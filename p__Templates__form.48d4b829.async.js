(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{BOG6:function(J,c,e){"use strict";e.r(c);var j=e("miYZ"),p=e("tsqr"),x=e("9og8"),s=e("fOrg"),b=e("+KLJ"),N=e("+L6B"),W=e("2/Rp"),h=e("tJVT"),y=e("jrin"),O=e("k1fw"),B=e("WmNS"),P=e.n(B),i=e("q1tI"),R=e.n(i),m=e("VMEa"),S=e("Qurx"),U=e("yj/a"),F=e("nhC9"),r=e("rWUb"),n=e("tMyG"),a=e("9kvl"),u=e("Ty5D"),_=e("pWZp"),t=e("nKUr"),g=e.n(t),V=function(D){return D?Object.keys(D).reduce(function(o,M){return Object(O.a)(Object(O.a)({},o),{},Object(y.a)({},M,M))},{}):{}},$=function(D){var o=D.disabled,M=o===void 0?!1:o,L=D.id,C=Object(i.useState)({state:"ready"}),G=Object(h.a)(C,2),f=G[0],E=G[1],w=Object(i.useCallback)(function(){E({state:"loading"}),Object(r.c)(L).then(function(l){l.success?l.data.sent&&l.data.to?E({state:"loaded",data:l.data,message:"email sent to ".concat(l.data.to)}):l.data.url?E({state:"loaded",data:l.data,message:Object(t.jsxs)(R.a.Fragment,{children:["Download"," ",Object(t.jsx)("a",{target:"_blank",href:l.data.url,children:l.data.filename})]})}):E({state:"loaded",data:l.data,message:l.message}):E({state:"error",error:l.message})}).catch(function(){E({state:"error",error:"error"})})},[L]);return Object(t.jsxs)(R.a.Fragment,{children:[Object(t.jsx)(W.a,{type:"primary",loading:f.state==="loading",disabled:M,onClick:w,children:Object(t.jsx)(a.a,{id:"preview"})}),f.state==="loaded"&&Object(t.jsx)(b.a,{message:f.message,type:"success",closable:!0,onClose:function(){return E({state:"ready"})}}),f.state==="error"&&Object(t.jsx)(b.a,{message:f.error,type:"error",closable:!0,onClose:function(){return E({state:"ready"})}})]})};c.default=function(){var I=Object(a.i)(),D=Object(u.g)(),o=D.template,M=o==="new",L=Object(i.useState)(!1),C=Object(h.a)(L,2),G=C[0],f=C[1],E=m.b.useForm(),w=Object(h.a)(E,1),l=w[0],Q=Object(i.useState)(),Z=Object(h.a)(Q,2),K=Z[0],X=Z[1];Object(i.useEffect)(function(){Object(r.g)().then(function(T){X(T.success?T.data:{})})},[]);var Y=Object(i.useCallback)(Object(x.a)(P.a.mark(function T(){var d;return P.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,Object(r.d)(Number(o));case 2:d=v.sent,d.success&&(l.setFieldsValue(Object(O.a)(Object(O.a)({},d.data),{},{content:d.data.content||""})),f(!0));case 4:case"end":return v.stop()}},T)})),[o,K]);Object(i.useEffect)(function(){o!=="new"&&Y()},[o,Y]);var k=Object(i.useCallback)(function(){var T=Object(x.a)(P.a.mark(function d(H){var v,z;return P.a.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(z=Object(O.a)({},H),o!=="new"){A.next=8;break}return A.next=4,Object(r.a)(z);case 4:v=A.sent,v.success&&a.d.push("/templates/".concat(v.data.id)),A.next=11;break;case 8:return A.next=10,Object(r.f)(Number(o),z);case 10:v=A.sent;case 11:f(!0),p.default.success(v.message);case 13:case"end":return A.stop()}},d)}));return function(d){return T.apply(this,arguments)}}(),[]);return Object(t.jsx)(n.a,{title:M?Object(t.jsx)(a.a,{id:"new_template"}):Object(t.jsx)(a.a,{id:"new_template"}),children:Object(t.jsx)(F.a,{children:Object(t.jsxs)(m.b,{initialValues:{},onFinish:k,form:l,onValuesChange:function(){f(!1)},children:[Object(t.jsxs)(m.b.Group,{children:[Object(t.jsx)(S.a,{width:"md",name:"name",label:Object(t.jsx)(a.a,{id:"name"}),tooltip:Object(t.jsx)(a.a,{id:"name_tooltip"}),placeholder:I.formatMessage({id:"name"}),required:!0}),Object(t.jsx)(U.a,{name:"type",label:Object(t.jsx)(a.a,{id:"tpl_type"}),tooltip:Object(t.jsx)(a.a,{id:"tpl_type_tooltip"}),valueEnum:K?V(K):{},placeholder:I.formatMessage({id:"tpl_type_placeholder"}),rules:[{required:!0,message:"Please select your country!"}]}),Object(t.jsx)(m.b.Item,{noStyle:!0,shouldUpdate:!0,children:function(d){return Object(t.jsx)(U.a,{name:"vars_set",label:Object(t.jsx)(a.a,{id:"tpl_vars_set"}),tooltip:Object(t.jsx)(a.a,{id:"tpl_vars_set_tooltip"}),valueEnum:K?V(K[d.getFieldValue("type")]):{},placeholder:I.formatMessage({id:"tpl_vars_set_placeholder"}),rules:[{required:!0,message:"Please select your country!"}]})}}),!M&&Object(t.jsx)(m.b.Item,{label:Object(t.jsx)(a.a,{id:"preview"}),children:Object(t.jsx)($,{disabled:!G,id:Number(o)})})]}),Object(t.jsx)(m.b.Item,{noStyle:!0,shouldUpdate:!0,children:function(d){return Object(t.jsx)(m.b.Item,{name:"content",label:Object(t.jsx)(a.a,{id:"content"}),tooltip:Object(t.jsx)(a.a,{id:"content_tooltip"}),valuePropName:"value",required:!0,shouldUpdate:!0,children:Object(t.jsx)(_.a,{tokens:K&&d.getFieldValue("type")&&d.getFieldValue("vars_set")?K[d.getFieldValue("type")][d.getFieldValue("vars_set")]:[]})})}})]})})})}},pWZp:function(J,c,e){"use strict";var j=e("DYRE"),p=e("zeV3"),x=e("tU7J"),s=e("wFql"),b=e("+BJd"),N=e("mr32"),W=e("/zsF"),h=e("PArb"),y=e("tJVT"),O=e("q1tI"),B=e.n(O),P=e("AEIT"),i=e.n(P),R=e("vnc/"),m=e.n(R),S=e("xEw5"),U=e.n(S),F=e("24R3"),r=e("nKUr"),n=e.n(r),a=function(_){var t=_.value,g=_.onChange,V=_.tokens,$=V===void 0?[]:V,I=Object(O.useRef)(),D=Object(O.useState)(Math.random().toString()),o=Object(y.a)(D,2),M=o[0],L=o[1];return Object(O.useEffect)(function(){L(Math.random().toString())},[$]),Object(r.jsxs)("div",{className:"template-editor",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(F.a,{id:"tokens",defaultMessage:"posibble tokens:"})}),Object(r.jsx)(p.b,{children:Object(r.jsx)(s.a,{children:$.map(function(C){return Object(r.jsx)(N.a,{children:C},C)})})}),Object(r.jsx)(h.a,{}),Object(r.jsx)(P.CKEditor,{ref:I,config:{width:"210mm",height:"297mm",mention:{feeds:[{marker:"@",minimumCharacters:1,feed:$}]}},editor:m.a,data:t||"",onChange:function(G,f){var E=f.getData();return g&&g(E)}},M)]})};c.a=a},rWUb:function(J,c,e){"use strict";e.d(c,"e",function(){return N}),e.d(c,"d",function(){return h}),e.d(c,"a",function(){return O}),e.d(c,"f",function(){return P}),e.d(c,"b",function(){return R}),e.d(c,"g",function(){return S}),e.d(c,"c",function(){return F});var j=e("k1fw"),p=e("9og8"),x=e("WmNS"),s=e.n(x),b=e("9kvl");function N(n,a){return W.apply(this,arguments)}function W(){return W=Object(p.a)(s.a.mark(function n(a,u){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(b.f)("/api/admin/templates",Object(j.a)({method:"GET",useCache:!0,params:Object(j.a)(Object(j.a)({},a),{},{per_page:a.pageSize,page:a.current})},u||{})));case 1:case"end":return t.stop()}},n)})),W.apply(this,arguments)}function h(n,a){return y.apply(this,arguments)}function y(){return y=Object(p.a)(s.a.mark(function n(a,u){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(b.f)("/api/admin/templates/".concat(a),Object(j.a)({method:"GET"},u||{})));case 1:case"end":return t.stop()}},n)})),y.apply(this,arguments)}function O(n,a){return B.apply(this,arguments)}function B(){return B=Object(p.a)(s.a.mark(function n(a,u){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(b.f)("/api/admin/templates",Object(j.a)({method:"POST",headers:{"Content-Type":"application/json"},data:a},u||{})));case 1:case"end":return t.stop()}},n)})),B.apply(this,arguments)}function P(n,a,u){return i.apply(this,arguments)}function i(){return i=Object(p.a)(s.a.mark(function n(a,u,_){return s.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",Object(b.f)("/api/admin/templates/".concat(a),Object(j.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:u},_||{})));case 1:case"end":return g.stop()}},n)})),i.apply(this,arguments)}function R(n,a){return m.apply(this,arguments)}function m(){return m=Object(p.a)(s.a.mark(function n(a,u){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(b.f)("/api/admin/templates/".concat(a),Object(j.a)({method:"DELETE",headers:{"Content-Type":"application/json"}},u||{})));case 1:case"end":return t.stop()}},n)})),m.apply(this,arguments)}function S(n){return U.apply(this,arguments)}function U(){return U=Object(p.a)(s.a.mark(function n(a){return s.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",Object(b.f)("/api/admin/templates/variables",Object(j.a)({method:"GET"},a||{})));case 1:case"end":return _.stop()}},n)})),U.apply(this,arguments)}function F(n,a){return r.apply(this,arguments)}function r(){return r=Object(p.a)(s.a.mark(function n(a,u){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(b.f)("/api/admin/templates/".concat(a,"/preview"),Object(j.a)({method:"GET"},u||{})));case 1:case"end":return t.stop()}},n)})),r.apply(this,arguments)}},xEw5:function(J,c,e){}}]);
