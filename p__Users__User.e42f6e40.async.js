(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{"59P8":function(oe,D,e){"use strict";var a=e("k1fw"),u=e("PpiC"),d=e("tJVT"),v=e("q1tI"),h=e("9kvl"),C=e("Qiat"),r=e("sWYD"),W=e("mGZj"),V=e("qLMh"),A=e("9og8");function q(S,U){return I.apply(this,arguments)}function I(){return I=Object(A.a)(Object(V.a)().mark(function S(U,_){return Object(V.a)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",Object(h.i)("/api/admin/tracks/routes",Object(a.a)({method:"GET",useCache:!1,params:Object(a.a)(Object(a.a)({},U),{},{per_page:U.pageSize,page:U.current})},_||{})));case 1:case"end":return b.stop()}},S)})),I.apply(this,arguments)}var Z=e("Vpfc"),o=e("0WSk"),s=e("nKUr"),l=["type","defaultRender"],p=[{title:Object(s.jsx)(h.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:Object(s.jsx)(h.a,{id:"dateRange",defaultMessage:"Date Range"}),dataIndex:"dateRange",hideInSearch:!1,hideInForm:!0,hideInTable:!0,valueType:"dateRange",fieldProps:{allowEmpty:[!0,!0]}},{title:Object(s.jsx)(h.a,{id:"http_method",defaultMessage:"http_method"}),dataIndex:"method",hideInSearch:!1,sorter:!0,valueEnum:{GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE",PATCH:"PATCH"}},{title:Object(s.jsx)(h.a,{id:"path",defaultMessage:"path"}),dataIndex:"path",sorter:!0,hideInSearch:!1}],K=function(U){var _=U.useAsWidget,ne=U.userID,b=Object(v.useRef)(),c=Object(v.useState)(!1),te=Object(d.a)(c,2),z=te[0],ae=te[1],de=Object(h.l)();return Object(s.jsx)(C.a,{headerTitle:de.formatMessage({id:"menu.Analytics.Logs",defaultMessage:"menu.Analytics.Logs"}),loading:z,actionRef:b,rowKey:"id",search:{layout:"vertical"},request:function(P,N){var ie=P.user_id,le=P.method,Q=P.dateRange,ce=P.path,ee=P.pageSize,me=P.current,re=N&&Object.entries(N)[0];ae(!0);var t=Q&&Q[0]?Object(r.a)(new Date(Q[0]),W.a):void 0,Oe=Q&&Q[1]?Object(r.a)(new Date(Q[1]),W.a):void 0;return q({user_id:_?ne:ie,method:le,pageSize:ee,current:me,path:ce,date_from:t,date_to:Oe,order_by:re&&re[0],order:re?re[1]==="ascend"?"ASC":"DESC":void 0}).then(function(ue){return ae(!1),ue.success?{data:ue.data,total:ue.meta.total,success:!0}:[]})},columns:[].concat(p,[{title:Object(s.jsx)(h.a,{id:"user",defaultMessage:"user"}),dataIndex:"user_id",key:"user_id",hideInSearch:_,sorter:!0,renderFormItem:function(P,N,ie){var le=N.type,Q=N.defaultRender,ce=Object(u.a)(N,l);if(le==="form")return null;var ee=ie.getFieldValue("state");return Object(s.jsx)(o.a,Object(a.a)(Object(a.a)({},ce),{},{state:{type:ee}}))},render:function(P,N){return N.user&&Object(s.jsx)(Z.a,{type:"App\\Models\\User",type_id:N.user.id})}}])})},i=D.a=K},"F/zT":function(oe,D,e){"use strict";var a=e("VTBJ"),u=e("Ff2n"),d=e("nKUr"),v=e.n(d),h=e("q1tI"),C=e.n(h),r=e("adzw"),W=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],V=C.a.forwardRef(function(A,q){var I=A.fieldProps,Z=A.unCheckedChildren,o=A.checkedChildren,s=A.proFieldProps,l=Object(u.a)(A,W);return Object(d.jsx)(r.a,Object(a.a)({valueType:"switch",fieldProps:Object(a.a)({unCheckedChildren:Z,checkedChildren:o},I),ref:q,valuePropName:"checked",proFieldProps:s,filedConfig:{valuePropName:"checked",ignoreWidth:!0}},l))});D.a=V},"G/Ub":function(oe,D,e){"use strict";e.d(D,"d",function(){return h}),e.d(D,"a",function(){return r}),e.d(D,"b",function(){return V}),e.d(D,"c",function(){return q}),e.d(D,"e",function(){return Z});var a=e("qLMh"),u=e("k1fw"),d=e("9og8"),v=e("9kvl");function h(s,l){return C.apply(this,arguments)}function C(){return C=Object(d.a)(Object(a.a)().mark(function s(l,p){return Object(a.a)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Object(v.i)("/api/admin/roles",Object(u.a)({method:"GET",useCache:!1,params:l},p||{})));case 1:case"end":return i.stop()}},s)})),C.apply(this,arguments)}function r(s,l){return W.apply(this,arguments)}function W(){return W=Object(d.a)(Object(a.a)().mark(function s(l,p){return Object(a.a)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Object(v.i)("/api/admin/roles",Object(u.a)({method:"POST",headers:{"Content-Type":"application/json"},data:l},p||{})));case 1:case"end":return i.stop()}},s)})),W.apply(this,arguments)}function V(s,l){return A.apply(this,arguments)}function A(){return A=Object(d.a)(Object(a.a)().mark(function s(l,p){return Object(a.a)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Object(v.i)("/api/admin/roles/".concat(l),Object(u.a)({method:"DELETE",headers:{"Content-Type":"application/json"}},p||{})));case 1:case"end":return i.stop()}},s)})),A.apply(this,arguments)}function q(s,l){return I.apply(this,arguments)}function I(){return I=Object(d.a)(Object(a.a)().mark(function s(l,p){return Object(a.a)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Object(v.i)("/api/admin/roles/".concat(l),Object(u.a)({method:"GET",useCache:!1},p||{})));case 1:case"end":return i.stop()}},s)})),I.apply(this,arguments)}function Z(s,l,p){return o.apply(this,arguments)}function o(){return o=Object(d.a)(Object(a.a)().mark(function s(l,p,K){return Object(a.a)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",Object(v.i)("/api/admin/roles/".concat(l),Object(u.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:p},K||{})));case 1:case"end":return S.stop()}},s)})),o.apply(this,arguments)}},TWax:function(oe,D,e){"use strict";var a=e("ozfa"),u=e("MJZm"),d=e("T2oS"),v=e("W9HT"),h=e("tJVT"),C=e("q1tI"),r=e.n(C),W=e("JifO"),V=e("nKUr"),A=e.n(V),q=function Z(o){return o.subcategories&&o.subcategories.length?{title:o.name,key:o.id,children:o.subcategories.map(function(s){return Z(s)})}:{title:o.name,key:o.id}},I=function(o){var s=o.value,l=o.onChange,p=o.multiple,K=p===void 0?!0:p,i=Object(C.useState)([]),S=Object(h.a)(i,2),U=S[0],_=S[1];Object(C.useEffect)(function(){Object(W.c)().then(function(b){b.success&&_(b.data)})},[]);var ne=Object(C.useMemo)(function(){return U.map(function(b){return q(b)})},[U]);return U.length===0?Object(V.jsx)(v.a,{}):Object(V.jsx)(u.a,{multiple:K,checkable:!0,checkStrictly:!0,defaultExpandAll:!0,style:{width:"100%"},checkedKeys:s,onCheck:function(c){if(typeof c=="object"&&!Array.isArray(c)&&c.checked){var te=c.checked;return l&&Array.isArray(te)&&l(te)}},treeData:ne,disabled:U.length===0})};D.a=I},weGn:function(oe,D,e){"use strict";e.r(D);var a=e("qLMh"),u=e("k1fw"),d=e("9og8"),v=e("tJVT"),h=e("nhC9"),C=e("Ty5D"),r=e("9kvl"),W=e("tMyG"),V=e("14J3"),A=e("BMrR"),q=e("/zsF"),I=e("PArb"),Z=e("tU7J"),o=e("wFql"),s=e("DYRE"),l=e("zeV3"),p=e("y8nQ"),K=e("Vl3Y"),i=e("+L6B"),S=e("2/Rp"),U=e("T2oS"),_=e("W9HT"),ne=e("miYZ"),b=e("tsqr"),c=e("q1tI"),te=e.n(c),z=e("VMEa"),ae=e("Qurx"),de=e("F/zT"),je=e("tneF"),P=e("VK58"),N=e("02ly"),ie=e("Jfn2"),le=e("2ult"),Q=e("55Ip"),ce=e("G/Ub"),ee=e("ri8c"),me=e("TpMl"),re=e("YDsB"),t=e("nKUr");function Oe(T){var X=Object(c.useState)([]),y=Object(v.a)(X,2),M=y[0],w=y[1],J=Object(c.useState)(!1),O=Object(v.a)(J,2),H=O[0],n=O[1],g=Object(c.useCallback)(Object(d.a)(Object(a.a)().mark(function B(){var j;return Object(a.a)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.prev=0,n(!0),R.next=4,Object(ee.h)({user_id:T});case 4:j=R.sent,j.success&&w(j.data.map(function(m){var he=m.id;return he}));case 6:return R.prev=6,n(!1),R.finish(6);case 9:case"end":return R.stop()}},B,null,[[0,,6,9]])})),[T]),G=Object(c.useCallback)(function(){var B=Object(d.a)(Object(a.a)().mark(function j(f){return Object(a.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(typeof f!="string"){m.next=2;break}return m.abrupt("return");case 2:return n(!0),m.next=5,Object(ee.a)(f,T);case 5:return m.next=7,g();case 7:n(!1);case 8:case"end":return m.stop()}},j)}));return function(j){return B.apply(this,arguments)}}(),[T]),L=Object(c.useCallback)(function(){var B=Object(d.a)(Object(a.a)().mark(function j(f){return Object(a.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(typeof f!="string"){m.next=2;break}return m.abrupt("return");case 2:return n(!0),m.next=5,Object(ee.d)(f,T);case 5:return m.next=7,g();case 7:n(!1);case 8:case"end":return m.stop()}},j)}));return function(j){return B.apply(this,arguments)}}(),[T]),Y=Object(c.useCallback)(Object(d.a)(Object(a.a)().mark(function B(){return Object(a.a)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return n(!0),f.next=3,Promise.all(M.map(function(R){return Object(ee.d)(R,T)}));case 3:return f.next=5,g();case 5:n(!1);case 6:case"end":return f.stop()}},B)})),[M]);return Object(c.useEffect)(function(){g()},[g]),{userGroups:M,userGroupsLoading:H,handleAddToGroup:G,handleRemoveFromGroup:L,handleClearAllGroups:Y}}var ue=function(T){var X,y,M,w,J=T.isNew,O=T.data,H=T.setData,n=Object(r.l)(),g=Object(C.l)(),G=g.user,L=Object(me.a)("EscolaLms\\Auth\\Models\\User"),Y=Object(r.m)("@@initialState"),B=Y.initialState,j=B==null||(X=B.config)===null||X===void 0||(y=X.filter(function(E){return E.key==="frontURL"})[0])===null||y===void 0?void 0:y.data,f=Oe((M=O==null?void 0:O.id)!==null&&M!==void 0?M:0),R=f.userGroups,m=f.userGroupsLoading,he=f.handleAddToGroup,Te=f.handleRemoveFromGroup,ye=f.handleClearAllGroups,Me=Object(c.useState)(),fe=Object(v.a)(Me,2),ve=fe[0],De=fe[1],Ae=z.a.useForm(),Se=Object(v.a)(Ae,1),be=Se[0],Re=Object(c.useCallback)(Object(d.a)(Object(a.a)().mark(function E(){var $,x;return Object(a.a)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,Object(ce.d)();case 2:return $=F.sent,F.next=5,$;case 5:x=F.sent,x.success&&De(x.data);case 7:case"end":return F.stop()}},E)})),[G]),Ie=function(){Object(P.d)(Number(G)).then(function($){$.success&&(b.b.success($.message),H(function(x){return Object(u.a)(Object(u.a)({},x),{},{avatar:"",path_avatar:""})}))}).catch(function($){b.b.error($.data.message)})};Object(c.useEffect)(function(){Re()},[G]);var Ue=Object(c.useMemo)(function(){return{form:be,onFinish:function(){var E=Object(d.a)(Object(a.a)().mark(function x(pe){var F,se;return Object(a.a)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(se=Object(u.a)({},pe),(!se.password||se.password==="")&&delete se.password,!J){k.next=9;break}return k.next=5,Object(P.a)(se);case 5:F=k.sent,F.success&&r.f.push("/users/".concat(F.data.id,"/user_info")),k.next=12;break;case 9:return k.next=11,Object(P.k)(Number(G),se);case 11:F=k.sent;case 12:b.b.success(F.message);case 13:case"end":return k.stop()}},x)}));function $(x){return E.apply(this,arguments)}return $}(),initialValues:O}},[O,G]);return O?Object(t.jsxs)(z.a,Object(u.a)(Object(u.a)({},Ue),{},{children:[Object(t.jsxs)(z.a.Group,{children:[Object(t.jsx)(ae.a,{width:"md",name:"first_name",label:Object(t.jsx)(r.a,{id:"first_name"}),tooltip:Object(t.jsx)(r.a,{id:"first_name"}),placeholder:n.formatMessage({id:"first_name"}),required:!0,rules:[{required:!0,message:n.formatMessage({id:"field_required"})}]}),Object(t.jsx)(ae.a,{width:"md",name:"last_name",label:Object(t.jsx)(r.a,{id:"last_name"}),tooltip:Object(t.jsx)(r.a,{id:"last_name"}),placeholder:n.formatMessage({id:"last_name"}),required:!0,rules:[{required:!0,message:n.formatMessage({id:"field_required"})}]}),Object(t.jsx)(ae.a,{width:"md",name:"email",label:Object(t.jsx)(r.a,{id:"email"}),tooltip:Object(t.jsx)(r.a,{id:"email"}),placeholder:n.formatMessage({id:"email"}),required:!0,rules:[{required:!0,message:n.formatMessage({id:"field_required"})}]}),Object(t.jsx)(ae.a.Password,{shouldUpdate:!0,width:"md",name:"password",label:Object(t.jsx)(r.a,{id:"password"}),tooltip:Object(t.jsx)(r.a,{id:"password"}),placeholder:n.formatMessage({id:"password"}),required:J,rules:[{validator:function($,x){return x&&!/(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{8,}$/i.test(x)?Promise.reject(new Error(n.formatMessage({id:"badPassword"}))):Promise.resolve()}},{required:J,message:Object(t.jsx)(r.a,{id:"field_required"})}]}),L.state==="loaded"&&L.list.map(function(E){return Object(t.jsx)(re.a,{field:E},E.id)})]}),Object(t.jsxs)(z.a.Group,{children:[!J&&Object(t.jsxs)(l.b,{direction:"vertical",children:[!((w=O.roles)!==null&&w!==void 0&&w.includes("admin"))&&Object(t.jsx)(de.a,{initialValue:O.is_active,name:"email_verified",label:Object(t.jsx)(r.a,{id:"is_email_verified"})}),Object(t.jsx)(K.a.Item,{noStyle:!0,shouldUpdate:!0,children:function(){return be.getFieldValue("email_verified")?Object(t.jsx)(te.a.Fragment,{}):Object(t.jsxs)(t.Fragment,{children:[!j&&Object(t.jsxs)("p",{children:[Object(t.jsx)(r.a,{id:"no_base_url"}),Object(t.jsx)(Q.a,{to:"/configuration/settings/escola_auth",children:"Settings"})]}),Object(t.jsx)(S.a,{disabled:!j,size:"small",onClick:function(){Object(P.g)(be.getFieldValue("email"),"".concat(j,"email-verify")).then(function(){b.b.success(n.formatMessage({id:"email_resend"}))})},children:Object(t.jsx)(r.a,{id:"resend"})})]})}})]}),Object(t.jsx)(de.a,{name:"is_active",label:Object(t.jsx)(r.a,{id:"is_active"})}),ve&&Object(t.jsx)(je.a.Group,{name:"roles",layout:"horizontal",label:Object(t.jsx)(r.a,{id:"roles"}),options:ve.filter(function(E){return E.guard_name!=="web"}).map(function(E){return E.name})})]}),!J&&Object(t.jsxs)(t.Fragment,{children:[Object(t.jsxs)(z.a.Group,{children:[Object(t.jsx)(z.a.Item,{name:"avatar",label:Object(t.jsx)(r.a,{id:"avatar"}),children:O.path_avatar?Object(t.jsx)(ie.a,{path:O.path_avatar,size:600,width:200}):Object(t.jsx)(o.a,{children:Object(t.jsx)(r.a,{id:"avatar_placeholder"})})}),Object(t.jsx)(K.a.Item,{noStyle:!0,shouldUpdate:!0,children:function(){return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(N.a,{folder:"avatars/".concat(G),wrapInForm:!1,url:"/api/admin/users/".concat(G,"/avatar"),name:"avatar",accept:"image/*",onChange:function(x){x.file.status==="done"&&x.file.response&&x.file.response.success&&H(x.file.response.data)}}),Object(t.jsx)(S.a,{danger:!0,onClick:Ie,children:Object(t.jsx)(r.a,{id:"delete"})})]})}})]}),Object(t.jsxs)(A.a,{children:[Object(t.jsx)(I.a,{}),Object(t.jsx)(z.a.Item,{style:{width:"100%"},label:Object(t.jsx)(r.a,{id:"groups",defaultMessage:"Groups"}),children:Object(t.jsx)(le.a,{multiple:!0,loading:m,disabled:m,value:R,onSelect:he,onDeselect:Te,onClear:ye})})]})]})]})):Object(t.jsx)(_.a,{})},ge=e("TWax"),Ee=function(X){var y=X.data,M=Object(c.useMemo)(function(){return{onFinish:function(){var w=Object(d.a)(Object(a.a)().mark(function O(H){var n,g;return Object(a.a)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return n=Object(u.a)({},H),L.next=3,Object(P.l)(Number(y==null?void 0:y.id),n);case 3:g=L.sent,b.b.success(g.message);case 5:case"end":return L.stop()}},O)}));function J(O){return w.apply(this,arguments)}return J}(),initialValues:y}},[y]);return Object(t.jsx)(z.a,Object(u.a)(Object(u.a)({},M),{},{children:Object(t.jsx)(z.a.Item,{label:Object(t.jsx)(r.a,{id:"categories"}),name:"interests",valuePropName:"value",children:Object(t.jsx)(ge.a,{})})}))},xe=Ee,Ce=e("c+yx"),Pe=e("59P8"),Ge=D.default=function(){var T=Object(C.l)(),X=Object(c.useState)(),y=Object(v.a)(X,2),M=y[0],w=y[1],J=Object(r.l)(),O=T.tab,H=O===void 0?"user_info":O,n=T.user,g=typeof n=="undefined",G=Object(c.useCallback)(Object(d.a)(Object(a.a)().mark(function L(){var Y;return Object(a.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,Object(P.m)(Number(n));case 2:Y=j.sent,Y.success&&w(Object(u.a)(Object(u.a)({},Y.data),{},{interests:Y.data.interests.map(Ce.a)}));case 4:case"end":return j.stop()}},L)})),[n]);return Object(c.useEffect)(function(){if(g){w({});return}G()},[n,G]),Object(t.jsx)(W.a,{title:Object(t.jsx)(r.a,{id:"settings"}),header:{breadcrumb:{routes:[{path:"/users/".concat(n,"/user_info"),breadcrumbName:J.formatMessage({id:"menu.Settings"})},{path:String(H),breadcrumbName:String(H)}]}},children:Object(t.jsxs)(h.a,{tabs:{type:"card",activeKey:H,onChange:function(Y){return r.f.push("/users/".concat(n,"/").concat(Y))}},children:[Object(t.jsx)(h.a.TabPane,{tab:g?Object(t.jsx)(r.a,{id:"new_user"}):Object(t.jsx)(r.a,{id:"edit_user"}),children:Object(t.jsx)(ue,{isNew:g,data:M,setData:w})},"user_info"),!g&&Object(t.jsx)(h.a.TabPane,{tab:Object(t.jsx)("span",{children:Object(t.jsx)(r.a,{id:"categories"})}),children:(M==null?void 0:M.id)&&Object(t.jsx)(xe,{data:M})},"categories"),!g&&Object(t.jsx)(h.a.TabPane,{tab:Object(t.jsx)("span",{children:Object(t.jsx)(r.a,{id:"user_logs"})}),children:n&&Object(t.jsx)(Pe.a,{useAsWidget:!0,userID:Number(n)})},"logs")]})})}}}]);
