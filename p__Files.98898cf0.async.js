(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"3fxf":function(F,O,e){"use strict";var m=e("DjyN"),g=e("NUBc"),p=e("Mwp2"),j=e("VXEj"),I=e("+L6B"),u=e("2/Rp"),y=e("5NDa"),P=e("5rEg"),U=e("oBTY"),a=e("k1fw"),R=e("tJVT"),S=e("DYRE"),l=e("zeV3"),c=e("tU7J"),s=e("wFql"),_=e("q1tI"),M=e.n(_),r=e("BAh9"),z=e("/MfK"),f=e("mAF4"),$=e("dF/Y"),L=e("9kvl"),N=e("DBJ/"),Y=e("lLVY"),V=e.n(Y),n=e("nKUr"),X=e.n(n),K=function(v){var A=v.directory,E=v.onUploaded;return Object(n.jsxs)(l.b,{align:"start",children:[Object(n.jsxs)(s.a.Text,{children:[Object(n.jsx)(L.a,{id:"pages.files.filesBrowser"}),Object(n.jsx)(s.a.Text,{code:!0,children:A})]}),Object(n.jsx)(N.a,{url:"/api/admin/file/upload",name:"file[]",data:{target:A},onUpload:function(W){W.success&&E(A,W.data)}})]})},x=function(v){var A=v.defaultDirectory,E=A===void 0?"/":A,B=v.onFile,W=v.hideDeleteBtn,k=W===void 0?!1:W,w=v.forceLoading,q=w===void 0?!1:w,ee=Object(L.j)(),te=Object(_.useState)({loading:!1,name:"",directory:E,current_page:1,data:void 0,per_page:1,last_page:1,total:0}),H=Object(R.a)(te,2),d=H[0],G=H[1],C=Object(_.useRef)(),b=Object(_.useCallback)(function(o){G(function(t){return Object(a.a)(Object(a.a)({},t),{},{loading:o})})},[]),Z=Object(_.useCallback)(function(o,t){o.success&&G(function(i){return Object(a.a)(Object(a.a)(Object(a.a)({},i),o.data),{},{data:[{url:t.split("/").slice(0,-1).join("/"),name:"..",created_at:"",mime:"directory"}].concat(Object(U.a)(o.data.data.map(function(D){return Object(a.a)(Object(a.a)({},D),{},{url:D.mime==="directory"?"".concat(t,"/").concat(D.name):D.url})}))).filter(function(D){return t==="/"||t===E?D.name!=="..":!0}),directory:t,loading:!1})})},[b]),h=Object(_.useCallback)(function(o){var t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,D=function(){return C.current&&C.current.abort()};return D(),C.current=new AbortController,b(!0),Object(r.a)({directory:o,page:i},{signal:(t=C.current)===null||t===void 0?void 0:t.signal}).then(function(T){T.success&&Z(T,o)}).catch(function(){return b(!1)}),function(){D()}},[b]);Object(_.useEffect)(function(){return h(E)},[E,h]);var ne=Object(_.useCallback)(function(o){b(!0),Object(r.c)(o).then(function(){h(d.directory)}).catch(function(){b(!1)})},[h,b,d.directory]),ae=Object(_.useCallback)(function(o,t){var i,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,T=function(){return C.current&&C.current.abort()};return T(),C.current=new AbortController,b(!0),Object(r.b)({directory:o,name:t,page:D},{signal:(i=C.current)===null||i===void 0?void 0:i.signal}).then(function(Q){Q.success&&Z(Q,o)}).catch(function(){return b(!1)}),function(){T()}},[b]);return Object(n.jsxs)("div",{className:"file-browser",children:[Object(n.jsxs)("div",{className:"file-browser__header",children:[Object(n.jsx)(P.a,{placeholder:ee.formatMessage({id:"search_file"}),className:"file-browser__input",onChange:function(t){return G(function(i){return Object(a.a)(Object(a.a)({},i),{},{name:t.target.value})})},value:d.name}),Object(n.jsxs)("div",{children:[Object(n.jsx)(u.a,{className:"file-browser__button",onClick:function(){return h(d.directory)},children:Object(n.jsx)(L.a,{id:"reset"})}),Object(n.jsx)(u.a,{className:"file-browser__button",type:"primary",onClick:function(){return ae(d.directory,d.name)},children:Object(n.jsx)(L.a,{id:"query"})})]})]}),Object(n.jsx)(j.b,{loading:d.loading||q,size:"small",itemLayout:"horizontal",dataSource:d.data,header:Object(n.jsx)(K,{directory:d.directory,onUploaded:function(t,i){i&&(h(t),B&&B(i,t))}}),footer:Object(n.jsx)(K,{directory:d.directory,onUploaded:function(t,i){h(t),i&&B&&B(i,t)}}),renderItem:function(t){return Object(n.jsx)(j.b.Item,{actions:t.mime!=="directory"&&!k?[Object(n.jsx)(u.a,{type:"default",danger:!0,icon:Object(n.jsx)(z.a,{}),size:"small",onClick:function(){return ne(t.url)}},"dir")]:[],children:Object(n.jsx)(j.b.Item.Meta,{avatar:t.mime==="directory"?Object(n.jsx)(u.a,{type:"primary",icon:Object(n.jsx)(f.a,{}),size:"small",onClick:function(){return h(t.url)}}):Object(n.jsx)("a",{href:t.url,target:"_blank",rel:"noreferrer",children:Object(n.jsx)(u.a,{type:"default",icon:Object(n.jsx)($.a,{}),size:"small"})}),description:Object(n.jsx)(M.a.Fragment,{children:Object(n.jsx)(u.a,{type:"text",size:"small",onClick:function(){return t.mime==="directory"?h(t.url):B&&B(t,d.directory)},children:t.name})})})})}}),Object(n.jsx)(g.a,{pageSizeOptions:[],current:d.current_page,total:d.total,pageSize:d.per_page,onChange:function(t){return h(d.directory,t)}})]})};O.a=x},BAh9:function(F,O,e){"use strict";e.d(O,"a",function(){return I}),e.d(O,"b",function(){return y}),e.d(O,"e",function(){return U}),e.d(O,"d",function(){return R}),e.d(O,"c",function(){return S});var m=e("qLMh"),g=e("k1fw"),p=e("9og8"),j=e("9kvl");function I(c,s){return u.apply(this,arguments)}function u(){return u=Object(p.a)(Object(m.a)().mark(function c(s,_){return Object(m.a)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Object(j.g)("/api/admin/file/list",Object(g.a)({method:"GET",params:s},_||{})));case 1:case"end":return r.stop()}},c)})),u.apply(this,arguments)}function y(c,s){return P.apply(this,arguments)}function P(){return P=Object(p.a)(Object(m.a)().mark(function c(s,_){return Object(m.a)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Object(j.g)("/api/admin/file/find",Object(g.a)({method:"GET",params:s},_||{})));case 1:case"end":return r.stop()}},c)})),P.apply(this,arguments)}function U(c,s,_){return a.apply(this,arguments)}function a(){return a=Object(p.a)(Object(m.a)().mark(function c(s,_,M){var r;return Object(m.a)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return r=new FormData,r.append("file[]",s),r.append("target",_),f.abrupt("return",Object(j.g)("/api/admin/file/upload",Object(g.a)({method:"POST",data:r},M||{})));case 4:case"end":return f.stop()}},c)})),a.apply(this,arguments)}var R=function(s){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;return"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/images/img?path=").concat(s,"&w=").concat(_)};function S(c,s){return l.apply(this,arguments)}function l(){return l=Object(p.a)(Object(m.a)().mark(function c(s,_){return Object(m.a)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Object(j.g)("/api/admin/file/delete",Object(g.a)({method:"DELETE",data:{url:s}},_||{})));case 1:case"end":return r.stop()}},c)})),l.apply(this,arguments)}},"DBJ/":function(F,O,e){"use strict";var m=e("k1fw"),g=e("y8nQ"),p=e("Vl3Y"),j=e("tJVT"),I=e("etVw"),u=e("q1tI"),y=e.n(u),P=e("9kvl"),U=e("qFDU"),a=e("nKUr"),R=e.n(a);function S(l){var c=l.onChange,s=l.onUpload,_=l.url,M=l.name,r=l.extra,z=l.accept,f=l.data,$=l.wrapInForm,L=$===void 0?!0:$,N=l.title,Y=l.formProps,V=l.maxFiles,n=l.clearListAfterUpload,X=Object(u.useState)(),K=Object(j.a)(X,2),x=K[0],J=K[1],v=Object(P.j)();return f&&f[M]&&delete f[M],Object(a.jsx)(U.a,{condition:L,wrap:function(E){return Object(a.jsx)(p.a,Object(m.a)(Object(m.a)({},Y),{},{children:E}))},children:Object(a.jsx)(I.a,{title:N||" ".concat(v.formatMessage({id:"upload_click_here"})),placeholder:v.formatMessage({id:"upload_click_here"}),onChange:function(E){J(E),c&&c(E),E.file.status==="done"&&(s&&s(E.file.response),n&&J(void 0))},label:Object(a.jsx)(P.a,{id:"upload"}),max:V!=null?V:2,fieldProps:{data:f,accept:z,name:M,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}},action:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com").concat(_),extra:r,fileList:x==null?void 0:x.fileList})})}O.a=S},lLVY:function(F,O,e){},u4ym:function(F,O,e){"use strict";e.r(O);var m=e("IzEo"),g=e("bx4M"),p=e("tU7J"),j=e("wFql"),I=e("q1tI"),u=e.n(I),y=e("tMyG"),P=e("9kvl"),U=e("3fxf"),a=e("nKUr"),R=e.n(a);O.default=function(){return Object(a.jsx)(y.a,{children:Object(a.jsxs)(g.a,{children:[Object(a.jsx)(j.a.Text,{strong:!0,children:Object(a.jsx)(P.a,{id:"pages.files.content"})}),Object(a.jsx)(U.a,{})]})})}}}]);
