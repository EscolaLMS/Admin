(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"/y+f":function(Ue,M,e){"use strict";e.d(M,"h",function(){return p}),e.d(M,"e",function(){return o}),e.d(M,"f",function(){return $}),e.d(M,"d",function(){return G}),e.d(M,"a",function(){return V}),e.d(M,"c",function(){return I}),e.d(M,"b",function(){return _}),e.d(M,"g",function(){return F});var p;(function(c){c.Unselected="",c.RichText="EscolaLms\\TopicTypes\\Models\\TopicContent\\RichText",c.OEmbed="EscolaLms\\TopicTypes\\Models\\TopicContent\\OEmbed",c.Audio="EscolaLms\\TopicTypes\\Models\\TopicContent\\Audio",c.Video="EscolaLms\\TopicTypes\\Models\\TopicContent\\Video",c.H5P="EscolaLms\\TopicTypes\\Models\\TopicContent\\H5P",c.Image="EscolaLms\\TopicTypes\\Models\\TopicContent\\Image",c.PDF="EscolaLms\\TopicTypes\\Models\\TopicContent\\PDF",c.SCORM="EscolaLms\\TopicTypes\\Models\\TopicContent\\ScormSco",c.Project="EscolaLms\\TopicTypeProject\\Models\\Project",c.GiftQuiz="EscolaLms\\TopicTypeGift\\Models\\GiftQuiz"})(p||(p={}));var Q;(function(c){c.OrderPaid="EscolaLms\\Cart\\Events\\OrderPaid",c.UserLogged="EscolaLms\\Auth\\Events\\UserLogged"})(Q||(Q={}));var O;(function(c){c.draft="draft",c.published="published",c.archived="archived"})(O||(O={}));var o;(function(c){c.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",c.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",c.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel"})(o||(o={}));var $;(function(c){c.ManuallyTriggeredEvent="EscolaLms\\Templates\\Events\\ManuallyTriggeredEvent"})($||($={}));var ve;(function(c){c.cart_fixed="cart_fixed",c.cart_percent="cart_percent",c.product_fixed="product_fixed",c.product_percent="product_percent"})(ve||(ve={}));var G;(function(c){c.MULTIPLE_CHOICE="multiple_choice",c.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS="multiple_choice_with_multiple_right_answers",c.TRUE_FALSE="true_false",c.SHORT_ANSWERS="short_answers",c.MATCHING="matching",c.NUMERICAL_QUESTION="numerical_question",c.ESSAY="essay",c.DESCRIPTION="description"})(G||(G={}));var V;(function(c){c.PRESENT="present",c.PRESENT_NOT_EXERCISING="present_not_exercising",c.ABSENT="absent",c.EXCUSED_ABSENCE="excused_absence"})(V||(V={}));var I;(function(c){c.Manual="manual",c.TeamsForms="teams_forms",c.TeamsLecture="teams_lecture",c.TestPortal="test_portal"})(I||(I={}));var _;(function(c){c.Simple="simple",c.Complex="complex"})(_||(_={}));var F;(function(c){c.QuizSummary="EscolaLms\\Reports\\Stats\\Topic\\QuizSummaryForTopicTypeGIFT"})(F||(F={}))},"60mZ":function(Ue,M,e){},EKp7:function(Ue,M,e){"use strict";e.r(M);var p=e("T2oS"),Q=e("W9HT"),O=e("q1tI"),o=e("9kvl"),$=e("Ty5D"),ve=e("tMyG"),G=e("nhC9"),V=e("tKSU"),I=e("qLMh"),_=e("miYZ"),F=e("tsqr"),c=e("9og8"),D=e("k1fw"),C=e("PpiC"),y=e("tJVT"),n=e("VMEa"),w=e("Qurx"),W=e("yj/a"),k=e("F/zT"),Y=e("BiO0"),E=e("CEpB"),f=e("0WSk"),x=e("Gn8c"),U=e("hd5d"),j=e("YRX9"),N=e("/y+f"),r=e("nKUr"),ie=["authors","category"],fe=Object.values(N.b).map(function(pe){return{value:pe,label:Object(r.jsx)(o.a,{id:"CompetencyChallenges.types.".concat(pe)})}}),Ee=function(){var Z=Object(V.b)(),b=Z.competencyChallenge,ee=Z.categoryDepths,A=Z.refreshData,te=Object($.l)(),K=Number(te.id),ce=Object(o.l)(),ye=n.a.useForm(),Oe=Object(y.a)(ye,1),ue=Oe[0],ge=n.a.useWatch("type",ue),he=Number.isNaN(K),_e=Object(O.useMemo)(function(){if(!(b!=null&&b.data))return{};var ae=b==null?void 0:b.data,H=ae.authors,z=ae.category,J=Object(C.a)(ae,ie);return Object(D.a)(Object(D.a)({},J),{},{authors:H.map(function(re){var ne=re.id;return ne}),category_id:z==null?void 0:z.id})},[b==null?void 0:b.data]),Ce=Object(O.useCallback)(function(){var ae=Object(c.a)(Object(I.a)().mark(function H(z){var J,re,ne,le,de,S,l,a;return Object(I.a)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return J=z.name,re=z.type,ne=z.is_active,le=ne===void 0?!1:ne,de=z.is_highlighted,S=de===void 0?!1:de,l=z.category_id,s.prev=1,s.next=4,Object(j.a)({name:J,is_active:le,is_highlighted:S,type:re,category_id:l});case 4:if(a=s.sent,a.success){s.next=8;break}return F.b.error(a.message),s.abrupt("return");case 8:return F.b.success(ce.formatMessage({id:a.message})),o.f.push("/competency-challenges/".concat(a.data.id,"/main")),s.next=12,A();case 12:s.next=17;break;case 14:s.prev=14,s.t0=s.catch(1),F.b.error(ce.formatMessage({id:"error"}));case 17:case"end":return s.stop()}},H,null,[[1,14]])}));return function(H){return ae.apply(this,arguments)}}(),[]),Fe=Object(O.useCallback)(function(){var ae=Object(c.a)(Object(I.a)().mark(function H(z){var J,re,ne,le;return Object(I.a)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.prev=0,J=ue.getFieldsValue(["image_url","image_path"]),re=J.image_url,ne=J.image_path,S.next=4,Object(j.g)(K,Object(D.a)(Object(D.a)({},z),{},{image_url:re,image_path:ne}));case 4:if(le=S.sent,le.success){S.next=8;break}return F.b.error(le.message),S.abrupt("return");case 8:return F.b.success(ce.formatMessage({id:le.message})),S.next=11,A();case 11:S.next=16;break;case 13:S.prev=13,S.t0=S.catch(0),F.b.error(ce.formatMessage({id:"error"}));case 16:case"end":return S.stop()}},H,null,[[0,13]])}));return function(H){return ae.apply(this,arguments)}}(),[K]);return Object(r.jsxs)(n.a,{form:ue,initialValues:_e,onFinish:he?Ce:Fe,onValuesChange:function(H){(H==null?void 0:H.type)==="complex"&&ue.setFieldValue("category",null)},children:[Object(r.jsxs)(n.a.Group,{title:Object(r.jsx)(o.a,{id:"CompetencyChallenges.base"}),children:[Object(r.jsx)(w.a,{width:"md",name:"name",label:Object(r.jsx)(o.a,{id:"name"}),placeholder:ce.formatMessage({id:"name"}),required:!0,rules:[{required:!0,message:ce.formatMessage({id:"field_required"})}]}),Object(r.jsx)(W.a,{width:"md",name:"type",label:Object(r.jsx)(o.a,{id:"type"}),options:fe,required:!0,rules:[{required:!0,message:ce.formatMessage({id:"field_required"})}]}),ge==="simple"&&Object(r.jsx)(n.a.Item,{name:"category_id",required:!0,label:Object(r.jsx)(o.a,{id:"category"}),rules:[{required:!0,message:ce.formatMessage({id:"field_required"})}],children:Object(r.jsx)(E.a,{enabledDepth:ee.role})}),Object(r.jsx)(k.a,{name:"is_active",label:Object(r.jsx)(o.a,{id:"is_active"})}),Object(r.jsx)(k.a,{name:"is_highlighted",label:Object(r.jsx)(o.a,{id:"is_highlighted"}),tooltip:Object(r.jsx)(o.a,{id:"CompetencyChallenges.highlighted"})})]}),!he&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(n.a.Group,{title:Object(r.jsx)(o.a,{id:"CompetencyChallenges.additional"}),children:[Object(r.jsx)(n.a.Item,{name:"description",label:Object(r.jsx)(o.a,{id:"description"}),valuePropName:"value",style:{width:440},children:Object(r.jsx)(U.a,{directory:"competency-challenges/".concat(K)})}),Object(r.jsx)(Y.a,{width:"lg",name:"summary",label:Object(r.jsx)(o.a,{id:"summary"})}),Object(r.jsx)(n.a.Item,{name:"authors",label:Object(r.jsx)(o.a,{id:"author"}),style:{width:"100%",maxWidth:440},children:Object(r.jsx)(f.a,{multiple:!0})})]}),Object(r.jsx)(x.a,{wrapInForm:!1,folder:"/competency-challenges/".concat(K),title:"image",action:"/api/admin/competency-challenges/".concat(K,"?_method=PATCH"),src_name:"image_url",form_name:"image",getUploadedSrcField:function(H){return H.file.response.data.image_url},setPath:function(H){return ue.setFieldsValue(H)}})]})]})},Me=e("P2fV"),T=e("NJEC"),X=e("5Dmo"),Se=e("3S7+"),P=e("+L6B"),B=e("2/Rp"),be=e("G3dp"),Le=e("/MfK"),Ne=e("Hn4i"),We=e("enqX"),t=["scale_min","category_id"],Ie=[{title:Object(r.jsx)(o.a,{id:"ID"}),dataIndex:"id",editable:!1,render:function(Z,b){if(typeof b.id!="string")return"-";var ee=b.id.split("-"),A=Object(y.a)(ee,2),te=A[0],K=A[1];return te==="new"?"-":K}},{title:Object(r.jsx)(o.a,{id:"min_points"}),dataIndex:"scale_min",valueType:"digit",formItemProps:{rules:[{required:!0,message:Object(r.jsx)(o.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(r.jsx)(o.a,{id:"number_between",values:{min:0}})}]},fieldProps:{min:0}},{title:Object(r.jsx)(o.a,{id:"category"}),dataIndex:"category_id",render:function(Z,b){return b.category_name},formItemProps:{rules:[{required:!0,message:Object(r.jsx)(o.a,{id:"field_required"})}]},renderFormItem:function(Z,b,ee){var A,te=((A=ee.getFieldValue("table"))!==null&&A!==void 0?A:[]).map(function(K){return K.category_id});return Object(r.jsx)(We.a,{disabledNodes:te})}}],Be=function(Z){return Z.map(function(b){var ee=b.id,A=b.scale_min,te=b.category;return{id:"old-".concat(ee),scale_min:A,category_id:te.id,category_name:te.name_with_breadcrumbs}})},Ke=function(){var Z,b,ee=Object(V.b)(),A=ee.competencyChallenge,te=ee.refreshData,K=Object($.l)(),ce=Number(K.id),ye=(Z=A==null||(b=A.data)===null||b===void 0?void 0:b.scales)!==null&&Z!==void 0?Z:[],Oe=Object(O.useState)([]),ue=Object(y.a)(Oe,2),ge=ue[0],he=ue[1],_e=Object(o.l)(),Ce=Object(O.useRef)(),Fe=Object(O.useRef)(),ae=Object(O.useRef)(),H=Object(O.useMemo)(function(){return Be(ye)},[ye]),z=Object(O.useMemo)(function(){return[].concat(Ie,[{valueType:"option",title:Object(r.jsx)(o.a,{id:"options"}),render:function(re,ne,le,de){return[Object(r.jsx)(Se.a,{title:Object(r.jsx)(o.a,{id:"edit",defaultMessage:"edit"}),children:Object(r.jsx)(B.a,{type:"primary",icon:Object(r.jsx)(be.a,{}),onClick:function(){return de==null?void 0:de.startEditable(ne.id)}})},"edit"),Object(r.jsx)(T.a,{title:Object(r.jsx)(o.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(c.a)(Object(I.a)().mark(function S(){var l,a,i,s,d,m,v,h;return Object(I.a)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(typeof ne.id=="string"){u.next=2;break}return u.abrupt("return");case 2:if(l=ne.id.split("-"),a=Object(y.a)(l,2),i=a[0],s=a[1],i!=="new"){u.next=7;break}return v=(d=Ce.current)===null||d===void 0?void 0:d.getFieldValue("table"),(m=Ce.current)===null||m===void 0||m.setFieldValue("table",v.filter(function(R){var se=R.id;return se!==ne.id})),u.abrupt("return");case 7:return u.next=9,Object(j.d)(+s);case 9:if(h=u.sent,!h.success){u.next=13;break}return u.next=13,te();case 13:case"end":return u.stop()}},S)})),okText:Object(r.jsx)(o.a,{id:"ok"}),cancelText:Object(r.jsx)(o.a,{id:"cancel"}),children:Object(r.jsx)(Se.a,{title:Object(r.jsx)(o.a,{id:"delete",defaultMessage:"delete"}),children:Object(r.jsx)(B.a,{type:"primary",icon:Object(r.jsx)(Le.a,{}),danger:!0})})},"delete")]}}])},[]);return Object(r.jsx)(n.a,{formRef:Ce,initialValues:{table:H},submitter:!1,children:Object(r.jsx)(Ne.a,{rowKey:function(re){return re.id},editableFormRef:Fe,controlled:!0,actionRef:ae,name:"table",columns:z,recordCreatorProps:{creatorButtonText:Object(r.jsx)(o.a,{id:"CompetencyChallenges.addNewRow"}),disabled:ge.length>0,record:function(re){return{id:"new-".concat(re)}}},editable:{onlyOneLineEditorAlertMessage:_e.formatMessage({id:"CompetencyChallenges.onlyOneRowIsEditable"}),onSave:function(){var J=Object(c.a)(Object(I.a)().mark(function ne(le,de){var S,l,a,i,s,d,m,v,h;return Object(I.a)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(S=de.scale_min,l=de.category_id,a=Object(C.a)(de,t),typeof a.id=="string"){u.next=3;break}return u.abrupt("return");case 3:if(i=a.id.split("-"),s=Object(y.a)(i,2),d=s[0],m=s[1],d!=="new"){u.next=12;break}return u.next=7,Object(j.b)({scale_min:S,category_id:l,competency_challenge_id:ce});case 7:if(v=u.sent,!v.success){u.next=11;break}return u.next=11,te();case 11:return u.abrupt("return");case 12:return u.next=14,Object(j.h)(+m,{scale_min:S,category_id:l,competency_challenge_id:ce});case 14:if(h=u.sent,!h.success){u.next=18;break}return u.next=18,te();case 18:return u.abrupt("return");case 19:case"end":return u.stop()}},ne)}));function re(ne,le){return J.apply(this,arguments)}return re}(),deletePopconfirmMessage:Object(r.jsx)(o.a,{id:"deleteQuestion"}),actionRender:function(re,ne,le){if(typeof re.id!="string")return[];var de=re.id.split("-"),S=Object(y.a)(de,1),l=S[0];return l==="new"?[le.save,le.delete]:[le.save,le.cancel]},type:"single",editableKeys:ge,onChange:he}})})},Je=e("/zsF"),ze=e("PArb"),Ve=e("DYRE"),Re=e("zeV3"),Ge=e("uD7z"),Qe=e("FJDo"),He=e("yioT"),ke=e("qRSf"),oe=function(){var Z=Object(V.b)(),b=Z.competencyChallenge.data,ee=Object(O.useState)(!1),A=Object(y.a)(ee,2),te=A[0],K=A[1],ce=Object(O.useState)(),ye=Object(y.a)(ce,2),Oe=ye[0],ue=ye[1],ge=Object(o.l)(),he=Object(O.useCallback)(function(){(b==null?void 0:b.quiz_id)!==void 0&&(K(!0),Object(ke.c)(b==null?void 0:b.quiz_id).then(function(Ce){Ce.success&&ue(Ce.data)}).finally(function(){return K(!1)}))},[b==null?void 0:b.quiz_id]),_e=Object(O.useCallback)(function(){var Ce=Object(c.a)(Object(I.a)().mark(function Fe(ae){return Object(I.a)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if((b==null?void 0:b.quiz_id)!==void 0){z.next=2;break}return z.abrupt("return");case 2:K(!0),Object(ke.f)(b==null?void 0:b.quiz_id,Object(D.a)(Object(D.a)({},ae),{},{value:"diagnostic-test"})).then(function(J){J.success&&ue(J.data)}).finally(function(){return K(!1)});case 4:case"end":return z.stop()}},Fe)}));return function(Fe){return Ce.apply(this,arguments)}}(),[]);return Object(O.useEffect)(function(){he()},[he]),Oe?Object(r.jsxs)("div",{style:{position:"relative",paddingBottom:"64px"},children:[Object(r.jsx)(n.a,{submitter:{render:function(Fe,ae){var H=Object(y.a)(ae,2),z=H[0],J=H[1];return Object(r.jsxs)(Re.b,{style:{position:"absolute",bottom:0,left:0},children:[z,J]})}},initialValues:Oe,onFinish:_e,children:Object(r.jsxs)(Ge.a,{children:[Object(r.jsx)(Qe.a,{name:"max_attempts",label:Object(r.jsx)(o.a,{id:"max_attempts"}),tooltip:Object(r.jsx)(o.a,{id:"max_attempts"}),placeholder:ge.formatMessage({id:"max_attempts",defaultMessage:"max_attempts"})}),Object(r.jsx)(Qe.a,{name:"max_execution_time",label:Object(r.jsx)(o.a,{id:"max_execution_time"}),tooltip:Object(r.jsx)(o.a,{id:"max_execution_time"}),placeholder:ge.formatMessage({id:"max_execution_time",defaultMessage:"max_execution_time"})})]})}),Object(r.jsx)(ze.a,{}),Object(r.jsx)(He.a,{questions:Oe.questions,quizId:Oe.id,onAdded:he,onEdited:he,onRemoved:he,tableHeader:Object(r.jsx)(o.a,{id:"questions"}),tableLoading:te,questionsCategory:{type:"question"}})]}):Object(r.jsx)(Q.a,{})},Xe=function(){var Z,b=Object(V.b)(),ee=b.competencyChallenge,A=Object(o.l)(),te=Object($.l)(),K=te.id,ce=te.tab,ye=ce===void 0?"main":ce,Oe=K==="new",ue=Object(O.useMemo)(function(){var ge;return Oe?A.formatMessage({id:"CompetencyChallenges.new_challenge"}):(ge=ee.data)!==null&&ge!==void 0&&ge.name?ee.data.name:A.formatMessage({id:"menu.Competency challenges"})},[A,(Z=ee.data)===null||Z===void 0?void 0:Z.name]);return Object(r.jsx)(ve.a,{title:ue,header:{breadcrumb:{routes:[{path:"competency-challenges",breadcrumbName:A.formatMessage({id:"menu.Competency challenges"})},{path:String(K),breadcrumbName:ue},{path:ye,breadcrumbName:A.formatMessage({id:"CompetencyChallenges.".concat(ye)})}]}},children:Object(r.jsxs)(G.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",cardProps:{loading:ee.loading&&Object(r.jsx)(Q.a,{})},activeKey:ye,onChange:function(he){o.f.push("/competency-challenges/".concat(K,"/").concat(he))}},children:[Object(r.jsx)(G.a.TabPane,{tab:Object(r.jsx)(o.a,{id:"CompetencyChallenges.main"}),children:Object(r.jsx)(Ee,{})},"main"),Object(r.jsx)(G.a.TabPane,{tab:Object(r.jsx)(o.a,{id:"CompetencyChallenges.scales"}),disabled:Oe,children:Object(r.jsx)(Ke,{})},"scales"),Object(r.jsx)(G.a.TabPane,{tab:Object(r.jsx)(o.a,{id:"CompetencyChallenges.diagnostic-test"}),disabled:Oe,children:Object(r.jsx)(oe,{})},"diagnostic-test")]})})},nt=function(){return Object(r.jsx)(V.a,{children:Object(r.jsx)(Xe,{})})},st=M.default=nt},YRX9:function(Ue,M,e){"use strict";e.d(M,"f",function(){return $}),e.d(M,"e",function(){return G}),e.d(M,"a",function(){return I}),e.d(M,"g",function(){return F}),e.d(M,"c",function(){return D}),e.d(M,"b",function(){return y}),e.d(M,"h",function(){return w}),e.d(M,"d",function(){return k});var p=e("qLMh"),Q=e("k1fw"),O=e("9og8"),o=e("9kvl");function $(E,f){return ve.apply(this,arguments)}function ve(){return ve=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges",Object(Q.a)({method:"GET",useCache:!1,params:f},x||{})));case 1:case"end":return j.stop()}},E)})),ve.apply(this,arguments)}function G(E,f){return V.apply(this,arguments)}function V(){return V=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges/".concat(f),Object(Q.a)({method:"GET",useCache:!1},x||{})));case 1:case"end":return j.stop()}},E)})),V.apply(this,arguments)}function I(E,f){return _.apply(this,arguments)}function _(){return _=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges",Object(Q.a)({method:"POST",headers:{"Content-Type":"application/json"},data:f},x||{})));case 1:case"end":return j.stop()}},E)})),_.apply(this,arguments)}function F(E,f,x){return c.apply(this,arguments)}function c(){return c=Object(O.a)(Object(p.a)().mark(function E(f,x,U){return Object(p.a)().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.abrupt("return",Object(o.i)("/api/admin/competency-challenges/".concat(f),Object(Q.a)({method:"PUT",headers:{"Content-Type":"application/json"},data:x},U||{})));case 1:case"end":return N.stop()}},E)})),c.apply(this,arguments)}function D(E,f){return C.apply(this,arguments)}function C(){return C=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges/".concat(f),Object(Q.a)({method:"DELETE"},x||{})));case 1:case"end":return j.stop()}},E)})),C.apply(this,arguments)}function y(E,f){return n.apply(this,arguments)}function n(){return n=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges/scales",Object(Q.a)({method:"POST",headers:{"Content-Type":"application/json"},data:f},x||{})));case 1:case"end":return j.stop()}},E)})),n.apply(this,arguments)}function w(E,f,x){return W.apply(this,arguments)}function W(){return W=Object(O.a)(Object(p.a)().mark(function E(f,x,U){return Object(p.a)().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.abrupt("return",Object(o.i)("/api/admin/competency-challenges/scales/".concat(f),Object(Q.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:x},U||{})));case 1:case"end":return N.stop()}},E)})),W.apply(this,arguments)}function k(E,f){return Y.apply(this,arguments)}function Y(){return Y=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges/scales/".concat(f),Object(Q.a)({method:"DELETE"},x||{})));case 1:case"end":return j.stop()}},E)})),Y.apply(this,arguments)}},enqX:function(Ue,M,e){"use strict";e.d(M,"a",function(){return c});var p=e("nRaC"),Q=e("5RzL"),O=e("tJVT"),o=e("q1tI"),$=e.n(o),ve=e("9kvl"),G=e("JifO"),V=e("tKSU"),I=e("nKUr"),_=e.n(I),F=function D(C,y,n){var w,W=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return(w=C.subcategories)!==null&&w!==void 0&&w.length?{title:C.name,value:C.id,disabled:W!==n||y.includes(C.id),children:C.subcategories.map(function(k){return D(k,y,n,W+1)})}:{title:C.name,value:C.id,disabled:W!==n||y.includes(C.id)}},c=function(C){var y,n,w,W=C.value,k=C.onChange,Y=C.type,E=Y===void 0?"scale":Y,f=C.disabledNodes,x=f===void 0?[]:f,U=Object(o.useState)([]),j=Object(O.a)(U,2),N=j[0],r=j[1],ie=Object(V.b)(),fe=ie.categoryDepths,Ee=ie.competencyChallenge,Me=Object(o.useMemo)(function(){var X;return((X=Ee.data)===null||X===void 0?void 0:X.type)==="simple"?N.filter(function(Se){var P,B;return Se.id===((P=Ee.data)===null||P===void 0||(B=P.category)===null||B===void 0?void 0:B.id)}):N},[N,(y=Ee.data)===null||y===void 0?void 0:y.type,(n=Ee.data)===null||n===void 0||(w=n.category)===null||w===void 0?void 0:w.id]),T=Object(o.useMemo)(function(){return Me.map(function(X){return F(X,x,fe[E])})},[Me,x,E]);return Object(o.useEffect)(function(){Object(G.c)().then(function(X){X.success&&r(X.data)})},[]),Object(I.jsx)(Q.a,{loading:N.length===0,showSearch:!0,value:W,dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:Object(I.jsx)(ve.a,{id:"select",defaultMessage:"Please select"}),allowClear:!0,treeDefaultExpandAll:!0,onChange:k,treeData:T,disabled:N.length===0})}},hd5d:function(Ue,M,e){"use strict";var p=e("qLMh"),Q=e("9og8"),O=e("q1tI"),o=e.n(O),$=e("acco"),ve=e.n($),G=e("BAh9"),V=e("vtG9"),I=e.n(V),_=e("9kvl"),F=e("nKUr"),c=e.n(F),D=function(n){var w=n.attrs,W=w.href,k=W.split("/").pop();return Object(F.jsx)("p",{children:Object(F.jsx)("a",{rel:"noreferrer",href:W,target:"_blank",children:k})})},C=function(n){var w=n.value,W=n.onChange,k=n.directory,Y=k===void 0?"/wysiwyg":k,E=Object(_.l)();return Object(F.jsx)("div",{className:"form-wysiwyg-markdown",children:Object(F.jsx)(ve.a,{excludeBlockMenuItems:["Sketch"],embeds:[{matcher:function(x){return!0},component:D}],uploadImage:function(){var f=Object(Q.a)(Object(p.a)().mark(function x(U){var j,N;return Object(p.a)().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,Object(G.e)(U,Y);case 2:if(j=ie.sent,!j.success){ie.next=8;break}if(!U.type.includes("image/")){ie.next=7;break}return N=j.data[0].name.includes("/")?j.data[0].name:"".concat(Y).concat(j.data[0].name),ie.abrupt("return",Object(G.d)(N,1e3));case 7:return ie.abrupt("return",j.data[0].url);case 8:throw new Error("Error while uploading");case 9:case"end":return ie.stop()}},x)}));return function(x){return f.apply(this,arguments)}}(),defaultValue:w||"",onChange:function(x){return W&&W(x())},placeholder:E.formatMessage({id:"wysiwyg_placeholder"})})})};M.a=C},tKSU:function(Ue,M,e){"use strict";e.d(M,"b",function(){return C}),e.d(M,"a",function(){return y});var p=e("k1fw"),Q=e("tJVT"),O=e("qLMh"),o=e("9og8"),$=e("q1tI"),ve=e.n($),G=e("Ty5D"),V=e("YRX9"),I=e("+up7"),_=e("nKUr"),F=e.n(_),c={categoryDepths:{scale:2,question:1,role:0},competencyChallenge:{data:null,loading:!1},refreshData:function(){var n=Object(o.a)(Object(O.a)().mark(function W(){return Object(O.a)().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.abrupt("return",console.warn("CONTEXT INIT"));case 1:case"end":return Y.stop()}},W)}));function w(){return n.apply(this,arguments)}return w}()},D=ve.a.createContext(c),C=function(){return Object($.useContext)(D)},y=function(w){var W=w.children,k=Object($.useState)(c.competencyChallenge),Y=Object(Q.a)(k,2),E=Y[0],f=Y[1],x=Object($.useState)(c.categoryDepths),U=Object(Q.a)(x,2),j=U[0],N=U[1],r=Object(G.l)(),ie=r.id,fe=Number(ie),Ee=Object($.useCallback)(Object(o.a)(Object(O.a)().mark(function T(){var X;return Object(O.a)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(!Number.isNaN(fe)){P.next=2;break}return P.abrupt("return");case 2:return P.prev=2,f(function(B){return Object(p.a)(Object(p.a)({},B),{},{loading:!0})}),P.next=6,Object(V.e)(fe);case 6:if(X=P.sent,X.success){P.next=10;break}return f(function(B){return Object(p.a)(Object(p.a)({},B),{},{error:X.errors})}),P.abrupt("return");case 10:f(function(B){return Object(p.a)(Object(p.a)({},B),{},{data:X.data})}),P.next=16;break;case 13:P.prev=13,P.t0=P.catch(2),f(function(B){return Object(p.a)(Object(p.a)({},B),{},{error:P.t0})});case 16:return P.prev=16,f(function(B){return Object(p.a)(Object(p.a)({},B),{},{loading:!1})}),P.finish(16);case 19:case"end":return P.stop()}},T,null,[[2,13,16,19]])})),[fe]),Me=Object($.useCallback)(Object(o.a)(Object(O.a)().mark(function T(){var X,Se,P,B,be,Le,Ne,We,t,Ie,Be,Ke,Je,ze,Ve,Re,Ge,Qe,He;return Object(O.a)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.prev=0,oe.next=3,Object(I.a)();case 3:if(Re=oe.sent,Re.success){oe.next=6;break}return oe.abrupt("return");case 6:Ge=Number((X=Re.data)===null||X===void 0||(Se=X.escolalms_competency_challenge)===null||Se===void 0||(P=Se.category)===null||P===void 0||(B=P.scale)===null||B===void 0||(be=B.depth)===null||be===void 0?void 0:be.value),Qe=Number((Le=Re.data)===null||Le===void 0||(Ne=Le.escolalms_competency_challenge)===null||Ne===void 0||(We=Ne.category)===null||We===void 0||(t=We.question)===null||t===void 0||(Ie=t.depth)===null||Ie===void 0?void 0:Ie.value),He=Number((Be=Re.data)===null||Be===void 0||(Ke=Be.escolalms_competency_challenge)===null||Ke===void 0||(Je=Ke.category)===null||Je===void 0||(ze=Je.role)===null||ze===void 0||(Ve=ze.depth)===null||Ve===void 0?void 0:Ve.value),N({scale:Number.isNaN(Ge)?2:Ge,question:Number.isNaN(Qe)?1:Qe,role:Number.isNaN(He)?0:He}),oe.next=15;break;case 12:oe.prev=12,oe.t0=oe.catch(0),console.error(oe.t0);case 15:case"end":return oe.stop()}},T,null,[[0,12]])})),[]);return Object($.useEffect)(function(){Ee(),Me()},[Ee,Me]),Object(_.jsx)(D.Provider,{value:{categoryDepths:j,competencyChallenge:E,refreshData:Ee},children:W})}},vtG9:function(Ue,M,e){},yioT:function(Ue,M,e){"use strict";e.d(M,"a",function(){return S});var p=e("tU7J"),Q=e("wFql"),O=e("BoS7"),o=e("Sdc0"),$=e("oBTY"),ve=e("+L6B"),G=e("2/Rp"),V=e("bbsP"),I=e("/wGt"),_=e("qLMh"),F=e("9og8"),c=e("PpiC"),D=e("tJVT"),C=e("k1fw"),y=e("q1tI"),n=e("9kvl"),w=e("YJCA"),W=e("wYyv"),k=e("smpX"),Y=e("eyie"),E=e("w5pM"),f=e("mWMg"),x=e("Vpfc"),U=e("qRSf"),j=e("DYRE"),N=e("zeV3"),r=e("/zsF"),ie=e("PArb"),fe=e("VMEa"),Ee=e("yj/a"),Me=e("FJDo"),T=e("/y+f"),X=e("enqX"),Se=e("5Dmo"),P=e("3S7+"),B=e("jrin"),be=e("Qurx"),Le=e("x1Ii"),Ne=e("tneF"),We=e("/MfK"),t=e("nKUr"),Ie,Be=(Ie={},Object(B.a)(Ie,T.d.MULTIPLE_CHOICE,[{isCorrect:!1,value:""},{isCorrect:!1,value:""}]),Object(B.a)(Ie,T.d.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS,[{value:"",weight:""},{value:"",weight:""}]),Ie),Ke=function(a){var i,s=a.type,d=Object(n.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(be.a,{name:"question",label:Object(t.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Le.b,{name:"answers",creatorButtonProps:{creatorButtonText:d.formatMessage({id:"Questions.addAnswer"})},actionRender:function(){return[]},initialValue:(i=Be[s])!==null&&i!==void 0?i:[],children:function(v,h,L,u){return Object(t.jsxs)(fe.a.Group,{title:Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(n.a,{id:"Questions.answer",values:{ordinalNumber:h+1}}),u>2&&Object(t.jsx)(P.a,{title:d.formatMessage({id:"Questions.deleteAnswer"}),children:Object(t.jsx)(G.a,{type:"text",icon:Object(t.jsx)(We.a,{}),onClick:function(){return L.remove(v.name)}})})]}),titleStyle:{width:"100%",display:"flex",justifyContent:"space-between"},children:[s===T.d.MULTIPLE_CHOICE&&Object(t.jsx)(Ne.a,{name:"isCorrect",label:Object(t.jsx)(n.a,{id:"Questions.correctAnswer",defaultMessage:"Is Correct Answer?"}),rules:[function(R){var se=R.getFieldValue;return{validator:function(){var me,we=(me=se("answers"))!==null&&me!==void 0?me:[];return we.filter(function(xe){return xe==null?void 0:xe.isCorrect}).length>1?Promise.reject("Only one answer can be correct"):Promise.resolve()},message:Object(t.jsx)(n.a,{id:"Questions.onlyOneAnswerIsCorrect"})}}]}),Object(t.jsx)(be.a,{name:"value",rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],label:Object(t.jsx)(n.a,{id:"content",defaultMessage:"Content"})}),s===T.d.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS&&Object(t.jsx)(Me.a,{name:"weight",rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],fieldProps:{min:-Number.MAX_SAFE_INTEGER,addonAfter:"%"},label:Object(t.jsx)(n.a,{id:"weight",defaultMessage:"Weight"})})]})}})]})},Je=function(){return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(be.a,{name:"question",label:Object(t.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Ne.a,{name:"isCorrect",label:Object(t.jsx)(n.a,{id:"Questions.correctAnswer"})})]})},ze=[{value:""}],Ve=function(){var a=Object(n.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(be.a,{name:"question",label:Object(t.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Le.b,{name:"answers",creatorButtonProps:{creatorButtonText:a.formatMessage({id:"Questions.addAnswer"})},deleteIconProps:{tooltipText:a.formatMessage({id:"Questions.deleteAnswer"})},actionRender:function(s,d,m){var v=Object(D.a)(m,2),h=v[1];return[h]},min:1,initialValue:ze,children:function(s,d){return Object(t.jsx)(be.a,{name:"value",rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],label:Object(t.jsx)(n.a,{id:"Questions.answer",values:{ordinalNumber:d+1},defaultMessage:"Answer ".concat(d+1)})})}})]})},Re=[{firstOfPair:"",secondOfPair:""}],Ge=function(){var a=Object(n.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(be.a,{name:"question",label:Object(t.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Le.b,{name:"answers",creatorButtonProps:{creatorButtonText:a.formatMessage({id:"Questions.addMatchingPair",defaultMessage:"Add Matching Pair"})},deleteIconProps:{tooltipText:a.formatMessage({id:"Questions.deletePair"})},actionRender:function(s,d,m){var v=Object(D.a)(m,2),h=v[1];return[h]},min:1,initialValue:Re,children:function(s,d){return Object(t.jsxs)(fe.a.Group,{direction:"horizontal",align:"baseline",size:"small",spaceProps:{style:{flexWrap:"nowrap"}},title:Object(t.jsx)(n.a,{id:"Questions.pair",values:{ordinalNumber:d+1},defaultMessage:"Pair ".concat(d+1)}),children:[Object(t.jsx)(be.a,{name:"firstOfPair",rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}]}),Object(t.jsx)(be.a,{name:"secondOfPair",rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}]})]})}})]})},Qe=function(){return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(be.a,{name:"question",label:Object(t.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Me.a,{name:"answer",label:Object(t.jsx)(n.a,{id:"answer"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Me.a,{name:"errorMargin",fieldProps:{addonAfter:"+/-"},label:Object(t.jsx)(n.a,{id:"Questions.errorMargin"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],required:!0})]})},He=e("BiO0"),ke=function(){return Object(t.jsx)(He.a,{name:"question",label:Object(t.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],required:!0})},oe=function(a){var i=a.type;if(!i)return null;switch(i){case T.d.MULTIPLE_CHOICE:case T.d.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return Object(t.jsx)(Ke,{type:i});case T.d.TRUE_FALSE:return Object(t.jsx)(Je,{});case T.d.SHORT_ANSWERS:return Object(t.jsx)(Ve,{});case T.d.MATCHING:return Object(t.jsx)(Ge,{});case T.d.NUMERICAL_QUESTION:return Object(t.jsx)(Qe,{});case T.d.ESSAY:case T.d.DESCRIPTION:return Object(t.jsx)(ke,{})}return Object(t.jsxs)("pre",{children:["Unsupported type ",i]})},Xe=e("rAM+"),nt=function(a){var i=a.question,s=a.answers;if(s.length===0)return"".concat(i,"{}");var d="".concat(i,"{"),m=Object(Xe.a)(s),v;try{for(m.s();!(v=m.n()).done;){var h=v.value,L=h.isCorrect,u=h.value,R=L?"=":"~";d+="".concat(R).concat(u)}}catch(se){m.e(se)}finally{m.f()}return d+="}",d.trim()},st=function(a){var i=a.question,s=a.answers;if(s.length==0)return"".concat(i,"{}");var d="".concat(i,"{"),m=Object(Xe.a)(s),v;try{for(m.s();!(v=m.n()).done;){var h=v.value,L=h.value,u=h.weight;d+="~%".concat(u,"%").concat(L)}}catch(R){m.e(R)}finally{m.f()}return d+="}",d.trim()},pe=function(a){var i=a.question,s=a.isCorrect;return"".concat(i,"{").concat(s?"T":"F","}")},Z=function(a){var i=a.question,s=a.answers;if(s.length===0)return"".concat(i,"{}");var d="".concat(i,"{"),m=Object(Xe.a)(s),v;try{for(m.s();!(v=m.n()).done;){var h=v.value,L=h.value;d+="=".concat(L)}}catch(u){m.e(u)}finally{m.f()}return d+="}",d.trim()},b=function(a){var i=a.question,s=a.answers;if(s.length===0)return"".concat(i,"{}");var d="".concat(i,"{"),m=Object(Xe.a)(s),v;try{for(m.s();!(v=m.n()).done;){var h=v.value,L=h.firstOfPair,u=h.secondOfPair;d+="=".concat(L,"->").concat(u)}}catch(R){m.e(R)}finally{m.f()}return d+="}",d.trim()},ee=function(a){var i=a.question,s=a.answer,d=a.errorMargin;return"".concat(i,"{#").concat(s,":").concat(d,"}")},A=function(a){var i=a.question;return"".concat(i,"{}")},te=function(a){var i=a.question;return i},K=function(a){switch(a.type){case T.d.MULTIPLE_CHOICE:return nt(a);case T.d.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return st(a);case T.d.TRUE_FALSE:return pe(a);case T.d.SHORT_ANSWERS:return Z(a);case T.d.MATCHING:return b(a);case T.d.NUMERICAL_QUESTION:return ee(a);case T.d.ESSAY:return A(a);case T.d.DESCRIPTION:return te(a);default:throw new Error("Unsupported type: ".concat(a.type))}},ce=function(a,i){var s=i.type,d=i.score,m=i.category_id,v=a==null?void 0:a.stem.text,h=a.choices.every(function(R){var se=R.weight;return se===null});if(h){var L=a.choices.map(function(R){var se=R.isCorrect,$e=R.text;return{isCorrect:se,value:$e.text}});return{type:s,score:d,category_id:m,question:v,answers:L}}var u=a.choices.reduce(function(R,se){var $e=se.weight,me=se.text;return $e!==null?[].concat(Object($.a)(R),[{weight:$e,value:me.text}]):R},[]);return{type:s,score:d,category_id:m,question:v,answers:u}},ye=function(a,i){var s=i.type,d=i.score,m=i.category_id,v=a==null?void 0:a.stem.text,h=a.isTrue;return{type:s,score:d,category_id:m,question:v,isCorrect:h}},Oe=function(a,i){var s=i.type,d=i.score,m=i.category_id,v=a==null?void 0:a.stem.text,h=a.choices.map(function(L){var u=L.text;return{value:u.text}});return{type:s,score:d,category_id:m,question:v,answers:h}},ue=function(a,i){var s=i.type,d=i.score,m=i.category_id,v=a==null?void 0:a.stem.text,h=a.matchPairs.map(function(L){var u=L.subquestion,R=L.subanswer;return{firstOfPair:u.text,secondOfPair:R}});return{type:s,score:d,category_id:m,question:v,answers:h}},ge=function(a,i){var s=i.type,d=i.score,m=i.category_id,v=a==null?void 0:a.stem.text;if(Array.isArray(a==null?void 0:a.choices))throw new Error("Unsupported choices type: array");var h=a==null?void 0:a.choices.number,L=a==null?void 0:a.choices.range;if(h===void 0||L===void 0)throw new Error("Value undefined - answer: ".concat(h," errorMargin: ").concat(L));return{type:s,score:d,category_id:m,question:v,answer:h,errorMargin:L}},he=function(a,i){var s=i.type,d=i.score,m=i.category_id,v=a==null?void 0:a.stem.text;return{type:s,score:d,category_id:m,question:v}};function _e(l){if(!!l){var a=Object(k.parse)(l.value),i=Object(D.a)(a,1),s=i[0];switch(s.type){case"MC":return ce(s,l);case"TF":return ye(s,l);case"Short":return Oe(s,l);case"Matching":return ue(s,l);case"Numerical":return ge(s,l);case"Description":case"Essay":return he(s,l);default:throw new Error("Unsupported type: ".concat(s==null?void 0:s.type))}}}var Ce=["type","score","category"],Fe=Object.values(T.d).reduce(function(l,a){return a?[].concat(Object($.a)(l),[{value:a,label:Object(t.jsx)(n.a,{id:"gift_type.".concat(a)})}]):l},[]),ae=function(a){var i=a.onSubmit,s=a.values,d=a.competencyChallengeCategoryTreeProps,m=d===void 0?!1:d,v=Object(n.l)(),h=fe.a.useForm(),L=Object(D.a)(h,1),u=L[0],R=fe.a.useWatch("type",u),se=Object(y.useMemo)(function(){return _e(s)},[s]),$e=Object(y.useCallback)(function(){var me=Object(F.a)(Object(_.a)().mark(function we(xe){var et,Ze,at,tt;return Object(_.a)().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return et=K(xe),Ze=xe.score,at=xe.category_id,Te.next=4,i({value:et,score:Ze,category_id:at});case 4:if(tt=Te.sent,tt){Te.next=7;break}return Te.abrupt("return");case 7:u.resetFields();case 8:case"end":return Te.stop()}},we)}));return function(we){return me.apply(this,arguments)}}(),[]);return Object(y.useEffect)(function(){u.resetFields()},[se]),Object(y.useEffect)(function(){if(R){var me=u.getFieldsValue(),we=Object.keys(me).filter(function(xe){return!Ce.includes(xe)});u.resetFields(we)}},[R]),Object(t.jsxs)(N.b,{direction:"vertical",style:{display:"flex"},children:[Object(t.jsx)(ie.a,{children:Object(t.jsx)(n.a,{id:se?"Questions.edit":"addNewQuestion"})}),Object(t.jsxs)(fe.a,{layout:"horizontal",form:u,onFinish:$e,initialValues:se,children:[Object(t.jsx)(Ee.a,{name:"type",placeholder:v.formatMessage({id:"selectNewQuestionType",defaultMessage:"Select new question type"}),label:Object(t.jsx)(n.a,{id:"type",defaultMessage:"Type:"}),options:Fe,rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(oe,{type:R}),Object(t.jsx)(Me.a,{name:"score",label:Object(t.jsx)(n.a,{id:"Questions.score",defaultMessage:"Score"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}]}),m&&Object(t.jsx)(fe.a.Item,{name:"category_id",label:Object(t.jsx)(n.a,{id:"category",defaultMessage:"Category"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"field_required"})}],required:!0,children:Object(t.jsx)(X.a,Object(C.a)({},typeof m=="object"?m:{}))})]})]})},H=e("60mZ"),z=["className","style"],J=Object(w.c)(function(){return Object(t.jsx)(Y.a,{style:{cursor:"grab",color:"#999"}})}),re=Object(w.b)(function(l){return Object(t.jsx)("tr",Object(C.a)({},l))}),ne=Object(w.a)(function(l){return Object(t.jsx)("tbody",Object(C.a)({},l))}),le=[{title:Object(t.jsx)(n.a,{id:"sort",defaultMessage:"sort"}),dataIndex:"id",width:60,className:"drag-visible",render:function(){return Object(t.jsx)(J,{})}},{title:Object(t.jsx)(n.a,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,i){return Object(t.jsx)(n.a,{id:"gift_type.".concat(i.type)})}},{title:Object(t.jsx)(n.a,{id:"question",defaultMessage:"Question"}),dataIndex:"question",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,i){var s=Object(k.parse)(i.value);return s!=null&&s[0]&&"stem"in s[0]?s[0].stem.text:"question"}}],de={title:Object(t.jsx)(n.a,{id:"category",defaultMessage:"Category"}),dataIndex:"category_id",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,i){return typeof i.category_id=="number"?Object(t.jsx)(x.a,{type:"Category",type_id:i.category_id}):"-"}},S=function(a){var i=a.questions,s=a.onAdded,d=a.onRemoved,m=a.onEdited,v=a.quizId,h=a.tableLoading,L=a.tableHeader,u=a.questionsCategory,R=Object(y.useState)(!1),se=Object(D.a)(R,2),$e=se[0],me=se[1],we=Object(y.useState)(!1),xe=Object(D.a)(we,2),et=xe[0],Ze=xe[1],at=Object(y.useState)(),tt=Object(D.a)(at,2),De=tt[0],Te=tt[1],lt=Object(y.useState)(!1),it=Object(D.a)(lt,2),ut=it[0],dt=it[1],mt=Object(y.useState)(i),ct=Object(D.a)(mt,2),rt=ct[0],ot=ct[1],jt=Object(y.useRef)();Object(y.useEffect)(function(){var je;(je=jt.current)===null||je===void 0||je.reload(),ot(i)},[i]);var vt=function(q){var Ae=q.oldIndex,Pe=q.newIndex;if(Ae!==Pe){var Ye=Object(W.a)(rt.slice(),Ae,Pe).filter(Boolean).map(function(g,qe){return Object(C.a)(Object(C.a)({},g),{},{order:qe})});Ye.forEach(function(g,qe){g.id!==rt[qe].id&&Object(U.g)(g.id,Object(C.a)(Object(C.a)({},g),{},{order:qe+1,topic_gift_quiz_id:v}))}),ot(Ye)}},bt=function(q){return Object(t.jsx)(ne,Object(C.a)({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:vt},q))},ft=function(q){var Ae=q.className,Pe=q.style,Ye=Object(c.a)(q,z),g=rt.findIndex(function(qe){return qe.id===Ye["data-row-key"]});return Object(t.jsx)(re,Object(C.a)({index:g},Ye))},Ot=Object(y.useCallback)(function(){var je=Object(F.a)(Object(_.a)().mark(function q(Ae){var Pe;return Object(_.a)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,me(!0),g.next=4,Object(U.a)(Object(C.a)({topic_gift_quiz_id:v},Ae));case 4:return Pe=g.sent,Ze(!1),s==null||s(),g.abrupt("return",Pe.success);case 10:return g.prev=10,g.t0=g.catch(0),console.log(g.t0),g.abrupt("return",!1);case 14:return g.prev=14,me(!1),g.finish(14);case 17:case"end":return g.stop()}},q,null,[[0,10,14,17]])}));return function(q){return je.apply(this,arguments)}}(),[et,v]),gt=Object(y.useCallback)(function(){var je=Object(F.a)(Object(_.a)().mark(function q(Ae){var Pe;return Object(_.a)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if((De==null?void 0:De.id)!==void 0){g.next=2;break}return g.abrupt("return",!1);case 2:return g.prev=2,me(!0),g.next=6,Object(U.g)(De.id,Object(C.a)({topic_gift_quiz_id:v},Ae));case 6:return Pe=g.sent,Te(void 0),m==null||m(),g.abrupt("return",Pe.success);case 12:return g.prev=12,g.t0=g.catch(2),console.log(g.t0),g.abrupt("return",!1);case 16:return g.prev=16,me(!1),g.finish(16);case 19:case"end":return g.stop()}},q,null,[[2,12,16,19]])}));return function(q){return je.apply(this,arguments)}}(),[De==null?void 0:De.id,v]);return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(I.a,{open:et,onClose:function(){return Ze(!1)},children:Object(t.jsx)(ae,{onSubmit:Ot,competencyChallengeCategoryTreeProps:u})}),Object(t.jsx)(I.a,{open:!!De,onClose:function(){return Te(void 0)},children:Object(t.jsx)(ae,{onSubmit:gt,competencyChallengeCategoryTreeProps:u,values:De})}),Object(t.jsx)(f.a,{search:!1,cardProps:{bodyStyle:{padding:0}},loading:h,headerTitle:L,toolbar:{settings:[]},toolBarRender:function(){return[Object(t.jsxs)(G.a,{icon:Object(t.jsx)(E.a,{}),type:"primary",onClick:function(){return Ze(!0)},children:[" ",Object(t.jsx)(n.a,{id:"addNewQuestion",defaultMessage:"Add new question"})]},"add")]},columns:[].concat(le,Object($.a)(u?[de]:[]),[{title:Object(t.jsx)(n.a,{id:"actions",defaultMessage:"Actions"}),dataIndex:"address",valueType:"option",render:function(q,Ae){return[Object(t.jsx)(G.a,{size:"small",type:"primary",onClick:function(){Te(Ae)},children:Object(t.jsx)(n.a,{id:"Questions.edit",defaultMessage:"Edit Question"})},"edit"),Object(t.jsx)(G.a,{loading:$e,size:"small",danger:!0,onClick:function(){me(!0),Object(U.b)(Ae.id).then(function(){d&&d()}).finally(function(){me(!1)})},children:Object(t.jsx)(n.a,{id:"Questions.delete",defaultMessage:"Delete Question"})},"delete")]}}]),rowKey:function(q){return q.id},pagination:!1,dataSource:rt,components:{body:{wrapper:bt,row:ft}}}),Object(t.jsxs)(Q.a,{style:{marginTop:"3em"},children:["Debug GIFT: ",Object(t.jsx)(o.a,{checked:ut,onChange:function(q){return dt(q)}})]})]})}}}]);

//# sourceMappingURL=p__CompetencyChallenges__form.3b8bcef4.async.js.map