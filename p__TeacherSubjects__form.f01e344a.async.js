"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7937,2803],{56717:function(St,Je,u){var ze=u(1413),m=u(67294),He=u(93696),Te=u(84089),_e=function(g,v){return m.createElement(Te.Z,(0,ze.Z)((0,ze.Z)({},g),{},{ref:v,icon:He.Z}))},W=m.forwardRef(_e);Je.Z=W},78677:function(St,Je,u){var ze=u(67294),m=u(64585),He=function(){return He=Object.assign||function(_e){for(var W,$e=1,g=arguments.length;$e<g;$e++){W=arguments[$e];for(var v in W)Object.prototype.hasOwnProperty.call(W,v)&&(_e[v]=W[v])}return _e},He.apply(this,arguments)},Te=function(_e){return ze.createElement(m.P,He({},_e,{chartType:"Column"}))};Je.Z=Te},88280:function(St,Je,u){u.d(Je,{Z:function(){return ue}});var ze=u(4942),m=u(97685),He=u(45987),Te=u(74165),_e=u(15861),W=u(1413),$e=u(87462),g=u(67294),v=u(42110),s=u(78026),ee=function(T,e){return g.createElement(s.Z,(0,$e.Z)({},T,{ref:e,icon:v.Z}))},d=g.forwardRef(ee),P=d,i=u(97462),b=u(952),I=u(10915),ae=u(48171),Z=u(53914),H=u(22270),ie=u(60249),De=u(14726),ne=u(75842),pt=u(21770),nt=u(88306),gt=u(8880),xt=u(72717),Fe=u(85893),yt=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],jt=["record","position","creatorButtonText","newRecordType","parentKey","style"],be=g.createContext(void 0);function C(j){var T=j.children,e=j.record,Ee=j.position,Pe=j.newRecordType,oe=j.parentKey,Oe=(0,g.useContext)(be);return g.cloneElement(T,(0,W.Z)((0,W.Z)({},T.props),{},{onClick:function(){var Ue=(0,_e.Z)((0,Te.Z)().mark(function Se(Be){var We,Le,he,le;return(0,Te.Z)().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(We=(Le=T.props).onClick)===null||We===void 0?void 0:We.call(Le,Be);case 2:if(le=O.sent,le!==!1){O.next=5;break}return O.abrupt("return");case 5:Oe==null||(he=Oe.current)===null||he===void 0||he.addEditRecord(e,{position:Ee,newRecordType:Pe,parentKey:oe});case 6:case"end":return O.stop()}},Se)}));function xe(Se){return Ue.apply(this,arguments)}return xe}()}))}function me(j){var T,e,Ee=(0,I.YB)(),Pe=j.onTableChange,oe=j.maxLength,Oe=j.formItemProps,Ue=j.recordCreatorProps,xe=j.rowKey,Se=j.controlled,Be=j.defaultValue,We=j.onChange,Le=j.editableFormRef,he=(0,He.Z)(j,yt),le=(0,g.useRef)(void 0),de=(0,g.useRef)(),O=(0,g.useRef)();(0,g.useImperativeHandle)(he.actionRef,function(){return de.current},[de.current]);var D=(0,pt.Z)(function(){return j.value||Be||[]},{value:j.value,onChange:j.onChange}),ye=(0,m.Z)(D,2),fe=ye[0],_t=ye[1],st=g.useMemo(function(){return typeof xe=="function"?xe:function(R,re){return R[xe]||re}},[xe]),lt=(0,ae.J)(function(R){if(typeof R=="number"&&!j.name){if(R>=fe.length)return R;var re=fe&&fe[R];return st==null?void 0:st(re,R)}if((typeof R=="string"||R>=fe.length)&&j.name){var ce=fe.findIndex(function(pe,ge){var Ze;return(st==null||(Ze=st(pe,ge))===null||Ze===void 0?void 0:Ze.toString())===(R==null?void 0:R.toString())});if(ce!==-1)return ce}return R});(0,g.useImperativeHandle)(Le,function(){var R=function(pe){var ge,Ze;if(pe==null)throw new Error("rowIndex is required");var Ke=lt(pe),Ae=[j.name,(ge=Ke==null?void 0:Ke.toString())!==null&&ge!==void 0?ge:""].flat(1).filter(Boolean);return(Ze=O.current)===null||Ze===void 0?void 0:Ze.getFieldValue(Ae)},re=function(){var pe,ge=[j.name].flat(1).filter(Boolean);if(Array.isArray(ge)&&ge.length===0){var Ze,Ke=(Ze=O.current)===null||Ze===void 0?void 0:Ze.getFieldsValue();return Array.isArray(Ke)?Ke:Object.keys(Ke).map(function(Ae){return Ke[Ae]})}return(pe=O.current)===null||pe===void 0?void 0:pe.getFieldValue(ge)};return(0,W.Z)((0,W.Z)({},O.current),{},{getRowData:R,getRowsData:re,setRowData:function(pe,ge){var Ze,Ke;if(pe==null)throw new Error("rowIndex is required");var Ae=lt(pe),Et=[j.name,(Ze=Ae==null?void 0:Ae.toString())!==null&&Ze!==void 0?Ze:""].flat(1).filter(Boolean),Zt=Object.assign({},(0,W.Z)((0,W.Z)({},R(pe)),ge||{})),Nt=(0,gt.Z)({},Et,Zt);return(Ke=O.current)===null||Ke===void 0||Ke.setFieldsValue(Nt),!0}})},[lt,j.name,O.current]),(0,g.useEffect)(function(){j.controlled&&(fe||[]).forEach(function(R,re){var ce;(ce=O.current)===null||ce===void 0||ce.setFieldsValue((0,ze.Z)({},"".concat(st(R,re)),R))},{})},[(0,Z.ZP)(fe),j.controlled]),(0,g.useEffect)(function(){if(j.name){var R;O.current=j==null||(R=j.editable)===null||R===void 0?void 0:R.form}},[(T=j.editable)===null||T===void 0?void 0:T.form,j.name]);var et=Ue||{},Mt=et.record,Ct=et.position,Tt=et.creatorButtonText,Pt=et.newRecordType,Ft=et.parentKey,wt=et.style,N=(0,He.Z)(et,jt),J=Ct==="top",V=(0,g.useMemo)(function(){return typeof oe=="number"&&oe<=(fe==null?void 0:fe.length)?!1:Ue!==!1&&(0,Fe.jsx)(C,{record:(0,H.h)(Mt,fe==null?void 0:fe.length,fe)||{},position:Ct,parentKey:(0,H.h)(Ft,fe==null?void 0:fe.length,fe),newRecordType:Pt,children:(0,Fe.jsx)(De.ZP,(0,W.Z)((0,W.Z)({type:"dashed",style:(0,W.Z)({display:"block",margin:"10px 0",width:"100%"},wt),icon:(0,Fe.jsx)(P,{})},N),{},{children:Tt||Ee.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[Ue,oe,fe==null?void 0:fe.length]),z=(0,g.useMemo)(function(){return V?J?{components:{header:{wrapper:function(re){var ce,pe=re.className,ge=re.children;return(0,Fe.jsxs)("thead",{className:pe,children:[ge,(0,Fe.jsxs)("tr",{style:{position:"relative"},children:[(0,Fe.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:V}),(0,Fe.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(ce=he.columns)===null||ce===void 0?void 0:ce.length,children:V})]})]})}}}}:{tableViewRender:function(re,ce){var pe,ge;return(0,Fe.jsxs)(Fe.Fragment,{children:[(pe=(ge=j.tableViewRender)===null||ge===void 0?void 0:ge.call(j,re,ce))!==null&&pe!==void 0?pe:ce,V]})}}:{}},[J,V]),K=(0,W.Z)({},j.editable),Q=(0,ae.J)(function(R,re){var ce,pe,ge;if((ce=j.editable)===null||ce===void 0||(pe=ce.onValuesChange)===null||pe===void 0||pe.call(ce,R,re),(ge=j.onValuesChange)===null||ge===void 0||ge.call(j,re,R),j.controlled){var Ze;j==null||(Ze=j.onChange)===null||Ze===void 0||Ze.call(j,re)}});return(j!=null&&j.onValuesChange||(e=j.editable)!==null&&e!==void 0&&e.onValuesChange||j.controlled&&j!==null&&j!==void 0&&j.onChange)&&(K.onValuesChange=Q),(0,Fe.jsxs)(Fe.Fragment,{children:[(0,Fe.jsx)(be.Provider,{value:de,children:(0,Fe.jsx)(xt.Z,(0,W.Z)((0,W.Z)((0,W.Z)({search:!1,options:!1,pagination:!1,rowKey:xe,revalidateOnFocus:!1},he),z),{},{tableLayout:"fixed",actionRef:de,onChange:Pe,editable:(0,W.Z)((0,W.Z)({},K),{},{formProps:(0,W.Z)({formRef:O},K.formProps)}),dataSource:fe,onDataSourceChange:function(re){if(_t(re),j.name&&Ct==="top"){var ce,pe=(0,gt.Z)({},[j.name].flat(1).filter(Boolean),re);(ce=O.current)===null||ce===void 0||ce.setFieldsValue(pe)}}}))}),j.name?(0,Fe.jsx)(i.Z,{name:[j.name],children:function(re){var ce,pe;if(!le.current)return le.current=fe,null;var ge=(0,nt.Z)(re,[j.name].flat(1)),Ze=ge==null?void 0:ge.find(function(Ke,Ae){var Et;return!(0,ie.A)(Ke,(Et=le.current)===null||Et===void 0?void 0:Et[Ae])});return le.current=fe,Ze&&(j==null||(ce=j.editable)===null||ce===void 0||(pe=ce.onValuesChange)===null||pe===void 0||pe.call(ce,Ze,ge)),null}}):null]})}function L(j){var T=b.ZP.useFormInstance();return j.name?(0,Fe.jsx)(ne.Z.Item,(0,W.Z)((0,W.Z)({style:{maxWidth:"100%"}},j==null?void 0:j.formItemProps),{},{name:j.name,shouldUpdate:function(Ee,Pe){var oe=[j.name].flat(1);try{return JSON.stringify((0,nt.Z)(Ee,oe))!==JSON.stringify((0,nt.Z)(Pe,oe))}catch(Oe){return!0}},children:(0,Fe.jsx)(me,(0,W.Z)((0,W.Z)({},j),{},{editable:(0,W.Z)((0,W.Z)({},j.editable),{},{form:T})}))})):(0,Fe.jsx)(me,(0,W.Z)({},j))}L.RecordCreator=C;var ue=L},11312:function(St,Je,u){u.d(Je,{nu:function(){return T},rL:function(){return j},Du:function(){return ue}});var ze=u(9783),m=u.n(ze),He=u(97857),Te=u.n(He),_e=u(19632),W=u.n(_e),$e=u(5574),g=u.n($e),v=u(45919),s=u(66419),ee=u(78677),d=u(26271),P=u(78957),i=u(66309),b=u(72051),I=u(71230),ae=u(72269),Z=u(83863),H=u(60943),ie=u(67294),De=u(70804),ne=u(80854),pt=u(62235),nt=u(15009),gt=u.n(nt),xt=u(99289),Fe=u.n(xt),yt=u(58638),jt=u(14726),be=u(76841),C=u(85893),me=function(Ee){var Pe=Ee.course_id,oe=Ee.stat,Oe=oe===void 0?"EscolaLms\\Reports\\Stats\\Course\\FinishedTopics":oe,Ue=(0,ie.useState)(!1),xe=g()(Ue,2),Se=xe[0],Be=xe[1],We=(0,ie.useCallback)(function(Le){return Fe()(gt()().mark(function he(){var le,de;return gt()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return Be(!0),D.prev=1,D.next=4,(0,be._g)(Le,{stat:Oe});case 4:le=D.sent,le instanceof Blob&&(de=document.createElement("a"),de.href=window.URL.createObjectURL(le),de.download="finished_topics_".concat(Pe,".xlsx"),document.body.appendChild(de),de.click(),document.body.removeChild(de)),D.next=11;break;case 8:D.prev=8,D.t0=D.catch(1),console.error(D.t0);case 11:return D.prev=11,Be(!1),D.finish(11);case 14:case"end":return D.stop()}},he,null,[[1,8,11,14]])}))},[Oe]);return(0,C.jsxs)(jt.ZP,{type:"primary",loading:Se,onClick:We(Pe),children:[(0,C.jsx)(yt.Z,{})," ",(0,C.jsx)(ne.FormattedMessage,{id:"export"})]})},L=function(Ee){return Ee.topicable.content.contents?Object.values(Ee.topicable.content.contents)[0].library:"H5P"},ue=function(Ee){var Pe=Ee.course_id,oe=Ee.topics,Oe=Ee.stats,Ue=(0,ie.useState)(!1),xe=g()(Ue,2),Se=xe[0],Be=xe[1],We=(0,ie.useMemo)(function(){return[{title:(0,C.jsx)(ne.FormattedMessage,{id:"user"}),dataIndex:"id",render:function(le){return(0,C.jsx)(pt.Z,{type:"App\\Models\\User",type_id:le})}},{title:(0,C.jsx)(ne.FormattedMessage,{id:"email"}),dataIndex:"email"}].concat(W()(oe.map(function(he){var le,de=(le=he.topicable_type)===null||le===void 0?void 0:le.split("\\").pop();return de==="H5P"&&(de=L(he)),{render:function(D){var ye=0;switch(D&&(D.started_at&&D.finished_at?ye=1:D.started_at&&(ye=2)),ye){case 1:return(0,C.jsxs)(P.Z,{children:[(0,C.jsx)(i.Z,{color:"success",children:"F"}),Se&&(D==null?void 0:D.seconds)&&(0,C.jsx)("small",{children:(0,s.Im)(D.seconds)})]});case 2:return(0,C.jsxs)(P.Z,{children:[(0,C.jsx)(i.Z,{color:"blue",children:"S"}),Se&&(D==null?void 0:D.seconds)&&(0,C.jsx)("small",{children:(0,s.Im)(D.seconds)})]});case 0:default:return(0,C.jsx)(ie.Fragment,{children:(0,C.jsx)(i.Z,{color:"error",children:"N"})})}},title:(0,C.jsxs)("small",{children:[(0,C.jsx)(i.Z,{children:de})," ",he.title]}),dataIndex:he.id}})))},[oe,Se]),Le=(0,ie.useMemo)(function(){return Oe.map(function(he){return oe.reduce(function(le,de){var O=he.topics.find(function(D){return D.id===de.id});return Te()(Te()({},le),{},m()({},Number(de.id),O!=null?O:0))},{email:he.email,id:he.id})})},[Oe,oe]);return(0,C.jsx)(b.Z,{title:function(){return(0,C.jsxs)(I.Z,{justify:"space-between",align:"middle",children:[(0,C.jsxs)(P.Z,{children:[(0,C.jsx)(ne.FormattedMessage,{id:"Finished",defaultMessage:"Finished:"})," ",(0,C.jsx)(i.Z,{color:"success",children:"F"}),(0,C.jsx)(ne.FormattedMessage,{id:"Started",defaultMessage:"Started:"})," ",(0,C.jsx)(i.Z,{color:"blue",children:"S"}),(0,C.jsx)(ne.FormattedMessage,{id:"NotStarted",defaultMessage:"Not Started:"})," ",(0,C.jsx)(i.Z,{color:"error",children:"N"}),(0,C.jsx)(ne.FormattedMessage,{id:"ShowMinutes",defaultMessage:"Show minutes spent on topic:"})," ",(0,C.jsx)(ae.Z,{checked:Se,onChange:function(de){return Be(de)}})]}),(0,C.jsx)(me,{course_id:Pe})]})},columns:We,dataSource:Le,size:"small",scroll:{x:1500},components:{table:function(le){return(0,C.jsx)(De.Z,{horizontal:!0,style:{maxWidth:"auto"},hideScrollbars:!1,children:(0,C.jsx)("table",Te()({},le))})}}})},j=function(Ee){var Pe=Ee.stats,oe=Ee.attempts,Oe=(0,ie.useMemo)(function(){return[{title:(0,C.jsx)(ne.FormattedMessage,{id:"user"}),dataIndex:"id",render:function(Se){return(0,C.jsx)(pt.Z,{type:"App\\Models\\User",type_id:Se})}},{title:(0,C.jsx)(ne.FormattedMessage,{id:"email"}),dataIndex:"email"},{title:(0,C.jsx)(ne.FormattedMessage,{id:"attempt",defaultMessage:"Attempt"}),dataIndex:"attempt"},{title:(0,C.jsx)(ne.FormattedMessage,{id:"finished_at",defaultMessage:"Finished at"}),dataIndex:"finished_at",render:function(Se){return Se?(0,H.WU)(new Date(Se),v.Cu):""}}]},[]),Ue=(0,ie.useMemo)(function(){return Pe.map(function(xe){var Se=xe.id,Be=xe.email,We=xe.finished_at,Le=oe==null?void 0:oe.find(function(le){return le.id===Se}),he=Array.isArray(Le==null?void 0:Le.attempts)?Le==null?void 0:Le.attempts.length:0;return{id:Se,email:Be,finished_at:We,attempt:he}})},[Pe]);return(0,C.jsx)(b.Z,{title:function(){return(0,C.jsx)(P.Z,{children:(0,C.jsx)(ne.FormattedMessage,{id:"course.finished",defaultMessage:"Finished"})})},columns:Oe,dataSource:Ue,size:"small",scroll:{x:500}})},T=function(Ee){var Pe=Ee.stats,oe=(0,ie.useState)(null),Oe=g()(oe,2),Ue=Oe[0],xe=Oe[1],Se=(0,ie.useState)(null),Be=g()(Se,2),We=Be[0],Le=Be[1],he=(0,ne.useIntl)(),le=(0,ie.useMemo)(function(){return Pe.flatMap(function(O){return Object.values(O.attempts).flatMap(function(D){var ye=D.dates,fe=D.attempt,_t=Object.values(ye).flatMap(function(st){var lt=st.date,et=st.seconds_total;return{date:lt,attempt:fe,seconds_total:et,email:O.email}});return _t})})},[Pe]),de={xField:"date",yField:"seconds_total",seriesField:"attempt",isStack:!0,xAxis:{label:{autoHide:!0,autoRotate:!1}},slider:{start:0,end:1},label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]}};return(0,C.jsx)(d.ZP,{title:(0,C.jsxs)(P.Z,{children:[(0,C.jsx)(ne.FormattedMessage,{id:"course.interactions_time_in_days"}),(0,C.jsx)(Z.default,{showSearch:!0,value:Ue,onChange:function(D){xe(D),Le(null)},placeholder:(0,C.jsx)(ne.FormattedMessage,{id:"select_person",defaultMessage:"Select a person"}),children:Pe.map(function(O){var D=O.id,ye=O.email;return(0,C.jsx)(Z.default.Option,{value:ye,children:ye},D)})}),(0,C.jsx)(Z.default,{value:We,onChange:function(D){return Le(D)},disabled:Ue===null,placeholder:(0,C.jsx)(ne.FormattedMessage,{id:"select_attempt",defaultMessage:"Select attempt"}),children:W()(new Set(le.filter(function(O){var D=O.email;return D===Ue}).map(function(O){var D=O.attempt;return D}))).map(function(O){return(0,C.jsxs)(Z.default.Option,{value:O,children:[(0,C.jsx)(ne.FormattedMessage,{id:"attempt",defaultMessage:"Attempt"})," ",O]},O)})})]}),colSpan:12,layout:"center",children:(0,C.jsx)("div",{style:{overflow:"auto",minHeight:"400px",width:"100%"},children:(0,C.jsx)(ee.Z,Te()(Te()({},de),{},{tooltip:{title:"".concat(he.formatMessage({id:"attempt"})),formatter:function(D){var ye=Math.floor(+D.seconds_total/60),fe=+D.seconds_total>60?+D.seconds_total-ye*60:0;return{name:D.attempt,value:"".concat(ye,"m ").concat(fe,"s")}}},data:le.filter(function(O){var D=O.email;return D===Ue}).filter(function(O){var D=O.attempt;return Number.isInteger(We)?D===We:!0})}))})})}},87366:function(St,Je,u){u.d(Je,{Il:function(){return jt},_y:function(){return Z},uS:function(){return De}});var ze=u(15009),m=u.n(ze),He=u(99289),Te=u.n(He),_e=u(5574),W=u.n(_e),$e=u(97857),g=u.n($e),v=u(19632),s=u.n(v),ee=u(2453),d=u(67294),P=u(80854),i=u(99100),b=u(31472),I=u(36309),ae=u(85893),Z=d.createContext({}),H=function(){return Math.round(Math.random()*99999)},ie=function be(C){return C.reduce(function(me,L){return[].concat(s()(me),s()(L.lessons?be(L.lessons):[]),[L])},[])},De=function be(C){return C.reduce(function(me,L){var ue;return[].concat(s()(me),s()(L.lessons?be(L.lessons):[]),s()((ue=L.topics)!==null&&ue!==void 0?ue:[]))},[])},ne=function be(C,me,L){return C.map(function(ue){var j,T;return g()(g()({},ue),{},{lessons:ue.lessons?be(ue.lessons,me,L):[],topics:ue.id===me?[].concat(s()((j=ue.topics)!==null&&j!==void 0?j:[]),[L]):(T=ue.topics)!==null&&T!==void 0?T:[]})})},pt=function be(C,me,L){return L?C.map(function(ue){return g()(g()({},ue),{},{lessons:[].concat(s()(ue.lessons?be(ue.lessons,me,L):[]),s()(ue.id===L?[me]:[]))})}):[].concat(s()(C),[me])},nt=function be(C,me,L){return C.map(function(ue){return g()(g()({},ue.id===me?L:ue),{},{lessons:ue.lessons?be(ue.lessons,me,L):[]})})},gt=function be(C,me){return C.map(function(L){return g()(g()({},L),{},{parent_id:me,lessons:L.lessons?be(L.lessons,L.id):[]})})},xt=function be(C,me){return C.filter(function(L){return L.id!==me}).map(function(L){return g()(g()({},L),{},{lessons:L.lessons?be(L.lessons,me):[]})})},Fe=function be(C,me){return C.map(function(L){return g()(g()({},L),{},{lessons:L.lessons?be(L.lessons,me):[],topics:L.topics?L.topics.filter(function(ue){return ue.id!==me}):[]})})},yt=function be(C,me,L,ue){return ue==null?void 0:ue.map(function(j){if(j.id===L){var T;return g()(g()({},j),{},{topics:(T=j.topics)===null||T===void 0?void 0:T.map(function(e){return e.id===C?me.file.response.data:e})})}else if(j.lessons)return g()(g()({},j),{},{lessons:be(C,me,L,j.lessons||[])});return j})},jt=function(C){var me=C.children,L=C.id,ue=(0,d.useState)(),j=W()(ue,2),T=j[0],e=j[1],Ee=(0,P.useIntl)(),Pe=(0,d.useMemo)(function(){return T&&T.lessons?De(T.lessons):[]},[T]),oe=(0,d.useMemo)(function(){return T&&T.lessons?ie(T.lessons):[]},[T]),Oe=(0,d.useState)([]),Ue=W()(Oe,2),xe=Ue[0],Se=Ue[1],Be=(0,d.useState)(!1),We=W()(Be,2),Le=We[0],he=We[1],le=(0,P.useLocation)(),de=(0,d.useMemo)(function(){var N=new URLSearchParams(le.search);return{lesson:N.get("lesson"),topic:N.get("topic")}},[le]),O=(0,d.useCallback)(Te()(m()().mark(function N(){var J,V;return m()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,(0,I.XU)({class_type:"EscolaLms\\Courses\\Models\\Lesson"});case 2:J=K.sent,J.success&&(V=J.data.find(function(Q){var R=Q.name;return R==="assistant_id"}),he(!!(V!=null&&V.id)));case 4:case"end":return K.stop()}},N)})),[]);(0,d.useEffect)(function(){O(),Se([])},[]);var D=(0,d.useCallback)(function(){(0,i.Nx)(L).then(function(N){return N.success&&e(g()(g()({},N.data),{},{lessons:gt(N.data.lessons)}))})},[L]);(0,d.useEffect)(function(){D()},[D]);var ye=(0,d.useCallback)(function(N){var J=oe.find(function(V){var z;return V==null||(z=V.topics)===null||z===void 0?void 0:z.find(function(K){return K.id===N})});return J?J.id:null},[oe]),fe=(0,d.useMemo)(function(){return de.lesson?{mode:"lesson",id:Number(de.lesson),value:oe.find(function(N){return N.id===Number(de.lesson)})}:de.topic?{mode:"topic",id:Number(de.topic),value:Pe.find(function(N){return N.id===Number(de.topic)})}:{mode:"init"}},[de,T,oe,Pe]),_t=(0,d.useCallback)(function(N){var J={course_id:L,topics:[],isNew:!0,id:T?T.lessons.length+1:H(),order:0,title:Ee.formatMessage({id:"add_title_here"}),active:!0,parent_id:N};return e(function(V){var z;return g()(g()({},V),{},{lessons:pt((z=V==null?void 0:V.lessons)!==null&&z!==void 0?z:[],J,N)})}),J},[L,T]),st=(0,d.useCallback)(function(N,J){var V=oe.find(function(K){return K.id===N}),z=V&&V.isNew;return(z?(0,i.aA)(J):(0,i.sI)(N,J)).then(function(K){return ee.ZP.success(K.message),D(),K.success&&e(function(Q){var R;return g()(g()({},Q),{},{lessons:nt((R=Q==null?void 0:Q.lessons)!==null&&R!==void 0?R:[],N,g()(g()({},K.data),{},{isNew:!1}))})})})},[T]),lt=(0,d.useCallback)(function(N){var J=oe.find(function(z){return z.id===N});if(J){var V=J.isNew;V?e(function(z){var K;return g()(g()({},z),{},{lessons:xt((K=z==null?void 0:z.lessons)!==null&&K!==void 0?K:[],N)})}):(0,i.iI)(N).then(function(z){z.success&&(ee.ZP.success(z.message),e(function(K){var Q;return g()(g()({},K),{},{lessons:xt((Q=K==null?void 0:K.lessons)!==null&&Q!==void 0?Q:[],N)})}))})}},[T]),et=(0,d.useCallback)(function(N,J){var V,z=ye(N),K=oe.find(function(re){return re.id===z}),Q=K&&((V=K.topics)===null||V===void 0?void 0:V.find(function(re){return re.id===N})),R=Q==null?void 0:Q.isNew;return(R?(0,i.HV)(J):(0,i.Cn)(N,J)).then(function(re){re.success&&(ee.ZP.success(re.message),D(),P.history.push("/courses/list/".concat(L,"/program/?topic=").concat(re.data.id)),(Q==null?void 0:Q.topicable_type)===b.oz.Video&&setTimeout(function(){D()},5e3))})},[ye,T,D]),Mt=(0,d.useCallback)(function(N){var J=ye(N),V=oe.find(function(Q){return Q.id===J});if(V){var z=Pe==null?void 0:Pe.find(function(Q){return Q.id===N}),K=z==null?void 0:z.isNew;K&&!z.topicable?e(function(Q){var R;return g()(g()({},Q),{},{lessons:Fe((R=Q==null?void 0:Q.lessons)!==null&&R!==void 0?R:[],N)})}):(0,i.vJ)(N).then(function(Q){Q.success&&(ee.ZP.success(Q.message),e(function(R){var re;return g()(g()({},R),{},{lessons:Fe((re=R==null?void 0:R.lessons)!==null&&re!==void 0?re:[],N)})}))})}},[T,ye]),Ct=(0,d.useCallback)(function(N,J){var V={lesson_id:N,isNew:!0,id:H(),title:Ee.formatMessage({id:"add_title_here"}),active:!0,topicable_type:J};return e(function(z){var K;return g()(g()({},z),{},{lessons:ne((K=z==null?void 0:z.lessons)!==null&&K!==void 0?K:[],N,V)})}),V},[]),Tt=function(J,V){var z=ye(J);e(function(K){return g()(g()({},K),{},{lessons:K?yt(J,V,z,K.lessons||[]):[]})}),P.history.push("/courses/list/".concat(L,"/program/?topic=").concat(V.file.response.data.id))},Pt=(0,d.useCallback)(function(N){return(0,i.Cx)(N).then(function(J){if(J.success){ee.ZP.success(J.message);var V=ye(N);e(function(z){var K;return g()(g()({},z),{},{lessons:z?(K=z.lessons)===null||K===void 0?void 0:K.map(function(Q){if(Q.id===V){var R=Q.topics||[];return g()(g()({},Q),{},{topics:[].concat(s()(R),[J.data])})}return Q}):[]})})}})},[T,ye]),Ft=(0,d.useCallback)(function(N){return(0,i.if)(N).then(function(J){J.success&&(ee.ZP.success(J.message),e(function(V){return g()(g()({},V),{},{lessons:V?[].concat(s()(V.lessons),[J.data]):[]})}))})},[]),wt={state:T,h5ps:xe,id:L,addNewLesson:_t,updateLesson:st,updateTopic:et,deleteLesson:lt,addNewTopic:Ct,deleteTopic:Mt,onTopicUploaded:Tt,cloneTopic:Pt,cloneLesson:Ft,currentEditMode:fe,getLessons:D,isAssistant:Le};return(0,ae.jsx)(Z.Provider,{value:wt,children:me})}},88030:function(St,Je,u){u.r(Je),u.d(Je,{default:function(){return $r}});var ze=u(97857),m=u.n(ze),He=u(91115),Te=u(26114),_e=u(26271),W=u(74453),$e=u(75081),g=u(14726),v=u(67294),s=u(80854),ee=u(15009),d=u.n(ee),P=u(99289),i=u.n(P),b=u(19632),I=u.n(b),ae=u(5574),Z=u.n(ae),H=u(16894),ie=u(83062),De=u(2453),ne=u(25093),pt=u(28248),nt=u(78957),gt=u(2487),xt=u(96365),Fe=u(75842);function yt(o,n){return jt.apply(this,arguments)}function jt(){return jt=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/bookmarks",m()({method:"GET",params:n},t||{})));case 1:case"end":return a.stop()}},o)})),jt.apply(this,arguments)}function be(o,n){return C.apply(this,arguments)}function C(){return C=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/bookmarks",m()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return a.stop()}},o)})),C.apply(this,arguments)}function me(o,n,t){return L.apply(this,arguments)}function L(){return L=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/bookmarks/".concat(n),m()({method:"PATCH",headers:{"Content-Type":"application/json"},data:t},r||{})));case 1:case"end":return l.stop()}},o)})),L.apply(this,arguments)}function ue(o,n,t){return j.apply(this,arguments)}function j(){return j=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/bookmarks/".concat(n),m()({method:"DELETE",headers:{"Content-Type":"application/json"},data:t},r||{})));case 1:case"end":return l.stop()}},o)})),j.apply(this,arguments)}var T=u(31472),e=u(85893),Ee=function(n){var t=n.visible,r=n.onClose,a=n.user,l=ne.Z.Text,c=a.name,f=a.groupId,h=a.userId,_=(0,v.useState)(""),S=Z()(_,2),M=S[0],F=S[1],p=(0,v.useState)(!1),x=Z()(p,2),y=x[0],E=x[1],k=(0,v.useState)([]),G=Z()(k,2),A=G[0],se=G[1],X=(0,v.useState)(null),q=Z()(X,2),U=q[0],w=q[1],$=(0,v.useState)({current_page:1,per_page:5,last_page:1,total:0}),B=Z()($,2),ve=B[0],Ye=B[1],Ve=function(){var Re=i()(d()().mark(function Y(je){var te;return d()().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.next=2,yt({bookmarkable_id:f,bookmarkable_type:T.h5.Group,user_id:h,page:je,per_page:ve.per_page});case 2:te=Ie.sent,te.success&&(se(te.data),Ye(te.meta));case 4:case"end":return Ie.stop()}},Y)}));return function(je){return Re.apply(this,arguments)}}(),at=function(){var Re=i()(d()().mark(function Y(){var je;return d()().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:return Xe.next=2,be({value:M,bookmarkable_id:f,bookmarkable_type:T.h5.Group,user_id:h});case 2:je=Xe.sent,je.success&&(Ve(),E(!1),F(""));case 4:case"end":return Xe.stop()}},Y)}));return function(){return Re.apply(this,arguments)}}(),Qe=function(){var Re=i()(d()().mark(function Y(je){var te;return d()().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.next=2,ue(je);case 2:te=Ie.sent,te.success&&Ve();case 4:case"end":return Ie.stop()}},Y)}));return function(je){return Re.apply(this,arguments)}}(),Me=function(){var Re=i()(d()().mark(function Y(je){var te;return d()().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.next=2,me(je,{value:(U==null?void 0:U.currentText)||"",bookmarkable_id:f,bookmarkable_type:T.h5.Group,user_id:h});case 2:te=Ie.sent,te.success&&(Ve(),w(null));case 4:case"end":return Ie.stop()}},Y)}));return function(je){return Re.apply(this,arguments)}}();return(0,v.useEffect)(function(){Ve()},[]),(0,e.jsxs)(pt.Z,{title:(0,e.jsxs)(nt.Z,{children:[(0,e.jsx)(s.FormattedMessage,{id:"notes"}),(0,e.jsx)(l,{children:"(".concat(c,")")})]}),open:t,onCancel:r,footer:[(0,e.jsx)(g.ZP,{onClick:r,children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})},"cancel")],children:[(0,e.jsx)(gt.Z,{dataSource:A,pagination:{onChange:function(Y){return Ve(Y)},pageSize:ve.per_page,total:ve.total,current:ve.current_page},renderItem:function(Y){return(0,e.jsx)(gt.Z.Item,{actions:[(0,e.jsx)(g.ZP,{danger:!0,onClick:function(){return Qe(Y.id)},children:(0,e.jsx)(s.FormattedMessage,{id:"delete"})},Y.id),(U==null?void 0:U.currentNoteId)===Y.id?(0,e.jsxs)(nt.Z,{children:[(0,e.jsx)(g.ZP,{onClick:function(){return Me(Y.id)},children:(0,e.jsx)(s.FormattedMessage,{id:"save"})}),(0,e.jsx)(g.ZP,{onClick:function(){return w(null)},children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})})]}):(0,e.jsx)(g.ZP,{onClick:function(){return w({currentNoteId:Y.id,currentText:Y.value||""})},children:(0,e.jsx)(s.FormattedMessage,{id:"edit"})},Y.id)],children:(U==null?void 0:U.currentNoteId)===Y.id&&(U==null?void 0:U.currentText)!==null?(0,e.jsx)(xt.Z.TextArea,{value:U==null?void 0:U.currentText,onChange:function(te){return w(function(Xe){return m()(m()({},Xe),{},{currentText:te.target.value})})}}):Y.value})}}),y?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Fe.Z,{layout:"vertical",children:(0,e.jsx)(Fe.Z.Item,{label:(0,e.jsx)(s.FormattedMessage,{id:"new_note"}),children:(0,e.jsx)(xt.Z.TextArea,{value:M,onChange:function(Y){return F(Y.target.value)},autoSize:{minRows:3,maxRows:6}})})}),(0,e.jsxs)(nt.Z,{children:[(0,e.jsx)(g.ZP,{type:"primary",onClick:at,children:(0,e.jsx)(s.FormattedMessage,{id:"save"})}),(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){return E(!1)},children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})})]})]}):(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){return E(!0)},children:(0,e.jsx)(s.FormattedMessage,{id:"add_note"})},"new")]})},Pe=Ee;function oe(o,n){return Oe.apply(this,arguments)}function Oe(){return Oe=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/schedules/groups/".concat(n),m()({method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},o)})),Oe.apply(this,arguments)}function Ue(o,n,t,r){return xe.apply(this,arguments)}function xe(){return xe=i()(d()().mark(function o(n,t,r,a){return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,s.request)("/api/admin/schedules/".concat(n,"/attendances"),m()({data:{attendances:[{user_id:t,value:r}]},method:"POST"},a||{})));case 1:case"end":return c.stop()}},o)})),xe.apply(this,arguments)}function Se(o,n){return Be.apply(this,arguments)}function Be(){return Be=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams",m()({method:"GET",useCache:!1,params:n},t||{})));case 1:case"end":return a.stop()}},o)})),Be.apply(this,arguments)}function We(o,n){return Le.apply(this,arguments)}function Le(){return Le=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams",m()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return a.stop()}},o)})),Le.apply(this,arguments)}function he(o,n,t){return le.apply(this,arguments)}function le(){return le=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n),m()({method:"PUT",data:t,useCache:!1},r||{})));case 1:case"end":return l.stop()}},o)})),le.apply(this,arguments)}function de(o,n){return O.apply(this,arguments)}function O(){return O=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n),m()({method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},o)})),O.apply(this,arguments)}function D(o,n){return ye.apply(this,arguments)}function ye(){return ye=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n),m()({method:"DELETE"},t||{})));case 1:case"end":return a.stop()}},o)})),ye.apply(this,arguments)}function fe(o,n,t,r){return _t.apply(this,arguments)}function _t(){return _t=i()(d()().mark(function o(n,t,r,a){return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n,"/users/").concat(t),m()({method:"POST",headers:{"Content-Type":"application/json"},data:r},a||{})));case 1:case"end":return c.stop()}},o)})),_t.apply(this,arguments)}function st(o,n,t){return lt.apply(this,arguments)}function lt(){return lt=_asyncToGenerator(_regeneratorRuntime().mark(function o(n,t,r){return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",request("/api/admin/exams/".concat(n,"/users/").concat(t),_objectSpread({method:"DELETE"},r||{})));case 1:case"end":return l.stop()}},o)})),lt.apply(this,arguments)}function et(o,n,t){return Mt.apply(this,arguments)}function Mt(){return Mt=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/semester-subjects/".concat(n,"/tutors/").concat(t,"/grades"),m()({method:"GET",useCache:!1},r||{})));case 1:case"end":return l.stop()}},o)})),Mt.apply(this,arguments)}function Ct(o,n,t,r){return Tt.apply(this,arguments)}function Tt(){return Tt=i()(d()().mark(function o(n,t,r,a){return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,s.request)("/api/admin/semester-subjects/".concat(n,"/tutors/").concat(t,"/grades"),m()({method:"POST",data:r},a||{})));case 1:case"end":return c.stop()}},o)})),Tt.apply(this,arguments)}function Pt(o,n){return Ft.apply(this,arguments)}function Ft(){return Ft=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/lesson-group-users",m()({method:"GET",params:{groups:n},useCache:!1},t||{})));case 1:case"end":return a.stop()}},o)})),Ft.apply(this,arguments)}function wt(o,n,t){return N.apply(this,arguments)}function N(){return N=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/lesson-group-users/groups/".concat(n,"/users/").concat(t),m()({method:"GET",useCache:!1},r||{})));case 1:case"end":return l.stop()}},o)})),N.apply(this,arguments)}function J(o){return V.apply(this,arguments)}function V(){return V=i()(d()().mark(function o(n){return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/admin/grade-terms",m()({method:"GET",useCache:!1},n||{})));case 1:case"end":return r.stop()}},o)})),V.apply(this,arguments)}function z(o,n){return K.apply(this,arguments)}function K(){return K=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/grade-scales/".concat(n),m()({method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},o)})),K.apply(this,arguments)}function Q(o,n){return R.apply(this,arguments)}function R(){return R=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/final-grades",m()({method:"POST",data:n},t||{})));case 1:case"end":return a.stop()}},o)})),R.apply(this,arguments)}function re(o,n,t){return ce.apply(this,arguments)}function ce(){return ce=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/final-grades/".concat(n),m()({method:"PATCH",data:t},r||{})));case 1:case"end":return l.stop()}},o)})),ce.apply(this,arguments)}function pe(o,n){return ge.apply(this,arguments)}function ge(){return ge=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/final-grades/".concat(n),m()({method:"DELETE"},t||{})));case 1:case"end":return a.stop()}},o)})),ge.apply(this,arguments)}var Ze=u(95213),Ke=u(47389),Ae=u(7092),Et=u(13769),Zt=u.n(Et),Nt=["results"],Vt=function(n,t){return n.reduce(function(r,a){var l=a.results,c=Zt()(a,Nt),f=l.find(function(h){return h.user_id===t});return f?[].concat(I()(r),[m()(m()({},c),{},{result:f})]):r},[])},Xt=function(n,t){var r,a=n.reduce(function(p,x){var y=x.result,E=x.weight;return E&&typeof y.result=="number"?[p[0]+y.result*E,p[1]+E]:p},[0,0]),l=Z()(a,2),c=l[0],f=l[1],h=Number.isNaN(c/f)?0:c/f,_=t.sort(function(p,x){return p.grade_value-x.grade_value}).reduce(function(p,x){return[].concat(I()(p),[m()(m()({},x),{},{isWeightedAverageGreater:h>=x.grade_value})])},[]);if(_.every(function(p){var x=p.isWeightedAverageGreater;return x})){var S,M;return(S=(M=_.at(-1))===null||M===void 0?void 0:M.name)!==null&&S!==void 0?S:""}var F=_.findIndex(function(p){var x=p.isWeightedAverageGreater;return!x});return F<0?"":(r=_[F-1])===null||r===void 0?void 0:r.name},zt=function(n,t){var r;return(r=t.find(function(a){return a.s_subject_scale_form_id===n}))===null||r===void 0?void 0:r.scale},dt=u(73199),da=u(9783),tt=u.n(da),Ht=u(84567);function ca(o){var n,t=o===null?T.cX.ABSENT:o,r=tt()(tt()(tt()(tt()({},T.cX.PRESENT,{ch1:!0,ch2:!1}),T.cX.PRESENT_NOT_EXERCISING,{ch1:!0,ch2:!0}),T.cX.ABSENT,{ch1:!1,ch2:!1}),T.cX.EXCUSED_ABSENCE,{ch1:!1,ch2:!0});return(n=r[t])!==null&&n!==void 0?n:{ch1:!1,ch2:!1}}function ma(o){var n,t=o.ch1,r=o.ch2,a="".concat(t,"_").concat(r),l={true_false:T.cX.PRESENT,true_true:T.cX.PRESENT_NOT_EXERCISING,false_false:T.cX.ABSENT,false_true:T.cX.EXCUSED_ABSENCE};return(n=l[a])!==null&&n!==void 0?n:T.cX.ABSENT}var fa=function(n){var t=n.groupAttendanceScheduleId,r=n.studentId,a=n.attendance,l=n.onSuccess,c=(0,v.useState)(ca(a)),f=Z()(c,2),h=f[0],_=f[1],S=(0,v.useState)(!1),M=Z()(S,2),F=M[0],p=M[1],x=(0,v.useRef)(!0),y=(0,v.useCallback)(function(G){p(!0),Ue(t,r,ma(G)).then(function(A){A.success&&(l==null||l())}).finally(function(){return p(!1)})},[]),E=(0,v.useCallback)(function(G){return _(G.target.checked?{ch1:!0,ch2:!1}:{ch1:!1,ch2:!1})},[]),k=(0,v.useCallback)(function(G){return _(function(A){return m()(m()({},A),{},{ch2:G.target.checked})})},[]);return(0,v.useEffect)(function(){if(x.current){x.current=!1;return}y(h)},[h,y]),(0,e.jsxs)(nt.Z,{children:[(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"present"}),children:(0,e.jsx)(Ht.Z,{disabled:F,checked:h.ch1,onChange:E})}),(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:h.ch1?"not_exercising":"excused_absence"}),children:(0,e.jsx)(Ht.Z,{disabled:F,checked:h.ch2,onChange:k})})]})},Yt=fa,ht=u(45919),bt=u(60943),It=u(83863),Jt=u(8925),va=u(96486),pa=function(n){var t=n.exam_id,r=n.result,a=n.student_id,l=n.type,c=n.onSuccess,f=(0,v.useCallback)((0,va.debounce)(function(_){fe(t,a,{result:_}).then(function(S){S.success&&(c==null||c(S.data))})},300),[t,r,a]),h=function(){switch(l){case T.UL.ManualPass:return(0,e.jsx)(It.default,{allowClear:!0,style:{width:"100%"},onChange:f,options:dt.FW,defaultValue:r,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_grade"})});case T.UL.ManualGrades:return(0,e.jsx)(It.default,{allowClear:!0,style:{width:"100%"},onChange:f,options:dt.BP,defaultValue:r,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_grade"})});default:return(0,e.jsx)(Jt.Z,{type:"number",min:0,max:100,onChange:f,defaultValue:r!=null?r:void 0})}};return h()},ga=function(n,t){var r;return(r=n.find(function(a){return a.name===t}))===null||r===void 0?void 0:r.id},ha=function(n){var t=n.term,r=n.gradeScales,a=n.defaultFinalGrade,l=n.finalGrades,c=(0,v.useState)(a),f=Z()(c,2),h=f[0],_=f[1],S=(0,v.useState)(!1),M=Z()(S,2),F=M[0],p=M[1],x=(0,v.useState)(!1),y=Z()(x,2),E=y[0],k=y[1],G=(0,s.useIntl)(),A=(0,v.useMemo)(function(){return r.map(function(q){var U=q.name,w=q.id;return{value:w,label:U}})},[r]),se=function(U){k(!0),De.ZP.error(G.formatMessage({id:U.data.message}))},X=(0,v.useCallback)(function(q){if(l!=null&&l.id){if(q===void 0){if(!h)return;p(!0),pe(h.id).then(function(U){U.success&&_(void 0)}).finally(function(){return p(!1)});return}if(h){p(!0),re(h.id,{grade_scale_id:q}).catch(function(U){var w;U!=null&&(w=U.data)!==null&&w!==void 0&&w.message&&se(U)}).finally(function(){return p(!1)});return}p(!0),Q({grade_term_id:t.id,grade_scale_id:q,lesson_group_user_id:l.id}).then(function(U){if(U.success){var w=U.data.grades.find(function($){return $.grade_term.id===t.id});_(w),E&&k(!1)}}).catch(function(U){var w;U!=null&&(w=U.data)!==null&&w!==void 0&&w.message&&se(U)}).finally(function(){return p(!1)})}},[h,t.id,l==null?void 0:l.id]);return l?(0,e.jsx)(It.default,{allowClear:!0,status:E?"error":"",loading:F,disabled:F,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_final_grade"}),style:{width:"100%"},onChange:X,options:A,defaultValue:ga(r,a==null?void 0:a.grade_name)}):null},xa=function(n){var t=n.reduce(function(r,a){return[].concat(I()(r),[{title:(0,bt.WU)(new Date(a.date_from),ht.GC),dataIndex:"attendance-".concat(a.id),hideInSearch:!0,width:100,align:"center",render:function(c,f){return(0,e.jsx)(Yt,{groupAttendanceScheduleId:a.id,attendance:f["attendance-".concat(a==null?void 0:a.id)],studentId:f.id})}}])},[]);return t.length?{title:(0,e.jsx)(s.FormattedMessage,{id:"attendance"}),hideInSearch:!0,children:t}:{title:(0,e.jsx)(s.FormattedMessage,{id:"attendance"}),hideInSearch:!0,hideInTable:!0}},ja=function(n,t){return n.reduce(function(r,a){var l=a.attendances.find(function(c){return c.user_id===t});return l?m()(m()({},r),{},tt()({},"attendance-".concat(a.id),l.value)):r},{})},_a=function(n){var t=n.reduce(function(r,a){return[].concat(I()(r),[{dataIndex:"exam-".concat(a.id),title:a.type===T.UL.Manual?(0,e.jsx)(s.FormattedMessage,{id:"examTitleWithWeight",values:a}):(0,e.jsx)(s.FormattedMessage,{id:"examTitleWithoutWeight",values:a}),hideInSearch:!0,width:100,render:function(c,f){var h;return(f==null||(h=f["exam-".concat(a.id)])===null||h===void 0?void 0:h.result)!==void 0?(0,e.jsx)(pa,{type:a.type,result:f==null?void 0:f["exam-".concat(a.id)].result,exam_id:a.id,student_id:f.id}):"-"}}])},[]);return t.length?{title:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),hideInSearch:!0,children:t}:{title:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),hideInSearch:!0,hideInTable:!0}},ba=function(n){return n.reduce(function(t,r){var a=r.result,l=r.id;return m()(m()({},t),{},tt()({},"exam-".concat(l),a))},{})},Sa=function(n,t){return{title:(0,e.jsx)(s.FormattedMessage,{id:"final-grades"}),hideInSearch:!0,children:n.map(function(r){return{title:r.name,hideInSearch:!0,width:100,align:"center",render:function(l,c){var f;return(0,e.jsx)(ha,{defaultFinalGrade:c["final-grade-".concat(r.id)],finalGrades:c.final_grades,term:r,gradeScales:t},"".concat(c==null||(f=c.final_grades)===null||f===void 0?void 0:f.group_id,"-").concat(r.id))}}})}},ya=function(n,t){return n.find(function(r){return r.user.id===t})},Ma=function(n){var t;return((t=n==null?void 0:n.grades)!==null&&t!==void 0?t:[]).reduce(function(r,a){return m()(m()({},r),{},tt()({},"final-grade-".concat(a.grade_term.id),a))},{})},Ca=function(){var n,t=(0,Ae.Z)(),r=t.teacherSubjectData,a=t.semester_subject_id,l=(0,v.useState)([]),c=Z()(l,2),f=c[0],h=c[1],_=(0,v.useState)(r==null||(n=r.groups)===null||n===void 0||(n=n[0])===null||n===void 0?void 0:n.name),S=Z()(_,2),M=S[0],F=S[1],p=(0,v.useState)(null),x=Z()(p,2),y=x[0],E=x[1],k=(0,s.useIntl)(),G=(0,v.useMemo)(function(){var X;return((X=r==null?void 0:r.groups)!==null&&X!==void 0?X:[]).map(function(q){var U=q.id,w=q.name;return{value:U,label:w}})},[r==null?void 0:r.groups]),A=(0,v.useRef)(),se=(0,v.useMemo)(function(){var X;return[{title:(0,e.jsx)(s.FormattedMessage,{id:"group"}),dataIndex:"group_id",hideInTable:!0,valueType:"select",fieldProps:{options:G,defaultValue:G==null||(X=G[0])===null||X===void 0?void 0:X.value,allowClear:!1}},{title:(0,e.jsx)(s.FormattedMessage,{id:"surnameAndName",defaultMessage:"Name and surname"}),dataIndex:"full_name",fixed:"left"}].concat(I()(f),[{hideInSearch:!0,title:(0,e.jsx)(s.FormattedMessage,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",fixed:"right",width:60,render:function(U,w){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"notes",defaultMessage:"notes"}),children:(0,e.jsx)(g.ZP,{type:"primary",icon:(0,e.jsx)(Ke.Z,{}),onClick:function(){return E({userName:w.full_name,userId:w.id,groupId:w.final_grades.group_id})}})})})}}])},[G,f]);return(0,e.jsxs)(e.Fragment,{children:[(y==null?void 0:y.userId)&&(0,e.jsx)(Pe,{visible:!!y.userId,onClose:function(){return E(null)},user:{name:y.userName,userId:y.userId,groupId:y.groupId}}),(0,e.jsx)(H.ZP,{sticky:!0,className:"table-standalone",request:function(){var X=i()(d()().mark(function q(U){var w,$,B,ve,Ye,Ve,at,Qe,Me,Re,Y,je,te,Xe,Ie,Ce,Ge,we,ke,qe,ft;return d()().wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:return ve=U.group_id,Ye=ve===void 0?(w=G[0])===null||w===void 0?void 0:w.value:ve,Ve=U.full_name,at=Ve===void 0?"":Ve,Ne.next=3,Pt([Ye]);case 3:if(Qe=Ne.sent,Me=G.find(function(it){var ut=it.value;return ut===Ye}),!(!Qe.success||Qe.data[0]===void 0||a===null)){Ne.next=8;break}return De.ZP.error(k.formatMessage({id:"groupDataMissing"},{group_name:Me==null?void 0:Me.label})),Ne.abrupt("return",{data:[],total:0,success:!1});case 8:return Ne.next=10,Promise.all([(0,Ze.X)(Ye),oe(Ye),Se({group_id:Ye,per_page:-1}),et(a,($=Qe.data)===null||$===void 0||($=$[0])===null||$===void 0?void 0:$.tutor_id),J(),z((B=Qe.data)===null||B===void 0||(B=B[0])===null||B===void 0?void 0:B.s_subject_scale_form_id)]);case 10:if(Re=Ne.sent,Y=Z()(Re,6),je=Y[0],te=Y[1],Xe=Y[2],Ie=Y[3],Ce=Y[4],Ge=Y[5],!(!je.success||!te.success||!Xe.success||!Ie.success||!Ce.success||!Ge.success||!Me)){Ne.next=21;break}return De.ZP.error(k.formatMessage({id:"groupDataMissing"},{group_name:Me==null?void 0:Me.label})),Ne.abrupt("return",{data:[],total:0,success:!1});case 21:return F(Me.label),we=xa(te.data),ke=_a(Xe.data),qe=Sa(Ce.data,Ge.data),h([we,ke,qe,{title:(0,e.jsx)(s.FormattedMessage,{id:"proposed_grade"}),hideInSearch:!0,dataIndex:"proposed_grade",align:"center",width:100}]),ft=je.data.users.reduce(function(it,ut){var Ot,rt,Dt,Gt=ut.id,Or=ut.academic_teacher_id,Nr=ut.first_name,Ur=ut.last_name,oa="".concat(Ur," ").concat(Nr);if(Or!==null||!oa.toLowerCase().includes(at.toLowerCase()))return it;var kr=ja(te.data,Gt),la=Vt(Xe.data,Gt),Lt=ya(Qe.data,Gt),Br=(Ot=zt((rt=Lt==null?void 0:Lt.s_subject_scale_form_id)!==null&&rt!==void 0?rt:0,(Dt=Ie.data.grade_scale)!==null&&Dt!==void 0?Dt:[]))!==null&&Ot!==void 0?Ot:[],Wr=Xt(la,Br),Kr=ba(la),Vr=Ma(Lt);return[].concat(I()(it),[m()(m()(m()(m()({id:Gt,full_name:oa},kr),Kr),Vr),{},{proposed_grade:Wr,final_grades:Lt})])},[]).sort(function(it,ut){return it.full_name.localeCompare(ut.full_name)}),Ne.abrupt("return",{data:ft,total:ft.length,success:!0});case 28:case"end":return Ne.stop()}},q)}));return function(q){return X.apply(this,arguments)}}(),columns:se,headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"classRegisterTitleWithGroupName",values:{groupName:M}}),search:{layout:"vertical"},scroll:{x:1500},actionRef:A,pagination:{defaultPageSize:dt.Sl,onChange:function(){var q;return(q=A.current)===null||q===void 0?void 0:q.reload()}},rowKey:"id"})]})},Qt=u(1413),Ta={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM305.8 637.7c3.1 3.1 8.1 3.1 11.3 0l138.3-137.6L583 628.5c3.1 3.1 8.2 3.1 11.3 0l275.4-275.3c3.1-3.1 3.1-8.2 0-11.3l-39.6-39.6a8.03 8.03 0 00-11.3 0l-230 229.9L461.4 404a8.03 8.03 0 00-11.3 0L266.3 586.7a8.03 8.03 0 000 11.3l39.5 39.7z"}}]},name:"line-chart",theme:"outlined"},Fa=Ta,Ea=u(84089),Pa=function(n,t){return v.createElement(Ea.Z,(0,Qt.Z)((0,Qt.Z)({},n),{},{ref:t,icon:Fa}))},Za=v.forwardRef(Pa),Ia=Za,qt=u(82061),ea=u(86738),At=u(62235),ot=u(952),Ga=u(5966),wa=u(50335),ta=u(71230),ct=u(15746),Da=u(56717),aa=u(95830),La=u(29477),ra=function(n){return n===T.UL.Manual||n===T.UL.ManualPass||n===T.UL.ManualGrades},Aa=function(n){var t=n.type,r=n.onDataConverted,a=n.groupSelectDisabled,l=(0,Ae.Z)(),c=l.semester_subject_id,f=l.teacherSubjectData,h=(0,v.useState)(null),_=Z()(h,2),S=_[0],M=_[1],F=(0,v.useMemo)(function(){var y;return((y=f==null?void 0:f.groups)!==null&&y!==void 0?y:[]).map(function(E){var k=E.id,G=E.name;return{label:G,value:k}})},[]),p={type:t,group_id:S,semester_subject_id:c},x=(0,v.useCallback)(function(y){if(y.success){var E=y.data.results.filter(function(k){var G=k.user_id;return G!==null});if(!E.length)return;r({exam_results:E,group_id:y.data.group_id})}},[]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ot.ZP.Item,{label:(0,e.jsx)(s.FormattedMessage,{id:"group"}),children:(0,e.jsx)(It.default,{disabled:a,value:S,onChange:function(E){return M(E)},options:F,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_group"}),style:{width:"100%"}})}),(0,e.jsx)(La.Z,{name:"file",url:"/api/admin/exams/parse",onUpload:x,onChange:function(E){return!E.fileList.length&&r(void 0)},maxFiles:1,data:p,disabled:!S})]})},Ra=function(n){var t=n.onDataConverted,r=(0,Ae.Z)(),a=r.teacherSubjectData,l=r.groupUsers,c=(0,v.useState)(null),f=Z()(c,2),h=f[0],_=f[1],S=(0,v.useMemo)(function(){var F;return((F=a==null?void 0:a.groups)!==null&&F!==void 0?F:[]).map(function(p){var x=p.id,y=p.name;return{label:y,value:x}})},[]),M=(0,v.useCallback)(function(F){var p;_(F);var x=(p=l.byId)===null||p===void 0?void 0:p[F];if(x){var y=x.users.reduce(function(E,k){var G=k.id,A=k.email,se=k.first_name,X=k.last_name,q=k.academic_teacher_id;return q!==null?E:[].concat(I()(E),[{email:A,first_name:se,last_name:X,user_id:G,result:null}])},[]);t({group_id:F,exam_results:y})}},[l.byId]);return(0,e.jsx)(It.default,{value:h,onChange:M,options:S,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_group"}),style:{width:"100%"}})},Rt=tt()(tt()(tt()(tt()(tt()(tt()({},T.UL.TestPortal,["/teacher-examples/testPortal.png"]),T.UL.TeamsForms,["/teacher-examples/teamsForms.png"]),T.UL.TeamsLecture,["/teacher-examples/teamsLecture.png","/teacher-examples/teamsLectureWithoutMail.png"]),T.UL.Manual,[]),T.UL.ManualPass,[]),T.UL.ManualGrades,[]),$a=function(n){var t=n.images,r=(0,v.useState)(!1),a=Z()(r,2),l=a[0],c=a[1],f=(0,v.useCallback)(function(){return c(!0)},[]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"see_file_example_image"}),children:(0,e.jsx)(g.ZP,{onClick:f,icon:(0,e.jsx)(Da.Z,{})})}),(0,e.jsx)(aa.Z.PreviewGroup,{preview:{visible:l,onVisibleChange:c},children:t.map(function(h){return(0,e.jsx)(aa.Z,{style:{display:"none"},src:h},h)})})]})},Oa=function(n){var t,r=n.type,a=n.onOk,l=n.onCancel,c=n.okDisabled,f=(t=Rt==null?void 0:Rt[r])!==null&&t!==void 0?t:Rt[T.UL.Manual];return(0,e.jsxs)(nt.Z,{style:{width:"100%",justifyContent:f.length?"space-between":"flex-end"},children:[!!f.length&&(0,e.jsx)($a,{images:f}),(0,e.jsxs)(nt.Z,{children:[(0,e.jsx)(g.ZP,{onClick:l,children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})}),(0,e.jsx)(g.ZP,{type:"primary",disabled:c,onClick:a,children:(0,e.jsx)(s.FormattedMessage,{id:"ok"})})]})]})},Na=[T.UL.TeamsLecture,T.UL.TestPortal,T.UL.TeamsForms],Ua=function(n){var t=n.open,r=n.closeModal,a=n.onSuccess,l=n.type,c=(0,Ae.Z)(),f=c.teacherSubjectData,h=c.fetchGroupUsers,_=(0,v.useState)(),S=Z()(_,2),M=S[0],F=S[1];return(0,v.useEffect)(function(){if(ra(l)&&t){var p;f==null||(p=f.groups)===null||p===void 0||p.forEach(function(x){var y=x.id;return h(y)})}},[l,t]),(0,e.jsxs)(pt.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.".concat(l,"Convert")}),width:"40vw",open:t,onCancel:r,footer:(0,e.jsx)(Oa,{type:l,onOk:function(){M&&a(M)},onCancel:r,okDisabled:!M}),children:[Na.includes(l)&&(0,e.jsx)(Aa,{type:l,onDataConverted:F,groupSelectDisabled:!!M}),ra(l)&&(0,e.jsx)(Ra,{onDataConverted:F,examType:l})]})},ka=function(n){var t=n.onSelect;return(0,e.jsxs)(ta.Z,{gutter:[16,16],children:[(0,e.jsx)(ct.Z,{span:12,children:(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){return t(T.UL.TeamsForms)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadFile.MsTeamsForms",defaultMessage:"uploadFile.MsTeamsForms"})})}),(0,e.jsx)(ct.Z,{span:12,children:(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){return t(T.UL.TestPortal)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadFile.TestPortal",defaultMessage:"uploadFile.TestPortal"})})}),(0,e.jsx)(ct.Z,{span:12,children:(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){return t(T.UL.TeamsLecture)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadFile.MsTeams",defaultMessage:"uploadFile.MsTeams"})})}),(0,e.jsx)(ct.Z,{span:12,children:(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){return t(T.UL.Manual)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGradesManually",defaultMessage:"uploadGradesManually"})})}),(0,e.jsx)(ct.Z,{span:12,children:(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){return t(T.UL.ManualPass)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGradesManuallyPass",defaultMessage:"uploadGradesManuallyPass"})})}),(0,e.jsx)(ct.Z,{span:12,children:(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){return t(T.UL.ManualGrades)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGradesManuallyGrades",defaultMessage:"uploadGradesManuallyGrades"})})})]})},Ba=[{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name"}),dataIndex:"first_name",editable:!1},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name"}),dataIndex:"last_name",editable:!1}],Wa=function(n){var t,r=n.exam_id,a=ot.ZP.useForm(),l=Z()(a,1),c=l[0],f=(0,v.useState)(),h=Z()(f,2),_=h[0],S=h[1],M=(0,v.useState)(),F=Z()(M,2),p=F[0],x=F[1],y=(0,v.useState)(!1),E=Z()(y,2),k=E[0],G=E[1],A=(0,Ae.Z)(),se=A.semester_subject_id,X=A.getGroupById,q=(0,v.useMemo)(function(){var w;return((w=p==null?void 0:p.exam_results)!==null&&w!==void 0?w:[]).map(function($){var B=$.user_id;return B})},[p==null?void 0:p.exam_results]);(0,v.useEffect)(function(){var w=Number(r);r==="new"&&(S(void 0),x(void 0),c.resetFields()),r!=="new"&&!Number.isNaN(w)&&(G(!0),de(w).then(function($){if($.success){var B=$.data,ve=B.type,Ye=B.results,Ve=B.title,at=B.weight,Qe=B.passed_at,Me=B.group_id;S(ve),x({group_id:Me,exam_results:Ye}),c.setFieldsValue({title:Ve,weight:at,passed_at:Qe})}}).finally(function(){return G(!1)}))},[r]);var U=(0,v.useCallback)(function(){S(void 0),x(void 0)},[]);return k?(0,e.jsx)($e.Z,{}):(0,e.jsxs)(e.Fragment,{children:[_&&(0,e.jsx)(Ua,{open:!!(_&&!p),type:_,closeModal:U,onSuccess:x}),(0,e.jsxs)(ot.ZP,{form:c,submitter:_===void 0||!p?!1:void 0,onFinish:function(){var w=i()(d()().mark(function $(B){var ve,Ye,Ve,at,Qe,Me,Re,Y;return d()().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(!(p&&typeof se=="number")){te.next=16;break}if(ve=B.title,Ye=B.passed_at,Ve=B.weight,at=Number(r),Qe=p.exam_results,Me=p.group_id,Re={type:_,semester_subject_id:se,title:ve,passed_at:Ye,weight:Ve,group_id:Me,results:Qe},!Number.isNaN(at)){te.next=11;break}return te.next=8,We(Re);case 8:te.t0=te.sent,te.next=14;break;case 11:return te.next=13,he(at,Re);case 13:te.t0=te.sent;case 14:Y=te.t0,Y.success&&s.history.push("/teacher/subjects/".concat(se,"/exams"));case 16:return te.abrupt("return",!0);case 17:case"end":return te.stop()}},$)}));return function($){return w.apply(this,arguments)}}(),onReset:U,children:[(0,e.jsxs)(ot.ZP.Group,{children:[(0,e.jsx)(Ga.Z,{label:(0,e.jsx)(s.FormattedMessage,{id:"examTitle",defaultMessage:"examTitle"}),rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],width:"lg",name:"title"}),(0,e.jsx)(wa.Z,{label:(0,e.jsx)(s.FormattedMessage,{id:"datePassingExam",defaultMessage:"datePassingExam"}),rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],width:"lg",name:"passed_at"}),_!==T.UL.ManualGrades&&_!==T.UL.ManualPass&&(0,e.jsx)(ot.ZP.Item,{name:"weight",label:(0,e.jsx)(s.FormattedMessage,{id:"examImportance",defaultMessage:"examImportance"}),rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})},{type:"number",min:1,max:100,message:(0,e.jsx)(s.FormattedMessage,{id:"number_between",values:{min:1,max:100}})}],children:(0,e.jsx)(Jt.Z,{})})]}),_&&p&&(0,e.jsx)(H.ZP,{rowKey:"user_id",headerTitle:(t=X(p.group_id))===null||t===void 0?void 0:t.name,editable:{type:"single",editableKeys:q,onValuesChange:function($,B){return x({group_id:p.group_id,exam_results:B})}},cardProps:{bodyStyle:{paddingInline:0}},search:!1,dataSource:p.exam_results.sort(function(w,$){return w.last_name.localeCompare($.last_name)}),pagination:{defaultPageSize:dt.Sl},columns:[].concat(Ba,[function(){switch(_){case T.UL.ManualPass:return{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",valueType:"select",fieldProps:{options:dt.FW}};case T.UL.ManualGrades:return{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",valueType:"select",fieldProps:{options:dt.BP}};default:return{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",valueType:"percent",formItemProps:{rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})},{type:"number",min:0,max:100,message:(0,e.jsx)(s.FormattedMessage,{id:"number_between",values:{min:0,max:100}})}]}}}}()])}),!p&&(0,e.jsx)(ka,{onSelect:S})]})]})},Ka=[{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name"}),dataIndex:"first_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name"}),dataIndex:"last_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",hideInSearch:!0}],Va=function(n){var t=n.exam_id,r=(0,v.useState)(""),a=Z()(r,2),l=a[0],c=a[1];return(0,e.jsx)(H.ZP,{className:"table-standalone",rowKey:"user_id",search:!1,headerTitle:l,pagination:{defaultPageSize:dt.Sl},request:i()(d()().mark(function f(){var h;return d()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,de(t);case 2:if(h=S.sent,!h.success){S.next=6;break}return c(h.data.title),S.abrupt("return",{total:h.data.results.length,success:!0,data:h.data.results});case 6:return S.abrupt("return",[]);case 7:case"end":return S.stop()}},f)})),columns:Ka})},Xa=[{title:(0,e.jsx)(s.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",sorter:!0,width:"80px"},{title:(0,e.jsx)(s.FormattedMessage,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!0,sorter:!0},{title:(0,e.jsx)(s.FormattedMessage,{id:"type",defaultMessage:"type"}),dataIndex:"type",sorter:!0,render:function(n,t){return(0,e.jsx)(s.FormattedMessage,{id:"ExamGradeType.".concat(t.type)})}},{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.exam_date",defaultMessage:"Exam date"}),dataIndex:"passed_at",sorter:!0,render:function(n,t){return t.passed_at&&(0,bt.WU)(new Date(t.passed_at),ht.GC)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",sorter:!0,render:function(n,t){return t.weight?t.weight+"%":""}},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",sorter:!0,render:function(n,t){return t.created_at&&(0,bt.WU)(new Date(t.created_at),ht.GC)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"semester",defaultMessage:"Semester"}),dataIndex:"semester",sorter:!0,render:function(n,t){return(0,e.jsx)(s.FormattedMessage,{id:"SemesterType.".concat(t.semester.type),values:{year:t.semester.year}})}},{title:(0,e.jsx)(s.FormattedMessage,{id:"group",defaultMessage:"Group"}),dataIndex:"group_id",sorter:!0,render:function(n,t){return(0,e.jsx)(At.Z,{type:"Students",type_id:t.group_id},t.group_id)}}],za=function(){var n,t=(0,v.useRef)(),r=(0,Ae.Z)(),a=r.semester_subject_id,l=(0,s.useLocation)(),c=new URLSearchParams(l.search),f=(n=c.get("exam_id"))!==null&&n!==void 0?n:null,h=c.get("results");return h!==null&&!Number.isNaN(Number(h))?(0,e.jsx)(Va,{exam_id:Number(h)}):f!==null?(0,e.jsx)(Wa,{exam_id:f}):(0,e.jsx)(H.ZP,{className:"table-standalone",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),actionRef:t,search:!1,rowKey:"id",pagination:{defaultPageSize:dt.Sl},request:function(){var _=i()(d()().mark(function S(M,F){var p,x,y,E;return d()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(p=M.current,x=M.pageSize,a!==null){G.next=3;break}return G.abrupt("return",{data:[],total:0,success:!1});case 3:return y=F&&Object.entries(F)[0],G.next=6,Se({per_page:x,page:p,semester_subject_id:Number.isNaN(a)?void 0:a,order_by:y&&y[0],order:y&&(y[1]==="ascend"?"ASC":"DESC")});case 6:if(E=G.sent,!E.success){G.next=9;break}return G.abrupt("return",{data:E.data,total:E.meta.total,success:!0});case 9:return G.abrupt("return",{data:[],total:0,success:!1});case 10:case"end":return G.stop()}},S)}));return function(S,M){return _.apply(this,arguments)}}(),columns:[].concat(Xa,[{title:(0,e.jsx)(s.FormattedMessage,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(S,M){return[(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(M.semester_subject_id,"/exams?exam_id=").concat(M.id),children:(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,e.jsx)(g.ZP,{type:"primary",icon:(0,e.jsx)(Ke.Z,{})})})},"edit"),(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(M.semester_subject_id,"/exams?results=").concat(M.id),children:(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.results",defaultMessage:"results"}),children:(0,e.jsx)(g.ZP,{icon:(0,e.jsx)(Ia,{})})})},"results"),(0,e.jsx)(ea.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:i()(d()().mark(function F(){var p;return d()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,D(M.id);case 2:p=y.sent,p.success&&t.current&&t.current.reload();case 4:case"end":return y.stop()}},F)})),okText:(0,e.jsx)(s.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(s.FormattedMessage,{id:"no"}),children:(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(g.ZP,{type:"primary",icon:(0,e.jsx)(qt.Z,{}),danger:!0})})},"delete")]}}])})},Ha=u(69753),na=u(44167),Ya=u(84665),Ja=["type","defaultRender"],Qa=["type","defaultRender"],qa=function(n){var t=n.url;return(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"download"}),children:(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){window.open(t,"_blank","noopener noreferrer")},icon:(0,e.jsx)(Ha.Z,{})})})},er=[{title:(0,e.jsx)(s.FormattedMessage,{id:"ID"}),dataIndex:"id",hideInSearch:!0},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_at"}),dataIndex:"created_at",hideInSearch:!0,render:function(n,t){return(0,bt.WU)(new Date(t.created_at),ht.Cu)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_by"}),dataIndex:"created_by",renderFormItem:function(n,t,r){var a=t.type,l=t.defaultRender,c=Zt()(t,Ja);if(a==="form")return null;var f=r.getFieldValue("state");return(0,e.jsx)(na.Z,m()(m()({},c),{},{state:{type:f}}))},render:function(n,t){var r,a;return(0,e.jsx)(At.Z,{type:"EscolaLms\\Core\\Models\\User",type_id:t.created_by.id,text:t!=null&&(r=t.created_by)!==null&&r!==void 0&&r.first_name&&t!==null&&t!==void 0&&(a=t.created_by)!==null&&a!==void 0&&a.last_name?"".concat(t.created_by.first_name," ").concat(t.created_by.last_name):void 0},t.created_by.id)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"exported_at"}),dataIndex:"exported_at",hideInSearch:!0,render:function(n,t){return(0,bt.WU)(new Date(t.exported_at),ht.Cu)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"exported_by"}),dataIndex:"exported_by",renderFormItem:function(n,t,r){var a=t.type,l=t.defaultRender,c=Zt()(t,Qa);if(a==="form")return null;var f=r.getFieldValue("state");return(0,e.jsx)(na.Z,m()(m()({},c),{},{state:{type:f}}))},render:function(n,t){var r,a;return(0,e.jsx)(At.Z,{type:"EscolaLms\\Core\\Models\\User",type_id:t.exported_by.id,text:t!=null&&(r=t.exported_by)!==null&&r!==void 0&&r.first_name&&t!==null&&t!==void 0&&(a=t.exported_by)!==null&&a!==void 0&&a.last_name?"".concat(t.exported_by.first_name," ").concat(t.exported_by.last_name):void 0},t.exported_by.id)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"version"}),dataIndex:"version",hideInSearch:!0},{title:(0,e.jsx)(s.FormattedMessage,{id:"options"}),valueType:"option",render:function(n,t){return[(0,e.jsx)(qa,{url:t.url},"download")]}}],tr=function(){var n,t=(0,Ae.Z)(),r=t.teacherSubjectData,a=(0,v.useMemo)(function(){var c;return((c=r==null?void 0:r.groups)!==null&&c!==void 0?c:[]).map(function(f){var h=f.id,_=f.name;return{value:h,label:_}})},[r==null?void 0:r.groups]),l=(0,v.useMemo)(function(){var c;return[{title:(0,e.jsx)(s.FormattedMessage,{id:"group"}),dataIndex:"group_id",hideInTable:!0,valueType:"select",fieldProps:{options:a,defaultValue:r==null||(c=r.groups)===null||c===void 0||(c=c[0])===null||c===void 0?void 0:c.id,allowClear:!1}}].concat(er)},[r==null||(n=r.groups)===null||n===void 0||(n=n[0])===null||n===void 0?void 0:n.id,a]);return(0,e.jsx)(H.ZP,{className:"table-standalone",request:function(){var c=i()(d()().mark(function f(h){var _,S,M,F,p,x;return d()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return S=h.group_id,M=S===void 0?r==null||(_=r.groups)===null||_===void 0||(_=_[0])===null||_===void 0?void 0:_.id:S,F=h.created_by,p=h.exported_by,E.next=3,(0,Ya.v)({group_id:M,created_by:F,exported_by:p});case 3:if(x=E.sent,x.success){E.next=6;break}return E.abrupt("return",{success:!1,data:[],total:0});case 6:return E.abrupt("return",{success:!0,data:x.data,total:x.data.length});case 7:case"end":return E.stop()}},f)}));return function(f){return c.apply(this,arguments)}}(),columns:l,search:{layout:"vertical"},scroll:{x:1500},pagination:{defaultPageSize:dt.Sl}})},sa=u(64317),Ut=u(96074),ia=u(11312),ar=u(87366),kt=u(99100),rr=["attendances"];function nr(o){return function(t){o(function(r){return m()(m()({},r),{},{loading:t})})}}function ua(o,n){return Bt.apply(this,arguments)}function Bt(){return Bt=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n(!0),a.prev=1,a.abrupt("return",t());case 3:return a.prev=3,n(!1),a.finish(3);case 6:case"end":return a.stop()}},o,null,[[1,,3,6]])})),Bt.apply(this,arguments)}function sr(o,n){var t=(0,v.useState)({loading:!1}),r=Z()(t,2),a=r[0],l=r[1],c=(0,v.useCallback)(nr(l),[]),f=(0,v.useCallback)(i()(d()().mark(function _(){var S;return d()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,wt(o,n);case 2:if(S=F.sent,S.success){F.next=5;break}return F.abrupt("return",S);case 5:return l(function(p){return m()(m()({},p),{},{data:S.data})}),F.abrupt("return",S);case 7:case"end":return F.stop()}},_)})),[n,o]),h=(0,v.useCallback)(function(_){return ua(c,function(){return pe(_).then(f)})},[f]);return(0,v.useEffect)(function(){ua(c,f)},[f]),{finalGrades:a,deleteFinalGrade:h}}function ir(){var o=(0,v.useState)({loading:!1}),n=Z()(o,2),t=n[0],r=n[1];return(0,v.useEffect)(function(){r(function(a){return m()(m()({},a),{},{loading:!0})}),J().then(function(a){a.success&&r(function(l){return m()(m()({},l),{},{data:a.data})})}).finally(function(){r(function(a){return m()(m()({},a),{},{loading:!1})})})},[]),{gradeTerms:t}}function ur(o){var n=(0,v.useState)({loading:!1}),t=Z()(n,2),r=t[0],a=t[1];return(0,v.useEffect)(function(){o!==void 0&&(a(function(l){return m()(m()({},l),{},{loading:!0})}),z(o).then(function(l){l.success&&a(function(c){return m()(m()({},c),{},{data:l.data})})}).finally(function(){a(function(l){return m()(m()({},l),{},{loading:!1})})}))},[o]),{subjectGradeScales:r}}function or(o,n,t){var r=(0,v.useState)({loading:!1}),a=Z()(r,2),l=a[0],c=a[1];return(0,v.useEffect)(function(){typeof o!="number"||typeof n!="number"||typeof t!="number"||(c(function(f){return m()(m()({},f),{},{loading:!0})}),et(o,n).then(function(f){f.success&&c(function(h){var _,S;return m()(m()({},h),{},{data:(_=zt(t,(S=f.data.grade_scale)!==null&&S!==void 0?S:[]))===null||_===void 0?void 0:_.map(function(M,F){return m()(m()({},M),{},{id:F})})})})}).finally(function(){c(function(f){return m()(m()({},f),{},{loading:!1})})}))},[o,n]),{tutorGradeScales:l}}function lr(o,n){var t=(0,v.useState)({loading:!1}),r=Z()(t,2),a=r[0],l=r[1],c=(0,v.useCallback)(function(){l(function(f){return m()(m()({},f),{},{loading:!0})}),oe(o).then(function(f){if(f.success){var h=f.data.reduce(function(_,S){var M=S.attendances,F=Zt()(S,rr),p=M.find(function(x){return x.user_id===n});return p?[].concat(I()(_),[m()(m()({},F),{},{attendance:p})]):_},[]);l(function(_){return m()(m()({},_),{},{data:h})})}}).finally(function(){l(function(f){return m()(m()({},f),{},{loading:!1})})})},[o,n]);return(0,v.useEffect)(function(){c()},[c]),{userAttendanceSchedules:a,fetchUserAttendanceSchedules:c}}function dr(o,n){var t=(0,v.useState)({loading:!1}),r=Z()(t,2),a=r[0],l=r[1];return(0,v.useEffect)(function(){n&&(l(function(c){return m()(m()({},c),{},{loading:!0})}),Se({student_id:o,semester_subject_id:n}).then(function(c){if(c.success){var f=Vt(c.data,o);l(function(h){return m()(m()({},h),{},{data:f})})}}).finally(function(){l(function(c){return m()(m()({},c),{},{loading:!1})})}))},[o,n]),{studentExams:a}}function cr(o,n){var t=(0,v.useState)({loading:!1}),r=Z()(t,2),a=r[0],l=r[1],c=(0,v.useState)({loading:!1}),f=Z()(c,2),h=f[0],_=f[1],S=(0,v.useState)({loading:!1}),M=Z()(S,2),F=M[0],p=M[1];return(0,v.useEffect)(function(){l(function(x){return m()(m()({},x),{},{loading:!0})}),(0,kt.N7)({group_id:o}).then(function(x){x.success&&l(function(y){return m()(m()({},y),{},{data:x.data})})}).finally(function(){l(function(x){return m()(m()({},x),{},{loading:!1})})})},[o]),(0,v.useEffect)(function(){a.data&&(p(function(x){return m()(m()({},x),{},{loading:!0})}),Promise.all(a.data.map(function(x){var y=x.id;return(0,kt.Nx)(Number(y))})).then(function(x){x.forEach(function(y){y.success&&p(function(E){return m()(m()({},E),{},{data:m()(m()({},E.data),{},tt()({},Number(y.data.id),(0,ar.uS)(y.data.lessons)))})})})}).finally(function(){p(function(x){return m()(m()({},x),{},{loading:!1})})}),_(function(x){return m()(m()({},x),{},{loading:!0})}),Promise.all(a.data.map(function(x){var y=x.id;return(0,kt.ue)(Number(y),["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics","EscolaLms\\Reports\\Stats\\Course\\AttendanceList"]).then(function(E){if(E.success){var k,G,A=((k=E.data["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics"])!==null&&k!==void 0?k:[]).filter(function(X){return X.id===n}),se=(G=E.data["EscolaLms\\Reports\\Stats\\Course\\AttendanceList"])!==null&&G!==void 0?G:[];_(function(X){return m()(m()({},X),{},{data:m()(m()({},X.data),{},tt()({},Number(y),{finishedTopics:A,attendanceList:se}))})})}})})).finally(function(){return _(function(x){return m()(m()({},x),{},{loading:!1})})}))},[a.data,n]),{userCourses:a,userCoursesStats:h,userCoursesTopics:F}}var mr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"grade"},{title:(0,e.jsx)(s.FormattedMessage,{id:"degree"}),dataIndex:"name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent"}],fr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"date"}),dataIndex:"date_from",render:function(n,t){return(0,bt.WU)(new Date(t.date_from),ht.GC)}}],vr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"name"}),dataIndex:"title"},{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",valueType:"percent"},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",render:function(n,t){return(0,bt.WU)(new Date(t.created_at),ht.GC)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"result",render:function(n,t){return"".concat(t.result.result," ").concat(t.weight?"%":"")}}],pr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"name"}),dataIndex:"name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"issued_at"}),dataIndex:"grade",render:function(n,t){var r,a;return(r=t.grade)!==null&&r!==void 0&&r.grade_date?(0,bt.WU)(new Date((a=t.grade)===null||a===void 0?void 0:a.grade_date),ht.GC):"-"}},{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"grade",render:function(n,t){var r,a;return(r=(a=t.grade)===null||a===void 0?void 0:a.grade_name)!==null&&r!==void 0?r:"-"}}],$t=6,gr=function(n){var t,r,a,l,c=n.user_id,f=n.group_id,h=(0,Ae.Z)(),_=h.semester_subject_id,S=dr(c,_),M=S.studentExams,F=sr(f,c),p=F.finalGrades,x=F.deleteFinalGrade,y=ir(),E=y.gradeTerms,k=ur((t=p.data)===null||t===void 0?void 0:t.s_subject_scale_form_id),G=k.subjectGradeScales,A=or(_,(r=p.data)===null||r===void 0?void 0:r.tutor_id,(a=p.data)===null||a===void 0?void 0:a.s_subject_scale_form_id),se=A.tutorGradeScales,X=lr(f,c),q=X.userAttendanceSchedules,U=X.fetchUserAttendanceSchedules,w=cr(f,c),$=w.userCourses,B=w.userCoursesStats,ve=w.userCoursesTopics,Ye=ot.ZP.useForm(),Ve=Z()(Ye,1),at=Ve[0],Qe=(0,v.useMemo)(function(){var Ce;return((Ce=E.data)!==null&&Ce!==void 0?Ce:[]).map(function(Ge){var we=Ge.id,ke=Ge.name;return{label:ke,value:we}})},[E.data]),Me=(0,v.useMemo)(function(){var Ce;return((Ce=G.data)!==null&&Ce!==void 0?Ce:[]).map(function(Ge){var we=Ge.name,ke=Ge.id;return{label:we,value:ke}})},[G.data]),Re=(0,v.useMemo)(function(){var Ce,Ge;return Xt((Ce=M.data)!==null&&Ce!==void 0?Ce:[],(Ge=se.data)!==null&&Ge!==void 0?Ge:[])},[M.data,se.data]),Y=(0,v.useCallback)(function(){var Ce=i()(d()().mark(function Ge(we){var ke,qe,ft,vt,Ne,it,ut;return d()().wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:if(ft=we.grade_scale_id,vt=we.grade_term_id,((ke=p.data)===null||ke===void 0?void 0:ke.id)!==void 0){rt.next=3;break}return rt.abrupt("return");case 3:if(Ne=(qe=p.data)===null||qe===void 0?void 0:qe.grades.find(function(Dt){var Gt=Dt.grade_term;return Gt.id===vt}),!Ne){rt.next=11;break}return rt.next=7,re(Ne.id,{grade_scale_id:ft});case 7:return it=rt.sent,De.ZP[it.success?"success":"error"](it.message),it.success&&s.history.push("/teacher/subjects/".concat(_,"/final-grades")),rt.abrupt("return");case 11:return rt.next=13,Q({grade_scale_id:ft,grade_term_id:vt,lesson_group_user_id:p.data.id});case 13:ut=rt.sent,De.ZP[ut.success?"success":"error"](ut.message),ut.success&&s.history.push("/teacher/subjects/".concat(_,"/final-grades"));case 16:case"end":return rt.stop()}},Ge)}));return function(Ge){return Ce.apply(this,arguments)}}(),[p.data,_]),je=(0,v.useMemo)(function(){return[].concat(pr,[{title:(0,e.jsx)(s.FormattedMessage,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",render:function(Ge,we){var ke;return typeof(we==null||(ke=we.grade)===null||ke===void 0?void 0:ke.id)=="number"?[(0,e.jsx)(ea.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:function(){return x(we.grade.id)},okText:(0,e.jsx)(s.FormattedMessage,{id:"yes",defaultMessage:"Yes"}),cancelText:(0,e.jsx)(s.FormattedMessage,{id:"no",defaultMessage:"No"}),children:(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(g.ZP,{type:"primary",icon:(0,e.jsx)(qt.Z,{}),danger:!0})})},"delete")]:[]}}])},[]),te=(0,v.useMemo)(function(){var Ce;return((Ce=E.data)!==null&&Ce!==void 0?Ce:[]).map(function(Ge){var we;return m()(m()({},Ge),{},{grade:(we=p.data)===null||we===void 0?void 0:we.grades.find(function(ke){var qe=ke.grade_term;return qe.id===Ge.id})})})},[p.data,E.data]),Xe=$.loading&&!$.data||B.loading&&!B.data||ve.loading&&!ve.data,Ie=!!($.data&&B.data&&ve.data);return p.loading?(0,e.jsx)($e.Z,{}):(0,e.jsxs)(e.Fragment,{children:[p.data&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ne.Z.Text,{style:{fontSize:"16px",fontWeight:500},children:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.Student",values:p.data.user})}),(0,e.jsx)(Ut.Z,{})]}),(0,e.jsxs)(ta.Z,{gutter:[48,48],justify:"space-between",children:[(0,e.jsx)(ct.Z,{span:12,children:(0,e.jsx)(H.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.StudentPartialGrades"}),search:!1,pagination:{pageSize:$t},dataSource:M.data,loading:M.loading,columns:vr,options:!1,cardProps:{bodyStyle:{padding:0}}})}),(0,e.jsx)(ct.Z,{span:12,children:(0,e.jsx)(H.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.FinalGrades"}),search:!1,pagination:{pageSize:$t},dataSource:te,loading:p.loading||E.loading,columns:je,options:!1,cardProps:{bodyStyle:{padding:0}}})}),(0,e.jsx)(ct.Z,{span:12,children:(0,e.jsx)(H.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.Attendances"}),search:!1,options:!1,pagination:{pageSize:$t},cardProps:{bodyStyle:{padding:0}},dataSource:q.data,loading:q.loading,columns:[].concat(fr,[{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.Attendance"}),dataIndex:"attendance",render:function(Ge,we){return(0,e.jsx)(Yt,{groupAttendanceScheduleId:we.id,studentId:c,attendance:we.attendance.value,onSuccess:U})}}])})}),(0,e.jsx)(ct.Z,{span:12,children:(0,e.jsx)(H.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.GradesScale"}),search:!1,options:!1,pagination:{pageSize:$t},cardProps:{bodyStyle:{padding:0}},dataSource:se.data,loading:se.loading,columns:mr})}),Xe&&(0,e.jsx)($e.Z,{}),Ie&&((l=$.data)===null||l===void 0?void 0:l.map(function(Ce){var Ge,we,ke,qe,ft,vt,Ne=Ce.id,it=Ce.title;return(0,e.jsxs)(ct.Z,{span:24,children:[(0,e.jsx)(ne.Z.Text,{style:{fontSize:"16px",fontWeight:500},children:it}),(0,e.jsx)(ia.Du,{course_id:Number(Ne),topics:(Ge=(we=ve.data)===null||we===void 0?void 0:we[Number(Ne)])!==null&&Ge!==void 0?Ge:[],stats:(ke=(qe=B.data)===null||qe===void 0||(qe=qe[Number(Ne)])===null||qe===void 0?void 0:qe.finishedTopics)!==null&&ke!==void 0?ke:[]}),(0,e.jsx)(ia.nu,{stats:(ft=(vt=B.data)===null||vt===void 0||(vt=vt[Number(Ne)])===null||vt===void 0?void 0:vt.attendanceList)!==null&&ft!==void 0?ft:[]})]},Ne)}))]}),(0,e.jsx)(ot.ZP,{form:at,onFinish:Y,children:(0,e.jsxs)(ot.ZP.Group,{style:{display:"flex",flexDirection:"column",paddingTop:"48px"},title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.IssueAssessment"}),titleStyle:{flex:"unset"},align:"center",children:[(0,e.jsx)(sa.Z,{name:"grade_term_id",rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],label:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.GradeTerm"}),options:Qe,width:"sm",fieldProps:{loading:E.loading}}),(0,e.jsx)(sa.Z,{name:"grade_scale_id",rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],label:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.FinalGrade"}),options:Me,fieldProps:{loading:p.loading||G.loading}}),(0,e.jsx)(ot.ZP.Item,{children:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.ProposedGrade",values:{grade:Re}})})]})})]})},hr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name"}),dataIndex:"first_name",render:function(n,t){return t.user.first_name}},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name"}),dataIndex:"last_name",render:function(n,t){return t.user.last_name}},{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),hideInSearch:!0,dataIndex:"grades",render:function(n,t){return(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:t.grades.length?t.grades.map(function(r){var a=r.grade_name,l=r.grade_term,c=r.id;return(0,e.jsxs)(ne.Z.Text,{children:[l.name,": ",a]},c)}):"-"})}}],xr=function(){var n,t,r=(0,s.useLocation)(),a=new URLSearchParams(r.search),l=(n=a.get("user_id"))!==null&&n!==void 0?n:null,c=(t=a.get("group_id"))!==null&&t!==void 0?t:null,f=(0,Ae.Z)(),h=f.teacherSubjectData,_=f.semester_subject_id,S=(0,v.useMemo)(function(){var M;return((M=h==null?void 0:h.groups)!==null&&M!==void 0?M:[]).map(function(F){var p=F.id,x=F.name;return{label:x,value:p}})},[h==null?void 0:h.groups]);return l!==null&&c!==null?(0,e.jsx)(gr,{user_id:Number(l),group_id:Number(c)}):(0,e.jsx)(H.ZP,{className:"table-standalone",rowKey:"id",search:{layout:"vertical"},pagination:{defaultPageSize:dt.Sl},request:function(){var M=i()(d()().mark(function F(p){var x,y,E,k,G,A,se,X,q,U;return d()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return y=p.group_id,E=y===void 0?[]:y,k=p.first_name,G=k===void 0?"":k,A=p.last_name,se=A===void 0?"":A,X=((x=h==null?void 0:h.groups)!==null&&x!==void 0?x:[]).map(function(B){var ve=B.id;return ve}),$.next=4,Pt(E.length===0?X:E);case 4:if(q=$.sent,q.success){$.next=7;break}return $.abrupt("return",{success:!1,total:0,data:[]});case 7:return U=q.data.filter(function(B){var ve=B.user;return ve.first_name.toLowerCase().includes(G.toLowerCase())&&ve.last_name.toLowerCase().includes(se.toLowerCase())}),$.abrupt("return",{success:!0,total:U.length,data:U});case 9:case"end":return $.stop()}},F)}));return function(F){return M.apply(this,arguments)}}(),columns:[{title:(0,e.jsx)(s.FormattedMessage,{id:"group"}),dataIndex:"group_id",valueType:"select",fieldProps:{options:S,mode:"multiple"},render:function(F,p){return(0,e.jsx)(At.Z,{type:"Students",type_id:p.group_id},p.group_id)}}].concat(hr,[{title:(0,e.jsx)(s.FormattedMessage,{id:"options"}),hideInSearch:!0,render:function(F,p){return[(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(_,"/final-grades?user_id=").concat(p.user.id,"&group_id=").concat(p.group_id),children:(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"edit"}),children:(0,e.jsx)(g.ZP,{type:"primary",icon:(0,e.jsx)(Ke.Z,{})})})},"edit")]}}])})},jr=u(88284),_r=u(88280),br=[{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"grade",editable:!1},{title:(0,e.jsx)(s.FormattedMessage,{id:"degree"}),dataIndex:"name",editable:!1},{title:(0,e.jsx)(s.FormattedMessage,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent",formItemProps:{rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})},{type:"number",min:0,max:100,message:(0,e.jsx)(s.FormattedMessage,{id:"number_between",values:{min:0,max:100}})}]}}],Sr=function(n){var t=n.subjectTutorGradeScale,r=n.onFormSubmit,a=(0,v.useState)([]),l=Z()(a,2),c=l[0],f=l[1],h=(0,v.useRef)(),_=ot.ZP.useForm(),S=Z()(_,1),M=S[0];return(0,v.useEffect)(function(){var F,p=((F=t.scale)!==null&&F!==void 0?F:[]).map(function(x,y){return m()(m()({},x),{},{id:String((y+1)*100)})});M.setFieldValue("table",p)},[]),(0,e.jsx)(ot.ZP,{form:M,onFinish:r,submitter:{render:function(p,x){var y=Z()(x,2),E=y[1];return[E]}},children:(0,e.jsx)(_r.Z,{name:"table",rowKey:"id",actionRef:h,formItemProps:{label:(0,e.jsx)(s.FormattedMessage,{id:"grades-scale"})},cardProps:{bodyStyle:{padding:0}},recordCreatorProps:!1,columns:[].concat(br,[{title:(0,e.jsx)(s.FormattedMessage,{id:"options"}),valueType:"option",render:function(p,x){return(0,e.jsx)(g.ZP,{type:"primary",onClick:function(){var E;return(E=h.current)===null||E===void 0?void 0:E.startEditable(x.id)},icon:(0,e.jsx)(Ke.Z,{})})}}]),editable:{form:M,type:"multiple",editableKeys:c,saveText:(0,e.jsx)(g.ZP,{type:"primary",icon:(0,e.jsx)(jr.Z,{})}),onChange:f,actionRender:function(p,x,y){return[y.save]}}})})},yr=function(){var n,t,r=(0,s.useModel)("@@initialState"),a=r.initialState,l=(0,Ae.Z)(),c=l.semester_subject_id,f=l.tutors,h=(0,v.useState)(),_=Z()(h,2),S=_[0],M=_[1],F=(0,v.useState)(!1),p=Z()(F,2),x=p[0],y=p[1],E=(0,v.useState)(null),k=Z()(E,2),G=k[0],A=k[1],se=(0,v.useMemo)(function(){return!!f.data.find(function(w){var $,B=w.id;return B===(a==null||($=a.currentUser)===null||$===void 0?void 0:$.id)})},[f.data,a==null||(n=a.currentUser)===null||n===void 0?void 0:n.id]),X=(0,v.useMemo)(function(){return f.data.map(function(w){var $=w.id,B=w.first_name,ve=w.last_name;return{label:"".concat(B," ").concat(ve),value:$}})},[f.data]),q=(0,v.useCallback)(function(){c===null||G===null||(y(!0),M(void 0),et(c,G).then(function(w){w.success&&M(w.data)}).finally(function(){y(!1)}))},[c,G]),U=(0,v.useCallback)(function(w,$){return function(){var B=i()(d()().mark(function ve(Ye){var Ve,at;return d()().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:if(!(c===null||G===null)){Me.next=2;break}return Me.abrupt("return");case 2:return Ve=w.reduce(function(Re,Y){return Y.s_subject_scale_form_id===$?[].concat(I()(Re),[{s_subject_scale_form_id:$,scale:Ye.table.map(function(je){var te=je.name,Xe=je.grade,Ie=je.grade_value;return{name:te,grade:Xe,grade_value:Ie}})}]):[].concat(I()(Re),[Y])},[]),Me.next=5,Ct(c,G,{grade_scale:Ve});case 5:at=Me.sent,at.success&&q();case 7:case"end":return Me.stop()}},ve)}));return function(ve){return B.apply(this,arguments)}}()},[G,c]);return(0,v.useEffect)(function(){var w,$;if(!se||!(a!=null&&(w=a.currentUser)!==null&&w!==void 0&&w.id)){var B;if((B=f.data)!==null&&B!==void 0&&B[0]){var ve;A((ve=f.data)===null||ve===void 0?void 0:ve[0].id)}return}A(a==null||($=a.currentUser)===null||$===void 0?void 0:$.id)},[a==null||(t=a.currentUser)===null||t===void 0?void 0:t.id,se]),(0,v.useEffect)(function(){q()},[q]),f.loading?(0,e.jsx)($e.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ot.ZP.Item,{label:(0,e.jsx)(s.FormattedMessage,{id:"menu.Teacher"}),children:(0,e.jsx)(It.default,{disabled:se,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select"}),options:X,value:G,onChange:function($){return A($)}})}),(0,e.jsx)(Ut.Z,{}),x&&!S&&(0,e.jsx)($e.Z,{}),S!=null&&S.grade_scale?S.grade_scale.map(function(w,$){var B;return(0,e.jsxs)(v.Fragment,{children:[$>0&&(0,e.jsx)(Ut.Z,{}),(0,e.jsx)(Sr,{subjectTutorGradeScale:w,onFormSubmit:U((B=S.grade_scale)!==null&&B!==void 0?B:[],w.s_subject_scale_form_id)})]},w.s_subject_scale_form_id)}):(0,e.jsx)(ne.Z.Paragraph,{style:{textAlign:"center"},children:(0,e.jsx)(s.FormattedMessage,{id:"gradesScalesMissing"})})]})},Mr=u(30814),Cr=u(40411),Tr=u(31156),Fr=u(27484),mt=u.n(Fr);function Er(o,n){return Wt.apply(this,arguments)}function Wt(){return Wt=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/schedules",m()({params:n,method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},o)})),Wt.apply(this,arguments)}var Pr=function(){var n=(0,v.useState)(null),t=Z()(n,2),r=t[0],a=t[1],l=(0,v.useState)([]),c=Z()(l,2),f=c[0],h=c[1],_=(0,Ae.Z)(),S=_.semester_subject_id,M=mt()(),F=(0,v.useMemo)(function(){return f.map(function(A){return{id:A.id,title:"".concat(A.group.name," (").concat(A.term_status.name,")"),start:mt()(A.date_from).toDate(),end:mt()(A.date_to).toDate(),tutor_name:"".concat(A.tutor.first_name," ").concat(A.tutor.last_name),tutor_email:A.tutor.email,semester:A.semester.name,group:A.group.name,subject:A.subject.name,ms_teams_join_url:A.ms_teams_join_url}})},[f]),p=(0,v.useCallback)(function(A,se){Er({semester_subject_id:S,date_form:A.toDate(),date_to:se.toDate()}).then(function(X){X.success&&h(X.data)})},[S]),x=(0,v.useCallback)(function(A){a(A)},[]),y=(0,v.useCallback)(function(){a(null)},[]),E=(0,v.useCallback)(function(A){return A.isSame(M,"day")?"warning":A.isAfter(M,"day")?"success":"error"},[]),k=(0,v.useCallback)(function(A){var se=F.filter(function(X){return mt()(X.start).isSame(A,"day")});return(0,e.jsx)("ul",{className:"events",children:se.map(function(X){return(0,e.jsx)("li",{onClick:function(){return x(X)},children:(0,e.jsx)(Cr.Z,{status:E(mt()(X.start)),text:X.title})},X.id)})})},[f]),G=(0,v.useCallback)(function(A,se){var X=mt()(A).startOf(se).subtract(1,"month"),q=mt()(A).endOf(se).add(1,"month");p(X,q)},[]);return(0,v.useEffect)(function(){var A=mt()().startOf("month"),se=mt()().endOf("month");p(A,se)},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ne.Z.Title,{level:4,children:(0,e.jsx)(s.FormattedMessage,{id:"schedule",defaultMessage:"Schedule"})}),(0,e.jsx)(Tr.Z,{dateCellRender:k,onPanelChange:G}),(0,e.jsxs)(pt.Z,{open:r!==null,title:"".concat(r==null?void 0:r.subject,": ").concat(r==null?void 0:r.title),onCancel:y,footer:null,children:[(0,e.jsxs)(ne.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"tutorName",defaultMessage:"Tutor"}),": ",r==null?void 0:r.tutor_name]}),(0,e.jsxs)(ne.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"email",defaultMessage:"Email"}),": ",r==null?void 0:r.tutor_email]}),(0,e.jsxs)(ne.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"group",defaultMessage:"Group"}),": ",r==null?void 0:r.group]}),(0,e.jsxs)(ne.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"semester",defaultMessage:"Semester"}),": ",r==null?void 0:r.semester]}),(0,e.jsxs)(ne.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"started_at",defaultMessage:"Start date"}),":",r&&mt()(r.start).format(ht.E)]}),(0,e.jsxs)(ne.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"end_at",defaultMessage:"End date"}),":",r&&mt()(r.end).format(ht.E)]}),(r==null?void 0:r.ms_teams_join_url)&&(0,e.jsx)(ne.Z.Paragraph,{children:(0,e.jsx)("a",{href:r.ms_teams_join_url,target:"_blank",rel:"noreferrer",children:(0,e.jsx)(g.ZP,{type:"primary",children:(0,e.jsx)(s.FormattedMessage,{id:"msTeams"})})},"teamsLink")})]})]})},Zr=u(58638);function Ir(o,n){return Kt.apply(this,arguments)}function Kt(){return Kt=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/chats/ms-teams",m()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return a.stop()}},o)})),Kt.apply(this,arguments)}var Gr=function(n){var t=n.student_id,r=(0,v.useState)(!1),a=Z()(r,2),l=a[0],c=a[1],f=(0,v.useCallback)(i()(d()().mark(function h(){var _;return d()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return c(!0),M.next=3,Ir({user_id:t});case 3:if(_=M.sent,_.success){M.next=8;break}return De.ZP.error(_.message),c(!1),M.abrupt("return");case 8:window.open(_.data.web_url,"_blank","noopener noreferrer"),c(!1);case 10:case"end":return M.stop()}},h)})),[]);return(0,e.jsx)(ie.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"msTeams",defaultMessage:"teams"}),children:(0,e.jsx)(g.ZP,{loading:l,type:"primary",icon:(0,e.jsx)(Zr.Z,{}),onClick:f})})},wr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"user_id",hideInSearch:!0,width:"80px"},{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name",defaultMessage:"First name"}),dataIndex:"first_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name",defaultMessage:"Last name"}),dataIndex:"last_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"email",defaultMessage:"email"}),dataIndex:"email"},{title:(0,e.jsx)(s.FormattedMessage,{id:"groupName",defaultMessage:"Group name"}),dataIndex:"group_name",hideInSearch:!0}],Dr=function(n){return n.map(function(t){var r=t.id,a=t.name;return{label:a,value:r}})},Lr=function(n){return n.reduce(function(t,r){var a,l=r==null||(a=r.users)===null||a===void 0?void 0:a.reduce(function(c,f){return f.academic_teacher_id!==null?c:[].concat(I()(c),[{group_id:r.id,group_name:r.name,user_id:f.id,first_name:f.first_name,last_name:f.last_name,email:f.email}])},[]);return[].concat(I()(t),I()(l))},[])},Ar=function(){var n=(0,Ae.Z)(),t=n.teacherSubjectData,r=(0,v.useMemo)(function(){var a;return Dr((a=t==null?void 0:t.groups)!==null&&a!==void 0?a:[])},[t==null?void 0:t.groups]);return(0,e.jsx)(H.ZP,{className:"table-standalone",rowKey:function(l){return"".concat(l.group_id,"-").concat(l.user_id)},search:{layout:"vertical"},pagination:{defaultPageSize:dt.Sl},request:function(){var a=i()(d()().mark(function l(c){var f,h,_,S,M,F,p,x,y;return d()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return f=c.groups,h=c.first_name,_=h===void 0?"":h,S=c.last_name,M=S===void 0?"":S,F=c.email,p=F===void 0?"":F,k.next=3,(0,Ze.Z)({parent_id:t==null?void 0:t.group_id,"id[]":f});case 3:if(x=k.sent,x.success){k.next=6;break}return k.abrupt("return",{data:[],total:0,success:!1});case 6:return y=Lr(x.data).filter(function(G){return G.first_name.toLowerCase().includes(_.toLowerCase())&&G.last_name.toLowerCase().includes(M.toLowerCase())&&G.email.toLowerCase().includes(p.toLowerCase())}),k.abrupt("return",{data:y,total:y.length,success:!0});case 8:case"end":return k.stop()}},l)}));return function(l){return a.apply(this,arguments)}}(),columns:[{title:(0,e.jsx)(s.FormattedMessage,{id:"groups",defaultMessage:"Groups"}),dataIndex:"groups",hideInTable:!0,filterMultiple:!0,valueType:"select",fieldProps:{options:r,mode:"multiple"}}].concat(wr,[{hideInSearch:!0,title:(0,e.jsx)(s.FormattedMessage,{id:"msTeams"}),dataIndex:"teamsLink",valueType:"option",render:function(l,c){return[(0,e.jsx)(Gr,{student_id:c.user_id},"teamsChat")]}}])})},Rr=function(n){var t,r,a=n.tab,l=(0,s.useIntl)(),c=(0,s.useModel)("@@initialState"),f=c.setInitialState,h=c.initialState,_=(0,Ae.Z)(),S=_.teacherSubjectData,M=_.semester_subject_id,F=_.tutors,p=(0,v.useCallback)((0,Te.X)(h==null?void 0:h.currentUser),[h==null?void 0:h.currentUser]),x=(0,v.useMemo)(function(){return!!F.data.find(function(y){var E,k=y.id;return k===(h==null||(E=h.currentUser)===null||E===void 0?void 0:E.id)})||p(He.Z.TeacherListGradeScale)},[]);return S?(0,e.jsx)(W._z,{title:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.FormattedMessage,{id:S==null||(t=S.subject)===null||t===void 0?void 0:t.name}),", ",(0,e.jsx)(s.FormattedMessage,{id:a})]}),tabBarExtraContent:(0,e.jsx)("div",{style:{display:"flex",padding:"12px",gap:"12px"},children:(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(M,"/exams?exam_id=new"),children:(0,e.jsx)(g.ZP,{type:"primary",children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGrades",defaultMessage:"uploadGrades"})})})}),header:{breadcrumb:{routes:[{path:"teacher",breadcrumbName:l.formatMessage({id:"menu.Teacher"})},{path:"subjects",breadcrumbName:l.formatMessage({id:"menu.Teacher.Subjects"})},{path:String(M),breadcrumbName:String((r=S.subject)===null||r===void 0?void 0:r.name)},{path:String(a),breadcrumbName:l.formatMessage({id:a,defaultMessage:String(a)})}]}},children:(0,e.jsxs)(_e.ZP,{bodyStyle:{padding:"24px"},tabs:{type:"card",activeKey:a,onChange:function(E){f(m()({},h)),s.history.push("/teacher/subjects/".concat(M,"/").concat(E))}},children:[(0,e.jsx)(_e.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"groups"}),children:(0,e.jsx)(Mr.F,{})},"groups"),(0,e.jsx)(_e.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"students"}),children:(0,e.jsx)(Ar,{})},"students"),(0,e.jsx)(_e.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),children:(0,e.jsx)(za,{})},"exams"),(0,e.jsx)(_e.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"schedule"}),children:(0,e.jsx)(Pr,{})},"schedule"),(0,e.jsx)(_e.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"class-register"}),children:(0,e.jsx)(Ca,{})},"class-register"),x&&(0,e.jsx)(_e.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"grades-scale"}),children:(0,e.jsx)(yr,{})},"grades-scale"),(0,e.jsx)(_e.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"final-grades"}),children:(0,e.jsx)(xr,{})},"final-grades"),(0,e.jsx)(_e.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"file-exports-history"}),children:(0,e.jsx)(tr,{})},"file-exports-history")]})}):(0,e.jsx)($e.Z,{})},$r=function(){var o=(0,s.useParams)(),n=o.subjectId,t=o.tab,r=t===void 0?"groups":t;return(0,e.jsx)(Ae.p,{semester_subject_id:Number(n),children:(0,e.jsx)(Rr,{tab:r})})}},76841:function(St,Je,u){u.d(Je,{Gm:function(){return g},Sx:function(){return d},_g:function(){return s}});var ze=u(15009),m=u.n(ze),He=u(97857),Te=u.n(He),_e=u(99289),W=u.n(_e),$e=u(80854);function g(i,b){return v.apply(this,arguments)}function v(){return v=W()(m()().mark(function i(b,I){return m()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,$e.request)("/api/admin/reports/report",Te()({params:b,method:"GET",useCache:!1},I||{})));case 1:case"end":return Z.stop()}},i)})),v.apply(this,arguments)}function s(i,b,I){return ee.apply(this,arguments)}function ee(){return ee=W()(m()().mark(function i(b,I,ae){return m()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.abrupt("return",(0,$e.request)("/api/admin/stats/course/".concat(b,"/export"),Te()({params:I,method:"GET",useCache:!1,responseType:"blob",headers:{accept:"application/vnd.ms-excel"}},ae||{})));case 1:case"end":return H.stop()}},i)})),ee.apply(this,arguments)}function d(i,b,I){return P.apply(this,arguments)}function P(){return P=W()(m()().mark(function i(b,I,ae){return m()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.abrupt("return",(0,$e.request)("/api/admin/stats/topic/".concat(b,"/export"),Te()({method:"GET",useCache:!1,params:{stat:I},responseType:"blob",headers:{accept:"application/vnd.ms-excel"}},ae||{})));case 1:case"end":return H.stop()}},i)})),P.apply(this,arguments)}},70804:function(St,Je,u){var ze=u(67294);var m=function(ee,d){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,i){P.__proto__=i}||function(P,i){for(var b in i)i.hasOwnProperty(b)&&(P[b]=i[b])})(ee,d)},He,Te,_e=(function(ee){(function(){var d={}.hasOwnProperty;function P(){for(var i=[],b=0;b<arguments.length;b++){var I=arguments[b];if(I){var ae=typeof I;if(ae==="string"||ae==="number")i.push(I);else if(Array.isArray(I)&&I.length){var Z=P.apply(null,I);Z&&i.push(Z)}else if(ae==="object")for(var H in I)d.call(I,H)&&I[H]&&i.push(H)}}return i.join(" ")}ee.exports?(P.default=P,ee.exports=P):window.classNames=P})()}(Te={path:He,exports:{},require:function(ee,d){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(d==null&&Te.path)}},Te.exports),Te.exports);function W(ee,d,P){var i,b,I,ae,Z;function H(){var De=Date.now()-ae;De<d&&De>=0?i=setTimeout(H,d-De):(i=null,P||(Z=ee.apply(I,b),I=b=null))}d==null&&(d=100);var ie=function(){I=this,b=arguments,ae=Date.now();var De=P&&!i;return i||(i=setTimeout(H,d)),De&&(Z=ee.apply(I,b),I=b=null),Z};return ie.clear=function(){i&&(clearTimeout(i),i=null)},ie.flush=function(){i&&(Z=ee.apply(I,b),I=b=null,clearTimeout(i),i=null)},ie}W.debounce=W;var $e=W;(function(ee,d){d===void 0&&(d={});var P=d.insertAt;if(ee&&typeof document!="undefined"){var i=document.head||document.getElementsByTagName("head")[0],b=document.createElement("style");b.type="text/css",P==="top"&&i.firstChild?i.insertBefore(b,i.firstChild):i.appendChild(b),b.styleSheet?b.styleSheet.cssText=ee:b.appendChild(document.createTextNode(ee))}})(`.indiana-scroll-container {
  overflow: auto; }
  .indiana-scroll-container--dragging {
    scroll-behavior: auto !important; }
    .indiana-scroll-container--dragging > * {
      pointer-events: none;
      cursor: -webkit-grab;
      cursor: grab; }
  .indiana-scroll-container--hide-scrollbars {
    overflow: hidden;
    overflow: -moz-scrollbars-none;
    -ms-overflow-style: none;
    scrollbar-width: none; }
    .indiana-scroll-container--hide-scrollbars::-webkit-scrollbar {
      display: none !important;
      height: 0 !important;
      width: 0 !important;
      background: transparent !important;
      -webkit-appearance: none !important; }
  .indiana-scroll-container--native-scroll {
    overflow: auto; }

.indiana-dragging {
  cursor: -webkit-grab;
  cursor: grab; }
`);var g,v=(g="indiana-scroll-container",function(ee,d){if(!ee)return g;var P;typeof ee=="string"?P=ee:d=ee;var i=g;return P&&(i+="__"+P),i+(d?Object.keys(d).reduce(function(b,I){var ae=d[I];return ae&&(b+=" "+(typeof ae=="boolean"?i+"--"+I:i+"--"+I+"_"+ae)),b},""):"")}),s=function(ee){function d(P){var i=ee.call(this,P)||this;return i.onEndScroll=function(){i.scrolling=!1,!i.pressed&&i.started&&i.processEnd()},i.onScroll=function(b){var I=i.container.current;I.scrollLeft===i.scrollLeft&&I.scrollTop===i.scrollTop||(i.scrolling=!0,i.processScroll(b),i.onEndScroll())},i.onTouchStart=function(b){var I=i.props.nativeMobileScroll;if(i.isDraggable(b.target))if(i.internal=!0,I&&i.scrolling)i.pressed=!0;else{var ae=b.touches[0];i.processClick(b,ae.clientX,ae.clientY),!I&&i.props.stopPropagation&&b.stopPropagation()}},i.onTouchEnd=function(b){var I=i.props.nativeMobileScroll;i.pressed&&(!i.started||i.scrolling&&I?i.pressed=!1:i.processEnd(),i.forceUpdate())},i.onTouchMove=function(b){var I=i.props.nativeMobileScroll;if(i.pressed&&(!I||!i.isMobile)){var ae=b.touches[0];ae&&i.processMove(b,ae.clientX,ae.clientY),b.preventDefault(),i.props.stopPropagation&&b.stopPropagation()}},i.onMouseDown=function(b){i.isDraggable(b.target)&&i.isScrollable()&&(i.internal=!0,i.props.buttons.indexOf(b.button)!==-1&&(i.processClick(b,b.clientX,b.clientY),b.preventDefault(),i.props.stopPropagation&&b.stopPropagation()))},i.onMouseMove=function(b){i.pressed&&(i.processMove(b,b.clientX,b.clientY),b.preventDefault(),i.props.stopPropagation&&b.stopPropagation())},i.onMouseUp=function(b){i.pressed&&(i.started?i.processEnd():(i.internal=!1,i.pressed=!1,i.forceUpdate(),i.props.onClick&&i.props.onClick(b)),b.preventDefault(),i.props.stopPropagation&&b.stopPropagation())},i.container=ze.createRef(),i.onEndScroll=$e(i.onEndScroll,300),i.scrolling=!1,i.started=!1,i.pressed=!1,i.internal=!1,i.getRef=i.getRef.bind(i),i}return function(P,i){function b(){this.constructor=P}m(P,i),P.prototype=i===null?Object.create(i):(b.prototype=i.prototype,new b)}(d,ee),d.prototype.componentDidMount=function(){var P=this.props.nativeMobileScroll,i=this.container.current;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd),i.addEventListener("touchstart",this.onTouchStart,{passive:!1}),i.addEventListener("mousedown",this.onMouseDown,{passive:!1}),P&&(this.isMobile=this.isMobileDevice(),this.isMobile&&this.forceUpdate())},d.prototype.componentWillUnmount=function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},d.prototype.getElement=function(){return this.container.current},d.prototype.isMobileDevice=function(){return window.orientation!==void 0||navigator.userAgent.indexOf("IEMobile")!==-1},d.prototype.isDraggable=function(P){var i=this.props.ignoreElements;if(i){var b=P.closest(i);return b===null||b.contains(this.getElement())}return!0},d.prototype.isScrollable=function(){var P=this.container.current;return P&&(P.scrollWidth>P.clientWidth||P.scrollHeight>P.clientHeight)},d.prototype.processClick=function(P,i,b){var I=this.container.current;this.scrollLeft=I.scrollLeft,this.scrollTop=I.scrollTop,this.clientX=i,this.clientY=b,this.pressed=!0},d.prototype.processStart=function(P){P===void 0&&(P=!0);var i=this.props.onStartScroll;this.started=!0,P&&document.body.classList.add("indiana-dragging"),i&&i({external:!this.internal}),this.forceUpdate()},d.prototype.processScroll=function(P){if(this.started){var i=this.props.onScroll;i&&i({external:!this.internal})}else this.processStart(!1)},d.prototype.processMove=function(P,i,b){var I=this.props,ae=I.horizontal,Z=I.vertical,H=I.activationDistance,ie=I.onScroll,De=this.container.current;this.started?(ae&&(De.scrollLeft-=i-this.clientX),Z&&(De.scrollTop-=b-this.clientY),ie&&ie({external:!this.internal}),this.clientX=i,this.clientY=b,this.scrollLeft=De.scrollLeft,this.scrollTop=De.scrollTop):(ae&&Math.abs(i-this.clientX)>H||Z&&Math.abs(b-this.clientY)>H)&&(this.clientX=i,this.clientY=b,this.processStart())},d.prototype.processEnd=function(){var P=this.props.onEndScroll;this.container.current&&P&&P({external:!this.internal}),this.pressed=!1,this.started=!1,this.scrolling=!1,this.internal=!1,document.body.classList.remove("indiana-dragging"),this.forceUpdate()},d.prototype.getRef=function(P){[this.container,this.props.innerRef].forEach(function(i){i&&(typeof i=="function"?i(P):i.current=P)})},d.prototype.render=function(){var P=this.props,i=P.children,b=P.draggingClassName,I=P.className,ae=P.style,Z=P.hideScrollbars,H=P.component;return ze.createElement(H,{className:_e(I,this.pressed&&b,v({dragging:this.pressed,"hide-scrollbars":Z,"native-scroll":this.isMobile})),style:ae,ref:this.getRef,onScroll:this.onScroll},i)},d.defaultProps={nativeMobileScroll:!0,hideScrollbars:!0,activationDistance:10,vertical:!0,horizontal:!0,stopPropagation:!1,style:{},component:"div",buttons:[0]},d}(ze.PureComponent);Je.Z=s}}]);
