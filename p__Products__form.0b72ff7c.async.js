(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{"25Dr":function(N,O,e){"use strict";e.r(O);var P=e("14J3"),h=e("BMrR"),F=e("jCWc"),u=e("kPKH"),M=e("5NDa"),x=e("5rEg"),A=e("T2oS"),D=e("W9HT"),g=e("miYZ"),W=e("tsqr"),j=e("k1fw"),_=e("9og8"),v=e("tJVT"),b=e("WmNS"),i=e.n(b),p=e("q1tI"),m=e("VMEa"),n=e("Qurx"),r=e("5qq5"),o=e("F/zT"),c=e("FJDo"),a=e("nhC9"),f=e("tMyG"),s=e("9kvl"),J=e("Ty5D"),H=e("OaEy"),V=e("2fM7"),le=e("+BJd"),U=e("mr32"),G=e("oBTY"),k=e("DVQu"),t=e("nKUr"),ue=function(d){return"".concat(d.productable_type,":").concat(d.productable_id)},oe=function(d){return"".concat(d.class,":").concat(d.id)},de=function(d){var B=d.value,C=d.onChange,L=d.multiple,$=L===void 0?!1:L,K=Object(p.useState)([]),ee=Object(v.a)(K,2),te=ee[0],Q=ee[1],X=Object(p.useState)(!1),ae=Object(v.a)(X,2),ne=ae[0],Y=ae[1],se=Object(p.useState)([]),Z=Object(v.a)(se,2),ce=Z[0],re=Z[1],z=Object(p.useRef)(),w=Object(p.useCallback)(function(l){Q(function(I){return[].concat(Object(G.a)(I),Object(G.a)(l)).filter(function(E,T,S){return S.findIndex(function(ie){return ie.productable_id===E.productable_id})===T})})},[]),y=Object(p.useCallback)(function(){Y(!0),z.current&&z.current.abort(),z.current=new AbortController,Object(k.d)({signal:z.current.signal}).then(function(l){l.success&&w(l.data),Y(!1)}).catch(function(){return Y(!1)})},[]);return Object(p.useEffect)(function(){y()},[]),Object(p.useEffect)(function(){var l=new AbortController;if(B){var I=Array.isArray(B)?B:[B],E=I.map(function(T){return typeof T=="object"?oe(T):String(T)});re(E)}return function(){l.abort()}},[B]),Object(t.jsx)(V.a,{allowClear:!0,style:{width:"100%",minWidth:"150px"},value:ce,onChange:C,mode:$?"multiple":void 0,showSearch:!0,placeholder:Object(t.jsx)(s.a,{id:"select_product",defaultMessage:"Select a product"}),optionFilterProp:"children",filterOption:function(I,E){if(E&&E.children){var T;return(E==null||(T=E.children)===null||T===void 0?void 0:T.toString().toLowerCase().indexOf(I&&I.toLowerCase()||""))>=0}return!1},notFoundContent:ne?Object(t.jsx)(D.a,{size:"small"}):null,children:te.map(function(l){return Object(t.jsxs)(V.a.Option,{value:ue(l),children:[Object(t.jsx)(U.a,{children:Object(t.jsx)(s.a,{id:l.productable_type.split("\\").pop(),defaultMessage:l.productable_type.split("\\").pop()})})," ",l.name," ",Object(t.jsxs)("small",{children:["id:",l.productable_id]})]},l.productable_id)})})},me=de,je=e("Gn8c"),Oe=e("TWax"),be=e("Ug4X"),pe=function(d){var B=Array.isArray(d)?d:[d],C=B.map(function(L){return typeof L=="object"?L:{id:parseInt(L.split(":")[1]),class:L.split(":")[0]}});return C},fe=function(){var d=Object(s.i)(),B=Object(J.h)(),C=B.id,L=B.tab,$=L===void 0?"attributes":L,K=C==="new",ee=Object(p.useState)(),te=Object(v.a)(ee,2),Q=te[0],X=te[1],ae=m.a.useForm(),ne=Object(v.a)(ae,1),Y=ne[0],se=Object(p.useState)(!1),Z=Object(v.a)(se,2),ce=Z[0],re=Z[1],z=Object(p.useCallback)(Object(_.a)(i.a.mark(function y(){var l;return i.a.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,Object(k.c)(Number(C));case 2:l=E.sent,l.success&&(X(Object(j.a)({},l.data)),re(l.data.type==="bundle"));case 4:case"end":return E.stop()}},y)})),[C]);Object(p.useEffect)(function(){if(K){X({name:"..."});return}z()},[C]);var w=Object(p.useMemo)(function(){return{onValuesChange:function(l){l.type&&re(l.type==="bundle")},onFinish:function(){var y=Object(_.a)(i.a.mark(function I(E){var T,S;return i.a.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(console.log("on finish",E.productables),T=Object(j.a)(Object(j.a)({},E),{},{productables:E.productables?pe(E.productables):void 0}),!K){R.next=9;break}return R.next=5,Object(k.a)(T);case 5:S=R.sent,S.success&&s.d.push("/products/".concat(S.data.id)),R.next=13;break;case 9:return R.next=11,Object(k.f)(Number(C),T);case 11:S=R.sent,S.success&&s.d.push("/products/".concat(S.data.id,"/").concat($));case 13:W.default.success(S.message);case 14:case"end":return R.stop()}},I)}));function l(I){return y.apply(this,arguments)}return l}(),initialValues:Q}},[Q,C,$]);return Q?Object(t.jsx)(f.a,{title:K?Object(t.jsx)(s.a,{id:"product"}):Object(t.jsx)(s.a,{id:"product.edit"}),header:{breadcrumb:{routes:[{path:"products",breadcrumbName:d.formatMessage({id:"menu.Products"})},{path:String(C),breadcrumbName:d.formatMessage({id:"form"})},{path:"/",breadcrumbName:d.formatMessage({id:C==="new"?"new":"edit"})},{path:String($),breadcrumbName:d.formatMessage({id:String($)})}]}},children:Object(t.jsxs)(a.a,{tabs:{type:"card",activeKey:$,onChange:function(l){return s.d.push("/products/".concat(C,"/").concat(l))}},children:[Object(t.jsx)(a.a.TabPane,{tab:Object(t.jsx)(s.a,{id:"attributes"}),children:Object(t.jsxs)(m.a,Object(j.a)(Object(j.a)({},w),{},{form:Y,children:[Object(t.jsx)(m.a.Group,{children:Object(t.jsx)(n.a,{width:"md",name:"name",label:Object(t.jsx)(s.a,{id:"name"}),tooltip:Object(t.jsx)(s.a,{id:"name_tooltip"}),placeholder:d.formatMessage({id:"name",defaultMessage:"name"}),required:!0})}),Object(t.jsx)(m.a.Item,{name:"productables",label:Object(t.jsx)(s.a,{id:"productables"}),valuePropName:"value",children:Object(t.jsx)(me,{multiple:ce})}),Object(t.jsxs)(m.a.Group,{children:[Object(t.jsx)(r.a.Group,{name:"type",label:Object(t.jsx)(s.a,{id:"type"}),options:[{label:d.formatMessage({id:"single",defaultMessage:"single"}),value:"single"},{label:d.formatMessage({id:"bundle",defaultMessage:"bundle"}),value:"bundle"}]}),Object(t.jsx)(o.a,{name:"purchasable",label:Object(t.jsx)(s.a,{id:"purchasable"})}),Object(t.jsx)(n.a,{width:"md",name:"teaser_url",label:Object(t.jsx)(s.a,{id:"teaser_url"}),tooltip:Object(t.jsx)(s.a,{id:"teaser_url_tooltip"}),placeholder:d.formatMessage({id:"teaser_url",defaultMessage:"teaser_url"})})]}),Object(t.jsxs)(m.a.Group,{children:[Object(t.jsx)(c.a,{width:"xs",name:"price",label:Object(t.jsx)(s.a,{id:"price"}),tooltip:Object(t.jsx)(s.a,{id:"price_tooltip"}),placeholder:d.formatMessage({id:"price",defaultMessage:"price"}),min:0,max:99999,fieldProps:{step:1}}),Object(t.jsx)(c.a,{width:"xs",name:"tax_rate",label:Object(t.jsx)(s.a,{id:"tax_rate"}),tooltip:Object(t.jsx)(s.a,{id:"tax_rate_tooltip"}),placeholder:d.formatMessage({id:"tax_rate",defaultMessage:"tax_rate"}),initialValue:K?23:void 0,min:0,max:100,fieldProps:{step:1,formatter:function(l){return"".concat(l,"%")},parser:function(l){return l?l.replace("%",""):""}}}),Object(t.jsx)(m.a.Item,{shouldUpdate:!0,label:Object(t.jsx)(s.a,{id:"price_brutto"}),tooltip:Object(t.jsx)(s.a,{id:"price_brutto_tooltip"}),style:{width:104},children:function(l){return Object(t.jsx)(x.a,{disabled:!0,readOnly:!0,value:l.getFieldValue("price")?Math.round(parseInt(l.getFieldValue("price"))*(1+parseInt(l.getFieldValue("tax_rate"))/100)):void 0})}}),Object(t.jsx)(m.a.Item,{shouldUpdate:!0,label:Object(t.jsx)(s.a,{id:"tax_value"}),tooltip:Object(t.jsx)(s.a,{id:"tax_value_tooltip"}),style:{width:104},children:function(l){return Object(t.jsx)(x.a,{disabled:!0,readOnly:!0,value:l.getFieldValue("price")?Math.round(parseInt(l.getFieldValue("price"))*(parseInt(l.getFieldValue("tax_rate"))/100)):void 0})}}),Object(t.jsx)(c.a,{width:"xs",name:"price_old",label:Object(t.jsx)(s.a,{id:"price_old"}),tooltip:Object(t.jsx)(s.a,{id:"price_old_tooltip"}),placeholder:d.formatMessage({id:"price",defaultMessage:"price"}),min:0,max:99999,fieldProps:{step:1}}),Object(t.jsx)(c.a,{initialValue:K?null:void 0,width:"xs",name:"extra_fees",label:Object(t.jsx)(s.a,{id:"extra_fees"}),tooltip:Object(t.jsx)(s.a,{id:"extra_fees_tooltip"}),placeholder:d.formatMessage({id:"extra_fees",defaultMessage:"extra_fees"}),min:0,max:99999,fieldProps:{step:1}})]}),Object(t.jsxs)(m.a.Group,{children:[Object(t.jsx)(n.a,{width:"md",name:"duration",label:Object(t.jsx)(s.a,{id:"duration"}),tooltip:Object(t.jsx)(s.a,{id:"duration_tooltip"}),placeholder:d.formatMessage({id:"duration",defaultMessage:"duration"})}),Object(t.jsx)(c.a,{initialValue:K?null:void 0,width:"xs",name:"limit_per_user",label:Object(t.jsx)(s.a,{id:"limit_per_user"}),tooltip:Object(t.jsx)(s.a,{id:"limit_per_user_tooltip"}),placeholder:d.formatMessage({id:"limit_per_user",defaultMessage:"limit_per_user"}),min:0,max:99999,fieldProps:{step:1}}),Object(t.jsx)(c.a,{initialValue:K?null:void 0,width:"xs",name:"limit_total",label:Object(t.jsx)(s.a,{id:"limit_total"}),tooltip:Object(t.jsx)(s.a,{id:"limit_total_tooltip"}),placeholder:d.formatMessage({id:"limit_total",defaultMessage:"limit_total"}),min:0,max:99999,fieldProps:{step:1}})]})]}))},"attributes"),!K&&Object(t.jsx)(a.a.TabPane,{tab:Object(t.jsx)(s.a,{id:"media"}),children:Object(t.jsx)(m.a,Object(j.a)(Object(j.a)({},w),{},{children:Object(t.jsx)(je.a,{title:"image",action:"/api/admin/products/".concat(C,"/?_method=PUT"),src_name:"poster_url",form_name:"poster",getUploadedSrcField:function(l){return l.file.response.data.image_url},setPath:function(l){return X(function(I){return Object(j.a)(Object(j.a)({},I),l)})}})}))},"media"),!K&&Object(t.jsx)(a.a.TabPane,{tab:Object(t.jsx)(s.a,{id:"categories"}),children:Object(t.jsx)(h.a,{children:Object(t.jsx)(u.a,{span:12,children:Object(t.jsx)(m.a,Object(j.a)(Object(j.a)({},w),{},{children:Object(t.jsx)(m.a.Item,{label:Object(t.jsx)(s.a,{id:"categories"}),name:"categories",valuePropName:"value",children:Object(t.jsx)(Oe.a,{})})}))})})},"categories")]})}):Object(t.jsx)(D.a,{})},he=O.default=fe},"DBJ/":function(N,O,e){"use strict";var P=e("y8nQ"),h=e("Vl3Y"),F=e("etVw"),u=e("q1tI"),M=e.n(u),x=e("9kvl"),A=e("qFDU"),D=e("nKUr"),g=e.n(D),W=function(_){var v=_.onChange,b=_.url,i=_.name,p=_.extra,m=_.accept,n=_.data,r=_.wrapInForm,o=r===void 0?!0:r,c=_.title,a=Object(x.i)();return n&&n[i]&&delete n[i],Object(D.jsx)(A.a,{condition:o,wrap:function(s){return Object(D.jsx)(h.a,{children:s})},children:Object(D.jsx)(F.a,{title:c||Object(D.jsx)(x.a,{id:"upload_click_here"}),placeholder:a.formatMessage({id:"upload_click_here"}),onChange:v,label:Object(D.jsx)(x.a,{id:"upload"}),max:2,fieldProps:{data:n,accept:m,name:i,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}},action:"".concat("https://api-stage.escolalms.com").concat(b),extra:p})})};O.a=W},DVQu:function(N,O,e){"use strict";e.d(O,"e",function(){return x}),e.d(O,"a",function(){return D}),e.d(O,"c",function(){return W}),e.d(O,"f",function(){return _}),e.d(O,"b",function(){return b}),e.d(O,"d",function(){return p});var P=e("k1fw"),h=e("9og8"),F=e("WmNS"),u=e.n(F),M=e("9kvl");function x(n,r){return A.apply(this,arguments)}function A(){return A=Object(h.a)(u.a.mark(function n(r,o){return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(M.f)("/api/admin/products",Object(P.a)({method:"GET",params:Object(P.a)(Object(P.a)({},r),{},{per_page:r.pageSize,page:r.current})},o||{})));case 1:case"end":return a.stop()}},n)})),A.apply(this,arguments)}function D(n,r){return g.apply(this,arguments)}function g(){return g=Object(h.a)(u.a.mark(function n(r,o){return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(M.f)("/api/admin/products",Object(P.a)({method:"POST",data:r},o||{})));case 1:case"end":return a.stop()}},n)})),g.apply(this,arguments)}function W(n,r){return j.apply(this,arguments)}function j(){return j=Object(h.a)(u.a.mark(function n(r,o){return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(M.f)("/api/admin/products/".concat(r),Object(P.a)({method:"GET"},o||{})));case 1:case"end":return a.stop()}},n)})),j.apply(this,arguments)}function _(n,r,o){return v.apply(this,arguments)}function v(){return v=Object(h.a)(u.a.mark(function n(r,o,c){return u.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",Object(M.f)("/api/admin/products/".concat(r,"?_method=PUT"),Object(P.a)({method:"POST",data:o},c||{})));case 1:case"end":return f.stop()}},n)})),v.apply(this,arguments)}function b(n,r){return i.apply(this,arguments)}function i(){return i=Object(h.a)(u.a.mark(function n(r,o){return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(M.f)("/api/admin/products/".concat(r),Object(P.a)({method:"DELETE"},o||{})));case 1:case"end":return a.stop()}},n)})),i.apply(this,arguments)}function p(n){return m.apply(this,arguments)}function m(){return m=Object(h.a)(u.a.mark(function n(r){return u.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(M.f)("/api/admin/productables",Object(P.a)({method:"GET"},r||{})));case 1:case"end":return c.stop()}},n)})),m.apply(this,arguments)}},Gn8c:function(N,O,e){"use strict";var P=e("14J3"),h=e("BMrR"),F=e("XCrF"),u=e("1GRj"),M=e("jCWc"),x=e("kPKH"),A=e("+L6B"),D=e("2/Rp"),g=e("jrin"),W=e("q1tI"),j=e.n(W),_=e("VMEa"),v=e("DBJ/"),b=e("9kvl"),i=e("nKUr"),p=e.n(i),m=function(r){var o=r.title,c=r.action,a=r.form_name,f=r.src_name,s=r.getUploadedSrcField,J=r.setPath;return Object(i.jsx)(_.a.Group,{title:Object(i.jsx)(b.a,{id:o}),children:Object(i.jsxs)(h.a,{children:[Object(i.jsx)(x.a,{children:Object(i.jsx)(_.a.Item,{shouldUpdate:!0,children:function(V){return Object(i.jsxs)(j.a.Fragment,{children:[Object(i.jsx)(v.a,{accept:"image/*",name:a,url:c,onChange:function(U){if(U.file.status==="done"){var G;V.setFieldsValue(Object(g.a)({},f,s(U))),J((G={},Object(g.a)(G,"".concat(a,"_url"),U.file.response.data["".concat(a,"_url")]),Object(g.a)(G,"".concat(a,"_path"),U.file.response.data["".concat(a,"_path")]),G))}}}),Object(i.jsx)(D.a,{danger:!0,onClick:function(){var U;return[J((U={},Object(g.a)(U,"".concat(a,"_url"),""),Object(g.a)(U,"".concat(a,"_path"),""),U)),V.setFieldsValue(Object(g.a)({},f,""))]},children:Object(i.jsx)(b.a,{id:"delete"})})]})}})}),Object(i.jsx)(x.a,{span:24,children:Object(i.jsx)(_.a.Item,{shouldUpdate:!0,children:function(V){return Object(i.jsx)(u.a,{width:200,src:V.getFieldValue(f)})}})})]})})};O.a=m},JifO:function(N,O,e){"use strict";e.d(O,"c",function(){return x}),e.d(O,"a",function(){return D}),e.d(O,"b",function(){return W}),e.d(O,"d",function(){return _}),e.d(O,"f",function(){return b}),e.d(O,"e",function(){return p});var P=e("k1fw"),h=e("9og8"),F=e("WmNS"),u=e.n(F),M=e("9kvl");function x(n){return A.apply(this,arguments)}function A(){return A=Object(h.a)(u.a.mark(function n(r){return u.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(M.f)("/api/admin/categories/tree",Object(P.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return c.stop()}},n)})),A.apply(this,arguments)}function D(n){return g.apply(this,arguments)}function g(){return g=Object(h.a)(u.a.mark(function n(r){return u.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(M.f)("/api/admin/categories",Object(P.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return c.stop()}},n)})),g.apply(this,arguments)}function W(n,r){return j.apply(this,arguments)}function j(){return j=Object(h.a)(u.a.mark(function n(r,o){return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(M.f)("/api/admin/categories/".concat(r),Object(P.a)({method:"GET",useCache:!1},o||{})));case 1:case"end":return a.stop()}},n)})),j.apply(this,arguments)}function _(n,r){return v.apply(this,arguments)}function v(){return v=Object(h.a)(u.a.mark(function n(r,o){return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(M.f)("/api/admin/categories",Object(P.a)({method:"POST",headers:{"Content-Type":"application/json"},data:r},o||{})));case 1:case"end":return a.stop()}},n)})),v.apply(this,arguments)}function b(n,r,o){return i.apply(this,arguments)}function i(){return i=Object(h.a)(u.a.mark(function n(r,o,c){return u.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",Object(M.f)("/api/admin/categories/".concat(r),Object(P.a)({method:"PUT",headers:{"Content-Type":"application/json"},data:o},c||{})));case 1:case"end":return f.stop()}},n)})),i.apply(this,arguments)}function p(n,r,o){return m.apply(this,arguments)}function m(){return m=Object(h.a)(u.a.mark(function n(r,o,c){return u.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",Object(M.f)("/api/admin/categories/".concat(r),Object(P.a)({method:"DELETE",headers:{"Content-Type":"application/json"},data:o},c||{})));case 1:case"end":return f.stop()}},n)})),m.apply(this,arguments)}},TWax:function(N,O,e){"use strict";var P=e("ozfa"),h=e("MJZm"),F=e("T2oS"),u=e("W9HT"),M=e("tJVT"),x=e("q1tI"),A=e.n(x),D=e("JifO"),g=e("nKUr"),W=e.n(g),j=function v(b){return b.subcategories&&b.subcategories.length?{title:b.name,key:b.id,children:b.subcategories.map(function(i){return v(i)})}:{title:b.name,key:b.id}},_=function(b){var i=b.value,p=b.onChange,m=b.multiple,n=m===void 0?!0:m,r=Object(x.useState)([]),o=Object(M.a)(r,2),c=o[0],a=o[1];Object(x.useEffect)(function(){Object(D.c)().then(function(s){return a(s.data)})},[]);var f=Object(x.useMemo)(function(){return c.map(function(s){return j(s)})},[c]);return c.length===0?Object(g.jsx)(u.a,{}):Object(g.jsx)(h.a,{multiple:n,checkable:!0,checkStrictly:!0,defaultExpandAll:!0,style:{width:"100%"},checkedKeys:i,onCheck:function(J){var H=J.checked;return p&&Array.isArray(H)&&p(H)},treeData:f,disabled:c.length===0})};O.a=_},Ug4X:function(N,O,e){}}]);
