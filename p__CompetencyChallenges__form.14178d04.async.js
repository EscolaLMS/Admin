(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"/y+f":function($e,M,e){"use strict";e.d(M,"g",function(){return p}),e.d(M,"e",function(){return o}),e.d(M,"f",function(){return F}),e.d(M,"d",function(){return K}),e.d(M,"a",function(){return J}),e.d(M,"c",function(){return I}),e.d(M,"b",function(){return H});var p;(function(i){i.Unselected="",i.RichText="EscolaLms\\TopicTypes\\Models\\TopicContent\\RichText",i.OEmbed="EscolaLms\\TopicTypes\\Models\\TopicContent\\OEmbed",i.Audio="EscolaLms\\TopicTypes\\Models\\TopicContent\\Audio",i.Video="EscolaLms\\TopicTypes\\Models\\TopicContent\\Video",i.H5P="EscolaLms\\TopicTypes\\Models\\TopicContent\\H5P",i.Image="EscolaLms\\TopicTypes\\Models\\TopicContent\\Image",i.PDF="EscolaLms\\TopicTypes\\Models\\TopicContent\\PDF",i.SCORM="EscolaLms\\TopicTypes\\Models\\TopicContent\\ScormSco",i.Project="EscolaLms\\TopicTypeProject\\Models\\Project",i.GiftQuiz="EscolaLms\\TopicTypeGift\\Models\\GiftQuiz"})(p||(p={}));var N;(function(i){i.OrderPaid="EscolaLms\\Cart\\Events\\OrderPaid",i.UserLogged="EscolaLms\\Auth\\Events\\UserLogged"})(N||(N={}));var O;(function(i){i.draft="draft",i.published="published",i.archived="archived"})(O||(O={}));var o;(function(i){i.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",i.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",i.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel"})(o||(o={}));var F;(function(i){i.ManuallyTriggeredEvent="EscolaLms\\Templates\\Events\\ManuallyTriggeredEvent"})(F||(F={}));var je;(function(i){i.cart_fixed="cart_fixed",i.cart_percent="cart_percent",i.product_fixed="product_fixed",i.product_percent="product_percent"})(je||(je={}));var K;(function(i){i.MULTIPLE_CHOICE="multiple_choice",i.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS="multiple_choice_with_multiple_right_answers",i.TRUE_FALSE="true_false",i.SHORT_ANSWERS="short_answers",i.MATCHING="matching",i.NUMERICAL_QUESTION="numerical_question",i.ESSAY="essay",i.DESCRIPTION="description"})(K||(K={}));var J;(function(i){i.PRESENT="present",i.PRESENT_NOT_EXERCISING="present_not_exercising",i.ABSENT="absent",i.EXCUSED_ABSENCE="excused_absence"})(J||(J={}));var I;(function(i){i.Manual="manual",i.TeamsForms="teams_forms",i.TeamsLecture="teams_lecture",i.TestPortal="test_portal"})(I||(I={}));var H;(function(i){i.Simple="simple",i.Complex="complex"})(H||(H={}))},"60mZ":function($e,M,e){},EKp7:function($e,M,e){"use strict";e.r(M);var p=e("T2oS"),N=e("W9HT"),O=e("q1tI"),o=e("9kvl"),F=e("Ty5D"),je=e("tMyG"),K=e("nhC9"),J=e("tKSU"),I=e("qLMh"),H=e("miYZ"),i=e("tsqr"),ne=e("9og8"),D=e("k1fw"),C=e("PpiC"),y=e("tJVT"),n=e("VMEa"),w=e("Qurx"),Q=e("yj/a"),se=e("F/zT"),_=e("BiO0"),E=e("CEpB"),f=e("0WSk"),x=e("Gn8c"),U=e("hd5d"),j=e("YRX9"),$=e("/y+f"),r=e("nKUr"),ie=["authors","category"],fe=Object.values($.b).map(function(pe){return{value:pe,label:Object(r.jsx)(o.a,{id:"CompetencyChallenges.types.".concat(pe)})}}),Ee=function(){var X=Object(J.b)(),b=X.competencyChallenge,Z=X.categoryDepths,A=X.refreshData,k=Object(F.l)(),B=Number(k.id),ce=Object(o.l)(),ye=n.a.useForm(),Oe=Object(y.a)(ye,1),ue=Oe[0],ge=n.a.useWatch("type",ue),he=Number.isNaN(B),_e=Object(O.useMemo)(function(){if(!(b!=null&&b.data))return{};var ee=b==null?void 0:b.data,z=ee.authors,G=ee.category,Y=Object(C.a)(ee,ie);return Object(D.a)(Object(D.a)({},Y),{},{authors:z.map(function(te){var ae=te.id;return ae}),category_id:G==null?void 0:G.id})},[b==null?void 0:b.data]),Ce=Object(O.useCallback)(function(){var ee=Object(ne.a)(Object(I.a)().mark(function z(G){var Y,te,ae,le,be,T;return Object(I.a)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Y=G.name,te=G.type,ae=G.is_active,le=ae===void 0?!1:ae,be=G.category_id,t.prev=1,t.next=4,Object(j.a)({name:Y,is_active:le,type:te,category_id:be});case 4:if(T=t.sent,T.success){t.next=8;break}return i.b.error(T.message),t.abrupt("return");case 8:return i.b.success(ce.formatMessage({id:T.message})),o.f.push("/competency-challenges/".concat(T.data.id,"/main")),t.next=12,A();case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),i.b.error(ce.formatMessage({id:"error"}));case 17:case"end":return t.stop()}},z,null,[[1,14]])}));return function(z){return ee.apply(this,arguments)}}(),[]),Fe=Object(O.useCallback)(function(){var ee=Object(ne.a)(Object(I.a)().mark(function z(G){var Y,te,ae,le;return Object(I.a)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.prev=0,Y=ue.getFieldsValue(["image_url","image_path"]),te=Y.image_url,ae=Y.image_path,T.next=4,Object(j.g)(B,Object(D.a)(Object(D.a)({},G),{},{image_url:te,image_path:ae}));case 4:if(le=T.sent,le.success){T.next=8;break}return i.b.error(le.message),T.abrupt("return");case 8:return i.b.success(ce.formatMessage({id:le.message})),T.next=11,A();case 11:T.next=16;break;case 13:T.prev=13,T.t0=T.catch(0),i.b.error(ce.formatMessage({id:"error"}));case 16:case"end":return T.stop()}},z,null,[[0,13]])}));return function(z){return ee.apply(this,arguments)}}(),[B]);return Object(r.jsxs)(n.a,{form:ue,initialValues:_e,onFinish:he?Ce:Fe,onValuesChange:function(z){(z==null?void 0:z.type)==="complex"&&ue.setFieldValue("category",null)},children:[Object(r.jsxs)(n.a.Group,{title:Object(r.jsx)(o.a,{id:"CompetencyChallenges.base"}),children:[Object(r.jsx)(w.a,{width:"md",name:"name",label:Object(r.jsx)(o.a,{id:"name"}),placeholder:ce.formatMessage({id:"name"}),required:!0,rules:[{required:!0,message:ce.formatMessage({id:"field_required"})}]}),Object(r.jsx)(Q.a,{width:"md",name:"type",label:Object(r.jsx)(o.a,{id:"type"}),options:fe,required:!0,rules:[{required:!0,message:ce.formatMessage({id:"field_required"})}]}),ge==="simple"&&Object(r.jsx)(n.a.Item,{name:"category_id",required:!0,label:Object(r.jsx)(o.a,{id:"category"}),rules:[{required:!0,message:ce.formatMessage({id:"field_required"})}],children:Object(r.jsx)(E.a,{enabledDepth:Z.main})}),Object(r.jsx)(se.a,{name:"is_active",label:Object(r.jsx)(o.a,{id:"is_active"})})]}),!he&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(n.a.Group,{title:Object(r.jsx)(o.a,{id:"CompetencyChallenges.additional"}),children:[Object(r.jsx)(n.a.Item,{name:"description",label:Object(r.jsx)(o.a,{id:"description"}),valuePropName:"value",style:{width:440},children:Object(r.jsx)(U.a,{directory:"competency-challenges/".concat(B)})}),Object(r.jsx)(_.a,{width:"lg",name:"summary",label:Object(r.jsx)(o.a,{id:"summary"})}),Object(r.jsx)(n.a.Item,{name:"authors",label:Object(r.jsx)(o.a,{id:"author"}),style:{width:"100%",maxWidth:440},children:Object(r.jsx)(f.a,{multiple:!0})})]}),Object(r.jsx)(x.a,{wrapInForm:!1,folder:"/competency-challenges/".concat(B),title:"image",action:"/api/admin/competency-challenges/".concat(B,"?_method=PATCH"),src_name:"image_url",form_name:"image",getUploadedSrcField:function(z){return z.file.response.data.image_url},setPath:function(z){return ue.setFieldsValue(z)}})]})]})},Me=e("P2fV"),P=e("NJEC"),V=e("5Dmo"),Se=e("3S7+"),S=e("+L6B"),W=e("2/Rp"),ve=e("G3dp"),Le=e("/MfK"),Ne=e("Hn4i"),We=e("enqX"),a=["scale_min","category_id"],Ie=[{title:Object(r.jsx)(o.a,{id:"ID"}),dataIndex:"id",editable:!1,render:function(X,b){if(typeof b.id!="string")return"-";var Z=b.id.split("-"),A=Object(y.a)(Z,2),k=A[0],B=A[1];return k==="new"?"-":B}},{title:Object(r.jsx)(o.a,{id:"min_points"}),dataIndex:"scale_min",valueType:"digit",formItemProps:{rules:[{required:!0,message:Object(r.jsx)(o.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(r.jsx)(o.a,{id:"number_between",values:{min:0}})}]},fieldProps:{min:0}},{title:Object(r.jsx)(o.a,{id:"category"}),dataIndex:"category_id",render:function(X,b){return b.category_name},formItemProps:{rules:[{required:!0,message:Object(r.jsx)(o.a,{id:"field_required"})}]},renderFormItem:function(X,b,Z){var A,k=((A=Z.getFieldValue("table"))!==null&&A!==void 0?A:[]).map(function(B){return B.category_id});return Object(r.jsx)(We.a,{disabledNodes:k})}}],Be=function(X){return X.map(function(b){var Z=b.id,A=b.scale_min,k=b.category;return{id:"old-".concat(Z),scale_min:A,category_id:k.id,category_name:k.name_with_breadcrumbs}})},Ke=function(){var X,b,Z=Object(J.b)(),A=Z.competencyChallenge,k=Z.refreshData,B=Object(F.l)(),ce=Number(B.id),ye=(X=A==null||(b=A.data)===null||b===void 0?void 0:b.scales)!==null&&X!==void 0?X:[],Oe=Object(O.useState)([]),ue=Object(y.a)(Oe,2),ge=ue[0],he=ue[1],_e=Object(o.l)(),Ce=Object(O.useRef)(),Fe=Object(O.useRef)(),ee=Object(O.useRef)(),z=Object(O.useMemo)(function(){return Be(ye)},[ye]),G=Object(O.useMemo)(function(){return[].concat(Ie,[{valueType:"option",title:Object(r.jsx)(o.a,{id:"options"}),render:function(te,ae,le,be){return[Object(r.jsx)(Se.a,{title:Object(r.jsx)(o.a,{id:"edit",defaultMessage:"edit"}),children:Object(r.jsx)(W.a,{type:"primary",icon:Object(r.jsx)(ve.a,{}),onClick:function(){return be==null?void 0:be.startEditable(ae.id)}})},"edit"),Object(r.jsx)(P.a,{title:Object(r.jsx)(o.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(ne.a)(Object(I.a)().mark(function T(){var d,t,s,c,u,m,v,h;return Object(I.a)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(typeof ae.id=="string"){l.next=2;break}return l.abrupt("return");case 2:if(d=ae.id.split("-"),t=Object(y.a)(d,2),s=t[0],c=t[1],s!=="new"){l.next=7;break}return v=(u=Ce.current)===null||u===void 0?void 0:u.getFieldValue("table"),(m=Ce.current)===null||m===void 0||m.setFieldValue("table",v.filter(function(R){var re=R.id;return re!==ae.id})),l.abrupt("return");case 7:return l.next=9,Object(j.d)(+c);case 9:if(h=l.sent,!h.success){l.next=13;break}return l.next=13,k();case 13:case"end":return l.stop()}},T)})),okText:Object(r.jsx)(o.a,{id:"ok"}),cancelText:Object(r.jsx)(o.a,{id:"cancel"}),children:Object(r.jsx)(Se.a,{title:Object(r.jsx)(o.a,{id:"delete",defaultMessage:"delete"}),children:Object(r.jsx)(W.a,{type:"primary",icon:Object(r.jsx)(Le.a,{}),danger:!0})})},"delete")]}}])},[]);return Object(r.jsx)(n.a,{formRef:Ce,initialValues:{table:z},submitter:!1,children:Object(r.jsx)(Ne.a,{rowKey:function(te){return te.id},editableFormRef:Fe,controlled:!0,actionRef:ee,name:"table",columns:G,recordCreatorProps:{creatorButtonText:Object(r.jsx)(o.a,{id:"CompetencyChallenges.addNewRow"}),disabled:ge.length>0,record:function(te){return{id:"new-".concat(te)}}},editable:{onlyOneLineEditorAlertMessage:_e.formatMessage({id:"CompetencyChallenges.onlyOneRowIsEditable"}),onSave:function(){var Y=Object(ne.a)(Object(I.a)().mark(function ae(le,be){var T,d,t,s,c,u,m,v,h;return Object(I.a)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(T=be.scale_min,d=be.category_id,t=Object(C.a)(be,a),typeof t.id=="string"){l.next=3;break}return l.abrupt("return");case 3:if(s=t.id.split("-"),c=Object(y.a)(s,2),u=c[0],m=c[1],u!=="new"){l.next=12;break}return l.next=7,Object(j.b)({scale_min:T,category_id:d,competency_challenge_id:ce});case 7:if(v=l.sent,!v.success){l.next=11;break}return l.next=11,k();case 11:return l.abrupt("return");case 12:return l.next=14,Object(j.h)(+m,{scale_min:T,category_id:d,competency_challenge_id:ce});case 14:if(h=l.sent,!h.success){l.next=18;break}return l.next=18,k();case 18:return l.abrupt("return");case 19:case"end":return l.stop()}},ae)}));function te(ae,le){return Y.apply(this,arguments)}return te}(),deletePopconfirmMessage:Object(r.jsx)(o.a,{id:"deleteQuestion"}),actionRender:function(te,ae,le){if(typeof te.id!="string")return[];var be=te.id.split("-"),T=Object(y.a)(be,1),d=T[0];return d==="new"?[le.save,le.delete]:[le.save,le.cancel]},type:"single",editableKeys:ge,onChange:he}})})},Je=e("/zsF"),ze=e("PArb"),Ve=e("DYRE"),Re=e("zeV3"),Ge=e("uD7z"),we=e("FJDo"),He=e("yioT"),ke=e("qRSf"),oe=function(){var X=Object(J.b)(),b=X.competencyChallenge.data,Z=Object(O.useState)(!1),A=Object(y.a)(Z,2),k=A[0],B=A[1],ce=Object(O.useState)(),ye=Object(y.a)(ce,2),Oe=ye[0],ue=ye[1],ge=Object(o.l)(),he=Object(O.useCallback)(function(){(b==null?void 0:b.quiz_id)!==void 0&&(B(!0),Object(ke.c)(b==null?void 0:b.quiz_id).then(function(Ce){Ce.success&&ue(Ce.data)}).finally(function(){return B(!1)}))},[b==null?void 0:b.quiz_id]),_e=Object(O.useCallback)(function(){var Ce=Object(ne.a)(Object(I.a)().mark(function Fe(ee){return Object(I.a)().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if((b==null?void 0:b.quiz_id)!==void 0){G.next=2;break}return G.abrupt("return");case 2:B(!0),Object(ke.f)(b==null?void 0:b.quiz_id,Object(D.a)(Object(D.a)({},ee),{},{value:"diagnostic-test"})).then(function(Y){Y.success&&ue(Y.data)}).finally(function(){return B(!1)});case 4:case"end":return G.stop()}},Fe)}));return function(Fe){return Ce.apply(this,arguments)}}(),[]);return Object(O.useEffect)(function(){he()},[he]),Oe?Object(r.jsxs)("div",{style:{position:"relative",paddingBottom:"64px"},children:[Object(r.jsx)(n.a,{submitter:{render:function(Fe,ee){var z=Object(y.a)(ee,2),G=z[0],Y=z[1];return Object(r.jsxs)(Re.b,{style:{position:"absolute",bottom:0,left:0},children:[G,Y]})}},initialValues:Oe,onFinish:_e,children:Object(r.jsxs)(Ge.a,{children:[Object(r.jsx)(we.a,{name:"max_attempts",label:Object(r.jsx)(o.a,{id:"max_attempts"}),tooltip:Object(r.jsx)(o.a,{id:"max_attempts"}),placeholder:ge.formatMessage({id:"max_attempts",defaultMessage:"max_attempts"})}),Object(r.jsx)(we.a,{name:"max_execution_time",label:Object(r.jsx)(o.a,{id:"max_execution_time"}),tooltip:Object(r.jsx)(o.a,{id:"max_execution_time"}),placeholder:ge.formatMessage({id:"max_execution_time",defaultMessage:"max_execution_time"})})]})}),Object(r.jsx)(ze.a,{}),Object(r.jsx)(He.a,{questions:Oe.questions,quizId:Oe.id,onAdded:he,onEdited:he,onRemoved:he,tableHeader:Object(r.jsx)(o.a,{id:"questions"}),tableLoading:k,questionsCategory:{type:"question"}})]}):Object(r.jsx)(N.a,{})},Xe=function(){var X,b=Object(J.b)(),Z=b.competencyChallenge,A=Object(o.l)(),k=Object(F.l)(),B=k.id,ce=k.tab,ye=ce===void 0?"main":ce,Oe=B==="new",ue=Object(O.useMemo)(function(){var ge;return Oe?A.formatMessage({id:"CompetencyChallenges.new_challenge"}):(ge=Z.data)!==null&&ge!==void 0&&ge.name?Z.data.name:A.formatMessage({id:"menu.Competency challenges"})},[A,(X=Z.data)===null||X===void 0?void 0:X.name]);return Object(r.jsx)(je.a,{title:ue,header:{breadcrumb:{routes:[{path:"competency-challenges",breadcrumbName:A.formatMessage({id:"menu.Competency challenges"})},{path:String(B),breadcrumbName:ue},{path:ye,breadcrumbName:A.formatMessage({id:"CompetencyChallenges.".concat(ye)})}]}},children:Object(r.jsxs)(K.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",cardProps:{loading:Z.loading&&Object(r.jsx)(N.a,{})},activeKey:ye,onChange:function(he){o.f.push("/competency-challenges/".concat(B,"/").concat(he))}},children:[Object(r.jsx)(K.a.TabPane,{tab:Object(r.jsx)(o.a,{id:"CompetencyChallenges.main"}),children:Object(r.jsx)(Ee,{})},"main"),Object(r.jsx)(K.a.TabPane,{tab:Object(r.jsx)(o.a,{id:"CompetencyChallenges.scales"}),disabled:Oe,children:Object(r.jsx)(Ke,{})},"scales"),Object(r.jsx)(K.a.TabPane,{tab:Object(r.jsx)(o.a,{id:"CompetencyChallenges.diagnostic-test"}),disabled:Oe,children:Object(r.jsx)(oe,{})},"diagnostic-test")]})})},nt=function(){return Object(r.jsx)(J.a,{children:Object(r.jsx)(Xe,{})})},st=M.default=nt},YRX9:function($e,M,e){"use strict";e.d(M,"f",function(){return F}),e.d(M,"e",function(){return K}),e.d(M,"a",function(){return I}),e.d(M,"g",function(){return i}),e.d(M,"c",function(){return D}),e.d(M,"b",function(){return y}),e.d(M,"h",function(){return w}),e.d(M,"d",function(){return se});var p=e("qLMh"),N=e("k1fw"),O=e("9og8"),o=e("9kvl");function F(E,f){return je.apply(this,arguments)}function je(){return je=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges",Object(N.a)({method:"GET",useCache:!1,params:f},x||{})));case 1:case"end":return j.stop()}},E)})),je.apply(this,arguments)}function K(E,f){return J.apply(this,arguments)}function J(){return J=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges/".concat(f),Object(N.a)({method:"GET",useCache:!1},x||{})));case 1:case"end":return j.stop()}},E)})),J.apply(this,arguments)}function I(E,f){return H.apply(this,arguments)}function H(){return H=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges",Object(N.a)({method:"POST",headers:{"Content-Type":"application/json"},data:f},x||{})));case 1:case"end":return j.stop()}},E)})),H.apply(this,arguments)}function i(E,f,x){return ne.apply(this,arguments)}function ne(){return ne=Object(O.a)(Object(p.a)().mark(function E(f,x,U){return Object(p.a)().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.abrupt("return",Object(o.i)("/api/admin/competency-challenges/".concat(f),Object(N.a)({method:"PUT",headers:{"Content-Type":"application/json"},data:x},U||{})));case 1:case"end":return $.stop()}},E)})),ne.apply(this,arguments)}function D(E,f){return C.apply(this,arguments)}function C(){return C=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges/".concat(f),Object(N.a)({method:"DELETE"},x||{})));case 1:case"end":return j.stop()}},E)})),C.apply(this,arguments)}function y(E,f){return n.apply(this,arguments)}function n(){return n=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges/scales",Object(N.a)({method:"POST",headers:{"Content-Type":"application/json"},data:f},x||{})));case 1:case"end":return j.stop()}},E)})),n.apply(this,arguments)}function w(E,f,x){return Q.apply(this,arguments)}function Q(){return Q=Object(O.a)(Object(p.a)().mark(function E(f,x,U){return Object(p.a)().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.abrupt("return",Object(o.i)("/api/admin/competency-challenges/scales/".concat(f),Object(N.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:x},U||{})));case 1:case"end":return $.stop()}},E)})),Q.apply(this,arguments)}function se(E,f){return _.apply(this,arguments)}function _(){return _=Object(O.a)(Object(p.a)().mark(function E(f,x){return Object(p.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(o.i)("/api/admin/competency-challenges/scales/".concat(f),Object(N.a)({method:"DELETE"},x||{})));case 1:case"end":return j.stop()}},E)})),_.apply(this,arguments)}},enqX:function($e,M,e){"use strict";e.d(M,"a",function(){return ne});var p=e("nRaC"),N=e("5RzL"),O=e("tJVT"),o=e("q1tI"),F=e.n(o),je=e("9kvl"),K=e("JifO"),J=e("tKSU"),I=e("nKUr"),H=e.n(I),i=function D(C,y,n){var w,Q=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return(w=C.subcategories)!==null&&w!==void 0&&w.length?{title:C.name,value:C.id,disabled:Q!==n||y.includes(C.id),children:C.subcategories.map(function(se){return D(se,y,n,Q+1)})}:{title:C.name,value:C.id,disabled:Q!==n||y.includes(C.id)}},ne=function(C){var y,n,w,Q=C.value,se=C.onChange,_=C.type,E=_===void 0?"scale":_,f=C.disabledNodes,x=f===void 0?[]:f,U=Object(o.useState)([]),j=Object(O.a)(U,2),$=j[0],r=j[1],ie=Object(J.b)(),fe=ie.categoryDepths,Ee=ie.competencyChallenge,Me=Object(o.useMemo)(function(){var V;return((V=Ee.data)===null||V===void 0?void 0:V.type)==="simple"?$.filter(function(Se){var S,W;return Se.id===((S=Ee.data)===null||S===void 0||(W=S.category)===null||W===void 0?void 0:W.id)}):$},[$,(y=Ee.data)===null||y===void 0?void 0:y.type,(n=Ee.data)===null||n===void 0||(w=n.category)===null||w===void 0?void 0:w.id]),P=Object(o.useMemo)(function(){return Me.map(function(V){return i(V,x,fe[E])})},[Me,x,E]);return Object(o.useEffect)(function(){Object(K.c)().then(function(V){V.success&&r(V.data)})},[]),Object(I.jsx)(N.a,{loading:$.length===0,showSearch:!0,value:Q,dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:Object(I.jsx)(je.a,{id:"select",defaultMessage:"Please select"}),allowClear:!0,treeDefaultExpandAll:!0,onChange:se,treeData:P,disabled:$.length===0})}},hd5d:function($e,M,e){"use strict";var p=e("qLMh"),N=e("9og8"),O=e("q1tI"),o=e.n(O),F=e("acco"),je=e.n(F),K=e("BAh9"),J=e("vtG9"),I=e.n(J),H=e("9kvl"),i=e("nKUr"),ne=e.n(i),D=function(n){var w=n.attrs,Q=w.href,se=Q.split("/").pop();return Object(i.jsx)("p",{children:Object(i.jsx)("a",{rel:"noreferrer",href:Q,target:"_blank",children:se})})},C=function(n){var w=n.value,Q=n.onChange,se=n.directory,_=se===void 0?"/wysiwyg":se,E=Object(H.l)();return Object(i.jsx)("div",{className:"form-wysiwyg-markdown",children:Object(i.jsx)(je.a,{excludeBlockMenuItems:["Sketch"],embeds:[{matcher:function(x){return!0},component:D}],uploadImage:function(){var f=Object(N.a)(Object(p.a)().mark(function x(U){var j,$;return Object(p.a)().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,Object(K.e)(U,_);case 2:if(j=ie.sent,!j.success){ie.next=8;break}if(!U.type.includes("image/")){ie.next=7;break}return $=j.data[0].name.includes("/")?j.data[0].name:"".concat(_).concat(j.data[0].name),ie.abrupt("return",Object(K.d)($,1e3));case 7:return ie.abrupt("return",j.data[0].url);case 8:throw new Error("Error while uploading");case 9:case"end":return ie.stop()}},x)}));return function(x){return f.apply(this,arguments)}}(),defaultValue:w||"",onChange:function(x){return Q&&Q(x())},placeholder:E.formatMessage({id:"wysiwyg_placeholder"})})})};M.a=C},tKSU:function($e,M,e){"use strict";e.d(M,"b",function(){return C}),e.d(M,"a",function(){return y});var p=e("k1fw"),N=e("tJVT"),O=e("qLMh"),o=e("9og8"),F=e("q1tI"),je=e.n(F),K=e("Ty5D"),J=e("YRX9"),I=e("+up7"),H=e("nKUr"),i=e.n(H),ne={categoryDepths:{scale:2,question:1,main:0},competencyChallenge:{data:null,loading:!1},refreshData:function(){var n=Object(o.a)(Object(O.a)().mark(function Q(){return Object(O.a)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",console.warn("CONTEXT INIT"));case 1:case"end":return _.stop()}},Q)}));function w(){return n.apply(this,arguments)}return w}()},D=je.a.createContext(ne),C=function(){return Object(F.useContext)(D)},y=function(w){var Q=w.children,se=Object(F.useState)(ne.competencyChallenge),_=Object(N.a)(se,2),E=_[0],f=_[1],x=Object(F.useState)(ne.categoryDepths),U=Object(N.a)(x,2),j=U[0],$=U[1],r=Object(K.l)(),ie=r.id,fe=Number(ie),Ee=Object(F.useCallback)(Object(o.a)(Object(O.a)().mark(function P(){var V;return Object(O.a)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!Number.isNaN(fe)){S.next=2;break}return S.abrupt("return");case 2:return S.prev=2,f(function(W){return Object(p.a)(Object(p.a)({},W),{},{loading:!0})}),S.next=6,Object(J.e)(fe);case 6:if(V=S.sent,V.success){S.next=10;break}return f(function(W){return Object(p.a)(Object(p.a)({},W),{},{error:V.errors})}),S.abrupt("return");case 10:f(function(W){return Object(p.a)(Object(p.a)({},W),{},{data:V.data})}),S.next=16;break;case 13:S.prev=13,S.t0=S.catch(2),f(function(W){return Object(p.a)(Object(p.a)({},W),{},{error:S.t0})});case 16:return S.prev=16,f(function(W){return Object(p.a)(Object(p.a)({},W),{},{loading:!1})}),S.finish(16);case 19:case"end":return S.stop()}},P,null,[[2,13,16,19]])})),[fe]),Me=Object(F.useCallback)(Object(o.a)(Object(O.a)().mark(function P(){var V,Se,S,W,ve,Le,Ne,We,a,Ie,Be,Ke,Je,ze,Ve,Re,Ge,we,He;return Object(O.a)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.prev=0,oe.next=3,Object(I.a)();case 3:if(Re=oe.sent,Re.success){oe.next=6;break}return oe.abrupt("return");case 6:Ge=Number((V=Re.data)===null||V===void 0||(Se=V.escolalms_competency_challenge)===null||Se===void 0||(S=Se.category)===null||S===void 0||(W=S.scale)===null||W===void 0||(ve=W.depth)===null||ve===void 0?void 0:ve.value),we=Number((Le=Re.data)===null||Le===void 0||(Ne=Le.escolalms_competency_challenge)===null||Ne===void 0||(We=Ne.category)===null||We===void 0||(a=We.question)===null||a===void 0||(Ie=a.depth)===null||Ie===void 0?void 0:Ie.value),He=Number((Be=Re.data)===null||Be===void 0||(Ke=Be.escolalms_competency_challenge)===null||Ke===void 0||(Je=Ke.category)===null||Je===void 0||(ze=Je.main)===null||ze===void 0||(Ve=ze.depth)===null||Ve===void 0?void 0:Ve.value),$({scale:Number.isNaN(Ge)?2:Ge,question:Number.isNaN(we)?1:we,main:Number.isNaN(He)?0:He}),oe.next=15;break;case 12:oe.prev=12,oe.t0=oe.catch(0),console.error(oe.t0);case 15:case"end":return oe.stop()}},P,null,[[0,12]])})),[]);return Object(F.useEffect)(function(){Ee(),Me()},[Ee,Me]),Object(H.jsx)(D.Provider,{value:{categoryDepths:j,competencyChallenge:E,refreshData:Ee},children:Q})}},vtG9:function($e,M,e){},yioT:function($e,M,e){"use strict";e.d(M,"a",function(){return T});var p=e("tU7J"),N=e("wFql"),O=e("BoS7"),o=e("Sdc0"),F=e("oBTY"),je=e("+L6B"),K=e("2/Rp"),J=e("bbsP"),I=e("/wGt"),H=e("qLMh"),i=e("9og8"),ne=e("PpiC"),D=e("tJVT"),C=e("k1fw"),y=e("q1tI"),n=e("9kvl"),w=e("YJCA"),Q=e("wYyv"),se=e("smpX"),_=e("eyie"),E=e("w5pM"),f=e("mWMg"),x=e("Vpfc"),U=e("qRSf"),j=e("DYRE"),$=e("zeV3"),r=e("/zsF"),ie=e("PArb"),fe=e("VMEa"),Ee=e("yj/a"),Me=e("FJDo"),P=e("/y+f"),V=e("enqX"),Se=e("5Dmo"),S=e("3S7+"),W=e("jrin"),ve=e("Qurx"),Le=e("x1Ii"),Ne=e("tneF"),We=e("/MfK"),a=e("nKUr"),Ie,Be=(Ie={},Object(W.a)(Ie,P.d.MULTIPLE_CHOICE,[{isCorrect:!1,value:""},{isCorrect:!1,value:""}]),Object(W.a)(Ie,P.d.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS,[{value:"",weight:""},{value:"",weight:""}]),Ie),Ke=function(t){var s,c=t.type,u=Object(n.l)();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(ve.a,{name:"question",label:Object(a.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(a.jsx)(Le.b,{name:"answers",creatorButtonProps:{creatorButtonText:u.formatMessage({id:"Questions.addAnswer"})},actionRender:function(){return[]},initialValue:(s=Be[c])!==null&&s!==void 0?s:[],children:function(v,h,L,l){return Object(a.jsxs)(fe.a.Group,{title:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(n.a,{id:"Questions.answer",values:{ordinalNumber:h+1}}),l>2&&Object(a.jsx)(S.a,{title:u.formatMessage({id:"Questions.deleteAnswer"}),children:Object(a.jsx)(K.a,{type:"text",icon:Object(a.jsx)(We.a,{}),onClick:function(){return L.remove(v.name)}})})]}),titleStyle:{width:"100%",display:"flex",justifyContent:"space-between"},children:[c===P.d.MULTIPLE_CHOICE&&Object(a.jsx)(Ne.a,{name:"isCorrect",label:Object(a.jsx)(n.a,{id:"Questions.correctAnswer",defaultMessage:"Is Correct Answer?"}),rules:[function(R){var re=R.getFieldValue;return{validator:function(){var de,Qe=(de=re("answers"))!==null&&de!==void 0?de:[];return Qe.filter(function(xe){return xe==null?void 0:xe.isCorrect}).length>1?Promise.reject("Only one answer can be correct"):Promise.resolve()},message:Object(a.jsx)(n.a,{id:"Questions.onlyOneAnswerIsCorrect"})}}]}),Object(a.jsx)(ve.a,{name:"value",rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],label:Object(a.jsx)(n.a,{id:"content",defaultMessage:"Content"})}),c===P.d.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS&&Object(a.jsx)(Me.a,{name:"weight",rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],fieldProps:{min:-Number.MAX_SAFE_INTEGER,addonAfter:"%"},label:Object(a.jsx)(n.a,{id:"weight",defaultMessage:"Weight"})})]})}})]})},Je=function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(ve.a,{name:"question",label:Object(a.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(a.jsx)(Ne.a,{name:"isCorrect",label:Object(a.jsx)(n.a,{id:"Questions.correctAnswer"})})]})},ze=[{value:""}],Ve=function(){var t=Object(n.l)();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(ve.a,{name:"question",label:Object(a.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(a.jsx)(Le.b,{name:"answers",creatorButtonProps:{creatorButtonText:t.formatMessage({id:"Questions.addAnswer"})},deleteIconProps:{tooltipText:t.formatMessage({id:"Questions.deleteAnswer"})},actionRender:function(c,u,m){var v=Object(D.a)(m,2),h=v[1];return[h]},min:1,initialValue:ze,children:function(c,u){return Object(a.jsx)(ve.a,{name:"value",rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],label:Object(a.jsx)(n.a,{id:"Questions.answer",values:{ordinalNumber:u+1},defaultMessage:"Answer ".concat(u+1)})})}})]})},Re=[{firstOfPair:"",secondOfPair:""}],Ge=function(){var t=Object(n.l)();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(ve.a,{name:"question",label:Object(a.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(a.jsx)(Le.b,{name:"answers",creatorButtonProps:{creatorButtonText:t.formatMessage({id:"Questions.addMatchingPair",defaultMessage:"Add Matching Pair"})},deleteIconProps:{tooltipText:t.formatMessage({id:"Questions.deletePair"})},actionRender:function(c,u,m){var v=Object(D.a)(m,2),h=v[1];return[h]},min:1,initialValue:Re,children:function(c,u){return Object(a.jsxs)(fe.a.Group,{direction:"horizontal",align:"baseline",size:"small",spaceProps:{style:{flexWrap:"nowrap"}},title:Object(a.jsx)(n.a,{id:"Questions.pair",values:{ordinalNumber:u+1},defaultMessage:"Pair ".concat(u+1)}),children:[Object(a.jsx)(ve.a,{name:"firstOfPair",rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}]}),Object(a.jsx)(ve.a,{name:"secondOfPair",rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}]})]})}})]})},we=function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(ve.a,{name:"question",label:Object(a.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(a.jsx)(Me.a,{name:"answer",label:Object(a.jsx)(n.a,{id:"answer"}),rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(a.jsx)(Me.a,{name:"errorMargin",fieldProps:{addonAfter:"+/-"},label:Object(a.jsx)(n.a,{id:"Questions.errorMargin"}),rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],required:!0})]})},He=e("BiO0"),ke=function(){return Object(a.jsx)(He.a,{name:"question",label:Object(a.jsx)(n.a,{id:"question"}),rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],required:!0})},oe=function(t){var s=t.type;if(!s)return null;switch(s){case P.d.MULTIPLE_CHOICE:case P.d.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return Object(a.jsx)(Ke,{type:s});case P.d.TRUE_FALSE:return Object(a.jsx)(Je,{});case P.d.SHORT_ANSWERS:return Object(a.jsx)(Ve,{});case P.d.MATCHING:return Object(a.jsx)(Ge,{});case P.d.NUMERICAL_QUESTION:return Object(a.jsx)(we,{});case P.d.ESSAY:case P.d.DESCRIPTION:return Object(a.jsx)(ke,{})}return Object(a.jsxs)("pre",{children:["Unsupported type ",s]})},Xe=e("rAM+"),nt=function(t){var s=t.question,c=t.answers;if(c.length===0)return"".concat(s,"{}");var u="".concat(s,"{"),m=Object(Xe.a)(c),v;try{for(m.s();!(v=m.n()).done;){var h=v.value,L=h.isCorrect,l=h.value,R=L?"=":"~";u+="".concat(R).concat(l)}}catch(re){m.e(re)}finally{m.f()}return u+="}",u.trim()},st=function(t){var s=t.question,c=t.answers;if(c.length==0)return"".concat(s,"{}");var u="".concat(s,"{"),m=Object(Xe.a)(c),v;try{for(m.s();!(v=m.n()).done;){var h=v.value,L=h.value,l=h.weight;u+="~%".concat(l,"%").concat(L)}}catch(R){m.e(R)}finally{m.f()}return u+="}",u.trim()},pe=function(t){var s=t.question,c=t.isCorrect;return"".concat(s,"{").concat(c?"T":"F","}")},X=function(t){var s=t.question,c=t.answers;if(c.length===0)return"".concat(s,"{}");var u="".concat(s,"{"),m=Object(Xe.a)(c),v;try{for(m.s();!(v=m.n()).done;){var h=v.value,L=h.value;u+="=".concat(L)}}catch(l){m.e(l)}finally{m.f()}return u+="}",u.trim()},b=function(t){var s=t.question,c=t.answers;if(c.length===0)return"".concat(s,"{}");var u="".concat(s,"{"),m=Object(Xe.a)(c),v;try{for(m.s();!(v=m.n()).done;){var h=v.value,L=h.firstOfPair,l=h.secondOfPair;u+="=".concat(L,"->").concat(l)}}catch(R){m.e(R)}finally{m.f()}return u+="}",u.trim()},Z=function(t){var s=t.question,c=t.answer,u=t.errorMargin;return"".concat(s,"{#").concat(c,":").concat(u,"}")},A=function(t){var s=t.question;return"".concat(s,"{}")},k=function(t){var s=t.question;return s},B=function(t){switch(t.type){case P.d.MULTIPLE_CHOICE:return nt(t);case P.d.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return st(t);case P.d.TRUE_FALSE:return pe(t);case P.d.SHORT_ANSWERS:return X(t);case P.d.MATCHING:return b(t);case P.d.NUMERICAL_QUESTION:return Z(t);case P.d.ESSAY:return A(t);case P.d.DESCRIPTION:return k(t);default:throw new Error("Unsupported type: ".concat(t.type))}},ce=function(t,s){var c=s.type,u=s.score,m=s.category_id,v=t==null?void 0:t.stem.text,h=t.choices.every(function(R){var re=R.weight;return re===null});if(h){var L=t.choices.map(function(R){var re=R.isCorrect,Ue=R.text;return{isCorrect:re,value:Ue.text}});return{type:c,score:u,category_id:m,question:v,answers:L}}var l=t.choices.reduce(function(R,re){var Ue=re.weight,de=re.text;return Ue!==null?[].concat(Object(F.a)(R),[{weight:Ue,value:de.text}]):R},[]);return{type:c,score:u,category_id:m,question:v,answers:l}},ye=function(t,s){var c=s.type,u=s.score,m=s.category_id,v=t==null?void 0:t.stem.text,h=t.isTrue;return{type:c,score:u,category_id:m,question:v,isCorrect:h}},Oe=function(t,s){var c=s.type,u=s.score,m=s.category_id,v=t==null?void 0:t.stem.text,h=t.choices.map(function(L){var l=L.text;return{value:l.text}});return{type:c,score:u,category_id:m,question:v,answers:h}},ue=function(t,s){var c=s.type,u=s.score,m=s.category_id,v=t==null?void 0:t.stem.text,h=t.matchPairs.map(function(L){var l=L.subquestion,R=L.subanswer;return{firstOfPair:l.text,secondOfPair:R}});return{type:c,score:u,category_id:m,question:v,answers:h}},ge=function(t,s){var c=s.type,u=s.score,m=s.category_id,v=t==null?void 0:t.stem.text;if(Array.isArray(t==null?void 0:t.choices))throw new Error("Unsupported choices type: array");var h=t==null?void 0:t.choices.number,L=t==null?void 0:t.choices.range;if(h===void 0||L===void 0)throw new Error("Value undefined - answer: ".concat(h," errorMargin: ").concat(L));return{type:c,score:u,category_id:m,question:v,answer:h,errorMargin:L}},he=function(t,s){var c=s.type,u=s.score,m=s.category_id,v=t==null?void 0:t.stem.text;return{type:c,score:u,category_id:m,question:v}};function _e(d){if(!!d){var t=Object(se.parse)(d.value),s=Object(D.a)(t,1),c=s[0];switch(c.type){case"MC":return ce(c,d);case"TF":return ye(c,d);case"Short":return Oe(c,d);case"Matching":return ue(c,d);case"Numerical":return ge(c,d);case"Description":case"Essay":return he(c,d);default:throw new Error("Unsupported type: ".concat(c==null?void 0:c.type))}}}var Ce=["type","score","category"],Fe=Object.values(P.d).reduce(function(d,t){return t?[].concat(Object(F.a)(d),[{value:t,label:Object(a.jsx)(n.a,{id:"gift_type.".concat(t)})}]):d},[]),ee=function(t){var s=t.onSubmit,c=t.values,u=t.competencyChallengeCategoryTreeProps,m=u===void 0?!1:u,v=Object(n.l)(),h=fe.a.useForm(),L=Object(D.a)(h,1),l=L[0],R=fe.a.useWatch("type",l),re=Object(y.useMemo)(function(){return _e(c)},[c]),Ue=Object(y.useCallback)(function(){var de=Object(i.a)(Object(H.a)().mark(function Qe(xe){var et,qe,at,tt;return Object(H.a)().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:return et=B(xe),qe=xe.score,at=xe.category_id,Te.next=4,s({value:et,score:qe,category_id:at});case 4:if(tt=Te.sent,tt){Te.next=7;break}return Te.abrupt("return");case 7:l.resetFields();case 8:case"end":return Te.stop()}},Qe)}));return function(Qe){return de.apply(this,arguments)}}(),[]);return Object(y.useEffect)(function(){l.resetFields()},[re]),Object(y.useEffect)(function(){if(R){var de=l.getFieldsValue(),Qe=Object.keys(de).filter(function(xe){return!Ce.includes(xe)});l.resetFields(Qe)}},[R]),Object(a.jsxs)($.b,{direction:"vertical",style:{display:"flex"},children:[Object(a.jsx)(ie.a,{children:Object(a.jsx)(n.a,{id:re?"Questions.edit":"addNewQuestion"})}),Object(a.jsxs)(fe.a,{layout:"horizontal",form:l,onFinish:Ue,initialValues:re,children:[Object(a.jsx)(Ee.a,{name:"type",placeholder:v.formatMessage({id:"selectNewQuestionType",defaultMessage:"Select new question type"}),label:Object(a.jsx)(n.a,{id:"type",defaultMessage:"Type:"}),options:Fe,rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],required:!0}),Object(a.jsx)(oe,{type:R}),Object(a.jsx)(Me.a,{name:"score",label:Object(a.jsx)(n.a,{id:"Questions.score",defaultMessage:"Score"}),rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}]}),m&&Object(a.jsx)(fe.a.Item,{name:"category_id",label:Object(a.jsx)(n.a,{id:"category",defaultMessage:"Category"}),rules:[{required:!0,message:Object(a.jsx)(n.a,{id:"field_required"})}],required:!0,children:Object(a.jsx)(V.a,Object(C.a)({},typeof m=="object"?m:{}))})]})]})},z=e("60mZ"),G=["className","style"],Y=Object(w.c)(function(){return Object(a.jsx)(_.a,{style:{cursor:"grab",color:"#999"}})}),te=Object(w.b)(function(d){return Object(a.jsx)("tr",Object(C.a)({},d))}),ae=Object(w.a)(function(d){return Object(a.jsx)("tbody",Object(C.a)({},d))}),le=[{title:Object(a.jsx)(n.a,{id:"sort",defaultMessage:"sort"}),dataIndex:"id",width:60,className:"drag-visible",render:function(){return Object(a.jsx)(Y,{})}},{title:Object(a.jsx)(n.a,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(t,s){return Object(a.jsx)(n.a,{id:"gift_type.".concat(s.type)})}},{title:Object(a.jsx)(n.a,{id:"question",defaultMessage:"Question"}),dataIndex:"question",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(t,s){var c=Object(se.parse)(s.value);return c!=null&&c[0]&&"stem"in c[0]?c[0].stem.text:"question"}}],be={title:Object(a.jsx)(n.a,{id:"category",defaultMessage:"Category"}),dataIndex:"category_id",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(t,s){return typeof s.category_id=="number"?Object(a.jsx)(x.a,{type:"Category",type_id:s.category_id}):"-"}},T=function(t){var s=t.questions,c=t.onAdded,u=t.onRemoved,m=t.onEdited,v=t.quizId,h=t.tableLoading,L=t.tableHeader,l=t.questionsCategory,R=Object(y.useState)(!1),re=Object(D.a)(R,2),Ue=re[0],de=re[1],Qe=Object(y.useState)(!1),xe=Object(D.a)(Qe,2),et=xe[0],qe=xe[1],at=Object(y.useState)(),tt=Object(D.a)(at,2),De=tt[0],Te=tt[1],lt=Object(y.useState)(!1),it=Object(D.a)(lt,2),ut=it[0],dt=it[1],mt=Object(y.useState)(s),ct=Object(D.a)(mt,2),rt=ct[0],ot=ct[1],jt=Object(y.useRef)();Object(y.useEffect)(function(){var me;(me=jt.current)===null||me===void 0||me.reload(),ot(s)},[s]);var vt=function(q){var Ae=q.oldIndex,Pe=q.newIndex;if(Ae!==Pe){var Ye=Object(Q.a)(rt.slice(),Ae,Pe).filter(Boolean).map(function(g,Ze){return Object(C.a)(Object(C.a)({},g),{},{order:Ze})});Ye.forEach(function(g,Ze){g.id!==rt[Ze].id&&Object(U.g)(g.id,Object(C.a)(Object(C.a)({},g),{},{order:Ze+1,topic_gift_quiz_id:v}))}),ot(Ye)}},bt=function(q){return Object(a.jsx)(ae,Object(C.a)({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:vt},q))},ft=function(q){var Ae=q.className,Pe=q.style,Ye=Object(ne.a)(q,G),g=rt.findIndex(function(Ze){return Ze.id===Ye["data-row-key"]});return Object(a.jsx)(te,Object(C.a)({index:g},Ye))},Ot=Object(y.useCallback)(function(){var me=Object(i.a)(Object(H.a)().mark(function q(Ae){var Pe;return Object(H.a)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,de(!0),g.next=4,Object(U.a)(Object(C.a)({topic_gift_quiz_id:v},Ae));case 4:return Pe=g.sent,qe(!1),c==null||c(),g.abrupt("return",Pe.success);case 10:return g.prev=10,g.t0=g.catch(0),console.log(g.t0),g.abrupt("return",!1);case 14:return g.prev=14,de(!1),g.finish(14);case 17:case"end":return g.stop()}},q,null,[[0,10,14,17]])}));return function(q){return me.apply(this,arguments)}}(),[et,v]),gt=Object(y.useCallback)(function(){var me=Object(i.a)(Object(H.a)().mark(function q(Ae){var Pe;return Object(H.a)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if((De==null?void 0:De.id)!==void 0){g.next=2;break}return g.abrupt("return",!1);case 2:return g.prev=2,de(!0),g.next=6,Object(U.g)(De.id,Object(C.a)({topic_gift_quiz_id:v},Ae));case 6:return Pe=g.sent,Te(void 0),m==null||m(),g.abrupt("return",Pe.success);case 12:return g.prev=12,g.t0=g.catch(2),console.log(g.t0),g.abrupt("return",!1);case 16:return g.prev=16,de(!1),g.finish(16);case 19:case"end":return g.stop()}},q,null,[[2,12,16,19]])}));return function(q){return me.apply(this,arguments)}}(),[De==null?void 0:De.id,v]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(I.a,{open:et,onClose:function(){return qe(!1)},children:Object(a.jsx)(ee,{onSubmit:Ot,competencyChallengeCategoryTreeProps:l})}),Object(a.jsx)(I.a,{open:!!De,onClose:function(){return Te(void 0)},children:Object(a.jsx)(ee,{onSubmit:gt,competencyChallengeCategoryTreeProps:l,values:De})}),Object(a.jsx)(f.a,{search:!1,cardProps:{bodyStyle:{padding:0}},loading:h,headerTitle:L,toolbar:{settings:[]},toolBarRender:function(){return[Object(a.jsxs)(K.a,{icon:Object(a.jsx)(E.a,{}),type:"primary",onClick:function(){return qe(!0)},children:[" ",Object(a.jsx)(n.a,{id:"addNewQuestion",defaultMessage:"Add new question"})]},"add")]},columns:[].concat(le,Object(F.a)(l?[be]:[]),[{title:Object(a.jsx)(n.a,{id:"actions",defaultMessage:"Actions"}),dataIndex:"address",valueType:"option",render:function(q,Ae){return[Object(a.jsx)(K.a,{size:"small",type:"primary",onClick:function(){Te(Ae)},children:Object(a.jsx)(n.a,{id:"Questions.edit",defaultMessage:"Edit Question"})},"edit"),Object(a.jsx)(K.a,{loading:Ue,size:"small",danger:!0,onClick:function(){de(!0),Object(U.b)(Ae.id).then(function(){u&&u()}).finally(function(){de(!1)})},children:Object(a.jsx)(n.a,{id:"Questions.delete",defaultMessage:"Delete Question"})},"delete")]}}]),rowKey:function(q){return q.id},pagination:!1,dataSource:rt,components:{body:{wrapper:bt,row:ft}}}),Object(a.jsxs)(N.a,{style:{marginTop:"3em"},children:["Debug GIFT: ",Object(a.jsx)(o.a,{checked:ut,onChange:function(q){return dt(q)}})]})]})}}}]);

//# sourceMappingURL=p__CompetencyChallenges__form.14178d04.async.js.map