(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"3fxf":function(ne,T,e){"use strict";var A=e("DjyN"),V=e("NUBc"),I=e("Mwp2"),G=e("VXEj"),x=e("+L6B"),i=e("2/Rp"),F=e("5NDa"),K=e("5rEg"),Q=e("oBTY"),a=e("k1fw"),S=e("tJVT"),P=e("DYRE"),R=e("zeV3"),_=e("tU7J"),M=e("wFql"),b=e("q1tI"),C=e.n(b),j=e("BAh9"),k=e("/MfK"),U=e("mAF4"),se=e("dF/Y"),g=e("9kvl"),z=e("DBJ/"),J=e("lLVY"),$=e.n(J),O=e("nKUr"),ee=e.n(O),be=function(ce){var de=ce.directory,je=ce.onUploaded;return Object(O.jsxs)(R.b,{align:"start",children:[Object(O.jsxs)(M.a.Text,{children:[Object(O.jsx)(g.a,{id:"pages.files.filesBrowser"}),Object(O.jsx)(M.a.Text,{code:!0,children:de})]}),Object(O.jsx)(z.a,{url:"/api/admin/file/upload",name:"file[]",data:{target:de},onUpload:function(fe){fe.success&&je(de,fe.data)}})]})},Se=function(ce){var de=ce.defaultDirectory,je=de===void 0?"/":de,oe=ce.onFile,fe=ce.hideDeleteBtn,Ce=fe===void 0?!1:fe,ye=ce.forceLoading,De=ye===void 0?!1:ye,Te=Object(g.j)(),ge=Object(b.useState)({loading:!1,name:"",directory:je,current_page:1,data:void 0,per_page:1,last_page:1,total:0}),pe=Object(S.a)(ge,2),w=pe[0],me=pe[1],le=Object(b.useRef)(),H=Object(b.useCallback)(function(B){me(function(o){return Object(a.a)(Object(a.a)({},o),{},{loading:B})})},[]),he=Object(b.useCallback)(function(B,o){B.success&&me(function(W){return Object(a.a)(Object(a.a)(Object(a.a)({},W),B.data),{},{data:[{url:o.split("/").slice(0,-1).join("/"),name:"..",created_at:"",mime:"directory"}].concat(Object(Q.a)(B.data.data.map(function(Y){return Object(a.a)(Object(a.a)({},Y),{},{url:Y.mime==="directory"?"".concat(o,"/").concat(Y.name):Y.url})}))).filter(function(Y){return o==="/"||o===je?Y.name!=="..":!0}),directory:o,loading:!1})})},[H]),te=Object(b.useCallback)(function(B){var o,W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Y=function(){return le.current&&le.current.abort()};return Y(),le.current=new AbortController,H(!0),Object(j.a)({directory:B,page:W},{signal:(o=le.current)===null||o===void 0?void 0:o.signal}).then(function(ae){ae.success&&he(ae,B)}).catch(function(){return H(!1)}),function(){Y()}},[H]);Object(b.useEffect)(function(){return te(je)},[je,te]);var _e=Object(b.useCallback)(function(B){H(!0),Object(j.c)(B).then(function(){te(w.directory)}).catch(function(){H(!1)})},[te,H,w.directory]),Ue=Object(b.useCallback)(function(B,o){var W,Y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,ae=function(){return le.current&&le.current.abort()};return ae(),le.current=new AbortController,H(!0),Object(j.b)({directory:B,name:o,page:Y},{signal:(W=le.current)===null||W===void 0?void 0:W.signal}).then(function(Ee){Ee.success&&he(Ee,B)}).catch(function(){return H(!1)}),function(){ae()}},[H]);return Object(O.jsxs)("div",{className:"file-browser",children:[Object(O.jsxs)("div",{className:"file-browser__header",children:[Object(O.jsx)(K.a,{placeholder:Te.formatMessage({id:"search_file"}),className:"file-browser__input",onChange:function(o){return me(function(W){return Object(a.a)(Object(a.a)({},W),{},{name:o.target.value})})},value:w.name}),Object(O.jsxs)("div",{children:[Object(O.jsx)(i.a,{className:"file-browser__button",onClick:function(){return te(w.directory)},children:Object(O.jsx)(g.a,{id:"reset"})}),Object(O.jsx)(i.a,{className:"file-browser__button",type:"primary",onClick:function(){return Ue(w.directory,w.name)},children:Object(O.jsx)(g.a,{id:"query"})})]})]}),Object(O.jsx)(G.b,{loading:w.loading||De,size:"small",itemLayout:"horizontal",dataSource:w.data,header:Object(O.jsx)(be,{directory:w.directory,onUploaded:function(o,W){W&&(te(o),oe&&oe(W,o))}}),footer:Object(O.jsx)(be,{directory:w.directory,onUploaded:function(o,W){te(o),W&&oe&&oe(W,o)}}),renderItem:function(o){return Object(O.jsx)(G.b.Item,{actions:o.mime!=="directory"&&!Ce?[Object(O.jsx)(i.a,{type:"default",danger:!0,icon:Object(O.jsx)(k.a,{}),size:"small",onClick:function(){return _e(o.url)}},"dir")]:[],children:Object(O.jsx)(G.b.Item.Meta,{avatar:o.mime==="directory"?Object(O.jsx)(i.a,{type:"primary",icon:Object(O.jsx)(U.a,{}),size:"small",onClick:function(){return te(o.url)}}):Object(O.jsx)("a",{href:o.url,target:"_blank",rel:"noreferrer",children:Object(O.jsx)(i.a,{type:"default",icon:Object(O.jsx)(se.a,{}),size:"small"})}),description:Object(O.jsx)(C.a.Fragment,{children:Object(O.jsx)(i.a,{type:"text",size:"small",onClick:function(){return o.mime==="directory"?te(o.url):oe&&oe(o,w.directory)},children:o.name})})})})}}),Object(O.jsx)(V.a,{pageSizeOptions:[],current:w.current_page,total:w.total,pageSize:w.per_page,onChange:function(o){return te(w.directory,o)}})]})};T.a=Se},"5qq5":function(ne,T,e){"use strict";var A=e("7Kak"),V=e("9yH6"),I=e("VTBJ"),G=e("Ff2n"),x=e("nKUr"),i=e.n(x),F=e("uX+g"),K=e("q1tI"),Q=e.n(K),a=e("WFLz"),S=e("adzw"),P=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],R=Q.a.forwardRef(function(C,j){var k=C.fieldProps,U=C.options,se=C.radioType,g=C.layout,z=C.proFieldProps,J=C.valueEnum,$=Object(G.a)(C,P);return Object(x.jsx)(S.a,Object(I.a)(Object(I.a)({mode:"edit",valueType:se==="button"?"radioButton":"radio",ref:j,valueEnum:Object(F.a)(J,void 0)},$),{},{fieldProps:Object(I.a)({options:U,layout:g},k),proFieldProps:z,filedConfig:{customLightMode:!0}}))}),_=Q.a.forwardRef(function(C,j){var k=C.fieldProps,U=C.children;return Object(x.jsx)(V.a,Object(I.a)(Object(I.a)({},k),{},{ref:j,children:U}))}),M=Object(a.a)(_,{valuePropName:"checked",ignoreWidth:!0}),b=M;b.Group=R,b.Button=V.a.Button,b.displayName="ProFormComponent",T.a=b},BAh9:function(ne,T,e){"use strict";e.d(T,"a",function(){return x}),e.d(T,"b",function(){return F}),e.d(T,"e",function(){return Q}),e.d(T,"d",function(){return S}),e.d(T,"c",function(){return P});var A=e("qLMh"),V=e("k1fw"),I=e("9og8"),G=e("9kvl");function x(_,M){return i.apply(this,arguments)}function i(){return i=Object(I.a)(Object(A.a)().mark(function _(M,b){return Object(A.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(G.g)("/api/admin/file/list",Object(V.a)({method:"GET",params:M},b||{})));case 1:case"end":return j.stop()}},_)})),i.apply(this,arguments)}function F(_,M){return K.apply(this,arguments)}function K(){return K=Object(I.a)(Object(A.a)().mark(function _(M,b){return Object(A.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(G.g)("/api/admin/file/find",Object(V.a)({method:"GET",params:M},b||{})));case 1:case"end":return j.stop()}},_)})),K.apply(this,arguments)}function Q(_,M,b){return a.apply(this,arguments)}function a(){return a=Object(I.a)(Object(A.a)().mark(function _(M,b,C){var j;return Object(A.a)().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return j=new FormData,j.append("file[]",M),j.append("target",b),U.abrupt("return",Object(G.g)("/api/admin/file/upload",Object(V.a)({method:"POST",data:j},C||{})));case 4:case"end":return U.stop()}},_)})),a.apply(this,arguments)}var S=function(M){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;return"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/images/img?path=").concat(M,"&w=").concat(b)};function P(_,M){return R.apply(this,arguments)}function R(){return R=Object(I.a)(Object(A.a)().mark(function _(M,b){return Object(A.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(G.g)("/api/admin/file/delete",Object(V.a)({method:"DELETE",data:{url:M}},b||{})));case 1:case"end":return j.stop()}},_)})),R.apply(this,arguments)}},BiO0:function(ne,T,e){"use strict";var A=e("VTBJ"),V=e("Ff2n"),I=e("nKUr"),G=e.n(I),x=e("q1tI"),i=e.n(x),F=e("adzw"),K=["fieldProps","proFieldProps"],Q=function(S,P){var R=S.fieldProps,_=S.proFieldProps,M=Object(V.a)(S,K);return Object(I.jsx)(F.a,Object(A.a)({ref:P,mode:"edit",valueType:"textarea",fieldProps:R,proFieldProps:_},M))};T.a=i.a.forwardRef(Q)},"DBJ/":function(ne,T,e){"use strict";var A=e("k1fw"),V=e("y8nQ"),I=e("Vl3Y"),G=e("etVw"),x=e("9kvl"),i=e("qFDU"),F=e("nKUr"),K=e.n(F);function Q(a){var S=a.onChange,P=a.onUpload,R=a.url,_=a.name,M=a.extra,b=a.accept,C=a.data,j=a.wrapInForm,k=j===void 0?!0:j,U=a.title,se=a.formProps,g=Object(x.j)();return C&&C[_]&&delete C[_],Object(F.jsx)(i.a,{condition:k,wrap:function(J){return Object(F.jsx)(I.a,Object(A.a)(Object(A.a)({},se),{},{children:J}))},children:Object(F.jsx)(G.a,{title:U||" ".concat(g.formatMessage({id:"upload_click_here"})),placeholder:g.formatMessage({id:"upload_click_here"}),onChange:function(J){S&&S(J),J.file.status==="done"&&P&&P(J.file.response)},label:Object(F.jsx)(x.a,{id:"upload"}),max:2,fieldProps:{data:C,accept:b,name:_,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}},action:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com").concat(R),extra:M})})}T.a=Q},"O/iA":function(ne,T,e){},Qurx:function(ne,T,e){"use strict";var A=e("VTBJ"),V=e("Ff2n"),I=e("nKUr"),G=e.n(I),x=e("adzw"),i=["fieldProps","proFieldProps"],F=["fieldProps","proFieldProps"],K="text",Q=function(R){var _=R.fieldProps,M=R.proFieldProps,b=Object(V.a)(R,i);return Object(I.jsx)(x.a,Object(A.a)({mode:"edit",valueType:K,fieldProps:_,filedConfig:{valueType:K},proFieldProps:M},b))},a=function(R){var _=R.fieldProps,M=R.proFieldProps,b=Object(V.a)(R,F);return Object(I.jsx)(x.a,Object(A.a)({mode:"edit",valueType:"password",fieldProps:_,proFieldProps:M,filedConfig:{valueType:K}},b))},S=Q;S.Password=a,S.displayName="ProFormComponent",T.a=S},YjuE:function(ne,T,e){"use strict";e.r(T);var A=e("fOrg"),V=e("+KLJ"),I=e("T2oS"),G=e("W9HT"),x=e("tJVT"),i=e("q1tI"),F=e.n(i),K=e("nhC9"),Q=e("Ty5D"),a=e("9kvl"),S=e("tMyG"),P=e("+up7"),R=e("P2fV"),_=e("NJEC"),M=e("5Dmo"),b=e("3S7+"),C=e("+L6B"),j=e("2/Rp"),k=e("+BJd"),U=e("mr32"),se=e("jrin"),g=e("qLMh"),z=e("k1fw"),J=e("miYZ"),$=e("tsqr"),O=e("9og8"),ee=e("xvlK"),be=e("Qiat"),Se=e("EFp3"),Re=e("O/iA"),ce=e("OaEy"),de=e("wx14"),je=e("U8pU"),oe=e("ODXe"),fe=e("TSYQ"),Ce=e.n(fe),ye=e("Zm9Q"),De=e("bT9E"),Te=e("H84U"),ge=e("2fM7"),pe=e("0n0R"),w=ge.a.Option;function me(y){return y&&y.type&&(y.type.isSelectOption||y.type.isSelectOptGroup)}var le=function(r,s){var u=r.prefixCls,c=r.className,h=r.popupClassName,n=r.dropdownClassName,d=r.children,D=r.dataSource,v=Object(ye.a)(d),f;if(v.length===1&&Object(pe.c)(v[0])&&!me(v[0])){var p=Object(oe.a)(v,1);f=p[0]}var m=f?function(){return f}:void 0,L;return v.length&&me(v[0])?L=d:L=D?D.map(function(l){if(Object(pe.c)(l))return l;switch(Object(je.a)(l)){case"string":return i.createElement(w,{key:l,value:l},l);case"object":{var E=l.value;return i.createElement(w,{key:E,value:E},l.text)}default:return}}):[],i.createElement(Te.a,null,function(l){var E=l.getPrefixCls,N=E("select",u);return i.createElement(ge.a,Object(de.a)({ref:s},Object(De.a)(r,["dataSource"]),{prefixCls:N,dropdownClassName:h||n,className:Ce()("".concat(N,"-auto-complete"),c),mode:ge.a.SECRET_COMBOBOX_MODE_DO_NOT_USE},{getInputElement:m}),L)})},H=i.forwardRef(le);H.Option=w;var he=H,te=e("y8nQ"),_e=e("Vl3Y"),Ue=e("5NDa"),B=e("5rEg"),o=e("VMEa"),W=e("rmhi"),Y=e("Qurx"),ae=e("F/zT"),Ee=e("5qq5"),Be=e("BiO0"),Ne=e("hd5d"),Ve=e("3fxf"),we=e("ovOe"),xe=e.n(we),t=e("nKUr"),ze=function(r){var s=r.value,u=r.onChange,c=r.type,h=c===void 0?"file":c,n=Object(i.useState)(!1),d=Object(x.a)(n,2),D=d[0],v=d[1];return Object(t.jsxs)(F.a.Fragment,{children:[Object(t.jsxs)(o.a.Group,{children:[Object(t.jsx)(B.a,{value:s,readOnly:!0}),Object(t.jsxs)(j.a,{size:"small",type:"primary",onClick:function(){return v(!D)},children:["toggle ",h," browser"]})]}),D&&Object(t.jsx)(Ve.a,{onFile:function(p,m){return u&&u("".concat(m,"/").concat(p.name))}})]})},$e=function(r){var s=Object(a.j)(),u=r.visible,c=r.onVisibleChange,h=r.onFinish,n=r.id,d=r.initialData,D=r.groups,v=_e.a.useForm(),f=Object(x.a)(v,1),p=f[0],m=!n||n===-1,L=Object(i.useState)("text"),l=Object(x.a)(L,2),E=l[0],N=l[1],Z=Object(i.useCallback)(function(){return!!(p.getFieldValue("group")==="global"||d)},[p,d]),ue=Object(i.useState)(""),re=Object(x.a)(ue,2),ie=re[0],q=re[1];Object(i.useEffect)(function(){typeof n=="object"?p.setFieldsValue(n):n&&n!==-1?Object(P.d)(Number(n)).then(function(X){X.success&&(p.setFieldsValue(X.data),N(X.data.type),q(X.data.group))}):(p.resetFields(),N("text"))},[n,p,d]);var ve=Object(i.useCallback)(function(X){X.type&&X.type!==E&&N(X.type)},[E]);return Object(t.jsxs)(W.a,{form:p,title:s.formatMessage({id:n?"editSetting":"newSetting",defaultMessage:n?"editSetting":"newSetting"}),width:"60vw",visible:!!u,onVisibleChange:c,onFinish:h,onValuesChange:ve,children:[Object(t.jsxs)(o.a.Group,{children:[d?Object(t.jsx)(Y.a,{label:Object(t.jsx)(a.a,{id:"group",defaultMessage:"group"}),rules:[{required:!0}],width:"md",name:"group",disabled:Z()}):Object(t.jsx)(o.a.Item,{label:Object(t.jsx)(a.a,{id:"group",defaultMessage:"group"}),name:"group",children:Object(t.jsx)(he,{style:{width:"300px"},autoFocus:!0,value:ie,onChange:function(Pe){return q(Pe)},filterOption:function(Pe,Ae){var Fe;return(Ae==null||(Fe=Ae.children)===null||Fe===void 0?void 0:Fe.toString().toLowerCase().indexOf(Pe.toLowerCase()))!==-1},children:D.map(function(X){return Object(t.jsx)(he.Option,{value:X,children:X},X)})})}),Object(t.jsx)(Y.a,{label:Object(t.jsx)(a.a,{id:"key",defaultMessage:"key"}),rules:[{required:!0}],width:"md",name:"key",disabled:Z()})]}),Object(t.jsxs)(o.a.Group,{children:[Object(t.jsx)(ae.a,{name:"enumerable",disabled:Z(),label:Object(t.jsx)(a.a,{id:"enumerable",defaultMessage:"enumerable"})}),Object(t.jsx)(ae.a,{name:"public",disabled:Z(),label:Object(t.jsx)(a.a,{id:"public",defaultMessage:"public"})})]}),Object(t.jsx)(o.a.Group,{children:Object(t.jsx)(Ee.a.Group,{disabled:!!(!m||d),name:"type",label:Object(t.jsx)(a.a,{id:"type"}),options:[{label:"text",value:"text"},{label:"markdown",value:"markdown"},{label:"json",value:"json"},{label:"file",value:"file"},{label:"image",value:"image"}]})}),Object(t.jsxs)("div",{children:[E==="text"&&Object(t.jsx)(Y.a,{width:"lg",name:"value",label:Object(t.jsx)(a.a,{id:"value"})}),E==="json"&&Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(Be.a,{width:"lg",name:"value",label:Object(t.jsx)(a.a,{id:"value"}),tooltip:"".concat(s.formatMessage({id:"example_json"}),': {"name":"John", "age":30, "city":["New York","Warsaw"]}')}),Object(t.jsx)(o.a.Item,{noStyle:!0,shouldUpdate:!0,children:function(){try{return Object(t.jsx)(xe.a,{src:JSON.parse(p.getFieldValue("value"))})}catch(Pe){return Object(t.jsx)(xe.a,{src:JSON.parse('{ "error": "cannot parse this json" }')})}}})]}),(E==="file"||E==="image")&&Object(t.jsx)(o.a.Item,{name:"value",label:"value",tooltip:"select file from current repository or upload new one",valuePropName:"value",children:Object(t.jsx)(ze,{type:E})}),E==="markdown"&&Object(t.jsx)(o.a.Item,{name:"value",label:"value",tooltip:"The editor is WYSIWYG and includes formatting tools whilst retaining the ability to write markdown shortcuts inline and output plain Markdown.",valuePropName:"value",children:Object(t.jsx)(Ne.a,{directory:"settings/wysiwyg"})})]})]})},Le=$e,Ie=e("G3dp"),Ke=e("/MfK"),Ge=function(){var y=Object(O.a)(Object(g.a)().mark(function r(s,u,c){var h;return Object(g.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return h=$.b.loading(s.formatMessage({id:"loading"})),d.prev=1,d.next=4,c&&c!==-1?Object(P.h)(c,Object(z.a)({},u)):Object(P.b)(Object(z.a)({},u));case 4:return h(),$.b.success(s.formatMessage({id:"success"})),d.abrupt("return",!0);case 9:return d.prev=9,d.t0=d.catch(1),h(),$.b.error(s.formatMessage({id:"error"})),d.abrupt("return",!1);case 14:case"end":return d.stop()}},r,null,[[1,9]])}));return function(s,u,c){return y.apply(this,arguments)}}(),Je=function(){var y=Object(O.a)(Object(g.a)().mark(function r(s,u){var c;return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return c=$.b.loading(s.formatMessage({id:"loading"})),n.prev=1,n.next=4,Object(P.c)(u);case 4:return c(),$.b.success(s.formatMessage({id:"success"})),n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(1),c(),$.b.error(s.formatMessage({id:"error"})),n.abrupt("return",!1);case 14:case"end":return n.stop()}},r,null,[[1,9]])}));return function(s,u){return y.apply(this,arguments)}}(),Ye=function(){var r=Object(i.useState)(!1),s=Object(x.a)(r,2),u=s[0],c=s[1],h=Object(i.useState)([]),n=Object(x.a)(h,2),d=n[0],D=n[1],v=Object(i.useRef)(),f=Object(a.j)(),p=Object(a.k)("@@initialState"),m=p.setInitialState;Object(i.useEffect)(function(){Object(P.e)().then(function(l){l.success&&D(l.data.filter(function(E){return E!=="global"}))})},[]);var L=[{title:Object(t.jsx)(a.a,{id:"group",defaultMessage:"group"}),dataIndex:"group",hideInSearch:!1,key:"group",valueType:"select",width:100,valueEnum:d.sort().reduce(function(l,E){return Object(z.a)(Object(z.a)({},l),{},Object(se.a)({},E,E))},{})},{title:Object(t.jsx)(a.a,{id:"key",defaultMessage:"key"}),dataIndex:"key",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"type",defaultMessage:"type"}),dataIndex:"type",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"enumerable",defaultMessage:"enumerable"}),dataIndex:"enumerable",hideInForm:!0,hideInSearch:!0,render:function(E,N){return Object(t.jsx)(U.a,{color:N.enumerable?"success":"error",children:Object(t.jsx)(a.a,{id:N.enumerable?"true":"false",defaultMessage:N.enumerable?"true":"false"})})}},{title:Object(t.jsx)(a.a,{id:"public",defaultMessage:"public"}),dataIndex:"public",hideInForm:!0,hideInSearch:!0,render:function(E,N){return Object(t.jsx)(U.a,{color:N.public?"success":"error",children:Object(t.jsx)(a.a,{id:N.public?"true":"false",defaultMessage:N.public?"true":"false"})})}},{hideInSearch:!0,title:Object(t.jsx)(a.a,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",valueType:"option",render:function(E,N){return[Object(t.jsx)(b.a,{title:Object(t.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(t.jsx)(j.a,{type:"primary",icon:Object(t.jsx)(Ie.a,{}),onClick:function(){return c(N.id)}})},"edit"),Object(t.jsx)(_.a,{title:Object(t.jsx)(a.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(O.a)(Object(g.a)().mark(function Z(){var ue;return Object(g.a)().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,Je(f,N.id);case 2:ue=ie.sent,ue&&(c(!1),v.current&&v.current.reload());case 4:case"end":return ie.stop()}},Z)})),okText:Object(t.jsx)(a.a,{id:"yes",defaultMessage:"Yes"}),cancelText:Object(t.jsx)(a.a,{id:"no",defaultMessage:"No"}),children:Object(t.jsx)(b.a,{title:Object(t.jsx)(a.a,{id:"delete",defaultMessage:"delete"}),children:Object(t.jsx)(j.a,{type:"primary",icon:Object(t.jsx)(Ke.a,{}),danger:!0})})},"delete")]}}];return Object(t.jsxs)(F.a.Fragment,{children:[Object(t.jsx)(be.a,{headerTitle:f.formatMessage({id:"menu.settings"}),actionRef:v,rowKey:"id",search:{},toolBarRender:function(){return[Object(t.jsxs)(j.a,{type:"primary",onClick:function(){c(-1)},children:[Object(t.jsx)(ee.a,{})," ",Object(t.jsx)(a.a,{id:"pages.searchTable.new"})]},"primary")]},request:function(E){var N=E.pageSize,Z=E.current,ue=E.group;return Object(P.f)({pageSize:N,current:Z,group:ue}).then(function(re){return re.success?{data:re.data.filter(function(ie){return ie.group!=="global"}),total:re.meta.total,success:!0}:[]})},columns:L}),Object(t.jsx)(Le,{groups:d,id:u,visible:Number.isInteger(u),onVisibleChange:function(E){return!E&&c(!1)},onFinish:function(){var l=Object(O.a)(Object(g.a)().mark(function E(N){var Z,ue,re;return Object(g.a)().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return Z=N,q.next=3,Ge(f,Z,Number(u));case 3:if(ue=q.sent,!ue){q.next=12;break}if(c(!1),v.current&&v.current.reload(),Z.group!=="global"){q.next=12;break}return q.next=10,Object(P.f)({current:1,pageSize:100,group:"global"});case 10:re=q.sent,m(function(ve){return Object(z.a)(Object(z.a)({},ve),{},{config:re.success?re.data:ve==null?void 0:ve.config})});case 12:case"end":return q.stop()}},E)}));return function(E){return l.apply(this,arguments)}}()})]})},Qe=Ye,jt=e("tU7J"),Xe=e("wFql"),He=e("Fghh"),Ze=Xe.a.Text,Oe;(function(y){y.Array="array",y.String="string"})(Oe||(Oe={}));var ke=function(r,s){return s===Oe.Array?r&&Array.isArray(r)?JSON.stringify(r):"[]":r},qe=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",s=arguments.length>1?arguments[1]:void 0;if(s===Oe.Array){var u=JSON.parse(r);return u&&Array.isArray(u)?u:[]}return r},et=function(r){var s=Object(He.j)(),u=r.visible,c=r.onVisibleChange,h=r.onFinish,n=r.value,d=_e.a.useForm(),D=Object(x.a)(d,1),v=D[0],f=Object(i.useMemo)(function(){return(n.rules||[]).includes(Oe.Array)?Oe.Array:Oe.String},[n.rules]);return Object(i.useEffect)(function(){v.setFieldsValue(Object(z.a)(Object(z.a)({},n),{},{value:ke(n.value,f)}))},[f,n,v]),Object(t.jsxs)(W.a,{form:v,title:n.full_key,width:"60vw",visible:u,onVisibleChange:c,onFinish:Object(O.a)(Object(g.a)().mark(function p(){var m;return Object(g.a)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,Object(P.g)({key:n.full_key,value:qe(v.getFieldsValue().value,f)});case 2:if(m=l.sent,!m.success){l.next=6;break}return h(m.success===!0),l.abrupt("return",m.success);case 6:return l.abrupt("return");case 7:case"end":return l.stop()}},p)})),children:[Object(t.jsxs)(o.a.Group,{children:[Object(t.jsx)(ae.a,{disabled:!0,name:"public",label:Object(t.jsx)(a.a,{id:"public",defaultMessage:"public"})}),Object(t.jsx)(ae.a,{disabled:!0,name:"readonly",label:Object(t.jsx)(a.a,{id:"readonly",defaultMessage:"readonly"})}),Object(t.jsx)(o.a.Item,{shouldUpdate:!0,label:Object(t.jsx)(a.a,{id:"rules",defaultMessage:"rules"}),children:function(){return Object(t.jsx)(Ze,{code:!0,children:JSON.stringify(v.getFieldValue("rules"))})}})]}),f===Oe.Array?Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(Be.a,{width:"lg",name:"value",label:Object(t.jsx)(a.a,{id:"value"}),tooltip:"".concat(s.formatMessage({id:"example_json"}),': ["first_field_name", "second_field_name"]')}),Object(t.jsx)(o.a.Item,{noStyle:!0,shouldUpdate:!0,children:function(){try{return Object(t.jsx)(xe.a,{src:JSON.parse(v.getFieldValue("value"))})}catch(m){return Object(t.jsx)(xe.a,{src:JSON.parse('{ "error": "cannot parse this array" }')})}}})]}):Object(t.jsx)(Y.a,{width:"lg",name:"value",label:Object(t.jsx)(a.a,{id:"value"})})]})},tt=et,at=[{title:Object(t.jsx)(a.a,{id:"key",defaultMessage:"key"}),dataIndex:"key",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"readonly",defaultMessage:"readonly"}),dataIndex:"readonly",hideInForm:!0,hideInSearch:!0,render:function(r,s){return Object(t.jsx)(U.a,{color:s.readonly?"success":"error",children:Object(t.jsx)(a.a,{id:s.readonly?"true":"false",defaultMessage:s.readonly?"true":"false"})})}},{title:Object(t.jsx)(a.a,{id:"public",defaultMessage:"public"}),dataIndex:"public",hideInForm:!0,hideInSearch:!0,render:function(r,s){return Object(t.jsx)(U.a,{color:s.public?"success":"error",children:Object(t.jsx)(a.a,{id:s.public?"true":"false",defaultMessage:s.public?"true":"false"})})}},{title:Object(t.jsx)(a.a,{id:"value",defaultMessage:"value"}),dataIndex:"value",hideInForm:!0,hideInSearch:!0}],rt=function y(r,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return!r||typeof r!="object"?!1:(Object.keys(r).forEach(function(c){var h=r[c];c===s?u.push(r):typeof h=="object"&&y(h,s,u)}),u)},nt=function(r){var s=r.packageName,u=r.values,c=r.onValueUpdated,h=Object(a.j)(),n=Object(i.useState)(),d=Object(x.a)(n,2),D=d[0],v=d[1],f=Object(i.useMemo)(function(){var p=u[s];return rt(p,"rules")},[u,s]);return Object(t.jsxs)(F.a.Fragment,{children:[Object(t.jsx)(be.a,{headerTitle:h.formatMessage({id:"menu.settings"}),rowKey:"key",search:{},dataSource:f,columns:[].concat(at,[{hideInSearch:!0,title:Object(t.jsx)(a.a,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",valueType:"option",render:function(m,L){return[Object(t.jsx)(b.a,{title:Object(t.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(t.jsx)(j.a,{type:"primary",icon:Object(t.jsx)(Ie.a,{}),onClick:function(){return v(L)}})},"edit")]}}])}),D&&Object(t.jsx)(tt,{value:D,visible:D!==void 0,onVisibleChange:function(m){return m===!1&&v(void 0)},onFinish:Object(O.a)(Object(g.a)().mark(function p(){return Object(g.a)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:c();case 1:case"end":return L.stop()}},p)}))})]})},st=nt,We=e("oBTY"),lt=function(){var y=Object(O.a)(Object(g.a)().mark(function r(s,u,c){var h;return Object(g.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return h=$.b.loading(s.formatMessage({id:"loading"})),d.prev=1,d.next=4,c&&c!==-1?Object(P.h)(c,Object(z.a)({},u)):Object(P.b)(Object(z.a)({},u));case 4:return h(),$.b.success(s.formatMessage({id:"success"})),d.abrupt("return",!0);case 9:return d.prev=9,d.t0=d.catch(1),h(),$.b.error(s.formatMessage({id:"error"})),d.abrupt("return",!1);case 14:case"end":return d.stop()}},r,null,[[1,9]])}));return function(s,u,c){return y.apply(this,arguments)}}(),it=function(){var y=Object(O.a)(Object(g.a)().mark(function r(s,u){var c;return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return c=$.b.loading(s.formatMessage({id:"loading"})),n.prev=1,n.next=4,Object(P.c)(u);case 4:return c(),$.b.success(s.formatMessage({id:"success"})),n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(1),c(),$.b.error(s.formatMessage({id:"error"})),n.abrupt("return",!1);case 14:case"end":return n.stop()}},r,null,[[1,9]])}));return function(s,u){return y.apply(this,arguments)}}(),Me={logo:{id:-1,key:"logo",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"image",data:"EscolaLMS"},frontURL:{id:0,key:"frontURL",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"}},ot=function(){var r=Object(i.useState)(!1),s=Object(x.a)(r,2),u=s[0],c=s[1],h=Object(i.useRef)(),n=Object(a.j)(),d=[{title:Object(t.jsx)(a.a,{id:"key",defaultMessage:"key"}),dataIndex:"key",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"type",defaultMessage:"type"}),dataIndex:"type",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"enumerable",defaultMessage:"enumerable"}),dataIndex:"enumerable",hideInForm:!0,hideInSearch:!0,render:function(v,f){return Object(t.jsx)(U.a,{color:f.enumerable?"success":"error",children:Object(t.jsx)(a.a,{id:f.enumerable?"true":"false",defaultMessage:f.enumerable?"true":"false"})})}},{title:Object(t.jsx)(a.a,{id:"public",defaultMessage:"public"}),dataIndex:"public",hideInForm:!0,hideInSearch:!0,render:function(v,f){return Object(t.jsx)(U.a,{color:f.public?"success":"error",children:Object(t.jsx)(a.a,{id:f.public?"true":"false",defaultMessage:f.public?"true":"false"})})}},{hideInSearch:!0,title:Object(t.jsx)(a.a,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",valueType:"option",render:function(v,f){return[f.id>0?Object(t.jsx)(b.a,{title:Object(t.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(t.jsx)(j.a,{type:"primary",icon:Object(t.jsx)(Ie.a,{}),onClick:function(){return c(f.id)}})},"edit"):Object(t.jsx)(b.a,{title:Object(t.jsx)(a.a,{id:"create",defaultMessage:"create"}),children:Object(t.jsx)(j.a,{type:"primary",icon:Object(t.jsx)(ee.a,{}),onClick:function(){c(Me[f.key]||-1)}})},"create"),Object(t.jsx)(_.a,{title:Object(t.jsx)(a.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(O.a)(Object(g.a)().mark(function p(){var m;return Object(g.a)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,it(n,f.id);case 2:m=l.sent,m&&(c(!1),h.current&&h.current.reload());case 4:case"end":return l.stop()}},p)})),okText:Object(t.jsx)(a.a,{id:"yes",defaultMessage:"Yes"}),cancelText:Object(t.jsx)(a.a,{id:"no",defaultMessage:"No"}),children:f.id>0?Object(t.jsx)(b.a,{title:Object(t.jsx)(a.a,{id:"delete",defaultMessage:"delete"}),children:Object(t.jsx)(j.a,{type:"primary",icon:Object(t.jsx)(Ke.a,{}),danger:!0})}):null},"delete")]}}];return Object(t.jsxs)(F.a.Fragment,{children:[Object(t.jsx)(be.a,{headerTitle:n.formatMessage({id:"menu.settings"}),actionRef:h,rowKey:"id",request:function(v){var f=v.pageSize,p=v.current;return Object(P.f)({pageSize:f,current:p,group:"global"}).then(function(m){if(m.success){var L=[].concat(Object(We.a)(Object.keys(Me).map(function(l){return m.data.find(function(E){return E.key===l})||Me[l]})),Object(We.a)(m.data.filter(function(l){return!Object.keys(Me).includes(l.key)})));return{data:L,total:L.length,success:!0}}return[]})},columns:d}),Object(t.jsx)(Le,{groups:[],id:u,visible:u,initialData:Me,onVisibleChange:function(v){return!v&&c(!1)},onFinish:function(){var D=Object(O.a)(Object(g.a)().mark(function v(f){var p,m;return Object(g.a)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return p=f,l.next=3,lt(n,p,Number(u));case 3:m=l.sent,m&&(c(!1),h.current&&h.current.reload());case 5:case"end":return l.stop()}},v)}));return function(v){return D.apply(this,arguments)}}()})]})},ut=ot,ct=e("I5X1"),dt=function(r){return r.replaceAll("escolalms","").split("_").join("")},Ot=T.default=function(){var y=Object(Q.l)(),r=Object(a.j)(),s=y.tab,u=s===void 0?"user_settings":s,c=Object(i.useState)(),h=Object(x.a)(c,2),n=h[0],d=h[1],D=Object(i.useCallback)(function(){Object(P.a)().then(function(m){m.success&&d(m.data)})},[]),v=Object(ct.a)("@@initialState"),f=v.initialState,p=Object(i.useCallback)(function(){var m;return(f==null||(m=f.config)===null||m===void 0?void 0:m.length)!==0},[f]);return Object(i.useEffect)(function(){D()},[]),n?Object(t.jsxs)(S.a,{title:Object(t.jsx)(a.a,{id:"settings"}),header:{breadcrumb:{routes:[{path:"settings",breadcrumbName:r.formatMessage({id:"menu.Configuration.settings"})},{path:String(u),breadcrumbName:String(u)}]}},children:[!p()&&Object(t.jsx)(V.a,{message:Object(t.jsx)(a.a,{id:"global_settings_alert_title",defaultMessage:"Add global settings"}),description:Object(t.jsx)(a.a,{id:"global_settings_alert_description",defaultMessage:"Global settings are used to configure the entire LMS. You can add global settings by clicking the button below."}),type:"warning",showIcon:!0,style:{marginBottom:"20px"}}),Object(t.jsxs)(K.a,{tabs:{type:"card",activeKey:u,onChange:function(L){return a.e.push("/configuration/settings/".concat(L))}},children:[Object(t.jsx)(K.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"user.settings"}),children:Object(t.jsx)(Qe,{})},"user_settings"),Object(t.jsx)(K.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"global_settings"}),children:Object(t.jsx)(ut,{})},"global_settings"),Object.keys(n).map(function(m){return Object(t.jsxs)(K.a.TabPane,{tab:Object(t.jsxs)("span",{children:[Object(t.jsx)(a.a,{id:"package"})," ",dt(m)]}),children:[Object(t.jsx)(st,{values:n,packageName:m,onValueUpdated:function(){return D()}}),m]},m)})]})]}):Object(t.jsx)(G.a,{})}},hd5d:function(ne,T,e){"use strict";var A=e("qLMh"),V=e("9og8"),I=e("q1tI"),G=e.n(I),x=e("3Ef1"),i=e.n(x),F=e("BAh9"),K=e("vtG9"),Q=e.n(K),a=e("9kvl"),S=e("nKUr"),P=e.n(S),R=function(M){var b=M.value,C=M.onChange,j=M.directory,k=j===void 0?"/wysiwyg":j,U=Object(a.j)();return Object(S.jsx)("div",{className:"form-wysiwyg-markdown",children:Object(S.jsx)(i.a,{uploadImage:function(){var se=Object(V.a)(Object(A.a)().mark(function g(z){var J,$;return Object(A.a)().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,Object(F.e)(z,k);case 2:if(J=ee.sent,!J.success){ee.next=6;break}return $=J.data[0].name.includes("/")?J.data[0].name:"".concat(k).concat(J.data[0].name),ee.abrupt("return",Object(F.d)($,1e3));case 6:throw new Error("Error while uploading");case 7:case"end":return ee.stop()}},g)}));return function(g){return se.apply(this,arguments)}}(),defaultValue:b||"",onChange:function(g){return C&&C(g())},placeholder:U.formatMessage({id:"wysiwyg_placeholder"})})})};T.a=R},lLVY:function(ne,T,e){},vtG9:function(ne,T,e){}}]);
