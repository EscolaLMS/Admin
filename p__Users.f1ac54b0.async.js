(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{"DBJ/":function(q,b,e){"use strict";var h=e("k1fw"),S=e("y8nQ"),P=e("Vl3Y"),I=e("tJVT"),w=e("etVw"),x=e("q1tI"),ee=e.n(x),M=e("9kvl"),D=e("qFDU"),v=e("nKUr"),J=e.n(v);function B(o){var m=o.onChange,l=o.onUpload,u=o.url,f=o.name,r=o.extra,a=o.accept,g=o.data,z=o.wrapInForm,te=z===void 0?!0:z,V=o.title,Q=o.formProps,F=o.maxFiles,_=o.clearListAfterUpload,ae=Object(x.useState)(),Y=Object(I.a)(ae,2),G=Y[0],H=Y[1],re=Object(M.j)();return g&&g[f]&&delete g[f],Object(v.jsx)(D.a,{condition:te,wrap:function(A){return Object(v.jsx)(P.a,Object(h.a)(Object(h.a)({},Q),{},{children:A}))},children:Object(v.jsx)(w.a,{title:V||" ".concat(re.formatMessage({id:"upload_click_here"})),placeholder:re.formatMessage({id:"upload_click_here"}),onChange:function(A){H(A),m&&m(A),A.file.status==="done"&&(l&&l(A.file.response),_&&H(void 0))},label:Object(v.jsx)(M.a,{id:"upload"}),max:F!=null?F:2,fieldProps:{data:g,accept:a,name:f,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}},action:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com").concat(u),extra:r,fileList:G==null?void 0:G.fileList})})}b.a=B},"G/Ub":function(q,b,e){"use strict";e.d(b,"d",function(){return w}),e.d(b,"a",function(){return ee}),e.d(b,"b",function(){return D}),e.d(b,"c",function(){return J}),e.d(b,"e",function(){return o});var h=e("qLMh"),S=e("k1fw"),P=e("9og8"),I=e("9kvl");function w(l){return x.apply(this,arguments)}function x(){return x=Object(P.a)(Object(h.a)().mark(function l(u){return Object(h.a)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Object(I.g)("/api/admin/roles",Object(S.a)({method:"GET",useCache:!1},u||{})));case 1:case"end":return r.stop()}},l)})),x.apply(this,arguments)}function ee(l,u){return M.apply(this,arguments)}function M(){return M=Object(P.a)(Object(h.a)().mark(function l(u,f){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(I.g)("/api/admin/roles",Object(S.a)({method:"POST",headers:{"Content-Type":"application/json"},data:u},f||{})));case 1:case"end":return a.stop()}},l)})),M.apply(this,arguments)}function D(l,u){return v.apply(this,arguments)}function v(){return v=Object(P.a)(Object(h.a)().mark(function l(u,f){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(I.g)("/api/admin/roles/".concat(u),Object(S.a)({method:"DELETE",headers:{"Content-Type":"application/json"}},f||{})));case 1:case"end":return a.stop()}},l)})),v.apply(this,arguments)}function J(l,u){return B.apply(this,arguments)}function B(){return B=Object(P.a)(Object(h.a)().mark(function l(u,f){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(I.g)("/api/admin/roles/".concat(u),Object(S.a)({method:"GET",useCache:!1},f||{})));case 1:case"end":return a.stop()}},l)})),B.apply(this,arguments)}function o(l,u,f){return m.apply(this,arguments)}function m(){return m=Object(P.a)(Object(h.a)().mark(function l(u,f,r){return Object(h.a)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",Object(I.g)("/api/admin/roles/".concat(u),Object(S.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:f},r||{})));case 1:case"end":return g.stop()}},l)})),m.apply(this,arguments)}},n6PA:function(q,b,e){},u7Dd:function(q,b,e){"use strict";e.r(b),e.d(b,"TableColumns",function(){return ce});var h=e("P2fV"),S=e("NJEC"),P=e("5Dmo"),I=e("3S7+"),w=e("+L6B"),x=e("2/Rp"),ee=e("miYZ"),M=e("tsqr"),D=e("tJVT"),v=e("k1fw"),J=e("PpiC"),B=e("+BJd"),o=e("mr32"),m=e("qLMh"),l=e("9og8"),u=e("4KAj"),f=e("xvlK"),r=e("q1tI"),a=e("9kvl"),g=e("55Ip"),z=e("tMyG"),te=e("Qiat"),V=e("sWYD"),Q=e("VK58");function F(y,i){return _.apply(this,arguments)}function _(){return _=Object(l.a)(Object(m.a)().mark(function y(i,n){return Object(m.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(a.g)("/api/admin/csv/users",Object(v.a)({params:Object(v.a)(Object(v.a)({},i),{},{per_page:i&&i.pageSize,page:i&&i.current}),method:"GET",headers:{accept:"application/csv"},useCache:!1},n||{})));case 1:case"end":return j.stop()}},y)})),_.apply(this,arguments)}var ae=e("G3dp"),Y=e("/MfK"),G=e("mGZj"),H=e("DBJ/"),re=e("OaEy"),N=e("2fM7"),A=e("T2oS"),de=e("W9HT"),oe=e("G/Ub"),t=e("nKUr"),ue=function(i){var n=i.value,C=i.onChange,j=i.multiple,W=j===void 0?!1:j,se=Object(r.useState)(),Z=Object(D.a)(se,2),U=Z[0],le=Z[1],X=Object(r.useState)(!1),k=Object(D.a)(X,2),L=k[0],c=k[1],d=Object(r.useRef)(),O=Object(r.useRef)(),T=Object(r.useCallback)(function(p){le(p)},[]);Object(r.useEffect)(function(){d.current=U},[U]);var s=Object(r.useCallback)(function(p){c(!0),O.current&&O.current.abort(),O.current=new AbortController,Object(oe.d)({search:p}).then(function(K){K.success&&T(K.data),c(!1)}).catch(function(){return c(!1)})},[T]),E=Object(r.useCallback)(function(p){s(p)},[s]);return Object(t.jsx)(N.a,{onFocus:function(){return s()},allowClear:!0,style:{width:"100%"},value:n,onChange:C,mode:W?"multiple":void 0,showSearch:!0,onSearch:E,placeholder:Object(t.jsx)(a.a,{id:"select_user_role",defaultMessage:"Select role"}),optionFilterProp:"children",filterOption:function(K,R){if(R&&R.children){var $;return(R==null||($=R.children)===null||$===void 0?void 0:$.toString().toLowerCase().indexOf(K.toLowerCase()))>=0}return!0},notFoundContent:L?Object(t.jsx)(de.a,{size:"small"}):null,children:U&&U.map(function(p){return Object(t.jsx)(N.a.Option,{value:p.name,children:p.name},p.id)})})},je=ue,ne=e("nhC9"),he=e("n6PA"),me=["type","defaultRender"],fe=function(){var y=Object(l.a)(Object(m.a)().mark(function i(n){return Object(m.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,Object(Q.c)(n);case 2:return j.abrupt("return",!0);case 3:case"end":return j.stop()}},i)}));return function(n){return y.apply(this,arguments)}}(),ce=[{title:Object(t.jsx)(a.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"created_at",defaultMessage:"created_at"}),dataIndex:"created_at",hideInSearch:!0,render:function(i,n){return n.created_at&&Object(V.a)(new Date(n.created_at),G.a)}},{title:Object(t.jsx)(a.a,{id:"first_name",defaultMessage:"first_name"}),dataIndex:"first_name",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"last_name",defaultMessage:"last_name"}),dataIndex:"last_name",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"email",defaultMessage:"email"}),dataIndex:"email",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"search",defaultMessage:"search"}),dataIndex:"search",hideInSearch:!1,hideInTable:!0,hideInDescriptions:!0,tooltip:Object(t.jsx)(a.a,{id:"search_tooltip_1"})},{title:Object(t.jsx)(a.a,{id:"is_active"}),dataIndex:"is_active",hideInSearch:!0,render:function(i,n){return[Object(t.jsx)(o.a,{color:n.is_active?"green":"red",children:n.is_active?Object(t.jsx)(a.a,{id:"Active"}):Object(t.jsx)(a.a,{id:"Inactive"})},"is_active")]}},{title:Object(t.jsx)(a.a,{id:"email_verified",defaultMessage:"email_verified"}),dataIndex:"email_verified",hideInSearch:!0,render:function(i,n){return[Object(t.jsx)(o.a,{color:n.email_verified?"green":"red",children:n.email_verified?Object(t.jsx)(a.a,{id:"verified"}):Object(t.jsx)(a.a,{id:"unverified"})},"email_verified")]}},{title:Object(t.jsx)(a.a,{id:"created_after",defaultMessage:"Created After"}),key:"from",dataIndex:"from",valueType:"date",hideInTable:!0,hideInDescriptions:!0},{title:Object(t.jsx)(a.a,{id:"created_before",defaultMessage:"Created Before"}),key:"to",dataIndex:"to",valueType:"date",hideInTable:!0,hideInDescriptions:!0},{title:Object(t.jsx)(a.a,{id:"gt_last_login_day",defaultMessage:">= Login last n days"}),key:"gt_last_login_day",dataIndex:"gt_last_login_day",valueType:"digit",hideInTable:!0,hideInDescriptions:!0},{title:Object(t.jsx)(a.a,{id:"lt_last_login_day",defaultMessage:"<= Login last n days"}),key:"lt_last_login_day",dataIndex:"lt_last_login_day",valueType:"digit",hideInTable:!0,hideInDescriptions:!0},{title:Object(t.jsx)(a.a,{id:"roles",defaultMessage:"roles"}),dataIndex:"roles",hideInSearch:!0,render:function(i,n){return n.roles.map(function(C){return Object(t.jsx)(o.a,{children:C},C)})}},{hideInSearch:!1,title:Object(t.jsx)(a.a,{id:"role",defaultMessage:"role"}),dataIndex:"role",renderFormItem:function(i,n){var C=n.type,j=n.defaultRender,W=Object(J.a)(n,me);return Object(t.jsx)(je,Object(v.a)({},W))}}],Oe=function(){var i=Object(r.useRef)(),n=Object(a.j)(),C=Object(r.useState)({}),j=Object(D.a)(C,2),W=j[0],se=j[1],Z=Object(r.useState)(!1),U=Object(D.a)(Z,2),le=U[0],X=U[1],k=Object(r.useCallback)(Object(l.a)(Object(m.a)().mark(function L(){var c,d,O;return Object(m.a)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return X(!0),s.prev=1,s.next=4,F(W);case 4:c=s.sent,c&&(d="data:text/csv;charset=utf-8,"+c,O=document.createElement("a"),O.href=d,O.download="users.csv",document.body.appendChild(O),O.click(),document.body.removeChild(O)),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(1),console.error(s.t0);case 11:return s.prev=11,X(!1),s.finish(11);case 14:case"end":return s.stop()}},L,null,[[1,8,11,14]])})),[W]);return Object(t.jsx)(z.a,{children:Object(t.jsxs)(ne.a,{tabs:{type:"card",activeKey:"list",onChange:function(c){switch(c){case"list":return a.e.push("/users");case"fields":return a.e.push("/users/fields");default:return a.e.push("/users/".concat(c))}}},children:[Object(t.jsx)(ne.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"list"}),children:Object(t.jsx)(te.a,{headerTitle:n.formatMessage({id:"menu.Users",defaultMessage:"users"}),actionRef:i,rowKey:"key",search:{},toolBarRender:function(){return[Object(t.jsx)(H.a,{title:n.formatMessage({id:"import_users"}),url:"/api/admin/csv/users",name:"file",accept:".csv",data:{return_url:"".concat(window.location.origin,"/#/user/reset-password")},onChange:function(d){d.file.status==="done"&&d.file.response&&d.file.response.success&&M.b.success(d.file.response.message),d.file.response&&d.file.status==="error"&&(M.b.error(d.file.response.message),console.error(d.file.response))}},"upload"),Object(t.jsxs)(x.a,{loading:le,type:"primary",onClick:function(){return k()},children:[Object(t.jsx)(u.a,{})," ",Object(t.jsx)(a.a,{id:"export",defaultMessage:"export"})]},"primary"),Object(t.jsx)(g.a,{to:"/users/list/new",children:Object(t.jsxs)(x.a,{type:"primary",children:[Object(t.jsx)(f.a,{})," ",Object(t.jsx)(a.a,{id:"new",defaultMessage:"new"})]},"primary")},"link")]},request:function(c){var d=c.pageSize,O=c.current,T=c.search,s=c.role,E=c.from,p=c.to,K=c.gt_last_login_day,R=c.lt_last_login_day;se({pageSize:d,current:O,search:T,role:s,from:E,to:p,gt_last_login_day:K,lt_last_login_day:R});var $=s&&s.toString()==="all"?void 0:s;return Object(Q.n)({pageSize:d,current:O,search:T,role:$,from:E,to:p,gt_last_login_day:K,lt_last_login_day:R}).then(function(ie){return ie.success?{data:ie.data,total:ie.meta.total,success:!0}:[]})},columns:[].concat(ce,[{hideInSearch:!0,title:Object(t.jsx)(a.a,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(c,d){return[Object(t.jsx)(g.a,{to:"/users/".concat(d.id,"/user_info"),children:Object(t.jsx)(I.a,{title:Object(t.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(t.jsx)(x.a,{type:"primary",icon:Object(t.jsx)(ae.a,{})})})},"edit"),Object(t.jsx)(S.a,{title:Object(t.jsx)(a.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(l.a)(Object(m.a)().mark(function O(){var T;return Object(m.a)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,fe(d.id);case 2:T=E.sent,T&&i.current&&i.current.reload();case 4:case"end":return E.stop()}},O)})),okText:Object(t.jsx)(a.a,{id:"yes"}),cancelText:Object(t.jsx)(a.a,{id:"no"}),children:Object(t.jsx)(I.a,{title:Object(t.jsx)(a.a,{id:"delete",defaultMessage:"delete"}),children:Object(t.jsx)(x.a,{type:"primary",icon:Object(t.jsx)(Y.a,{}),danger:!0})})},"delete")]}}])})},"list"),Object(t.jsx)(ne.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"ModelFields"})},"fields")]})})},ve=b.default=Oe}}]);
