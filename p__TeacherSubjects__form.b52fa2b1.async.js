(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"/y+f":function(Ke,me,t){"use strict";t.d(me,"f",function(){return i}),t.d(me,"d",function(){return f}),t.d(me,"e",function(){return A}),t.d(me,"c",function(){return oe}),t.d(me,"a",function(){return a}),t.d(me,"b",function(){return Le});var i;(function(l){l.Unselected="",l.RichText="EscolaLms\\TopicTypes\\Models\\TopicContent\\RichText",l.OEmbed="EscolaLms\\TopicTypes\\Models\\TopicContent\\OEmbed",l.Audio="EscolaLms\\TopicTypes\\Models\\TopicContent\\Audio",l.Video="EscolaLms\\TopicTypes\\Models\\TopicContent\\Video",l.H5P="EscolaLms\\TopicTypes\\Models\\TopicContent\\H5P",l.Image="EscolaLms\\TopicTypes\\Models\\TopicContent\\Image",l.PDF="EscolaLms\\TopicTypes\\Models\\TopicContent\\PDF",l.SCORM="EscolaLms\\TopicTypes\\Models\\TopicContent\\ScormSco",l.Project="EscolaLms\\TopicTypeProject\\Models\\Project",l.GiftQuiz="EscolaLms\\TopicTypeGift\\Models\\GiftQuiz"})(i||(i={}));var H;(function(l){l.OrderPaid="EscolaLms\\Cart\\Events\\OrderPaid",l.UserLogged="EscolaLms\\Auth\\Events\\UserLogged"})(H||(H={}));var W;(function(l){l.draft="draft",l.published="published",l.archived="archived"})(W||(W={}));var f;(function(l){l.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",l.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",l.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel"})(f||(f={}));var A;(function(l){l.ManuallyTriggeredEvent="EscolaLms\\Templates\\Events\\ManuallyTriggeredEvent"})(A||(A={}));var u;(function(l){l.cart_fixed="cart_fixed",l.cart_percent="cart_percent",l.product_fixed="product_fixed",l.product_percent="product_percent"})(u||(u={}));var oe;(function(l){l.MULTIPLE_CHOICE="multiple_choice",l.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS="multiple_choice_with_multiple_right_answers",l.TRUE_FALSE="true_false",l.SHORT_ANSWERS="short_answers",l.MATCHING="matching",l.NUMERICAL_QUESTION="numerical_question",l.ESSAY="essay",l.DESCRIPTION="description"})(oe||(oe={}));var a;(function(l){l.PRESENT="present",l.ABSENT="absent"})(a||(a={}));var Le;(function(l){l.Manual="manual",l.TeamsForms="teams_forms",l.TeamsLecture="teams_lecture",l.TestPortal="test_portal"})(Le||(Le={}))},"0JQy":function(Ke,me){var t="\\ud800-\\udfff",i="\\u0300-\\u036f",H="\\ufe20-\\ufe2f",W="\\u20d0-\\u20ff",f=i+H+W,A="\\ufe0e\\ufe0f",u="["+t+"]",oe="["+f+"]",a="\\ud83c[\\udffb-\\udfff]",Le="(?:"+oe+"|"+a+")",l="[^"+t+"]",ue="(?:\\ud83c[\\udde6-\\uddff]){2}",Te="[\\ud800-\\udbff][\\udc00-\\udfff]",Se="\\u200d",ie=Le+"?",Re="["+A+"]?",ct="(?:"+Se+"(?:"+[l,ue,Te].join("|")+")"+Re+ie+")*",he=Re+ie+ct,Qe="(?:"+[l+oe+"?",oe,ue,Te,u].join("|")+")",Ve=RegExp(a+"(?="+a+")|"+Qe+he,"g");function g(m){return m.match(Ve)||[]}Ke.exports=g},"5R/X":function(Ke,me,t){},"5Syx":function(Ke,me,t){"use strict";t.d(me,"c",function(){return Ne}),t.d(me,"b",function(){return lt}),t.d(me,"a",function(){return ae});var i=t("OaEy"),H=t("2fM7"),W=t("g9YV"),f=t("wCAj"),A=t("BoS7"),u=t("Sdc0"),oe=t("jrin"),a=t("k1fw"),Le=t("DYRE"),l=t("zeV3"),ue=t("+BJd"),Te=t("mr32"),Se=t("oBTY"),ie=t("tJVT"),Re=t("q1tI"),ct=t.n(Re),he=t("9kvl"),Qe=t("Vpfc"),Ve=t("nhC9"),g=t("LDJE"),m=t("nKUr"),Ze=t.n(m),Xe=function(J){return J.topicable.content.contents?Object.values(J.topicable.content.contents)[0].library:"H5P"},Ne=function(J){var v=J.topics,Z=J.stats,ge=Object(Re.useState)(!1),S=Object(ie.a)(ge,2),j=S[0],pe=S[1],ye=Object(Re.useMemo)(function(){return[{title:Object(m.jsx)(he.a,{id:"user"}),dataIndex:"id",render:function(Ge){return Object(m.jsx)(Qe.a,{type:"App\\Models\\User",type_id:Ge})}},{title:Object(m.jsx)(he.a,{id:"email"}),dataIndex:"email"}].concat(Object(Se.a)(v.map(function(Ee){var Ge,Me=(Ge=Ee.topicable_type)===null||Ge===void 0?void 0:Ge.split("\\").pop();return Me==="H5P"&&(Me=Xe(Ee)),{render:function(R){var k=0,xe=0;switch(R&&(R.started_at&&R.finished_at?k=1:R.started_at&&(k=2),xe=R.seconds/60),k){case 1:return Object(m.jsxs)(l.b,{children:[Object(m.jsx)(Te.a,{color:"success",children:"F"}),j&&Object(m.jsxs)("small",{children:[xe.toFixed(2),"m"]})]});case 2:return Object(m.jsxs)(l.b,{children:[Object(m.jsx)(Te.a,{color:"blue",children:"S"}),j&&Object(m.jsxs)("small",{children:[xe.toFixed(2),"m"]})]});case 0:default:return Object(m.jsx)(ct.a.Fragment,{children:Object(m.jsx)(Te.a,{color:"error",children:"N"})})}},title:Object(m.jsxs)("small",{children:[Object(m.jsx)(Te.a,{children:Me})," ",Ee.title]}),dataIndex:Ee.id}})))},[v,j]),Ce=Object(Re.useMemo)(function(){return Z.map(function(Ee){return v.reduce(function(Ge,Me){var He=Ee.topics.find(function(R){return R.id===Me.id});return Object(a.a)(Object(a.a)({},Ge),{},Object(oe.a)({},Number(Me.id),He!=null?He:0))},{email:Ee.email,id:Ee.id})})},[Z,v]);return Object(m.jsx)(f.a,{title:function(){return Object(m.jsxs)(l.b,{children:[Object(m.jsx)(he.a,{id:"Finished",defaultMessage:"Finished:"})," ",Object(m.jsx)(Te.a,{color:"success",children:"F"}),Object(m.jsx)(he.a,{id:"Started",defaultMessage:"Started:"})," ",Object(m.jsx)(Te.a,{color:"blue",children:"S"}),Object(m.jsx)(he.a,{id:"NotStarted",defaultMessage:"Not Started:"})," ",Object(m.jsx)(Te.a,{color:"error",children:"N"}),Object(m.jsx)(he.a,{id:"ShowMinutes",defaultMessage:"Show minutes spent on topic:"})," ",Object(m.jsx)(u.a,{checked:j,onChange:function(Me){return pe(Me)}})]})},columns:ye,dataSource:Ce,size:"small",scroll:{x:1500}})},lt=function(J){var v=J.stats,Z=Object(Re.useMemo)(function(){return[{title:"user",dataIndex:"id",render:function(j){return Object(m.jsx)(Qe.a,{type:"App\\Models\\User",type_id:j})}},{title:"email",dataIndex:"email"},{title:Object(m.jsx)(he.a,{id:"finished_at",defaultMessage:"Finished at"}),dataIndex:"finished_at"}]},[]),ge=Object(Re.useMemo)(function(){return v.map(function(S){var j=S.id,pe=S.email,ye=S.finished_at;return{id:j,email:pe,finished_at:ye}})},[v]);return Object(m.jsx)(f.a,{title:function(){return Object(m.jsx)(l.b,{children:Object(m.jsx)(he.a,{id:"course.finished",defaultMessage:"Finished"})})},columns:Z,dataSource:ge,size:"small",scroll:{x:500}})},ae=function(J){var v=J.stats,Z=Object(Re.useState)(null),ge=Object(ie.a)(Z,2),S=ge[0],j=ge[1],pe=Object(Re.useState)(null),ye=Object(ie.a)(pe,2),Ce=ye[0],Ee=ye[1],Ge=Object(he.l)(),Me=Object(Re.useMemo)(function(){return v.flatMap(function(R){return Object.values(R.attempts).flatMap(function(k){var xe=k.dates,$=k.attempt,dt=Object.values(xe).flatMap(function(Je){var ke=Je.date,Be=Je.seconds_total;return{date:ke,attempt:$,seconds_total:Be,email:R.email}});return dt})})},[v]),He={xField:"date",yField:"seconds_total",seriesField:"attempt",isStack:!0,xAxis:{label:{autoHide:!0,autoRotate:!1}},slider:{start:0,end:1},label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]}};return Object(m.jsx)(Ve.a,{title:Object(m.jsxs)(l.b,{children:[Object(m.jsx)(he.a,{id:"course.interactions_time_in_days"}),Object(m.jsx)(H.a,{showSearch:!0,value:S,onChange:function(k){j(k),Ee(null)},placeholder:Object(m.jsx)(he.a,{id:"select_person",defaultMessage:"Select a person"}),children:v.map(function(R){var k=R.id,xe=R.email;return Object(m.jsx)(H.a.Option,{value:xe,children:xe},k)})}),Object(m.jsx)(H.a,{value:Ce,onChange:function(k){return Ee(k)},disabled:S===null,placeholder:Object(m.jsx)(he.a,{id:"select_attempt",defaultMessage:"Select attempt"}),children:Object(Se.a)(new Set(Me.filter(function(R){var k=R.email;return k===S}).map(function(R){var k=R.attempt;return k}))).map(function(R){return Object(m.jsxs)(H.a.Option,{value:R,children:[Object(m.jsx)(he.a,{id:"attempt",defaultMessage:"Attempt"})," ",R]},R)})})]}),colSpan:12,layout:"center",children:Object(m.jsx)("div",{style:{overflow:"auto",minHeight:"400px",width:"100%"},children:Object(m.jsx)(g.a,Object(a.a)(Object(a.a)({},He),{},{tooltip:{title:"".concat(Ge.formatMessage({id:"attempt"})),formatter:function(k){var xe=Math.floor(+k.seconds_total/60),$=+k.seconds_total>60?+k.seconds_total-xe*60:0;return{name:k.attempt,value:"".concat(xe,"m ").concat($,"s")}}},data:Me.filter(function(R){var k=R.email;return k===S}).filter(function(R){var k=R.attempt;return Number.isInteger(Ce)?k===Ce:!0})}))})})}},Em2t:function(Ke,me,t){var i=t("bahg"),H=t("quyA"),W=t("0JQy");function f(A){return H(A)?W(A):i(A)}Ke.exports=f},Hn4i:function(Ke,me,t){"use strict";var i=t("y8nQ"),H=t("Vl3Y"),W=t("+L6B"),f=t("2/Rp"),A=t("rePB"),u=t("ODXe"),oe=t("Ff2n"),a=t("x+uP"),Le=t("HaE+"),l=t("VTBJ"),ue=t("nKUr"),Te=t.n(ue),Se=t("xvlK"),ie=t("WuYN"),Re=t("VMEa"),ct=t("LQCs"),he=t("ft2k"),Qe=t("uX+g"),Ve=t("+i8S"),g=t("ipCM"),m=t("6cGi"),Ze=t("ub+h"),Xe=t("bG1m"),Ne=t("q1tI"),lt=t.n(Ne),ae=t("mWMg"),q=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],J=["record","position","creatorButtonText","newRecordType","parentKey","style"],v=lt.a.createContext(void 0);function Z(j){var pe=j.children,ye=j.record,Ce=j.position,Ee=j.newRecordType,Ge=j.parentKey,Me=Object(Ne.useContext)(v);return lt.a.cloneElement(pe,Object(l.a)(Object(l.a)({},pe.props),{},{onClick:function(){var He=Object(Le.a)(Object(a.a)().mark(function k(xe){var $,dt,Je,ke;return Object(a.a)().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.next=2,($=(dt=pe.props).onClick)===null||$===void 0?void 0:$.call(dt,xe);case 2:if(ke=se.sent,ke!==!1){se.next=5;break}return se.abrupt("return");case 5:Me==null||(Je=Me.current)===null||Je===void 0||Je.addEditRecord(ye,{position:Ce,newRecordType:Ee,parentKey:Ge});case 6:case"end":return se.stop()}},k)}));function R(k){return He.apply(this,arguments)}return R}()}))}function ge(j){var pe,ye,Ce=Object(ct.d)(),Ee=j.onTableChange,Ge=j.maxLength,Me=j.formItemProps,He=j.recordCreatorProps,R=j.rowKey,k=j.controlled,xe=j.defaultValue,$=j.onChange,dt=j.editableFormRef,Je=Object(oe.a)(j,q),ke=Object(he.a)(j.value),Be=Object(Ne.useRef)(),se=Object(Ne.useRef)();Object(Ne.useImperativeHandle)(Je.actionRef,function(){return Be.current});var Ot=Object(m.a)(function(){return j.value||xe||[]},{value:j.value,onChange:j.onChange}),ft=Object(u.a)(Ot,2),z=ft[0],_t=ft[1],qe=lt.a.useMemo(function(){return typeof R=="function"?R:function(je,ee){return je[R]||ee}},[R]),mt=function(ee){if(typeof ee=="number"&&!j.name){if(ee>=z.length)return ee;var ne=z&&z[ee];return qe==null?void 0:qe(ne,ee)}if((typeof ee=="string"||ee>=z.length)&&j.name){var be=z.findIndex(function(Q,De){var Ae;return(qe==null||(Ae=qe(Q,De))===null||Ae===void 0?void 0:Ae.toString())===(ee==null?void 0:ee.toString())});return be}return ee};Object(Ne.useImperativeHandle)(dt,function(){var je=function(be){var Q,De;if(be==null)throw new Error("rowIndex is required");var Ae=mt(be),nt=[j.name,(Q=Ae==null?void 0:Ae.toString())!==null&&Q!==void 0?Q:""].flat(1).filter(Boolean);return(De=se.current)===null||De===void 0?void 0:De.getFieldValue(nt)},ee=function(){var be,Q=[j.name].flat(1).filter(Boolean);if(Array.isArray(Q)&&Q.length===0){var De,Ae=(De=se.current)===null||De===void 0?void 0:De.getFieldsValue();return Array.isArray(Ae)?Ae:Object.keys(Ae).map(function(nt){return Ae[nt]})}return(be=se.current)===null||be===void 0?void 0:be.getFieldValue(Q)};return Object(l.a)(Object(l.a)({},se.current),{},{getRowData:je,getRowsData:ee,setRowData:function(be,Q){var De,Ae,nt,vt;if(be==null)throw new Error("rowIndex is required");var ht=mt(be),gt=[j.name,(De=ht==null?void 0:ht.toString())!==null&&De!==void 0?De:""].flat(1).filter(Boolean),pt=((Ae=se.current)===null||Ae===void 0||(nt=Ae.getFieldsValue)===null||nt===void 0?void 0:nt.call(Ae))||{},xt=Object(Xe.a)(pt,gt,Object(l.a)(Object(l.a)({},je(be)),Q||{}));return(vt=se.current)===null||vt===void 0?void 0:vt.setFieldsValue(xt)}})}),Object(Ne.useEffect)(function(){!j.controlled||z.forEach(function(je,ee){var ne;(ne=se.current)===null||ne===void 0||ne.setFieldsValue(Object(A.a)({},qe(je,ee),je))},{})},[z,j.controlled]),Object(Ne.useEffect)(function(){if(j.name){var je;se.current=j==null||(je=j.editable)===null||je===void 0?void 0:je.form}},[(pe=j.editable)===null||pe===void 0?void 0:pe.form,j.name]);var We=He||{},ze=We.record,bt=We.position,e=We.creatorButtonText,L=We.newRecordType,E=We.parentKey,h=We.style,p=Object(oe.a)(We,J),F=bt==="top",K=Object(Ne.useMemo)(function(){return Ge&&Ge<=(z==null?void 0:z.length)?!1:He!==!1&&Object(ue.jsx)(Z,{record:Object(Qe.a)(ze,z==null?void 0:z.length,z)||{},position:bt,parentKey:Object(Qe.a)(E,z==null?void 0:z.length,z),newRecordType:L,children:Object(ue.jsx)(f.a,Object(l.a)(Object(l.a)({type:"dashed",style:Object(l.a)({display:"block",margin:"10px 0",width:"100%"},h),icon:Object(ue.jsx)(Se.a,{})},p),{},{children:e||Ce.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[He,Ge,z==null?void 0:z.length]),Pe=Object(Ne.useMemo)(function(){return K?F?{components:{header:{wrapper:function(ee){var ne,be=ee.className,Q=ee.children;return Object(ue.jsxs)("thead",{className:be,children:[Q,Object(ue.jsxs)("tr",{style:{position:"relative"},children:[Object(ue.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:K}),Object(ue.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(ne=Je.columns)===null||ne===void 0?void 0:ne.length,children:K})]})]})}}}}:{tableViewRender:function(ee,ne){var be,Q;return Object(ue.jsxs)(ue.Fragment,{children:[(be=(Q=j.tableViewRender)===null||Q===void 0?void 0:Q.call(j,ee,ne))!==null&&be!==void 0?be:ne,K]})}}:{}},[F,K]),it=Object(l.a)({},j.editable),Ye=Object(Ve.a)(function(je,ee){var ne,be,Q;if((ne=j.editable)===null||ne===void 0||(be=ne.onValuesChange)===null||be===void 0||be.call(ne,je,ee),(Q=j.onValuesChange)===null||Q===void 0||Q.call(j,ee,je),j.controlled){var De;j==null||(De=j.onChange)===null||De===void 0||De.call(j,ee)}});return((j==null?void 0:j.onValuesChange)||((ye=j.editable)===null||ye===void 0?void 0:ye.onValuesChange)||j.controlled&&(j==null?void 0:j.onChange))&&(it.onValuesChange=Ye),Object(ue.jsxs)(ue.Fragment,{children:[Object(ue.jsx)(v.Provider,{value:Be,children:Object(ue.jsx)(ae.a,Object(l.a)(Object(l.a)(Object(l.a)({search:!1,options:!1,pagination:!1,rowKey:R,revalidateOnFocus:!1},Je),Pe),{},{tableLayout:"fixed",actionRef:Be,onChange:Ee,editable:Object(l.a)(Object(l.a)({},it),{},{formProps:Object(l.a)({formRef:se},it.formProps)}),dataSource:z,onDataSourceChange:function(ee){if(_t(ee),j.name&&bt==="top"){var ne,be=Object(Xe.a)({},[j.name].flat(1).filter(Boolean),ee);(ne=se.current)===null||ne===void 0||ne.setFieldsValue(be)}}}))}),j.name?Object(ue.jsx)(ie.a,{name:[j.name],children:function(ee){var ne,be,Q=Object(Ze.a)(ee,[j.name].flat(1)),De=Q==null?void 0:Q.find(function(Ae,nt){return!Object(g.a)(Ae,ke==null?void 0:ke[nt])});return De&&ke&&(j==null||(ne=j.editable)===null||ne===void 0||(be=ne.onValuesChange)===null||be===void 0||be.call(ne,De,Q)),null}}):null]})}function S(j){var pe=Re.a.useFormInstance();return j.name?Object(ue.jsx)(H.a.Item,Object(l.a)(Object(l.a)({style:{maxWidth:"100%"}},j==null?void 0:j.formItemProps),{},{name:j.name,children:Object(ue.jsx)(ge,Object(l.a)(Object(l.a)({},j),{},{editable:Object(l.a)(Object(l.a)({},j.editable),{},{form:pe})}))})):Object(ue.jsx)(ge,Object(l.a)({},j))}S.RecordCreator=Z,me.a=S},KxBF:function(Ke,me){function t(i,H,W){var f=-1,A=i.length;H<0&&(H=-H>A?0:A+H),W=W>A?A:W,W<0&&(W+=A),A=H>W?0:W-H>>>0,H>>>=0;for(var u=Array(A);++f<A;)u[f]=i[f+H];return u}Ke.exports=t},LDJE:function(Ke,me,t){"use strict";var i=t("q1tI"),H=t.n(i),W=t("ma/q"),f=t("ZIEt"),A=t("QpZ9"),u=t("GzfL"),oe=t("Scwr"),a=function(l,ue){var Te={};for(var Se in l)Object.prototype.hasOwnProperty.call(l,Se)&&ue.indexOf(Se)<0&&(Te[Se]=l[Se]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ie=0,Se=Object.getOwnPropertySymbols(l);ie<Se.length;ie++)ue.indexOf(Se[ie])<0&&Object.prototype.propertyIsEnumerable.call(l,Se[ie])&&(Te[Se[ie]]=l[Se[ie]]);return Te},Le=Object(i.forwardRef)(function(l,ue){var Te=l.chartRef,Se=l.style,ie=Se===void 0?{height:"inherit"}:Se,Re=l.className,ct=l.loading,he=l.loadingTemplate,Qe=l.errorTemplate,Ve=a(l,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),g=Object(f.a)(W.a,Ve),m=g.chart,Ze=g.container;return Object(i.useEffect)(function(){Object(A.a)(Te,m.current)},[m.current]),Object(i.useImperativeHandle)(ue,function(){return{getChart:function(){return m.current}}}),H.a.createElement(u.a,{errorTemplate:Qe},ct&&H.a.createElement(oe.a,{loadingTemplate:he,theme:l.theme}),H.a.createElement("div",{className:Re,style:ie,ref:Ze}))});me.a=Le},bahg:function(Ke,me){function t(i){return i.split("")}Ke.exports=t},olry:function(Ke,me,t){"use strict";t.r(me);var i=t("k1fw"),H=t("+L6B"),W=t("2/Rp"),f=t("T2oS"),A=t("W9HT"),u=t("q1tI"),oe=t("nhC9"),a=t("9kvl"),Le=t("55Ip"),l=t("Ty5D"),ue=t("tMyG"),Te=t("my69"),Se=t("huej"),ie=t("mJ0o"),Re=t("EhlZ"),ct=t("P2fV"),he=t("NJEC"),Qe=t("5Dmo"),Ve=t("3S7+"),g=t("qLMh"),m=t("9og8"),Ze=t("sWYD"),Xe=t("G3dp"),Ne=t("lbgm"),lt=t("/MfK"),ae=t("Qiat"),q=t("mGZj");function J(o,c){return v.apply(this,arguments)}function v(){return v=Object(m.a)(Object(g.a)().mark(function o(c,r){return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams",Object(i.a)({method:"GET",useCache:!1,params:c},r||{})));case 1:case"end":return n.stop()}},o)})),v.apply(this,arguments)}function Z(o,c){return ge.apply(this,arguments)}function ge(){return ge=Object(m.a)(Object(g.a)().mark(function o(c,r){return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams",Object(i.a)({method:"POST",headers:{"Content-Type":"application/json"},data:c},r||{})));case 1:case"end":return n.stop()}},o)})),ge.apply(this,arguments)}function S(o,c,r){return j.apply(this,arguments)}function j(){return j=Object(m.a)(Object(g.a)().mark(function o(c,r,s){return Object(g.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/exams/".concat(c),Object(i.a)({method:"PUT",data:r,useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),j.apply(this,arguments)}function pe(o,c){return ye.apply(this,arguments)}function ye(){return ye=Object(m.a)(Object(g.a)().mark(function o(c,r){return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams/".concat(c),Object(i.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),ye.apply(this,arguments)}function Ce(o,c){return Ee.apply(this,arguments)}function Ee(){return Ee=Object(m.a)(Object(g.a)().mark(function o(c,r){return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams/".concat(c),Object(i.a)({method:"DELETE"},r||{})));case 1:case"end":return n.stop()}},o)})),Ee.apply(this,arguments)}function Ge(o,c,r,s){return Me.apply(this,arguments)}function Me(){return Me=Object(m.a)(Object(g.a)().mark(function o(c,r,s,n){return Object(g.a)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",Object(a.i)("/api/admin/exams/".concat(c,"/users/").concat(r),Object(i.a)({method:"POST",headers:{"Content-Type":"application/json"},data:s},n||{})));case 1:case"end":return b.stop()}},o)})),Me.apply(this,arguments)}function He(o,c,r){return R.apply(this,arguments)}function R(){return R=Object(m.a)(Object(g.a)().mark(function o(c,r,s){return Object(g.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/exams/".concat(c,"/users/").concat(r),Object(i.a)({method:"DELETE"},s||{})));case 1:case"end":return d.stop()}},o)})),R.apply(this,arguments)}var k=t("giR+"),xe=t("fyUT"),$=t("tJVT"),dt=t("14J3"),Je=t("BMrR"),ke=t("jCWc"),Be=t("kPKH"),se=t("VMEa"),Ot=t("Qurx"),ft=t("lR9U"),z=t("/y+f"),_t=t("2qtc"),qe=t("kLXV"),mt=t("OaEy"),We=t("2fM7"),ze=t("oBTY"),bt=t("DBJ/"),e=t("nKUr"),L=[z.b.TeamsLecture,z.b.TestPortal,z.b.TeamsForms];function E(o){var c=o.showSelectAll,r=c===void 0?!0:c,s=o.options,n=s===void 0?[]:s,d=o.value,b=o.onChange,O=Object(u.useCallback)(function(){b==null||b(n.map(function(C){return C.value}),n)},[b,n]),T=Object(u.useCallback)(function(){b==null||b([],[])},[b]),y=Object(u.useMemo)(function(){return r?[{label:d!=null&&d.length?Object(e.jsx)(W.a,{type:"link",onClick:T,children:Object(e.jsx)(a.a,{id:"deselect_all"})}):Object(e.jsx)(W.a,{type:"link",onClick:O,children:Object(e.jsx)(a.a,{id:"select_all"})}),options:n}]:n},[O,T,n,r,d==null?void 0:d.length]);return{options:y,value:d,onChange:b}}var h=function(c){var r=c.open,s=c.closeModal,n=c.onSuccess,d=c.type,b=Object(ie.b)(),O=b.teacherSubjectData,T=b.semester_subject_id,y=b.groupUsers,C=b.getGroupUsers,P=Object(u.useState)(),D=Object($.a)(P,2),G=D[0],M=D[1],Y=Object(u.useState)([]),_=Object($.a)(Y,2),w=_[0],ve=_[1],x={type:d,semester_subject_id:T},V=Object(u.useCallback)(function(B){B.success&&M(B.data.results)},[]),U=Object(u.useMemo)(function(){var B;return((B=O==null?void 0:O.groups)!==null&&B!==void 0?B:[]).map(function(_e){var Ie=_e.id,ce=_e.name;return{label:ce,value:Ie}})},[]),N=Object(u.useCallback)(function(B){ve(B);var _e=B.reduce(function(Ie,ce){var re,fe=(re=y.byId)===null||re===void 0?void 0:re[ce];if(!fe)return Ie;var X=fe.users.map(function(te){var $e=te.id,I=te.email,Oe=te.first_name,de=te.last_name;return{email:I,first_name:Oe,last_name:de,user_id:$e,result:0}});return[].concat(Object(ze.a)(Ie),Object(ze.a)(X))},[]);M(_e!=null&&_e.length?_e:void 0)},[y.byId]),le=E({options:U,onChange:N,value:w});return Object(u.useEffect)(function(){if(d===z.b.Manual&&r){var B;O==null||(B=O.groups)===null||B===void 0||B.forEach(function(_e){var Ie=_e.id;return C(Ie)})}},[d,r]),Object(e.jsxs)(qe.a,{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.".concat(d,"Convert")}),width:"40vw",open:r,onCancel:s,onOk:function(){G&&n(G)},okButtonProps:{disabled:!G},children:[L.includes(d)&&Object(e.jsx)(bt.a,{name:"file",url:"/api/admin/exams/parse",onUpload:V,onChange:function(_e){return!_e.fileList.length&&M(void 0)},maxFiles:1,data:x,hideLabel:!0}),d===z.b.Manual&&Object(e.jsx)(We.a,Object(i.a)(Object(i.a)({},le),{},{placeholder:Object(e.jsx)(a.a,{id:"select_groups"}),mode:"multiple",style:{width:"100%"}}))]})},p=function(c){var r=c.onSelect;return Object(e.jsxs)(Je.a,{gutter:[16,16],children:[Object(e.jsx)(Be.a,{span:12,children:Object(e.jsx)(W.a,{type:"primary",onClick:function(){return r(z.b.TeamsForms)},children:Object(e.jsx)(a.a,{id:"uploadFile.MsTeamsForms",defaultMessage:"uploadFile.MsTeamsForms"})})}),Object(e.jsx)(Be.a,{span:12,children:Object(e.jsx)(W.a,{type:"primary",onClick:function(){return r(z.b.TestPortal)},children:Object(e.jsx)(a.a,{id:"uploadFile.TestPortal",defaultMessage:"uploadFile.TestPortal"})})}),Object(e.jsx)(Be.a,{span:12,children:Object(e.jsx)(W.a,{type:"primary",onClick:function(){return r(z.b.TeamsLecture)},children:Object(e.jsx)(a.a,{id:"uploadFile.MsTeams",defaultMessage:"uploadFile.MsTeams"})})}),Object(e.jsx)(Be.a,{span:12,children:Object(e.jsx)(W.a,{type:"primary",onClick:function(){return r(z.b.Manual)},children:Object(e.jsx)(a.a,{id:"uploadGradesManually",defaultMessage:"uploadGradesManually"})})})]})},F=[{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"first_name",editable:!1},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"last_name",editable:!1},{title:Object(e.jsx)(a.a,{id:"examResult"}),dataIndex:"result",valueType:"percent",formItemProps:{rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:0,max:100}})}]}}],K=function(c){var r=c.exam_id,s=se.a.useForm(),n=Object($.a)(s,1),d=n[0],b=Object(u.useState)(),O=Object($.a)(b,2),T=O[0],y=O[1],C=Object(u.useState)(),P=Object($.a)(C,2),D=P[0],G=P[1],M=Object(u.useState)(!1),Y=Object($.a)(M,2),_=Y[0],w=Y[1],ve=Object(ie.b)(),x=ve.semester_subject_id,V=Object(u.useMemo)(function(){return(D!=null?D:[]).map(function(N){var le=N.user_id;return le})},[D]);Object(u.useEffect)(function(){var N=Number(r);r==="new"&&(y(void 0),G(void 0),d.resetFields()),r!=="new"&&!Number.isNaN(N)&&(w(!0),pe(N).then(function(le){if(le.success){var B=le.data,_e=B.type,Ie=B.results,ce=B.title,re=B.weight,fe=B.passed_at;y(_e),G(Ie),d.setFieldsValue({title:ce,weight:re,passed_at:fe})}}).finally(function(){return w(!1)}))},[r]);var U=Object(u.useCallback)(function(){y(void 0),G(void 0)},[]);return _?Object(e.jsx)(A.a,{}):Object(e.jsxs)(e.Fragment,{children:[T&&Object(e.jsx)(h,{open:Boolean(T&&!D),type:T,closeModal:U,onSuccess:G}),Object(e.jsxs)(se.a,{form:d,submitter:T===void 0||!D?!1:void 0,onFinish:function(){var N=Object(m.a)(Object(g.a)().mark(function le(B){var _e,Ie,ce,re,fe,X,te;return Object(g.a)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(_e=D==null?void 0:D.every(function(Oe){var de=Oe.result;return typeof de=="number"&&de>=0&&de<=100}),!(_e&&typeof x=="number")){I.next=16;break}if(Ie=B.title,ce=B.passed_at,re=B.weight,fe=Number(r),X={type:T,semester_subject_id:x,title:Ie,passed_at:ce,weight:re,results:D},!Number.isNaN(fe)){I.next=11;break}return I.next=8,Z(X);case 8:I.t0=I.sent,I.next=14;break;case 11:return I.next=13,S(fe,X);case 13:I.t0=I.sent;case 14:te=I.t0,te.success&&a.f.push("/teacher/subjects/".concat(x,"/exams"));case 16:return I.abrupt("return",!0);case 17:case"end":return I.stop()}},le)}));return function(le){return N.apply(this,arguments)}}(),onReset:U,children:[Object(e.jsxs)(se.a.Group,{children:[Object(e.jsx)(Ot.a,{label:Object(e.jsx)(a.a,{id:"examTitle",defaultMessage:"examTitle"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],width:"lg",name:"title"}),Object(e.jsx)(ft.a,{label:Object(e.jsx)(a.a,{id:"datePassingExam",defaultMessage:"datePassingExam"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],width:"lg",name:"passed_at"}),Object(e.jsx)(se.a.Item,{name:"weight",label:Object(e.jsx)(a.a,{id:"examImportance",defaultMessage:"examImportance"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:1,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:1,max:100}})}],children:Object(e.jsx)(xe.a,{})})]}),T&&D&&Object(e.jsx)(ae.a,{rowKey:"user_id",editable:{type:"single",editableKeys:V,onValuesChange:function(le,B){return G(B)}},cardProps:{bodyStyle:{paddingInline:0}},search:!1,dataSource:D,columns:F}),!D&&Object(e.jsx)(p,{onSelect:y})]})]})},Pe=[{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"first_name"},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"last_name"},{title:Object(e.jsx)(a.a,{id:"examResult"}),dataIndex:"result",hideInSearch:!0}],it=function(c){var r=c.exam_id;return Object(e.jsx)(ae.a,{rowKey:"user_id",search:!1,headerTitle:Object(e.jsx)(a.a,{id:"examResults"}),request:Object(m.a)(Object(g.a)().mark(function s(){var n;return Object(g.a)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,pe(r);case 2:if(n=b.sent,!n.success){b.next=5;break}return b.abrupt("return",{total:n.data.results.length,success:!0,data:n.data.results});case 5:return b.abrupt("return",[]);case 6:case"end":return b.stop()}},s)})),columns:Pe})},Ye=[{title:Object(e.jsx)(a.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",sorter:!0},{title:Object(e.jsx)(a.a,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!0,sorter:!0},{title:Object(e.jsx)(a.a,{id:"type",defaultMessage:"type"}),dataIndex:"type",sorter:!0,render:function(c,r){return Object(e.jsx)(a.a,{id:"ExamGradeType.".concat(r.type)})}},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.exam_date",defaultMessage:"Exam date"}),dataIndex:"passed_at",sorter:!0,render:function(c,r){return r.passed_at&&Object(Ze.a)(new Date(r.passed_at),q.c)}},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",sorter:!0,render:function(c,r){return r.weight+"%"}},{title:Object(e.jsx)(a.a,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",sorter:!0,render:function(c,r){return r.created_at&&Object(Ze.a)(new Date(r.created_at),q.c)}},{title:Object(e.jsx)(a.a,{id:"semester",defaultMessage:"Semester"}),dataIndex:"semester",sorter:!0,render:function(c,r){return Object(e.jsx)(a.a,{id:"SemesterType.".concat(r.semester.type),values:{year:r.semester.year}})}}],je=function(){var c,r,s=Object(u.useRef)(),n=Object(ie.b)(),d=n.semester_subject_id,b=Object(l.k)(),O=Object(u.useMemo)(function(){var C,P,D;return{exam_id:(C=(P=b.query)===null||P===void 0?void 0:P.exam_id)!==null&&C!==void 0?C:null,results:(D=b.query)===null||D===void 0?void 0:D.results}},[(c=b.query)===null||c===void 0?void 0:c.exam_id,(r=b.query)===null||r===void 0?void 0:r.results]),T=O.exam_id,y=O.results;return y!==null&&!Number.isNaN(Number(y))?Object(e.jsx)(it,{exam_id:Number(y)}):T!==null?Object(e.jsx)(K,{exam_id:T}):Object(e.jsx)(ae.a,{headerTitle:Object(e.jsx)(a.a,{id:"exams"}),actionRef:s,search:!1,rowKey:"id",request:function(){var C=Object(m.a)(Object(g.a)().mark(function P(D,G){var M,Y,_,w;return Object(g.a)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(M=D.current,Y=D.pageSize,d!==null){x.next=3;break}return x.abrupt("return",{data:[],total:0,success:!1});case 3:return _=G&&Object.entries(G)[0],x.next=6,J({per_page:Y,page:M,semester_subject_id:Number.isNaN(d)?void 0:d,order_by:_&&_[0],order:_&&(_[1]==="ascend"?"ASC":"DESC")});case 6:if(w=x.sent,!w.success){x.next=9;break}return x.abrupt("return",{data:w.data,total:w.meta.total,success:!0});case 9:return x.abrupt("return",{data:[],total:0,success:!1});case 10:case"end":return x.stop()}},P)}));return function(P,D){return C.apply(this,arguments)}}(),columns:[].concat(Ye,[{title:Object(e.jsx)(a.a,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(P,D){return[Object(e.jsx)(Le.a,{to:"/teacher/subjects/".concat(D.semester_subject_id,"/exams?exam_id=").concat(D.id),children:Object(e.jsx)(Ve.a,{title:Object(e.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(e.jsx)(W.a,{type:"primary",icon:Object(e.jsx)(Xe.a,{})})})},"edit"),Object(e.jsx)(Le.a,{to:"/teacher/subjects/".concat(D.semester_subject_id,"/exams?results=").concat(D.id),children:Object(e.jsx)(Ve.a,{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.results",defaultMessage:"results"}),children:Object(e.jsx)(W.a,{icon:Object(e.jsx)(Ne.a,{})})})},"results"),Object(e.jsx)(he.a,{title:Object(e.jsx)(a.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(m.a)(Object(g.a)().mark(function G(){var M;return Object(g.a)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,Ce(D.id);case 2:M=_.sent,M.success&&s.current&&s.current.reload();case 4:case"end":return _.stop()}},G)})),okText:Object(e.jsx)(a.a,{id:"yes"}),cancelText:Object(e.jsx)(a.a,{id:"no"}),children:Object(e.jsx)(Ve.a,{title:Object(e.jsx)(a.a,{id:"delete",defaultMessage:"delete"}),children:Object(e.jsx)(W.a,{type:"primary",icon:Object(e.jsx)(lt.a,{}),danger:!0})})},"delete")]}}])})},ee=t("DYRE"),ne=t("zeV3"),be=t("tU7J"),Q=t("wFql"),De=t("4KAj"),Ae=t("o0Ox"),nt=[{title:Object(e.jsx)(a.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"user_id",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"first_name",defaultMessage:"First name"}),dataIndex:"first_name",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"last_name",defaultMessage:"Last name"}),dataIndex:"last_name",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"email",defaultMessage:"email"}),dataIndex:"email",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"groupName",defaultMessage:"Group name"}),dataIndex:"group_name",hideInSearch:!0}],vt=function(){var c,r=Object(u.useState)(!1),s=Object($.a)(r,2),n=s[0],d=s[1],b=Object(ie.b)(),O=b.teacherSubjectData,T=Object(u.useState)([]),y=Object($.a)(T,2),C=y[0],P=y[1],D=Object(u.useRef)(),G=Object(u.useMemo)(function(){return C.reduce(function(_,w){var ve,x=[];return w==null||(ve=w.users)===null||ve===void 0||ve.reduce(function(V,U){var N={group_id:w.id,group_name:w.name,user_id:U.id,first_name:U.first_name,last_name:U.last_name,email:U.email};return x.push(N),Object(i.a)(Object(i.a)({},V),N)},{}),d(!1),[].concat(Object(ze.a)(_),x)},[])},[C]),M=function(w){Object(Ae.a)({parent_id:O==null?void 0:O.group_id,"id[]":w}).then(function(ve){ve.success&&P(ve.data)})},Y=function(w){d(!0),M(w)};return Object(u.useEffect)(function(){M()},[]),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(oe.a,{children:Object(e.jsxs)(ne.b,{children:[Object(e.jsx)(Q.a.Title,{level:5,children:Object(e.jsx)(a.a,{id:"select_user_group",defaultMessage:"Select group"})}),Object(e.jsx)(We.a,{allowClear:!0,mode:"multiple",style:{minWidth:"400px"},onChange:Y,onClear:M,children:O==null||(c=O.groups)===null||c===void 0?void 0:c.map(function(_){return Object(e.jsx)(We.a.Option,{value:_.id,children:_.name},_.id)})})]})}),Object(e.jsx)(ae.a,{actionRef:D,rowKey:"user_id",search:!1,loading:n,dataSource:G!=null?G:[],columns:[].concat(nt,[{hideInSearch:!0,title:Object(e.jsx)(a.a,{id:"msTeams"}),dataIndex:"teamsLink",valueType:"option",render:function(){return[Object(e.jsx)(Le.a,{to:"#",children:Object(e.jsx)(Ve.a,{title:Object(e.jsx)(a.a,{id:"msTeams",defaultMessage:"teams"}),children:Object(e.jsx)(W.a,{type:"primary",icon:Object(e.jsx)(De.a,{})})})},"teamsLink")]}}])})]})},ht=vt,gt=t("jrin");function pt(o,c){return xt.apply(this,arguments)}function xt(){return xt=Object(m.a)(Object(g.a)().mark(function o(c,r){return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/schedules/groups/".concat(c),Object(i.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),xt.apply(this,arguments)}function $t(o,c,r,s){return Tt.apply(this,arguments)}function Tt(){return Tt=Object(m.a)(Object(g.a)().mark(function o(c,r,s,n){return Object(g.a)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",Object(a.i)("/api/admin/schedules/".concat(c,"/attendances"),Object(i.a)({data:{attendances:[{user_id:r,value:s}]},method:"POST"},n||{})));case 1:case"end":return b.stop()}},o)})),Tt.apply(this,arguments)}var Ia=t("sRBo"),Kt=t("kaz8"),Vt=function(c){var r=c.currentData,s=c.recordData,n=c.groupId,d=c.onSuccess,b=Object(u.useState)(!1),O=Object($.a)(b,2),T=O[0],y=O[1],C=function(){y(!0),$t(r.id,s.id,(s==null?void 0:s[String(r.date_from)])===z.a.PRESENT?z.a.ABSENT:z.a.PRESENT).then(function(D){D.success&&pt(Number(n)).then(function(G){G.success&&(d(G.data),y(!1))})})};return T?Object(e.jsx)(A.a,{size:"small"}):Object(e.jsx)(Kt.a,{checked:(s==null?void 0:s[String(r.date_from)])===z.a.PRESENT,onChange:function(){return C()}})},Ht=Vt,Jt=function(){var c,r,s,n,d,b=Object(ie.b)(),O=b.teacherSubjectData,T=Object(u.useRef)(),y=Object(a.l)(),C=Object(u.useState)(!1),P=Object($.a)(C,2),D=P[0],G=P[1],M=Object(u.useState)(),Y=Object($.a)(M,2),_=Y[0],w=Y[1],ve=Object(u.useState)(),x=Object($.a)(ve,2),V=x[0],U=x[1],N=Object(u.useState)({id:(c=O==null||(r=O.groups)===null||r===void 0?void 0:r[0].id)!==null&&c!==void 0?c:null,name:O==null||(s=O.groups)===null||s===void 0?void 0:s[0].name}),le=Object($.a)(N,2),B=le[0],_e=le[1],Ie=Object(u.useMemo)(function(){var X;return((X=V==null?void 0:V.users)!==null&&X!==void 0?X:[]).reduce(function(te,$e){var I={id:$e.id,first_name:$e.first_name,last_name:$e.last_name,academic_teacher_id:$e.academic_teacher_id},Oe=(_!=null?_:[]).reduce(function(de,Ue){var Fe=Ue.attendances.find(function(et){return et.user_id===$e.id});return Object(i.a)(Object(i.a)({},de),{},Object(gt.a)({},String(Ue.date_from),Fe==null?void 0:Fe.value))},{});return I.academic_teacher_id?Object(ze.a)(te):[].concat(Object(ze.a)(te),[Object(i.a)(Object(i.a)({},I),Oe)])},[])},[V,_]),ce=Object(u.useMemo)(function(){var X=(_!=null?_:[]).reduce(function(te,$e){return[].concat(Object(ze.a)(te),[{title:String(Object(Ze.a)(new Date($e.date_from),q.c)),dataIndex:String($e.date_from),hideInSearch:!0,width:100,align:"center",render:function(Oe,de){return Object(e.jsx)(Ht,{currentData:$e,recordData:de,onSuccess:function(Fe){return w(Fe)},groupId:B.id})}}])},[]);return console.log({columns:ce}),G(!1),[{title:Object(e.jsx)(a.a,{id:"nameAndSurname",defaultMessage:"Name and surname"}),hideInSearch:!0,fixed:"left",render:function($e,I){return"".concat(I.first_name," ").concat(I.last_name)}}].concat(Object(ze.a)(X))},[_]),re=function(te){var $e,I=O==null||($e=O.groups)===null||$e===void 0?void 0:$e.find(function(Oe){return Oe.id===te});return I?I==null?void 0:I.name:""},fe=function(te){G(!0),_e({id:te,name:re(te)})};return Object(u.useEffect)(function(){B.id&&(pt(B.id).then(function(X){X.success&&w(X.data)}),Object(Ae.b)(B.id).then(function(X){X.success&&U(X.data)}))},[B]),console.log({studentAttendanceList:Ie}),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(oe.a,{children:Object(e.jsxs)(ne.b,{children:[Object(e.jsx)(Q.a.Title,{level:5,children:Object(e.jsx)(a.a,{id:"select_user_group",defaultMessage:"Select group"})}),Object(e.jsx)(We.a,{style:{minWidth:"400px"},onChange:fe,defaultValue:O==null||(n=O.groups)===null||n===void 0?void 0:n[0].id,children:O==null||(d=O.groups)===null||d===void 0?void 0:d.map(function(X){return Object(e.jsx)(We.a.Option,{value:X.id,children:X.name},X.id)})})]})}),ce.length===1?Object(e.jsx)(a.a,{id:"noAttendanceSchedule",defaultMessage:"No attendance schedule for this group..."}):Object(e.jsx)(ae.a,{headerTitle:"".concat(y.formatMessage({id:"attendances",defaultMessage:"Attendances"})," (").concat(B.name,")"),actionRef:T,rowKey:"group_id",search:!1,loading:D,dataSource:Ie!=null?Ie:[],scroll:{x:1500},columns:Object(ze.a)(ce)})]})},zt=Jt,Ra=t("/zsF"),yt=t("PArb"),Yt=t("Hn4i"),Zt=t("bRQS");function Bt(o,c,r){return Ct.apply(this,arguments)}function Ct(){return Ct=Object(m.a)(Object(g.a)().mark(function o(c,r,s){return Object(g.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/semester-subjects/".concat(c,"/tutors/").concat(r,"/grades"),Object(i.a)({method:"GET",useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),Ct.apply(this,arguments)}function Qt(o,c,r,s){return Mt.apply(this,arguments)}function Mt(){return Mt=Object(m.a)(Object(g.a)().mark(function o(c,r,s,n){return Object(g.a)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",Object(a.i)("/api/admin/semester-subjects/".concat(c,"/tutors/").concat(r,"/grades"),Object(i.a)({method:"POST",data:s},n||{})));case 1:case"end":return b.stop()}},o)})),Mt.apply(this,arguments)}function Xt(o,c){return Pt.apply(this,arguments)}function Pt(){return Pt=Object(m.a)(Object(g.a)().mark(function o(c,r){return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/lesson-group-users",Object(i.a)({method:"GET",params:{"groups[]":c},useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),Pt.apply(this,arguments)}function kt(o,c,r){return Dt.apply(this,arguments)}function Dt(){return Dt=Object(m.a)(Object(g.a)().mark(function o(c,r,s){return Object(g.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/lesson-group-users/groups/".concat(c,"/users/").concat(r),Object(i.a)({method:"GET",useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),Dt.apply(this,arguments)}function qt(o){return At.apply(this,arguments)}function At(){return At=Object(m.a)(Object(g.a)().mark(function o(c){return Object(g.a)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",Object(a.i)("/api/admin/grade-terms",Object(i.a)({method:"GET",useCache:!1},c||{})));case 1:case"end":return s.stop()}},o)})),At.apply(this,arguments)}function ea(o,c){return It.apply(this,arguments)}function It(){return It=Object(m.a)(Object(g.a)().mark(function o(c,r){return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/grade-scales/".concat(c),Object(i.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),It.apply(this,arguments)}function ta(o,c){return Rt.apply(this,arguments)}function Rt(){return Rt=Object(m.a)(Object(g.a)().mark(function o(c,r){return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/final-grades",Object(i.a)({method:"POST",data:c},r||{})));case 1:case"end":return n.stop()}},o)})),Rt.apply(this,arguments)}function aa(o,c,r){return Lt.apply(this,arguments)}function Lt(){return Lt=Object(m.a)(Object(g.a)().mark(function o(c,r,s){return Object(g.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/final-grades/".concat(c),Object(i.a)({method:"PATCH",data:r},s||{})));case 1:case"end":return d.stop()}},o)})),Lt.apply(this,arguments)}var na=[{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade",editable:!1},{title:Object(e.jsx)(a.a,{id:"degree"}),dataIndex:"name",editable:!1},{title:Object(e.jsx)(a.a,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent",formItemProps:{rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:0,max:100}})}]}}],ra=function(){var c,r,s=Object(a.m)("@@initialState"),n=s.initialState,d=Object(ie.b)(),b=d.semester_subject_id,O=d.tutors,T=se.a.useForm(),y=Object($.a)(T,1),C=y[0],P=Object(u.useState)([]),D=Object($.a)(P,2),G=D[0],M=D[1],Y=Object(u.useRef)(),_=Object(u.useState)(!1),w=Object($.a)(_,2),ve=w[0],x=w[1],V=Object(u.useState)(null),U=Object($.a)(V,2),N=U[0],le=U[1],B=Object(u.useMemo)(function(){return!!O.data.find(function(ce){var re,fe=ce.id;return fe===(n==null||(re=n.currentUser)===null||re===void 0?void 0:re.id)})},[O.data,n==null||(c=n.currentUser)===null||c===void 0?void 0:c.id]),_e=Object(u.useMemo)(function(){return O.data.map(function(ce){var re=ce.id,fe=ce.first_name,X=ce.last_name;return{label:"".concat(fe," ").concat(X),value:re}})},[O.data]);Object(u.useEffect)(function(){var ce,re;if(!B||!(n!=null&&(ce=n.currentUser)!==null&&ce!==void 0&&ce.id)){var fe;if((fe=O.data)!==null&&fe!==void 0&&fe[0]){var X;le((X=O.data)===null||X===void 0?void 0:X[0].id)}return}le(n==null||(re=n.currentUser)===null||re===void 0?void 0:re.id)},[n==null||(r=n.currentUser)===null||r===void 0?void 0:r.id,B]),Object(u.useEffect)(function(){b===null||N===null||(x(!0),Bt(b,N).then(function(ce){if(ce.success){var re,fe=((re=ce.data.grade_scale)!==null&&re!==void 0?re:[]).map(function(X,te){return Object(i.a)(Object(i.a)({},X),{},{id:String((te+1)*100)})});C.setFieldValue("table",fe)}}).finally(function(){x(!1)}))},[b,N]);var Ie=Object(u.useCallback)(function(){var ce=Object(m.a)(Object(g.a)().mark(function re(fe){return Object(g.a)().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(!(b===null||N===null)){te.next=2;break}return te.abrupt("return");case 2:return te.next=4,Qt(b,N,{grade_scale:fe.table});case 4:case"end":return te.stop()}},re)}));return function(re){return ce.apply(this,arguments)}}(),[N,b]);return O.loading?Object(e.jsx)(A.a,{}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(se.a.Item,{label:Object(e.jsx)(a.a,{id:"menu.Teacher"}),children:Object(e.jsx)(We.a,{disabled:B,placeholder:Object(e.jsx)(a.a,{id:"select"}),options:_e,value:N,onChange:function(re){return le(re)}})}),Object(e.jsx)(yt.a,{}),Object(e.jsx)(se.a,{form:C,onFinish:Ie,submitter:{render:function(re,fe){var X=Object($.a)(fe,2),te=X[1];return[te]}},children:Object(e.jsx)(Yt.a,{name:"table",rowKey:"id",actionRef:Y,formItemProps:{label:Object(e.jsx)(a.a,{id:"grades-scale"})},cardProps:{bodyStyle:{padding:0}},recordCreatorProps:!1,loading:ve,columns:[].concat(na,[{title:Object(e.jsx)(a.a,{id:"options"}),valueType:"option",render:function(re,fe){return Object(e.jsx)(W.a,{type:"primary",onClick:function(){var te;return(te=Y.current)===null||te===void 0?void 0:te.startEditable(fe.id)},icon:Object(e.jsx)(Xe.a,{})})}}]),editable:{form:C,type:"multiple",editableKeys:G,saveText:Object(e.jsx)(W.a,{type:"primary",icon:Object(e.jsx)(Zt.a,{})}),onChange:M,actionRender:function(re,fe,X){return[X.save]}}})})]})},La=t("qbNl"),sa=t("JBPa"),Ga=t("Awhp"),ca=t("KrTs"),ia=t("wd/R"),rt=t.n(ia),Ua=t("5R/X");function ua(o,c){return Gt.apply(this,arguments)}function Gt(){return Gt=Object(m.a)(Object(g.a)().mark(function o(c,r){return Object(g.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/schedules",Object(i.a)({params:c,method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),Gt.apply(this,arguments)}var la=function(){var c=Object(u.useState)(null),r=Object($.a)(c,2),s=r[0],n=r[1],d=Object(u.useState)([]),b=Object($.a)(d,2),O=b[0],T=b[1],y=Object(ie.b)(),C=y.semester_subject_id,P=rt()(),D=Object(u.useMemo)(function(){return O.map(function(x){return{id:x.id,title:"".concat(x.group.name," (").concat(x.term_status.name,")"),start:rt()(x.date_from).toDate(),end:rt()(x.date_to).toDate(),tutor_name:"".concat(x.tutor.first_name," ").concat(x.tutor.last_name),tutor_email:x.tutor.email,semester:x.semester.name,group:x.group.name,subject:x.subject.name}})},[O]),G=Object(u.useCallback)(function(x,V){ua({semester_subject_id:C,date_form:x.toDate(),date_to:V.toDate()}).then(function(U){U.success&&T(U.data)})},[C]),M=Object(u.useCallback)(function(x){n(x)},[]),Y=Object(u.useCallback)(function(){n(null)},[]),_=Object(u.useCallback)(function(x){return x.isSame(P,"day")?"warning":x.isAfter(P,"day")?"success":"error"},[]),w=Object(u.useCallback)(function(x){var V=D.filter(function(U){return rt()(U.start).isSame(x,"day")});return Object(e.jsx)("ul",{className:"events",children:V.map(function(U){return Object(e.jsx)("li",{onClick:function(){return M(U)},children:Object(e.jsx)(ca.a,{status:_(rt()(U.start)),text:U.title})},U.id)})})},[O]),ve=Object(u.useCallback)(function(x,V){var U=rt()(x).startOf(V).subtract(1,"month"),N=rt()(x).endOf(V).add(1,"month");G(U,N)},[]);return Object(u.useEffect)(function(){var x=rt()().startOf("month"),V=rt()().endOf("month");G(x,V)},[]),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Q.a.Title,{level:4,children:Object(e.jsx)(a.a,{id:"schedule",defaultMessage:"Schedule"})}),Object(e.jsx)(sa.a,{dateCellRender:w,onPanelChange:ve}),Object(e.jsxs)(qe.a,{open:s!==null,title:"".concat(s==null?void 0:s.subject,": ").concat(s==null?void 0:s.title),onCancel:Y,footer:null,children:[Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"tutorName",defaultMessage:"Tutor"}),": ",s==null?void 0:s.tutor_name]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"email",defaultMessage:"Email"}),": ",s==null?void 0:s.tutor_email]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"group",defaultMessage:"Group"}),": ",s==null?void 0:s.group]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"semester",defaultMessage:"Semester"}),": ",s==null?void 0:s.semester]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"started_at",defaultMessage:"Start date"}),":",s&&rt()(s.start).format(q.b)]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"end_at",defaultMessage:"End date"}),":",s&&rt()(s.end).format(q.b)]})]})]})},da=la,Ut=t("PpiC"),oa=t("Vpfc"),Fa=t("miYZ"),St=t("tsqr"),Nt=t("yj/a"),Wt=t("5Syx"),Ft=t("H6aw"),ja=t("p3I6"),ba=["attendances"],fa=["results"];function Oa(o,c){var r=Object(u.useState)({loading:!1}),s=Object($.a)(r,2),n=s[0],d=s[1];return Object(u.useEffect)(function(){d(function(b){return Object(i.a)(Object(i.a)({},b),{},{loading:!0})}),kt(o,c).then(function(b){b.success&&d(function(O){return Object(i.a)(Object(i.a)({},O),{},{data:b.data})})}).finally(function(){d(function(b){return Object(i.a)(Object(i.a)({},b),{},{loading:!1})})})},[c,o]),{finalGrades:n}}function ma(){var o=Object(u.useState)({loading:!1}),c=Object($.a)(o,2),r=c[0],s=c[1];return Object(u.useEffect)(function(){s(function(n){return Object(i.a)(Object(i.a)({},n),{},{loading:!0})}),qt().then(function(n){n.success&&s(function(d){return Object(i.a)(Object(i.a)({},d),{},{data:n.data})})}).finally(function(){s(function(n){return Object(i.a)(Object(i.a)({},n),{},{loading:!1})})})},[]),{gradeTerms:r}}function va(o){var c=Object(u.useState)({loading:!1}),r=Object($.a)(c,2),s=r[0],n=r[1];return Object(u.useEffect)(function(){o!==void 0&&(n(function(d){return Object(i.a)(Object(i.a)({},d),{},{loading:!0})}),ea(o).then(function(d){d.success&&n(function(b){return Object(i.a)(Object(i.a)({},b),{},{data:d.data})})}).finally(function(){n(function(d){return Object(i.a)(Object(i.a)({},d),{},{loading:!1})})}))},[o]),{subjectGradeScales:s}}function ha(o,c){var r=Object(u.useState)({loading:!1}),s=Object($.a)(r,2),n=s[0],d=s[1];return Object(u.useEffect)(function(){typeof o!="number"||typeof c!="number"||(d(function(b){return Object(i.a)(Object(i.a)({},b),{},{loading:!0})}),Bt(o,c).then(function(b){b.success&&d(function(O){return Object(i.a)(Object(i.a)({},O),{},{data:b.data.grade_scale})})}).finally(function(){d(function(b){return Object(i.a)(Object(i.a)({},b),{},{loading:!1})})}))},[o,c]),{tutorGradeScales:n}}function ga(o,c){var r=Object(u.useState)({loading:!1}),s=Object($.a)(r,2),n=s[0],d=s[1],b=Object(u.useCallback)(function(){d(function(T){return Object(i.a)(Object(i.a)({},T),{},{loading:!0})}),pt(o).then(function(T){if(T.success){var y=T.data.reduce(function(C,P){var D=P.attendances,G=Object(Ut.a)(P,ba),M=D.find(function(Y){return Boolean(Y.user_id)});return M?[].concat(Object(ze.a)(C),[Object(i.a)(Object(i.a)({},G),{},{attendance:M})]):C},[]);d(function(C){return Object(i.a)(Object(i.a)({},C),{},{data:y})})}}).finally(function(){d(function(T){return Object(i.a)(Object(i.a)({},T),{},{loading:!1})})})},[o,c]),O=Object(u.useCallback)(function(T,y){d(function(C){return Object(i.a)(Object(i.a)({},C),{},{loading:!0})}),$t(T,c,y).then(function(C){C.success?St.b.success(C.message):St.b.error(C.message)}).finally(function(){b(),d(function(C){return Object(i.a)(Object(i.a)({},C),{},{loading:!1})})})},[b,c]);return Object(u.useEffect)(function(){b()},[b]),{userAttendanceSchedules:n,fetchUserAttendanceSchedules:b,updateUserAttendanceSchedules:O}}function pa(o){var c=Object(u.useState)({loading:!1}),r=Object($.a)(c,2),s=r[0],n=r[1];return Object(u.useEffect)(function(){n(function(d){return Object(i.a)(Object(i.a)({},d),{},{loading:!0})}),J({student_id:o}).then(function(d){if(d.success){var b=d.data.reduce(function(O,T){var y=Object($.a)(T.results,1),C=y[0],P=Object(Ut.a)(T,fa);return C?[].concat(Object(ze.a)(O),[Object(i.a)(Object(i.a)({},P),{},{result:C})]):O},[]);n(function(O){return Object(i.a)(Object(i.a)({},O),{},{data:b})})}}).finally(function(){n(function(d){return Object(i.a)(Object(i.a)({},d),{},{loading:!1})})})},[o]),{studentExams:s}}function xa(o,c){var r=Object(u.useState)({loading:!1}),s=Object($.a)(r,2),n=s[0],d=s[1],b=Object(u.useState)({loading:!1}),O=Object($.a)(b,2),T=O[0],y=O[1],C=Object(u.useState)({loading:!1}),P=Object($.a)(C,2),D=P[0],G=P[1];return Object(u.useEffect)(function(){d(function(M){return Object(i.a)(Object(i.a)({},M),{},{loading:!0})}),Object(Ft.e)({group_id:o}).then(function(M){M.success&&d(function(Y){return Object(i.a)(Object(i.a)({},Y),{},{data:M.data})})}).finally(function(){d(function(M){return Object(i.a)(Object(i.a)({},M),{},{loading:!1})})})},[o]),Object(u.useEffect)(function(){!n.data||(G(function(M){return Object(i.a)(Object(i.a)({},M),{},{loading:!0})}),Promise.all(n.data.map(function(M){var Y=M.id;return Object(Ft.m)(Number(Y))})).then(function(M){M.forEach(function(Y){Y.success&&G(function(_){return Object(i.a)(Object(i.a)({},_),{},{data:Object(i.a)(Object(i.a)({},_.data),{},Object(gt.a)({},Number(Y.data.id),Object(ja.c)(Y.data.lessons)))})})})}).finally(function(){G(function(M){return Object(i.a)(Object(i.a)({},M),{},{loading:!1})})}),y(function(M){return Object(i.a)(Object(i.a)({},M),{},{loading:!0})}),Promise.all(n.data.map(function(M){var Y=M.id;return Object(Ft.l)(Number(Y),["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics","EscolaLms\\Reports\\Stats\\Course\\AttendanceList"]).then(function(_){if(_.success){var w,ve,x=((w=_.data["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics"])!==null&&w!==void 0?w:[]).filter(function(U){return U.id===c}),V=(ve=_.data["EscolaLms\\Reports\\Stats\\Course\\AttendanceList"])!==null&&ve!==void 0?ve:[];y(function(U){return Object(i.a)(Object(i.a)({},U),{},{data:Object(i.a)(Object(i.a)({},U.data),{},Object(gt.a)({},Number(Y),{finishedTopics:x,attendanceList:V}))})})}})})).finally(function(){return y(function(M){return Object(i.a)(Object(i.a)({},M),{},{loading:!1})})}))},[n.data,c]),{userCourses:n,userCoursesStats:T,userCoursesTopics:D}}var _a=[{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade"},{title:Object(e.jsx)(a.a,{id:"degree"}),dataIndex:"name"},{title:Object(e.jsx)(a.a,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent"}],Sa=[{title:Object(e.jsx)(a.a,{id:"date"}),dataIndex:"date_from",render:function(c,r){return Object(Ze.a)(new Date(r.date_from),q.c)}}],Ea=[{title:Object(e.jsx)(a.a,{id:"name"}),dataIndex:"title"},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",valueType:"percent"},{title:Object(e.jsx)(a.a,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",render:function(c,r){return Object(Ze.a)(new Date(r.created_at),q.c)}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"result",render:function(c,r){return"".concat(r.result.result,"%")}}],Ta=[{title:Object(e.jsx)(a.a,{id:"name"}),dataIndex:"name"},{title:Object(e.jsx)(a.a,{id:"issued_at"}),dataIndex:"grade",render:function(c,r){var s,n;return(s=r.grade)!==null&&s!==void 0&&s.grade_date?Object(Ze.a)(new Date((n=r.grade)===null||n===void 0?void 0:n.grade_date),q.c):"-"}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade",render:function(c,r){var s,n;return(s=(n=r.grade)===null||n===void 0?void 0:n.grade_name)!==null&&s!==void 0?s:"-"}}],Et=6,ya=function(c){var r,s,n=c.user_id,d=c.group_id,b=Object(ie.b)(),O=b.semester_subject_id,T=pa(n),y=T.studentExams,C=Oa(d,n),P=C.finalGrades,D=ma(),G=D.gradeTerms,M=va((r=P.data)===null||r===void 0?void 0:r.s_subject_scale_form_id),Y=M.subjectGradeScales,_=ha(O,(s=P.data)===null||s===void 0?void 0:s.tutor_id),w=_.tutorGradeScales,ve=ga(d,n),x=ve.userAttendanceSchedules,V=ve.updateUserAttendanceSchedules,U=xa(d,n),N=U.userCourses,le=U.userCoursesStats,B=U.userCoursesTopics,_e=se.a.useForm(),Ie=Object($.a)(_e,1),ce=Ie[0],re=Object(u.useMemo)(function(){var I;return((I=G.data)!==null&&I!==void 0?I:[]).map(function(Oe){var de=Oe.id,Ue=Oe.name;return{label:Ue,value:de}})},[G.data]),fe=Object(u.useMemo)(function(){var I;return((I=Y.data)!==null&&I!==void 0?I:[]).map(function(Oe){var de=Oe.name,Ue=Oe.id;return{label:de,value:Ue}})},[Y.data]),X=Object(u.useMemo)(function(){var I,Oe,de,Ue=((I=y.data)!==null&&I!==void 0?I:[]).reduce(function(at,st){var Aa=st.result,wt=st.weight;return[at[0]+Aa.result*wt,at[1]+wt]},[0,0]),Fe=Object($.a)(Ue,2),et=Fe[0],ut=Fe[1],ot=Number.isNaN(et/ut)?0:et/ut,jt=((Oe=w.data)!==null&&Oe!==void 0?Oe:[]).sort(function(at,st){return at.grade_value-st.grade_value}).reduce(function(at,st){return[].concat(Object(ze.a)(at),[Object(i.a)(Object(i.a)({},st),{},{isWeightedAverageGreater:ot>=st.grade_value})])},[]);if(jt.every(function(at){var st=at.isWeightedAverageGreater;return st})){var we;return(we=jt.at(-1))===null||we===void 0?void 0:we.name}var tt=jt.findIndex(function(at){var st=at.isWeightedAverageGreater;return!st});return tt<0?"":(de=jt[tt-1])===null||de===void 0?void 0:de.name},[y.data,w.data]),te=Object(u.useCallback)(function(){var I=Object(m.a)(Object(g.a)().mark(function Oe(de){var Ue,Fe,et,ut,ot;return Object(g.a)().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(et=de.grade_scale_id,ut=de.grade_term_id,((Ue=P.data)===null||Ue===void 0?void 0:Ue.id)!==void 0){we.next=3;break}return we.abrupt("return");case 3:if(ot=(Fe=P.data)===null||Fe===void 0?void 0:Fe.grades.find(function(tt){var at=tt.grade_term;return at.id===ut}),!ot){we.next=7;break}return aa(ot.id,{grade_scale_id:et}).then(function(tt){St.b[tt.success?"success":"error"](tt.message),a.f.push("/teacher/subjects/".concat(O,"/final-grades"))}),we.abrupt("return");case 7:ta({grade_scale_id:et,grade_term_id:ut,lesson_group_user_id:P.data.id}).then(function(tt){St.b[tt.success?"success":"error"](tt.message),a.f.push("/teacher/subjects/".concat(O,"/final-grades"))});case 8:case"end":return we.stop()}},Oe)}));return function(Oe){return I.apply(this,arguments)}}(),[P.data,O]),$e=Object(u.useMemo)(function(){var I;return((I=G.data)!==null&&I!==void 0?I:[]).map(function(Oe){var de;return Object(i.a)(Object(i.a)({},Oe),{},{grade:(de=P.data)===null||de===void 0?void 0:de.grades.find(function(Ue){var Fe=Ue.grade_term;return Fe.id===Oe.id})})})},[P.data,G.data]);return P.loading?Object(e.jsx)(A.a,{}):Object(e.jsxs)(e.Fragment,{children:[P.data&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Q.a.Text,{style:{fontSize:"16px",fontWeight:500},children:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Student",values:P.data.user})}),Object(e.jsx)(yt.a,{})]}),Object(e.jsxs)(Je.a,{gutter:[48,48],justify:"space-between",children:[Object(e.jsx)(Be.a,{span:12,children:Object(e.jsx)(ae.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.StudentPartialGrades"}),search:!1,pagination:{pageSize:Et},dataSource:y.data,loading:y.loading,columns:Ea,options:!1,cardProps:{bodyStyle:{padding:0}}})}),Object(e.jsx)(Be.a,{span:12,children:Object(e.jsx)(ae.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.FinalGrades"}),search:!1,pagination:{pageSize:Et},dataSource:$e,loading:P.loading||G.loading,columns:Ta,options:!1,cardProps:{bodyStyle:{padding:0}}})}),Object(e.jsx)(Be.a,{span:12,children:Object(e.jsx)(ae.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Attendances"}),search:!1,options:!1,pagination:{pageSize:Et},cardProps:{bodyStyle:{padding:0}},dataSource:x.data,loading:x.loading,columns:[].concat(Sa,[{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Attendance"}),dataIndex:"attendance",render:function(Oe,de){return Object(e.jsx)(Kt.a,{onChange:function(Fe){return V(de.id,Fe.target.checked?z.a.PRESENT:z.a.ABSENT)},checked:de.attendance.value===z.a.PRESENT})}}])})}),Object(e.jsx)(Be.a,{span:12,children:Object(e.jsx)(ae.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.GradesScale"}),search:!1,options:!1,pagination:{pageSize:Et},cardProps:{bodyStyle:{padding:0}},dataSource:w.data,loading:w.loading,columns:_a})}),N.loading&&!N.data||le.loading&&!le.data||B.loading&&!B.data&&Object(e.jsx)(A.a,{}),N.data&&le.data&&B.data&&N.data.map(function(I){var Oe,de,Ue,Fe,et,ut,ot,jt,we=I.id,tt=I.title;return Object(e.jsxs)(Be.a,{span:24,children:[Object(e.jsx)(Q.a.Text,{style:{fontSize:"16px",fontWeight:500},children:tt}),Object(e.jsx)(Wt.c,{topics:(Oe=(de=B.data)===null||de===void 0?void 0:de[Number(we)])!==null&&Oe!==void 0?Oe:[],stats:(Ue=(Fe=le.data)===null||Fe===void 0||(et=Fe[Number(we)])===null||et===void 0?void 0:et.finishedTopics)!==null&&Ue!==void 0?Ue:[]}),Object(e.jsx)(Wt.a,{stats:(ut=(ot=le.data)===null||ot===void 0||(jt=ot[Number(we)])===null||jt===void 0?void 0:jt.attendanceList)!==null&&ut!==void 0?ut:[]})]},we)})]}),Object(e.jsx)(se.a,{form:ce,onFinish:te,children:Object(e.jsxs)(se.a.Group,{style:{display:"flex",flexDirection:"column",paddingTop:"48px"},title:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.IssueAssessment"}),titleStyle:{flex:"unset"},align:"center",children:[Object(e.jsx)(Nt.a,{name:"grade_term_id",rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],label:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.GradeTerm"}),options:re,width:"sm",fieldProps:{loading:G.loading}}),Object(e.jsx)(Nt.a,{name:"grade_scale_id",rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],label:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.FinalGrade"}),options:fe,fieldProps:{loading:P.loading||Y.loading}}),Object(e.jsx)(se.a.Item,{children:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.ProposedGrade",values:{grade:X}})})]})})]})},Ca=["grades"],Ma=[{title:Object(e.jsx)(a.a,{id:"group"}),dataIndex:"group_id",render:function(c,r){return Object(e.jsx)(oa.a,{type:"Students",type_id:r.group_id},r.group_id)}},{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"user",render:function(c,r){return r.user.first_name}},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"user",render:function(c,r){return r.user.last_name}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grades",render:function(c,r){return Object(e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:r.grades.length?r.grades.map(function(s){var n=s.grade_name,d=s.grade_term,b=s.id;return Object(e.jsxs)(Q.a.Text,{children:[d.name,": ",n]},b)}):"-"})}}],Pa=function(){var c,r,s,n=Object(l.k)(),d=Object(u.useMemo)(function(){var V,U,N,le;return{user_id:Number.isNaN(Number((V=n.query)===null||V===void 0?void 0:V.user_id))?null:Number((U=n.query)===null||U===void 0?void 0:U.user_id),group_id:Number.isNaN(Number((N=n.query)===null||N===void 0?void 0:N.group_id))?null:Number((le=n.query)===null||le===void 0?void 0:le.group_id)}},[(c=n.query)===null||c===void 0?void 0:c.user_id,(r=n.query)===null||r===void 0?void 0:r.group_id]),b=d.user_id,O=d.group_id,T=Object(ie.b)(),y=T.teacherSubjectData,C=T.semester_subject_id,P=Object(u.useState)({loading:!1}),D=Object($.a)(P,2),G=D[0],M=D[1],Y=Object(u.useState)([Number(y==null||(s=y.groups)===null||s===void 0?void 0:s[0].id)]),_=Object($.a)(Y,2),w=_[0],ve=_[1],x=Object(u.useMemo)(function(){var V;return((V=y==null?void 0:y.groups)!==null&&V!==void 0?V:[]).map(function(U){var N=U.id,le=U.name;return{label:le,value:N}})},[y==null?void 0:y.groups]);return Object(u.useEffect)(function(){if(typeof b!="number"){if(!w.length){M({loading:!1});return}M(function(V){return Object(i.a)(Object(i.a)({},V),{},{loading:!0})}),Xt(w).then(function(V){if(V.success){var U=V.data.map(function(N){var le=N.grades,B=Object(Ut.a)(N,Ca);return Object(i.a)(Object(i.a)({},B),{},{grades:le.sort(function(_e,Ie){return new Date(Ie.grade_date).getTime()-new Date(_e.grade_date).getTime()})})});M(function(N){return Object(i.a)(Object(i.a)({},N),{},{dataSource:U})})}}).finally(function(){M(function(V){return Object(i.a)(Object(i.a)({},V),{},{loading:!1})})})}},[w,b]),b!==null&&O!==null?Object(e.jsx)(ya,{user_id:b,group_id:O}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(se.a.Item,{label:Object(e.jsx)(a.a,{id:"group"}),children:Object(e.jsx)(We.a,{allowClear:!0,mode:"multiple",options:x,value:w,onChange:function(U){return ve(U)}})}),Object(e.jsx)(yt.a,{}),Object(e.jsx)(ae.a,{rowKey:"id",search:!1,loading:G.loading,dataSource:G.dataSource,columns:[].concat(Ma,[{title:Object(e.jsx)(a.a,{id:"options"}),render:function(U,N){return[Object(e.jsx)(Le.a,{to:"/teacher/subjects/".concat(C,"/final-grades?user_id=").concat(N.user.id,"&group_id=").concat(N.group_id),children:Object(e.jsx)(Ve.a,{title:Object(e.jsx)(a.a,{id:"edit"}),children:Object(e.jsx)(W.a,{type:"primary",icon:Object(e.jsx)(Xe.a,{})})})},"edit")]}}])})]})},Da=function(c){var r,s,n=c.tab,d=Object(a.l)(),b=Object(a.m)("@@initialState"),O=b.setInitialState,T=b.initialState,y=Object(ie.b)(),C=y.teacherSubjectData,P=y.semester_subject_id,D=y.tutors,G=Object(u.useCallback)(Object(Se.a)(T==null?void 0:T.currentUser),[T==null?void 0:T.currentUser]),M=Object(u.useMemo)(function(){return!!D.data.find(function(Y){var _,w=Y.id;return w===(T==null||(_=T.currentUser)===null||_===void 0?void 0:_.id)})||G(Te.a.TeacherListGradeScale)},[]);return C?Object(e.jsx)(ue.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(a.a,{id:C==null||(r=C.subject)===null||r===void 0?void 0:r.name}),", ",Object(e.jsx)(a.a,{id:n})]}),tabBarExtraContent:Object(e.jsxs)("div",{style:{display:"flex",padding:"12px",gap:"12px"},children:[Object(e.jsx)(W.a,{type:"primary",onClick:function(){return console.log("MSTeams")},children:Object(e.jsx)(a.a,{id:"msTeams",defaultMessage:"msTeams"})}),Object(e.jsx)(Le.a,{to:"/teacher/subjects/".concat(P,"/exams?exam_id=new"),children:Object(e.jsx)(W.a,{type:"primary",children:Object(e.jsx)(a.a,{id:"uploadGrades",defaultMessage:"uploadGrades"})})})]}),header:{breadcrumb:{routes:[{path:"teacher",breadcrumbName:d.formatMessage({id:"Teacher"})},{path:"subjects",breadcrumbName:d.formatMessage({id:"Subjects"})},{path:String(P),breadcrumbName:String((s=C.subject)===null||s===void 0?void 0:s.name)},{path:String(n),breadcrumbName:d.formatMessage({id:n,defaultMessage:String(n)})}]}},children:Object(e.jsxs)(oe.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",activeKey:n,onChange:function(_){O(Object(i.a)({},T)),a.f.push("/teacher/subjects/".concat(P,"/").concat(_))}},children:[Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"groups"}),children:Object(e.jsx)(Re.b,{})},"groups"),Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"students"}),children:Object(e.jsx)(ht,{})},"students"),Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"exams"}),children:Object(e.jsx)(je,{})},"exams"),Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"schedule"}),children:Object(e.jsx)(da,{})},"schedule"),Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"attendance"}),children:Object(e.jsx)(zt,{})},"attendance"),M&&Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"grades-scale"}),children:Object(e.jsx)(ra,{})},"grades-scale"),Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"final-grades"}),children:Object(e.jsx)(Pa,{})},"final-grades")]})}):Object(e.jsx)(A.a,{})},$a=me.default=function(){var o=Object(l.l)(),c=o.subjectId,r=o.tab,s=r===void 0?"groups":r;return Object(e.jsx)(ie.a,{semester_subject_id:Number(c),children:Object(e.jsx)(Da,{tab:s})})}},p3I6:function(Ke,me,t){"use strict";t.d(me,"b",function(){return ie}),t.d(me,"c",function(){return he}),t.d(me,"a",function(){return lt});var i=t("miYZ"),H=t("tsqr"),W=t("tJVT"),f=t("k1fw"),A=t("oBTY"),u=t("q1tI"),oe=t.n(u),a=t("9kvl"),Le=t("Ty5D"),l=t("H6aw"),ue=t("/y+f"),Te=t("nKUr"),Se=t.n(Te),ie=oe.a.createContext({}),Re=function(){return Math.round(Math.random()*99999)},ct=function ae(q){return q.reduce(function(J,v){return[].concat(Object(A.a)(J),Object(A.a)(v.lessons?ae(v.lessons):[]),[v])},[])},he=function ae(q){return q.reduce(function(J,v){var Z;return[].concat(Object(A.a)(J),Object(A.a)(v.lessons?ae(v.lessons):[]),Object(A.a)((Z=v.topics)!==null&&Z!==void 0?Z:[]))},[])},Qe=function ae(q,J,v){return q.map(function(Z){var ge,S;return Object(f.a)(Object(f.a)({},Z),{},{lessons:Z.lessons?ae(Z.lessons,J,v):[],topics:Z.id===J?[].concat(Object(A.a)((ge=Z.topics)!==null&&ge!==void 0?ge:[]),[v]):(S=Z.topics)!==null&&S!==void 0?S:[]})})},Ve=function ae(q,J,v){return q.map(function(Z){var ge,S,j;return Object(f.a)(Object(f.a)({},Z),{},{lessons:ae((ge=Z.lessons)!==null&&ge!==void 0?ge:[],J,v),topics:(S=(j=Z.topics)===null||j===void 0?void 0:j.map(function(pe){return pe.id===J?v:pe}))!==null&&S!==void 0?S:[]})})},g=function ae(q,J,v){return v?q.map(function(Z){return Object(f.a)(Object(f.a)({},Z),{},{lessons:[].concat(Object(A.a)(Z.lessons?ae(Z.lessons,J,v):[]),Object(A.a)(Z.id===v?[J]:[]))})}):[].concat(Object(A.a)(q),[J])},m=function ae(q,J,v){return q.map(function(Z){return Object(f.a)(Object(f.a)({},Z.id===J?v:Z),{},{lessons:Z.lessons?ae(Z.lessons,J,v):[]})})},Ze=function ae(q,J){return q.map(function(v){return Object(f.a)(Object(f.a)({},v),{},{parent_id:J,lessons:v.lessons?ae(v.lessons,v.id):[]})})},Xe=function ae(q,J){return q.filter(function(v){return v.id!==J}).map(function(v){return Object(f.a)(Object(f.a)({},v),{},{lessons:v.lessons?ae(v.lessons,J):[]})})},Ne=function ae(q,J){return q.map(function(v){return Object(f.a)(Object(f.a)({},v),{},{lessons:v.lessons?ae(v.lessons,J):[],topics:v.topics?v.topics.filter(function(Z){return Z.id!==J}):[]})})},lt=function(q){var J=q.children,v=q.id,Z=Object(u.useState)(),ge=Object(W.a)(Z,2),S=ge[0],j=ge[1],pe=Object(a.l)(),ye=Object(u.useMemo)(function(){return S&&S.lessons?he(S.lessons):[]},[S]),Ce=Object(u.useMemo)(function(){return S&&S.lessons?ct(S.lessons):[]},[S]),Ee=Object(u.useState)([]),Ge=Object(W.a)(Ee,2),Me=Ge[0],He=Ge[1],R=Object(Le.k)();Object(u.useEffect)(function(){He([])},[]);var k=Object(u.useCallback)(function(){Object(l.m)(v).then(function(e){return e.success&&j(Object(f.a)(Object(f.a)({},e.data),{},{lessons:Ze(e.data.lessons)}))})},[v]);Object(u.useEffect)(function(){k()},[k]);var xe=Object(u.useCallback)(function(e){var L=Ce.find(function(E){var h;return E==null||(h=E.topics)===null||h===void 0?void 0:h.find(function(p){return p.id===e})});return L?L.id:null},[Ce]),$=Object(u.useMemo)(function(){var e,L;return(e=R.query)!==null&&e!==void 0&&e.lesson?{mode:"lesson",id:Number(R.query.lesson),value:Ce.find(function(E){return E.id===Number(R.query.lesson)})}:(L=R.query)!==null&&L!==void 0&&L.topic?{mode:"topic",id:Number(R.query.topic),value:ye.find(function(E){return E.id===Number(R.query.topic)})}:{mode:"init"}},[R.query,S,Ce,ye]),dt=Object(u.useCallback)(function(e){var L={course_id:v,topics:[],isNew:!0,id:S?S.lessons.length+1:Re(),order:0,title:pe.formatMessage({id:"add_title_here"}),active:!0,parent_id:e};return j(function(E){var h;return Object(f.a)(Object(f.a)({},E),{},{lessons:g((h=E==null?void 0:E.lessons)!==null&&h!==void 0?h:[],L,e)})}),L},[v,S]),Je=Object(u.useCallback)(function(e,L){var E=Ce.find(function(p){return p.id===e}),h=E&&E.isNew;return(h?Object(l.g)(L):Object(l.u)(e,L)).then(function(p){return H.b.success(p.message),k(),p.success&&j(function(F){var K;return Object(f.a)(Object(f.a)({},F),{},{lessons:m((K=F==null?void 0:F.lessons)!==null&&K!==void 0?K:[],e,Object(f.a)(Object(f.a)({},p.data),{},{isNew:!1}))})})})},[S]),ke=Object(u.useCallback)(function(e){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,E=(S==null?void 0:S.lessons.findIndex(function(K){return K.id===e}))||0,h=L?E-1:E+1,p=S==null?void 0:S.lessons.map(function(K,Pe,it){var Ye=Pe==E?it[h]:Pe==h?it[E]:K;return Object(f.a)(Object(f.a)({},Ye),{},{order:Pe})});j(function(K){return Object(f.a)(Object(f.a)({},K),{},{lessons:p||[]})});var F=p==null?void 0:p.filter(function(K){return!K.isNew}).map(function(K){return[K.id,K.order]});Object(l.s)({class:"Lesson",orders:F,course_id:v}).then(function(K){K.success&&H.b.success(K.message)})},[S,v]),Be=Object(u.useCallback)(function(e,L){var E,h,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,F=Ce.find(function(Ye){return Ye.id===e}),K=F==null||(E=F.topics)===null||E===void 0?void 0:E.findIndex(function(Ye){return Ye.id===L});if(!(K===void 0||K===-1)){var Pe=p?K-1:K+1,it=(F==null||(h=F.topics)===null||h===void 0?void 0:h.map(function(Ye,je,ee){var ne=je==K?ee[Pe]:je==Pe?ee[K]:Ye;return Object(f.a)(Object(f.a)({},ne),{},{order:je})}))||[];j(function(Ye){return Object(f.a)(Object(f.a)({},Ye),{},{lessons:Ye?Ye.lessons.map(function(je){return je.id===e?Object(f.a)(Object(f.a)({},je),{},{topics:it}):je}):[]})})}},[S]),se=Object(u.useCallback)(function(e){var L,E=Ce.find(function(p){return p.id===e}),h=E==null||(L=E.topics)===null||L===void 0?void 0:L.filter(function(p){return!p.isNew}).map(function(p){return[p.id,p.order]});Object(l.s)({class:"Topic",orders:h,course_id:v}).then(function(p){p.success&&H.b.success(p.message)})},[S,v]),Ot=Object(u.useCallback)(function(e,L){j(function(h){return Object(f.a)(Object(f.a)({},h),{},{lessons:h?h.lessons.map(function(p){return p.id===e?Object(f.a)(Object(f.a)({},p),{},{topics:L}):p}):[]})});var E=L.map(function(h){return[h.id,h.order]});Object(l.s)({class:"Topic",orders:E,course_id:v}).then(function(h){h.success&&H.b.success(h.message)})},[S]),ft=Object(u.useCallback)(function(e){var L=Ce.find(function(h){return h.id===e});if(!!L){var E=L.isNew;E?j(function(h){var p;return Object(f.a)(Object(f.a)({},h),{},{lessons:Xe((p=h==null?void 0:h.lessons)!==null&&p!==void 0?p:[],e)})}):Object(l.o)(e).then(function(h){h.success&&(H.b.success(h.message),j(function(p){var F;return Object(f.a)(Object(f.a)({},p),{},{lessons:Xe((F=p==null?void 0:p.lessons)!==null&&F!==void 0?F:[],e)})}))})}},[S]),z=Object(u.useCallback)(function(e,L){var E,h=xe(e),p=Ce.find(function(Pe){return Pe.id===h}),F=p&&((E=p.topics)===null||E===void 0?void 0:E.find(function(Pe){return Pe.id===e})),K=F==null?void 0:F.isNew;return(K?Object(l.h)(L):Object(l.v)(e,L)).then(function(Pe){Pe.success&&(H.b.success(Pe.message),k(),a.f.push("/courses/list/".concat(v,"/program/?topic=").concat(Pe.data.id)),(F==null?void 0:F.topicable_type)===ue.f.Video&&setTimeout(function(){k()},5e3))})},[xe,S,k]),_t=Object(u.useCallback)(function(e){var L=xe(e),E=Ce.find(function(F){return F.id===L});if(!!E){var h=ye==null?void 0:ye.find(function(F){return F.id===e}),p=h==null?void 0:h.isNew;p&&!h.topicable?j(function(F){var K;return Object(f.a)(Object(f.a)({},F),{},{lessons:Ne((K=F==null?void 0:F.lessons)!==null&&K!==void 0?K:[],e)})}):Object(l.p)(e).then(function(F){F.success&&(H.b.success(F.message),j(function(K){var Pe;return Object(f.a)(Object(f.a)({},K),{},{lessons:Ne((Pe=K==null?void 0:K.lessons)!==null&&Pe!==void 0?Pe:[],e)})}))})}},[S,xe]),qe=Object(u.useCallback)(function(e,L){var E={lesson_id:e,isNew:!0,id:Re(),title:pe.formatMessage({id:"add_title_here"}),active:!0,topicable_type:L};return j(function(h){var p;return Object(f.a)(Object(f.a)({},h),{},{lessons:Qe((p=h==null?void 0:h.lessons)!==null&&p!==void 0?p:[],e,E)})}),E},[]),mt=function(L,E){j(function(h){var p;return Object(f.a)(Object(f.a)({},h),{},{lessons:Ve((p=h==null?void 0:h.lessons)!==null&&p!==void 0?p:[],L,E.file.response.data)})}),a.f.push("/courses/list/".concat(v,"/program/?topic=").concat(E.file.response.data.id))},We=Object(u.useCallback)(function(e){return Object(l.d)(e).then(function(L){if(L.success){H.b.success(L.message);var E=xe(e);j(function(h){var p;return Object(f.a)(Object(f.a)({},h),{},{lessons:h?(p=h.lessons)===null||p===void 0?void 0:p.map(function(F){if(F.id===E){var K=F.topics||[];return Object(f.a)(Object(f.a)({},F),{},{topics:[].concat(Object(A.a)(K),[L.data])})}return F}):[]})})}})},[S,xe]),ze=Object(u.useCallback)(function(e){return Object(l.c)(e).then(function(L){L.success&&(H.b.success(L.message),j(function(E){return Object(f.a)(Object(f.a)({},E),{},{lessons:E?[].concat(Object(A.a)(E.lessons),[L.data]):[]})}))})},[]),bt={state:S,h5ps:Me,id:v,addNewLesson:dt,updateLesson:Je,updateTopic:z,deleteLesson:ft,sortLesson:ke,addNewTopic:qe,deleteTopic:_t,sortTopic:Be,sortTopics:Ot,updateTopicsOrder:se,onTopicUploaded:mt,cloneTopic:We,cloneLesson:ze,currentEditMode:$,getLessons:k};return Object(Te.jsx)(ie.Provider,{value:bt,children:J})}},quyA:function(Ke,me){var t="\\ud800-\\udfff",i="\\u0300-\\u036f",H="\\ufe20-\\ufe2f",W="\\u20d0-\\u20ff",f=i+H+W,A="\\ufe0e\\ufe0f",u="\\u200d",oe=RegExp("["+u+t+f+A+"]");function a(Le){return oe.test(Le)}Ke.exports=a},wy8a:function(Ke,me,t){var i=t("KxBF");function H(W,f,A){var u=W.length;return A=A===void 0?u:A,!f&&A>=u?W:i(W,f,A)}Ke.exports=H}}]);
