(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{"DBJ/":function(Y,v,e){"use strict";var O=e("k1fw"),M=e("y8nQ"),T=e("Vl3Y"),g=e("etVw"),G=e("9kvl"),x=e("qFDU"),S=e("nKUr"),A=e.n(S);function P(d){var F=d.onChange,U=d.onUpload,L=d.url,m=d.name,c=d.extra,u=d.accept,f=d.data,r=d.wrapInForm,a=r===void 0?!0:r,y=d.title,H=d.formProps,z=Object(G.j)();return f&&f[m]&&delete f[m],Object(S.jsx)(x.a,{condition:a,wrap:function(R){return Object(S.jsx)(T.a,Object(O.a)(Object(O.a)({},H),{},{children:R}))},children:Object(S.jsx)(g.a,{title:y||" ".concat(z.formatMessage({id:"upload_click_here"})),placeholder:z.formatMessage({id:"upload_click_here"}),onChange:function(R){F&&F(R),R.file.status==="done"&&U&&U(R.file.response)},label:Object(S.jsx)(G.a,{id:"upload"}),max:2,fieldProps:{data:f,accept:u,name:m,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}},action:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com").concat(L),extra:c})})}v.a=P},"G/Ub":function(Y,v,e){"use strict";e.d(v,"d",function(){return G}),e.d(v,"a",function(){return S}),e.d(v,"b",function(){return P}),e.d(v,"c",function(){return F}),e.d(v,"e",function(){return L});var O=e("qLMh"),M=e("k1fw"),T=e("9og8"),g=e("9kvl");function G(c){return x.apply(this,arguments)}function x(){return x=Object(T.a)(Object(O.a)().mark(function c(u){return Object(O.a)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Object(g.g)("/api/admin/roles",Object(M.a)({method:"GET",useCache:!1},u||{})));case 1:case"end":return r.stop()}},c)})),x.apply(this,arguments)}function S(c,u){return A.apply(this,arguments)}function A(){return A=Object(T.a)(Object(O.a)().mark(function c(u,f){return Object(O.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(g.g)("/api/admin/roles",Object(M.a)({method:"POST",headers:{"Content-Type":"application/json"},data:u},f||{})));case 1:case"end":return a.stop()}},c)})),A.apply(this,arguments)}function P(c,u){return d.apply(this,arguments)}function d(){return d=Object(T.a)(Object(O.a)().mark(function c(u,f){return Object(O.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(g.g)("/api/admin/roles/".concat(u),Object(M.a)({method:"DELETE",headers:{"Content-Type":"application/json"}},f||{})));case 1:case"end":return a.stop()}},c)})),d.apply(this,arguments)}function F(c,u){return U.apply(this,arguments)}function U(){return U=Object(T.a)(Object(O.a)().mark(function c(u,f){return Object(O.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(g.g)("/api/admin/roles/".concat(u),Object(M.a)({method:"GET",useCache:!1},f||{})));case 1:case"end":return a.stop()}},c)})),U.apply(this,arguments)}function L(c,u,f){return m.apply(this,arguments)}function m(){return m=Object(T.a)(Object(O.a)().mark(function c(u,f,r){return Object(O.a)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",Object(g.g)("/api/admin/roles/".concat(u),Object(M.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:f},r||{})));case 1:case"end":return y.stop()}},c)})),m.apply(this,arguments)}},n6PA:function(Y,v,e){},u7Dd:function(Y,v,e){"use strict";e.r(v),e.d(v,"TableColumns",function(){return te});var O=e("P2fV"),M=e("NJEC"),T=e("5Dmo"),g=e("3S7+"),G=e("+L6B"),x=e("2/Rp"),S=e("miYZ"),A=e("tsqr"),P=e("tJVT"),d=e("k1fw"),F=e("PpiC"),U=e("+BJd"),L=e("mr32"),m=e("qLMh"),c=e("9og8"),u=e("4KAj"),f=e("xvlK"),r=e("q1tI"),a=e("9kvl"),y=e("55Ip"),H=e("tMyG"),z=e("Qiat"),N=e("sWYD"),R=e("VK58");function ae(b,l){return Z.apply(this,arguments)}function Z(){return Z=Object(c.a)(Object(m.a)().mark(function b(l,n){return Object(m.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(a.g)("/api/admin/csv/users",Object(d.a)({params:Object(d.a)(Object(d.a)({},l),{},{per_page:l&&l.pageSize,page:l&&l.current}),method:"GET",headers:{accept:"application/csv"},useCache:!1},n||{})));case 1:case"end":return j.stop()}},b)})),Z.apply(this,arguments)}var re=e("G3dp"),ne=e("/MfK"),se=e("mGZj"),le=e("DBJ/"),fe=e("OaEy"),ee=e("2fM7"),he=e("T2oS"),ie=e("W9HT"),ce=e("G/Ub"),t=e("nKUr"),de=function(l){var n=l.value,C=l.onChange,j=l.multiple,w=j===void 0?!1:j,_=Object(r.useState)(),J=Object(P.a)(_,2),K=J[0],k=J[1],V=Object(r.useState)(!1),Q=Object(P.a)(V,2),B=Q[0],i=Q[1],o=Object(r.useRef)(),h=Object(r.useRef)(),E=Object(r.useCallback)(function(p){k(p)},[]);Object(r.useEffect)(function(){o.current=K},[K]);var s=Object(r.useCallback)(function(p){i(!0),h.current&&h.current.abort(),h.current=new AbortController,Object(ce.d)({search:p}).then(function(W){W.success&&E(W.data),i(!1)}).catch(function(){return i(!1)})},[E]),I=Object(r.useCallback)(function(p){s(p)},[s]);return Object(t.jsx)(ee.a,{onFocus:function(){return s()},allowClear:!0,style:{width:"100%"},value:n,onChange:C,mode:w?"multiple":void 0,showSearch:!0,onSearch:I,placeholder:Object(t.jsx)(a.a,{id:"select_user_role",defaultMessage:"Select role"}),optionFilterProp:"children",filterOption:function(W,D){if(D&&D.children){var $;return(D==null||($=D.children)===null||$===void 0?void 0:$.toString().toLowerCase().indexOf(W.toLowerCase()))>=0}return!0},notFoundContent:B?Object(t.jsx)(ie.a,{size:"small"}):null,children:K&&K.map(function(p){return Object(t.jsx)(ee.a.Option,{value:p.name,children:p.name},p.id)})})},oe=de,X=e("nhC9"),Oe=e("n6PA"),ue=["type","defaultRender"],je=function(){var b=Object(c.a)(Object(m.a)().mark(function l(n){return Object(m.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,Object(R.c)(n);case 2:return j.abrupt("return",!0);case 3:case"end":return j.stop()}},l)}));return function(n){return b.apply(this,arguments)}}(),te=[{title:Object(t.jsx)(a.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"created_at",defaultMessage:"created_at"}),dataIndex:"created_at",hideInSearch:!0,render:function(l,n){return n.created_at&&Object(N.a)(new Date(n.created_at),se.a)}},{title:Object(t.jsx)(a.a,{id:"first_name",defaultMessage:"first_name"}),dataIndex:"first_name",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"last_name",defaultMessage:"last_name"}),dataIndex:"last_name",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"email",defaultMessage:"email"}),dataIndex:"email",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"search",defaultMessage:"search"}),dataIndex:"search",hideInSearch:!1,hideInTable:!0,hideInDescriptions:!0,tooltip:Object(t.jsx)(a.a,{id:"search_tooltip_1"})},{title:Object(t.jsx)(a.a,{id:"is_active"}),dataIndex:"is_active",hideInSearch:!0,render:function(l,n){return[Object(t.jsx)(L.a,{color:n.is_active?"green":"red",children:n.is_active?Object(t.jsx)(a.a,{id:"Active"}):Object(t.jsx)(a.a,{id:"Inactive"})},"is_active")]}},{title:Object(t.jsx)(a.a,{id:"email_verified",defaultMessage:"email_verified"}),dataIndex:"email_verified",hideInSearch:!0,render:function(l,n){return[Object(t.jsx)(L.a,{color:n.email_verified?"green":"red",children:n.email_verified?Object(t.jsx)(a.a,{id:"verified"}):Object(t.jsx)(a.a,{id:"unverified"})},"email_verified")]}},{title:Object(t.jsx)(a.a,{id:"created_after",defaultMessage:"Created After"}),key:"from",dataIndex:"from",valueType:"date",hideInTable:!0,hideInDescriptions:!0},{title:Object(t.jsx)(a.a,{id:"created_before",defaultMessage:"Created Before"}),key:"to",dataIndex:"to",valueType:"date",hideInTable:!0,hideInDescriptions:!0},{title:Object(t.jsx)(a.a,{id:"gt_last_login_day",defaultMessage:">= Login last n days"}),key:"gt_last_login_day",dataIndex:"gt_last_login_day",valueType:"digit",hideInTable:!0,hideInDescriptions:!0},{title:Object(t.jsx)(a.a,{id:"lt_last_login_day",defaultMessage:"<= Login last n days"}),key:"lt_last_login_day",dataIndex:"lt_last_login_day",valueType:"digit",hideInTable:!0,hideInDescriptions:!0},{title:Object(t.jsx)(a.a,{id:"roles",defaultMessage:"roles"}),dataIndex:"roles",hideInSearch:!0,render:function(l,n){return n.roles.map(function(C){return Object(t.jsx)(L.a,{children:C},C)})}},{hideInSearch:!1,title:Object(t.jsx)(a.a,{id:"role",defaultMessage:"role"}),dataIndex:"role",renderFormItem:function(l,n){var C=n.type,j=n.defaultRender,w=Object(F.a)(n,ue);return Object(t.jsx)(oe,Object(d.a)({},w))}}],me=function(){var l=Object(r.useRef)(),n=Object(a.j)(),C=Object(r.useState)({}),j=Object(P.a)(C,2),w=j[0],_=j[1],J=Object(r.useState)(!1),K=Object(P.a)(J,2),k=K[0],V=K[1],Q=Object(r.useCallback)(Object(c.a)(Object(m.a)().mark(function B(){var i,o,h;return Object(m.a)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return V(!0),s.prev=1,s.next=4,ae(w);case 4:i=s.sent,i&&(o="data:text/csv;charset=utf-8,"+i,h=document.createElement("a"),h.href=o,h.download="users.csv",document.body.appendChild(h),h.click(),document.body.removeChild(h)),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(1),console.error(s.t0);case 11:return s.prev=11,V(!1),s.finish(11);case 14:case"end":return s.stop()}},B,null,[[1,8,11,14]])})),[w]);return Object(t.jsx)(H.a,{children:Object(t.jsxs)(X.a,{tabs:{type:"card",activeKey:"list",onChange:function(i){switch(i){case"list":return a.e.push("/users");case"fields":return a.e.push("/users/fields");default:return a.e.push("/users/".concat(i))}}},children:[Object(t.jsx)(X.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"list"}),children:Object(t.jsx)(z.a,{headerTitle:n.formatMessage({id:"menu.Users",defaultMessage:"users"}),actionRef:l,rowKey:"key",search:{},toolBarRender:function(){return[Object(t.jsx)(le.a,{title:n.formatMessage({id:"import_users"}),url:"/api/admin/csv/users",name:"file",accept:".csv",data:{return_url:"".concat(window.location.origin,"/#/user/reset-password")},onChange:function(o){o.file.status==="done"&&o.file.response&&o.file.response.success&&A.b.success(o.file.response.message),o.file.response&&o.file.status==="error"&&(A.b.error(o.file.response.message),console.error(o.file.response))}},"upload"),Object(t.jsxs)(x.a,{loading:k,type:"primary",onClick:function(){return Q()},children:[Object(t.jsx)(u.a,{})," ",Object(t.jsx)(a.a,{id:"export",defaultMessage:"export"})]},"primary"),Object(t.jsx)(y.a,{to:"/users/list/new",children:Object(t.jsxs)(x.a,{type:"primary",children:[Object(t.jsx)(f.a,{})," ",Object(t.jsx)(a.a,{id:"new",defaultMessage:"new"})]},"primary")},"link")]},request:function(i){var o=i.pageSize,h=i.current,E=i.search,s=i.role,I=i.from,p=i.to,W=i.gt_last_login_day,D=i.lt_last_login_day;_({pageSize:o,current:h,search:E,role:s,from:I,to:p,gt_last_login_day:W,lt_last_login_day:D});var $=s&&s.toString()==="all"?void 0:s;return Object(R.n)({pageSize:o,current:h,search:E,role:$,from:I,to:p,gt_last_login_day:W,lt_last_login_day:D}).then(function(q){return q.success?{data:q.data,total:q.meta.total,success:!0}:[]})},columns:[].concat(te,[{hideInSearch:!0,title:Object(t.jsx)(a.a,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(i,o){return[Object(t.jsx)(y.a,{to:"/users/".concat(o.id,"/user_info"),children:Object(t.jsx)(g.a,{title:Object(t.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(t.jsx)(x.a,{type:"primary",icon:Object(t.jsx)(re.a,{})})})},"edit"),Object(t.jsx)(M.a,{title:Object(t.jsx)(a.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(c.a)(Object(m.a)().mark(function h(){var E;return Object(m.a)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,je(o.id);case 2:E=I.sent,E&&l.current&&l.current.reload();case 4:case"end":return I.stop()}},h)})),okText:Object(t.jsx)(a.a,{id:"yes"}),cancelText:Object(t.jsx)(a.a,{id:"no"}),children:Object(t.jsx)(g.a,{title:Object(t.jsx)(a.a,{id:"delete",defaultMessage:"delete"}),children:Object(t.jsx)(x.a,{type:"primary",icon:Object(t.jsx)(ne.a,{}),danger:!0})})},"delete")]}}])})},"list"),Object(t.jsx)(X.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"ModelFields"})},"fields")]})})},pe=v.default=me}}]);
