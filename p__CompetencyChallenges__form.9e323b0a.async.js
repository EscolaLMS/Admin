(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"60mZ":function(Xe,K,e){},EKp7:function(Xe,K,e){"use strict";e.r(K);var C=e("T2oS"),ee=e("W9HT"),O=e("q1tI"),c=e("9kvl"),me=e("Ty5D"),xe=e("tMyG"),Ee=e("nhC9"),V=e("tKSU"),F=e("qLMh"),Le=e("miYZ"),te=e("tsqr"),R=e("9og8"),J=e("k1fw"),S=e("PpiC"),g=e("tJVT"),m=e("VMEa"),h=e("Qurx"),i=e("yj/a"),ae=e("F/zT"),Y=e("BiO0"),p=e("CEpB"),b=e("0WSk"),E=e("Gn8c"),_=e("hd5d"),d=e("YRX9"),re=e("/y+f"),r=e("nKUr"),Q=["authors","category"],fe=Object.values(re.b).map(function(je){return{value:je,label:Object(r.jsx)(c.a,{id:"CompetencyChallenges.types.".concat(je)})}}),Ue=function(){var w=Object(V.b)(),j=w.competencyChallenge,X=w.categoryDepths,P=w.refreshData,Z=Object(me.l)(),B=Number(Z.id),se=Object(c.l)(),he=m.a.useForm(),De=Object(g.a)(he,1),k=De[0],pe=m.a.useWatch("type",k),Pe=Number.isNaN(B),ye=Object(O.useMemo)(function(){if(!(j!=null&&j.data))return{};var T=j==null?void 0:j.data,$=T.authors,be=T.category,G=Object(S.a)(T,Q);return Object(J.a)(Object(J.a)({},G),{},{authors:$.map(function(W){var N=W.id;return N}),category_id:be==null?void 0:be.id})},[j==null?void 0:j.data]),ve=Object(O.useCallback)(function(){var T=Object(R.a)(Object(F.a)().mark(function $(be){var G,W,N,ie,z,M,Ie,Ce;return Object(F.a)().wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return G=be.name,W=be.type,N=be.is_active,ie=N===void 0?!1:N,z=be.is_highlighted,M=z===void 0?!1:z,Ie=be.category_id,q.prev=1,q.next=4,Object(d.a)({name:G,is_active:ie,is_highlighted:M,type:W,category_id:Ie});case 4:if(Ce=q.sent,Ce.success){q.next=8;break}return te.b.error(Ce.message),q.abrupt("return");case 8:return te.b.success(se.formatMessage({id:Ce.message})),c.f.push("/competency-challenges/".concat(Ce.data.id,"/main")),q.next=12,P();case 12:q.next=17;break;case 14:q.prev=14,q.t0=q.catch(1),te.b.error(se.formatMessage({id:"error"}));case 17:case"end":return q.stop()}},$,null,[[1,14]])}));return function($){return T.apply(this,arguments)}}(),[]),Be=Object(O.useCallback)(function(){var T=Object(R.a)(Object(F.a)().mark(function $(be){var G,W,N,ie;return Object(F.a)().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.prev=0,G=k.getFieldsValue(["image_url","image_path"]),W=G.image_url,N=G.image_path,M.next=4,Object(d.g)(B,Object(J.a)(Object(J.a)({},be),{},{image_url:W,image_path:N}));case 4:if(ie=M.sent,ie.success){M.next=8;break}return te.b.error(ie.message),M.abrupt("return");case 8:return te.b.success(se.formatMessage({id:ie.message})),M.next=11,P();case 11:M.next=16;break;case 13:M.prev=13,M.t0=M.catch(0),te.b.error(se.formatMessage({id:"error"}));case 16:case"end":return M.stop()}},$,null,[[0,13]])}));return function($){return T.apply(this,arguments)}}(),[B]);return Object(r.jsxs)(m.a,{form:k,initialValues:ye,onFinish:Pe?ve:Be,onValuesChange:function($){($==null?void 0:$.type)==="complex"&&k.setFieldValue("category",null)},children:[Object(r.jsxs)(m.a.Group,{title:Object(r.jsx)(c.a,{id:"CompetencyChallenges.base"}),children:[Object(r.jsx)(h.a,{width:"md",name:"name",label:Object(r.jsx)(c.a,{id:"name"}),placeholder:se.formatMessage({id:"name"}),required:!0,rules:[{required:!0,message:se.formatMessage({id:"field_required"})}]}),Object(r.jsx)(i.a,{width:"md",name:"type",label:Object(r.jsx)(c.a,{id:"type"}),options:fe,required:!0,rules:[{required:!0,message:se.formatMessage({id:"field_required"})}]}),pe==="simple"&&Object(r.jsx)(m.a.Item,{name:"category_id",required:!0,label:Object(r.jsx)(c.a,{id:"category"}),rules:[{required:!0,message:se.formatMessage({id:"field_required"})}],children:Object(r.jsx)(p.a,{enabledDepth:X.role})}),Object(r.jsx)(ae.a,{name:"is_active",label:Object(r.jsx)(c.a,{id:"is_active"})}),Object(r.jsx)(ae.a,{name:"is_highlighted",label:Object(r.jsx)(c.a,{id:"is_highlighted"}),tooltip:Object(r.jsx)(c.a,{id:"CompetencyChallenges.highlighted"})})]}),!Pe&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(m.a.Group,{title:Object(r.jsx)(c.a,{id:"CompetencyChallenges.additional"}),children:[Object(r.jsx)(m.a.Item,{name:"description",label:Object(r.jsx)(c.a,{id:"description"}),valuePropName:"value",style:{width:440},children:Object(r.jsx)(_.a,{directory:"competency-challenges/".concat(B)})}),Object(r.jsx)(Y.a,{width:"lg",name:"summary",label:Object(r.jsx)(c.a,{id:"summary"})}),Object(r.jsx)(m.a.Item,{name:"authors",label:Object(r.jsx)(c.a,{id:"author"}),style:{width:"100%",maxWidth:440},children:Object(r.jsx)(b.a,{multiple:!0})})]}),Object(r.jsx)(E.a,{wrapInForm:!1,folder:"/competency-challenges/".concat(B),title:"image",action:"/api/admin/competency-challenges/".concat(B,"?_method=PATCH"),src_name:"image_url",form_name:"image",getUploadedSrcField:function($){return $.file.response.data.image_url},setPath:function($){return k.setFieldsValue($)}})]})]})},Ke=e("P2fV"),t=e("NJEC"),Me=e("5Dmo"),we=e("3S7+"),x=e("+L6B"),ne=e("2/Rp"),Qe=e("G3dp"),Te=e("/MfK"),I=e("Hn4i"),_e=e("enqX"),at=["scale_min","category_id"],Ze=[{title:Object(r.jsx)(c.a,{id:"ID"}),dataIndex:"id",editable:!1,render:function(w,j){if(typeof j.id!="string")return"-";var X=j.id.split("-"),P=Object(g.a)(X,2),Z=P[0],B=P[1];return Z==="new"?"-":B}},{title:Object(r.jsx)(c.a,{id:"min_points"}),dataIndex:"scale_min",valueType:"digit",formItemProps:{rules:[{required:!0,message:Object(r.jsx)(c.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(r.jsx)(c.a,{id:"number_between",values:{min:0}})}]},fieldProps:{min:0}},{title:Object(r.jsx)(c.a,{id:"category"}),dataIndex:"category_id",render:function(w,j){return j.category_name},formItemProps:{rules:[{required:!0,message:Object(r.jsx)(c.a,{id:"field_required"})}]},renderFormItem:function(w,j,X){var P,Z=((P=X.getFieldValue("table"))!==null&&P!==void 0?P:[]).map(function(B){return B.category_id});return Object(r.jsx)(_e.a,{disabledNodes:Z})}}],Ge=function(w){return w.map(function(j){var X=j.id,P=j.scale_min,Z=j.category;return{id:"old-".concat(X),scale_min:P,category_id:Z.id,category_name:Z.name_with_breadcrumbs}})},ge=function(){var w,j,X=Object(V.b)(),P=X.competencyChallenge,Z=X.refreshData,B=Object(me.l)(),se=Number(B.id),he=(w=P==null||(j=P.data)===null||j===void 0?void 0:j.scales)!==null&&w!==void 0?w:[],De=Object(O.useState)([]),k=Object(g.a)(De,2),pe=k[0],Pe=k[1],ye=Object(c.l)(),ve=Object(O.useRef)(),Be=Object(O.useRef)(),T=Object(O.useRef)(),$=Object(O.useMemo)(function(){return Ge(he)},[he]),be=Object(O.useMemo)(function(){return[].concat(Ze,[{valueType:"option",title:Object(r.jsx)(c.a,{id:"options"}),render:function(W,N,ie,z){return[Object(r.jsx)(we.a,{title:Object(r.jsx)(c.a,{id:"edit",defaultMessage:"edit"}),children:Object(r.jsx)(ne.a,{type:"primary",icon:Object(r.jsx)(Qe.a,{}),onClick:function(){return z==null?void 0:z.startEditable(N.id)}})},"edit"),Object(r.jsx)(t.a,{title:Object(r.jsx)(c.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(R.a)(Object(F.a)().mark(function M(){var Ie,Ce,Je,q,Ye,u,a,s;return Object(F.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(typeof N.id=="string"){n.next=2;break}return n.abrupt("return");case 2:if(Ie=N.id.split("-"),Ce=Object(g.a)(Ie,2),Je=Ce[0],q=Ce[1],Je!=="new"){n.next=7;break}return a=(Ye=ve.current)===null||Ye===void 0?void 0:Ye.getFieldValue("table"),(u=ve.current)===null||u===void 0||u.setFieldValue("table",a.filter(function(l){var v=l.id;return v!==N.id})),n.abrupt("return");case 7:return n.next=9,Object(d.d)(+q);case 9:if(s=n.sent,!s.success){n.next=13;break}return n.next=13,Z();case 13:case"end":return n.stop()}},M)})),okText:Object(r.jsx)(c.a,{id:"ok"}),cancelText:Object(r.jsx)(c.a,{id:"cancel"}),children:Object(r.jsx)(we.a,{title:Object(r.jsx)(c.a,{id:"delete",defaultMessage:"delete"}),children:Object(r.jsx)(ne.a,{type:"primary",icon:Object(r.jsx)(Te.a,{}),danger:!0})})},"delete")]}}])},[]);return Object(r.jsx)(m.a,{formRef:ve,initialValues:{table:$},submitter:!1,children:Object(r.jsx)(I.a,{rowKey:function(W){return W.id},editableFormRef:Be,controlled:!0,actionRef:T,name:"table",columns:be,recordCreatorProps:{creatorButtonText:Object(r.jsx)(c.a,{id:"CompetencyChallenges.addNewRow"}),disabled:pe.length>0,record:function(W){return{id:"new-".concat(W)}}},editable:{onlyOneLineEditorAlertMessage:ye.formatMessage({id:"CompetencyChallenges.onlyOneRowIsEditable"}),onSave:function(){var G=Object(R.a)(Object(F.a)().mark(function N(ie,z){var M,Ie,Ce,Je,q,Ye,u,a,s;return Object(F.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(M=z.scale_min,Ie=z.category_id,Ce=Object(S.a)(z,at),typeof Ce.id=="string"){n.next=3;break}return n.abrupt("return");case 3:if(Je=Ce.id.split("-"),q=Object(g.a)(Je,2),Ye=q[0],u=q[1],Ye!=="new"){n.next=12;break}return n.next=7,Object(d.b)({scale_min:M,category_id:Ie,competency_challenge_id:se});case 7:if(a=n.sent,!a.success){n.next=11;break}return n.next=11,Z();case 11:return n.abrupt("return");case 12:return n.next=14,Object(d.h)(+u,{scale_min:M,category_id:Ie,competency_challenge_id:se});case 14:if(s=n.sent,!s.success){n.next=18;break}return n.next=18,Z();case 18:return n.abrupt("return");case 19:case"end":return n.stop()}},N)}));function W(N,ie){return G.apply(this,arguments)}return W}(),deletePopconfirmMessage:Object(r.jsx)(c.a,{id:"deleteQuestion"}),actionRender:function(W,N,ie){if(typeof W.id!="string")return[];var z=W.id.split("-"),M=Object(g.a)(z,1),Ie=M[0];return Ie==="new"?[ie.save,ie.delete]:[ie.save,ie.cancel]},type:"single",editableKeys:pe,onChange:Pe}})})},qe=e("/zsF"),He=e("PArb"),rt=e("DYRE"),Ae=e("zeV3"),ke=e("uD7z"),Ve=e("FJDo"),et=e("4KAj"),ot=e("yioT"),ce=e("qRSf"),ct=e("rmhi"),lt=function(w){var j=w.quiz_id,X=w.visible,P=w.onVisibleChange,Z=m.a.useForm(),B=Object(g.a)(Z,1),se=B[0],he=Object(O.useCallback)(function(){var De=Object(R.a)(Object(F.a)().mark(function k(pe){var Pe,ye,ve;return Object(F.a)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return Pe=pe.category_ids,T.prev=1,T.next=4,Object(ce.c)({quiz_id:j,category_ids:Pe});case 4:ye=T.sent,ye instanceof Blob&&(ve=document.createElement("a"),ve.href=window.URL.createObjectURL(ye),ve.download="quiz_".concat(j,"_questions_by_category_id.xlsx"),document.body.appendChild(ve),ve.click(),document.body.removeChild(ve)),T.next=11;break;case 8:T.prev=8,T.t0=T.catch(1),console.error(T.t0);case 11:return T.prev=11,P(!1),T.finish(11);case 14:case"end":return T.stop()}},k,null,[[1,8,11,14]])}));return function(k){return De.apply(this,arguments)}}(),[j]);return Object(r.jsx)(ct.a,{title:Object(r.jsx)(c.a,{id:"exportQuestions"}),form:se,visible:X,onVisibleChange:P,onFinish:he,children:Object(r.jsx)(m.a.Item,{name:"category_ids",label:Object(r.jsx)(c.a,{id:"categories"}),required:!0,rules:[{required:!0,message:Object(r.jsx)(c.a,{id:"field_required"})}],children:Object(r.jsx)(_e.a,{multiple:!0,type:"question"})})})},ut=function(){var w=Object(V.b)(),j=w.competencyChallenge.data,X=Object(O.useState)(!1),P=Object(g.a)(X,2),Z=P[0],B=P[1],se=Object(O.useState)(!1),he=Object(g.a)(se,2),De=he[0],k=he[1],pe=Object(O.useState)(),Pe=Object(g.a)(pe,2),ye=Pe[0],ve=Pe[1],Be=Object(c.l)(),T=Object(O.useCallback)(function(){return B(!0)},[]),$=Object(O.useCallback)(function(){(j==null?void 0:j.quiz_id)!==void 0&&(k(!0),Object(ce.d)(j==null?void 0:j.quiz_id).then(function(G){G.success&&ve(G.data)}).finally(function(){return k(!1)}))},[j==null?void 0:j.quiz_id]),be=Object(O.useCallback)(function(){var G=Object(R.a)(Object(F.a)().mark(function W(N){return Object(F.a)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if((j==null?void 0:j.quiz_id)!==void 0){z.next=2;break}return z.abrupt("return");case 2:k(!0),Object(ce.g)(j==null?void 0:j.quiz_id,Object(J.a)(Object(J.a)({},N),{},{value:"diagnostic-test"})).then(function(M){M.success&&ve(M.data)}).finally(function(){return k(!1)});case 4:case"end":return z.stop()}},W)}));return function(W){return G.apply(this,arguments)}}(),[]);return Object(O.useEffect)(function(){$()},[$]),ye?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(lt,{visible:Z,onVisibleChange:B,quiz_id:ye.id}),Object(r.jsxs)("div",{style:{position:"relative",paddingBottom:"64px"},children:[Object(r.jsx)(m.a,{submitter:{render:function(W,N){var ie=Object(g.a)(N,2),z=ie[0],M=ie[1];return Object(r.jsxs)(Ae.b,{style:{position:"absolute",bottom:0,left:0},children:[z,M]})}},initialValues:ye,onFinish:be,children:Object(r.jsxs)(ke.a,{children:[Object(r.jsx)(Ve.a,{name:"max_attempts",label:Object(r.jsx)(c.a,{id:"max_attempts"}),tooltip:Object(r.jsx)(c.a,{id:"max_attempts"}),placeholder:Be.formatMessage({id:"max_attempts",defaultMessage:"max_attempts"})}),Object(r.jsx)(Ve.a,{name:"max_execution_time",label:Object(r.jsx)(c.a,{id:"max_execution_time"}),tooltip:Object(r.jsx)(c.a,{id:"max_execution_time"}),placeholder:Be.formatMessage({id:"max_execution_time",defaultMessage:"max_execution_time"})})]})}),Object(r.jsx)(He.a,{}),Object(r.jsx)(ot.a,{questions:ye.questions,quizId:ye.id,onAdded:$,onEdited:$,onRemoved:$,tableHeader:Object(r.jsx)(c.a,{id:"questions"}),tableLoading:De,questionsCategory:{type:"question"},customToolbarElements:[Object(r.jsxs)(ne.a,{type:"primary",icon:Object(r.jsx)(et.a,{}),onClick:T,children:[" ",Object(r.jsx)(c.a,{id:"exportQuestionsByCategory"})]},"export_by_category")]})]})]}):Object(r.jsx)(ee.a,{})},dt=function(){var w,j=Object(V.b)(),X=j.competencyChallenge,P=Object(c.l)(),Z=Object(me.l)(),B=Z.id,se=Z.tab,he=se===void 0?"main":se,De=B==="new",k=Object(O.useMemo)(function(){var pe;return De?P.formatMessage({id:"CompetencyChallenges.new_challenge"}):(pe=X.data)!==null&&pe!==void 0&&pe.name?X.data.name:P.formatMessage({id:"menu.Competency challenges"})},[P,(w=X.data)===null||w===void 0?void 0:w.name]);return Object(r.jsx)(xe.a,{title:k,header:{breadcrumb:{routes:[{path:"competency-challenges",breadcrumbName:P.formatMessage({id:"menu.Competency challenges"})},{path:String(B),breadcrumbName:k},{path:he,breadcrumbName:P.formatMessage({id:"CompetencyChallenges.".concat(he)})}]}},children:Object(r.jsxs)(Ee.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",cardProps:{loading:X.loading&&Object(r.jsx)(ee.a,{})},activeKey:he,onChange:function(Pe){c.f.push("/competency-challenges/".concat(B,"/").concat(Pe))}},children:[Object(r.jsx)(Ee.a.TabPane,{tab:Object(r.jsx)(c.a,{id:"CompetencyChallenges.main"}),children:Object(r.jsx)(Ue,{})},"main"),Object(r.jsx)(Ee.a.TabPane,{tab:Object(r.jsx)(c.a,{id:"CompetencyChallenges.scales"}),disabled:De,children:Object(r.jsx)(ge,{})},"scales"),Object(r.jsx)(Ee.a.TabPane,{tab:Object(r.jsx)(c.a,{id:"CompetencyChallenges.diagnostic-test"}),disabled:De,children:Object(r.jsx)(ut,{})},"diagnostic-test")]})})},mt=function(){return Object(r.jsx)(V.a,{children:Object(r.jsx)(dt,{})})},vt=K.default=mt},YRX9:function(Xe,K,e){"use strict";e.d(K,"f",function(){return me}),e.d(K,"e",function(){return Ee}),e.d(K,"a",function(){return F}),e.d(K,"g",function(){return te}),e.d(K,"c",function(){return J}),e.d(K,"b",function(){return g}),e.d(K,"h",function(){return h}),e.d(K,"d",function(){return ae});var C=e("qLMh"),ee=e("k1fw"),O=e("9og8"),c=e("9kvl");function me(p,b){return xe.apply(this,arguments)}function xe(){return xe=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges",Object(ee.a)({method:"GET",useCache:!1,params:b},E||{})));case 1:case"end":return d.stop()}},p)})),xe.apply(this,arguments)}function Ee(p,b){return V.apply(this,arguments)}function V(){return V=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges/".concat(b),Object(ee.a)({method:"GET",useCache:!1},E||{})));case 1:case"end":return d.stop()}},p)})),V.apply(this,arguments)}function F(p,b){return Le.apply(this,arguments)}function Le(){return Le=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges",Object(ee.a)({method:"POST",headers:{"Content-Type":"application/json"},data:b},E||{})));case 1:case"end":return d.stop()}},p)})),Le.apply(this,arguments)}function te(p,b,E){return R.apply(this,arguments)}function R(){return R=Object(O.a)(Object(C.a)().mark(function p(b,E,_){return Object(C.a)().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.abrupt("return",Object(c.i)("/api/admin/competency-challenges/".concat(b),Object(ee.a)({method:"PUT",headers:{"Content-Type":"application/json"},data:E},_||{})));case 1:case"end":return re.stop()}},p)})),R.apply(this,arguments)}function J(p,b){return S.apply(this,arguments)}function S(){return S=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges/".concat(b),Object(ee.a)({method:"DELETE"},E||{})));case 1:case"end":return d.stop()}},p)})),S.apply(this,arguments)}function g(p,b){return m.apply(this,arguments)}function m(){return m=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges/scales",Object(ee.a)({method:"POST",headers:{"Content-Type":"application/json"},data:b},E||{})));case 1:case"end":return d.stop()}},p)})),m.apply(this,arguments)}function h(p,b,E){return i.apply(this,arguments)}function i(){return i=Object(O.a)(Object(C.a)().mark(function p(b,E,_){return Object(C.a)().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.abrupt("return",Object(c.i)("/api/admin/competency-challenges/scales/".concat(b),Object(ee.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:E},_||{})));case 1:case"end":return re.stop()}},p)})),i.apply(this,arguments)}function ae(p,b){return Y.apply(this,arguments)}function Y(){return Y=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges/scales/".concat(b),Object(ee.a)({method:"DELETE"},E||{})));case 1:case"end":return d.stop()}},p)})),Y.apply(this,arguments)}},enqX:function(Xe,K,e){"use strict";e.d(K,"a",function(){return R});var C=e("nRaC"),ee=e("5RzL"),O=e("tJVT"),c=e("q1tI"),me=e.n(c),xe=e("9kvl"),Ee=e("JifO"),V=e("tKSU"),F=e("nKUr"),Le=e.n(F),te=function J(S,g,m){var h,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return(h=S.subcategories)!==null&&h!==void 0&&h.length?{title:S.name,value:S.id,disabled:i!==m||g.includes(S.id),children:S.subcategories.map(function(ae){return J(ae,g,m,i+1)})}:{title:S.name,value:S.id,disabled:i!==m||g.includes(S.id)}},R=function(S){var g,m,h,i=S.value,ae=S.onChange,Y=S.type,p=Y===void 0?"scale":Y,b=S.disabledNodes,E=b===void 0?[]:b,_=S.multiple,d=_===void 0?!1:_,re=Object(c.useState)([]),r=Object(O.a)(re,2),Q=r[0],fe=r[1],Ue=Object(V.b)(),Ke=Ue.categoryDepths,t=Ue.competencyChallenge,Me=Object(c.useMemo)(function(){var x;return((x=t.data)===null||x===void 0?void 0:x.type)==="simple"?Q.filter(function(ne){var Qe,Te;return ne.id===((Qe=t.data)===null||Qe===void 0||(Te=Qe.category)===null||Te===void 0?void 0:Te.id)}):Q},[Q,(g=t.data)===null||g===void 0?void 0:g.type,(m=t.data)===null||m===void 0||(h=m.category)===null||h===void 0?void 0:h.id]),we=Object(c.useMemo)(function(){return Me.map(function(x){return te(x,E,Ke[p])})},[Me,E,p]);return Object(c.useEffect)(function(){Object(Ee.c)().then(function(x){x.success&&fe(x.data)})},[]),Object(F.jsx)(ee.a,{loading:Q.length===0,showSearch:!0,multiple:d,value:i,dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:Object(F.jsx)(xe.a,{id:"select",defaultMessage:"Please select"}),allowClear:!0,treeDefaultExpandAll:!0,onChange:ae,treeData:we,disabled:Q.length===0})}},hd5d:function(Xe,K,e){"use strict";var C=e("qLMh"),ee=e("9og8"),O=e("q1tI"),c=e.n(O),me=e("acco"),xe=e.n(me),Ee=e("BAh9"),V=e("vtG9"),F=e.n(V),Le=e("9kvl"),te=e("nKUr"),R=e.n(te),J=function(m){var h=m.attrs,i=h.href,ae=i.split("/").pop();return Object(te.jsx)("p",{children:Object(te.jsx)("a",{rel:"noreferrer",href:i,target:"_blank",children:ae})})},S=function(m){var h=m.value,i=m.onChange,ae=m.directory,Y=ae===void 0?"/wysiwyg":ae,p=Object(Le.l)();return Object(te.jsx)("div",{className:"form-wysiwyg-markdown",children:Object(te.jsx)(xe.a,{excludeBlockMenuItems:["Sketch"],embeds:[{matcher:function(E){return!0},component:J}],uploadImage:function(){var b=Object(ee.a)(Object(C.a)().mark(function E(_){var d,re;return Object(C.a)().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,Object(Ee.e)(_,Y);case 2:if(d=Q.sent,!d.success){Q.next=8;break}if(!_.type.includes("image/")){Q.next=7;break}return re=d.data[0].name.includes("/")?d.data[0].name:"".concat(Y).concat(d.data[0].name),Q.abrupt("return",Object(Ee.d)(re,1e3));case 7:return Q.abrupt("return",d.data[0].url);case 8:throw new Error("Error while uploading");case 9:case"end":return Q.stop()}},E)}));return function(E){return b.apply(this,arguments)}}(),defaultValue:h||"",onChange:function(E){return i&&i(E())},placeholder:p.formatMessage({id:"wysiwyg_placeholder"})})})};K.a=S},tKSU:function(Xe,K,e){"use strict";e.d(K,"b",function(){return S}),e.d(K,"a",function(){return g});var C=e("k1fw"),ee=e("tJVT"),O=e("qLMh"),c=e("9og8"),me=e("q1tI"),xe=e.n(me),Ee=e("Ty5D"),V=e("YRX9"),F=e("+up7"),Le=e("nKUr"),te=e.n(Le),R={categoryDepths:{scale:2,question:1,role:0},competencyChallenge:{data:null,loading:!1},refreshData:function(){var m=Object(c.a)(Object(O.a)().mark(function i(){return Object(O.a)().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.abrupt("return",console.warn("CONTEXT INIT"));case 1:case"end":return Y.stop()}},i)}));function h(){return m.apply(this,arguments)}return h}()},J=xe.a.createContext(R),S=function(){return Object(me.useContext)(J)},g=function(h){var i=h.children,ae=Object(me.useState)(R.competencyChallenge),Y=Object(ee.a)(ae,2),p=Y[0],b=Y[1],E=Object(me.useState)(R.categoryDepths),_=Object(ee.a)(E,2),d=_[0],re=_[1],r=Object(Ee.l)(),Q=r.id,fe=Number(Q),Ue=Object(me.useCallback)(Object(c.a)(Object(O.a)().mark(function t(){var Me;return Object(O.a)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!Number.isNaN(fe)){x.next=2;break}return x.abrupt("return");case 2:return x.prev=2,b(function(ne){return Object(C.a)(Object(C.a)({},ne),{},{loading:!0})}),x.next=6,Object(V.e)(fe);case 6:if(Me=x.sent,Me.success){x.next=10;break}return b(function(ne){return Object(C.a)(Object(C.a)({},ne),{},{error:Me.errors})}),x.abrupt("return");case 10:b(function(ne){return Object(C.a)(Object(C.a)({},ne),{},{data:Me.data})}),x.next=16;break;case 13:x.prev=13,x.t0=x.catch(2),b(function(ne){return Object(C.a)(Object(C.a)({},ne),{},{error:x.t0})});case 16:return x.prev=16,b(function(ne){return Object(C.a)(Object(C.a)({},ne),{},{loading:!1})}),x.finish(16);case 19:case"end":return x.stop()}},t,null,[[2,13,16,19]])})),[fe]),Ke=Object(me.useCallback)(Object(c.a)(Object(O.a)().mark(function t(){var Me,we,x,ne,Qe,Te,I,_e,at,Ze,Ge,ge,qe,He,rt,Ae,ke,Ve,et;return Object(O.a)().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.prev=0,ce.next=3,Object(F.a)();case 3:if(Ae=ce.sent,Ae.success){ce.next=6;break}return ce.abrupt("return");case 6:ke=Number((Me=Ae.data)===null||Me===void 0||(we=Me.escolalms_competency_challenge)===null||we===void 0||(x=we.category)===null||x===void 0||(ne=x.scale)===null||ne===void 0||(Qe=ne.depth)===null||Qe===void 0?void 0:Qe.value),Ve=Number((Te=Ae.data)===null||Te===void 0||(I=Te.escolalms_competency_challenge)===null||I===void 0||(_e=I.category)===null||_e===void 0||(at=_e.question)===null||at===void 0||(Ze=at.depth)===null||Ze===void 0?void 0:Ze.value),et=Number((Ge=Ae.data)===null||Ge===void 0||(ge=Ge.escolalms_competency_challenge)===null||ge===void 0||(qe=ge.category)===null||qe===void 0||(He=qe.role)===null||He===void 0||(rt=He.depth)===null||rt===void 0?void 0:rt.value),re({scale:Number.isNaN(ke)?2:ke,question:Number.isNaN(Ve)?1:Ve,role:Number.isNaN(et)?0:et}),ce.next=15;break;case 12:ce.prev=12,ce.t0=ce.catch(0),console.error(ce.t0);case 15:case"end":return ce.stop()}},t,null,[[0,12]])})),[]);return Object(me.useEffect)(function(){Ue(),Ke()},[Ue,Ke]),Object(Le.jsx)(J.Provider,{value:{categoryDepths:d,competencyChallenge:p,refreshData:Ue},children:i})}},vtG9:function(Xe,K,e){},yioT:function(Xe,K,e){"use strict";e.d(K,"a",function(){return Ye});var C=e("tU7J"),ee=e("wFql"),O=e("BoS7"),c=e("Sdc0"),me=e("miYZ"),xe=e("tsqr"),Ee=e("+L6B"),V=e("2/Rp"),F=e("oBTY"),Le=e("bbsP"),te=e("/wGt"),R=e("qLMh"),J=e("9og8"),S=e("PpiC"),g=e("tJVT"),m=e("k1fw"),h=e("q1tI"),i=e("9kvl"),ae=e("YJCA"),Y=e("wYyv"),p=e("smpX"),b=e("eyie"),E=e("w5pM"),_=e("4KAj"),d=e("mWMg"),re=e("DBJ/"),r=e("Vpfc"),Q=e("qRSf"),fe=e("VMEa"),Ue=e("rmhi"),Ke=e("yj/a"),t=e("nKUr"),Me=function(a){var s=a.quiz_id,o=a.quizQuestions,n=a.visible,l=a.onVisibleChange,v=fe.a.useForm(),y=Object(g.a)(v,1),L=y[0],D=Object(i.l)(),A=Object(h.useCallback)(function(){var Se=Object(J.a)(Object(R.a)().mark(function le(Fe){var U,Ne,Re;return Object(R.a)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return U=Fe.ids,oe.prev=1,oe.next=4,Object(Q.c)({quiz_id:s,ids:U});case 4:Ne=oe.sent,Ne instanceof Blob&&(Re=document.createElement("a"),Re.href=window.URL.createObjectURL(Ne),Re.download="quiz_questions_".concat(s,".xlsx"),document.body.appendChild(Re),Re.click(),document.body.removeChild(Re)),oe.next=11;break;case 8:oe.prev=8,oe.t0=oe.catch(1),console.error(oe.t0);case 11:return oe.prev=11,l(!1),oe.finish(11);case 14:case"end":return oe.stop()}},le,null,[[1,8,11,14]])}));return function(le){return Se.apply(this,arguments)}}(),[s]),de=Object(h.useMemo)(function(){return o.map(function(Se){var le=Se.id,Fe=Se.value,U=Object(p.parse)(Fe);if(!(U!=null&&U[0])||!("stem"in U[0]))return{value:le,label:D.formatMessage({id:"ExportQuestions.questionTitle"},{id:le})};var Ne=U[0].stem.text;return{value:le,label:Ne}})},[o]);return Object(t.jsx)(Ue.a,{title:Object(t.jsx)(i.a,{id:"exportQuestions"}),form:L,visible:n,onVisibleChange:l,onFinish:A,children:Object(t.jsx)(Ke.a,{mode:"multiple",options:de,name:"ids",label:Object(t.jsx)(i.a,{id:"questions"}),required:!0,rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}]})})},we=e("DYRE"),x=e("zeV3"),ne=e("/zsF"),Qe=e("PArb"),Te=e("FJDo"),I=e("/y+f"),_e=e("enqX"),at=e("5Dmo"),Ze=e("3S7+"),Ge=e("jrin"),ge=e("Qurx"),qe=e("x1Ii"),He=e("tneF"),rt=e("/MfK"),Ae,ke=(Ae={},Object(Ge.a)(Ae,I.e.MULTIPLE_CHOICE,[{isCorrect:!1,value:""},{isCorrect:!1,value:""}]),Object(Ge.a)(Ae,I.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS,[{value:"",weight:""},{value:"",weight:""}]),Ae),Ve=function(a){var s,o=a.type,n=Object(i.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ge.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(qe.b,{name:"answers",creatorButtonProps:{creatorButtonText:n.formatMessage({id:"Questions.addAnswer"})},actionRender:function(){return[]},initialValue:(s=ke[o])!==null&&s!==void 0?s:[],children:function(v,y,L,D){return Object(t.jsxs)(fe.a.Group,{title:Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(i.a,{id:"Questions.answer",values:{ordinalNumber:y+1}}),D>2&&Object(t.jsx)(Ze.a,{title:n.formatMessage({id:"Questions.deleteAnswer"}),children:Object(t.jsx)(V.a,{type:"text",icon:Object(t.jsx)(rt.a,{}),onClick:function(){return L.remove(v.name)}})})]}),titleStyle:{width:"100%",display:"flex",justifyContent:"space-between"},children:[o===I.e.MULTIPLE_CHOICE&&Object(t.jsx)(He.a,{name:"isCorrect",label:Object(t.jsx)(i.a,{id:"Questions.correctAnswer",defaultMessage:"Is Correct Answer?"}),rules:[function(A){var de=A.getFieldValue;return{validator:function(){var le,Fe=(le=de("answers"))!==null&&le!==void 0?le:[];return Fe.filter(function(U){return U==null?void 0:U.isCorrect}).length>1?Promise.reject("Only one answer can be correct"):Promise.resolve()},message:Object(t.jsx)(i.a,{id:"Questions.onlyOneAnswerIsCorrect"})}}]}),Object(t.jsx)(ge.a,{name:"value",rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],label:Object(t.jsx)(i.a,{id:"content",defaultMessage:"Content"})}),o===I.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS&&Object(t.jsx)(Te.a,{name:"weight",rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],fieldProps:{min:-Number.MAX_SAFE_INTEGER,addonAfter:"%"},label:Object(t.jsx)(i.a,{id:"weight",defaultMessage:"Weight"})})]})}})]})},et=function(){return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ge.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(He.a,{name:"isCorrect",label:Object(t.jsx)(i.a,{id:"Questions.correctAnswer"})})]})},ot=[{value:""}],ce=function(){var a=Object(i.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ge.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(qe.b,{name:"answers",creatorButtonProps:{creatorButtonText:a.formatMessage({id:"Questions.addAnswer"})},deleteIconProps:{tooltipText:a.formatMessage({id:"Questions.deleteAnswer"})},actionRender:function(o,n,l){var v=Object(g.a)(l,2),y=v[1];return[y]},min:1,initialValue:ot,children:function(o,n){return Object(t.jsx)(ge.a,{name:"value",rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],label:Object(t.jsx)(i.a,{id:"Questions.answer",values:{ordinalNumber:n+1},defaultMessage:"Answer ".concat(n+1)})})}})]})},ct=[{firstOfPair:"",secondOfPair:""}],lt=function(){var a=Object(i.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ge.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(qe.b,{name:"answers",creatorButtonProps:{creatorButtonText:a.formatMessage({id:"Questions.addMatchingPair",defaultMessage:"Add Matching Pair"})},deleteIconProps:{tooltipText:a.formatMessage({id:"Questions.deletePair"})},actionRender:function(o,n,l){var v=Object(g.a)(l,2),y=v[1];return[y]},min:1,initialValue:ct,children:function(o,n){return Object(t.jsxs)(fe.a.Group,{direction:"horizontal",align:"baseline",size:"small",spaceProps:{style:{flexWrap:"nowrap"}},title:Object(t.jsx)(i.a,{id:"Questions.pair",values:{ordinalNumber:n+1},defaultMessage:"Pair ".concat(n+1)}),children:[Object(t.jsx)(ge.a,{name:"firstOfPair",rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}]}),Object(t.jsx)(ge.a,{name:"secondOfPair",rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}]})]})}})]})},ut=function(){return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ge.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Te.a,{name:"answer",label:Object(t.jsx)(i.a,{id:"answer"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Te.a,{name:"errorMargin",fieldProps:{addonAfter:"+/-"},label:Object(t.jsx)(i.a,{id:"Questions.errorMargin"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0})]})},dt=e("BiO0"),mt=function(){return Object(t.jsx)(dt.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0})},vt=function(a){var s=a.type;if(!s)return null;switch(s){case I.e.MULTIPLE_CHOICE:case I.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return Object(t.jsx)(Ve,{type:s});case I.e.TRUE_FALSE:return Object(t.jsx)(et,{});case I.e.SHORT_ANSWERS:return Object(t.jsx)(ce,{});case I.e.MATCHING:return Object(t.jsx)(lt,{});case I.e.NUMERICAL_QUESTION:return Object(t.jsx)(ut,{});case I.e.ESSAY:case I.e.DESCRIPTION:return Object(t.jsx)(mt,{})}return Object(t.jsxs)("pre",{children:["Unsupported type ",s]})},je=e("rAM+"),w=["question"],j=function(a){for(var s=["~","=","#","{","}",":"],o="",n=0;n<a.length;n++){var l=a[n];s.includes(l)?o+="\\".concat(l):o+=l}return o},X=function(a){var s=a.question,o=a.answers;if(o.length===0)return"".concat(s,"{}");var n="".concat(s,"{"),l=Object(je.a)(o),v;try{for(l.s();!(v=l.n()).done;){var y=v.value,L=y.isCorrect,D=y.value,A=L?"=":"~";n+="".concat(A).concat(D)}}catch(de){l.e(de)}finally{l.f()}return n+="}",n.trim()},P=function(a){var s=a.question,o=a.answers;if(o.length==0)return"".concat(s,"{}");var n="".concat(s,"{"),l=Object(je.a)(o),v;try{for(l.s();!(v=l.n()).done;){var y=v.value,L=y.value,D=y.weight;n+="~%".concat(D,"%").concat(L)}}catch(A){l.e(A)}finally{l.f()}return n+="}",n.trim()},Z=function(a){var s=a.question,o=a.isCorrect;return"".concat(s,"{").concat(o?"T":"F","}")},B=function(a){var s=a.question,o=a.answers;if(o.length===0)return"".concat(s,"{}");var n="".concat(s,"{"),l=Object(je.a)(o),v;try{for(l.s();!(v=l.n()).done;){var y=v.value,L=y.value;n+="=".concat(L)}}catch(D){l.e(D)}finally{l.f()}return n+="}",n.trim()},se=function(a){var s=a.question,o=a.answers;if(o.length===0)return"".concat(s,"{}");var n="".concat(s,"{"),l=Object(je.a)(o),v;try{for(l.s();!(v=l.n()).done;){var y=v.value,L=y.firstOfPair,D=y.secondOfPair;n+="=".concat(L,"->").concat(D)}}catch(A){l.e(A)}finally{l.f()}return n+="}",n.trim()},he=function(a){var s=a.question,o=a.answer,n=a.errorMargin;return"".concat(s,"{#").concat(o,":").concat(n,"}")},De=function(a){var s=a.question;return"".concat(s,"{}")},k=function(a){var s=a.question;return s},pe=function(a){var s=a.question,o=Object(S.a)(a,w),n=Object(m.a)({question:j(s)},o);switch(n.type){case I.e.MULTIPLE_CHOICE:return X(n);case I.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return P(n);case I.e.TRUE_FALSE:return Z(n);case I.e.SHORT_ANSWERS:return B(n);case I.e.MATCHING:return se(n);case I.e.NUMERICAL_QUESTION:return he(n);case I.e.ESSAY:return De(n);case I.e.DESCRIPTION:return k(n);default:throw new Error("Unsupported type: ".concat(n.type))}},Pe=function(a,s){var o=s.type,n=s.score,l=s.category_id,v=a==null?void 0:a.stem.text,y=a.choices.every(function(A){var de=A.weight;return de===null});if(y){var L=a.choices.map(function(A){var de=A.isCorrect,Se=A.text;return{isCorrect:de,value:Se.text}});return{type:o,score:n,category_id:l,question:v,answers:L}}var D=a.choices.reduce(function(A,de){var Se=de.weight,le=de.text;return Se!==null?[].concat(Object(F.a)(A),[{weight:Se,value:le.text}]):A},[]);return{type:o,score:n,category_id:l,question:v,answers:D}},ye=function(a,s){var o=s.type,n=s.score,l=s.category_id,v=a==null?void 0:a.stem.text,y=a.isTrue;return{type:o,score:n,category_id:l,question:v,isCorrect:y}},ve=function(a,s){var o=s.type,n=s.score,l=s.category_id,v=a==null?void 0:a.stem.text,y=a.choices.map(function(L){var D=L.text;return{value:D.text}});return{type:o,score:n,category_id:l,question:v,answers:y}},Be=function(a,s){var o=s.type,n=s.score,l=s.category_id,v=a==null?void 0:a.stem.text,y=a.matchPairs.map(function(L){var D=L.subquestion,A=L.subanswer;return{firstOfPair:D.text,secondOfPair:A}});return{type:o,score:n,category_id:l,question:v,answers:y}},T=function(a,s){var o=s.type,n=s.score,l=s.category_id,v=a==null?void 0:a.stem.text;if(Array.isArray(a==null?void 0:a.choices))throw new Error("Unsupported choices type: array");var y=a==null?void 0:a.choices.number,L=a==null?void 0:a.choices.range;if(y===void 0||L===void 0)throw new Error("Value undefined - answer: ".concat(y," errorMargin: ").concat(L));return{type:o,score:n,category_id:l,question:v,answer:y,errorMargin:L}},$=function(a,s){var o=s.type,n=s.score,l=s.category_id,v=a==null?void 0:a.stem.text;return{type:o,score:n,category_id:l,question:v}};function be(u){if(!!u){var a=Object(p.parse)(u.value),s=Object(g.a)(a,1),o=s[0];switch(o.type){case"MC":return Pe(o,u);case"TF":return ye(o,u);case"Short":return ve(o,u);case"Matching":return Be(o,u);case"Numerical":return T(o,u);case"Description":case"Essay":return $(o,u);default:throw new Error("Unsupported type: ".concat(o==null?void 0:o.type))}}}var G=["type","score","category"],W=Object.values(I.e).reduce(function(u,a){return a?[].concat(Object(F.a)(u),[{value:a,label:Object(t.jsx)(i.a,{id:"gift_type.".concat(a)})}]):u},[]),N=function(a){var s=a.onSubmit,o=a.values,n=a.competencyChallengeCategoryTreeProps,l=n===void 0?!1:n,v=Object(i.l)(),y=fe.a.useForm(),L=Object(g.a)(y,1),D=L[0],A=fe.a.useWatch("type",D),de=Object(h.useMemo)(function(){return be(o)},[o]),Se=Object(h.useCallback)(function(){var le=Object(J.a)(Object(R.a)().mark(function Fe(U){var Ne,Re,nt,oe;return Object(R.a)().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return Ne=pe(U),Re=U.score,nt=U.category_id,ze.next=4,s({value:Ne,score:Re,category_id:nt});case 4:if(oe=ze.sent,oe){ze.next=7;break}return ze.abrupt("return");case 7:D.resetFields();case 8:case"end":return ze.stop()}},Fe)}));return function(Fe){return le.apply(this,arguments)}}(),[]);return Object(h.useEffect)(function(){D.resetFields()},[de]),Object(h.useEffect)(function(){if(A){var le=D.getFieldsValue(),Fe=Object.keys(le).filter(function(U){return!G.includes(U)});D.resetFields(Fe)}},[A]),Object(t.jsxs)(x.b,{direction:"vertical",style:{display:"flex"},children:[Object(t.jsx)(Qe.a,{children:Object(t.jsx)(i.a,{id:de?"Questions.edit":"addNewQuestion"})}),Object(t.jsxs)(fe.a,{layout:"horizontal",form:D,onFinish:Se,initialValues:de,children:[Object(t.jsx)(Ke.a,{name:"type",placeholder:v.formatMessage({id:"selectNewQuestionType",defaultMessage:"Select new question type"}),label:Object(t.jsx)(i.a,{id:"type",defaultMessage:"Type:"}),options:W,rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(vt,{type:A}),Object(t.jsx)(Te.a,{name:"score",label:Object(t.jsx)(i.a,{id:"Questions.score",defaultMessage:"Score"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}]}),l&&Object(t.jsx)(fe.a.Item,{name:"category_id",label:Object(t.jsx)(i.a,{id:"category",defaultMessage:"Category"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0,children:Object(t.jsx)(_e.a,Object(m.a)({},typeof l=="object"?l:{}))})]})]})},ie=e("60mZ"),z=["className","style"],M=Object(ae.c)(function(){return Object(t.jsx)(b.a,{style:{cursor:"grab",color:"#999"}})}),Ie=Object(ae.b)(function(u){return Object(t.jsx)("tr",Object(m.a)({},u))}),Ce=Object(ae.a)(function(u){return Object(t.jsx)("tbody",Object(m.a)({},u))}),Je=[{title:Object(t.jsx)(i.a,{id:"sort",defaultMessage:"sort"}),dataIndex:"id",width:60,className:"drag-visible",render:function(){return Object(t.jsx)(M,{})}},{title:Object(t.jsx)(i.a,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,s){return Object(t.jsx)(i.a,{id:"gift_type.".concat(s.type)})}},{title:Object(t.jsx)(i.a,{id:"question",defaultMessage:"Question"}),dataIndex:"question",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,s){var o=Object(p.parse)(s.value);return o!=null&&o[0]&&"stem"in o[0]?o[0].stem.text:"question"}}],q={title:Object(t.jsx)(i.a,{id:"category",defaultMessage:"Category"}),dataIndex:"category_id",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,s){return typeof s.category_id=="number"?Object(t.jsx)(r.a,{type:"Category",type_id:s.category_id}):"-"}},Ye=function(a){var s=a.questions,o=a.onAdded,n=a.onRemoved,l=a.onEdited,v=a.quizId,y=a.tableLoading,L=a.tableHeader,D=a.questionsCategory,A=a.customToolbarElements,de=A===void 0?[]:A,Se=Object(h.useState)(!1),le=Object(g.a)(Se,2),Fe=le[0],U=le[1],Ne=Object(h.useState)(!1),Re=Object(g.a)(Ne,2),nt=Re[0],oe=Re[1],bt=Object(h.useState)(),ze=Object(g.a)(bt,2),We=ze[0],jt=ze[1],yt=Object(h.useState)(!1),Ot=Object(g.a)(yt,2),Ct=Ot[0],ft=Ot[1],xt=Object(h.useState)(!1),gt=Object(g.a)(xt,2),Et=gt[0],Mt=gt[1],Tt=Object(h.useState)(s),ht=Object(g.a)(Tt,2),it=ht[0],pt=ht[1],Pt=Object(i.l)(),St=Object(h.useRef)();Object(h.useEffect)(function(){var Oe;(Oe=St.current)===null||Oe===void 0||Oe.reload(),pt(s)},[s]);var Dt=function(H){var ue=H.oldIndex,$e=H.newIndex;if(ue!==$e){var tt=Object(Y.a)(it.slice(),ue,$e).filter(Boolean).map(function(f,st){return Object(m.a)(Object(m.a)({},f),{},{order:st})});tt.forEach(function(f,st){f.id!==it[st].id&&Object(Q.h)(f.id,Object(m.a)(Object(m.a)({},f),{},{order:st+1,topic_gift_quiz_id:v}))}),pt(tt)}},It=function(H){return Object(t.jsx)(Ce,Object(m.a)({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:Dt},H))},At=function(H){var ue=H.className,$e=H.style,tt=Object(S.a)(H,z),f=it.findIndex(function(st){return st.id===tt["data-row-key"]});return Object(t.jsx)(Ie,Object(m.a)({index:f},tt))},Ft=Object(h.useCallback)(function(){var Oe=Object(J.a)(Object(R.a)().mark(function H(ue){var $e;return Object(R.a)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,U(!0),f.next=4,Object(Q.a)(Object(m.a)({topic_gift_quiz_id:v},ue));case 4:return $e=f.sent,oe(!1),o==null||o(),f.abrupt("return",$e.success);case 10:return f.prev=10,f.t0=f.catch(0),console.log(f.t0),f.abrupt("return",!1);case 14:return f.prev=14,U(!1),f.finish(14);case 17:case"end":return f.stop()}},H,null,[[0,10,14,17]])}));return function(H){return Oe.apply(this,arguments)}}(),[nt,v]),Rt=Object(h.useCallback)(function(){var Oe=Object(J.a)(Object(R.a)().mark(function H(ue){var $e;return Object(R.a)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if((We==null?void 0:We.id)!==void 0){f.next=2;break}return f.abrupt("return",!1);case 2:return f.prev=2,U(!0),f.next=6,Object(Q.h)(We.id,Object(m.a)({topic_gift_quiz_id:v},ue));case 6:return $e=f.sent,jt(void 0),l==null||l(),f.abrupt("return",$e.success);case 12:return f.prev=12,f.t0=f.catch(2),console.log(f.t0),f.abrupt("return",!1);case 16:return f.prev=16,U(!1),f.finish(16);case 19:case"end":return f.stop()}},H,null,[[2,12,16,19]])}));return function(H){return Oe.apply(this,arguments)}}(),[We==null?void 0:We.id,v]);return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(te.a,{open:nt,onClose:function(){return oe(!1)},children:Object(t.jsx)(N,{onSubmit:Ft,competencyChallengeCategoryTreeProps:D})}),Object(t.jsx)(te.a,{open:!!We,onClose:function(){return jt(void 0)},children:Object(t.jsx)(N,{onSubmit:Rt,competencyChallengeCategoryTreeProps:D,values:We})}),Object(t.jsx)(Me,{quiz_id:v,quizQuestions:it,visible:Ct,onVisibleChange:ft}),Object(t.jsx)(d.a,{search:!1,cardProps:{bodyStyle:{padding:0}},loading:y,headerTitle:L,toolbar:{settings:[]},toolBarRender:function(){return[Object(t.jsxs)(V.a,{icon:Object(t.jsx)(E.a,{}),type:"primary",onClick:function(){return oe(!0)},children:[" ",Object(t.jsx)(i.a,{id:"addNewQuestion",defaultMessage:"Add new question"})]},"add"),Object(t.jsx)(re.a,{title:Pt.formatMessage({id:"importQuestions"}),hideLabel:!0,showUploadList:!1,url:"/api/admin/gift-questions/import",name:"file",accept:".xlsx",data:{topic_gift_quiz_id:v},onChange:function(ue){ue.file.status==="done"&&ue.file.response&&ue.file.response.success&&(xe.b.success(ue.file.response.message),o==null||o()),ue.file.response&&ue.file.status==="error"&&(xe.b.error(ue.file.response.message),console.error(ue.file.response))}},"import"),Object(t.jsxs)(V.a,{icon:Object(t.jsx)(_.a,{}),type:"primary",onClick:function(){return ft(!0)},children:[" ",Object(t.jsx)(i.a,{id:"exportQuestions"})]},"export")].concat(Object(F.a)(de))},columns:[].concat(Je,Object(F.a)(D?[q]:[]),[{title:Object(t.jsx)(i.a,{id:"actions",defaultMessage:"Actions"}),dataIndex:"address",valueType:"option",render:function(H,ue){return[Object(t.jsx)(V.a,{size:"small",type:"primary",onClick:function(){jt(ue)},children:Object(t.jsx)(i.a,{id:"Questions.edit",defaultMessage:"Edit Question"})},"edit"),Object(t.jsx)(V.a,{loading:Fe,size:"small",danger:!0,onClick:function(){U(!0),Object(Q.b)(ue.id).then(function(){n&&n()}).finally(function(){U(!1)})},children:Object(t.jsx)(i.a,{id:"Questions.delete",defaultMessage:"Delete Question"})},"delete")]}}]),rowKey:function(H){return H.id},pagination:!1,dataSource:it,components:{body:{wrapper:It,row:At}}}),Object(t.jsxs)(ee.a,{style:{marginTop:"3em"},children:["Debug GIFT: ",Object(t.jsx)(c.a,{checked:Et,onChange:function(H){return Mt(H)}})]})]})}}}]);

//# sourceMappingURL=p__CompetencyChallenges__form.9e323b0a.async.js.map