(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"4f6N":function(X,C,e){"use strict";var I=e("2qtc"),A=e("kLXV"),E=e("9kvl"),f=e("nKUr"),H=e.n(f),N=function(m){var B=m.visible,P=m.setManage;return Object(f.jsx)(A.a,{width:"600px",title:Object(f.jsx)(E.a,{id:"course.validate_edit.header",defaultMessage:"course.validate_edit.header"}),visible:B,onOk:function(){return P({showModal:!1,disableEdit:!1,clicked:!0})},onCancel:function(){return P({showModal:!1,disableEdit:!0,clicked:!1})},okText:"OK",cancelText:"Cancel",children:Object(f.jsx)("p",{children:Object(f.jsx)(E.a,{id:"course.validate_edit.content",defaultMessage:"course.validate_edit.content"})})})};C.a=N},CiB2:function(X,C,e){"use strict";e.d(C,"a",function(){return I});function I(A){if(A==null)throw new TypeError("Cannot destructure undefined")}},CiXh:function(X,C,e){"use strict";var I=e("2qtc"),A=e("kLXV"),E=e("9kvl"),f=e("nKUr"),H=e.n(f),N=function(m){var B=m.open,P=m.onOk,p=m.onCancel,T=m.title,S=m.content,a=m.okText,G=m.loading;return Object(f.jsx)(A.a,{width:"600px",title:T!=null?T:Object(f.jsx)(E.a,{id:"confirmModal.title"}),open:B,onOk:P,onCancel:p,okText:a!=null?a:Object(f.jsx)(E.a,{id:"save"}),cancelText:Object(f.jsx)(E.a,{id:"cancel"}),confirmLoading:G,children:S!=null?S:Object(f.jsx)("p",{children:Object(f.jsx)(E.a,{id:"confirmModal.content"})})})};C.a=N},FJDo:function(X,C,e){"use strict";var I=e("VTBJ"),A=e("Ff2n"),E=e("nKUr"),f=e.n(E),H=e("q1tI"),N=e.n(H),Z=e("adzw"),m=["fieldProps","min","proFieldProps","max"],B=function(p,T){var S=p.fieldProps,a=p.min,G=p.proFieldProps,K=p.max,v=Object(A.a)(p,m);return Object(E.jsx)(Z.a,Object(I.a)({valueType:"digit",fieldProps:Object(I.a)({min:a,max:K},S),ref:T,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:G},v))};C.a=N.a.forwardRef(B)},GZq3:function(X,C,e){},"J+hL":function(X,C,e){},eFHa:function(X,C,e){"use strict";e.d(C,"a",function(){return Z});var I=e("k1fw"),A=e("tJVT"),E=e("q1tI"),f=e("/Tr7"),H=e("jIYg");function N(m){return Object(H.a)(1,arguments),Object(f.a)(m).getTime()<Date.now()}function Z(){var m=Object(E.useState)({showModal:!1,disableEdit:!1,clicked:!1}),B=Object(A.a)(m,2),P=B[0],p=B[1],T=function(a){(a==null?void 0:a.status)==="published"&&a!==null&&a!==void 0&&a.active_from&&N(new Date(a==null?void 0:a.active_from))&&!P.clicked?p(Object(I.a)(Object(I.a)({},P),{},{showModal:!1,disableEdit:!0,clicked:!1})):p(Object(I.a)(Object(I.a)({},P),{},{showModal:!1,disableEdit:!1,clicked:!1}))};return{manageCourseEdit:P,setManageCourseEdit:p,validateCourseEdit:T}}},q34N:function(X,C,e){"use strict";var I=e("tJVT"),A=e("0eZe"),E=e("q1tI"),f=e.n(E),H=e("nKUr"),N=e.n(H),Z=function(B){var P=B.productable,p=B.type,T=p===void 0?"card":p,S=Object(E.useState)("attributes"),a=Object(I.a)(S,2),G=a[0],K=a[1];return Object(H.jsx)(A.a,{productable:P,tab:G,onTabChange:function(q){return K(q)},type:T})};C.a=Z},rh3J:function(X,C,e){"use strict";e.r(C);var I=e("14J3"),A=e("BMrR"),E=e("jCWc"),f=e("kPKH"),H=e("fOrg"),N=e("+KLJ"),Z=e("+L6B"),m=e("2/Rp"),B=e("T2oS"),P=e("W9HT"),p=e("miYZ"),T=e("tsqr"),S=e("qLMh"),a=e("k1fw"),G=e("9og8"),K=e("tJVT"),v=e("q1tI"),q=e.n(v),R=e("VMEa"),at=e("Qurx"),ct=e("yj/a"),nt=e("lR9U"),z=e("nhC9"),ut=e("hd5d"),jt=e("tMyG"),n=e("9kvl"),bt=e("Ty5D"),Ot=e("0WSk"),ft=e("TWax"),_=e("Gb5Y"),Lt=e("OaEy"),vt=e("2fM7"),Kt=e("iQDF"),st=e("+eQT"),Wt=e("+BJd"),mt=e("mr32"),ht=e("oBTY"),gt=e("wd/R"),k=e.n(gt),Nt=e("GZq3"),t=e("nKUr"),rt=function(i){return i.local().valueOf()},xt=function(i){var O=i.value,s=O===void 0?[]:O,D=i.onChange,g=i.format,y=g===void 0?"DD-MM-YYYY HH:mm":g,J=i.selectProps,Y=J===void 0?{}:J,c=Object(v.useState)(!1),U=Object(K.a)(c,2),$=U[0],r=U[1],M=Object(v.useCallback)(function(j){var b=rt(j),o=s.indexOf(b),l=Object(ht.a)(s);o>-1?l.splice(o,1):l.push(b),D(l)},[s]),u=Object(v.useCallback)(function(j){var b=s.indexOf(rt(j))>-1;return Object(t.jsx)("div",{className:"ant-picker-cell-inner",style:b?{position:"relative",zIndex:2,display:"inlineBlock",width:"24px",height:"22px",lineHeight:"22px",backgroundColor:"#1890ff",color:"#fff",margin:"auto",borderRadius:"2px",transition:"background 0.3s, border 0.3s"}:{},children:j.date()})},[s]),x=Object(v.useCallback)(function(j){var b=j.value,o=j.onClose,l=function(){o(),D(s.filter(function(L){return L!==b}))};return Object(t.jsx)(mt.a,{onClose:l,closable:!0,children:k()(b).format(y)})},[s]),F=function(){return{disabledMinutes:function(){return Array.from({length:59},function(o,l){return l+1})}}};return Object(t.jsx)(vt.a,Object(a.a)(Object(a.a)({},Y),{},{allowClear:!0,mode:"multiple",value:s,onClear:function(){return D&&D([])},tagRender:x,open:$,onFocus:function(){return r(!0)},onBlur:function(){return r(!1)},dropdownMatchSelectWidth:!1,dropdownClassName:"multipleDropdownClassName",dropdownStyle:{height:"310px",width:"335px",minWidth:"0"},dropdownRender:function(){return Object(t.jsx)(st.a,{disabledDate:function(o){var l=new Date;return o&&o.valueOf()<=l.setDate(l.getDate()-1)},showTime:{format:"HH"},disabledTime:F,onChange:function(o){return o&&M(o)},open:!0,dateRender:u,style:{visibility:"hidden"},getPopupContainer:function(o){var l=o.parentNode;return l},defaultValue:k()("00:00","HH")})}}))},pt=xt,tt=e("c+yx"),ot=e("Gn8c"),et;(function(h){h.draft="draft",h.published="published",h.archived="archived"})(et||(et={}));var Mt=e("eFHa"),Ct=e("4f6N"),Et=e("CiB2"),Vt=e("qbNl"),Pt=e("JBPa"),Ht=e("5Dmo"),Dt=e("3S7+"),Gt=e("Awhp"),it=e("KrTs"),yt=e("Qiat"),Tt=function(i){var O=i.data,s=i.onChange,D=Object(v.useState)(!1),g=Object(K.a)(D,2),y=g[0],J=g[1],Y=Object(v.useState)(k()(O.date)),c=Object(K.a)(Y,2),U=c[0],$=c[1],r=Object(v.useCallback)(function(M){$(k()(M)),J(!0),Object(_.a)(O.consultation_term_id,M).then(function(u){u.success?(T.b.success(u.message),s(U)):T.b.error(u.message)}).catch(function(u){return T.b.error(u.toString())}).finally(function(){return J(!1)})},[U]);return Object(t.jsx)(q.a.Fragment,{children:Object(t.jsx)(st.a,{disabledDate:function(u){var x=new Date;return u&&u.valueOf()<=x.setDate(x.getDate()-1)},disabled:y,value:U,showTime:{format:"HH"},onChange:function(u){u&&r(u.toISOString())}})})},lt={reported:"warning",reject:"error",approved:"success"},St=[{title:Object(t.jsx)(n.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"consultation_term_id",hideInSearch:!0,sorter:!0,width:"80px"},{title:Object(t.jsx)(n.a,{id:"user",defaultMessage:"user"}),dataIndex:"user",render:function(i,O){var s,D,g;return"".concat((s=O.user)===null||s===void 0?void 0:s.first_name," ").concat((D=O.user)===null||D===void 0?void 0:D.last_name," ").concat((g=O.user)===null||g===void 0?void 0:g.email)},sorter:!0},{title:Object(t.jsx)(n.a,{id:"date",defaultMessage:"date"}),dataIndex:"date",sorter:!0,render:function(i,O){return k()(O.date).format("yyyy-MM-DD HH:mm")}},{title:Object(t.jsx)(n.a,{id:"status",defaultMessage:"status"}),dataIndex:"status",sorter:!0,render:function(i,O){return Object(t.jsx)(it.a,{status:lt[O.status],text:Object(t.jsx)(n.a,{id:O.status})})}}],It=function(i){var O=i.consultation,s=Object(v.useState)(!1),D=Object(K.a)(s,2),g=D[0],y=D[1],J=Object(v.useState)([]),Y=Object(K.a)(J,2),c=Y[0],U=Y[1],$=Object(n.l)(),r=Object(v.useCallback)(function(){y(!0),Object(_.f)(O).then(function(u){u.success&&U(u.data)}).catch(function(){T.b.error(Object(t.jsx)(n.a,{id:"error",defaultMessage:"error"}))}).finally(function(){return y(!1)})},[O]);Object(v.useEffect)(function(){r()},[O]);var M=Object(v.useCallback)(function(u){return Object(t.jsx)("ul",{className:"events",children:c.map(function(x){if(u.format("yyyy-MM-DD")===k()(x.date).format("yyyy-MM-DD")){var F,j,b,o;return Object(t.jsx)("li",{children:Object(t.jsx)(it.a,{status:lt[x.status],text:Object(t.jsx)(q.a.Fragment,{children:Object(t.jsxs)(Dt.a,{title:"".concat((F=x.user)===null||F===void 0?void 0:F.first_name," ").concat((j=x.user)===null||j===void 0?void 0:j.last_name," ").concat((b=x.user)===null||b===void 0?void 0:b.email),children:[Object(t.jsx)("small",{children:k()(x.date).format("HH:mm")})," ",(o=x.user)===null||o===void 0?void 0:o.email]})})})},x.consultation_term_id)}return null})})},[c]);return Object(t.jsxs)(q.a.Fragment,{children:[g&&Object(t.jsx)(P.a,{}),Object(t.jsx)(Pt.a,{dateCellRender:M}),g?Object(t.jsx)(P.a,{}):Object(t.jsx)(yt.a,{headerTitle:$.formatMessage({id:"Consultations",defaultMessage:"Consultations"}),loading:g,rowKey:"consultation_term_id",search:!1,request:function(){var u=Object(G.a)(Object(S.a)().mark(function x(F,j){var b,o;return Object(S.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return Object(Et.a)(F),b=j&&Object.entries(j)[0],o=c,b&&(o=Object(tt.i)(o,b[0],b[1]!=="ascend")),d.abrupt("return",{data:o,total:o.length,success:!0});case 5:case"end":return d.stop()}},x)}));return function(x,F){return u.apply(this,arguments)}}(),columns:[].concat(St,[{title:Object(t.jsx)(n.a,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",width:"20%",render:function(x,F){return[Object(t.jsx)(Tt,{data:F,onChange:function(){return r()}},"change_date")]}}])})]})},At=It,Rt=e("q34N"),Ut=e("5RzD"),Bt=e("CiXh"),Jt=e("J+hL"),V;(function(h){h.ATTRIBUTES="attributes",h.PRODUCT="product",h.MEDIA="media",h.CATEGORIES="categories",h.BRANDING="branding",h.USER_SUBMISSION="user_submission",h.CALENDAR="calendar"})(V||(V={}));var Ft=function(){var i=Object(n.l)(),O=Object(bt.l)(),s=O.consultation,D=O.tab,g=D===void 0?"attributes":D,y=s==="new",J=Object(v.useState)(),Y=Object(K.a)(J,2),c=Y[0],U=Y[1],$=Object(Mt.a)(),r=$.manageCourseEdit,M=$.setManageCourseEdit,u=$.validateCourseEdit,x=R.a.useForm(),F=Object(K.a)(x,1),j=F[0],b=Object(v.useCallback)(Object(G.a)(Object(S.a)().mark(function l(){var d,L;return Object(S.a)().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,Object(_.e)(Number(s));case 2:d=Q.sent,d.success&&(g==="attributes"&&u(d.data),U(Object(a.a)(Object(a.a)({},d.data),{},{author_id:d.data.author&&d.data.author.id,categories:(L=d.data.categories)===null||L===void 0?void 0:L.map(tt.a)})));case 4:case"end":return Q.stop()}},l)})),[s]);Object(v.useEffect)(function(){if(y){U({name:"new"});return}b()},[s]);var o=Object(v.useMemo)(function(){return{onValuesChange:function(){M(Object(a.a)(Object(a.a)({},r),{},{valuesChanged:!0}))},onFinish:function(){var l=Object(G.a)(Object(S.a)().mark(function L(dt){var Q,w;return Object(S.a)().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!r.disableEdit){W.next=3;break}return M({showModal:!0,disableEdit:!0,clicked:!1}),W.abrupt("return");case 3:if(Q=Object(a.a)(Object(a.a)({},dt),{},{image_url:c&&c.image_url,image_path:c&&c.image_url&&Object(tt.k)(c.image_url),logotype_url:c&&c.logotype_url,logotype_path:c&&c.logotype_path&&Object(tt.k)(c.logotype_path)}),!y){W.next=11;break}return W.next=7,Object(_.c)(Q);case 7:w=W.sent,w.success&&n.f.push("/other/consultations/".concat(w.data.id)),W.next=15;break;case 11:return W.next=13,Object(_.g)(Number(s),Q);case 13:w=W.sent,w.success&&(u(w.data),n.f.push("/other/consultations/".concat(w.data.id,"/").concat(g)));case 15:T.b.success(w.message),M(Object(a.a)(Object(a.a)({},r),{},{showConfirmModal:!1,loading:!1,valuesChanged:!1}));case 17:case"end":return W.stop()}},L)}));function d(L){return l.apply(this,arguments)}return d}(),initialValues:c}},[c,s,g,r]);return c?Object(t.jsxs)(jt.a,{title:y?Object(t.jsx)(n.a,{id:"consultation"}):Object(t.jsx)(n.a,{id:"consultations.edit"}),header:{breadcrumb:{routes:[{path:"other/consultations",breadcrumbName:i.formatMessage({id:"menu.Other activities.Consultations"})},{path:String(s),breadcrumbName:i.formatMessage({id:"form"})},{path:"/",breadcrumbName:String(c.name)},{path:String(g),breadcrumbName:String(c.name)}]}},children:[Object(t.jsxs)(z.a,{tabs:{type:"card",activeKey:g,onChange:function(d){d!==V.ATTRIBUTES&&r.valuesChanged?M(Object(a.a)(Object(a.a)({},r),{},{showConfirmModal:!0})):n.f.push("/other/consultations/".concat(s,"/").concat(d))}},children:[Object(t.jsxs)(z.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"attributes"}),children:[r.disableEdit&&Object(t.jsx)(N.a,{closable:!0,style:{marginBottom:"20px"},type:"warning",message:Object(t.jsx)(n.a,{id:"course_edit_warning_message",defaultMessage:"course_edit_warning_message"}),action:Object(t.jsx)(m.a,{onClick:function(){return M({showModal:!0,disableEdit:!0,clicked:!0})},type:"primary",children:Object(t.jsx)(n.a,{id:"questionnaire.submit",defaultMessage:"questionnaire.submit"})})}),Object(t.jsx)(Ct.a,{visible:r.showModal,setManage:M}),Object(t.jsxs)(R.a,Object(a.a)(Object(a.a)({},o),{},{form:j,children:[Object(t.jsxs)(R.a.Group,{children:[Object(t.jsx)(at.a,{width:"md",name:"name",label:Object(t.jsx)(n.a,{id:"name"}),tooltip:Object(t.jsx)(n.a,{id:"name"}),placeholder:i.formatMessage({id:"name",defaultMessage:"name"}),required:!0,disabled:r.disableEdit}),Object(t.jsx)(at.a,{width:"sm",name:"duration",label:Object(t.jsx)(n.a,{id:"duration"}),tooltip:Object(t.jsx)(n.a,{id:"consultations.duration_tooltip"}),placeholder:i.formatMessage({id:"duration",defaultMessage:"duration"}),disabled:r.disableEdit}),Object(t.jsx)(ct.a,{name:"status",width:"sm",label:Object(t.jsx)(n.a,{id:"status"}),tooltip:Object(t.jsx)(n.a,{id:"status_consultation_tooltip"}),valueEnum:{draft:i.formatMessage({id:"draft",defaultMessage:"draft"}),published:i.formatMessage({id:"published",defaultMessage:"published"}),archived:i.formatMessage({id:"archived",defaultMessage:"archived"})},initialValue:et.draft,placeholder:i.formatMessage({id:"status"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"select"})}],disabled:r.disableEdit})]}),Object(t.jsxs)(R.a.Group,{children:[Object(t.jsx)(nt.a,{width:"sm",name:"active_from",label:Object(t.jsx)(n.a,{id:"active_from"}),tooltip:Object(t.jsx)(n.a,{id:"active_from"}),placeholder:i.formatMessage({id:"active_from",defaultMessage:"active_from"}),disabled:r.disableEdit}),Object(t.jsx)(nt.a,{width:"sm",name:"active_to",label:Object(t.jsx)(n.a,{id:"active_to"}),tooltip:Object(t.jsx)(n.a,{id:"active_to"}),placeholder:i.formatMessage({id:"active_to",defaultMessage:"active_to"}),disabled:r.disableEdit}),Object(t.jsx)(R.a.Item,{name:"author_id",label:Object(t.jsx)(n.a,{id:"tutor"}),tooltip:Object(t.jsx)(n.a,{id:"tutor_consultation_tooltip"}),valuePropName:"value",required:!0,children:Object(t.jsx)(Ot.a,{})})]}),Object(t.jsx)(R.a.Group,{children:Object(t.jsx)(R.a.Item,{name:"description",label:Object(t.jsx)(n.a,{id:"description"}),tooltip:Object(t.jsx)(n.a,{id:"description_tooltip"}),valuePropName:"value",required:!0,children:Object(t.jsx)(ut.a,{directory:"consultation/".concat(s,"/wysiwyg")})})}),Object(t.jsx)(R.a.Group,{children:Object(t.jsx)(R.a.Item,{valuePropName:"value",name:"proposed_terms",tooltip:Object(t.jsx)(n.a,{id:"proposed_terms_tooltip"}),label:Object(t.jsx)(n.a,{id:"consultations.proposed_terms"}),children:Object(t.jsx)(pt,{})})})]}))]},V.ATTRIBUTES),!y&&Object(t.jsx)(z.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"product"}),disabled:r.disableEdit,children:s&&Object(t.jsx)(Rt.a,{type:"line",productable:{class_type:"App\\Models\\Consultation",class_id:s,name:String(c.name),quantity:1}})},V.PRODUCT),!y&&Object(t.jsx)(z.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"media"}),disabled:r.disableEdit,children:Object(t.jsx)(R.a,Object(a.a)(Object(a.a)({},o),{},{children:Object(t.jsx)(ot.a,{folder:"consultation/".concat(s),title:"image",action:"/api/admin/consultations/".concat(s),src_name:"image_url",form_name:"image",getUploadedSrcField:function(d){return d.file.response.data.image_url},setPath:function(d){return U(function(L){return Object(a.a)(Object(a.a)({},L),d)})}})}))},V.MEDIA),!y&&Object(t.jsx)(z.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"categories"}),disabled:r.disableEdit,children:Object(t.jsx)(A.a,{children:Object(t.jsx)(f.a,{span:12,children:Object(t.jsx)(R.a,Object(a.a)(Object(a.a)({},o),{},{children:Object(t.jsx)(R.a.Item,{label:Object(t.jsx)(n.a,{id:"categories"}),name:"categories",valuePropName:"value",children:Object(t.jsx)(ft.a,{})})}))})})},V.CATEGORIES)," ",!y&&Object(t.jsx)(z.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"branding"}),disabled:r.disableEdit,children:Object(t.jsx)(R.a,Object(a.a)(Object(a.a)({},o),{},{children:Object(t.jsx)(ot.a,{folder:"consultation/".concat(s),title:i.formatMessage({id:"logotype"}),action:"/api/admin/consultations/".concat(s),src_name:"logotype_url",form_name:"logotype",getUploadedSrcField:function(d){return d.file.response.data.logotype_url},setPath:function(d){return U(function(L){return Object(a.a)(Object(a.a)({},L),d)})}})}))},V.BRANDING)," ",!y&&Object(t.jsx)(z.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"user_submission"}),disabled:r.disableEdit,children:Object(t.jsx)(A.a,{children:Object(t.jsx)(f.a,{span:12,children:s&&Object(t.jsx)(Ut.a,{id:Number(s),type:"App\\Models\\Consultation"})})})},V.USER_SUBMISSION),!y&&Object(t.jsx)(z.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"consultations.calendar"}),children:Object(t.jsx)(At,{consultation:Number(s)})},V.CALENDAR)]}),Object(t.jsx)(Bt.a,{open:!!r.showConfirmModal,onOk:function(){M(Object(a.a)(Object(a.a)({},r),{},{loading:!0})),j.submit()},onCancel:function(){M(Object(a.a)(Object(a.a)({},r),{},{showConfirmModal:!1}))},loading:!!r.loading})]}):Object(t.jsx)(P.a,{})},Yt=C.default=Ft}}]);

//# sourceMappingURL=p__Consultations__form.0ec66098.async.js.map