"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[82],{7418:function(Ue,te,t){var ae=t(52677),l=t.n(ae),re=t(5574),i=t.n(re),z=t(75081),d=t(68962),P=t(67294),Z=t(94116),Y=t(85893),m=function D(g){return g.subcategories&&g.subcategories.length?{title:g.name,key:g.id,children:g.subcategories.map(function(E){return D(E)})}:{title:g.name,key:g.id}},o=function(g){var E=g.value,u=g.onChange,U=g.multiple,y=U===void 0?!0:U,w=(0,P.useState)([]),M=i()(w,2),v=M[0],A=M[1];(0,P.useEffect)(function(){(0,Z.CL)().then(function(L){L.success&&A(L.data)})},[]);var S=(0,P.useMemo)(function(){return v.map(function(L){return m(L)})},[v]);return v.length===0?(0,Y.jsx)(z.Z,{}):(0,Y.jsx)(d.Z,{multiple:y,checkable:!0,checkStrictly:!0,defaultExpandAll:!0,style:{width:"100%"},checkedKeys:E,onCheck:function(x){if(l()(x)==="object"&&!Array.isArray(x)&&x.checked){var F=x.checked;return u&&Array.isArray(F)&&u(F)}},treeData:S,disabled:v.length===0})};te.Z=o},25387:function(Ue,te,t){t.d(te,{P:function(){return y}});var ae=t(97857),l=t.n(ae),re=t(9783),i=t.n(re),z=t(5574),d=t.n(z),P=t(13769),Z=t.n(P),Y=t(34994),m=t(96365),o=t(67294),D=t(80854),g=t(85893),E=["name","form","onChange"],u=["label","defaultValue"],U=function(M,v){return M===null?"":(M/100).toFixed(v!=null?v:0)},y=function(M){var v,A=M.name,S=M.form,L=M.onChange,x=Z()(M,E),F=x.label,s=x.defaultValue,a=s===void 0?0:s,j=Z()(x,u),I=(0,o.useState)({dollars:"",cents:null}),r=d()(I,2),h=r[0],Se=r[1],Re=(0,D.useModel)("@@initialState"),Te=Re.initialState,Ce=Te==null||(v=Te.config)===null||v===void 0||(v=v.find(function(R){var e=R.group,le=R.key;return e==="currencies"&&le==="default"}))===null||v===void 0?void 0:v.value,J=function(e){var le=e.target.value,Ae=le.replace(/[^0-9.]/,""),Fe=parseFloat(Ae),Ie=Math.round(Fe*100);Se({cents:Ie||a,dollars:le.trim()})},T=h.cents===null?"":U(h.cents,2);(0,o.useEffect)(function(){var R=S.getFieldValue(A)?U(S.getFieldValue(A),2):"";Se({dollars:R,cents:+R*100||a})},[S,A]),(0,o.useEffect)(function(){S&&A&&S.setFieldsValue(i()({},A,Number.isNaN(h.cents)?null:h.cents)),L&&L(h.cents)},[h]);var K=l()(l()({},F),{},{values:l()(l()({},F==null?void 0:F.values),{},{currency:Ce?"(".concat(Ce,")"):""})});return(0,g.jsx)(Y.A.Item,l()(l()({name:A,initialValue:h.dollars,label:F?(0,g.jsx)(D.FormattedMessage,l()({},K)):void 0},j),{},{children:(0,g.jsx)(m.Z,{value:h.dollars,onChange:J,onBlur:function(){Se(function(e){return l()(l()({},e),{},{dollars:T!=="NaN"?T:""})})}})}))}},39470:function(Ue,te,t){var ae=t(5574),l=t.n(ae),re=t(64532),i=t(83863),z=t(67294),d=t(85893),P=i.default.Option,Z=function(m){var o=m.value,D=m.onChange,g=(0,z.useState)([]),E=l()(g,2),u=E[0],U=E[1];return(0,z.useEffect)(function(){(0,re.a)().then(function(y){return U(y.data)})},[]),(0,d.jsx)(i.default,{mode:"tags",showSearch:!0,style:{width:"100%"},placeholder:"Select a Tag",optionFilterProp:"children",onChange:D,value:o,children:u.map(function(y){return(0,d.jsx)(P,{value:y.title,children:y.title},y.title)})})};te.Z=Z},54434:function(Ue,te,t){t.d(te,{ZP:function(){return Ce}});var ae=t(97857),l=t.n(ae),re=t(15009),i=t.n(re),z=t(99289),d=t.n(z),P=t(5574),Z=t.n(P),Y=t(952),m=t(67294),o=t(80854),D=t(66309),g=t(14726),E=t(86738),u=t(83062),U=t(2453);function y(J,T){return w.apply(this,arguments)}function w(){return w=d()(i()().mark(function J(T,K){return i()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/api/admin/user-submissions",l()({method:"GET",params:T},K||{})));case 1:case"end":return e.stop()}},J)})),w.apply(this,arguments)}function M(J,T){return v.apply(this,arguments)}function v(){return v=d()(i()().mark(function J(T,K){return i()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/api/admin/user-submissions",l()({method:"POST",headers:{"Content-Type":"application/json"},data:T},K||{})));case 1:case"end":return e.stop()}},J)})),v.apply(this,arguments)}function A(J,T){return S.apply(this,arguments)}function S(){return S=d()(i()().mark(function J(T,K){return i()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.request)("/api/admin/user-submissions/".concat(T),l()({method:"DELETE",headers:{"Content-Type":"application/json"}},K||{})));case 1:case"end":return e.stop()}},J)})),S.apply(this,arguments)}var L=t(66419),x=t(51042),F=t(82061),s=t(16894),a=t(37476),j=t(5966),I=t(75842),r=t(85893),h=function(T){var K=(0,o.useIntl)(),R=T.visible,e=T.onVisibleChange,le=T.onFinish,Ae=T.id,Fe=I.Z.useForm(),Ie=Z()(Fe,1),de=Ie[0];return(0,r.jsx)(a.Y,{form:de,title:K.formatMessage({id:"email",defaultMessage:"email"}),width:"30vw",visible:R,onVisibleChange:e,onFinish:le,children:(0,r.jsx)(Y.ZP.Group,{children:(0,r.jsx)(j.Z,{width:"md",name:"email",label:(0,r.jsx)(o.FormattedMessage,{id:"email"}),tooltip:(0,r.jsx)(o.FormattedMessage,{id:"email_tooltip"}),placeholder:K.formatMessage({id:"email",defaultMessage:"email"}),required:!0})})})},Se=h,Re=[{title:(0,r.jsx)(o.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,r.jsx)(o.FormattedMessage,{id:"email",defaultMessage:"email"}),dataIndex:"email",hideInSearch:!1,width:"70%",sorter:!0},{title:(0,r.jsx)(o.FormattedMessage,{id:"status",defaultMessage:"status"}),dataIndex:"status",hideInSearch:!0,sorter:!0,valueEnum:{sent:(0,r.jsx)(D.Z,{color:"processing",children:(0,r.jsx)(o.FormattedMessage,{id:"sent"})}),assigned:(0,r.jsx)(D.Z,{color:"default",children:(0,r.jsx)(o.FormattedMessage,{id:"assigned"})}),accepted:(0,r.jsx)(D.Z,{color:"success",children:(0,r.jsx)(o.FormattedMessage,{id:"accepted"})}),rejected:(0,r.jsx)(D.Z,{color:"error",children:(0,r.jsx)(o.FormattedMessage,{id:"rejected"})})}}],Te=function(T){var K=T.id,R=T.type,e=(0,o.useIntl)(),le=(0,m.useRef)(),Ae=(0,m.useState)(!1),Fe=Z()(Ae,2),Ie=Fe[0],de=Fe[1],Ve=Y.ZP.useForm(),Be=Z()(Ve,1),Ne=Be[0],we=(0,m.useState)(!1),$e=Z()(we,2),Ge=$e[0],Le=$e[1],Ye=(0,m.useCallback)(function(){var pe=d()(i()().mark(function b($){var ie;return i()().wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return de(!0),he.next=3,A(Number($));case 3:(ie=le.current)===null||ie===void 0||ie.reload(),de(!1);case 5:case"end":return he.stop()}},b)}));return function(b){return pe.apply(this,arguments)}}(),[K,R]);return(0,r.jsxs)(m.Fragment,{children:[(0,r.jsx)(s.ZP,{defaultSize:"small",loading:Ie,search:{layout:"vertical"},headerTitle:e.formatMessage({id:"user_submission",defaultMessage:"user_submission"}),actionRef:le,toolBarRender:function(){return[(0,r.jsxs)(g.ZP,{type:"primary",onClick:function(){return Le(!0)},children:[(0,r.jsx)(x.Z,{})," ",(0,r.jsx)(o.FormattedMessage,{id:"email_to_add",defaultMessage:"email_to_add"})]},"primary")]},rowKey:"id",request:function(){var pe=d()(i()().mark(function b($,ie){var fe,he,H;return i()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return fe=$.email,he=$.pageSize,H=$.current,de(!0),_.abrupt("return",y(l()({email:fe,per_page:he,page:H,morphable_type:R,morphable_id:K},(0,L.di)(ie,"created_at"))).then(function(p){return de(!1),p.success?{data:p.data,total:p.data.length,success:!0}:p.success?[]:{data:[],total:0,success:!1}}));case 3:case"end":return _.stop()}},b)}));return function(b,$){return pe.apply(this,arguments)}}(),columns:[].concat(Re,[{title:(0,r.jsx)(o.FormattedMessage,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",width:"10%",render:function(b,$){return[(0,r.jsx)(E.Z,{title:(0,r.jsx)(o.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:function(){return Ye($.id)},okText:(0,r.jsx)(o.FormattedMessage,{id:"yes"}),cancelText:(0,r.jsx)(o.FormattedMessage,{id:"no"}),children:(0,r.jsx)(u.Z,{title:(0,r.jsx)(o.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,r.jsx)(g.ZP,{type:"primary",icon:(0,r.jsx)(F.Z,{}),danger:!0})})},"delete")]}}])})," ",(0,r.jsx)(Se,{visible:Ge,onVisibleChange:function(b){return b===!1&&Le(!1)},onFinish:function(){var pe=d()(i()().mark(function b($){var ie,fe;return i()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return de(!0),H.prev=1,H.next=4,M(l()(l()({},$),{},{morphable_id:K,morphable_type:R}));case 4:ie=H.sent,ie.success&&(Ne.resetFields(),(fe=le.current)===null||fe===void 0||fe.reload(),de(!1),Le(!1)),H.next=13;break;case 8:H.prev=8,H.t0=H.catch(1),Le(!1),U.ZP.error((0,r.jsx)(o.FormattedMessage,{id:"error",defaultMessage:"error"})),de(!1);case 13:case"end":return H.stop()}},b,null,[[1,8]])}));return function(b){return pe.apply(this,arguments)}}()})]})},Ce=Te},19411:function(Ue,te,t){t.d(te,{ZP:function(){return g}});var ae=t(15009),l=t.n(ae),re=t(99289),i=t.n(re),z=t(17578),d=t(2800),P=t.n(d),Z=t(67294),Y=t(80854),m=t(85893),o=function(u){var U=u.attrs,y=U.href,w=y.split("/").pop();return(0,m.jsx)("p",{children:(0,m.jsx)("a",{rel:"noreferrer",href:y,target:"_blank",children:w})})},D=function(u){var U=u.value,y=u.onChange,w=u.directory,M=w===void 0?"/wysiwyg":w,v=(0,Y.useIntl)();return(0,m.jsx)("div",{className:"form-wysiwyg-markdown",children:(0,m.jsx)(P(),{excludeBlockMenuItems:["Sketch"],embeds:[{matcher:function(){return!0},component:o}],uploadImage:function(){var A=i()(l()().mark(function S(L){var x,F;return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,z.ws)(L,M);case 2:if(x=a.sent,!x.success){a.next=8;break}if(!L.type.includes("image/")){a.next=7;break}return F=x.data[0].name.includes("/")?x.data[0].name:"".concat(M).concat(x.data[0].name),a.abrupt("return",(0,z.pV)(F,1e3));case 7:return a.abrupt("return",x.data[0].url);case 8:throw new Error("Error while uploading");case 9:case"end":return a.stop()}},S)}));return function(S){return A.apply(this,arguments)}}(),defaultValue:U||"",onChange:function(S){return y&&y(S())},placeholder:v.formatMessage({id:"wysiwyg_placeholder"})})})},g=D},50082:function(Ue,te,t){t.d(te,{Z:function(){return H}});var ae=t(19632),l=t.n(ae),re=t(15009),i=t.n(re),z=t(97857),d=t.n(z),P=t(99289),Z=t.n(P),Y=t(5574),m=t.n(Y),o=t(52677),D=t.n(o),g=t(67541),E=t(26271),u=t(952),U=t(5966),y=t(86615),w=t(52688),M=t(31199),v=t(2453),A=t(75081),S=t(96365),L=t(66309),x=t(71230),F=t(15746),s=t(67294),a=t(80854),j=t(7418),I=t(23535),r=t(44837),h=t(25387),Se=t(81424),Re=t(39470),Te=t(31472),Ce=t(40658),J=t(78957),T=t(83062),K=t(14726),R=t(83863),e=t(85893),le=function(_){var p=_.value,ge=_.onChange,G=_.multiple,Ze=G===void 0?!1:G,je=_.params,C=(0,s.useState)([]),W=m()(C,2),ue=W[0],ve=W[1],f=(0,s.useState)(!1),Ee=m()(f,2),k=Ee[0],c=Ee[1],se=(0,s.useState)([]),Q=m()(se,2),B=Q[0],me=Q[1],N=(0,s.useRef)(),q=(0,s.useCallback)(function(){c(!0),N.current&&N.current.abort(),N.current=new AbortController,(0,Ce.zd)(je,{signal:N.current.signal}).then(function(X){X.success&&ve(X.data),c(!1)}).catch(function(){return c(!1)})},[]);return(0,s.useEffect)(function(){var X=new AbortController;if(p){var De=Array.isArray(p)?p:[p],xe=De.map(function(be){return D()(be)==="object"?Number(be.id):Number(be)});me(xe)}return function(){X.abort()}},[p]),(0,e.jsx)(R.default,{onFocus:function(){return q()},allowClear:!0,style:{width:"100%",minWidth:"400px"},value:B,onChange:ge,mode:Ze?"multiple":void 0,showSearch:!0,placeholder:(0,e.jsx)(a.FormattedMessage,{id:"select_template",defaultMessage:"Select a template"}),optionFilterProp:"children",filterOption:function(De,xe){if(xe&&xe.children){var be;return(xe==null||(be=xe.children)===null||be===void 0?void 0:be.toString().toLowerCase().indexOf(De&&De.toLowerCase()||""))>=0}return!1},notFoundContent:k?(0,e.jsx)(A.Z,{size:"small"}):null,children:ue.map(function(X){return(0,e.jsxs)(R.default.Option,{value:X.id,children:[X.name," ",(0,e.jsxs)("small",{children:[(0,e.jsx)(a.FormattedMessage,{id:X.channel.split("\\").pop()}),":",X.event&&(0,e.jsx)(a.FormattedMessage,{id:X.event.split("\\").pop()})]})]},X.id)})})},Ae=null,Fe=function(_){var p=_.productId,ge=(0,s.useState)(!1),G=m()(ge,2),Ze=G[0],je=G[1],C=(0,s.useState)(),W=m()(C,2),ue=W[0],ve=W[1],f=(0,a.useIntl)(),Ee=(0,s.useCallback)(function(){je(!0),typeof ue=="number"&&(0,Ce.zB)(Number(ue),p).then(function(k){k.success?v.ZP.success(k.message):v.ZP.error(k.message)}).catch(function(k){return v.ZP.error(k.toString())}).finally(function(){return je(!1)})},[ue,p]);return(0,e.jsxs)(J.Z,{children:[(0,e.jsx)(le,{params:{event:Te.fn.ManuallyTriggeredEvent},multiple:!1,value:ue,onChange:function(c){return ve(c)}}),(0,e.jsx)(T.Z,{title:f.formatMessage({id:"generate_pdf_for_products_tooltip"}),children:(0,e.jsx)(K.ZP,{loading:Ze,onClick:function(){return Ee()},disabled:!ue,children:(0,e.jsx)(a.FormattedMessage,{id:"generate"})})})]})},Ie=Fe,de=t(54434),Ve=t(19411),Be=t(66419),Ne=t(64317),we=t(16894),$e=t(44167),Ge=t(82061),Le=[{title:(0,e.jsx)(a.FormattedMessage,{id:"name",defaultMessage:"name"}),dataIndex:"name"},{title:(0,e.jsx)(a.FormattedMessage,{id:"email",defaultMessage:"email"}),dataIndex:"email"}],Ye=function(_){var p=_.id,ge=(0,a.useIntl)(),G=(0,s.useRef)(),Ze=(0,s.useState)(!1),je=m()(Ze,2),C=je[0],W=je[1],ue=u.ZP.useForm(),ve=m()(ue,1),f=ve[0],Ee=(0,s.useCallback)(function(){var c=Z()(i()().mark(function se(Q){var B;return i()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return W(!0),N.next=3,(0,r.fw)(Number(p),{user_id:Q.user_id});case 3:f.resetFields(),(B=G.current)===null||B===void 0||B.reload(),W(!1);case 6:case"end":return N.stop()}},se)}));return function(se){return c.apply(this,arguments)}}(),[p]),k=(0,s.useCallback)(function(){var c=Z()(i()().mark(function se(Q){var B;return i()().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return W(!0),N.next=3,(0,r.q5)(Number(p),{user_id:Q});case 3:(B=G.current)===null||B===void 0||B.reload(),W(!1);case 5:case"end":return N.stop()}},se)}));return function(se){return c.apply(this,arguments)}}(),[p]);return(0,e.jsxs)(s.Fragment,{children:[(0,e.jsx)(u.ZP,{layout:"inline",onFinish:Ee,form:f,labelWrap:!0,children:(0,e.jsx)(u.ZP.Group,{children:(0,e.jsx)(u.ZP.Item,{name:"user_id",label:(0,e.jsx)(a.FormattedMessage,{id:"users"}),valuePropName:"value",children:(0,e.jsx)($e.Z,{})})})}),(0,e.jsx)(we.ZP,{defaultSize:"small",loading:C,search:!1,headerTitle:ge.formatMessage({id:"users",defaultMessage:"Users"}),actionRef:G,rowKey:"id",request:Z()(i()().mark(function c(){return i()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return W(!0),Q.abrupt("return",(0,r.wv)(Number(p)).then(function(B){return W(!1),B.success&&B.data.users?{data:B.data.users,total:B.data.users.length,success:!0}:B.success?[]:{data:[],total:0,success:!1}}));case 2:case"end":return Q.stop()}},c)})),columns:[].concat(Le,[{title:(0,e.jsx)(a.FormattedMessage,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",width:"10%",render:function(se,Q){return[(0,e.jsx)(T.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(K.ZP,{type:"primary",icon:(0,e.jsx)(Ge.Z,{}),danger:!0,onClick:function(){return k(Q.id)}})},"delete")]}}])})]})},pe=Ye,b=function(V){return V.SINGLE="single",V.BUNDLE="bundle",V.SUBSCRIPTION="subscription",V.SUBSCRIPTION_ALL_IN="subscription-all-in",V}(b||{}),$=function(V){return V.DAILY="daily",V.MONTHLY="monthly",V.YEARLY="yearly",V}($||{}),ie=function(_){return _.map(function(p){return{class:p.productable_type,id:Number(p.productable_id),name:p.name,quantity:p.quantity}})},fe=function(_){var p=Array.isArray(_)?_:[_],ge=p.map(function(G){return D()(G)==="object"?G:{id:parseInt(G.split(":")[1]),class:G.split(":")[0],name:G.split(":")[2]}});return ge},he=function(_){var p,ge=_.tab,G=ge===void 0?"attributes":ge,Ze=_.onTabChange,je=_.id,C=_.productable,W=_.onProductSaved,ue=_.type,ve=ue===void 0?"card":ue,f=(0,a.useIntl)(),Ee=(0,s.useState)(je),k=m()(Ee,2),c=k[0],se=k[1],Q=(0,s.useState)([]),B=m()(Q,2),me=B[0],N=B[1],q=(0,s.useMemo)(function(){return c==="new"},[c]),X=(0,s.useState)(!0),De=m()(X,2),xe=De[0],be=De[1],lt=(0,s.useState)(null),Je=m()(lt,2),ke=Je[0],it=Je[1],ut=(0,s.useState)({}),ot=m()(ut,2),dt=ot[1],mt=(0,s.useCallback)(function(){return dt({})},[]),ct=u.ZP.useForm(),pt=m()(ct,1),_e=pt[0],ft=(0,a.useModel)("@@initialState"),ze=ft.initialState,We=ze==null||(p=ze.config)===null||p===void 0||(p=p.find(function(O){var n=O.group,ee=O.key;return n==="currencies"&&ee==="default"}))===null||p===void 0?void 0:p.value,ht=(0,s.useState)(!1),qe=m()(ht,2),et=qe[0],tt=qe[1],gt=(0,s.useState)(b.BUNDLE),at=m()(gt,2),He=at[0],rt=at[1],vt=(0,s.useState)(!1),st=m()(vt,2),Ke=st[0],nt=st[1];(0,s.useEffect)(function(){C&&C.class_id&&C.class_type&&((0,r.nS)({productable_id:Number(C.class_id),productable_type:C.class_type}).then(function(O){O.success&&se(O.data.id)}).catch(function(){console.log("err"),se("new")}),N([{class:C.class_type,id:Number(C.class_id),name:C.name}]),_e.setFieldsValue({productables:[{class:C.class_type,id:C.class_id,name:C.name}]}))},[C]);var _t=(0,s.useCallback)(Z()(i()().mark(function O(){var n,ee,Me,Pe,Oe,oe;return i()().wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:if(!(c&&c!=="new")){ye.next=5;break}return ye.next=3,(0,r.wv)(Number(c));case 3:n=ye.sent,n.success&&(Oe=d()(d()({},n.data),{},{categories:(ee=n.data.categories)===null||ee===void 0?void 0:ee.map(Be.i4),tags:(Me=n.data.tags)===null||Me===void 0?void 0:Me.map(function(ce){return(0,Be.ZR)(ce)}),productables:n.data.productables?ie(n.data.productables):[]}),n.data&&n!==null&&n!==void 0&&(Pe=n.data)!==null&&Pe!==void 0&&Pe.productables&&it(n==null||(oe=n.data)===null||oe===void 0||(oe=oe.productables[0])===null||oe===void 0?void 0:oe.productable_type),N(ie(n.data.productables)),_e.setFieldsValue(Oe),tt(n.data.type===b.BUNDLE),rt(n.data.type),nt(!!n.data.has_trial));case 5:be(!1);case 6:case"end":return ye.stop()}},O)})),[c]);(0,s.useEffect)(function(){c&&_t()},[c]);var Qe=(0,s.useMemo)(function(){return{onValuesChange:function(n){n.type&&(tt(n.type===b.BUNDLE),rt(n.type)),typeof n.has_trial=="boolean"&&nt(n.has_trial)},onFinish:function(){var O=Z()(i()().mark(function ee(Me){var Pe,Oe,oe,ne;return i()().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:if(Oe=(Pe=Me.related_products)!==null&&Pe!==void 0&&Pe.every(function(Xe){return D()(Xe)==="object"})?Me.related_products.map(function(Xe){return Xe.id}):Me.related_products,oe=d()(d()({},Me),{},{productables:me?fe(me):void 0},Me.related_products?{related_products:Oe}:{}),!q){ce.next=9;break}return ce.next=5,(0,r.ry)(oe);case 5:ne=ce.sent,ne.success&&(W&&W(ne.data),se(ne.data.id),_e.setFieldsValue(ne.data)),ce.next=13;break;case 9:return ce.next=11,(0,r.nM)(Number(c),oe);case 11:ne=ce.sent,ne.success&&W&&W(ne.data);case 13:v.ZP.success(ne.message);case 14:case"end":return ce.stop()}},ee)}));function n(ee){return O.apply(this,arguments)}return n}()}},[c,W,me]);return xe?(0,e.jsx)(A.Z,{}):(0,e.jsxs)(E.ZP,{title:ve==="line"?(0,e.jsx)(a.FormattedMessage,{id:"product_widget_title",defaultMessage:"Product Attibutes"}):null,tooltip:ve==="line"?(0,e.jsx)(a.FormattedMessage,{id:"product_widget_tooltip",defaultMessage:"All attributes below are related only to product"}):null,subTitle:ve==="line"?(0,e.jsx)(a.FormattedMessage,{id:"product_widget_tooltip",defaultMessage:"All attributes below are related only to product"}):null,tabs:{type:ve,activeKey:G,onChange:function(n){return Ze(n)}},children:[(0,e.jsxs)(E.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"attributes"}),children:[(0,e.jsxs)(u.ZP,d()(d()({},Qe),{},{form:_e,omitNil:!1,children:[(0,e.jsxs)(u.ZP.Group,{children:[(0,e.jsx)(U.Z,{width:"md",name:"name",initialValue:q&&C?C.name:void 0,label:(0,e.jsx)(a.FormattedMessage,{id:"name"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"name_tooltip"}),placeholder:f.formatMessage({id:"name",defaultMessage:"name"}),required:!0}),(0,e.jsx)(u.ZP.Item,{shouldUpdate:!0,style:{minWidth:104*3},name:"productables",tooltip:(0,e.jsx)(a.FormattedMessage,{id:"productables_tooltip"}),label:(0,e.jsx)(a.FormattedMessage,{id:"productables"}),valuePropName:"value",children:(0,e.jsx)(g.Z,{multiple:et,disabled:C!==void 0||He===b.SUBSCRIPTION_ALL_IN,onChange:function(n){return N(fe(n))}})})]}),(0,e.jsxs)(u.ZP.Group,{children:[(0,e.jsx)(y.Z.Group,{disabled:C!==void 0,initialValue:c&&c!=="new"?void 0:"single",rules:[{required:!0}],name:"type",label:(0,e.jsx)(a.FormattedMessage,{id:"type"}),options:[{label:f.formatMessage({id:"single",defaultMessage:"single"}),value:b.SINGLE},{label:f.formatMessage({id:"bundle",defaultMessage:"bundle"}),value:b.BUNDLE},{label:f.formatMessage({id:"subscription",defaultMessage:"Subscription"}),value:b.SUBSCRIPTION},{label:f.formatMessage({id:"subscription_all_in",defaultMessage:"Subscription all in"}),value:b.SUBSCRIPTION_ALL_IN}],shouldUpdate:!0}),(0,e.jsx)(w.Z,{name:"purchasable",label:(0,e.jsx)(a.FormattedMessage,{id:"purchasable"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"purchasable_tooltip"})})]}),(0,e.jsxs)(u.ZP.Group,{title:(0,e.jsx)(a.FormattedMessage,{id:"prices"}),children:[(0,e.jsx)(h.P,{form:_e,width:"xs",name:"price",label:{id:"price"},tooltip:(0,e.jsx)(a.FormattedMessage,{id:"price_tooltip"}),placeholder:f.formatMessage({id:"price",defaultMessage:"price"}),fieldProps:{step:1}}),(0,e.jsx)(M.Z,{rules:[{required:!0}],width:"xs",name:"tax_rate",label:(0,e.jsx)(a.FormattedMessage,{id:"tax_rate"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"tax_rate_tooltip"}),placeholder:f.formatMessage({id:"tax_rate",defaultMessage:"tax_rate"}),initialValue:q?23:void 0,min:0,max:100,fieldProps:{step:1,formatter:function(n){return"".concat(n,"%")},parser:function(n){return Number(n?n.replace("%",""):"")}}}),(0,e.jsx)(u.ZP.Item,{shouldUpdate:!0,label:(0,e.jsx)(a.FormattedMessage,{id:"price_brutto",values:{currency:We?"(".concat(We,")"):""}}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"price_brutto_tooltip"}),children:function(n){return(0,e.jsx)(S.Z,{disabled:!0,readOnly:!0,style:{width:"104px"},value:n.getFieldValue("price")?(Math.round(parseInt(n.getFieldValue("price"))*(1+parseInt(n.getFieldValue("tax_rate"))/100))/100).toFixed(2):void 0})}}),(0,e.jsx)(u.ZP.Item,{shouldUpdate:!0,label:(0,e.jsx)(a.FormattedMessage,{id:"tax_value",values:{currency:We?"(".concat(We,")"):""}}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"tax_value_tooltip"}),children:function(n){return(0,e.jsx)(S.Z,{disabled:!0,readOnly:!0,style:{width:"104px"},value:n.getFieldValue("price")?(Math.round(parseInt(n.getFieldValue("price"))*(parseInt(n.getFieldValue("tax_rate"))/100))/100).toFixed(2):void 0})}}),(0,e.jsx)(h.P,{form:_e,width:"xs",name:"price_old",label:{id:"price_old"},tooltip:(0,e.jsx)(a.FormattedMessage,{id:"price_old_tooltip"}),placeholder:f.formatMessage({id:"price",defaultMessage:"price"}),fieldProps:{step:1},defaultValue:null}),(0,e.jsx)(h.P,{form:_e,initialValue:q?null:void 0,width:"xs",name:"extra_fees",label:{id:"extra_fees"},tooltip:(0,e.jsx)(a.FormattedMessage,{id:"extra_fees_tooltip"}),placeholder:f.formatMessage({id:"extra_fees",defaultMessage:"extra_fees"}),fieldProps:{step:1}})]}),(He===b.SUBSCRIPTION||He===b.SUBSCRIPTION_ALL_IN)&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(u.ZP.Group,{title:(0,e.jsx)(a.FormattedMessage,{id:"subscription"}),children:[(0,e.jsx)(Ne.Z,{name:"subscription_period",tooltip:(0,e.jsx)(a.FormattedMessage,{id:"subscription_period_tooltip"}),label:f.formatMessage({id:"subscription_period",defaultMessage:"Subscription period"}),options:[{label:f.formatMessage({id:"daily",defaultMessage:"Daily"}),value:$.DAILY},{label:f.formatMessage({id:"monthly",defaultMessage:"Monthly"}),value:$.MONTHLY},{label:f.formatMessage({id:"yearly",defaultMessage:"Yearly"}),value:$.YEARLY}],placeholder:f.formatMessage({id:"select",defaultMessage:"Select"}),rules:[{required:!0}]}),(0,e.jsx)(M.Z,{width:"sm",name:"subscription_duration",label:(0,e.jsx)(a.FormattedMessage,{id:"subscription_duration"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"subscription_duration_tooltip"}),placeholder:f.formatMessage({id:"subscription_duration",defaultMessage:"subscription_duration"}),min:1,max:99999,fieldProps:{step:1},rules:[{required:!0}]}),(0,e.jsx)(w.Z,{name:"recursive",label:(0,e.jsx)(a.FormattedMessage,{id:"recursive"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"recursive_tooltip"})})]}),(0,e.jsxs)(u.ZP.Group,{children:[(0,e.jsx)(w.Z,{name:"has_trial",label:(0,e.jsx)(a.FormattedMessage,{id:"has_trial"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"has_trial_tooltip"})}),(0,e.jsx)(Ne.Z,{name:"trial_period",tooltip:(0,e.jsx)(a.FormattedMessage,{id:"trial_period_tooltip"}),label:f.formatMessage({id:"trial_period",defaultMessage:"Trial period"}),options:[{label:f.formatMessage({id:"daily",defaultMessage:"Daily"}),value:$.DAILY},{label:f.formatMessage({id:"monthly",defaultMessage:"Monthly"}),value:$.MONTHLY},{label:f.formatMessage({id:"yearly",defaultMessage:"Yearly"}),value:$.YEARLY}],placeholder:f.formatMessage({id:"select",defaultMessage:"Select"}),rules:[{required:Ke}],disabled:!Ke}),(0,e.jsx)(M.Z,{width:"sm",name:"trial_duration",label:(0,e.jsx)(a.FormattedMessage,{id:"trial_duration"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"trial_duration_tooltip"}),placeholder:f.formatMessage({id:"trial_duration",defaultMessage:"trial_duration"}),min:1,max:99999,fieldProps:{step:1},rules:[{required:Ke}],disabled:!Ke})]})]}),(0,e.jsxs)(u.ZP.Group,{title:(0,e.jsx)(a.FormattedMessage,{id:"additional_fields"}),children:[(0,e.jsx)(U.Z,{width:"sm",name:"duration",label:(0,e.jsx)(a.FormattedMessage,{id:"duration"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"duration_tooltip"}),placeholder:f.formatMessage({id:"duration",defaultMessage:"duration"})}),(0,e.jsx)(M.Z,{initialValue:q?null:void 0,width:"sm",name:"limit_per_user",label:(0,e.jsx)(a.FormattedMessage,{id:"limit_per_user"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"limit_per_user_tooltip"}),placeholder:f.formatMessage({id:"limit_per_user",defaultMessage:"limit_per_user"}),min:0,max:99999,fieldProps:{step:1}}),(0,e.jsx)(M.Z,{initialValue:q?null:void 0,width:"sm",name:"limit_total",label:(0,e.jsx)(a.FormattedMessage,{id:"limit_total"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"limit_total_tooltip"}),placeholder:f.formatMessage({id:"limit_total",defaultMessage:"limit_total"}),min:0,max:99999,fieldProps:{step:1}}),(0,e.jsx)(U.Z,{width:"sm",name:"teaser_url",label:(0,e.jsx)(a.FormattedMessage,{id:"teaser_url"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"teaser_url_tooltip"}),placeholder:f.formatMessage({id:"teaser_url",defaultMessage:"teaser_url"})})]})," ",(0,e.jsx)(u.ZP.Item,{shouldUpdate:!0,name:"related_products",label:(0,e.jsx)(a.FormattedMessage,{id:"related_products"}),valuePropName:"value",children:ke&&(0,e.jsx)(Se.Z,{type:ke,multiple:!0})}),!q&&(0,e.jsx)(u.ZP.Item,{style:{width:"100%"},name:"description",label:(0,e.jsx)(a.FormattedMessage,{id:"description"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"description_tooltip"}),valuePropName:"value",children:(0,e.jsx)(Ve.ZP,{directory:"products/".concat(c,"/wysiwyg")})}),me.length>0&&et&&(0,e.jsx)(we.ZP,{headerTitle:f.formatMessage({id:"selected_products",defaultMessage:"Selected Products"}),pagination:!1,search:!1,dataSource:l()(me),rowKey:"id",columns:[{title:(0,e.jsx)(a.FormattedMessage,{id:"id",defaultMessage:"id"}),dataIndex:"id",width:"80px"},{title:(0,e.jsx)(a.FormattedMessage,{id:"name",defaultMessage:"name"}),dataIndex:"name"},{title:(0,e.jsx)(a.FormattedMessage,{id:"type",defaultMessage:"type"}),dataIndex:"class",render:function(n,ee){return(0,e.jsx)(L.Z,{children:(0,e.jsx)(a.FormattedMessage,{id:ee.class.split("\\").pop(),defaultMessage:ee.class.split("\\").pop()})})}},{title:(0,e.jsx)(a.FormattedMessage,{id:"quantity",defaultMessage:"quantity"}),dataIndex:"quantity",width:"10%",render:function(n,ee){return(0,e.jsx)(S.Z,{min:1,type:"number",value:ee.quantity||1,onChange:function(Pe){var Oe=Pe.target.value,oe=me.findIndex(function(ye){return ye.id===ee.id}),ne=me;ne[oe].quantity=Number(Oe),N(ne),mt()}})}}]})]}))," "]},"attributes"),!q&&(0,e.jsx)(E.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"cart_media",defaultMessage:"Cart Media"}),children:(0,e.jsx)(u.ZP,d()(d()({},Qe),{},{form:_e,children:(0,e.jsx)(I.Z,{folder:"products/".concat(c),wrapInForm:!1,title:"image",action:"/api/admin/products/".concat(c,"/?_method=PUT"),src_name:"poster_url",form_name:"poster",getUploadedSrcField:function(n){return n.file.response.data.poster_url},setPath:function(n){return _e.setFieldsValue(n)}})}))},"media"),!q&&(0,e.jsx)(E.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"product_categories_and_tags",defaultMessage:"Product Categories & Tags"}),children:(0,e.jsx)(u.ZP,d()(d()({},Qe),{},{form:_e,children:(0,e.jsxs)(x.Z,{children:[(0,e.jsx)(F.Z,{span:12,children:(0,e.jsx)(u.ZP.Item,{label:(0,e.jsx)(a.FormattedMessage,{id:"categories"}),name:"categories",valuePropName:"value",children:(0,e.jsx)(j.Z,{})})}),(0,e.jsx)(F.Z,{span:12,children:(0,e.jsx)(u.ZP.Item,{label:(0,e.jsx)(a.FormattedMessage,{id:"tags"}),name:"tags",valuePropName:"value",children:(0,e.jsx)(Re.Z,{})})})]})}))},"categories"),!q&&(0,e.jsx)(E.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"users_attached",defaultMessage:"Users Attached"}),children:(0,e.jsx)(x.Z,{children:(0,e.jsx)(F.Z,{span:24,children:c&&(0,e.jsx)(pe,{id:c})})})},"users")," ",!q&&(0,e.jsx)(E.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"user_submission",defaultMessage:"Users Attached without Account"}),children:(0,e.jsx)(x.Z,{children:(0,e.jsx)(F.Z,{span:12,children:c&&(0,e.jsx)(de.ZP,{id:Number(c),type:"EscolaLms\\Cart\\Models\\Product"})})})},"user_submission"),!q&&c&&(0,e.jsx)(E.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"template"}),children:(0,e.jsx)(x.Z,{children:(0,e.jsx)(F.Z,{span:12,children:(0,e.jsx)(Ie,{productId:Number(c)})})})},"template")]})},H=he},40658:function(Ue,te,t){t.d(te,{MZ:function(){return S},Mn:function(){return D},QB:function(){return E},RN:function(){return v},Rl:function(){return w},XK:function(){return m},Xc:function(){return U},zB:function(){return x},zd:function(){return Z}});var ae=t(15009),l=t.n(ae),re=t(97857),i=t.n(re),z=t(99289),d=t.n(z),P=t(80854);function Z(s,a){return Y.apply(this,arguments)}function Y(){return Y=d()(l()().mark(function s(a,j){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,P.request)("/api/admin/templates",i()({method:"GET",useCache:!1,params:a},j||{})));case 1:case"end":return r.stop()}},s)})),Y.apply(this,arguments)}function m(s,a){return o.apply(this,arguments)}function o(){return o=d()(l()().mark(function s(a,j){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,P.request)("/api/admin/templates/".concat(a),i()({method:"GET"},j||{})));case 1:case"end":return r.stop()}},s)})),o.apply(this,arguments)}function D(s,a){return g.apply(this,arguments)}function g(){return g=d()(l()().mark(function s(a,j){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,P.request)("/api/admin/templates",i()({method:"POST",headers:{"Content-Type":"application/json"},data:a},j||{})));case 1:case"end":return r.stop()}},s)})),g.apply(this,arguments)}function E(s,a,j){return u.apply(this,arguments)}function u(){return u=d()(l()().mark(function s(a,j,I){return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,P.request)("/api/admin/templates/".concat(a),i()({method:"PATCH",headers:{"Content-Type":"application/json"},data:j},I||{})));case 1:case"end":return h.stop()}},s)})),u.apply(this,arguments)}function U(s,a){return y.apply(this,arguments)}function y(){return y=d()(l()().mark(function s(a,j){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,P.request)("/api/admin/templates/".concat(a),i()({method:"DELETE",headers:{"Content-Type":"application/json"}},j||{})));case 1:case"end":return r.stop()}},s)})),y.apply(this,arguments)}function w(s){return M.apply(this,arguments)}function M(){return M=d()(l()().mark(function s(a){return l()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.abrupt("return",(0,P.request)("/api/admin/templates/variables",i()({method:"GET"},a||{})));case 1:case"end":return I.stop()}},s)})),M.apply(this,arguments)}function v(s,a){return A.apply(this,arguments)}function A(){return A=d()(l()().mark(function s(a,j){return l()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,P.request)("/api/admin/templates/".concat(a,"/preview"),i()({method:"GET"},j||{})));case 1:case"end":return r.stop()}},s)})),A.apply(this,arguments)}function S(s,a,j){return L.apply(this,arguments)}function L(){return L=d()(l()().mark(function s(a,j,I){return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,P.request)("/api/admin/events/trigger-manually/".concat(a),i()({method:"POST",headers:{"Content-Type":"application/json"},data:{users:j}},I||{})));case 1:case"end":return h.stop()}},s)})),L.apply(this,arguments)}function x(s,a,j){return F.apply(this,arguments)}function F(){return F=d()(l()().mark(function s(a,j,I){return l()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,P.request)("/api/admin/products/".concat(j,"/trigger-event-manually/").concat(a),i()({method:"POST",headers:{"Content-Type":"application/json"}},I||{})));case 1:case"end":return h.stop()}},s)})),F.apply(this,arguments)}}}]);
