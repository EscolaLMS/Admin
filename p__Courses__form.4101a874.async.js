(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4981,2803,8047,2238],{11312:function(ct,Ne,t){"use strict";t.d(Ne,{nu:function(){return q},rL:function(){return X},Du:function(){return ge}});var ze=t(9783),I=t.n(ze),We=t(97857),B=t.n(We),Te=t(19632),E=t.n(Te),ve=t(5574),d=t.n(ve),xe=t(45919),N=t(66419),le=t(78677),j=t(78715),Pe=t(78957),Z=t(66309),de=t(72051),k=t(71230),z=t(72269),F=t(74656),l=t(60943),n=t(67294),W=t(70804),e=t(80854),ue=t(62235),se=t(15009),fe=t.n(se),M=t(99289),Ie=t.n(M),Ve=t(58638),Le=t(14726),G=t(76841),g=t(85893),m=function(J){var C=J.course_id,S=J.stat,te=S===void 0?"EscolaLms\\Reports\\Stats\\Course\\FinishedTopics":S,Ce=(0,n.useState)(!1),K=d()(Ce,2),U=K[0],je=K[1],Y=(0,n.useCallback)(function(T){return Ie()(fe()().mark(function H(){var ae,ne;return fe()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return je(!0),y.prev=1,y.next=4,(0,G._g)(T,{stat:te});case 4:ae=y.sent,ae instanceof Blob&&(ne=document.createElement("a"),ne.href=window.URL.createObjectURL(ae),ne.download="finished_topics_".concat(C,".xlsx"),document.body.appendChild(ne),ne.click(),document.body.removeChild(ne)),y.next=11;break;case 8:y.prev=8,y.t0=y.catch(1),console.error(y.t0);case 11:return y.prev=11,je(!1),y.finish(11);case 14:case"end":return y.stop()}},H,null,[[1,8,11,14]])}))},[te]);return(0,g.jsxs)(Le.ZP,{type:"primary",loading:U,onClick:Y(C),children:[(0,g.jsx)(Ve.Z,{})," ",(0,g.jsx)(e.FormattedMessage,{id:"export"})]})},O=function(J){return J.topicable.content.contents?Object.values(J.topicable.content.contents)[0].library:"H5P"},ge=function(J){var C=J.course_id,S=J.topics,te=J.stats,Ce=(0,n.useState)(!1),K=d()(Ce,2),U=K[0],je=K[1],Y=(0,n.useMemo)(function(){return[{title:(0,g.jsx)(e.FormattedMessage,{id:"user"}),dataIndex:"id",render:function(ae){return(0,g.jsx)(ue.Z,{type:"App\\Models\\User",type_id:ae})}},{title:(0,g.jsx)(e.FormattedMessage,{id:"email"}),dataIndex:"email"}].concat(E()(S.map(function(H){var ae,ne=(ae=H.topicable_type)===null||ae===void 0?void 0:ae.split("\\").pop();return ne==="H5P"&&(ne=O(H)),{render:function(y){var Ae=0;switch(y&&(y.started_at&&y.finished_at?Ae=1:y.started_at&&(Ae=2)),Ae){case 1:return(0,g.jsxs)(Pe.Z,{children:[(0,g.jsx)(Z.Z,{color:"success",children:"F"}),U&&(y==null?void 0:y.seconds)&&(0,g.jsx)("small",{children:(0,N.Im)(y.seconds)})]});case 2:return(0,g.jsxs)(Pe.Z,{children:[(0,g.jsx)(Z.Z,{color:"blue",children:"S"}),U&&(y==null?void 0:y.seconds)&&(0,g.jsx)("small",{children:(0,N.Im)(y.seconds)})]});case 0:default:return(0,g.jsx)(n.Fragment,{children:(0,g.jsx)(Z.Z,{color:"error",children:"N"})})}},title:(0,g.jsxs)("small",{children:[(0,g.jsx)(Z.Z,{children:ne})," ",H.title]}),dataIndex:H.id}})))},[S,U]),T=(0,n.useMemo)(function(){return te.map(function(H){return S.reduce(function(ae,ne){var he=H.topics.find(function(y){return y.id===ne.id});return B()(B()({},ae),{},I()({},Number(ne.id),he!=null?he:0))},{email:H.email,id:H.id})})},[te,S]);return(0,g.jsx)(de.Z,{title:function(){return(0,g.jsxs)(k.Z,{justify:"space-between",align:"middle",children:[(0,g.jsxs)(Pe.Z,{children:[(0,g.jsx)(e.FormattedMessage,{id:"Finished",defaultMessage:"Finished:"})," ",(0,g.jsx)(Z.Z,{color:"success",children:"F"}),(0,g.jsx)(e.FormattedMessage,{id:"Started",defaultMessage:"Started:"})," ",(0,g.jsx)(Z.Z,{color:"blue",children:"S"}),(0,g.jsx)(e.FormattedMessage,{id:"NotStarted",defaultMessage:"Not Started:"})," ",(0,g.jsx)(Z.Z,{color:"error",children:"N"}),(0,g.jsx)(e.FormattedMessage,{id:"ShowMinutes",defaultMessage:"Show minutes spent on topic:"})," ",(0,g.jsx)(z.Z,{checked:U,onChange:function(ne){return je(ne)}})]}),(0,g.jsx)(m,{course_id:C})]})},columns:Y,dataSource:T,size:"small",scroll:{x:1500},components:{table:function(ae){return(0,g.jsx)(W.Z,{horizontal:!0,style:{maxWidth:"auto"},hideScrollbars:!1,children:(0,g.jsx)("table",B()({},ae))})}}})},X=function(J){var C=J.stats,S=J.attempts,te=(0,n.useMemo)(function(){return[{title:(0,g.jsx)(e.FormattedMessage,{id:"user"}),dataIndex:"id",render:function(U){return(0,g.jsx)(ue.Z,{type:"App\\Models\\User",type_id:U})}},{title:(0,g.jsx)(e.FormattedMessage,{id:"email"}),dataIndex:"email"},{title:(0,g.jsx)(e.FormattedMessage,{id:"attempt",defaultMessage:"Attempt"}),dataIndex:"attempt"},{title:(0,g.jsx)(e.FormattedMessage,{id:"finished_at",defaultMessage:"Finished at"}),dataIndex:"finished_at",render:function(U){return U?(0,l.WU)(new Date(U),xe.Cu):""}}]},[]),Ce=(0,n.useMemo)(function(){return C.map(function(K){var U=K.id,je=K.email,Y=K.finished_at,T=S==null?void 0:S.find(function(ae){return ae.id===U}),H=Array.isArray(T==null?void 0:T.attempts)?T==null?void 0:T.attempts.length:0;return{id:U,email:je,finished_at:Y,attempt:H}})},[C]);return(0,g.jsx)(de.Z,{title:function(){return(0,g.jsx)(Pe.Z,{children:(0,g.jsx)(e.FormattedMessage,{id:"course.finished",defaultMessage:"Finished"})})},columns:te,dataSource:Ce,size:"small",scroll:{x:500}})},q=function(J){var C=J.stats,S=(0,n.useState)(null),te=d()(S,2),Ce=te[0],K=te[1],U=(0,n.useState)(null),je=d()(U,2),Y=je[0],T=je[1],H=(0,e.useIntl)(),ae=(0,n.useMemo)(function(){return C.flatMap(function(he){return Object.values(he.attempts).flatMap(function(y){var Ae=y.dates,Ee=y.attempt,Ze=Object.values(Ae).flatMap(function(Xe){var Ke=Xe.date,Qe=Xe.seconds_total;return{date:Ke,attempt:Ee,seconds_total:Qe,email:he.email}});return Ze})})},[C]),ne={xField:"date",yField:"seconds_total",seriesField:"attempt",isStack:!0,xAxis:{label:{autoHide:!0,autoRotate:!1}},slider:{start:0,end:1},label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]}};return(0,g.jsx)(j.ZP,{title:(0,g.jsxs)(Pe.Z,{children:[(0,g.jsx)(e.FormattedMessage,{id:"course.interactions_time_in_days"}),(0,g.jsx)(F.default,{showSearch:!0,value:Ce,onChange:function(y){K(y),T(null)},placeholder:(0,g.jsx)(e.FormattedMessage,{id:"select_person",defaultMessage:"Select a person"}),children:C.map(function(he){var y=he.id,Ae=he.email;return(0,g.jsx)(F.default.Option,{value:Ae,children:Ae},y)})}),(0,g.jsx)(F.default,{value:Y,onChange:function(y){return T(y)},disabled:Ce===null,placeholder:(0,g.jsx)(e.FormattedMessage,{id:"select_attempt",defaultMessage:"Select attempt"}),children:E()(new Set(ae.filter(function(he){var y=he.email;return y===Ce}).map(function(he){var y=he.attempt;return y}))).map(function(he){return(0,g.jsxs)(F.default.Option,{value:he,children:[(0,g.jsx)(e.FormattedMessage,{id:"attempt",defaultMessage:"Attempt"})," ",he]},he)})})]}),colSpan:12,layout:"center",children:(0,g.jsx)("div",{style:{overflow:"auto",minHeight:"400px",width:"100%"},children:(0,g.jsx)(le.Z,B()(B()({},ne),{},{tooltip:{title:"".concat(H.formatMessage({id:"attempt"})),formatter:function(y){var Ae=Math.floor(+y.seconds_total/60),Ee=+y.seconds_total>60?+y.seconds_total-Ae*60:0;return{name:y.attempt,value:"".concat(Ae,"m ").concat(Ee,"s")}}},data:ae.filter(function(he){var y=he.email;return y===Ce}).filter(function(he){var y=he.attempt;return Number.isInteger(Y)?y===Y:!0})}))})})}},20568:function(ct,Ne,t){"use strict";t.d(Ne,{Z:function(){return ue}});var ze=t(19632),I=t.n(ze),We=t(97857),B=t.n(We),Te=t(5574),E=t.n(Te),ve=t(67294),d=t(17578),xe=t(78957),N=t(71471),le=t(55102),j=t(14726),Pe=t(2487),Z=t(72252),de=t(82061),k=t(55725),z=t(69753),F=t(80854),l=t(29477),n=t(85893),W=function(fe){var M=fe.directory,Ie=fe.onUploaded;return(0,n.jsxs)(xe.Z,{align:"start",children:[(0,n.jsxs)(N.Z.Text,{children:[(0,n.jsx)(F.FormattedMessage,{id:"pages.files.filesBrowser"}),(0,n.jsx)(N.Z.Text,{code:!0,children:M})]}),(0,n.jsx)(l.Z,{url:"/api/admin/file/upload",name:"file[]",data:{target:M},onUpload:function(Le){Le.success&&Ie(M,Le.data)}})]})},e=function(fe){var M=fe.defaultDirectory,Ie=M===void 0?"/":M,Ve=fe.onFile,Le=fe.hideDeleteBtn,G=Le===void 0?!1:Le,g=fe.forceLoading,m=g===void 0?!1:g,O=fe.hideAddBtn,ge=O===void 0?!1:O,X=(0,F.useIntl)(),q=(0,ve.useState)({loading:!1,name:"",directory:Ie,current_page:1,data:void 0,per_page:1,last_page:1,total:0}),L=E()(q,2),J=L[0],C=L[1],S=(0,ve.useRef)(),te=(0,ve.useCallback)(function(Y){C(function(T){return B()(B()({},T),{},{loading:Y})})},[]),Ce=(0,ve.useCallback)(function(Y,T){Y.success&&C(function(H){return B()(B()(B()({},H),Y.data),{},{data:[{url:T.split("/").slice(0,-1).join("/"),name:"..",created_at:"",mime:"directory"}].concat(I()(Y.data.data.map(function(ae){return B()(B()({},ae),{},{url:ae.mime==="directory"?"".concat(T,"/").concat(ae.name):ae.url})}))).filter(function(ae){return T==="/"||T===Ie?ae.name!=="..":!0}),directory:T,loading:!1})})},[te]),K=(0,ve.useCallback)(function(Y){var T,H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,ae=function(){return S.current&&S.current.abort()};return ae(),S.current=new AbortController,te(!0),(0,d.QZ)({directory:Y,page:H},{signal:(T=S.current)===null||T===void 0?void 0:T.signal}).then(function(ne){ne.success&&Ce(ne,Y)}).catch(function(){return te(!1)}),function(){ae()}},[te]);(0,ve.useEffect)(function(){return K(Ie)},[Ie,K]);var U=(0,ve.useCallback)(function(Y){te(!0),(0,d.Od)(Y).then(function(){K(J.directory)}).catch(function(){te(!1)})},[K,te,J.directory]),je=(0,ve.useCallback)(function(Y,T){var H,ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,ne=function(){return S.current&&S.current.abort()};return ne(),S.current=new AbortController,te(!0),(0,d.ht)({directory:Y,name:T,page:ae},{signal:(H=S.current)===null||H===void 0?void 0:H.signal}).then(function(he){he.success&&Ce(he,Y)}).catch(function(){return te(!1)}),function(){ne()}},[te]);return(0,n.jsxs)("div",{className:"file-browser",children:[(0,n.jsxs)("div",{className:"file-browser__header",children:[(0,n.jsx)(le.Z,{placeholder:X.formatMessage({id:"search_file"}),className:"file-browser__input",onChange:function(T){return C(function(H){return B()(B()({},H),{},{name:T.target.value})})},value:J.name}),(0,n.jsxs)("div",{children:[(0,n.jsx)(j.ZP,{className:"file-browser__button",onClick:function(){return K(J.directory)},children:(0,n.jsx)(F.FormattedMessage,{id:"reset"})}),(0,n.jsx)(j.ZP,{className:"file-browser__button",type:"primary",onClick:function(){return je(J.directory,J.name)},children:(0,n.jsx)(F.FormattedMessage,{id:"query"})})]})]}),(0,n.jsx)(Pe.Z,{loading:J.loading||m,size:"small",itemLayout:"horizontal",dataSource:J.data,header:ge?null:(0,n.jsx)(W,{directory:J.directory,onUploaded:function(T,H){H&&(K(T),Ve&&Ve(H,T))}}),footer:ge?null:(0,n.jsx)(W,{directory:J.directory,onUploaded:function(T,H){K(T),H&&Ve&&Ve(H,T)}}),renderItem:function(T){return(0,n.jsx)(Pe.Z.Item,{actions:T.mime!=="directory"&&!G?[(0,n.jsx)(j.ZP,{type:"default",danger:!0,icon:(0,n.jsx)(de.Z,{}),size:"small",onClick:function(){return U(T.url)}},"dir")]:[],children:(0,n.jsx)(Pe.Z.Item.Meta,{avatar:T.mime==="directory"?(0,n.jsx)(j.ZP,{type:"primary",icon:(0,n.jsx)(k.Z,{}),size:"small",onClick:function(){return K(T.url)}}):(0,n.jsx)("a",{href:T.url,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(j.ZP,{type:"default",icon:(0,n.jsx)(z.Z,{}),size:"small"})}),description:(0,n.jsx)(ve.Fragment,{children:(0,n.jsx)(j.ZP,{type:"text",size:"small",onClick:function(){return T.mime==="directory"?K(T.url):Ve&&Ve(T,J.directory)},children:T.name})})})})}}),(0,n.jsx)(Z.Z,{pageSizeOptions:[],current:J.current_page,total:J.total,pageSize:J.per_page,onChange:function(T){return K(J.directory,T)}})]})},ue=e},89825:function(ct,Ne,t){"use strict";t.d(Ne,{Z:function(){return e}});var ze=t(78715),I=t(80854),We=t(5574),B=t.n(We),Te=t(50227),E=t(2453),ve=t(15746),d=t(71230),xe=t(38925),N=t(74330),le=t(67294);function j(ue){var se=(0,le.useRef)(ue);(0,le.useEffect)(function(){var fe=function(){var Ie=localStorage.getItem("TOKEN");se.current(Ie)};return window.addEventListener("token_change",fe),function(){window.removeEventListener("token_change",fe)}},[])}var Pe=t(97704),Z=t(85893),de="h5p-editor",k=function(ue){return ue.TokenChanged="TOKEN_CHANGED",ue}(k||{}),z=function(se){var fe,M=document.getElementById(de);if(!M){console.error("There is no iframe with id '".concat(de,"'"));return}(fe=M.contentWindow)===null||fe===void 0||fe.postMessage({type:k.TokenChanged,token:se},"*")},F=function(se){var fe=se.id,M=se.onSubmitted,Ie=se.onLoaded,Ve=(0,le.useState)(),Le=B()(Ve,2),G=Le[0],g=Le[1],m=(0,le.useState)(!1),O=B()(m,2),ge=O[0],X=O[1],q=(0,le.useState)(),L=B()(q,2),J=L[0],C=L[1],S=(0,I.useIntl)(),te=S.locale.split("-")[0];j(z),(0,le.useEffect)(function(){fe&&(X(!0),(0,Pe.RN)(fe==="new"?void 0:fe,te).then(function(K){K.success?(Ie&&Ie(K.data),g(K.data)):C(K.message)}).catch(function(K){return K&&C(K.toString())}).finally(function(){return X(!1)}))},[fe]);var Ce=(0,le.useCallback)(function(K){X(!0),(0,Pe.x0)(K,fe==="new"?void 0:fe).then(function(U){U.success?(M(U.data.id),E.ZP.success((0,Z.jsx)(I.FormattedMessage,{id:"h5p_edited",defaultMessage:"H5P Element edited and saved successfully"}))):C(U.message)}).catch(function(U){return U&&C(U.toString())}).finally(function(){return X(!1)})},[]);return G?(0,Z.jsxs)(le.Fragment,{children:[J&&(0,Z.jsx)(xe.Z,{message:J,type:"error"}),G&&(0,Z.jsx)(Te.ContextlessEditor,{onError:function(U){return console.error(U)},state:G,allowSameOrigin:!0,onSubmit:Ce,loading:ge,lang:te,iframeId:de})]}):(0,Z.jsx)(ve.Z,{children:(0,Z.jsxs)(d.Z,{justify:"center",align:"middle",children:[J&&(0,Z.jsx)(xe.Z,{message:J,type:"error"}),(0,Z.jsx)(N.Z,{})]})})},l=F,n=t(66340),W=function(se){var fe=se.defaultCard,M=fe===void 0?"edit":fe,Ie=se.id,Ve=se.onSubmit,Le=se.onLoaded;return(0,Z.jsxs)(ze.ZP,{tabs:{type:"card",defaultActiveKey:M},children:[(0,Z.jsx)(ze.ZP.TabPane,{disabled:!Ie,tab:(0,Z.jsx)(I.FormattedMessage,{id:"edit"}),children:(0,Z.jsx)(l,{id:Ie,onSubmitted:Ve,onLoaded:Le},Ie)},"edit"),Ie!=="new"&&(0,Z.jsx)(ze.ZP.TabPane,{disabled:!Ie,tab:(0,Z.jsx)(I.FormattedMessage,{id:"preview"}),children:(0,Z.jsx)(n.Z,{id:Ie,onLoaded:Le})},"preview")]})},e=W},66340:function(ct,Ne,t){"use strict";var ze=t(19632),I=t.n(ze),We=t(5574),B=t.n(We),Te=t(97704),E=t(50227),ve=t.n(E),d=t(71471),xe=t(15746),N=t(71230),le=t(38925),j=t(74330),Pe=t(96074),Z=t(67294),de=t(55171),k=t.n(de),z=t(80854),F=t(85893),l=d.Z.Title,n=function(e){var ue=e.id,se=e.onXAPI,fe=e.onLoaded,M=(0,Z.useState)(),Ie=B()(M,2),Ve=Ie[0],Le=Ie[1],G=(0,Z.useState)(!1),g=B()(G,2),m=g[0],O=g[1],ge=(0,Z.useState)([]),X=B()(ge,2),q=X[0],L=X[1],J=(0,Z.useState)(),C=B()(J,2),S=C[0],te=C[1],Ce=(0,z.useIntl)(),K=Ce.locale.split("-")[0];return(0,Z.useEffect)(function(){ue&&(O(!0),(0,Te.LK)(ue,K).then(function(U){U.success?(fe&&fe(U.data),Le(U.data)):te(U.message)}).catch(function(U){return U&&te(U.toString())}).finally(function(){return O(!1)}))},[ue]),Ve?(0,F.jsxs)(Z.Fragment,{children:[S&&(0,F.jsx)(le.Z,{message:S,type:"error"}),(0,F.jsx)(E.ContextlessPlayer,{contentId:ue,onError:function(je){return console.error(je)},state:Ve,allowSameOrigin:!0,loading:m,onXAPI:function(je){se?se(je):L(function(Y){return[].concat(I()(Y),[je])})}}),!se&&(0,F.jsxs)(Z.Fragment,{children:[(0,F.jsx)(Pe.Z,{}),(0,F.jsxs)("div",{style:{overflow:"auto",maxHeight:"400px"},children:[(0,F.jsx)(l,{level:5,children:"XAPI Events"}),(0,F.jsx)(k(),{src:q})]})]})]}):(0,F.jsx)(xe.Z,{children:(0,F.jsxs)(N.Z,{justify:"center",align:"middle",children:[S&&(0,F.jsx)(le.Z,{message:S,type:"error"}),(0,F.jsx)(j.Z,{})]})})};Ne.Z=n},9412:function(ct,Ne,t){"use strict";var ze=t(29477),I=t(67294),We=t(85893),B=function(E){var ve=E.onSuccess,d=E.onError,xe=E.hideLabel;return(0,We.jsx)(ze.Z,{url:"/api/admin/hh5p/content/upload",name:"h5p_file",accept:".h5p",hideLabel:xe,onChange:function(le){le.file.status==="done"&&le.file.response&&ve(le.file.response),le.file.status==="error"&&d()}})};Ne.C=B},34201:function(ct,Ne,t){"use strict";t.d(Ne,{Z:function(){return X}});var ze=t(5574),I=t.n(ze),We=t(38925),B=t(74330),Te=t(96074),E=t(2487),ve=t(71471),d=t(14726),xe=t(67294),N=t(80854),le=t(19632),j=t.n(le),Pe=t(93162),Z=t(55733),de=t.n(Z),k=t(85893),z=function(L){var J=L.pdfIds,C=L.onProgress,S=L.onFinished,te=L.filename,Ce=te===void 0?"package.zip":te,K=(0,xe.useState)([]),U=I()(K,2),je=U[0],Y=U[1],T=(0,xe.useCallback)(function(H){var ae=new(de());H.forEach(function(ne,he){return ae.file("".concat(J[he],".pdf"),ne)}),ae.generateAsync({type:"blob"}).then(function(ne){(0,Pe.saveAs)(ne,Ce),S&&S()})},[je,Ce]);return(0,xe.useEffect)(function(){J.forEach(function(H){var ae=fetch("".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/pdfs/generate/").concat(H),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}});ae.then(function(ne){return ne.blob()}).then(function(ne){ne&&ne instanceof Blob&&Y(function(he){var y=(he.length+1)/J.length;return C&&C(y),y>=1&&T([].concat(j()(he),[ne])),[].concat(j()(he),[ne])})})})},[J]),(0,k.jsxs)("p",{children:["Progress ",je.length," / ",J.length]})},F=z,l=t(15009),n=t.n(l),W=t(97857),e=t.n(W),ue=t(99289),se=t.n(ue);function fe(q,L){return M.apply(this,arguments)}function M(){return M=se()(n()().mark(function q(L,J){return n()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",(0,N.request)("/api/admin/pdfs",e()({params:e()({},L),method:"GET"},J||{})));case 1:case"end":return S.stop()}},q)})),M.apply(this,arguments)}function Ie(q,L){return Ve.apply(this,arguments)}function Ve(){return Ve=se()(n()().mark(function q(L,J){return n()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",(0,N.request)("/api/pdfs/".concat(L),e()({method:"GET"},J||{})));case 1:case"end":return S.stop()}},q)})),Ve.apply(this,arguments)}function Le(q,L){return G.apply(this,arguments)}function G(){return G=_asyncToGenerator(_regeneratorRuntime().mark(function q(L,J){return _regeneratorRuntime().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",request("/api/pdfs/generate/".concat(L),_objectSpread({method:"GET"},J||{})));case 1:case"end":return S.stop()}},q)})),G.apply(this,arguments)}var g=t(62235),m=t(69753),O=t(19326),ge=function(L){var J=L.user_id,C=L.template_id,S=L.title,te=(0,xe.useState)({state:"initial"}),Ce=I()(te,2),K=Ce[0],U=Ce[1],je=(0,xe.useState)({state:"initial"}),Y=I()(je,2),T=Y[0],H=Y[1],ae=(0,xe.useState)(!1),ne=I()(ae,2),he=ne[0],y=ne[1];(0,xe.useEffect)(function(){U({state:"loading"});var Ee=new AbortController;return fe({user_id:J,template_id:C},{signal:Ee.signal}).then(function(Ze){Ze&&Ze.success?U({state:"loaded",list:Ze.data}):Ze&&!Ze.success&&U({state:"error",error:Ze.message})}).catch(function(Ze){return U({state:"error",error:Ze.toString()})}),function(){Ee.abort()}},[]);var Ae=(0,xe.useCallback)(function(Ee){H({state:"loading"}),Ie(Ee).then(function(Ze){Ze.success?H({state:"loaded",data:Ze.data.content}):H({state:"initial"})})},[]);return K.state==="error"?(0,k.jsx)(We.Z,{message:"Error Text",type:"error"}):K.state==="loading"||K.state==="initial"?(0,k.jsx)(B.Z,{}):(0,k.jsxs)(xe.Fragment,{children:[(0,k.jsx)(Te.Z,{}),he&&(0,k.jsx)(F,{pdfIds:K.list.map(function(Ee){return Ee.id}),onFinished:function(){return y(!1)}}),(0,k.jsx)(E.Z,{size:"small",itemLayout:"horizontal",dataSource:K.list,header:(0,k.jsxs)("div",{children:[(0,k.jsx)(N.FormattedMessage,{id:"template"})," ",S&&(0,k.jsx)(ve.Z.Text,{strong:!0,children:S}),". ",(0,k.jsx)(N.FormattedMessage,{id:"generated_pdfs",defaultMessage:"Generated PDFs"})," ",(0,k.jsx)(d.ZP,{loading:he,type:"primary",onClick:function(){return y(!0)},icon:(0,k.jsx)(m.Z,{}),size:"small",children:(0,k.jsx)(N.FormattedMessage,{id:"download_all",defaultMessage:"Download all PDFs"})})]}),renderItem:function(Ze){return(0,k.jsxs)(E.Z.Item,{actions:[(0,k.jsx)(O.Z,{url:"/api/pdfs/generate/".concat(Ze.id),filename:"generated-".concat(Ze.id,".pdf"),size:"small",icon:(0,k.jsx)(m.Z,{}),type:"primary",onClick:function(){return Ae(Ze.id)},loading:T.state==="loading",children:(0,k.jsx)(N.FormattedMessage,{id:"download_pdf",defaultMessage:"Download PDFs"})},"download")],children:[Ze.title," ",(0,k.jsx)(g.Z,{type:"App\\Models\\User",type_id:Ze.user_id})]})}})]})},X=ge},87366:function(ct,Ne,t){"use strict";t.d(Ne,{Il:function(){return Le},_y:function(){return F},uS:function(){return W}});var ze=t(15009),I=t.n(ze),We=t(99289),B=t.n(We),Te=t(5574),E=t.n(Te),ve=t(97857),d=t.n(ve),xe=t(19632),N=t.n(xe),le=t(2453),j=t(67294),Pe=t(80854),Z=t(99100),de=t(31472),k=t(36309),z=t(85893),F=j.createContext({}),l=function(){return Math.round(Math.random()*99999)},n=function G(g){return g.reduce(function(m,O){return[].concat(N()(m),N()(O.lessons?G(O.lessons):[]),[O])},[])},W=function G(g){return g.reduce(function(m,O){var ge;return[].concat(N()(m),N()(O.lessons?G(O.lessons):[]),N()((ge=O.topics)!==null&&ge!==void 0?ge:[]))},[])},e=function G(g,m,O){return g.map(function(ge){var X,q;return d()(d()({},ge),{},{lessons:ge.lessons?G(ge.lessons,m,O):[],topics:ge.id===m?[].concat(N()((X=ge.topics)!==null&&X!==void 0?X:[]),[O]):(q=ge.topics)!==null&&q!==void 0?q:[]})})},ue=function G(g,m,O){return O?g.map(function(ge){return d()(d()({},ge),{},{lessons:[].concat(N()(ge.lessons?G(ge.lessons,m,O):[]),N()(ge.id===O?[m]:[]))})}):[].concat(N()(g),[m])},se=function G(g,m,O){return g.map(function(ge){return d()(d()({},ge.id===m?O:ge),{},{lessons:ge.lessons?G(ge.lessons,m,O):[]})})},fe=function G(g,m){return g.map(function(O){return d()(d()({},O),{},{parent_id:m,lessons:O.lessons?G(O.lessons,O.id):[]})})},M=function G(g,m){return g.filter(function(O){return O.id!==m}).map(function(O){return d()(d()({},O),{},{lessons:O.lessons?G(O.lessons,m):[]})})},Ie=function G(g,m){return g.map(function(O){return d()(d()({},O),{},{lessons:O.lessons?G(O.lessons,m):[],topics:O.topics?O.topics.filter(function(ge){return ge.id!==m}):[]})})},Ve=function G(g,m,O,ge){return ge==null?void 0:ge.map(function(X){if(X.id===O){var q;return d()(d()({},X),{},{topics:(q=X.topics)===null||q===void 0?void 0:q.map(function(L){return L.id===g?m.file.response.data:L})})}else if(X.lessons)return d()(d()({},X),{},{lessons:G(g,m,O,X.lessons||[])});return X})},Le=function(g){var m=g.children,O=g.id,ge=(0,j.useState)(),X=E()(ge,2),q=X[0],L=X[1],J=(0,Pe.useIntl)(),C=(0,j.useMemo)(function(){return q&&q.lessons?W(q.lessons):[]},[q]),S=(0,j.useMemo)(function(){return q&&q.lessons?n(q.lessons):[]},[q]),te=(0,j.useState)([]),Ce=E()(te,2),K=Ce[0],U=Ce[1],je=(0,j.useState)(!1),Y=E()(je,2),T=Y[0],H=Y[1],ae=(0,Pe.useLocation)(),ne=(0,j.useMemo)(function(){var Me=new URLSearchParams(ae.search);return{lesson:Me.get("lesson"),topic:Me.get("topic")}},[ae]),he=(0,j.useCallback)(B()(I()().mark(function Me(){var $e,Fe;return I()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,(0,k.XU)({class_type:"EscolaLms\\Courses\\Models\\Lesson"});case 2:$e=re.sent,$e.success&&(Fe=$e.data.find(function(Re){var rt=Re.name;return rt==="assistant_id"}),H(!!(Fe!=null&&Fe.id)));case 4:case"end":return re.stop()}},Me)})),[]);(0,j.useEffect)(function(){he(),U([])},[]);var y=(0,j.useCallback)(function(){(0,Z.Nx)(O).then(function(Me){return Me.success&&L(d()(d()({},Me.data),{},{lessons:fe(Me.data.lessons)}))})},[O]);(0,j.useEffect)(function(){y()},[y]);var Ae=(0,j.useCallback)(function(Me){var $e=S.find(function(Fe){var ie;return Fe==null||(ie=Fe.topics)===null||ie===void 0?void 0:ie.find(function(re){return re.id===Me})});return $e?$e.id:null},[S]),Ee=(0,j.useMemo)(function(){return ne.lesson?{mode:"lesson",id:Number(ne.lesson),value:S.find(function(Me){return Me.id===Number(ne.lesson)})}:ne.topic?{mode:"topic",id:Number(ne.topic),value:C.find(function(Me){return Me.id===Number(ne.topic)})}:{mode:"init"}},[ne,q,S,C]),Ze=(0,j.useCallback)(function(Me){var $e={course_id:O,topics:[],isNew:!0,id:q?q.lessons.length+1:l(),order:0,title:J.formatMessage({id:"add_title_here"}),active:!0,parent_id:Me};return L(function(Fe){var ie;return d()(d()({},Fe),{},{lessons:ue((ie=Fe==null?void 0:Fe.lessons)!==null&&ie!==void 0?ie:[],$e,Me)})}),$e},[O,q]),Xe=(0,j.useCallback)(function(Me,$e){var Fe=S.find(function(re){return re.id===Me}),ie=Fe&&Fe.isNew;return(ie?(0,Z.aA)($e):(0,Z.sI)(Me,$e)).then(function(re){return le.ZP.success(re.message),y(),re.success&&L(function(Re){var rt;return d()(d()({},Re),{},{lessons:se((rt=Re==null?void 0:Re.lessons)!==null&&rt!==void 0?rt:[],Me,d()(d()({},re.data),{},{isNew:!1}))})})})},[q]),Ke=(0,j.useCallback)(function(Me){var $e=S.find(function(ie){return ie.id===Me});if($e){var Fe=$e.isNew;Fe?L(function(ie){var re;return d()(d()({},ie),{},{lessons:M((re=ie==null?void 0:ie.lessons)!==null&&re!==void 0?re:[],Me)})}):(0,Z.iI)(Me).then(function(ie){ie.success&&(le.ZP.success(ie.message),L(function(re){var Re;return d()(d()({},re),{},{lessons:M((Re=re==null?void 0:re.lessons)!==null&&Re!==void 0?Re:[],Me)})}))})}},[q]),Qe=(0,j.useCallback)(function(Me,$e){var Fe,ie=Ae(Me),re=S.find(function(ht){return ht.id===ie}),Re=re&&((Fe=re.topics)===null||Fe===void 0?void 0:Fe.find(function(ht){return ht.id===Me})),rt=Re==null?void 0:Re.isNew;return(rt?(0,Z.HV)($e):(0,Z.Cn)(Me,$e)).then(function(ht){ht.success&&(le.ZP.success(ht.message),y(),Pe.history.push("/courses/list/".concat(O,"/program/?topic=").concat(ht.data.id)),(Re==null?void 0:Re.topicable_type)===de.oz.Video&&setTimeout(function(){y()},5e3))})},[Ae,q,y]),it=(0,j.useCallback)(function(Me){var $e=Ae(Me),Fe=S.find(function(Re){return Re.id===$e});if(Fe){var ie=C==null?void 0:C.find(function(Re){return Re.id===Me}),re=ie==null?void 0:ie.isNew;re&&!ie.topicable?L(function(Re){var rt;return d()(d()({},Re),{},{lessons:Ie((rt=Re==null?void 0:Re.lessons)!==null&&rt!==void 0?rt:[],Me)})}):(0,Z.vJ)(Me).then(function(Re){Re.success&&(le.ZP.success(Re.message),L(function(rt){var ht;return d()(d()({},rt),{},{lessons:Ie((ht=rt==null?void 0:rt.lessons)!==null&&ht!==void 0?ht:[],Me)})}))})}},[q,Ae]),Mt=(0,j.useCallback)(function(Me,$e){var Fe={lesson_id:Me,isNew:!0,id:l(),title:J.formatMessage({id:"add_title_here"}),active:!0,topicable_type:$e};return L(function(ie){var re;return d()(d()({},ie),{},{lessons:e((re=ie==null?void 0:ie.lessons)!==null&&re!==void 0?re:[],Me,Fe)})}),Fe},[]),me=function($e,Fe){var ie=Ae($e);L(function(re){return d()(d()({},re),{},{lessons:re?Ve($e,Fe,ie,re.lessons||[]):[]})}),Pe.history.push("/courses/list/".concat(O,"/program/?topic=").concat(Fe.file.response.data.id))},Ot=(0,j.useCallback)(function(Me){return(0,Z.Cx)(Me).then(function($e){if($e.success){le.ZP.success($e.message);var Fe=Ae(Me);L(function(ie){var re;return d()(d()({},ie),{},{lessons:ie?(re=ie.lessons)===null||re===void 0?void 0:re.map(function(Re){if(Re.id===Fe){var rt=Re.topics||[];return d()(d()({},Re),{},{topics:[].concat(N()(rt),[$e.data])})}return Re}):[]})})}})},[q,Ae]),Et=(0,j.useCallback)(function(Me){return(0,Z.if)(Me).then(function($e){$e.success&&(le.ZP.success($e.message),L(function(Fe){return d()(d()({},Fe),{},{lessons:Fe?[].concat(N()(Fe.lessons),[$e.data]):[]})}))})},[]),wt={state:q,h5ps:K,id:O,addNewLesson:Ze,updateLesson:Xe,updateTopic:Qe,deleteLesson:Ke,addNewTopic:Mt,deleteTopic:it,onTopicUploaded:me,cloneTopic:Ot,cloneLesson:Et,currentEditMode:Ee,getLessons:y,isAssistant:T};return(0,z.jsx)(F.Provider,{value:wt,children:m})}},75175:function(ct,Ne,t){"use strict";var ze=t(17663),I=t(67294),We=t(85893),B=function(E){var ve=E.uuid,d="https://api-stage.escolalms.com";return(0,We.jsx)("div",{style:{height:"100vh"},children:(0,We.jsx)(ze.Y,{uuid:ve,apiUrl:d||"",serviceWorkerUrl:"/service-worker-scorm.js"})})};Ne.Z=B},82238:function(ct,Ne,t){"use strict";var ze=t(9783),I=t.n(ze),We=t(5574),B=t.n(We),Te=t(13769),E=t.n(Te),ve=t(15009),d=t.n(ve),xe=t(97857),N=t.n(xe),le=t(99289),j=t.n(le),Pe=t(20568),Z=t(29477),de=t(54734),k=t(2453),z=t(14726),F=t(28248),l=t(67294),n=t(80854),W=t(85893),e=["folder","onResponse","onUpload"],ue=function(){var Le=j()(d()().mark(function G(g,m,O){return d()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.abrupt("return",(0,n.request)(g,N()({method:"POST",data:m},O||{})));case 1:case"end":return X.stop()}},G)}));return function(g,m,O){return Le.apply(this,arguments)}}(),se=function(G){var g=G.split("//").join("/");return g=g[g.length-1]==="/"?g:"".concat(g,"/"),g=g[0]==="/"?g.slice(1):g,g},fe=function(G){return Array.isArray(G)&&G[0]?G[0].name:G.name},M=function(G,g){var m=se(G),O=fe(g);return O.includes(m)?O:"".concat(m).concat(O)},Ie=function(G){return{file:{status:"done",uid:"fileFromBrowser",name:"fileFromBrowser",response:G},fileList:[]}};function Ve(Le){var G=Le.folder,g=Le.onResponse,m=Le.onUpload,O=E()(Le,e),ge=(0,l.useState)(!1),X=B()(ge,2),q=X[0],L=X[1],J=(0,l.useState)(!1),C=B()(J,2),S=C[0],te=C[1],Ce=O.url,K=O.name,U=O.onChange,je=O.data,Y=(0,l.useCallback)(function(){L(!1)},[]),T=(0,l.useCallback)(function(){var H=j()(d()().mark(function ae(ne,he){var y;return d()().wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:if(he){Ee.next=2;break}return Ee.abrupt("return");case 2:return te(!0),Ee.prev=3,Ee.next=6,ue(Ce,N()(N()({},je),{},I()({},K,M(he,ne))));case 6:y=Ee.sent,g&&g(y),y.success?(Y(),U&&U(Ie(y))):k.ZP.error(y.message),Ee.next=15;break;case 11:Ee.prev=11,Ee.t0=Ee.catch(3),te(!1),k.ZP.error("data"in Ee.t0?Ee.t0.data.message:"Unknown Error");case 15:return Ee.prev=15,te(!1),Ee.finish(15);case 18:case"end":return Ee.stop()}},ae,null,[[3,11,15,18]])}));return function(ae,ne){return H.apply(this,arguments)}}(),[]);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(z.ZP,{onClick:function(){return L(!0)},icon:(0,W.jsx)(de.Z,{}),children:[" ",(0,W.jsx)(n.FormattedMessage,{id:"browse"})]}),q&&(0,W.jsx)(F.Z,{open:q,onCancel:Y,onOk:Y,width:"60vw",closeIcon:!1,children:(0,W.jsx)(Pe.Z,{forceLoading:S,hideDeleteBtn:!0,defaultDirectory:G,onFile:function(ae,ne){return T(ae,ne)}})}),(0,W.jsx)("div",{style:{marginTop:"10px"},children:(0,W.jsx)(Z.Z,N()({onUpload:m},O))})]})}Ne.Z=Ve},29477:function(ct,Ne,t){"use strict";var ze=t(97857),I=t.n(ze),We=t(5574),B=t.n(We),Te=t(55523),E=t(75842),ve=t(21974),d=t(67294),xe=t(80854),N=t(85893);function le(j){var Pe=j.onChange,Z=j.onUpload,de=j.url,k=j.name,z=j.extra,F=j.accept,l=j.data,n=j.wrapInForm,W=n===void 0?!0:n,e=j.title,ue=j.formProps,se=j.maxFiles,fe=j.clearListAfterUpload,M=j.hideLabel,Ie=j.disabled,Ve=j.showUploadList,Le=(0,d.useState)(),G=B()(Le,2),g=G[0],m=G[1],O=(0,xe.useIntl)();return l&&l[k]&&delete l[k],(0,N.jsx)(ve.Z,{condition:W,wrap:function(X){return(0,N.jsx)(E.Z,I()(I()({},ue),{},{children:X}))},children:(0,N.jsx)(Te.Z,{title:e||" ".concat(O.formatMessage({id:"upload_click_here"})),placeholder:O.formatMessage({id:"upload_click_here"}),label:!M&&(0,N.jsx)(xe.FormattedMessage,{id:"upload"}),max:se!=null?se:2,fieldProps:{data:l,accept:F,name:k,showUploadList:Ve,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))},onChange:function(X){m(X),Pe&&Pe(X),X.file.status==="done"&&(Z&&Z(X.file.response),fe&&m(void 0))}},action:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com").concat(de),extra:z,fileList:g==null?void 0:g.fileList,disabled:Ie})})}Ne.Z=le},12648:function(ct,Ne,t){"use strict";t.r(Ne),t.d(Ne,{default:function(){return Hs}});var ze=t(9783),I=t.n(ze),We=t(52677),B=t.n(We),Te=t(15009),E=t.n(Te),ve=t(97857),d=t.n(ve),xe=t(99289),N=t.n(xe),le=t(5574),j=t.n(le),Pe=t(49677),Z=t.n(Pe),de=t(95020),k=t(16894),z=t(2453),F=t(72269),l=t(67294),n=t(80854),W=t(62235),e=t(85893),ue={1:"course"},se=function(f){return f[f.COURSE=1]="COURSE",f}({}),fe=[{title:(0,e.jsx)(n.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,e.jsx)(n.FormattedMessage,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!0,sorter:!0,width:"80%",render:function(r,s){return(0,e.jsx)(W.Z,{type:"Questionnaire",type_id:Number(s.id),text:s.title})}}],M=function(r){var s=r.modelType,o=r.id,a=(0,l.useRef)(),i=(0,n.useIntl)(),c=(0,l.useCallback)(function(){var _=N()(E()().mark(function x(p,h){var A,u,v;return E()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(A=z.ZP.loading(i.formatMessage({id:"loading"})),D.prev=1,!h){D.next=8;break}return D.next=5,(0,de.cc)(ue[s],o,p);case 5:D.t0=D.sent,D.next=11;break;case 8:return D.next=10,(0,de.nX)(ue[s],o,p);case 10:D.t0=D.sent;case 11:return u=D.t0,u.success&&(A(),z.ZP.success(u.message),(v=a.current)===null||v===void 0||v.reload()),D.abrupt("return");case 16:return D.prev=16,D.t1=D.catch(1),A(),z.ZP.error((0,e.jsx)(n.FormattedMessage,{id:"error",defaultMessage:"error"})),D.abrupt("return",!1);case 21:case"end":return D.stop()}},x,null,[[1,16]])}));return function(x,p){return _.apply(this,arguments)}}(),[s,o]);return(0,e.jsx)(k.ZP,{headerTitle:i.formatMessage({id:"questionnaires",defaultMessage:"questionnaires"}),actionRef:a,rowKey:"id",search:!1,request:function(x,p){Z()(x);var h=p&&Object.entries(p)[0];return(0,de.SC)({order_by:h&&h[0],order:h?h[1]==="ascend"?"ASC":"DESC":void 0}).then(function(A){return A.success?{data:A.data,success:!0}:[]})},columns:[].concat(fe,[{title:(0,e.jsx)(n.FormattedMessage,{id:"assign",defaultMessage:"assign"}),dataIndex:"option",valueType:"option",render:function(x,p){var h;return[(0,e.jsx)(F.Z,{defaultChecked:p.models&&((h=p.models)===null||h===void 0?void 0:h.filter(function(A){return A.model_id===o}).length)>0,onChange:function(u){return c(Number(p.id),u)}},"assign")]}}])})},Ie=M,Ve=t(7418),Le=t(48959),G=t(19632),g=t.n(G),m=t(31472),O=t(61227),ge=t.n(O),X=t(60943),q=t(45919),L=t(99100),J=t(58638),C=t(14726),S=t(76841),te=function(r){var s=r.topic_id,o=r.stat,a=(0,l.useState)(!1),i=j()(a,2),c=i[0],_=i[1],x=(0,l.useCallback)(function(p){return N()(E()().mark(function h(){var A,u;return E()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(p){b.next=2;break}return b.abrupt("return");case 2:return _(!0),b.prev=3,b.next=6,(0,S.Sx)(p,o);case 6:A=b.sent,A instanceof Blob&&(u=document.createElement("a"),u.href=window.URL.createObjectURL(A),u.download="".concat(o,"_").concat(p,".xlsx"),document.body.appendChild(u),u.click(),document.body.removeChild(u)),b.next=13;break;case 10:b.prev=10,b.t0=b.catch(3),console.error(b.t0);case 13:return b.prev=13,_(!1),b.finish(13);case 16:case"end":return b.stop()}},h,null,[[3,10,13,16]])}))},[o]);return(0,e.jsxs)(C.ZP,{type:"primary",loading:c,disabled:s===void 0,onClick:x(s),children:[(0,e.jsx)(J.Z,{})," ",(0,e.jsx)(n.FormattedMessage,{id:"export"})]})},Ce=[{dataIndex:"attempt",title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.attempt"}),hideInSearch:!0,fixed:"left",width:100},{dataIndex:"email",title:(0,e.jsx)(n.FormattedMessage,{id:"email"}),hideInSearch:!0,fixed:"left"},{dataIndex:"user_id",title:(0,e.jsx)(n.FormattedMessage,{id:"user"}),hideInSearch:!0,render:function(r,s){return(0,e.jsx)(W.Z,{type:"App\\Models\\User",type_id:s.user_id})}},{dataIndex:"attempt_date",title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.attemptDate"}),hideInSearch:!0,render:function(r,s){return s.attempt_date?(0,X.WU)(new Date(s.attempt_date),q.Cu):"-"}},{dataIndex:"attempt_time",title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.attemptDuration"}),hideInSearch:!0,render:function(r,s){return s.attempt_time?"".concat(s.attempt_time,"s"):"-"}},{dataIndex:"summary",title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.result"}),hideInSearch:!0,render:function(r,s){return typeof s.summary=="number"?"".concat((s.summary*100).toFixed(2),"%"):"-"}}],K=function(r){return r!==void 0?Object.keys(r).filter(function(s){return s.includes("question")}).map(function(s,o){return{title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.question",values:{i:o+1}}),dataIndex:s,hideInSearch:!0}}):[]},U=function(r){var s,o=r.quizTopics,a=(0,l.useState)(o==null||(s=o[0])===null||s===void 0?void 0:s.id),i=j()(a,2),c=i[0],_=i[1],x=(0,l.useState)([]),p=j()(x,2),h=p[0],A=p[1],u=(0,l.useMemo)(function(){return o.reduce(function(D,P){var R=P.id,Q=P.title;return Q!==void 0&&R!==void 0?[].concat(g()(D),[{value:R,label:Q}]):D},[])},[o]),v=(0,l.useMemo)(function(){var D;return[{dataIndex:"topic_id",title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.topic"}),hideInTable:!0,valueType:"select",fieldProps:{options:u,defaultValue:u==null||(D=u[0])===null||D===void 0?void 0:D.value,allowClear:!1}}].concat(Ce,g()(h))},[u,h]),b=(0,l.useCallback)(function(){var D=N()(E()().mark(function P(R){var Q,$,Se,pe,be,we,Ue,at;return E()().wrap(function(tt){for(;;)switch(tt.prev=tt.next){case 0:if($=R.topic_id,Se=$===void 0?c:$,Se){tt.next=3;break}return tt.abrupt("return",{success:!1,data:[],total:0});case 3:return tt.next=5,(0,L.ps)(Se,m.rX.QuizSummary);case 5:if(pe=tt.sent,!(!pe.success||!((Q=pe.data)!==null&&Q!==void 0&&Q[m.rX.QuizSummary]))){tt.next=8;break}return tt.abrupt("return",{success:!1,data:[],total:0});case 8:return be=pe.data[m.rX.QuizSummary],we=ge()(be),Ue=we[0],at=we.slice(1),A(K(Ue)),tt.abrupt("return",{success:!0,data:at,total:at.length});case 11:case"end":return tt.stop()}},P)}));return function(P){return D.apply(this,arguments)}}(),[]);return(0,e.jsx)(k.ZP,{headerTitle:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.title"}),onSubmit:function(P){var R=P.topic_id;return _(R)},onReset:function(){var P;return _(o==null||(P=o[0])===null||P===void 0?void 0:P.id)},toolBarRender:function(){return[(0,e.jsx)(te,{stat:m.rX.QuizSummary,topic_id:c},"export")]},className:"table-standalone",request:b,columns:v,search:{layout:"vertical"},scroll:{x:1500}})},je=function(r){var s=r.flatTopics,o=(0,l.useMemo)(function(){var a;return s.reduce(function(i,c){return d()(d()({},i),{},I()({},c.topicable_type,[].concat(g()(i[c.topicable_type]),[c])))},(a={},I()(I()(I()(I()(I()(I()(I()(I()(I()(I()(a,m.oz.RichText,[]),m.oz.OEmbed,[]),m.oz.Audio,[]),m.oz.Video,[]),m.oz.H5P,[]),m.oz.Image,[]),m.oz.PDF,[]),m.oz.SCORM,[]),m.oz.Project,[]),m.oz.GiftQuiz,[]),I()(a,m.oz.Unselected,[])))},[s]);return(0,e.jsx)(e.Fragment,{children:o[m.oz.GiftQuiz].length>0&&(0,e.jsx)(U,{quizTopics:o[m.oz.GiftQuiz]})})},Y=t(87366),T=t(78715),H=t(71471),ae=t(74330),ne=t(38925),he=t(78677),y=function(r){var s=r.config,o=r.value,a=r.title,i=r.children,c=r.valueLabel,_=(0,l.useCallback)(function(p,h){var A,u=(A=o.find(function(v){return v.type===h.type}))===null||A===void 0?void 0:A.topic;return u?"".concat(u.topicable_type.split("\\").pop(),":").concat(u.title):p},[o]),x=(0,l.useCallback)(function(p){return{name:c||p.type,value:p.value}},[c]);return(0,e.jsx)(T.ZP,{title:a,headerBordered:!0,children:(0,e.jsxs)("div",{style:{overflow:"auto",minHeight:"400px"},children:[(0,e.jsx)(he.Z,d()(d()({},s),{},{tooltip:{formatter:x,title:_},data:o})),i&&i]})})},Ae=y,Ee=t(11312),Ze={xField:"type",yField:"value",seriesField:"type",isRange:!1,title:null,xAxis:{label:{autoHide:!0,autoRotate:!1}},interactions:[{type:"active-region",enable:!1}],columnBackground:{style:{fill:"rgba(0,0,0,0.1)"}}},Xe=function(r){var s,o,a,i,c=r.courseId,_=(0,l.useState)({mode:"init"}),x=j()(_,2),p=x[0],h=x[1],A=(0,l.useState)([]),u=j()(A,2),v=u[0],b=u[1],D=H.Z.Text,P=(0,n.useIntl)();return(0,l.useEffect)(function(){h({mode:"loading"}),Promise.all([(0,L.Nx)(Number(c)),(0,L.ue)(Number(c))]).then(function(R){var Q=j()(R,2),$=Q[0],Se=Q[1];$.success&&Se.success&&(b((0,Y.uS)($.data.lessons)),h({mode:"loaded",value:Object.entries(Se.data).map(function(pe){var be=j()(pe,2),we=be[0],Ue=be[1],at=P.formatMessage({id:we.split("\\").pop()});return{type:at,value:Ue}})}))})},[]),(0,e.jsxs)(T.ZP,{split:"vertical",children:[p.mode==="loading"&&(0,e.jsx)(ae.Z,{}),p.mode==="loaded"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ee.Du,{course_id:Number(c),topics:v,stats:(s=p.value.find(function(R){return R.type.includes("FinishedTopics")}))===null||s===void 0?void 0:s.value}),(0,e.jsx)(Ee.rL,{stats:(o=p.value.find(function(R){return R.type.includes("FinishedCourse")}))===null||o===void 0?void 0:o.value,attempts:(a=p.value.find(function(R){return R.type.includes("AttendanceList")}))===null||a===void 0?void 0:a.value}),(0,e.jsx)(Ee.nu,{stats:(i=p.value.find(function(R){return R.type.includes("AttendanceList")}))===null||i===void 0?void 0:i.value}),(0,e.jsxs)(D,{children:[(0,e.jsx)(n.FormattedMessage,{id:"MoneyEarned"}),": ".concat(p.value.find(function(R){return R.type.split("\\").pop()===P.formatMessage({id:"MoneyEarned"})}).value)]}),(0,e.jsx)(T.ZP,{colSpan:12,layout:"center",children:(0,e.jsx)(Ae,{config:Ze,title:(0,e.jsx)(n.FormattedMessage,{id:"People"}),value:p.value.filter(function(R){var Q=R.type.split("\\").pop();return Q===P.formatMessage({id:"PeopleBought"})||Q===P.formatMessage({id:"PeopleFinished"})||Q===P.formatMessage({id:"PeopleStarted"})})})}),(0,e.jsx)(T.ZP,{colSpan:12,layout:"center",children:(0,e.jsx)(Ae,{config:Ze,title:(0,e.jsx)(n.FormattedMessage,{id:"AverageTimePerTopic"}),valueLabel:P.formatMessage({id:"seconds",defaultMessage:"seconds"}),value:Object.entries(p.value.find(function(R){return R.type.split("\\").pop()===P.formatMessage({id:"AverageTimePerTopic"})}).value).map(function(R){var Q;return{type:R[0],value:(Q=R[1])===null||Q===void 0?void 0:Q.average_time,topic:v.find(function($){return $.id===Number(R[0])})}}),children:(0,e.jsxs)(D,{children:[(0,e.jsx)(n.FormattedMessage,{id:"AverageTime"}),`:
                    `.concat(p.value.find(function(R){return R.type.split("\\").pop()===P.formatMessage({id:"AverageTime"})}).value,`
                  `)]})})}),(0,e.jsx)(T.ZP,{children:(0,e.jsx)(je,{flatTopics:v})})]}),p.mode==="error"&&(0,e.jsx)(ne.Z,{message:p.error,type:"error"})]})},Ke=Xe,Qe=t(28225),it=t(95486),Mt=t(23535),me=t(952),Ot=t(22004),Et=t.n(Ot),wt=t(82238),Me=function(r){var s=r.action,o=r.form_name,a=r.src_name,i=r.getUploadedSrcField,c=r.setPath,_=r.folder,x=r.hideLabel;return(0,e.jsxs)(me.ZP.Group,{title:(0,e.jsx)(n.FormattedMessage,{id:"video"}),children:[(0,e.jsx)(me.ZP.Item,{shouldUpdate:!0,children:function(h){return(0,e.jsxs)(l.Fragment,{children:[(0,e.jsx)(wt.Z,{folder:_,accept:"video/*",name:o,url:s,onChange:function(u){if(u.file.status==="done"){var v;if(h.setFieldsValue(I()({},a,i(u))),(v=u.file.response)!==null&&v!==void 0&&v.success){var b=u.file.response.data;c(I()(I()({},"".concat(o,"_url"),b["".concat(o,"_url")]),"".concat(o,"_path"),b["".concat(o,"_path")]))}}},hideLabel:x}),(0,e.jsx)(C.ZP,{danger:!0,onClick:function(){return[c(I()(I()({},"".concat(o,"_url"),""),"".concat(o,"_path"),"")),h.setFieldsValue(I()({},a,""))]},children:(0,e.jsx)(n.FormattedMessage,{id:"delete"})})]})}}),(0,e.jsx)(me.ZP.Item,{shouldUpdate:!0,children:function(h){var A=h.getFieldValue(a);return A?(0,e.jsx)(Et(),{width:"auto",height:200,url:A,controls:!0}):(0,e.jsx)(e.Fragment,{})}})]})},$e=Me,Fe=t(53957),ie=t(71230),re=t(15746),Re=t(8266),rt=t(64599),ht=t.n(rt),Tt=function(r){var s=new FormData;for(var o in r)if(r[o]!=null||r[o]!=null){if(Array.isArray(r[o])){r[o].length||s.append("".concat(o,"[]"),"[]");var a=ht()(r[o]),i;try{for(a.s();!(i=a.n()).done;){var c=i.value;s.append("".concat(o,"[]"),c)}}catch(_){a.e(_)}finally{a.f()}continue}s.set(o,r[o])}return s},Ct=t(5966),Bt=t(52688),kt=t(50335),An=t(64218),Nt=t(78957),Zn=t(86738),Vt=t(96074),Fn=t(35614),On=t(2291),It=t(19411),Br=t(19054),Nr=function f(r,s,o){return r.reduce(function(a,i){var c,_=s===i.id;return[].concat(g()(a),[{value:i.id,title:i.title,label:i.title,disabled:o||_,children:f((c=i==null?void 0:i.lessons)!==null&&c!==void 0?c:[],s,_||o)}])},[])},Dn=function(r){var s=r.name,o=r.currentLessonId,a=(0,n.useIntl)(),i=(0,l.useContext)(Y._y),c=i.state,_=(0,l.useMemo)(function(){var x;return[{value:"",title:a.formatMessage({id:"root",defaultMessage:"Root"}),label:a.formatMessage({id:"root",defaultMessage:"Root"}),children:Nr((x=c==null?void 0:c.lessons)!==null&&x!==void 0?x:[],o)}]},[c,o]);return(0,e.jsx)("div",{className:"tree-select",children:(0,e.jsx)(Br.Z,{name:s,label:(0,e.jsx)(n.FormattedMessage,{id:"parent_lesson"}),fieldProps:{treeData:_,treeDefaultExpandAll:!0,treeLine:!0}})})},zr=function(r){var s=r.onFinish,o=r.onValuesChange,a=r.onDelete,i=r.onClone,c=r.initialValues,_=r.lesson,x=r.loading,p=x===void 0?!1:x,h=(0,l.useContext)(Y._y),A=h.isAssistant,u=me.ZP.useForm(),v=j()(u,1),b=v[0],D=me.ZP.useWatch("active_from",b),P=me.ZP.useWatch("active_to",b),R=(0,n.useIntl)();return(0,e.jsx)(me.ZP,{form:b,submitter:{render:function($){return(0,e.jsx)(ie.Z,{gutter:16,children:(0,e.jsx)(re.Z,{span:16,children:(0,e.jsx)(ie.Z,{justify:"center",className:"program__cta-footer",children:(0,e.jsx)(An.Z,{offsetBottom:4,children:(0,e.jsxs)(Nt.Z,{size:"large",children:[(0,e.jsx)(C.ZP,d()(d()({loading:p,type:"primary",onClick:function(){var pe;return(pe=$.form)===null||pe===void 0?void 0:pe.submit()}},$.submitButtonProps),{},{children:_.isNew?(0,e.jsx)(n.FormattedMessage,{id:"create"}):(0,e.jsx)(n.FormattedMessage,{id:"save"})}),"submit"),!_.isNew&&(0,e.jsx)(C.ZP,{onClick:i,loading:p,children:(0,e.jsx)(n.FormattedMessage,{id:"clone"})}),(0,e.jsx)(Zn.Z,{onConfirm:a,title:(0,e.jsx)(n.FormattedMessage,{id:"deleteQuestion"}),okText:(0,e.jsx)(n.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(n.FormattedMessage,{id:"no"}),children:(0,e.jsx)(C.ZP,d()(d()({type:"primary",danger:!0},$.submitButtonProps),{},{loading:p,children:(0,e.jsx)(n.FormattedMessage,{id:"delete"})}))},"delete")]})})})})})}},layout:"vertical",onFinish:s,onValuesChange:o,initialValues:d()(d()({},c),{},{summary:c.summary||""}),style:{height:"100%"},children:(0,e.jsxs)(ie.Z,{gutter:16,style:{height:"100%"},children:[(0,e.jsxs)(re.Z,{span:16,children:[(0,e.jsx)(Vt.Z,{children:(0,e.jsx)(n.FormattedMessage,{id:"lesson"})}),(0,e.jsxs)(T.ZP,{children:[(0,e.jsx)(Ct.Z,{name:"title",label:(0,e.jsx)(n.FormattedMessage,{id:"title"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"title"}),placeholder:R.formatMessage({id:"title"}),required:!0,labelCol:{span:5}}),(0,e.jsx)(me.ZP.Item,{name:"summary",label:(0,e.jsx)(n.FormattedMessage,{id:"summary"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"summary_tooltip"}),valuePropName:"value",labelCol:{span:5},children:(0,e.jsx)(It.ZP,{directory:"course/".concat(_.course_id,"/lesson/").concat(_.id,"/wysiwyg")})})]})]}),(0,e.jsx)(re.Z,{span:8,children:(0,e.jsxs)("aside",{className:"program-sidebar program-sidebar--right",children:[(0,e.jsx)(Ct.Z,{name:"duration",label:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),placeholder:R.formatMessage({id:"duration"})}),(0,e.jsx)(Bt.Z,{name:"active",label:(0,e.jsx)(n.FormattedMessage,{id:"is_active"})}),(0,e.jsx)(kt.Z,{allowClear:!1,width:"lg",name:"active_from",label:(0,e.jsx)(n.FormattedMessage,{id:"active_from"}),placeholder:R.formatMessage({id:"active_from",defaultMessage:"active_from"}),rules:[{validator:function($,Se){return Se&&P&&(0,Fn.A)(new Date(Se),new Date(P))?Promise.reject(new Error(R.formatMessage({id:"invalidDate"}))):Promise.resolve()}}]}),(0,e.jsx)(kt.Z,{allowClear:!1,width:"lg",name:"active_to",label:(0,e.jsx)(n.FormattedMessage,{id:"active_to"}),placeholder:R.formatMessage({id:"active_to",defaultMessage:"active_to"}),disabled:!D&&!P,rules:[{validator:function($,Se){return Se&&D&&(0,On.R)(new Date(Se),new Date(D))?Promise.reject(new Error(R.formatMessage({id:"invalidDate"}))):Promise.resolve()}}]}),(0,e.jsx)(Dn,{name:"parent_id",currentLessonId:_==null?void 0:_.id}),A&&(0,e.jsx)(Ct.Z,{name:"assistant_id",label:(0,e.jsx)(n.FormattedMessage,{id:"assistant_id",defaultMessage:"Assistant ID"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"assistant_id_tooltip"}),placeholder:R.formatMessage({id:"Assistant ID"})})]})})]})})},$r=zr,Ln=function(r){var s;return d()(d()({},r),{},{parent_id:(s=r.parent_id)!==null&&s!==void 0?s:""})},Wr=function(){var r=(0,l.useContext)(Y._y),s=r.updateLesson,o=r.deleteLesson,a=r.cloneLesson,i=r.currentEditMode,c=i&&i.mode==="lesson"&&i.value?i.value:{},_=(0,l.useState)(Ln(c)),x=j()(_,2),p=x[0],h=x[1],A=(0,l.useState)([]),u=j()(A,2),v=u[1],b=(0,l.useState)(!1),D=j()(b,2),P=D[0],R=D[1],Q=(0,n.useParams)();(0,l.useEffect)(function(){return h(Ln(c)),(c==null?void 0:c.topics)&&v(c.topics)},[c]);var $=(0,l.useCallback)(function(){R(!0);var be=Tt(d()(d()({course_id:(c==null?void 0:c.course_id)||Q.course},p),{},{active:p.active?1:0,parent_lesson_id:p.parent_id}));return s&&p.id?s(p.id,be).then(function(){return R(!1)}).catch(function(we){console.error(we),R(!1)}):Promise.resolve()},[p,c==null?void 0:c.course_id,s]),Se=(0,l.useCallback)(function(){return p.id&&o&&o(p.id),Promise.resolve()},[o,p.id]),pe=(0,l.useCallback)(function(){return p.id&&(a==null?void 0:a(p.id))},[a,p.id]);return(0,e.jsx)($r,{loading:P,lesson:p,initialValues:p,onDelete:Se,onFinish:$,onClone:pe,onValuesChange:function(we){h(function(Ue){return d()(d()({},Ue),we)})}})},Kr=Wr,kr=t(54734),Rn=t(55725),en=t(51042),Un=t(75625),Vr=t(62848),lt=t(83062),Gr=t(65400),Gt=t.n(Gr),wn=t(74253),Pt=t(43669),tn=t(28248),Hr=function(r){var s=r.handleOk,o=r.isModalVisible,a=r.initialValues,i=r.courseId;return(0,e.jsxs)(tn.Z,{title:(0,e.jsx)(Pt._H,{id:"description"}),visible:o,onOk:s,onCancel:s,width:1e3,footer:[(0,e.jsx)(C.ZP,{type:"primary",onClick:s,children:"Ok"},"back")],children:[(0,e.jsx)(me.ZP.Item,{name:"introduction",label:(0,e.jsx)(Pt._H,{id:"introduction"}),labelCol:{span:5},wrapperCol:{span:19},tooltip:(0,e.jsx)(Pt._H,{id:"introduction_tooltip"}),valuePropName:"value",children:(0,e.jsx)(It.ZP,{directory:"course/".concat(i,"/lesson/").concat(a.lesson_id,"/topic/").concat(a.id,"/wysiwyg")})}),(0,e.jsx)(me.ZP.Item,{name:"description",label:(0,e.jsx)(Pt._H,{id:"description"}),labelCol:{span:5},wrapperCol:{span:19},tooltip:(0,e.jsx)(Pt._H,{id:"description_tooltip"}),valuePropName:"value",children:(0,e.jsx)(It.ZP,{directory:"course/".concat(i,"/lesson/").concat(a.lesson_id,"/topic/").concat(a.id,"/wysiwyg")})}),(0,e.jsx)(me.ZP.Item,{name:"summary",label:(0,e.jsx)(Pt._H,{id:"summary"}),labelCol:{span:5},wrapperCol:{span:19},tooltip:(0,e.jsx)(Pt._H,{id:"summary_tooltip"}),valuePropName:"value",children:(0,e.jsx)(It.ZP,{directory:"course/".concat(i,"/lesson/").concat(a.lesson_id,"/topic/").concat(a.id,"/wysiwyg")})})]})},Qr=function(r){var s=r.onValuesChange,o=r.initialValues,a=r.courseId,i=(0,n.useIntl)(),c=l.useState(!1),_=j()(c,2),x=_[0],p=_[1];return(0,e.jsxs)(me.ZP,{submitter:!1,onValuesChange:s,initialValues:d()({},o),layout:"horizontal",children:[(0,e.jsx)(Ct.Z,{name:"title",label:(0,e.jsx)(n.FormattedMessage,{id:"title"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"title"}),placeholder:i.formatMessage({id:"title",defaultMessage:"title"}),required:!0}),(0,e.jsx)(Ct.Z,{name:"duration",label:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),placeholder:i.formatMessage({id:"duration"})}),(0,e.jsx)(Dn,{name:"lesson_id"}),(0,e.jsx)(me.ZP.Item,{label:(0,e.jsx)(n.FormattedMessage,{id:"description"}),children:(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return p(!0)},children:(0,e.jsx)(n.FormattedMessage,{id:"open_editor"})})}),(0,e.jsx)(Bt.Z,{name:"active",label:(0,e.jsx)(n.FormattedMessage,{id:"is_active"})}),(0,e.jsx)(Bt.Z,{name:"preview",label:(0,e.jsx)(n.FormattedMessage,{id:"able_to_preview"})}),(0,e.jsx)(Bt.Z,{name:"can_skip",label:(0,e.jsx)(n.FormattedMessage,{id:"can_skip"})}),(0,e.jsx)(me.ZP.Item,{name:"json",label:(0,e.jsx)(n.FormattedMessage,{id:"json"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"json_tooltip"}),valuePropName:"value",children:(0,e.jsx)(it.Z,{})}),(0,e.jsx)(Hr,{isModalVisible:x,handleOk:function(){return p(!1)},initialValues:o,courseId:a})]})},Jr=Qr,nn=function(r){if(typeof(r==null?void 0:r.topicable_type)!="string"||!r.topicable_type)return"Unknown";var s=((r==null?void 0:r.topicable_type)||"").split("\\");return s.pop()||"Unknown"},Bn=t(97704),Dt=t(66419),At=t(74656),Yr=function(r){var s=r.value,o=r.onChange,a=r.multiple,i=a===void 0?!1:a,c=(0,l.useState)([]),_=j()(c,2),x=_[0],p=_[1];return(0,l.useEffect)(function(){(0,Bn.gq)().then(function(h){return h.success&&p(h.data)})},[]),(0,l.useEffect)(function(){x.length&&(x.find(function(h){return Number(h.id)===Number(s)})||(0,Bn.gq)().then(function(h){return h.success&&p(h.data)}))},[s]),(0,e.jsx)(At.default,{loading:x.length===0,style:{width:"100%"},value:s,onChange:o,mode:i?"multiple":void 0,showSearch:!0,placeholder:(0,e.jsx)(n.FormattedMessage,{id:"H5P_select_content"}),optionFilterProp:"children",filterOption:function(A,u){var v,b=u==null||(v=u.children)===null||v===void 0?void 0:v.slice(1,u==null?void 0:u.children.length).join("");return(0,Dt.ri)(b,A)},children:x.map(function(h){return(0,e.jsxs)(At.default.Option,{value:h.id.toString(),children:[(0,e.jsx)("small",{children:h.id})," ",h.title," (",h.library.title,")"]},h.id.toString())})})},Xr=Yr,qr=t(9412),ea=t(89825),ta=function(r){var s=r.id,o=r.onChange,a=(0,n.useIntl)(),i=(0,l.useState)(s==="new"||s===void 0?"new":Number(s)),c=j()(i,2),_=c[0],x=c[1];return(0,e.jsxs)(l.Fragment,{children:[(0,e.jsxs)(ie.Z,{gutter:16,align:"middle",className:"create-new",children:[(0,e.jsx)(re.Z,{children:(0,e.jsxs)(C.ZP,{type:"primary",onClick:function(){return x("new")},children:[" ",(0,e.jsx)(n.FormattedMessage,{id:"create_new"})]})}),(0,e.jsx)(re.Z,{span:4,children:(0,e.jsxs)(H.Z,{children:[(0,e.jsx)("small",{children:(0,e.jsx)(n.FormattedMessage,{id:"or"})})," ",(0,e.jsx)(n.FormattedMessage,{id:"reuse_existing"})]})}),(0,e.jsx)(re.Z,{span:12,children:(0,e.jsx)(Xr,{value:s,onChange:function(h){o(h),x(s==="new"?"new":Number(s))}})})]}),(0,e.jsx)(ie.Z,{style:{marginTop:"30px"},children:(0,e.jsx)(re.Z,{span:24,children:(0,e.jsx)(ea.Z,{id:_,onSubmit:function(h){return o(String(h))}},_)})}),(0,e.jsx)(Vt.Z,{}),(0,e.jsx)(ie.Z,{gutter:16,children:(0,e.jsx)(re.Z,{span:24,children:(0,e.jsx)(ie.Z,{children:(0,e.jsx)(qr.C,{onSuccess:function(h){h.data.id&&o(String(h.data.id))},onError:function(){return console.log(a.formatMessage({id:"error"}))}})})})})]})},na=ta,Nn=t(55102),ra=t(98980),aa=t.n(ra),sa=[{provider_name:"YouTube",provider_url:"https://www.youtube.com/",endpoints:[{schemes:["https://*.youtube.com/watch*","https://*.youtube.com/v/*","https://youtu.be/*","https://*.youtube.com/shorts/*","https://youtube.com/shorts/*"],url:"https://www.youtube.com/oembed",discovery:!0}]},{provider_name:"Reddit",provider_url:"https://reddit.com/",endpoints:[{schemes:["https://reddit.com/r/*/comments/*/*","https://www.reddit.com/r/*/comments/*/*"],url:"https://www.reddit.com/oembed"}]},{provider_name:"Flickr",provider_url:"https://www.flickr.com/",endpoints:[{schemes:["http://*.flickr.com/photos/*","http://flic.kr/p/*","https://*.flickr.com/photos/*","https://flic.kr/p/*"],url:"https://www.flickr.com/services/oembed/",discovery:!0}]},{provider_name:"Vimeo",provider_url:"https://vimeo.com/",endpoints:[{schemes:["https://vimeo.com/*","https://vimeo.com/album/*/video/*","https://vimeo.com/channels/*/*","https://vimeo.com/groups/*/videos/*","https://vimeo.com/ondemand/*/*","https://player.vimeo.com/video/*"],url:"https://vimeo.com/api/oembed.{format}",discovery:!0}]},{provider_name:"SoundCloud",provider_url:"http://soundcloud.com/",endpoints:[{schemes:["http://soundcloud.com/*","https://soundcloud.com/*","https://soundcloud.app.goog.gl/*"],url:"https://soundcloud.com/oembed"}]},{provider_name:"Twitter",provider_url:"http://www.twitter.com/",endpoints:[{schemes:["https://twitter.com/*/status/*","https://*.twitter.com/*/status/*","https://twitter.com/*/moments/*","https://*.twitter.com/*/moments/*"],url:"https://publish.twitter.com/oembed"}]},{provider_name:"GIPHY",provider_url:"https://giphy.com",endpoints:[{schemes:["https://giphy.com/gifs/*","http://gph.is/*","https://media.giphy.com/media/*/giphy.gif"],url:"https://giphy.com/services/oembed",discovery:!0}]}],ia=function(r){return(0,e.jsx)(aa(),d()(d()({},r),{},{providers:sa}))},oa=function(r){var s=r.text,o=r.onChange,a=(0,l.useState)(s),i=j()(a,2),c=i[0],_=i[1],x=(0,l.useState)(s),p=j()(x,2),h=p[0],A=p[1];return(0,e.jsxs)(l.Fragment,{children:[(0,e.jsxs)(ie.Z,{children:[(0,e.jsx)(Nn.Z,{value:s,onChange:function(v){_(v.target.value),o(v.target.value)}}),(0,e.jsx)(C.ZP,{onClick:function(){return A(c)},children:(0,e.jsx)(n.FormattedMessage,{id:"preview"})})]}),(0,e.jsx)(ie.Z,{children:h&&(0,e.jsx)(ia,{url:h},h)})]})},la=oa,da=function(r){var s=r.text,o=r.onChange,a=r.directory,i=a===void 0?"topics/new":a;return(0,e.jsx)("div",{children:(0,e.jsx)(It.ZP,{directory:i,value:s,onChange:function(_){o(_)}})})},ua=da,ca=t(26859),ma=t(72252),pa=t(38703),zn=t(97042),va=t(16085),fa=t(59037);zn.default.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(zn.default.version,"/pdf.worker.min.js");var ga={acceptedTypes:I()(I()(I()({audio:".mp3,audio/*",video:".mp3,video/*",document:".doc,.docx,.pdf,.zip"},m.oz.Audio,".mp3,audio/*"),m.oz.Video,".mp3,video/*"),m.oz.PDF,".pdf,application/pdf")},_a=function(r){var s={},o;for(o in r)switch(B()(r[o])){case"boolean":s[o]=r[o]?1:0;break;case"object":s[o]=JSON.stringify(r[o]);break;case"string":case"number":s[o]=r[o];break;default:break}return s},ha=function(r){var s=r.file,o=(0,l.useState)(0),a=j()(o,2),i=a[0],c=a[1],_=(0,l.useState)(1),x=j()(_,2),p=x[0],h=x[1];return(0,e.jsxs)("div",{children:[i===0?(0,e.jsx)(ae.Z,{}):(0,e.jsxs)("div",{style:{margin:"0.5em 0"},children:[(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(n.FormattedMessage,{id:"page"}),":"]}),(0,e.jsx)(ma.Z,{defaultPageSize:1,size:"small",total:i,onChange:function(u){return h(u)},simple:!0})]}),(0,e.jsx)(va.Z,{file:s,onLoadSuccess:function(u){var v=u.numPages;return c(v)},children:(0,e.jsx)(fa.Z,{pageNumber:p,className:"pdf-preview"})})]})},ja=function(r){var s,o=r.topic,a=(0,l.useContext)(Y._y),i=a.getLessons;if((0,l.useEffect)(function(){var _;if(((_=o.json)===null||_===void 0?void 0:_.ffmpeg.state)==="coding"){var x=setTimeout(function(){i&&i()},1e3);return function(){return clearTimeout(x)}}},[]),((s=o.json)===null||s===void 0?void 0:s.ffmpeg.state)==="coding"){var c;return(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(n.FormattedMessage,{id:"encoding_progress",defaultMessage:"Encoding progress:"}),(0,e.jsx)(pa.Z,{percent:(c=o.json)===null||c===void 0||(c=c.ffmpeg)===null||c===void 0?void 0:c.percentage})]})}return(0,e.jsx)(l.Fragment,{})},xa=function(r){var s,o,a,i,c=r.type,_=r.topic;if(_&&_.topicable&&"url"in _.topicable)switch(c){case m.oz.Audio:return _.topicable_type===m.oz.Audio&&(s=_.topicable)!==null&&s!==void 0&&s.url?(0,e.jsx)("audio",{preload:"none",controls:!0,src:_.topicable.url}):(0,e.jsx)(l.Fragment,{});case m.oz.Video:return _.topicable_type===m.oz.Video&&(o=_.topicable)!==null&&o!==void 0&&o.url?(0,e.jsx)("video",{controls:!0,src:_.topicable.url,width:"100%"}):(0,e.jsx)(l.Fragment,{});case m.oz.Image:return _.topicable_type===m.oz.Image&&(a=_.topicable)!==null&&a!==void 0&&a.url?(0,e.jsx)("img",{title:"Topic image",src:_.topicable.url,width:"100%"}):(0,e.jsx)(l.Fragment,{});case m.oz.PDF:return _.topicable_type===m.oz.PDF&&(i=_.topicable)!==null&&i!==void 0&&i.url?(0,e.jsx)(ha,{file:_.topicable.url}):(0,e.jsx)(l.Fragment,{});default:return(0,e.jsx)(l.Fragment,{})}return(0,e.jsx)(l.Fragment,{})},ba=function(r){var s=r.topic,o=r.type,a=r.onUpdate,i=r.disabled,c=i===void 0?!1:i,_=r.currentState,x=r.onChange,p=r.folder,h=r.maxFiles,A=r.clearListAfterUpload,u=(0,l.useCallback)(function(b){return b.file.status==="done"?a&&a(b):x&&x(b)},[a,x]),v=d()(d()({},_),{},{topicable_type:o,active:_.active?1:0,preview:_.preview?1:0,can_skip:_.can_skip?1:0});return v.introduction||v==null||delete v.introduction,v.description||v==null||delete v.description,v.summary||v==null||delete v.summary,v.json||v==null||delete v.json,(0,e.jsxs)(l.Fragment,{children:[(0,e.jsx)(ie.Z,{children:(0,e.jsx)(wt.Z,{folder:p,onChange:u,name:"value",url:s.isNew?"/api/admin/topics":"/api/admin/topics/".concat(s.id,"?_method=PUT"),accept:ga.acceptedTypes[o],data:_a(v),maxFiles:h,clearListAfterUpload:A,children:(0,e.jsxs)(C.ZP,{disabled:c,icon:(0,e.jsx)(ca.Z,{}),children:["Click to upload ",o]})})}),(0,e.jsx)(ie.Z,{children:(0,e.jsxs)("div",{style:{padding:"0 12px"},children:[s.topicable_type===m.oz.Video&&(0,e.jsx)(ja,{topic:s}),(0,e.jsx)(xa,{type:o,topic:_})]})})]})},Ma=ba,$n=t(82061),Pa=t(69753),rn=t(2487),Ca=function(r){var s=r.topicId,o=r.folder,a=(0,l.useState)(),i=j()(a,2),c=i[0],_=i[1],x=(0,l.useRef)(),p=(0,l.useCallback)(function(){x.current&&x.current.abort(),x.current=new AbortController,(0,L.Jb)(s,{signal:x.current.signal}).then(function(u){u&&u.success&&_(u.data)})},[s]),h=(0,l.useCallback)(function(u){u&&u.success&&(0,L.Jb)(s).then(function(v){v&&v.success&&_(v.data)})},[]),A=(0,l.useCallback)(function(u){(0,L.fg)(s,u).then(function(v){v.success&&p()})},[s]);return(0,l.useEffect)(function(){p()},[s]),(0,e.jsx)(rn.Z,{size:"small",itemLayout:"horizontal",dataSource:c,header:(0,e.jsx)(wt.Z,{folder:o,url:"/api/admin/topics/".concat(s,"/resources"),name:"resource",onChange:function(v){if(v.file.status==="done"){var b;(b=v.file.response)!==null&&b!==void 0&&b.success&&h(v.file.response)}}}),renderItem:function(v){return(0,e.jsx)(rn.Z.Item,{actions:[(0,e.jsx)(C.ZP,{type:"default",danger:!0,icon:(0,e.jsx)($n.Z,{}),size:"small",onClick:function(){return A(v.id)}},"delete")],children:(0,e.jsx)(rn.Z.Item.Meta,{avatar:(0,e.jsx)("a",{href:v.url,target:"_blank",rel:"noreferrer",children:(0,e.jsx)(C.ZP,{type:"default",icon:(0,e.jsx)(Pa.Z,{}),size:"small"})}),description:(0,e.jsx)(l.Fragment,{children:(0,e.jsx)(C.ZP,{type:"text",size:"small",children:v.name})})})})}})},ya=Ca,Ea=t(75175),Sa=t(9649),Ta=function(r){var s=r.value,o=r.onChange,a=(0,l.useState)([]),i=j()(a,2),c=i[0],_=i[1],x=(0,l.useState)(!1),p=j()(x,2),h=p[0],A=p[1],u=(0,l.useState)(),v=j()(u,2),b=v[0],D=v[1],P=(0,l.useState)(),R=j()(P,2),Q=R[0],$=R[1],Se=(0,l.useRef)(),pe=(0,l.useCallback)(function(we){A(!0),Se.current&&Se.current.abort(),Se.current=new AbortController,(0,Sa.JZ)({search:we,pageSize:0},{signal:Se.current.signal}).then(function(Ue){if(Ue.success)return Array.isArray(Ue.data.data)&&_(Ue.data.data);A(!1)}).catch(function(){return A(!1)})},[]),be=(0,l.useCallback)(function(we){pe(we)},[pe]);return(0,l.useEffect)(function(){pe()},[s]),(0,l.useEffect)(function(){D(c.map(function(we){return we.scos.filter(function(Ue){return Ue.id===s})}).flat()[0])},[c]),(0,e.jsxs)(l.Fragment,{children:[Q&&(0,e.jsx)(tn.Z,{width:"80vw",bodyStyle:{height:"70vh"},visible:!0,onOk:function(){return $(void 0)},onCancel:function(){return $(void 0)},children:(0,e.jsx)(Ea.Z,{uuid:Q})}),(0,e.jsxs)(Nt.Z,{children:[(0,e.jsx)(At.default,{allowClear:!0,style:{width:"100%",minWidth:"300px"},value:b?"".concat(b==null?void 0:b.id,": ").concat(b==null?void 0:b.title):void 0,onChange:function(Ue){return o&&o(Ue&&Ue.split(":")[0])},showSearch:!0,onSearch:be,placeholder:(0,e.jsx)(n.FormattedMessage,{id:"select_scorm_package"}),optionFilterProp:"children",filterOption:function(Ue,at){if(at&&at.children){var pt;return(at==null||(pt=at.children)===null||pt===void 0?void 0:pt.toString().toLowerCase().indexOf(Ue.toLowerCase()))>=0}return!0},notFoundContent:h?(0,e.jsx)(ae.Z,{size:"small"}):null,children:c.map(function(we){return(0,e.jsx)(At.default.OptGroup,{label:"".concat(we.id,": ").concat(we.version),children:(0,e.jsx)(l.Fragment,{children:we.scos.map(function(Ue){return(0,e.jsx)(At.default.Option,{value:"".concat(Ue.id,": ").concat(Ue.title),children:Ue.title},Ue.id)})})},we.id)})}),b&&(0,e.jsx)(C.ZP,{onClick:function(){$(b==null?void 0:b.uuid)},children:(0,e.jsx)(n.FormattedMessage,{id:"preview"})},s)]})]})},Ia=Ta,Aa=function(r){var s=r.value,o=r.onChange;return(0,e.jsxs)(Nt.Z,{size:"large",align:"start",children:[(0,e.jsx)(Ia,{value:s,onChange:function(i){return o&&o(Number(i))}}),(0,e.jsx)(C.ZP,{onClick:function(){return o&&o(void 0)},children:(0,e.jsx)(n.FormattedMessage,{id:"clear_selection"})})]})},Wn=Aa,an=t(4828),sn=t(49354),on=t(35102),ln=t(45699),dn=t(35326),un=t(67337),cn=t(68432),mn=t(15360),pn=t(43973),vn=t(57619),Za=t(11475),Fa=t(38751),Oa=t(24739),Ht=t(31199),Da=t(89652),La=function(r){var s=r.topicable,o=r.onAdded,a=r.onRemoved,i=r.onEdited,c=r.onChange,_=(0,n.useIntl)();return(0,e.jsxs)(l.Fragment,{children:[(0,e.jsx)(me.ZP,{initialValues:{max_attempts:s?s.max_attempts:void 0,max_execution_time:s?s.max_execution_time:void 0,min_pass_score:s?s.min_pass_score:void 0},onValuesChange:function(p){var h=Object.keys(p)[0];h&&c(h,p[h])},submitter:!1,children:(0,e.jsxs)(Oa.UW,{children:[(0,e.jsx)(Ht.Z,{name:"max_attempts",label:(0,e.jsx)(n.FormattedMessage,{id:"max_attempts"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"max_attempts"}),placeholder:_.formatMessage({id:"max_attempts",defaultMessage:"max_attempts"})}),(0,e.jsx)(Ht.Z,{name:"max_execution_time",label:(0,e.jsx)(n.FormattedMessage,{id:"max_execution_time"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"max_execution_time_tooltip"}),placeholder:_.formatMessage({id:"max_execution_time",defaultMessage:"max_execution_time"})}),(0,e.jsx)(Ht.Z,{name:"min_pass_score",max:100,label:(0,e.jsx)(n.FormattedMessage,{id:"min_pass_score"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"min_pass_score_tooltip"}),placeholder:_.formatMessage({id:"min_pass_score",defaultMessage:"min_pass_score"})})]})}),(0,e.jsx)(Vt.Z,{}),s?(0,e.jsx)(Fa.i,{questions:s.questions,quizId:s.id,onAdded:o,onEdited:i,onRemoved:a}):(0,e.jsx)(Da.default,{children:(0,e.jsx)(n.FormattedMessage,{id:"pressSaveToCreateQuestions",defaultMessage:"Create this Topic before adding questions"})})]})},Ra=La,Qt=t(44167),Ua=function(r){var s,o=r.onChange,a=r.topicable,i=(0,l.useCallback)(function(c){var _=Object.keys(c)[0];_&&o(c[_])},[]);return(0,e.jsx)(l.Fragment,{children:(0,e.jsx)(me.ZP,{initialValues:{notify_users:(s=a==null?void 0:a.notify_users)!==null&&s!==void 0?s:[]},onValuesChange:i,submitter:!1,children:(0,e.jsx)(me.ZP.Item,{name:"notify_users",label:(0,e.jsx)(n.FormattedMessage,{id:"notify_users",defaultMessage:"Users to notify"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"notify_users_tooltip",defaultMessage:"Indicate which users should be notified about project upload"}),children:(0,e.jsx)(Qt.Z,{multiple:!0})})})})},wa=Ua,Kn=function(r){if(r)switch(r){case"ScormSco":return(0,e.jsx)(an.Z,{});case"PDF":return(0,e.jsx)(sn.Z,{});case"Audio":return(0,e.jsx)(on.Z,{});case"Image":return(0,e.jsx)(ln.Z,{});case"OEmbed":return(0,e.jsx)(dn.Z,{});case"H5P":return(0,e.jsx)(un.Z,{});case"Video":return(0,e.jsx)(cn.Z,{});case"RichText":return(0,e.jsx)(mn.Z,{});case"Project":return(0,e.jsx)(pn.Z,{});case"GiftQuiz":return(0,e.jsx)(vn.Z,{})}return(0,e.jsx)(Za.Z,{})},kn=function(r){return[m.oz.GiftQuiz,m.oz.Project,m.oz.GiftQuiz].includes(r)},Ba=function(){var r,s,o,a=(0,l.useContext)(Y._y),i=a.state,c=a.currentEditMode,_=a.updateTopic,x=a.deleteTopic,p=a.onTopicUploaded,h=a.cloneTopic,A=a.getLessons,u=c&&c.mode==="topic"&&c.value?c.value:{},v=(0,l.useState)(!1),b=j()(v,2),D=b[0],P=b[1],R=(0,l.useState)(d()(d()({},u),{},{value:u==null||(r=u.topicable)===null||r===void 0?void 0:r.value,can_skip:u.isNew?!0:u.can_skip})),Q=j()(R,2),$=Q[0],Se=Q[1],pe=$.topicable_type,be=(0,l.useState)($.order),we=j()(be,1),Ue=we[0],at=(0,l.useState)(!1),pt=j()(at,2),tt=pt[0],_e=pt[1],ee=(0,l.useState)(u),ce=j()(ee,2),w=ce[0],Ge=ce[1];(0,l.useEffect)(function(){Ge(u)},[u]),(0,l.useEffect)(function(){Se(function(Be){var V;return d()(d()(d()({},Be),u),{},{value:pe===(u==null?void 0:u.topicable_type)?u==null||(V=u.topicable)===null||V===void 0?void 0:V.value:""})}),u!=null&&u.isNew&&P(!kn(u.topicable_type))},[pe,u]),(0,l.useEffect)(function(){var Be,V;if(!((w==null?void 0:w.topicable_type)!==m.oz.Video||!((Be=w.json)!==null&&Be!==void 0&&Be.ffmpeg.state)||((V=w.json)===null||V===void 0?void 0:V.ffmpeg.state)==="finished")){var et=function(){var Ye=N()(E()().mark(function ot(){var ke;return E()().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:if(!u.id){ut.next=5;break}return ut.next=3,(0,L.BN)(u.id);case 3:ke=ut.sent,ke.success&&Ge(ke.data);case 5:case"end":return ut.stop()}},ot)}));return function(){return Ye.apply(this,arguments)}}(),dt=window.setInterval(et,5e3);return function(){window.clearInterval(dt)}}},[w==null?void 0:w.topicable_type,(s=w.json)===null||s===void 0||(s=s.ffmpeg)===null||s===void 0?void 0:s.state]);var ye=(0,l.useCallback)(function(Be,V){Se(function(et){return d()(d()({},et),{},I()({},Be,V))}),P(!1)},[u]),qe=(0,l.useCallback)(function(Be){Se(function(V){return d()(d()({},V),Be)})},[u]),yt=(0,l.useCallback)(function(Be){_&&$.id&&(_e(!0),_($.id,Be).then(function(){return _e(!1)}).catch(function(){_e(!1)}))},[$,_,u]),nt=(0,l.useCallback)(function(){var Be=d()(d()({},$),{},{active:$.active?1:0,preview:$.preview?1:0,can_skip:$.can_skip?1:0,order:Ue,json:$.json?JSON.stringify($.json):null});kn(u.topicable_type)&&!Be.value&&(Be.value="theProject");var V=Tt(Be);yt(V)},[$,yt,Ue]),jt=(0,l.useCallback)(function(){return u!=null&&u.isNew||_e(!0),x&&$.id&&x($.id)},[$,x,u]),gt=(0,l.useCallback)(function(){return u.id&&h&&h(u.id)},[u,h]);return(0,e.jsx)(l.Fragment,{children:(0,e.jsxs)(ie.Z,{gutter:16,style:{height:"100%"},children:[(0,e.jsxs)(re.Z,{span:16,style:{marginBottom:"46px"},children:[(0,e.jsxs)(wn.Z,{children:[u&&Kn(nn(u))," ",(u==null?void 0:u.topicable_type)&&(u==null?void 0:u.topicable_type.split("\\").pop())," ",(0,e.jsx)(n.FormattedMessage,{id:"type"})]}),!pe&&(0,e.jsx)(ne.Z,{message:(0,e.jsx)(n.FormattedMessage,{id:"select_type_topic"}),type:"info"}),pe&&pe===(m.oz===null||m.oz===void 0?void 0:m.oz.RichText)&&(0,e.jsx)(ua,{directory:"course/".concat(i==null?void 0:i.id,"/lesson/").concat(u==null?void 0:u.lesson_id,"/topic/").concat(u==null?void 0:u.id,"/wysiwyg"),text:(u==null?void 0:u.topicable_type)===(m.oz===null||m.oz===void 0?void 0:m.oz.RichText)&&(u==null||(o=u.topicable)===null||o===void 0?void 0:o.value)||"",onChange:function(V){return ye("value",V)}}),u&&pe&&(pe===m.oz.Video||pe===m.oz.Audio||pe===m.oz.Image||pe===m.oz.PDF)&&(0,e.jsx)(Ma,{folder:"course/".concat(i==null?void 0:i.id),type:pe,topic:w,currentState:$,onChange:function(V){_e(!0),V.file.status==="removed"&&_e(!1)},onUpdate:function(V){var et,dt,Ye,ot;u.id&&p&&p(u.id,V),u.topicable_type===m.oz.Video&&setTimeout(function(){A&&A()},5e3),Se(d()(d()({},$),{},{id:V==null||(et=V.file)===null||et===void 0||(et=et.response)===null||et===void 0||(et=et.data)===null||et===void 0?void 0:et.id,order:(dt=V.file.response.data)===null||dt===void 0?void 0:dt.order,value:V==null||(Ye=V.file)===null||Ye===void 0||(Ye=Ye.response.data)===null||Ye===void 0||(Ye=Ye.topicable)===null||Ye===void 0?void 0:Ye.value,topicable:V==null||(ot=V.file)===null||ot===void 0||(ot=ot.response.data)===null||ot===void 0?void 0:ot.topicable})),P(!1),_e(!1)},disabled:!1,maxFiles:1,clearListAfterUpload:!0}),pe&&pe===m.oz.OEmbed&&(0,e.jsx)(la,{text:$.value,onChange:function(V){return ye("value",V)}}),pe&&pe===m.oz.Project&&(0,e.jsx)(wa,{onChange:function(V){return ye("notify_users",V)},topicable:u.topicable}),pe&&pe===m.oz.GiftQuiz&&(0,e.jsx)(Ra,{onChange:function(V,et){ye(V,et)},topicable:$.topicable,onAdded:A,onRemoved:A,onEdited:A}),pe&&pe===m.oz.H5P&&(0,e.jsx)(na,{id:$.value,onChange:function(V){return ye("value",V)}}),pe&&pe===m.oz.SCORM&&(0,e.jsx)(Wn,{value:Number($.value),onChange:function(V){return ye("value",V)}}),(0,e.jsx)(ie.Z,{justify:"center",className:"program__cta-footer",children:(0,e.jsx)(An.Z,{offsetBottom:4,children:(0,e.jsxs)(Nt.Z,{size:"large",children:[(0,e.jsx)(Gt(),{loading:tt,children:(0,e.jsx)(n.FormattedMessage,{id:"cancel"})}),!u.isNew&&(0,e.jsx)(Gt(),{onClick:gt,loading:tt,children:(0,e.jsx)(n.FormattedMessage,{id:"clone"})}),(0,e.jsx)(Gt(),{type:"primary",onClick:nt,disabled:D,loading:tt,children:(0,e.jsx)(n.FormattedMessage,{id:"save"})}),(0,e.jsx)(Gt(),{danger:!0,onClick:jt,loading:tt,children:(0,e.jsx)(n.FormattedMessage,{id:"delete"})})]})})})]}),(0,e.jsx)(re.Z,{span:8,children:(0,e.jsxs)("aside",{className:"program-sidebar program-sidebar--right",children:[(i==null?void 0:i.lessons)&&(0,e.jsx)(Jr,{courseId:Number(i==null?void 0:i.id),courseLessons:i==null?void 0:i.lessons,initialValues:$,onValuesChange:function(V){return qe(V)}}),!$.isNew&&(0,e.jsxs)(l.Fragment,{children:[(0,e.jsx)(wn.Z,{children:(0,e.jsx)(n.FormattedMessage,{id:"file_resources"})}),(0,e.jsx)(ya,{topicId:Number(u==null?void 0:u.id),folder:"course/".concat(i==null?void 0:i.id)})]})]})})]})})},Na=Ba,St=t(57818),Vn=t(43458),za=t(13769),Gn=t.n(za),$a=["initialValue","onCreate"],Wa=l.forwardRef(function(f,r){var s=f.initialValue,o=f.onCreate,a=Gn()(f,$a),i=(0,l.useState)(""),c=j()(i,2),_=c[0],x=c[1];return(0,e.jsxs)("div",d()(d()({className:"program-sidebar__list-item program-sidebar__list-item--lesson-new",ref:r},a),{},{children:[(0,e.jsx)(Rn.Z,{}),(0,e.jsx)(Nn.Z,{value:_,onChange:function(h){return x(h.target.value)},placeholder:s.title}),(0,e.jsx)("div",{children:(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"create"}),children:(0,e.jsx)(C.ZP,{disabled:!_,size:"small",className:"btn-create-lesson",type:"primary",icon:(0,e.jsx)(J.Z,{}),onClick:function(){return o(_)}})})})]}))}),Ka=t(16165),ka=function(){return(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23.01",height:"18.077",viewBox:"0 0 23.01 18.077",children:(0,e.jsxs)("g",{id:"Group_5","data-name":"Group 5",transform:"translate(-97.496 -306.965)",children:[(0,e.jsx)("path",{id:"Path_2","data-name":"Path 2",d:"M138.934,401.557s8.685.579,12.972-6.836-11.893-6.747-7.254-1.854,16.02-8.07,16.02-8.07",transform:"translate(-40.906 -77.037)",fill:"none",stroke:"#58c35d",strokeLinecap:"round",strokeWidth:"1"}),(0,e.jsx)("path",{id:"Path_3","data-name":"Path 3",d:"M115.761,306.465h5.332V311.8",transform:"translate(-1.087 1)",fill:"none",stroke:"#58c35d",strokeLinecap:"round",strokeWidth:"1"})]})})},Hn=function(r){return(0,e.jsx)(Ka.Z,d()({component:ka},r))},fn=t(21987);function Va(f,r){return gn.apply(this,arguments)}function gn(){return gn=N()(E()().mark(function f(r,s){return E()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,n.request)("/api/admin/recommender/course/".concat(r," "),d()({method:"GET",useCache:!1},s||{})));case 1:case"end":return a.stop()}},f)})),gn.apply(this,arguments)}function Ga(f,r){return _n.apply(this,arguments)}function _n(){return _n=N()(E()().mark(function f(r,s){return E()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,n.request)("/api/admin/recommender/lesson/".concat(r,"/topic "),d()({method:"GET",useCache:!1},s||{})));case 1:case"end":return a.stop()}},f)})),_n.apply(this,arguments)}var Ha=function(r){var s=(0,l.useState)(),o=j()(s,2),a=o[0],i=o[1];return(0,l.useEffect)(function(){Va(r).then(function(c){return c.success&&i(c.data)})},[r]),a},Qa=function(r){var s=(0,l.useState)(),o=j()(s,2),a=o[0],i=o[1];return(0,l.useEffect)(function(){Ga(r).then(function(c){return c.success&&i(c.data)})},[r]),a},Ja=function(r){return r.includes("H5P")?"H5P":r},Ya=function(r){return(r==null?void 0:r.includes("."))&&(r==null?void 0:r.split(".").join(" "))},Qn=function(r){return Math.min(Math.ceil(Math.abs(r)*100),100)},Xa=function(r){var s=r.recommendedData,o=r.createTopic;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(fn.Z,{className:"recommender__paragraph",children:[(0,e.jsx)(n.FormattedMessage,{id:"recommender.add_exercise"}),(0,e.jsx)("span",{className:"recommender__paragraph--span",children:"".concat(Ya(s==null?void 0:s.topic_type),",")}),(0,e.jsx)("br",{}),(0,e.jsx)(n.FormattedMessage,{id:"recommender.increase"}),(0,e.jsx)("span",{className:"recommender__paragraph--span",children:"".concat(Qn(s.probability),"%.")})]}),(0,e.jsx)(C.ZP,{className:"recommender__button",type:"default",onClick:o,children:(0,e.jsx)(n.FormattedMessage,{id:"recommender.add_button"})})]})},qa=function(){return(0,e.jsx)(fn.Z,{className:"recommender__paragraph",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender.save_exercise"})})},es=t(56717),ts=t(55241),ns=function(){return(0,e.jsxs)("div",{className:"recommender__popover-wrapper",children:[(0,e.jsx)("h3",{className:"recommender__popover-title",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender_info.title"})}),(0,e.jsx)("strong",{className:"recommender__popover-text",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender_info.first_title"})}),(0,e.jsx)("p",{className:"recommender__popover-text",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender_info.first_text"})}),(0,e.jsx)("strong",{className:"recommender__popover-text",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender_info.second_title"})}),(0,e.jsx)("p",{className:"recommender__popover-text",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender_info.second_text"})})]})},Jn=function(){return(0,e.jsx)(ts.Z,{placement:"bottomLeft",content:(0,e.jsx)(ns,{}),trigger:"click",showArrow:!1,className:"recommender__popover",children:(0,e.jsx)(es.Z,{style:{color:"#2DAC34"}})})},rs=function(r){var s=r.courseId,o=r.lessonId,a=r.recommenderType,i=a===void 0?m.Zg.Exercise:a,c=(0,l.useContext)(Y._y),_=c.addNewTopic,x=Qa(o),p=(0,l.useCallback)(function(u,v){if(_){var b=_(u,v);n.history.push("/courses/list/".concat(s,"/program/?topic=").concat(b.id))}},[_]),h=function(v){switch(v){case m.Zg.Info:return(0,e.jsx)(qa,{});case m.Zg.Exercise:return x&&(0,e.jsx)(Xa,{createTopic:function(){return p(o,m.oz[Ja(x==null?void 0:x.topic_type)])},recommendedData:x});default:return(0,e.jsx)(n.FormattedMessage,{id:"recommender.no_recommendation"})}},A=i===m.Zg.Exercise&&!x;return(0,e.jsxs)("div",{className:"recommender",children:[(0,e.jsx)(Hn,{style:{marginTop:"4px"}}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"recommender__title",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender.title"})}),A&&(0,e.jsx)(ae.Z,{}),h(i)]}),(0,e.jsx)(Jn,{})]})},as=function(r){var s=r.courseId,o=Ha(s);return o&&o.probability&&o.probability>-.016?null:o?(0,e.jsxs)("div",{className:"recommender",children:[(0,e.jsx)(Hn,{style:{marginTop:"4px"}}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"recommender__title",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender.title"})}),(0,e.jsxs)(fn.Z,{className:"recommender__paragraph",children:[(0,e.jsx)(n.FormattedMessage,{id:"recommender.finish"}),(0,e.jsx)("strong",{children:"".concat(Qn(o.probability),"%. ")}),(0,e.jsx)("br",{}),(0,e.jsx)(n.FormattedMessage,{id:"recommender.too_long"})]})]}),(0,e.jsx)(Jn,{})]}):(0,e.jsx)(e.Fragment,{})},ss=t(52745),Yn=t(59234),is=[{type:m.oz.RichText,icon:(0,e.jsx)(mn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"RichText"})},{type:m.oz.OEmbed,icon:(0,e.jsx)(dn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"OEmbed"})},{type:m.oz.Audio,icon:(0,e.jsx)(on.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"Audio"})},{type:m.oz.Video,icon:(0,e.jsx)(cn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"Video"})},{type:m.oz.H5P,icon:(0,e.jsx)(un.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"H5P"})},{type:m.oz.Image,icon:(0,e.jsx)(ln.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"Image"})},{type:m.oz.PDF,icon:(0,e.jsx)(sn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"PDF"})},{type:m.oz.SCORM,icon:(0,e.jsx)(an.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"SCORM"})},{type:m.oz.Project,icon:(0,e.jsx)(pn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"Project"})},{type:m.oz.GiftQuiz,icon:(0,e.jsx)(vn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"Quiz"})}],os=function(r){var s=r.onSelected,o=r.positionsToHide,a=(0,l.useState)(!1),i=j()(a,2),c=i[0],_=i[1],x=(0,n.useModel)("@@initialState"),p=x.initialState,h=(0,l.useCallback)(function(v){_(!1),s(v)},[]),A=(0,l.useCallback)((0,Vn.a)(p==null?void 0:p.packages),[p==null?void 0:p.packages]),u=(0,l.useCallback)(function(v){var b,D=Object.keys(m.oz).filter(function(R){return m.oz[R]==v}).pop(),P=D&&(p==null||(b=p.config)===null||b===void 0||(b=b.filter(function(R){return R.key===(0,Yn.Wg)(D)})[0])===null||b===void 0?void 0:b.data);if(P)return!0;switch(v){case m.oz.GiftQuiz:return!A(St.Z.TopicTypeGift);case m.oz.SCORM:return!A(St.Z.Scorm);case m.oz.Project:return!A(St.Z.TopicTypeProject);default:return!A(St.Z.TopicTypes)}},[p]);return(0,e.jsxs)("div",{className:`topic-types-selector topic-types-selector__recommender-wrapper
       `.concat(c?"topic-types-selector--visible":""),children:[(0,e.jsx)(C.ZP,{type:"text",size:"small",onClick:function(){return _(function(b){return!b})},className:"topic-types-selector__recommender--add-btn",icon:c?(0,e.jsx)(ss.Z,{}):(0,e.jsx)(en.Z,{}),children:(0,e.jsx)(n.FormattedMessage,{id:"recommender.add_new_exercise"})}),(0,e.jsx)("div",{className:"topic-types-selector__recommender".concat(`
          `,c?"topic-types-selector__recommender--active":""),children:is.map(function(v){return!(o!=null&&o.includes(v.type))&&!u(v.type)&&(0,e.jsx)(lt.Z,{title:v.title,children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return h(v.type)},icon:v.icon})},v.type)})})]})},ls=t(86864),ds=function(r){var s=r.onSelected,o=r.onNewLesson,a=r.positionsToHide,i=r.depth,c=i===void 0?0:i,_=(0,l.useState)(!1),x=j()(_,2),p=x[0],h=x[1],A=(0,n.useModel)("@@initialState"),u=A.initialState,v=(0,n.useIntl)(),b=(0,l.useCallback)(function(P){h(!1),s(P)},[]),D=(0,l.useCallback)(function(P){var R,Q,$,Se,pe,be=Object.keys(m.oz).filter(function(Ue){return m.oz[Ue]==P}).pop(),we=be&&(u==null||(R=u.config)===null||R===void 0||(R=R.filter(function(Ue){return Ue.key===(0,Yn.Wg)(be)})[0])===null||R===void 0?void 0:R.data);if(we)return!0;switch(P){case m.oz.GiftQuiz:return!(u!=null&&u.packages&&u!==null&&u!==void 0&&(Q=u.packages)!==null&&Q!==void 0&&Q[St.Z.TopicTypeGift]);case m.oz.SCORM:return!(u!=null&&u.packages&&u!==null&&u!==void 0&&($=u.packages)!==null&&$!==void 0&&$[St.Z.Scorm]);case m.oz.Project:return!(u!=null&&u.packages&&u!==null&&u!==void 0&&(Se=u.packages)!==null&&Se!==void 0&&Se[St.Z.TopicTypeProject]);default:return!(u!=null&&u.packages&&u!==null&&u!==void 0&&(pe=u.packages)!==null&&pe!==void 0&&pe[St.Z.TopicTypes])}},[u]);return(0,e.jsxs)("div",{className:"topic-types-selector ".concat(p?"topic-types-selector--visible":""),children:[(0,e.jsx)(Nt.Z,{children:(0,e.jsx)(lt.Z,{placement:"top",title:(0,e.jsx)(n.FormattedMessage,{id:"add_new_topic"}),children:(0,e.jsx)(C.ZP,{type:"primary",size:"small",onClick:function(){return h(function(R){return!R})},icon:(0,e.jsx)(en.Z,{})})})}),(0,e.jsxs)("div",{className:"topic-types-selector__list ".concat(p?"topic-types-selector__list--visible":""),children:[!(a!=null&&a.includes("lesson"))&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(lt.Z,{placement:"right",title:v.messages["Lesson_level-".concat(c)]?(0,e.jsx)(n.FormattedMessage,{id:"Lesson_level-".concat(c)}):(0,e.jsx)(n.FormattedMessage,{id:"Lesson",defaultMessage:"Lesson"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){h(!1),o()},icon:(0,e.jsx)(ls.Z,{})})}),(0,e.jsx)(Vt.Z,{})]}),!(a!=null&&a.includes(m.oz.RichText))&&!D(m.oz.RichText)&&(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"RichText"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return b(m.oz.RichText)},icon:(0,e.jsx)(mn.Z,{})})}),!(a!=null&&a.includes(m.oz.OEmbed))&&!D(m.oz.OEmbed)&&(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"OEmbed"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return b(m.oz.OEmbed)},icon:(0,e.jsx)(dn.Z,{})})}),!(a!=null&&a.includes(m.oz.Audio))&&!D(m.oz.Audio)&&(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"Audio"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return b(m.oz.Audio)},icon:(0,e.jsx)(on.Z,{})})}),!(a!=null&&a.includes(m.oz.Video))&&!D(m.oz.Video)&&(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"Video"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return b(m.oz.Video)},icon:(0,e.jsx)(cn.Z,{})})}),!(a!=null&&a.includes(m.oz.H5P))&&!D(m.oz.H5P)&&(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"H5P"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return b(m.oz.H5P)},icon:(0,e.jsx)(un.Z,{})})}),!(a!=null&&a.includes(m.oz.Image))&&!D(m.oz.Image)&&(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"Image"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return b(m.oz.Image)},icon:(0,e.jsx)(ln.Z,{})})}),!(a!=null&&a.includes(m.oz.PDF))&&!D(m.oz.PDF)&&(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"PDF"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return b(m.oz.PDF)},icon:(0,e.jsx)(sn.Z,{})})}),!(a!=null&&a.includes(m.oz.SCORM))&&!D(m.oz.SCORM)&&(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"SCORM"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return b(m.oz.SCORM)},icon:(0,e.jsx)(an.Z,{})})}),!(a!=null&&a.includes(m.oz.Project))&&!D(m.oz.Project)&&(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"Project"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return b(m.oz.Project)},icon:(0,e.jsx)(pn.Z,{})})}),!(a!=null&&a.includes(m.oz.GiftQuiz))&&!D(m.oz.GiftQuiz)&&(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"Quiz"}),children:(0,e.jsx)(C.ZP,{block:!0,onClick:function(){return b(m.oz.GiftQuiz)},icon:(0,e.jsx)(vn.Z,{})})})]})]})},us=t(70227),ft=function(f){return f.New="new",f.Lesson="lesson",f.Topic="topic",f}({}),Xn=function(r,s){return r.map(function(o){return d()(d()({},o),{},{id:"topic-".concat(o.id,"-").concat(s)})})},cs=function(r,s){return r.map(function(o){return d()(d()({},o),{},{id:o.isNew?"new-".concat(o.id,"-").concat(s):"lesson-".concat(o.id,"-").concat(s)})})},qn=function(r,s){var o,a;return d()(d()({},r),{},{id:r.isNew?"new-".concat(r.id,"-").concat(s):"lesson-".concat(r.id,"-").concat(s),lessons:cs((o=r==null?void 0:r.lessons)!==null&&o!==void 0?o:[],s+1),topics:Xn((a=r==null?void 0:r.topics)!==null&&a!==void 0?a:[],s+1)})},ms=function f(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return r.reduce(function(o,a){var i;return[].concat(g()(o),g()(f((i=a==null?void 0:a.lessons)!==null&&i!==void 0?i:[],s+1)),[qn(a,s)])},[])},ps=function f(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return r.reduce(function(o,a){var i,c;return[].concat(g()(o),g()(f((i=a==null?void 0:a.lessons)!==null&&i!==void 0?i:[],s+1)),g()(Xn((c=a==null?void 0:a.topics)!==null&&c!==void 0?c:[],s)))},[])},vs=function(r){return r.map(function(s){var o,a,i=qn(s,0),c=[].concat(g()((o=i.lessons)!==null&&o!==void 0?o:[]),g()((a=i.topics)!==null&&a!==void 0?a:[])).map(function(_){var x=_.id;return x});return{id:i.id,children:c,hasChildren:c.length>0,isExpanded:!0,data:i}})},fs=function(r,s){return r.reduce(function(o,a){var i,c,_=[];if("lessons"in a||"topics"in a){var x,p;_=[].concat(g()((x=a.lessons)!==null&&x!==void 0?x:[]),g()((p=a.topics)!==null&&p!==void 0?p:[])).map(function(A){var u=A.id;return u})}var h=(i=s==null||(c=s["".concat(a.id)])===null||c===void 0?void 0:c.isExpanded)!==null&&i!==void 0?i:!0;return d()(d()({},o),{},I()({},"".concat(a.id),{id:a.id,children:_,hasChildren:_.length>0,isExpanded:h,data:a}))},{})},hn=function(r,s,o){var a=g()(r),i=s%a.length,c=o%a.length,_=a.splice(i,1),x=j()(_,1),p=x[0];return a.splice(c,0,p),a},Jt=function(r,s,o){var a=g()(r),i=a.length===1||s===a.length?s:s%a.length;return a.splice(i,0,o),a},Zt=function(r){return r.map(function(s,o){var a=s.toString().split("-"),i=j()(a,2),c=i[1];return[+c,o]})},Ft=function(){var f=N()(E()().mark(function r(s,o,a){var i,c;return E()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return i=void 0,s(function(p){return i=p,us.d.apply(void 0,[p].concat(g()(o)))}),x.prev=2,x.next=5,a();case 5:c=x.sent,B()(c)==="object"&&c!==null&&"success"in c&&typeof c.success=="boolean"&&!c.success&&i&&s(i),x.next=12;break;case 9:x.prev=9,x.t0=x.catch(2),i&&s(i);case 12:case"end":return x.stop()}},r,null,[[2,9]])}));return function(s,o,a){return f.apply(this,arguments)}}(),gs=function(r,s){return Object.values(r.items).find(function(o){var a=o.children;return a.includes(s)})},er=function(r,s,o){var a,i;return(a=(i=r.items)===null||i===void 0||(i=i[s])===null||i===void 0||(i=i.children)===null||i===void 0?void 0:i.indexOf(o))!==null&&a!==void 0?a:-1},_s=function(r){var s=r.onNewLesson,o=(0,l.useContext)(Y._y),a=o.state,i=o.currentEditMode,c=o.updateLesson,_=o.addNewTopic,x=o.addNewLesson,p=o.getLessons,h=a==null?void 0:a.id,A=(0,l.useMemo)(function(){var _e;return vs((_e=a==null?void 0:a.lessons)!==null&&_e!==void 0?_e:[])},[a==null?void 0:a.lessons]),u=(0,l.useMemo)(function(){var _e,ee;return[].concat(g()(ms((_e=a==null?void 0:a.lessons)!==null&&_e!==void 0?_e:[])),g()(ps((ee=a==null?void 0:a.lessons)!==null&&ee!==void 0?ee:[])))},[a==null?void 0:a.lessons]),v=(0,l.useState)({rootId:0,items:{}}),b=j()(v,2),D=b[0],P=b[1],R=(0,n.useModel)("@@initialState"),Q=R.initialState,$=(0,n.useIntl)(),Se=(0,l.useCallback)(function(){var _e,ee=Q==null||(_e=Q.packagesConfigs)===null||_e===void 0||(_e=_e.escolalms_recommender)===null||_e===void 0||(_e=_e.enabled)===null||_e===void 0?void 0:_e.value,ce=(0,Vn.a)(Q==null?void 0:Q.packages);return ee&&ce(St.Z.Recommender)},[Q==null?void 0:Q.packages]);(0,l.useEffect)(function(){P(function(_e){var ee={children:A.map(function(w){var Ge=w.id;return Ge}),id:"root",data:A,isExpanded:!0,hasChildren:A.length>0},ce=fs(u,_e.items);return{rootId:ee.id,items:d()(d()({},ce),{},I()({},ee.id,ee))}})},[u]);var pe=(0,l.useCallback)(function(_e,ee){if(_){var ce=_(_e,ee);n.history.push("/courses/list/".concat(h,"/program/?topic=").concat(ce.id))}},[_]),be=(0,l.useMemo)(function(){var _e;return((_e=Q==null?void 0:Q.config)!==null&&_e!==void 0?_e:[]).reduce(function(ee,ce){return ce.key==="maxLessonsNestingInProgram"?d()(d()({},ee),{},{lesson:ce.data}):ce.key==="minTopicNestingInProgram"?d()(d()({},ee),{},{topic:ce.data}):ee},{})},[Q==null?void 0:Q.config]),we=(0,l.useCallback)(function(_e){var ee,ce,w=[],Ge=(ee=be==null?void 0:be.lesson)!==null&&ee!==void 0?ee:.5,ye=(ce=be==null?void 0:be.topic)!==null&&ce!==void 0?ce:.5;return Number.isInteger(Ge)&&_e>Ge&&w.push("lesson"),Number.isInteger(ye)&&_e<ye&&Object.values(m.oz).forEach(function(qe){return w.push(qe)}),w},[be]),Ue=(0,l.useCallback)(function(_e){var ee,ce,w=_e.item,Ge=_e.depth,ye=_e.provided,qe=_e.onExpand,yt=_e.onCollapse,nt=w.id.toString().split("-"),jt=j()(nt,2),gt=jt[0],Be=jt[1],V=Number(Be),et=function(Ye,ot){var ke,_t=u.find(function(Oe){return Oe.id.includes(String(Ye))}),ut=_t==null||(ke=_t.topics)===null||ke===void 0?void 0:ke[_t.topics.length-1];return(ut==null?void 0:ut.id)===ot};return gt==="new"&&w.data.isNew?(0,e.jsx)(Wa,d()(d()(d()({},ye.draggableProps),ye.dragHandleProps),{},{ref:ye.innerRef,initialValue:w.data,onCreate:function(Ye){var ot=Tt(d()(d()({},w.data),{},{parent_lesson_id:w.data.parent_id,title:Ye,active:w.data.active?1:0}));c&&c(V,ot)}})):gt==="lesson"?(0,e.jsxs)("div",d()(d()(d()({},ye.draggableProps),ye.dragHandleProps),{},{ref:ye.innerRef,className:"program-sidebar__list-item program-sidebar__list-item--lesson ".concat((i==null?void 0:i.mode)==="lesson"&&i.id===V?"program-sidebar__list-item--active":""),children:[(0,e.jsxs)("div",{className:"program-sidebar__text-wrap",children:[(0,e.jsx)("button",{className:"program-sidebar__collapse",onClick:function(){return w.isExpanded?yt(w.id):qe(w.id)},children:w.isExpanded?(0,e.jsx)(kr.Z,{}):(0,e.jsx)(Rn.Z,{})}),(0,e.jsx)(lt.Z,{placement:"top",title:w.data.title,children:(0,e.jsx)(n.NavLink,{to:"/courses/list/".concat(h,"/program/?").concat(gt,"=").concat(V),className:"program-sidebar__link",children:(0,e.jsx)("span",{className:"program-sidebar__title",children:w.data.title})})})]}),(0,e.jsx)(ds,{onNewLesson:function(){x&&x(V)},onSelected:function(Ye){return pe(V,Ye)},positionsToHide:we(Ge+1),depth:Ge})]})):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.NavLink,d()(d()(d()({className:"program-sidebar__link program-sidebar__list-item program-sidebar__list-item--topic ".concat((i==null?void 0:i.mode)==="topic"&&i.id===V?"program-sidebar__list-item--active":""),to:"/courses/list/".concat(h,"/program/?").concat(gt,"=").concat(V)},ye.draggableProps),ye.dragHandleProps),{},{ref:ye.innerRef,children:[(0,e.jsx)(lt.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:nn(w.data)}),children:Kn(nn(w.data))}),(0,e.jsx)("span",{className:"title",children:w.data.title})]})),Se()&&h&&(i==null?void 0:i.mode)==="topic"&&(i==null||(ee=i.value)===null||ee===void 0?void 0:ee.lesson_id)&&(i==null||(ce=i.value)===null||ce===void 0?void 0:ce.lesson_id)===w.data.lesson_id&&et(i.value.lesson_id,w.data.id)&&(0,e.jsxs)(e.Fragment,{children:[u.length>5&&(0,e.jsx)(as,{courseId:h}),(0,e.jsx)(rs,{courseId:h,lessonId:i.value.lesson_id,recommenderType:i.value.isNew?m.Zg.Info:m.Zg.Exercise}),(0,e.jsx)(os,{onSelected:function(Ye){return pe(w.data.lesson_id,Ye)},positionsToHide:we(Ge+1)})]})]})},[h,i]),at=(0,l.useCallback)(function(_e){return P(function(ee){return(0,Un.U)(ee,_e,{isExpanded:!0})})},[]),pt=(0,l.useCallback)(function(_e){return P(function(ee){return(0,Un.U)(ee,_e,{isExpanded:!1})})},[]),tt=(0,l.useCallback)(function(){var _e=N()(E()().mark(function ee(ce,w){var Ge,ye,qe,yt,nt,jt,gt,Be,V,et,dt,Ye,ot,ke,_t,ut,Oe,De,He,Je,vt,xt,Yt,st,Lt,nr,rr,ar,sr,zt,ir,or,lr,dr,ur,cr,mr,Xt,pr,vr,fr,gr,_r,hr,jr,xr,br,yn,En,$t,Mr,Sn,Tn,Pr,Wt,Rt,Cr,yr,Er,Sr,Tr,Ir,Ar,Zr,In,qt,Kt,Ut,Fr,Or,Dr,Lr,Rr,Ur,wr;return E()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:if(!(!w||!h)){oe.next=2;break}return oe.abrupt("return");case 2:if(Ge=D.items[ce.parentId].children,ye=Ge[ce.index].toString(),qe=ye.split("-"),yt=j()(qe,2),nt=yt[0],jt=yt[1],gt=D.items[w.parentId].children,Be=be==null?void 0:be.lesson,V=be==null?void 0:be.topic,nt!==ft.New){oe.next=11;break}return z.ZP.warning($.formatMessage({id:"new_lessons_cant_be_moved"})),oe.abrupt("return");case 11:if(!w.parentId.toString().includes("topic")){oe.next=63;break}if(ot=Ge.filter(function(bt){return bt.toString().includes("topic")}),ke=gs(D,w.parentId),_t=Number((et=(dt=((Ye=ke==null?void 0:ke.id)!==null&&Ye!==void 0?Ye:"").toString().split("-"))===null||dt===void 0?void 0:dt[2])!==null&&et!==void 0?et:-2)+1,!(nt===ft.Lesson&&Be!==void 0&&_t>Be)){oe.next=18;break}return z.ZP.warning($.formatMessage({id:"max_lesson_nesting"},{max:Be})),oe.abrupt("return");case 18:if(!(nt===ft.Topic&&V!==void 0&&_t<V)){oe.next=21;break}return z.ZP.warning($.formatMessage({id:"min_topic_nesting"},{min:V})),oe.abrupt("return");case 21:if(!((ke==null?void 0:ke.id)!==void 0&&ce.parentId===ke.id)){oe.next=35;break}if(nt!==ft.Lesson){oe.next=25;break}return z.ZP.warning($.formatMessage({id:"lessons_and_topics_cant_be_mixed"})),oe.abrupt("return");case 25:if(nt!==ft.Topic){oe.next=35;break}if(ut=er(D,ke.id,w.parentId),!(ut<0)){oe.next=29;break}return oe.abrupt("return");case 29:return Oe=hn(ot,ce.index,ut),De=Zt(Oe),oe.next=33,Ft(P,[ce,{parentId:ke.id,index:ut}],function(){return(0,L.DY)({class:"Topic",orders:De,course_id:h})});case 33:return p==null||p(),oe.abrupt("return");case 35:if(!((ke==null?void 0:ke.id)!==void 0&&ce.parentId!==ke.id)){oe.next=62;break}if(He=ke.children.filter(function(bt){return bt.toString().includes("lesson")}),Je=ke.children.filter(function(bt){return bt.toString().includes("topic")}),nt!==ft.Lesson){oe.next=50;break}return vt=He.length,xt=ke.id.toString().split("-"),Yt=j()(xt,2),st=Yt[1],Lt=D.items[ye].data,nr={parent_lesson_id:ke.id==="root"?"":+st,course_id:h,title:Lt.title,order:vt},rr=Tt(nr),ar=Jt(He,vt,ye),sr=Zt(ar),oe.next=48,Ft(P,[ce,d()(d()({},w),{},{index:vt})],function(){return(0,L.sI)(+jt,rr).then(function(){return(0,L.DY)({class:"Lesson",orders:sr,course_id:h})})});case 48:return p==null||p(),oe.abrupt("return");case 50:if(nt!==ft.Topic){oe.next=62;break}if(zt=er(D,ke.id,w.parentId)+1,!(zt<1)){oe.next=54;break}return oe.abrupt("return");case 54:return ir=ke.id.toString().split("-"),or=j()(ir,2),lr=or[1],dr={lesson_id:+lr,order:zt},ur=Jt(Je,zt-He.length,ye),cr=Zt(ur),mr=Tt(dr),oe.next=61,Ft(P,[ce,{parentId:ke.id,index:zt}],function(){return(0,L.Cn)(+jt,mr).then(function(){return(0,L.DY)({class:"Topic",orders:cr,course_id:h})})});case 61:p==null||p();case 62:return oe.abrupt("return");case 63:if(!(w.parentId==="root"&&nt===ft.Topic)){oe.next=66;break}return z.ZP.warning($.formatMessage({id:"topic_cant_be_in_root"})),oe.abrupt("return");case 66:if(!(ce.parentId===w.parentId&&w.index!==void 0)){oe.next=93;break}if(Xt=Ge.filter(function(bt){return bt.toString().includes("lesson")}),pr=Ge.filter(function(bt){return bt.toString().includes("topic")}),nt!==ft.Lesson){oe.next=81;break}if(vr=0,fr=Xt.length-1,!(w.index<vr||w.index>fr)){oe.next=75;break}return z.ZP.warning($.formatMessage({id:"lessons_and_topics_cant_be_mixed"})),oe.abrupt("return");case 75:return gr=hn(Xt,ce.index,w.index),_r=Zt(gr),oe.next=79,Ft(P,[ce,w],function(){return(0,L.DY)({class:"Lesson",orders:_r,course_id:h})});case 79:return p==null||p(),oe.abrupt("return");case 81:if(nt!==ft.Topic){oe.next=93;break}if(hr=Xt.length,jr=Ge.length-1,!(w.index<hr||w.index>jr)){oe.next=87;break}return z.ZP.warning($.formatMessage({id:"lessons_and_topics_cant_be_mixed"})),oe.abrupt("return");case 87:return xr=hn(pr,ce.index,w.index),br=Zt(xr),oe.next=91,Ft(P,[ce,w],function(){return(0,L.DY)({class:"Topic",orders:br,course_id:h})});case 91:return p==null||p(),oe.abrupt("return");case 93:if(ce.parentId===w.parentId){oe.next=135;break}if($t=gt.filter(function(bt){return bt.toString().includes("lesson")}),Mr=gt.filter(function(bt){return bt.toString().includes("topic")}),Sn=Number((yn=(En=w.parentId.toString().split("-"))===null||En===void 0?void 0:En[2])!==null&&yn!==void 0?yn:-2)+1,!(nt===ft.Lesson&&Be!==void 0&&Sn>Be)){oe.next=100;break}return z.ZP.warning($.formatMessage({id:"max_lesson_nesting"},{max:Be})),oe.abrupt("return");case 100:if(!(nt===ft.Topic&&V!==void 0&&Sn<V)){oe.next=103;break}return z.ZP.warning($.formatMessage({id:"min_topic_nesting"},{min:V})),oe.abrupt("return");case 103:if(nt!==ft.Lesson){oe.next=120;break}if(Pr=0,Wt=$t.length,Rt=(Tn=w.index)!==null&&Tn!==void 0?Tn:Wt,!(Wt!==0&&Rt<Pr||Wt!==0&&Rt>Wt)){oe.next=110;break}return z.ZP.warning($.formatMessage({id:"lessons_and_topics_cant_be_mixed"})),oe.abrupt("return");case 110:return Cr=w.parentId.toString().split("-"),yr=j()(Cr,2),Er=yr[1],Sr=D.items[ye].data,Tr={parent_lesson_id:w.parentId==="root"?"":+Er,course_id:h,title:Sr.title,order:Rt},Ir=Tt(Tr),Ar=Jt($t,Rt,ye),Zr=Zt(Ar),oe.next=118,Ft(P,[ce,d()(d()({},w),{},{index:Rt})],function(){return(0,L.sI)(+jt,Ir).then(function(){return(0,L.DY)({class:"Lesson",orders:Zr,course_id:h})})});case 118:return p==null||p(),oe.abrupt("return");case 120:if(nt!==ft.Topic){oe.next=135;break}if(qt=$t.length,Kt=gt.length,Ut=(In=w.index)!==null&&In!==void 0?In:Kt,!(qt!==0&&Kt!==0&&Ut<qt||qt!==0&&Kt!==0&&Ut>Kt)){oe.next=127;break}return z.ZP.warning($.formatMessage({id:"lessons_and_topics_cant_be_mixed"})),oe.abrupt("return");case 127:return Fr=w.parentId.toString().split("-"),Or=j()(Fr,2),Dr=Or[1],Lr={lesson_id:+Dr,order:Ut},Rr=Jt(Mr,Ut-$t.length,ye),Ur=Zt(Rr),wr=Tt(Lr),oe.next=134,Ft(P,[ce,d()(d()({},w),{},{index:Ut})],function(){return(0,L.Cn)(+jt,wr).then(function(){return(0,L.DY)({class:"Topic",orders:Ur,course_id:h})})});case 134:p==null||p();case 135:case"end":return oe.stop()}},ee)}));return function(ee,ce){return _e.apply(this,arguments)}}(),[$,D,h,be]);return(0,e.jsxs)("div",{style:{height:"100%"},children:[(0,e.jsx)(Vr.Z,{offsetPerLevel:9,tree:D,onExpand:at,onCollapse:pt,onDragEnd:tt,renderItem:Ue,isDragEnabled:!0,isNestingEnabled:!0}),(0,e.jsx)(C.ZP,{onClick:s,type:"primary",className:"program-sidebar__add-btn",icon:(0,e.jsx)(en.Z,{}),children:(0,e.jsx)("span",{children:(0,e.jsx)(n.FormattedMessage,{id:"add_lesson"})})})]})},hs=function(){var r=(0,l.useContext)(Y._y),s=r.state,o=r.addNewLesson,a=(0,l.useCallback)(function(){if(o&&s){var i=o();n.history.push("/courses/list/".concat(s.id,"/program/?lesson=").concat(i.id))}},[o,s]);return s&&s.lessons?(0,e.jsx)("aside",{className:"program-sidebar program-sidebar--left ".concat(s.lessons.length>0?"":"program-sidebar--empty"),children:(0,e.jsx)(_s,{onNewLesson:a})}):(0,e.jsx)("div",{children:(0,e.jsx)(ae.Z,{})})},js=hs,xs=function(){var r=(0,l.useContext)(Y._y),s=r.state,o=r.currentEditMode,a=H.Z.Title;return s&&s.lessons?(0,e.jsxs)("div",{className:"course-block",children:[(0,e.jsxs)(ie.Z,{gutter:16,children:[(0,e.jsx)(re.Z,{span:4,children:(0,e.jsx)(js,{})}),(0,e.jsxs)(re.Z,{span:20,children:[o&&o.mode==="lesson"&&o.value&&(0,e.jsx)(Kr,{},o.id),o&&o.mode==="topic"&&o.value&&(0,e.jsx)(Na,{},o.id),o&&o.mode==="init"&&(0,e.jsxs)(ie.Z,{style:{height:"100%"},children:[(0,e.jsx)(re.Z,{span:16,children:(0,e.jsx)("div",{className:"program__empty-message",children:s.lessons.length>0?(0,e.jsx)(a,{level:4,children:(0,e.jsx)(Re.Z,{id:"program_form_not_selected_list_message"})}):(0,e.jsx)(a,{level:4,children:(0,e.jsx)(Re.Z,{id:"program_form_empty_list_message"})})})}),(0,e.jsx)(re.Z,{span:8,children:(0,e.jsx)("aside",{className:"program-sidebar program-sidebar--right"})})]})]})]}),(0,e.jsx)("div",{className:"curriculum-lessons-wrapper"})]}):(0,e.jsx)("div",{children:(0,e.jsx)(ae.Z,{})})},bs=xs,Ms=function(r){var s=r.id;return(0,e.jsx)(Y.Il,{id:Number(s),children:(0,e.jsx)(bs,{})})},Ps=Ms;function Cs(f,r){return jn.apply(this,arguments)}function jn(){return jn=N()(E()().mark(function f(r,s){return E()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,n.request)("/api/admin/topic-project-solutions",d()({params:d()(d()({},r),{},{per_page:r.pageSize,page:r.current}),method:"GET",useCache:!1},s||{})));case 1:case"end":return a.stop()}},f)})),jn.apply(this,arguments)}function ys(f,r){return xn.apply(this,arguments)}function xn(){return xn=N()(E()().mark(function f(r,s){return E()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,n.request)("/api/admin/topic-project-solutions/".concat(r),d()({method:"DELETE"},s||{})));case 1:case"end":return a.stop()}},f)})),xn.apply(this,arguments)}var Es=["type","defaultRender"],Ss=function(){var f=N()(E()().mark(function r(s){var o;return E()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,ys(s);case 2:return o=i.sent,o.success&&z.ZP.success(o.message),i.abrupt("return",!0);case 5:case"end":return i.stop()}},r)}));return function(s){return f.apply(this,arguments)}}(),Ts=function f(r){return r.reduce(function(s,o){var a;return[].concat(g()(s),g()(o.lessons?f(o.lessons):[]),g()((a=o.topics)!==null&&a!==void 0?a:[]))},[])},Is=function(r){var s=r.courseId,o=(0,n.useIntl)(),a=(0,l.useState)([]),i=j()(a,2),c=i[0],_=i[1],x=(0,l.useMemo)(function(){return c.reduce(function(h,A){var u,v,b;return d()(d()({},h),{},I()({},(u=A.id)!==null&&u!==void 0?u:-1,{text:(v=A.title)!==null&&v!==void 0?v:"",status:(b=A.id)!==null&&b!==void 0?b:-1}))},{})},[c]),p=(0,l.useMemo)(function(){return[{title:(0,e.jsx)(n.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,e.jsx)(n.FormattedMessage,{id:"topic",defaultMessage:"topic"}),dataIndex:"topic_id",hideInSearch:!1,sorter:!0,valueEnum:x,render:function(A,u){var v,b;return(0,e.jsx)(n.Link,{to:"/courses/list/".concat(s,"/program/?topic=").concat(u.topic_id),children:(v=x==null||(b=x[u.topic_id])===null||b===void 0?void 0:b.text)!==null&&v!==void 0?v:u.topic_id})}},{sorter:!0,title:(0,e.jsx)(n.FormattedMessage,{id:"user",defaultMessage:"user"}),dataIndex:"user_id",renderFormItem:function(A,u,v){var b=u.type,D=u.defaultRender,P=Gn()(u,Es);if(b==="form")return null;var R=v.getFieldValue("state");return(0,e.jsx)(Qt.Z,d()(d()({},P),{},{state:{type:R}}))},render:function(A,u){return u.user_id&&(0,e.jsx)(W.Z,{type:"EscolaLms\\Core\\Models\\User",type_id:u.user_id},"user")}},{sorter:!0,title:(0,e.jsx)(n.FormattedMessage,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",hideInSearch:!0,render:function(A,u){return u.created_at&&(0,X.WU)(new Date(u.created_at),q.Cu)}},{title:(0,e.jsx)(n.FormattedMessage,{id:"download",defaultMessage:"Download"}),dataIndex:"file_url",hideInSearch:!0,render:function(A,u){return(0,e.jsx)(C.ZP,{type:"primary",target:"_blank",size:"small",href:u.file_url,children:(0,e.jsx)(n.FormattedMessage,{id:"download",defaultMessage:"Download"})})}},{hideInSearch:!0,title:(0,e.jsx)(n.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"option"}),dataIndex:"option",valueType:"option",render:function(A,u,v,b){return[(0,e.jsx)(Zn.Z,{title:(0,e.jsx)(n.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:N()(E()().mark(function D(){var P;return E()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,Ss(u.id);case 2:if(P=Q.sent,P){Q.next=5;break}return Q.abrupt("return");case 5:b==null||b.reload();case 6:case"end":return Q.stop()}},D)})),okText:(0,e.jsx)(n.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(n.FormattedMessage,{id:"no"}),children:(0,e.jsx)(lt.Z,{title:(0,e.jsx)(n.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(C.ZP,{type:"primary",icon:(0,e.jsx)($n.Z,{}),danger:!0})})},"delete")]}}]},[x]);return(0,l.useEffect)(function(){s&&(0,L.Nx)(s).then(function(h){if(h.success){var A=Ts(h.data.lessons).filter(function(u){return u.topicable_type===m.oz.Project});_(A)}})},[s]),(0,e.jsx)(k.ZP,{headerTitle:o.formatMessage({id:"project_solutions",defaultMessage:"Project Uploaded Solutions"}),search:{layout:"vertical"},rowKey:"id",request:function(){var h=N()(E()().mark(function A(u,v){var b,D,P,R,Q,$,Se;return E()().wrap(function(be){for(;;)switch(be.prev=be.next){case 0:return b=u.pageSize,D=u.current,P=u.user_id,R=u.topic_id,Q=v&&Object.entries(v)[0],$=Q&&Q[0],be.next=5,Cs({pageSize:b,current:D,course_id:s,user_id:P,topic_id:R,order_by:$,order:Q?Q[1]==="ascend"?"ASC":"DESC":void 0});case 5:if(Se=be.sent,Se.success){be.next=8;break}return be.abrupt("return",{data:[],total:0,success:!1});case 8:return be.abrupt("return",{data:Se.data,total:Se.meta.total,success:!0});case 9:case"end":return be.stop()}},A)}));return function(A,u){return h.apply(this,arguments)}}(),columns:p})},Qs=null,As=t(39470),Zs=t(54434),Fs=t(68505),Os=t(14408),Ds=function(r){var s=r.visible,o=s===void 0?!1:s,a=r.handleOk,i=r.handleCancel;return(0,e.jsx)(tn.Z,{title:(0,e.jsx)(Pt._H,{id:"course_success_modal_title",defaultMessage:"course_success_modal_title"}),visible:o,onOk:a,onCancel:i,footer:[(0,e.jsx)(C.ZP,{onClick:i,children:(0,e.jsx)(Pt._H,{id:"course_success_modal_button_cancel",defaultMessage:"course_success_modal_button_cancel"})},"link"),(0,e.jsx)(C.ZP,{type:"primary",onClick:a,children:(0,e.jsx)(Pt._H,{id:"course_success_modal_button_ok",defaultMessage:"course_success_modal_button_ok"})},"link")],children:(0,e.jsx)("p",{children:(0,e.jsx)(Pt._H,{id:"course_success_modal_content",defaultMessage:"course_success_modal_content"})})})},tr=t(64317),Ls=t(74453),Rs=t(76560),Us=function(r){var s=r.id;return(0,e.jsxs)(me.ZP,{onFinish:function(){var o=N()(E()().mark(function a(i){return E()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:(0,L.O1)(Number(s),i).then(function(x){x.success&&z.ZP.success(x.message)});case 1:case"end":return _.stop()}},a)}));return function(a){return o.apply(this,arguments)}}(),request:function(){return(0,L.Pd)(Number(s)).then(function(a){return a.success?{users:a.data.users.map(function(i){return B()(i)==="object"?i.id:i}),groups:a.data.groups.map(function(i){return B()(i)==="object"?i.id:i})}:{users:[],groups:[]}})},children:[(0,e.jsx)(me.ZP.Item,{valuePropName:"value",name:"users",label:(0,e.jsx)(n.FormattedMessage,{id:"users",defaultMessage:"Users"}),children:(0,e.jsx)(Qt.Z,{multiple:!0})}),(0,e.jsx)(me.ZP.Item,{valuePropName:"value",name:"groups",label:(0,e.jsx)(n.FormattedMessage,{id:"groups",defaultMessage:"Groups"}),children:(0,e.jsx)(Rs.Z,{multiple:!0})})]})},ws=Us;function Bs(f,r){return bn.apply(this,arguments)}function bn(){return bn=N()(E()().mark(function f(r,s){return E()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,n.request)("/api/admin/templates/assignable",d()({method:"GET",useCache:!1,params:r},s||{})));case 1:case"end":return a.stop()}},f)})),bn.apply(this,arguments)}function Ns(f,r,s){return Mn.apply(this,arguments)}function Mn(){return Mn=N()(E()().mark(function f(r,s,o){return E()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,n.request)("/api/admin/templates/".concat(r,"/assign"),d()({method:"POST",headers:{"Content-Type":"application/json"},data:s},o||{})));case 1:case"end":return i.stop()}},f)})),Mn.apply(this,arguments)}function zs(f,r,s){return Pn.apply(this,arguments)}function Pn(){return Pn=N()(E()().mark(function f(r,s,o){return E()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,n.request)("/api/admin/templates/".concat(r,"/unassign"),d()({method:"POST",headers:{"Content-Type":"application/json"},data:s},o||{})));case 1:case"end":return i.stop()}},f)})),Pn.apply(this,arguments)}function $s(f,r){return Cn.apply(this,arguments)}function Cn(){return Cn=N()(E()().mark(function f(r,s){return E()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,n.request)("/api/admin/templates/assigned",d()({params:r,method:"GET",useCache:!1},s||{})));case 1:case"end":return a.stop()}},f)})),Cn.apply(this,arguments)}var Ws=function(r){var s=r.onChange,o=r.multiple,a=o===void 0?!1:o,i=r.assignable_class,c=r.assignable_id,_=r.onAssign,x=r.onUnassign,p=r.onTemplates,h=(0,l.useState)([]),A=j()(h,2),u=A[0],v=A[1],b=(0,l.useState)([]),D=j()(b,2),P=D[0],R=D[1],Q=(0,l.useState)(!1),$=j()(Q,2),Se=$[0],pe=$[1],be=(0,l.useRef)(),we=(0,l.useCallback)(function(ee){v(ee),p&&p(ee)},[p]),Ue=(0,l.useCallback)(function(){$s({assignable_class:i,assignable_id:Number(c)}).then(function(ee){ee.success&&R(ee.data.map(function(ce){return ce.id}))})},[i,c]),at=(0,l.useCallback)(function(){return pe(!0),be.current&&be.current.abort(),be.current=new AbortController,Bs({assignable_class:i},{signal:be.current.signal}).then(function(ee){ee&&ee.success&&we(ee.data),pe(!1)}).catch(function(){return pe(!1)}),function(){be.current&&be.current.abort()}},[i,c]),pt=(0,l.useCallback)(function(ee){R(function(ce){return ce.filter(function(w){return w!=ee})})},[]),tt=(0,l.useCallback)(function(ee){R(function(ce){return ce.includes(ee)?ce:[].concat(g()(ce),[ee])})},[]),_e=(0,l.useCallback)(function(ee){var ce=Array.isArray(ee)?ee:[ee],w=ce.filter(function(ye){return!P.includes(ye)}),Ge=P.filter(function(ye){return!ce.includes(ye)});w.forEach(function(ye){Ns(ye,{assignable_id:Number(c)}).then(function(qe){qe.success&&z.ZP.success(qe.message),qe.success||(z.ZP.error(qe.message),pt(ye))}).catch(function(qe){z.ZP.error(qe.toString()),pt(ye)})}),Ge.forEach(function(ye){zs(ye,{assignable_id:Number(c)}).then(function(qe){qe.success&&z.ZP.success(qe.message),qe.success||(z.ZP.error(qe.message),tt(ye))}).catch(function(qe){z.ZP.error(qe.toString()),tt(ye)})}),w.length!=0&&_&&_(w),Ge.length!=0&&x&&x(Ge),R(ce)},[P,c,_,x]);return(0,l.useEffect)(function(){at(),Ue()},[i,c]),(0,l.useEffect)(function(){s&&s(P)},[P,s]),(0,e.jsx)(At.default,{style:{width:"100%"},value:P,onChange:_e,mode:a?"multiple":void 0,showSearch:!0,placeholder:(0,e.jsx)(n.FormattedMessage,{id:"select_templates",defaultMessage:"Select a templates"}),optionFilterProp:"children",filterOption:function(ce,w){if(w&&w.children){var Ge;return(w==null||(Ge=w.children)===null||Ge===void 0?void 0:Ge.toString().toLowerCase().indexOf(ce.toLowerCase()))>=0}return!0},notFoundContent:Se?(0,e.jsx)(ae.Z,{size:"small"}):null,children:u.map(function(ee){return(0,e.jsxs)(At.default.Option,{value:ee.id,children:[ee.name," ",(0,e.jsxs)("small",{children:[(0,e.jsx)(n.FormattedMessage,{id:ee.channel.split("\\").pop()}),":",(0,e.jsx)(n.FormattedMessage,{id:ee.event.split("\\").pop()})]})," "]},ee.id)})})},Ks=Ws,ks=t(34201),Vs=function(r){var s=r.id,o=H.Z.Text,a=(0,l.useState)([]),i=j()(a,2),c=i[0],_=i[1],x=(0,l.useState)([]),p=j()(x,2),h=p[0],A=p[1],u=(0,l.useMemo)(function(){return h.map(function(v){return c.find(function(b){return b.id===v})}).filter(function(v){return v!==void 0}).filter(function(v){return v&&v.channel==="EscolaLms\\TemplatesPdf\\Core\\PdfChannel"})},[c,h]);return(0,e.jsxs)("div",{children:[(0,e.jsxs)(ie.Z,{align:"middle",children:[(0,e.jsx)(re.Z,{span:3,children:(0,e.jsx)(o,{children:(0,e.jsx)(n.FormattedMessage,{id:"CertificateTemplates",defaultMessage:"Users"})})}),(0,e.jsx)(re.Z,{span:12,children:(0,e.jsx)(Ks,{onTemplates:function(b){return _(b)},assignable_class:"EscolaLms\\Courses\\Models\\Course",assignable_id:Number(s),multiple:!0,onChange:function(b){return A(b)}})})]}),u.map(function(v){return v&&(0,e.jsx)(ks.Z,{template_id:v.id,title:v.name},v.id)})]})},Gs=Vs,mt=function(f){return f.ATTRIBUTES="attributes",f.PRODUCT="product",f.MEDIA="media",f.USER_SUBMISSION="user_submission",f.CATEGORIES="categories",f.PROGRAM="program",f.SCORM="scorm",f.ACCESS="access",f.CERTIFICATES="certificates",f.QUESTIONNAIRES="questionnaires",f.STATISTICS="statistics",f.USER_PROJECTS="user_projects",f}(mt||{}),Hs=function(){var f,r,s,o,a=(0,n.useParams)(),i=(0,n.useIntl)(),c=a.course,_=a.tab,x=_===void 0?mt.ATTRIBUTES:_,p=c==="new",h=(0,n.useAccess)(),A=(0,l.useState)(),u=j()(A,2),v=u[0],b=u[1],D=(0,Os.Z)(),P=D.manageCourseEdit,R=D.setManageCourseEdit,Q=D.validateCourseEdit,$=(0,l.useState)(null),Se=j()($,2),pe=Se[0],be=Se[1],we=(0,l.useState)(null),Ue=j()(we,2),at=Ue[0],pt=Ue[1],tt=(0,l.useState)({showModal:!1,courseId:0}),_e=j()(tt,2),ee=_e[0],ce=_e[1],w=(0,l.useState)(!0),Ge=j()(w,2),ye=Ge[0],qe=Ge[1],yt=(0,Fs.E)(),nt=yt.showNotification,jt=(0,n.getAllLocales)()||[],gt=(0,n.useModel)("@@initialState"),Be=gt.setInitialState,V=gt.initialState,et=me.ZP.useForm(),dt=j()(et,1),Ye=dt[0],ot=(f=V==null||(r=V.config)===null||r===void 0||(r=r.find(function(Oe){return Oe.key==="showInCourseAdditionalSettings-public"}))===null||r===void 0?void 0:r.data)!==null&&f!==void 0?f:!1,ke=(s=V==null||(o=V.config)===null||o===void 0||(o=o.filter(function(Oe){return Oe.key.includes("hideInCourseTabs")}))===null||o===void 0?void 0:o.reduce(function(Oe,De){var He=De.key,Je=De.data;return Oe[He.split("-")[1]]=Je,Oe},{}))!==null&&s!==void 0?s:{};(0,l.useEffect)(function(){x===mt.ATTRIBUTES&&v&&ye&&(Q(v),qe(!1))},[v,x,ye]),(0,l.useEffect)(function(){if(c==="new"){b({title:"new"});return}var Oe=function(){var De=N()(E()().mark(function He(){var Je,vt,xt;return E()().wrap(function(st){for(;;)switch(st.prev=st.next){case 0:return st.next=2,(0,L.XR)(Number(c));case 2:Je=st.sent,Je.success&&(b(d()(d()({},Je.data),{},{categories:(vt=Je.data.categories)===null||vt===void 0?void 0:vt.map(Dt.i4),tags:(xt=Je.data.tags)===null||xt===void 0?void 0:xt.map(Dt.ZR),summary:Je.data.summary||""})),be(Je.data.active_from),pt(Je.data.active_to));case 4:case"end":return st.stop()}},He)}));return function(){return De.apply(this,arguments)}}();Oe()},[c]);var _t=(0,l.useMemo)(function(){return{onValuesChange:function(De){return R(d()(d()({},P),{},{valuesChanged:!0})),De.active_from&&be(De.active_from),De.active_to&&pt(De.active_to),De.title&&b({title:De.title})},onFinish:function(){var Oe=N()(E()().mark(function He(Je){var vt,xt;return E()().wrap(function(st){for(;;)switch(st.prev=st.next){case 0:if(!P.disableEdit){st.next=3;break}return R({showModal:!0,disableEdit:!0,clicked:!1}),st.abrupt("return");case 3:if(vt=d()(d()({},Je),{},{active_from:Je.active_from||(v==null?void 0:v.active_from)||null,active_to:Je.active_to||(v==null?void 0:v.active_to)||null,authors:Je.authors&&Je.authors.map(function(Lt){return B()(Lt)==="object"?Lt.id:Lt}),scorm_sco_id:Je.scorm_sco_id?Je.scorm_sco_id:null,image_url:v&&v.image_url,image_path:v&&v.image_url&&(0,Dt.Ox)(v.image_url),video_url:v&&v.video_url,video_path:v&&v.video_url&&(0,Dt.Ox)(v.video_url),poster_url:v&&v.poster_url,poster_path:v&&v.poster_url&&(0,Dt.Ox)(v.poster_url),hours_to_complete:Je.hours_to_complete||null}),c!=="new"){st.next=11;break}return st.next=7,(0,L.P6)(vt);case 7:xt=st.sent,xt.success&&xt.data.id&&ce({showModal:!0,courseId:xt.data.id}),st.next=14;break;case 11:return st.next=13,(0,L.Hf)(Number(c),vt);case 13:xt=st.sent;case 14:nt(xt),R(d()(d()({},P),{},{showConfirmModal:!1,loading:!1,valuesChanged:!1}));case 16:case"end":return st.stop()}},He)}));function De(He){return Oe.apply(this,arguments)}return De}(),initialValues:v,validate:!0,form:Ye}},[c,v,P,Ye]),ut=(0,l.useMemo)(function(){var Oe,De=jt.map(function(Je){return Je.split("-")[0]}).reduce(function(Je,vt){return d()(d()({},Je),{},I()({},vt,vt))},{}),He=JSON.parse((V==null||(Oe=V.config)===null||Oe===void 0||(Oe=Oe.find(function(Je){return Je.key==="locales"}))===null||Oe===void 0?void 0:Oe.value)||"{}");return He?d()(d()({},De),He):De},[jt]);return v?(0,e.jsxs)(Ls._z,{title:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.FormattedMessage,{id:v.title?"course":"new_course"}),", ",(0,e.jsx)(n.FormattedMessage,{id:x})]}),header:{breadcrumb:{routes:[{path:"courses/list",breadcrumbName:i.formatMessage({id:"menu.Courses"})},{path:String(c),breadcrumbName:i.formatMessage({id:"form"})},{path:"/",breadcrumbName:String(v.title)},{path:String(x),breadcrumbName:i.formatMessage({id:x,defaultMessage:String(x)})}]}},children:[(0,e.jsxs)(T.ZP,{bodyStyle:{padding:"24px"},tabs:{type:"card",activeKey:x,onChange:function(De){Be(d()(d()({},V),{},{collapsed:De==="program"})),De!==mt.ATTRIBUTES&&P.valuesChanged?R(d()(d()({},P),{},{showConfirmModal:!0})):n.history.push("/courses/list/".concat(c,"/").concat(De))}},children:[(0,e.jsxs)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"attributes"}),children:[P.disableEdit&&(0,e.jsx)(ne.Z,{closable:!0,style:{marginBottom:"20px"},type:"warning",message:(0,e.jsx)(n.FormattedMessage,{id:"course_edit_warning_message",defaultMessage:"course_edit_warning_message"}),action:(0,e.jsx)(C.ZP,{onClick:function(){return R({showModal:!0,disableEdit:!0,clicked:!0})},type:"primary",children:(0,e.jsx)(n.FormattedMessage,{id:"questionnaire.submit",defaultMessage:"questionnaire.submit"})})}),(0,e.jsx)(Qe.Z,{visible:P.showModal,setManage:R}),(0,e.jsx)(Ds,{visible:ee.showModal,handleOk:function(){n.history.push("/courses/list/".concat(ee.courseId,"/program"))},handleCancel:function(){return n.history.push("/courses/list/".concat(ee.courseId,"/attributes"))}}),(0,e.jsxs)(me.ZP,d()(d()({},_t),{},{children:[(0,e.jsxs)(me.ZP.Group,{label:(0,e.jsx)(n.FormattedMessage,{id:"description"}),children:[(0,e.jsx)(Ct.Z,{width:"xl",name:"title",label:(0,e.jsx)(n.FormattedMessage,{id:"title"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.title"}),placeholder:i.formatMessage({id:"title",defaultMessage:"title"}),required:!0,disabled:P.disableEdit}),(0,e.jsx)(Ct.Z,{width:"xl",name:"subtitle",label:(0,e.jsx)(n.FormattedMessage,{id:"subtitle"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.subtitle"}),placeholder:i.formatMessage({id:"subtitle",defaultMessage:"subtitle"}),disabled:P.disableEdit}),(0,e.jsx)(me.ZP.Item,{name:"summary",label:(0,e.jsx)(n.FormattedMessage,{id:"summary"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.summary"}),valuePropName:"value",style:{width:697},children:(0,e.jsx)(It.ZP,{directory:"course/".concat(c,"/wysiwyg")})}),(0,e.jsx)(me.ZP.Item,{name:"description",label:(0,e.jsx)(n.FormattedMessage,{id:"description"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.description"}),valuePropName:"value",style:{width:697},children:(0,e.jsx)(It.ZP,{directory:"course/".concat(c,"/wysiwyg")})})]}),(0,e.jsxs)(me.ZP.Group,{label:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),children:[(0,e.jsx)(kt.Z,{width:"md",name:"active_from",label:(0,e.jsx)(n.FormattedMessage,{id:"active_from"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.active_from"}),placeholder:i.formatMessage({id:"active_from",defaultMessage:"active_from"}),rules:[{validator:function(De,He){return He&&at&&(0,Fn.A)(new Date(He),new Date(at))?Promise.reject(new Error(i.formatMessage({id:"invalidDate"}))):Promise.resolve()}}],disabled:P.disableEdit}),(0,e.jsx)(kt.Z,{width:"md",name:"active_to",label:(0,e.jsx)(n.FormattedMessage,{id:"active_to"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.active_to"}),placeholder:i.formatMessage({id:"active_to",defaultMessage:"active_to"}),disabled:P.disableEdit||!pe,rules:[{validator:function(De,He){return He&&pe&&(0,On.R)(new Date(He),new Date(pe))?Promise.reject(new Error(i.formatMessage({id:"invalidDate"}))):Promise.resolve()}}]}),(0,e.jsx)(Ct.Z,{width:"md",name:"duration",label:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.duration"}),placeholder:i.formatMessage({id:"duration",defaultMessage:"duration"}),disabled:P.disableEdit}),(0,e.jsx)(Ht.Z,{width:"md",name:"hours_to_complete",label:(0,e.jsx)(n.FormattedMessage,{id:"hours_to_complete"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"hours_to_complete"}),placeholder:i.formatMessage({id:"hours_to_complete",defaultMessage:"hours_to_complete"}),disabled:P.disableEdit})]}),(0,e.jsxs)(me.ZP.Group,{label:(0,e.jsx)(n.FormattedMessage,{id:"additional"}),children:[ot&&(0,e.jsx)(Bt.Z,{width:"xs",name:"public",label:(0,e.jsx)(n.FormattedMessage,{id:"public_label"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"public_tooltip"}),placeholder:i.formatMessage({id:"public",defaultMessage:"public"})}),(0,e.jsx)(Ct.Z,{width:"xs",name:"level",label:(0,e.jsx)(n.FormattedMessage,{id:"level"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.level"}),placeholder:i.formatMessage({id:"level",defaultMessage:"level"})}),(0,e.jsx)(tr.Z,{name:"language",width:"xs",label:(0,e.jsx)(n.FormattedMessage,{id:"language"}),placeholder:i.formatMessage({id:"language",defaultMessage:"language"}),valueEnum:ut,initialValue:(0,n.getLocale)().split("-")[0],disabled:P.disableEdit}),(0,e.jsx)(tr.Z,{name:"status",width:"md",label:(0,e.jsx)(n.FormattedMessage,{id:"status"}),valueEnum:{draft:i.formatMessage({id:"draft",defaultMessage:"draft"}),published:i.formatMessage({id:"published",defaultMessage:"published"}),archived:i.formatMessage({id:"archived",defaultMessage:"archived"}),published_unactivated:i.formatMessage({id:"published_unactivated",defaultMessage:"published_unactivated"})},placeholder:i.formatMessage({id:"status"}),disabled:P.disableEdit,rules:[{required:!0,message:(0,e.jsx)(n.FormattedMessage,{id:"select"}),validator:function(De,He){return He?Promise.resolve():Promise.reject(new Error(i.formatMessage({id:"select"})))}}]}),(0,e.jsx)(Ct.Z,{width:"sm",name:"target_group",label:(0,e.jsx)(n.FormattedMessage,{id:"target_group"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.target_group"}),placeholder:i.formatMessage({id:"target_group",defaultMessage:"target_group"}),disabled:P.disableEdit}),(0,e.jsx)(me.ZP.Item,{name:"authors",label:(0,e.jsx)(n.FormattedMessage,{id:"author_tutor"}),valuePropName:"value",children:(0,e.jsx)(Qt.Z,{multiple:!0})})]}),(0,e.jsx)(me.ZP.Item,{name:"fields",label:(0,e.jsx)(n.FormattedMessage,{id:"course_fields"}),valuePropName:"value",children:(0,e.jsx)(it.Z,{})})]}))]},mt.ATTRIBUTES),!p&&h.salesPermission&&(0,e.jsx)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"product"}),disabled:P.disableEdit,children:c&&(0,e.jsx)(Fe.C,{productable:{class_type:"App\\Models\\Course",class_id:c,name:String(v.title),quantity:1}})},mt.PRODUCT),!p&&(0,e.jsx)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"media"}),disabled:P.disableEdit,children:(0,e.jsx)(me.ZP,d()(d()({},_t),{},{layout:"horizontal",children:(0,e.jsxs)(ie.Z,{children:[(0,e.jsx)(re.Z,{span:24,children:(0,e.jsx)(Mt.Z,{folder:"course/".concat(c),title:"image",action:"/api/admin/courses/".concat(c),src_name:"image_url",form_name:"image",getUploadedSrcField:function(De){return De.file.response.data.image_url},setPath:function(De){return b(function(He){return d()(d()({},He),De)})},hideLabel:!0})}),(0,e.jsx)(re.Z,{span:24,children:(0,e.jsx)($e,{folder:"course/".concat(c),action:"/api/admin/courses/".concat(c),src_name:"video_url",form_name:"video",getUploadedSrcField:function(De){return De.file.response.data.video_url},setPath:function(De){return b(function(He){return d()(d()({},He),De)})},hideLabel:!0})}),(0,e.jsx)(re.Z,{span:24,children:(0,e.jsx)(Mt.Z,{folder:"course/".concat(c),title:"poster",action:"/api/admin/courses/".concat(c),src_name:"poster_url",form_name:"poster",getUploadedSrcField:function(De){return De.file.response.data.poster_url},setPath:function(De){return b(function(He){return d()(d()({},He),De)})},hideLabel:!0})})]})}))},mt.MEDIA),!p&&(0,e.jsx)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"categories_tags"}),disabled:P.disableEdit,children:(0,e.jsx)(me.ZP,d()(d()({},_t),{},{children:(0,e.jsxs)(ie.Z,{children:[(0,e.jsx)(re.Z,{span:12,children:(0,e.jsx)(me.ZP.Item,{label:(0,e.jsx)(n.FormattedMessage,{id:"categories"}),name:"categories",valuePropName:"value",children:(0,e.jsx)(Ve.Z,{})})}),(0,e.jsx)(re.Z,{span:12,children:(0,e.jsx)(me.ZP.Item,{label:(0,e.jsx)(n.FormattedMessage,{id:"tags"}),name:"tags",valuePropName:"value",children:(0,e.jsx)(As.Z,{})})})]})}))},mt.CATEGORIES),!p&&(0,e.jsx)(T.ZP.TabPane,{className:"program",tab:(0,e.jsx)(n.FormattedMessage,{id:"program"}),disabled:P.disableEdit,cardProps:{bodyStyle:{padding:0}},children:c&&(0,e.jsx)(Ps,{id:c})},mt.PROGRAM),!p&&h.scormListPermission&&(0,e.jsx)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"scorm"}),disabled:P.disableEdit,children:(0,e.jsx)(me.ZP,d()(d()({},_t),{},{children:(0,e.jsx)(me.ZP.Item,{label:"Scorm",name:"scorm_sco_id",valuePropName:"value",children:(0,e.jsx)(Wn,{})})}))},mt.SCORM),!p&&(0,e.jsx)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"access"}),disabled:P.disableEdit,children:c&&(0,e.jsx)(ws,{id:c})},mt.ACCESS),!p&&h.certificatesPermission&&(0,e.jsx)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"certificates"}),disabled:P.disableEdit,children:c&&(0,e.jsx)(Gs,{id:c})},mt.CERTIFICATES),!p&&h.questionnaireListPermission&&(0,e.jsx)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"questionnaires"}),disabled:P.disableEdit,children:c&&(0,e.jsx)(Ie,{modelType:se.COURSE,id:Number(c)})},mt.QUESTIONNAIRES),!p&&!ke.statistics&&(0,e.jsx)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"statistics"}),disabled:P.disableEdit,children:c&&(0,e.jsx)(Ke,{courseId:c})},mt.STATISTICS),!p&&!ke.user_submission&&(0,e.jsx)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"user_submission"}),disabled:P.disableEdit,children:c&&(0,e.jsx)(Zs.ZP,{id:Number(c),type:"App\\Models\\Course"})},mt.USER_SUBMISSION),!p&&!ke.user_projects&&(0,e.jsx)(T.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"user_projects"}),children:(0,e.jsx)(Is,{courseId:Number(c)})},mt.USER_PROJECTS)]}),(0,e.jsx)(Le.Z,{open:!!P.showConfirmModal,onOk:function(){R(d()(d()({},P),{},{loading:!0})),Ye.submit()},onCancel:function(){R(d()(d()({},P),{},{showConfirmModal:!1}))},loading:!!P.loading})]}):(0,e.jsx)(ae.Z,{})}},62343:function(ct,Ne,t){"use strict";var ze=t(52677),I=t.n(ze),We=t(5574),B=t.n(We),Te=t(952),E=t(37476),ve=t(5966),d=t(52688),xe=t(86615),N=t(90672),le=t(63434),j=t(31199),Pe=t(55102),Z=t(14726),de=t(75842),k=t(49288),z=t(67294),F=t(43564),l=t(80854),n=t(20568),W=t(19411),e=t(88284),ue=t(28508),se=t(55171),fe=t.n(se),M=t(85893),Ie=function(G){var g=G.value,m=G.onChange,O=G.type,ge=O===void 0?"file":O,X=(0,z.useState)(!1),q=B()(X,2),L=q[0],J=q[1];return(0,M.jsxs)(z.Fragment,{children:[(0,M.jsxs)(Te.ZP.Group,{children:[(0,M.jsx)(Pe.Z,{value:g,readOnly:!0}),(0,M.jsxs)(Z.ZP,{size:"small",type:"primary",onClick:function(){return J(!L)},children:["toggle ",ge," browser"]})]}),L&&(0,M.jsx)(n.Z,{onFile:function(S,te){return m&&m("".concat(te,"/").concat(S.name))}})]})},Ve=function(G){var g=(0,l.useIntl)(),m=G.visible,O=G.onVisibleChange,ge=G.onFinish,X=G.id,q=G.initialData,L=G.groups,J=de.Z.useForm(),C=B()(J,1),S=C[0],te=!X||X===-1,Ce=(0,z.useState)("text"),K=B()(Ce,2),U=K[0],je=K[1],Y=(0,z.useCallback)(function(){return!!(S.getFieldValue("group")==="global"||q)},[S,q]),T=(0,z.useState)(""),H=B()(T,2),ae=H[0],ne=H[1];(0,z.useEffect)(function(){if(I()(X)==="object"){var y;S.setFieldsValue(X),je((y=X.type)!==null&&y!==void 0?y:"text")}else X&&X!==-1?(0,F.GF)(Number(X)).then(function(Ae){Ae.success&&(S.setFieldsValue(Ae.data),je(Ae.data.type),ne(Ae.data.group))}):(S.resetFields(),je("text"))},[X,S,q]);var he=(0,z.useCallback)(function(y){y.type&&y.type!==U&&je(y.type)},[U]);return(0,M.jsxs)(E.Y,{form:S,title:g.formatMessage({id:X?"editSetting":"newSetting",defaultMessage:X?"editSetting":"newSetting"}),width:"60vw",visible:!!m,onVisibleChange:O,onFinish:ge,onValuesChange:he,children:[(0,M.jsxs)(Te.ZP.Group,{children:[q?(0,M.jsx)(ve.Z,{label:(0,M.jsx)(l.FormattedMessage,{id:"group",defaultMessage:"group"}),rules:[{required:!0}],width:"md",name:"group",disabled:Y()}):(0,M.jsx)(Te.ZP.Item,{label:(0,M.jsx)(l.FormattedMessage,{id:"group",defaultMessage:"group"}),name:"group",children:(0,M.jsx)(k.Z,{style:{width:"300px"},autoFocus:!0,value:ae,onChange:function(Ae){return ne(Ae)},filterOption:function(Ae,Ee){var Ze;return(Ee==null||(Ze=Ee.children)===null||Ze===void 0?void 0:Ze.toString().toLowerCase().indexOf(Ae.toLowerCase()))!==-1},children:L.map(function(y){return(0,M.jsx)(k.Z.Option,{value:y,children:y},y)})})}),(0,M.jsx)(ve.Z,{label:(0,M.jsx)(l.FormattedMessage,{id:"key",defaultMessage:"key"}),rules:[{required:!0}],width:"md",name:"key",disabled:Y()})]}),(0,M.jsxs)(Te.ZP.Group,{children:[(0,M.jsx)(d.Z,{name:"enumerable",disabled:Y(),label:(0,M.jsx)(l.FormattedMessage,{id:"enumerable",defaultMessage:"enumerable"})}),(0,M.jsx)(d.Z,{name:"public",disabled:Y(),label:(0,M.jsx)(l.FormattedMessage,{id:"public",defaultMessage:"public"})})]}),(0,M.jsx)(Te.ZP.Group,{children:(0,M.jsx)(xe.Z.Group,{disabled:!!(!te||q),name:"type",label:(0,M.jsx)(l.FormattedMessage,{id:"type"}),options:[{label:"text",value:"text"},{label:"markdown",value:"markdown"},{label:"json",value:"json"},{label:"file",value:"file"},{label:"image",value:"image"},{label:"boolean",value:"boolean"},{label:"number",value:"number"},{label:"array",value:"array"}]})}),(0,M.jsxs)("div",{children:[U==="text"&&(0,M.jsx)(ve.Z,{width:"lg",name:"value",label:(0,M.jsx)(l.FormattedMessage,{id:"value"})}),U==="json"&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(N.Z,{width:"lg",name:"value",label:(0,M.jsx)(l.FormattedMessage,{id:"value"}),tooltip:"".concat(g.formatMessage({id:"example_json"}),': {"name":"John", "age":30, "city":["New York","Warsaw"]}')}),(0,M.jsx)(Te.ZP.Item,{noStyle:!0,shouldUpdate:!0,children:function(){try{return(0,M.jsx)(fe(),{src:JSON.parse(S.getFieldValue("value"))})}catch(Ae){return(0,M.jsx)(fe(),{src:JSON.parse('{ "error": "cannot parse this json" }')})}}})]}),(U==="file"||U==="image")&&(0,M.jsx)(Te.ZP.Item,{name:"value",label:"value",tooltip:"select file from current repository or upload new one",valuePropName:"value",children:(0,M.jsx)(Ie,{type:U})}),U==="markdown"&&(0,M.jsx)(Te.ZP.Item,{name:"value",label:"value",tooltip:"The editor is WYSIWYG and includes formatting tools whilst retaining the ability to write markdown shortcuts inline and output plain Markdown.",valuePropName:"value",children:(0,M.jsx)(W.ZP,{directory:"settings/wysiwyg"})}),U==="boolean"?(0,M.jsx)(d.Z,{name:"value",label:(0,M.jsx)(l.FormattedMessage,{id:"value"}),checkedChildren:(0,M.jsx)(e.Z,{}),unCheckedChildren:(0,M.jsx)(ue.Z,{})}):(0,M.jsx)(Te.ZP.Item,{noStyle:!0,hidden:!0,children:(0,M.jsx)(le.Z,{name:"data",valuePropName:"data"})}),U==="number"&&(0,M.jsx)(j.Z,{name:"data",label:(0,M.jsx)(l.FormattedMessage,{id:"value"})}),U==="array"&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(N.Z,{width:"lg",name:"value",label:(0,M.jsx)(l.FormattedMessage,{id:"value"}),tooltip:"".concat(g.formatMessage({id:"example_json"}),": ['tutor', 'student']")}),(0,M.jsx)(Te.ZP.Item,{noStyle:!0,shouldUpdate:!0,children:function(){try{return(0,M.jsx)(fe(),{src:JSON.parse(S.getFieldValue("value"))})}catch(Ae){return(0,M.jsx)(fe(),{src:JSON.parse('{ "error": "cannot parse this json" }')})}}})]})]})]})};Ne.ZP=Ve},59234:function(ct,Ne,t){"use strict";t.d(Ne,{Wg:function(){return ge}});var ze=t(5574),I=t.n(ze),We=t(19632),B=t.n(We),Te=t(15009),E=t.n(Te),ve=t(97857),d=t.n(ve),xe=t(99289),N=t.n(xe),le=t(31472),j=t(51042),Pe=t(16894),Z=t(2453),de=t(83062),k=t(14726),z=t(86738),F=t(67294),l=t(80854),n=t(43564),W=t(56717),e=t(47389),ue=t(82061),se=t(62343),fe=t(20188),M=t(85893),Ie=function(){var C=N()(E()().mark(function S(te,Ce,K){var U,je;return E()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return U=Z.ZP.loading(te.formatMessage({id:"loading"})),T.prev=1,T.next=4,K&&K!==-1?(0,n.VP)(K,d()({},Ce)):(0,n.oh)(d()({},Ce));case 4:return je=T.sent,U(),Z.ZP.success(te.formatMessage({id:"success"})),T.abrupt("return",{success:!0,updatedSettings:je});case 10:return T.prev=10,T.t0=T.catch(1),U(),Z.ZP.error(te.formatMessage({id:"error"})),T.abrupt("return",{success:!1,updateSettings:null});case 15:case"end":return T.stop()}},S,null,[[1,10]])}));return function(te,Ce,K){return C.apply(this,arguments)}}(),Ve=function(){var C=N()(E()().mark(function S(te,Ce){var K;return E()().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:return K=Z.ZP.loading(te.formatMessage({id:"loading"})),je.prev=1,je.next=4,(0,n.Rb)(Ce);case 4:return K(),Z.ZP.success(te.formatMessage({id:"success"})),je.abrupt("return",!0);case 9:return je.prev=9,je.t0=je.catch(1),K(),Z.ZP.error(te.formatMessage({id:"error"})),je.abrupt("return",!1);case 14:case"end":return je.stop()}},S,null,[[1,9]])}));return function(te,Ce){return C.apply(this,arguments)}}(),Le=function(S){return S.toLowerCase().replace(/(_\w)/g,function(te){return te.toUpperCase().substr(1)})},G=["statistics","user_submission","user_projects"],g=["public"],m=["email","sms"],O=function(S){return"hideInMenu-".concat(Le(S.split("/").join("_")))},ge=function(S){return"disableTopicType-".concat(S)},X=[].concat(B()(Object.keys(le.oz).map(function(C){return{key:ge(C),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}})),B()(["ECommerce","Certificates"].map(function(C){return{key:"disable-".concat(C),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}})),B()(g.map(function(C){return{key:"showInCourseAdditionalSettings-".concat(C),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}})),B()(G.map(function(C){return{key:"hideInCourseTabs-".concat(C),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}})),B()(m.map(function(C){return{key:"hideTemplateTab-".concat(C),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}}))).reduce(function(C,S,te){return C[S.key]=d()(d()({},S),{},{id:-100*te}),C},{}),q=d()({logo:{id:-1,key:"logo",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"image",data:"EscolaLMS"},frontURL:{id:-2,key:"frontURL",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},maxLessonsNestingInProgram:{id:-4,key:"maxLessonsNestingInProgram",group:"global",value:"0",public:!0,enumerable:!0,sort:1,type:"number",data:0},minTopicNestingInProgram:{id:-5,key:"minTopicNestingInProgram",group:"global",value:"0",public:!0,enumerable:!0,sort:1,type:"number",data:0},companyName:{id:-6,key:"companyName",group:"global",value:"Wellms",public:!0,enumerable:!0,sort:0,type:"text",data:"Wellms"},companyURL:{id:-7,key:"companyURL",group:"global",value:"https://www.wellms.io/",public:!0,enumerable:!0,sort:0,type:"text",data:"https://www.wellms.io/"},logoLogin:{id:-8,key:"logoLogin",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"image",data:"EscolaLMS"},logoFooter:{id:-9,key:"logoFooter",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"image",data:"EscolaLMS"},footerFontColor:{id:-10,key:"footerFontColor",group:"global",value:"#00000072",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},showLoginBackgroundImage:{id:-11,key:"showLoginBackgroundImage",group:"global",value:"true",public:!0,enumerable:!0,sort:0,type:"boolean",data:"EscolaLMS"},loginHeaderBackgroundColor:{id:-12,key:"loginHeaderBackgroundColor",group:"global",value:"#f0f2f5",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},loginHeaderFontColor:{id:-13,key:"loginHeaderFontColor",group:"global",value:"#000000D8",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},loginFormBackgroundColor:{id:-14,key:"loginFormBackgroundColor",group:"global",value:"#f0f2f5",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},contentBackgroundColor:{id:-15,key:"contentBackgroundColor",group:"global",value:"#f0f2f5",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},technicalMaintenance:{id:-16,key:"technicalMaintenance",group:"global",value:"false",public:!0,enumerable:!0,sort:0,type:"boolean",data:"EscolaLMS"},technicalMaintenanceText:{id:-17,key:"technicalMaintenanceText",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"}},X),L=function(S){return typeof S.path=="string"},J=function(){var S=(0,F.useState)(!1),te=I()(S,2),Ce=te[0],K=te[1],U=(0,F.useRef)(),je=(0,l.useIntl)(),Y=(0,F.useState)(q),T=I()(Y,2),H=T[0],ae=T[1],ne=(0,l.useModel)("@@initialState"),he=ne.setInitialState,y=ne.initialState;(0,F.useEffect)(function(){(0,fe.s)().then(function(Ze){var Xe=Object.values(Ze.routes).filter(L).filter(function(Ke){return Ke.path&&Ke.path!=="/"&&Ke.layout!==!1}).map(function(Ke){return{path:Ke.path,key:O(Ke.path),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}});ae(function(Ke){return d()(d()({},Ke),Xe)})})},[]),(0,F.useEffect)(function(){U.current&&U.current.reload()},[H]);var Ae=[{title:(0,M.jsx)(l.FormattedMessage,{id:"key",defaultMessage:"key"}),dataIndex:"key",hideInSearch:!0,render:function(Xe,Ke){return(0,M.jsx)(F.Fragment,{children:(0,M.jsxs)(de.Z,{title:(0,M.jsx)(l.FormattedMessage,{id:"Settings.tooltip.".concat(Ke.key)}),children:[Ke.key," ",(0,M.jsx)(W.Z,{})]})})}},{title:(0,M.jsx)(l.FormattedMessage,{id:"type",defaultMessage:"type"}),dataIndex:"type",hideInSearch:!0},{title:(0,M.jsx)(l.FormattedMessage,{id:"value",defaultMessage:"value"}),dataIndex:"value",hideInForm:!0,hideInSearch:!0,render:function(Xe,Ke){return Ke.value}},{hideInSearch:!0,title:(0,M.jsx)(l.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",valueType:"option",render:function(Xe,Ke){return[Ke.id>0?(0,M.jsx)(de.Z,{title:(0,M.jsx)(l.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,M.jsx)(k.ZP,{type:"primary",icon:(0,M.jsx)(e.Z,{}),onClick:function(){return K(Ke.id)}})},"edit"):(0,M.jsx)(de.Z,{title:(0,M.jsx)(l.FormattedMessage,{id:"create",defaultMessage:"create"}),children:(0,M.jsx)(k.ZP,{type:"primary",icon:(0,M.jsx)(j.Z,{}),onClick:function(){K(H[Ke.key]||-1)}})},"create"),(0,M.jsx)(z.Z,{title:(0,M.jsx)(l.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:N()(E()().mark(function Qe(){var it;return E()().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return me.next=2,Ve(je,Ke.id);case 2:it=me.sent,it&&(K(!1),U.current&&U.current.reload());case 4:case"end":return me.stop()}},Qe)})),okText:(0,M.jsx)(l.FormattedMessage,{id:"yes",defaultMessage:"Yes"}),cancelText:(0,M.jsx)(l.FormattedMessage,{id:"no",defaultMessage:"No"}),children:Ke.id>0?(0,M.jsx)(de.Z,{title:(0,M.jsx)(l.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,M.jsx)(k.ZP,{type:"primary",icon:(0,M.jsx)(ue.Z,{}),danger:!0})}):null},"delete")]}}],Ee=function(Xe){var Ke;if(Xe&&(!(y!=null&&(Ke=y.config)!==null&&Ke!==void 0&&Ke.length)&&Xe&&he(d()(d()({},y),{},{config:[Xe]})),!!(y!=null&&y.config))){var Qe=y==null?void 0:y.config.map(function(it){return it.key===Xe.key?d()(d()({},it),Xe):it});he(d()(d()({},y),{},{config:Qe}))}};return(0,M.jsxs)(F.Fragment,{children:[(0,M.jsx)(Pe.ZP,{headerTitle:je.formatMessage({id:"menu.settings"}),search:!1,toolBarRender:!1,actionRef:U,rowKey:"id",request:function(Xe){var Ke=Xe.pageSize,Qe=Xe.current;return(0,n.Xd)({per_page:Ke,current:Qe,group:"global"}).then(function(it){if(it.success){var Mt=[].concat(B()(Object.keys(H).map(function(me){return it.data.find(function(Ot){return Ot.key===me})||H[me]})),B()(it.data.filter(function(me){return!Object.keys(H).includes(me.key)})));return{data:Mt,total:Mt.length,success:!0}}return[]})},columns:Ae}),(0,M.jsx)(se.ZP,{groups:[],id:Ce,visible:Ce,initialData:H,onVisibleChange:function(Xe){return!Xe&&K(!1)},onFinish:function(){var Ze=N()(E()().mark(function Xe(Ke){var Qe,it,Mt,me;return E()().wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return Qe=Ke,Qe.type==="number"&&(Qe=d()(d()({},Qe),{},{value:String(Qe.data)})),Qe.type==="boolean"&&(Qe=d()(d()({},Qe),{},{value:Qe.data})),Qe.type==="array"&&(Qe=d()(d()({},Qe),{},{value:JSON.parse(Qe.value)})),Et.next=6,Ie(je,Qe,Number(Ce));case 6:it=Et.sent,Mt=it.success,me=it.updatedSettings,Mt&&(me!=null&&me.success&&Ee(me.data),K(!1),U.current&&U.current.reload());case 10:case"end":return Et.stop()}},Xe)}));return function(Xe){return Ze.apply(this,arguments)}}()})]})};Ne.ZP=J},17578:function(ct,Ne,t){"use strict";t.d(Ne,{Od:function(){return de},QZ:function(){return d},ht:function(){return N},pV:function(){return Z},ws:function(){return j}});var ze=t(15009),I=t.n(ze),We=t(97857),B=t.n(We),Te=t(99289),E=t.n(Te),ve=t(80854);function d(z,F){return xe.apply(this,arguments)}function xe(){return xe=E()(I()().mark(function z(F,l){return I()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.abrupt("return",(0,ve.request)("/api/admin/file/list",B()({method:"GET",params:F},l||{})));case 1:case"end":return W.stop()}},z)})),xe.apply(this,arguments)}function N(z,F){return le.apply(this,arguments)}function le(){return le=E()(I()().mark(function z(F,l){return I()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.abrupt("return",(0,ve.request)("/api/admin/file/find",B()({method:"GET",params:F},l||{})));case 1:case"end":return W.stop()}},z)})),le.apply(this,arguments)}function j(z,F,l){return Pe.apply(this,arguments)}function Pe(){return Pe=E()(I()().mark(function z(F,l,n){var W;return I()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return W=new FormData,W.append("file[]",F),W.append("target",l),ue.abrupt("return",(0,ve.request)("/api/admin/file/upload",B()({method:"POST",data:W},n||{})));case 4:case"end":return ue.stop()}},z)})),Pe.apply(this,arguments)}var Z=function(F){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;return"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/images/img?path=").concat(F,"&w=").concat(l)};function de(z,F){return k.apply(this,arguments)}function k(){return k=E()(I()().mark(function z(F,l){return I()().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.abrupt("return",(0,ve.request)("/api/admin/file/delete",B()({method:"DELETE",data:{url:F}},l||{})));case 1:case"end":return W.stop()}},z)})),k.apply(this,arguments)}},97704:function(ct,Ne,t){"use strict";t.d(Ne,{Kn:function(){return d},LK:function(){return Pe},RN:function(){return j},gq:function(){return F},jc:function(){return k},x0:function(){return Z}});var ze=t(15009),I=t.n(ze),We=t(97857),B=t.n(We),Te=t(99289),E=t.n(Te),ve=t(80854);function d(n,W){return xe.apply(this,arguments)}function xe(){return xe=E()(I()().mark(function n(W,e){return I()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.abrupt("return",(0,ve.request)("/api/admin/hh5p/content",B()({method:"GET",params:W},e||{})));case 1:case"end":return se.stop()}},n)})),xe.apply(this,arguments)}function N(n,W){return le.apply(this,arguments)}function le(){return le=_asyncToGenerator(_regeneratorRuntime().mark(function n(W,e){return _regeneratorRuntime().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.abrupt("return",request("/api/admin/hh5p/content/".concat(W),_objectSpread({method:"GET"},e||{})));case 1:case"end":return se.stop()}},n)})),le.apply(this,arguments)}var j=function(W){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"en",ue=arguments.length>2?arguments[2]:void 0,se=W?"/api/admin/hh5p/editor/".concat(W):"/api/admin/hh5p/editor";return se=e?"".concat(se,"?lang=").concat(e):se,(0,ve.request)(se,B()({method:"GET"},ue||{}))},Pe=function(W){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"en",ue=arguments.length>2?arguments[2]:void 0,se="/api/admin/hh5p/content/".concat(W);return se=e?"".concat(se,"?lang=").concat(e):se,(0,ve.request)(se,B()({method:"GET"},ue||{}))};function Z(n,W,e){return de.apply(this,arguments)}function de(){return de=E()(I()().mark(function n(W,e,ue){return I()().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return fe.abrupt("return",(0,ve.request)(e?"/api/admin/hh5p/content/".concat(e):"/api/admin/hh5p/content",B()({method:"POST",headers:{"Content-Type":"application/json"},data:W},ue||{})));case 1:case"end":return fe.stop()}},n)})),de.apply(this,arguments)}function k(n){return z.apply(this,arguments)}function z(){return z=E()(I()().mark(function n(W){return I()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.abrupt("return",(0,ve.request)("/api/admin/hh5p/content/".concat(W),{method:"DELETE"}));case 1:case"end":return ue.stop()}},n)})),z.apply(this,arguments)}function F(n){return l.apply(this,arguments)}function l(){return l=E()(I()().mark(function n(W){return I()().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return ue.abrupt("return",(0,ve.request)("/api/admin/hh5p/content?per_page=0",B()({method:"GET"},W||{})));case 1:case"end":return ue.stop()}},n)})),l.apply(this,arguments)}},76841:function(ct,Ne,t){"use strict";t.d(Ne,{Gm:function(){return d},Sx:function(){return j},_g:function(){return N}});var ze=t(15009),I=t.n(ze),We=t(97857),B=t.n(We),Te=t(99289),E=t.n(Te),ve=t(80854);function d(Z,de){return xe.apply(this,arguments)}function xe(){return xe=E()(I()().mark(function Z(de,k){return I()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.abrupt("return",(0,ve.request)("/api/admin/reports/report",B()({params:de,method:"GET",useCache:!1},k||{})));case 1:case"end":return F.stop()}},Z)})),xe.apply(this,arguments)}function N(Z,de,k){return le.apply(this,arguments)}function le(){return le=E()(I()().mark(function Z(de,k,z){return I()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,ve.request)("/api/admin/stats/course/".concat(de,"/export"),B()({params:k,method:"GET",useCache:!1,responseType:"blob",headers:{accept:"application/vnd.ms-excel"}},z||{})));case 1:case"end":return l.stop()}},Z)})),le.apply(this,arguments)}function j(Z,de,k){return Pe.apply(this,arguments)}function Pe(){return Pe=E()(I()().mark(function Z(de,k,z){return I()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,ve.request)("/api/admin/stats/topic/".concat(de,"/export"),B()({method:"GET",useCache:!1,params:{stat:k},responseType:"blob",headers:{accept:"application/vnd.ms-excel"}},z||{})));case 1:case"end":return l.stop()}},Z)})),Pe.apply(this,arguments)}},9649:function(ct,Ne,t){"use strict";t.d(Ne,{JZ:function(){return d},NK:function(){return j}});var ze=t(15009),I=t.n(ze),We=t(97857),B=t.n(We),Te=t(99289),E=t.n(Te),ve=t(80854);function d(Z,de){return xe.apply(this,arguments)}function xe(){return xe=E()(I()().mark(function Z(de,k){return I()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.abrupt("return",(0,ve.request)("/api/admin/scorm",B()({params:de,method:"GET",useCache:!1},k||{})));case 1:case"end":return F.stop()}},Z)})),xe.apply(this,arguments)}function N(Z,de){return le.apply(this,arguments)}function le(){return le=_asyncToGenerator(_regeneratorRuntime().mark(function Z(de,k){return _regeneratorRuntime().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.abrupt("return",request("/api/admin/scorm/scos",_objectSpread({params:_objectSpread(_objectSpread({},de),{},{per_page:de.pageSize,page:de.current}),method:"GET",useCache:!1},k||{})));case 1:case"end":return F.stop()}},Z)})),le.apply(this,arguments)}function j(Z,de){return Pe.apply(this,arguments)}function Pe(){return Pe=E()(I()().mark(function Z(de,k){return I()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.abrupt("return",(0,ve.request)("/api/admin/scorm/".concat(de),B()({method:"DELETE"},k||{})));case 1:case"end":return F.stop()}},Z)})),Pe.apply(this,arguments)}},93414:function(){},70172:function(){},2001:function(){},33779:function(){},66558:function(){},82258:function(){}}]);

//# sourceMappingURL=p__Courses__form.4101a874.async.js.map