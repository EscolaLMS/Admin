(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"3fxf":function(F,m,t){"use strict";var M=t("DjyN"),P=t("NUBc"),A=t("Mwp2"),l=t("VXEj"),E=t("+L6B"),D=t("2/Rp"),s=t("5NDa"),y=t("5rEg"),p=t("oBTY"),a=t("k1fw"),h=t("tJVT"),_=t("DYRE"),W=t("zeV3"),i=t("tU7J"),c=t("wFql"),r=t("q1tI"),d=t.n(r),f=t("BAh9"),o=t("/MfK"),R=t("mAF4"),g=t("dF/Y"),I=t("9kvl"),z=t("DBJ/"),j=t("lLVY"),X=t.n(j),e=t("nKUr"),Q=t.n(e),S=function(T){var x=T.directory,L=T.onUploaded;return Object(e.jsxs)(W.b,{align:"start",children:[Object(e.jsxs)(c.a.Text,{children:[Object(e.jsx)(I.a,{id:"pages.files.filesBrowser"}),Object(e.jsx)(c.a.Text,{code:!0,children:x})]}),Object(e.jsx)(z.a,{url:"/api/admin/file/upload",name:"file[]",data:{target:x},onUpload:function(N){N.success&&L(x,N.data)}})]})},V=function(T){var x=T.defaultDirectory,L=x===void 0?"/":x,b=T.onFile,N=T.hideDeleteBtn,k=N===void 0?!1:N,Z=T.forceLoading,q=Z===void 0?!1:Z,tt=Object(I.i)(),et=Object(r.useState)({loading:!1,name:"",directory:L,current_page:1,data:void 0,per_page:1,last_page:1,total:0}),H=Object(h.a)(et,2),v=H[0],Y=H[1],K=Object(r.useRef)(),B=Object(r.useCallback)(function(u){Y(function(n){return Object(a.a)(Object(a.a)({},n),{},{loading:u})})},[]),w=Object(r.useCallback)(function(u,n){Y(function(O){return Object(a.a)(Object(a.a)(Object(a.a)({},O),u.data),{},{data:[{url:n.split("/").slice(0,-1).join("/"),name:"..",created_at:"",mime:"directory"}].concat(Object(p.a)(u.data.data.map(function(C){return Object(a.a)(Object(a.a)({},C),{},{url:C.mime==="directory"?"".concat(n,"/").concat(C.name):C.url})}))).filter(function(C){return n==="/"||n===L?C.name!=="..":!0}),directory:n,loading:!1})})},[B]),U=Object(r.useCallback)(function(u){var n,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,C=function(){return K.current&&K.current.abort()};return C(),K.current=new AbortController,B(!0),Object(f.a)({directory:u,page:O},{signal:(n=K.current)===null||n===void 0?void 0:n.signal}).then(function($){$.success&&w($,u)}).catch(function(){return B(!1)}),function(){C()}},[B]);Object(r.useEffect)(function(){return U(L)},[L,U]);var nt=Object(r.useCallback)(function(u){B(!0),Object(f.c)(u).then(function(){U(v.directory)}).catch(function(){B(!1)})},[U,B,v.directory]),at=Object(r.useCallback)(function(u,n){var O,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,$=function(){return K.current&&K.current.abort()};return $(),K.current=new AbortController,B(!0),Object(f.b)({directory:u,name:n,page:C},{signal:(O=K.current)===null||O===void 0?void 0:O.signal}).then(function(G){G.success&&w(G,u)}).catch(function(){return B(!1)}),function(){$()}},[B]);return Object(e.jsxs)("div",{className:"file-browser",children:[Object(e.jsxs)("div",{className:"file-browser__header",children:[Object(e.jsx)(y.a,{placeholder:tt.formatMessage({id:"search_file"}),className:"file-browser__input",onChange:function(n){return Y(function(O){return Object(a.a)(Object(a.a)({},O),{},{name:n.target.value})})},value:v.name}),Object(e.jsxs)("div",{children:[Object(e.jsx)(D.a,{className:"file-browser__button",onClick:function(){return U(v.directory)},children:Object(e.jsx)(I.a,{id:"reset"})}),Object(e.jsx)(D.a,{className:"file-browser__button",type:"primary",onClick:function(){return at(v.directory,v.name)},children:Object(e.jsx)(I.a,{id:"query"})})]})]}),Object(e.jsx)(l.b,{loading:v.loading||q,size:"small",itemLayout:"horizontal",dataSource:v.data,header:Object(e.jsx)(S,{directory:v.directory,onUploaded:function(n,O){O&&(U(n),b&&b(O,n))}}),footer:Object(e.jsx)(S,{directory:v.directory,onUploaded:function(n,O){U(n),O&&b&&b(O,n)}}),renderItem:function(n){return Object(e.jsx)(l.b.Item,{actions:n.mime!=="directory"&&!k?[Object(e.jsx)(D.a,{type:"default",danger:!0,icon:Object(e.jsx)(o.a,{}),size:"small",onClick:function(){return nt(n.url)}},"dir")]:[],children:Object(e.jsx)(l.b.Item.Meta,{avatar:n.mime==="directory"?Object(e.jsx)(D.a,{type:"primary",icon:Object(e.jsx)(R.a,{}),size:"small",onClick:function(){return U(n.url)}}):Object(e.jsx)("a",{href:n.url,target:"_blank",rel:"noreferrer",children:Object(e.jsx)(D.a,{type:"default",icon:Object(e.jsx)(g.a,{}),size:"small"})}),description:Object(e.jsx)(d.a.Fragment,{children:Object(e.jsx)(D.a,{type:"text",size:"small",onClick:function(){return n.mime==="directory"?U(n.url):b&&b(n,v.directory)},children:n.name})})})})}}),Object(e.jsx)(P.a,{pageSizeOptions:[],current:v.current_page,total:v.total,pageSize:v.per_page,onChange:function(n){return U(v.directory,n)}})]})};m.a=V},BAh9:function(F,m,t){"use strict";t.d(m,"a",function(){return D}),t.d(m,"b",function(){return y}),t.d(m,"e",function(){return a}),t.d(m,"d",function(){return _}),t.d(m,"c",function(){return W});var M=t("k1fw"),P=t("9og8"),A=t("WmNS"),l=t.n(A),E=t("9kvl");function D(c,r){return s.apply(this,arguments)}function s(){return s=Object(P.a)(l.a.mark(function c(r,d){return l.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Object(E.f)("/api/admin/file/list",Object(M.a)({method:"GET",params:r},d||{})));case 1:case"end":return o.stop()}},c)})),s.apply(this,arguments)}function y(c,r){return p.apply(this,arguments)}function p(){return p=Object(P.a)(l.a.mark(function c(r,d){return l.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Object(E.f)("/api/admin/file/find",Object(M.a)({method:"GET",params:r},d||{})));case 1:case"end":return o.stop()}},c)})),p.apply(this,arguments)}function a(c,r,d){return h.apply(this,arguments)}function h(){return h=Object(P.a)(l.a.mark(function c(r,d,f){var o;return l.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return o=new FormData,o.append("file[]",r),o.append("target",d),g.abrupt("return",Object(E.f)("/api/admin/file/upload",Object(M.a)({method:"POST",data:o},f||{})));case 4:case"end":return g.stop()}},c)})),h.apply(this,arguments)}var _=function(r){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;return"".concat("https://api-stage.escolalms.com","/api/images/img?path=").concat(r,"&w=").concat(d)};function W(c,r){return i.apply(this,arguments)}function i(){return i=Object(P.a)(l.a.mark(function c(r,d){return l.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",Object(E.f)("/api/admin/file/delete",Object(M.a)({method:"DELETE",data:{url:r}},d||{})));case 1:case"end":return o.stop()}},c)})),i.apply(this,arguments)}},"DBJ/":function(F,m,t){"use strict";var M=t("k1fw"),P=t("y8nQ"),A=t("Vl3Y"),l=t("etVw"),E=t("9kvl"),D=t("qFDU"),s=t("nKUr"),y=t.n(s);function p(a){var h=a.onChange,_=a.onUpload,W=a.url,i=a.name,c=a.extra,r=a.accept,d=a.data,f=a.wrapInForm,o=f===void 0?!0:f,R=a.title,g=a.formProps,I=Object(E.i)();return d&&d[i]&&delete d[i],Object(s.jsx)(D.a,{condition:o,wrap:function(j){return Object(s.jsx)(A.a,Object(M.a)(Object(M.a)({},g),{},{children:j}))},children:Object(s.jsx)(l.a,{title:R||Object(s.jsx)(E.a,{id:"upload_click_here"}),placeholder:I.formatMessage({id:"upload_click_here"}),onChange:function(j){h&&h(j),j.file.status==="done"&&_&&_(j.file.response)},label:Object(s.jsx)(E.a,{id:"upload"}),max:2,fieldProps:{data:d,accept:r,name:i,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}},action:"".concat("https://api-stage.escolalms.com").concat(W),extra:c})})}m.a=p},etVw:function(F,m,t){"use strict";var M=t("DZo9"),P=t("8z0m"),A=t("+L6B"),l=t("2/Rp"),E=t("wx14"),D=t("q1tI"),s=t.n(D),y=t("z7Xi"),p=t("WFLz"),a=function(_,W){var i=_.fieldProps,c=_.name,r=_.action,d=_.accept,f=_.listType,o=_.title,R=o===void 0?"\u5355\u51FB\u4E0A\u4F20":o,g=_.max,I=_.icon,z=I===void 0?s.a.createElement(y.a,null):I,j=_.value,X=_.buttonProps,e=_.onChange,Q=_.disabled,S=_.proFieldProps,V=_.fileList,J=(g===void 0||!j||(j==null?void 0:j.length)<g)&&(S==null?void 0:S.mode)!=="read",T=(f!=null?f:i==null?void 0:i.listType)==="picture-card";return s.a.createElement(P.a,Object(E.a)({action:r,accept:d,ref:W,name:c||"file",listType:f||"picture",fileList:V!=null?V:j},i,{onChange:function(L){var b;e==null||e(L),i==null||(b=i.onChange)===null||b===void 0||b.call(i,L)}}),J&&(T?s.a.createElement("span",null,z," ",R):s.a.createElement(l.a,Object(E.a)({disabled:Q||(i==null?void 0:i.disabled)},X),z,R)))};m.a=Object(p.a)(s.a.forwardRef(a),{getValueFromEvent:function(_){return _.fileList}})},lLVY:function(F,m,t){},qFDU:function(F,m,t){"use strict";var M=t("q1tI"),P=t.n(M);m.a=function(A){var l=A.condition,E=A.children,D=A.wrap;return l?P.a.cloneElement(D(E)):E}},u4ym:function(F,m,t){"use strict";t.r(m);var M=t("IzEo"),P=t("bx4M"),A=t("tU7J"),l=t("wFql"),E=t("q1tI"),D=t.n(E),s=t("tMyG"),y=t("9kvl"),p=t("3fxf"),a=t("nKUr"),h=t.n(a);m.default=function(){return Object(a.jsx)(s.a,{children:Object(a.jsxs)(P.a,{children:[Object(a.jsx)(l.a.Text,{strong:!0,children:Object(a.jsx)(y.a,{id:"pages.files.content"})}),Object(a.jsx)(p.a,{})]})})}}}]);
