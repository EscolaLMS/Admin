(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{"/y+f":function(fe,O,e){"use strict";e.d(O,"h",function(){return g}),e.d(O,"e",function(){return R}),e.d(O,"f",function(){return oe}),e.d(O,"d",function(){return ue}),e.d(O,"a",function(){return Y}),e.d(O,"c",function(){return de}),e.d(O,"b",function(){return q}),e.d(O,"g",function(){return je});var g;(function(a){a.Unselected="",a.RichText="EscolaLms\\TopicTypes\\Models\\TopicContent\\RichText",a.OEmbed="EscolaLms\\TopicTypes\\Models\\TopicContent\\OEmbed",a.Audio="EscolaLms\\TopicTypes\\Models\\TopicContent\\Audio",a.Video="EscolaLms\\TopicTypes\\Models\\TopicContent\\Video",a.H5P="EscolaLms\\TopicTypes\\Models\\TopicContent\\H5P",a.Image="EscolaLms\\TopicTypes\\Models\\TopicContent\\Image",a.PDF="EscolaLms\\TopicTypes\\Models\\TopicContent\\PDF",a.SCORM="EscolaLms\\TopicTypes\\Models\\TopicContent\\ScormSco",a.Project="EscolaLms\\TopicTypeProject\\Models\\Project",a.GiftQuiz="EscolaLms\\TopicTypeGift\\Models\\GiftQuiz"})(g||(g={}));var M;(function(a){a.OrderPaid="EscolaLms\\Cart\\Events\\OrderPaid",a.UserLogged="EscolaLms\\Auth\\Events\\UserLogged"})(M||(M={}));var H;(function(a){a.draft="draft",a.published="published",a.archived="archived"})(H||(H={}));var R;(function(a){a.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",a.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",a.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel"})(R||(R={}));var oe;(function(a){a.ManuallyTriggeredEvent="EscolaLms\\Templates\\Events\\ManuallyTriggeredEvent"})(oe||(oe={}));var k;(function(a){a.cart_fixed="cart_fixed",a.cart_percent="cart_percent",a.product_fixed="product_fixed",a.product_percent="product_percent"})(k||(k={}));var ue;(function(a){a.MULTIPLE_CHOICE="multiple_choice",a.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS="multiple_choice_with_multiple_right_answers",a.TRUE_FALSE="true_false",a.SHORT_ANSWERS="short_answers",a.MATCHING="matching",a.NUMERICAL_QUESTION="numerical_question",a.ESSAY="essay",a.DESCRIPTION="description"})(ue||(ue={}));var Y;(function(a){a.PRESENT="present",a.PRESENT_NOT_EXERCISING="present_not_exercising",a.ABSENT="absent",a.EXCUSED_ABSENCE="excused_absence"})(Y||(Y={}));var de;(function(a){a.Manual="manual",a.TeamsForms="teams_forms",a.TeamsLecture="teams_lecture",a.TestPortal="test_portal"})(de||(de={}));var q;(function(a){a.Simple="simple",a.Complex="complex"})(q||(q={}));var je;(function(a){a.QuizSummary="EscolaLms\\Reports\\Stats\\Topic\\QuizSummaryForTopicTypeGIFT"})(je||(je={}))},"B0O/":function(fe,O,e){"use strict";var g=e("Mwp2"),M=e("VXEj"),H=e("+L6B"),R=e("2/Rp"),oe=e("tU7J"),k=e("wFql"),ue=e("/zsF"),Y=e("PArb"),de=e("T2oS"),q=e("W9HT"),je=e("fOrg"),a=e("+KLJ"),G=e("tJVT"),L=e("q1tI"),v=e("9kvl"),E=e("qLMh"),V=e("k1fw"),ne=e("9og8");function ye(X,U){return te.apply(this,arguments)}function te(){return te=Object(ne.a)(Object(E.a)().mark(function X(U,z){return Object(E.a)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",Object(v.i)("/api/admin/pdfs",Object(V.a)({params:Object(V.a)({},U),method:"GET"},z||{})));case 1:case"end":return C.stop()}},X)})),te.apply(this,arguments)}function f(X,U){return B.apply(this,arguments)}function B(){return B=Object(ne.a)(Object(E.a)().mark(function X(U,z){return Object(E.a)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",Object(v.i)("/api/pdfs/".concat(U),Object(V.a)({method:"GET"},z||{})));case 1:case"end":return C.stop()}},X)})),B.apply(this,arguments)}function o(X,U){return j.apply(this,arguments)}function j(){return j=Object(ne.a)(Object(E.a)().mark(function X(U,z){return Object(E.a)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",Object(v.i)("/api/pdfs/generate/".concat(U),Object(V.a)({method:"GET"},z||{})));case 1:case"end":return C.stop()}},X)})),j.apply(this,arguments)}var y=e("oBTY"),I=e("Iab2"),m=e("xOOu"),x=e.n(m),S=e("nKUr"),Fe=function(U){var z=U.pdfIds,se=U.onProgress,C=U.onFinished,he=U.filename,me=he===void 0?"package.zip":he,ie=Object(L.useState)([]),ae=Object(G.a)(ie,2),pe=ae[0],ge=ae[1],Te=Object(L.useCallback)(function(le){var ce=new x.a;le.forEach(function(K,re){return ce.file("".concat(z[re],".pdf"),K)}),ce.generateAsync({type:"blob"}).then(function(K){Object(I.saveAs)(K,me),C&&C()})},[pe,me]);return Object(L.useEffect)(function(){z.forEach(function(le){var ce=fetch("".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/pdfs/generate/").concat(le),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}});ce.then(function(K){return K.blob()}).then(function(K){K&&K instanceof Blob&&ge(function(re){var Oe=(re.length+1)/z.length;return se&&se(Oe),Oe>=1&&Te([].concat(Object(y.a)(re),[K])),[].concat(Object(y.a)(re),[K])})})})},[z]),Object(S.jsxs)("p",{children:["Progress ",pe.length," / ",z.length]})},xe=Fe,Me=e("Vpfc"),be=e("dF/Y"),u=e("39sE"),t=function(U){var z=U.user_id,se=U.template_id,C=U.title,he=Object(L.useState)({state:"initial"}),me=Object(G.a)(he,2),ie=me[0],ae=me[1],pe=Object(L.useState)({state:"initial"}),ge=Object(G.a)(pe,2),Te=ge[0],le=ge[1],ce=Object(L.useState)(!1),K=Object(G.a)(ce,2),re=K[0],Oe=K[1];Object(L.useEffect)(function(){ae({state:"loading"});var _=new AbortController;return ye({user_id:z,template_id:se},{signal:_.signal}).then(function(N){N&&N.success?ae({state:"loaded",list:N.data}):N&&!N.success&&ae({state:"error",error:N.message})}).catch(function(N){return ae({state:"error",error:N.toString()})}),function(){_.abort()}},[]);var Pe=Object(L.useCallback)(function(_){le({state:"loading"}),f(_).then(function(N){N.success?le({state:"loaded",data:N.data.content}):le({state:"initial"})})},[]);return ie.state==="error"?Object(S.jsx)(a.a,{message:"Error Text",type:"error"}):ie.state==="loading"||ie.state==="initial"?Object(S.jsx)(q.a,{}):Object(S.jsxs)(L.Fragment,{children:[Object(S.jsx)(Y.a,{}),re&&Object(S.jsx)(xe,{pdfIds:ie.list.map(function(_){return _.id}),onFinished:function(){return Oe(!1)}}),Object(S.jsx)(M.b,{size:"small",itemLayout:"horizontal",dataSource:ie.list,header:Object(S.jsxs)("div",{children:[Object(S.jsx)(v.a,{id:"template"})," ",C&&Object(S.jsx)(k.a.Text,{strong:!0,children:C}),". ",Object(S.jsx)(v.a,{id:"generated_pdfs",defaultMessage:"Generated PDFs"})," ",Object(S.jsx)(R.a,{loading:re,type:"primary",onClick:function(){return Oe(!0)},icon:Object(S.jsx)(be.a,{}),size:"small",children:Object(S.jsx)(v.a,{id:"download_all",defaultMessage:"Download all PDFs"})})]}),renderItem:function(N){return Object(S.jsxs)(M.b.Item,{actions:[Object(S.jsx)(u.a,{url:"/api/pdfs/generate/".concat(N.id),filename:"generated-".concat(N.id,".pdf"),size:"small",icon:Object(S.jsx)(be.a,{}),type:"primary",onClick:function(){return Pe(N.id)},loading:Te.state==="loading",children:Object(S.jsx)(v.a,{id:"download_pdf",defaultMessage:"Download PDFs"})},"download")],children:[N.title," ",Object(S.jsx)(Me.a,{type:"App\\Models\\User",type_id:N.user_id})]})}})]})},Ae=O.a=t},BOG6:function(fe,O,e){"use strict";e.r(O);var g=e("DYRE"),M=e("zeV3"),H=e("tU7J"),R=e("wFql"),oe=e("+BJd"),k=e("mr32"),ue=e("/zsF"),Y=e("PArb"),de=e("T2oS"),q=e("W9HT"),je=e("miYZ"),a=e("tsqr"),G=e("qLMh"),L=e("9og8"),v=e("k1fw"),E=e("jrin"),V=e("tJVT"),ne=e("oBTY"),ye=e("fu2T"),te=e("gK9i"),f=e("q1tI"),B=e.n(f),o=e("VMEa"),j=e("Qurx"),y=e("yj/a"),I=e("tneF"),m=e("nhC9"),x=e("rWUb"),S=e("tMyG"),Fe=e("fOrg"),xe=e("+KLJ"),Me=e("+L6B"),be=e("2/Rp"),u=e("9kvl"),t=e("nKUr"),Ae=function(l){var r=l.disabled,n=r===void 0?!1:r,b=l.id,D=l.onPreviewData,P=Object(f.useState)({state:"ready"}),p=Object(V.a)(P,2),d=p[0],i=p[1],c=Object(f.useCallback)(function(){i({state:"loading"}),Object(x.c)(b).then(function(s){s.success?(D&&D(s.data),s.data.sent&&s.data.to?i({state:"loaded",data:s.data,message:"email sent to ".concat(s.data.to)}):s.data.url?i({state:"loaded",data:s.data,message:Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsx)(u.a,{id:"download"})," ",Object(t.jsx)("a",{target:"_blank",href:s.data.url,rel:"noreferrer",children:s.data.filename})]})}):i({state:"loaded",data:s.data,message:s.message})):i({state:"error",error:s.message})}).catch(function(){i({state:"error",error:"error"})})},[b]);return Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsx)(be.a,{type:"primary",loading:d.state==="loading",disabled:n,onClick:c,children:Object(t.jsx)(u.a,{id:"preview"})}),d.state==="loaded"&&Object(t.jsx)(xe.a,{message:d.message,type:"success",closable:!0,onClose:function(){return i({state:"ready"})}}),d.state==="error"&&Object(t.jsx)(xe.a,{message:d.error,type:"error",closable:!0,onClose:function(){return i({state:"ready"})}})]})},X=Ae,U=e("Ty5D"),z=e("BiO0"),se=e("PGov"),C=e("D6/r"),he=e("wbUo"),me=function(l){return Object(t.jsxs)("div",{className:"".concat(l.entity.required&&"required"),children:["@","".concat(l.entity.name)]})},ie=function(l){var r=l.requiredVariables,n=l.variables,b=l.onChange,D=l.value,P=l.error,p=l.styles,d=n.map(function(i){return{name:i.substring(1),required:r.includes(i)}});return Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsx)(se.a,{style:p,className:"ant-input pro-field pro-field-lg rta__textarea_wide ".concat(P.length&&"error"),onChange:function(c){return b(c.target.value)},loadingComponent:function(){return Object(t.jsx)(u.a,{id:"loading"})},minChar:0,value:D,itemStyle:{fontSize:"16px"},trigger:{"@":{dataProvider:function(c){return d.filter(function(s){return s.name.startsWith(c)})},component:me,output:function(c,s){return"".concat(s).concat(c.name)}}}}),Object(t.jsx)("div",{role:"alert",className:"ant-form-item-explain-error",children:P})]})},ae=ie,pe=e("UF3W"),ge=e("bXNp"),Te=e("ctOJ"),le=function(l){switch(l.toLocaleLowerCase()){case"varusername":return"John Doe";case"varcoursetitle":return"How to be an LMS Expert";case"varappname":return"Wellms Headless LMS";default:return"Lorem Ipsum"}},ce=function(l,r,n){var b=Math.max.apply(null,l.parameters?[l.parameters.map(function(p){return p.id}),l.docElements.map(function(p){return p.id})].flat():[1])+1,D=l.parameters?l.parameters.reduce(function(p,d){return Object(v.a)(Object(v.a)({},p),{},Object(E.a)({},d.name,d))},{}):{},P=r.map(function(p){return p.replace("@","")}).reduce(function(p,d,i){return p[d]?Object(v.a)(Object(v.a)({},p),{},Object(E.a)({},d,Object(v.a)(Object(v.a)({},p[d]),{},{id:b+i}))):Object(v.a)(Object(v.a)({},p),{},Object(E.a)({},d,{id:b+i,name:d,type:"string",arrayItemType:"string",eval:!1,nullable:!n.includes(d),pattern:"",expression:"",showOnlyNameType:!1,testData:le(d)}))},D);return Object.assign({},l,{parameters:Object.values(P)})},K=function(l){var r=l.onTemplateSaved,n=l.reportBroTemplate,b=n===void 0?null:n,D=l.field,P=l.variables,p=l.onTemplateUpdated,d=Object(f.useRef)(null),i=function(s){var F=s.nativeEvent.target.tagName.toLowerCase();switch(F){case"span":case"button":s.nativeEvent.stopPropagation(),s.nativeEvent.preventDefault();default:return}};return Object(f.useEffect)(function(){if(d.current){var c=new pe.ReportBro(d.current,{enableSpreadsheet:!1,fonts:[{name:"Open Sans",value:"Open Sans"}],defaultFont:"Open Sans",reportServerUrl:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/pdfs/reportbro/report/run"),saveCallback:function(){r(c.getReport())},cmdExecutedCallback:function(){p&&p(c.getReport())}});b&&c.load(ce(b,P,D.required_variables))}},[d]),Object(t.jsx)("div",{ref:d,className:"pdf-editor",onClick:i,children:"pdf editor"})},re=K,Oe=e("JAl+"),Pe=function(l){var r=l.name,n=l.field,b=l.variables,D=b===void 0?[]:b,P=Object(f.useCallback)(function(i){if(i.length)return Object(t.jsx)(M.b,{children:Object(t.jsxs)(R.a,{children:[Object(t.jsx)(u.a,{id:"templates.required_variables"}),":"," ",i.map(function(c){return Object(t.jsx)(k.a,{color:"red",children:c},c)})]})})},[n,r]),p=Object(f.useCallback)(function(i,c){return i&&c.every(function(s){return i.includes(s)})?Promise.resolve():Promise.reject(new Error("No required variable used"))},[n,r]),d=Object(f.useCallback)(function(){if(!n.readonly)switch(n.type){case"text":case"url":return Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsx)("label",{children:Object(t.jsx)(u.a,{id:r})}),Object(t.jsx)(o.a.Item,{shouldUpdate:!0,children:function(c){return Object(t.jsx)(ae,{requiredVariables:n.required_variables,variables:D,value:c.getFieldValue(r),onChange:function(F){return c.setFieldsValue(Object(E.a)({},r,F))},error:c.getFieldError(r),styles:{width:"100%",height:"100px"}})}}),Object(t.jsx)(j.a,{name:r,shouldUpdate:!0,hidden:!0,rules:n.readonly?void 0:[{required:n.required,message:Object(t.jsx)(u.a,{id:"templates.this_required"})},{validator:function(){var i=Object(L.a)(Object(G.a)().mark(function s(F,T){return Object(G.a)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",p(T,n.required_variables));case 1:case"end":return w.stop()}},s)}));function c(s,F){return i.apply(this,arguments)}return c}()}]}),P(n.required_variables)]});case"fabric.js":return Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsx)(o.a.Item,{shouldUpdate:!0,children:function(c){return Object(t.jsx)(re,{reportBroTemplate:c.getFieldValue(r)&&JSON.parse(c.getFieldValue(r)),variables:D,field:n,onTemplateSaved:function(F){c.setFieldsValue(Object(E.a)({},r,JSON.stringify(F))),c.submit()},onTemplateUpdated:function(F){c.setFieldsValue(Object(E.a)({},r,JSON.stringify(F)))}})}}),Object(t.jsx)(z.a,{name:r,shouldUpdate:!0,width:"lg",hidden:!0})]});case"html":return Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsx)(z.a,{readonly:n.readonly,shouldUpdate:!0,width:"lg",label:Object(t.jsx)(u.a,{id:r}),name:r,tooltip:Object(t.jsx)(u.a,{id:"templates.html_tooltip"}),rules:n.readonly?void 0:[{required:n.required,message:Object(t.jsx)(u.a,{id:"templates.this_required"})},{validator:function(){var i=Object(L.a)(Object(G.a)().mark(function s(F,T){return Object(G.a)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",p(T,n.required_variables));case 1:case"end":return w.stop()}},s)}));function c(s,F){return i.apply(this,arguments)}return c}()}]}),P(n.required_variables)]});case"mjml":return Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsxs)("p",{children:[Object(t.jsx)(u.a,{id:"templates.to_create_template"})," ",Object(t.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://mjml.io/try-it-live",children:"https://mjml.io/try-it-live"})]}),Object(t.jsx)("code",{children:Object(t.jsx)(u.a,{id:"code.snippet"})}),Object(t.jsx)(o.a.Item,{shouldUpdate:!0,children:function(c){return Object(t.jsx)(ae,{requiredVariables:n.required_variables,variables:D,value:c.getFieldValue(r),onChange:function(F){return c.setFieldsValue(Object(E.a)({},r,F))},error:c.getFieldError(r),styles:{width:"100%",height:"40vh"}})}}),Object(t.jsx)(z.a,{name:r,shouldUpdate:!0,hidden:!0,rules:n.readonly?void 0:[{required:n.required,message:Object(t.jsx)(u.a,{id:"templates.this_required"})},{validator:function(){var i=Object(L.a)(Object(G.a)().mark(function s(F,T){return Object(G.a)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",p(T,n.required_variables));case 1:case"end":return w.stop()}},s)}));function c(s,F){return i.apply(this,arguments)}return c}()}]}),P(n.required_variables)]});default:return}},[n,r,D]);return Object(t.jsx)(B.a.Fragment,{children:d()})},_=Pe,N=e("B0O/"),Ee=e("/y+f"),rt=e("5Dmo"),Le=e("3S7+"),Be=e("0WSk"),$e=function(l){var r=l.templateId,n=Object(f.useState)(!1),b=Object(V.a)(n,2),D=b[0],P=b[1],p=Object(f.useState)([]),d=Object(V.a)(p,2),i=d[0],c=d[1],s=Object(u.l)(),F=Object(f.useCallback)(function(){P(!0),Object(x.f)(Number(r),i).then(function(T){T.success?a.b.success(T.message):a.b.error(T.message)}).catch(function(T){return a.b.error(T.toString())}).finally(function(){return P(!1)})},[i,r]);return Object(t.jsxs)(M.b,{children:[Object(t.jsx)(Be.a,{multiple:!0,value:i,onChange:function($){return c($)}}),Object(t.jsx)(Le.a,{title:s.formatMessage({id:"generate_pdf_users_tooltip"}),children:Object(t.jsx)(be.a,{loading:D,onClick:function(){return F()},disabled:!i.length,children:Object(t.jsx)(u.a,{id:"generate"})})})]})},Ge=$e,ze=e("qSko"),we=function(l){var r=l.templateId,n=Object(f.useState)(!1),b=Object(V.a)(n,2),D=b[0],P=b[1],p=Object(f.useState)(),d=Object(V.a)(p,2),i=d[0],c=d[1],s=Object(u.l)(),F=Object(f.useCallback)(function(){P(!0),typeof i=="number"&&Object(x.g)(Number(r),Number(i)).then(function(T){T.success?a.b.success(T.message):a.b.error(T.message)}).catch(function(T){return a.b.error(T.toString())}).finally(function(){return P(!1)})},[i,r]);return Object(t.jsxs)(M.b,{children:[Object(t.jsx)(ze.a,{multiple:!1,value:i,onChange:function($){return c($)}}),Object(t.jsx)(Le.a,{title:s.formatMessage({id:"generate_pdf_products_tooltip"}),children:Object(t.jsx)(be.a,{loading:D,onClick:function(){return F()},disabled:!i,children:Object(t.jsx)(u.a,{id:"generate"})})})]})},Je=we,Ke=te.a.Panel,We=function(l){return Object.entries(l).map(function(r){return{key:r[0],content:r[1]}})},Ie=function(l){return Object.assign.apply(Object,[{}].concat(Object(ne.a)(l)))},He=function(l){var r=["name","event","default"];return Object.keys(l).filter(function(n){return!r.includes(n)}).reduce(function(n,b){return n[b]=l[b],n},{})},Se=Ee.e,nt=O.default=function(){var W=Object(u.l)(),l=Object(U.l)(),r=l.template,n=l.id,b=n==="new",D=Object(f.useState)(!1),P=Object(V.a)(D,2),p=P[0],d=P[1],i=o.a.useForm(),c=Object(V.a)(i,1),s=c[0],F=Object(f.useState)(),T=Object(V.a)(F,2),$=T[0],w=T[1],Ye=Object(f.useState)(void 0),Ue=Object(V.a)(Ye,2),Z=Ue[0],Xe=Ue[1],Ze=Object(f.useState)(),Ne=Object(V.a)(Ze,2),Qe=Ne[0],ke=Ne[1],qe=Object(f.useState)(!1),De=Object(V.a)(qe,2),Re=De[0],_e=De[1];Object(f.useEffect)(function(){Object(x.i)().then(function(A){w(A.success?A.data:{})})},[]),Object(f.useEffect)(function(){var A=s.getFieldsValue(),h=Z&&Object.keys(Z.sections).map(function(J){return Object(E.a)({},J,Z.sections[J].default_content)});h&&b&&s.setFieldsValue(Object(v.a)(Object(v.a)({},A),Ie(h)))},[Z]);var Ve=Object(f.useCallback)(function(A){if(A&&r){var h=$&&$[A][Se[r]];Xe(h)}_e(A===Ee.f.ManuallyTriggeredEvent)},[$,n]),et=Object(f.useCallback)(Object(L.a)(Object(G.a)().mark(function A(){var h,J,ee;return Object(G.a)().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return ve.next=2,Object(x.d)(Number(n));case 2:h=ve.sent,h.success&&(J=h.data.sections&&h.data.sections.map(function(Q){return Object(E.a)({},Q.key,Q.content)}),ee=J&&Ie(J),s.setFieldsValue(Object(v.a)(Object(v.a)({},h.data),ee)),Ve(String(h.data.event)),d(!0));case 4:case"end":return ve.stop()}},A)})),[n,$]),tt=Object(f.useCallback)(function(){var A=Object(L.a)(Object(G.a)().mark(function h(J){var ee,Ce;return Object(G.a)().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:if(Ce=Object(v.a)(Object(v.a)({},J),{},{channel:Se[r],sections:We(He(J))}),!b){Q.next=8;break}return Q.next=4,Object(x.a)(Ce);case 4:ee=Q.sent,ee.success&&u.f.push("/configuration/templates/".concat(r,"/").concat(ee.data.id)),Q.next=11;break;case 8:return Q.next=10,Object(x.h)(Number(n),Ce);case 10:ee=Q.sent;case 11:d(!0),a.b.success(ee.message);case 13:case"end":return Q.stop()}},h)}));return function(h){return A.apply(this,arguments)}}(),[$,n]);Object(f.useEffect)(function(){b||et()},[n,$]);var at=Object(f.useCallback)(function(A){return $?Object.keys($).reduce(function(h,J){return $[J][A]?Object(v.a)(Object(v.a)({},h),{},Object(E.a)({},J,W.formatMessage({id:J,defaultMessage:J}))):h},{}):{}},[$]);return Object(t.jsxs)(S.a,{title:b?Object(t.jsxs)("span",{children:[Object(t.jsx)(u.a,{id:"new"})," ",r," ",Object(t.jsx)(u.a,{id:"template"})]}):Object(t.jsxs)("span",{children:[Object(t.jsx)(u.a,{id:"edit"})," ",r," ",Object(t.jsx)(u.a,{id:"template"})]}),children:[Object(t.jsx)(m.a,{size:"small",children:Object(t.jsxs)(o.a,{initialValues:{},onFinish:tt,form:s,onValuesChange:function(){var h=s.getFieldsValue();Ve(h.event),d(!1)},children:[Object(t.jsxs)(o.a.Group,{children:[Object(t.jsx)(j.a,{width:"sm",name:"name",label:Object(t.jsx)(u.a,{id:"name"}),placeholder:W.formatMessage({id:"name"}),rules:[{required:!0,message:Object(t.jsx)(u.a,{id:"select"})}]}),Object(t.jsx)(y.a,{name:"event",width:"lg",label:Object(t.jsx)(u.a,{id:"event"}),valueEnum:$?at(Se[r]):{},placeholder:W.formatMessage({id:"event"}),rules:[{required:!0,message:Object(t.jsx)(u.a,{id:"select"})}]}),Object(t.jsx)(o.a.Item,{label:Object(t.jsx)(u.a,{id:"templates.set_as_default_template"}),children:Object(t.jsx)(I.a,{name:"default"})})]}),!b&&r!=="pdf"&&Object(t.jsxs)(o.a.Group,{children:[Object(t.jsx)(o.a.Item,{label:Object(t.jsx)(u.a,{id:"preview"}),children:Object(t.jsx)(X,{disabled:!p,id:Number(n),type:r,onPreviewData:function(h){h&&h.data&&h.data.content&&ke(h.data.content)}})}),Re&&Object(t.jsx)(o.a.Item,{label:Object(t.jsx)(u.a,{id:"generate_pdf"}),tooltip:Object(t.jsx)(u.a,{id:"generate_pdf_tooltip"}),children:Object(t.jsx)(Ge,{templateId:Number(n)})}),Re&&Object(t.jsx)(o.a.Item,{label:Object(t.jsx)(u.a,{id:"generate_pdf"}),tooltip:Object(t.jsx)(u.a,{id:"generate_pdf_tooltip"}),children:Object(t.jsx)(Je,{templateId:Number(n)})})]}),Se[r]===Ee.e.pdf&&!b&&Object(t.jsx)(te.a,{ghost:!0,destroyInactivePanel:!0,defaultActiveKey:[-1],children:Object(t.jsx)(Ke,{header:Object(t.jsx)(u.a,{id:"generated_pdfs"}),children:Object(t.jsx)(N.a,{template_id:Number(n)})},0)}),!Z&&!b?Object(t.jsx)(q.a,{}):Z&&Z.sections&&Object.keys(Z.sections).map(function(A,h){var J=Z.sections&&Z.sections[A];return Object(t.jsxs)(B.a.Fragment,{children:[h===0&&r!=="pdf"&&Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsx)(Y.a,{children:Object(t.jsx)(u.a,{id:"templates.tokens"})}),Object(t.jsx)(M.b,{children:Object(t.jsx)(R.a,{children:Z.variables.map(function(ee){return Object(t.jsx)(k.a,{color:"orange",children:ee},ee)})})})]}),Object(t.jsx)(Y.a,{}),Object(t.jsx)(_,{name:A,field:J,variables:Z.variables})]},A)}),Object(t.jsx)(Y.a,{})]})}),Qe&&Object(t.jsx)("p",{children:"fabric preview"})]})}},"JAl+":function(fe,O,e){},ctOJ:function(fe,O,e){},rWUb:function(fe,O,e){"use strict";e.d(O,"e",function(){return oe}),e.d(O,"d",function(){return ue}),e.d(O,"a",function(){return de}),e.d(O,"h",function(){return je}),e.d(O,"b",function(){return G}),e.d(O,"i",function(){return v}),e.d(O,"c",function(){return V}),e.d(O,"f",function(){return ye}),e.d(O,"g",function(){return f});var g=e("qLMh"),M=e("k1fw"),H=e("9og8"),R=e("9kvl");function oe(o,j){return k.apply(this,arguments)}function k(){return k=Object(H.a)(Object(g.a)().mark(function o(j,y){return Object(g.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(R.i)("/api/admin/templates",Object(M.a)({method:"GET",useCache:!1,params:j},y||{})));case 1:case"end":return m.stop()}},o)})),k.apply(this,arguments)}function ue(o,j){return Y.apply(this,arguments)}function Y(){return Y=Object(H.a)(Object(g.a)().mark(function o(j,y){return Object(g.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(R.i)("/api/admin/templates/".concat(j),Object(M.a)({method:"GET"},y||{})));case 1:case"end":return m.stop()}},o)})),Y.apply(this,arguments)}function de(o,j){return q.apply(this,arguments)}function q(){return q=Object(H.a)(Object(g.a)().mark(function o(j,y){return Object(g.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(R.i)("/api/admin/templates",Object(M.a)({method:"POST",headers:{"Content-Type":"application/json"},data:j},y||{})));case 1:case"end":return m.stop()}},o)})),q.apply(this,arguments)}function je(o,j,y){return a.apply(this,arguments)}function a(){return a=Object(H.a)(Object(g.a)().mark(function o(j,y,I){return Object(g.a)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",Object(R.i)("/api/admin/templates/".concat(j),Object(M.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:y},I||{})));case 1:case"end":return x.stop()}},o)})),a.apply(this,arguments)}function G(o,j){return L.apply(this,arguments)}function L(){return L=Object(H.a)(Object(g.a)().mark(function o(j,y){return Object(g.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(R.i)("/api/admin/templates/".concat(j),Object(M.a)({method:"DELETE",headers:{"Content-Type":"application/json"}},y||{})));case 1:case"end":return m.stop()}},o)})),L.apply(this,arguments)}function v(o){return E.apply(this,arguments)}function E(){return E=Object(H.a)(Object(g.a)().mark(function o(j){return Object(g.a)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.abrupt("return",Object(R.i)("/api/admin/templates/variables",Object(M.a)({method:"GET"},j||{})));case 1:case"end":return I.stop()}},o)})),E.apply(this,arguments)}function V(o,j){return ne.apply(this,arguments)}function ne(){return ne=Object(H.a)(Object(g.a)().mark(function o(j,y){return Object(g.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(R.i)("/api/admin/templates/".concat(j,"/preview"),Object(M.a)({method:"GET"},y||{})));case 1:case"end":return m.stop()}},o)})),ne.apply(this,arguments)}function ye(o,j,y){return te.apply(this,arguments)}function te(){return te=Object(H.a)(Object(g.a)().mark(function o(j,y,I){return Object(g.a)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",Object(R.i)("/api/admin/events/trigger-manually/".concat(j),Object(M.a)({method:"POST",headers:{"Content-Type":"application/json"},data:{users:y}},I||{})));case 1:case"end":return x.stop()}},o)})),te.apply(this,arguments)}function f(o,j,y){return B.apply(this,arguments)}function B(){return B=Object(H.a)(Object(g.a)().mark(function o(j,y,I){return Object(g.a)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",Object(R.i)("/api/admin/products/".concat(y,"/trigger-event-manually/").concat(j),Object(M.a)({method:"POST",headers:{"Content-Type":"application/json"}},I||{})));case 1:case"end":return x.stop()}},o)})),B.apply(this,arguments)}},wbUo:function(fe,O,e){}}]);

//# sourceMappingURL=p__Templates__form.2386fe8f.async.js.map