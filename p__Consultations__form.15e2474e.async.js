(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"4f6N":function(q,h,t){"use strict";var j=t("2qtc"),b=t("kLXV"),E=t("9kvl"),g=t("nKUr"),V=t.n(g),B=function(S){var R=S.visible,A=S.setManage;return Object(g.jsx)(b.a,{width:"600px",title:Object(g.jsx)(E.a,{id:"course.validate_edit.header",defaultMessage:"course.validate_edit.header"}),visible:R,onOk:function(){return A({showModal:!1,disableEdit:!1,clicked:!0})},onCancel:function(){return A({showModal:!1,disableEdit:!0,clicked:!1})},okText:"OK",cancelText:"Cancel",children:Object(g.jsx)("p",{children:Object(g.jsx)(E.a,{id:"course.validate_edit.content",defaultMessage:"course.validate_edit.content"})})})};h.a=B},GZq3:function(q,h,t){},Gb5Y:function(q,h,t){"use strict";t.d(h,"b",function(){return V}),t.d(h,"c",function(){return G}),t.d(h,"e",function(){return R}),t.d(h,"g",function(){return k}),t.d(h,"d",function(){return $}),t.d(h,"f",function(){return ee}),t.d(h,"a",function(){return m});var j=t("x+uP"),b=t("VTBJ"),E=t("HaE+"),g=t("9kvl");function V(r,i){return B.apply(this,arguments)}function B(){return B=Object(E.a)(Object(j.a)().mark(function r(i,P){return Object(j.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(g.f)("/api/admin/consultations",Object(b.a)({method:"GET",useCache:!1,params:Object(b.a)(Object(b.a)({},i),{},{per_page:i&&i.pageSize,page:i&&i.current})},P||{})));case 1:case"end":return n.stop()}},r)})),B.apply(this,arguments)}function G(r,i){return S.apply(this,arguments)}function S(){return S=Object(E.a)(Object(j.a)().mark(function r(i,P){return Object(j.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(g.f)("/api/admin/consultations",Object(b.a)({method:"POST",headers:{"Content-Type":"application/json"},data:i},P||{})));case 1:case"end":return n.stop()}},r)})),S.apply(this,arguments)}function R(r,i){return A.apply(this,arguments)}function A(){return A=Object(E.a)(Object(j.a)().mark(function r(i,P){return Object(j.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(g.f)("/api/admin/consultations/".concat(i),Object(b.a)({method:"GET",useCache:!1},P||{})));case 1:case"end":return n.stop()}},r)})),A.apply(this,arguments)}function k(r,i,P){return O.apply(this,arguments)}function O(){return O=Object(E.a)(Object(j.a)().mark(function r(i,P,L){return Object(j.a)().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.abrupt("return",Object(g.f)("/api/admin/consultations/".concat(i),Object(b.a)({method:"PUT",headers:{"Content-Type":"application/json"},data:P},L||{})));case 1:case"end":return W.stop()}},r)})),O.apply(this,arguments)}function $(r,i){return d.apply(this,arguments)}function d(){return d=Object(E.a)(Object(j.a)().mark(function r(i,P){return Object(j.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(g.f)("/api/admin/consultations/".concat(i),Object(b.a)({method:"DELETE",useCache:!1},P||{})));case 1:case"end":return n.stop()}},r)})),d.apply(this,arguments)}function ee(r,i){return U.apply(this,arguments)}function U(){return U=Object(E.a)(Object(j.a)().mark(function r(i,P){return Object(j.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(g.f)("/api/admin/consultations/".concat(i,"/schedule"),Object(b.a)({method:"GET",useCache:!1},P||{})));case 1:case"end":return n.stop()}},r)})),U.apply(this,arguments)}function m(r,i,P){return Z.apply(this,arguments)}function Z(){return Z=Object(E.a)(Object(j.a)().mark(function r(i,P,L){return Object(j.a)().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.abrupt("return",Object(g.f)("/api/admin/consultations/change-term/".concat(i),Object(b.a)({method:"POST",headers:{"Content-Type":"application/json"},data:{executed_at:P}},L||{})));case 1:case"end":return W.stop()}},r)})),Z.apply(this,arguments)}},"J+hL":function(q,h,t){},VlvL:function(q,h,t){"use strict";var j=t("9kvl"),b=t("Ty5D"),E=t("nKUr"),g=t.n(E),V=function(G){var S=G.show,R=Object(j.i)();return Object(E.jsx)(b.b,{when:S,message:R.formatMessage({id:"unsaved_changes"})})};h.a=V},eFHa:function(q,h,t){"use strict";t.d(h,"a",function(){return V});var j=t("ODXe"),b=t("q1tI"),E=t.n(b),g=t("HZtn");function V(){var B=Object(b.useState)({showModal:!1,disableEdit:!1,clicked:!1}),G=Object(j.a)(B,2),S=G[0],R=G[1],A=function(O){(O==null?void 0:O.status)==="published"&&O!==null&&O!==void 0&&O.active_from&&Object(g.a)(new Date(O==null?void 0:O.active_from))&&!S.clicked?R({showModal:!1,disableEdit:!0,clicked:!1}):R({showModal:!1,disableEdit:!1,clicked:!1})};return{manageCourseEdit:S,setManageCourseEdit:R,validateCourseEdit:A}}},q34N:function(q,h,t){"use strict";var j=t("ODXe"),b=t("0eZe"),E=t("q1tI"),g=t.n(E),V=t("nKUr"),B=t.n(V),G=function(R){var A=R.productable,k=R.type,O=k===void 0?"card":k,$=Object(E.useState)("attributes"),d=Object(j.a)($,2),ee=d[0],U=d[1];return Object(V.jsx)(b.a,{productable:A,tab:ee,onTabChange:function(Z){return U(Z)},type:O})};h.a=G},rh3J:function(q,h,t){"use strict";t.r(h);var j=t("14J3"),b=t("BMrR"),E=t("jCWc"),g=t("kPKH"),V=t("fOrg"),B=t("+KLJ"),G=t("+L6B"),S=t("2/Rp"),R=t("T2oS"),A=t("W9HT"),k=t("miYZ"),O=t("tsqr"),$=t("x+uP"),d=t("VTBJ"),ee=t("HaE+"),U=t("ODXe"),m=t("q1tI"),Z=t.n(m),r=t("VMEa"),i=t("Qurx"),P=t("yj/a"),L=t("lR9U"),n=t("nhC9"),W=t("hd5d"),me=t("tMyG"),a=t("9kvl"),fe=t("Ty5D"),ve=t("0WSk"),he=t("TWax"),ne=t("Gb5Y"),Fe=t("OaEy"),ge=t("2fM7"),Ne=t("iQDF"),le=t("+eQT"),He=t("+BJd"),pe=t("mr32"),xe=t("KQm4"),Ce=t("wd/R"),te=t.n(Ce),Ve=t("GZq3"),e=t("nKUr"),ce=function(l){return l.local().valueOf()},Ee=function(l){var f=l.value,s=f===void 0?[]:f,D=l.onChange,p=l.format,T=p===void 0?"DD-MM-YYYY HH:mm":p,X=l.selectProps,z=X===void 0?{}:X,N=Object(m.useState)(!1),K=Object(U.a)(N,2),ae=K[0],J=K[1],u=Object(m.useCallback)(function(v){var y=ce(v),x=s.indexOf(y),I=Object(xe.a)(s);x>-1?I.splice(x,1):I.push(y),D(I)},[s]),c=Object(m.useCallback)(function(v){var y=s.indexOf(ce(v))>-1;return Object(e.jsx)("div",{className:"ant-picker-cell-inner",style:y?{position:"relative",zIndex:2,display:"inlineBlock",width:"24px",height:"22px",lineHeight:"22px",backgroundColor:"#1890ff",color:"#fff",margin:"auto",borderRadius:"2px",transition:"background 0.3s, border 0.3s"}:{},children:v.date()})},[s]),M=Object(m.useCallback)(function(v){var y=v.value,x=v.onClose,I=function(){x(),D(s.filter(function(oe){return oe!==y}))};return Object(e.jsx)(pe.a,{onClose:I,closable:!0,children:te()(y).format(T)})},[s]),o=function(){return{disabledMinutes:function(){return Array.from({length:59},function(x,I){return I+1})}}};return Object(e.jsx)(ge.a,Object(d.a)(Object(d.a)({},z),{},{allowClear:!0,mode:"multiple",value:s,onClear:function(){return D&&D([])},tagRender:M,open:ae,onFocus:function(){return J(!0)},onBlur:function(){return J(!1)},dropdownMatchSelectWidth:!1,dropdownClassName:"multipleDropdownClassName",dropdownStyle:{height:"310px",width:"335px",minWidth:"0"},dropdownRender:function(){return Object(e.jsx)(le.a,{disabledDate:function(x){var I=new Date;return x&&x.valueOf()<=I.setDate(I.getDate()-1)},showTime:{format:"HH"},disabledTime:o,onChange:function(x){return x&&u(x)},open:!0,dateRender:c,style:{visibility:"hidden"},getPopupContainer:function(x){var I=x.parentNode;return I},defaultValue:te()("00:00","HH")})}}))},Me=Ee,re=t("c+yx"),de=t("Gn8c"),ye=t("VlvL"),ie;(function(F){F.draft="draft",F.published="published",F.archived="archived"})(ie||(ie={}));var Pe=t("eFHa"),De=t("4f6N"),Ge=t("qbNl"),Te=t("JBPa"),$e=t("5Dmo"),Se=t("3S7+"),Je=t("Awhp"),ue=t("KrTs"),Ae=t("Qiat"),Ue=function(l){var f=l.data,s=l.onChange,D=Object(m.useState)(!1),p=Object(U.a)(D,2),T=p[0],X=p[1],z=Object(m.useState)(te()(f.date)),N=Object(U.a)(z,2),K=N[0],ae=N[1],J=Object(m.useCallback)(function(u){ae(te()(u)),X(!0),Object(ne.a)(f.consultation_term_id,u).then(function(c){c.success?(O.default.success(c.message),s(K)):O.default.error(c.message)}).catch(function(c){return O.default.error(c.toString())}).finally(function(){return X(!1)})},[K]);return Object(e.jsx)(Z.a.Fragment,{children:Object(e.jsx)(le.a,{disabledDate:function(c){var M=new Date;return c&&c.valueOf()<=M.setDate(M.getDate()-1)},disabled:T,value:K,showTime:{format:"HH"},onChange:function(c){c&&J(c.toISOString())}})})},je={reported:"warning",reject:"error",approved:"success"},Ie=[{title:Object(e.jsx)(a.a,{id:"id",defaultMessage:"id"}),dataIndex:"consultation_term_id",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"user",defaultMessage:"user"}),dataIndex:"user",render:function(l,f){var s,D,p;return"".concat((s=f.user)===null||s===void 0?void 0:s.first_name," ").concat((D=f.user)===null||D===void 0?void 0:D.last_name," ").concat((p=f.user)===null||p===void 0?void 0:p.email)}},{title:Object(e.jsx)(a.a,{id:"date",defaultMessage:"date"}),dataIndex:"date",render:function(l,f){return te()(f.date).format("yyyy-MM-DD HH:mm")}},{title:Object(e.jsx)(a.a,{id:"status",defaultMessage:"status"}),dataIndex:"status",render:function(l,f){return Object(e.jsx)(ue.a,{status:je[f.status],text:Object(e.jsx)(a.a,{id:f.status})})}}],Re=function(l){var f=l.consultation,s=Object(m.useState)(!1),D=Object(U.a)(s,2),p=D[0],T=D[1],X=Object(m.useState)([]),z=Object(U.a)(X,2),N=z[0],K=z[1],ae=Object(a.i)(),J=Object(m.useCallback)(function(){T(!0),Object(ne.f)(f).then(function(c){c.success&&K(c.data)}).catch(function(){O.default.error(Object(e.jsx)(a.a,{id:"error",defaultMessage:"error"}))}).finally(function(){return T(!1)})},[f]);Object(m.useEffect)(function(){J()},[f]);var u=Object(m.useCallback)(function(c){return Object(e.jsx)("ul",{className:"events",children:N.map(function(M){if(c.format("yyyy-MM-DD")===te()(M.date).format("yyyy-MM-DD")){var o,v,y,x;return Object(e.jsx)("li",{children:Object(e.jsx)(ue.a,{status:je[M.status],text:Object(e.jsx)(Z.a.Fragment,{children:Object(e.jsxs)(Se.a,{title:"".concat((o=M.user)===null||o===void 0?void 0:o.first_name," ").concat((v=M.user)===null||v===void 0?void 0:v.last_name," ").concat((y=M.user)===null||y===void 0?void 0:y.email),children:[Object(e.jsx)("small",{children:te()(M.date).format("HH:mm")})," ",(x=M.user)===null||x===void 0?void 0:x.email]})})})})}return null})})},[N]);return Object(e.jsxs)(Z.a.Fragment,{children:[p&&Object(e.jsx)(A.a,{}),Object(e.jsx)(Te.a,{dateCellRender:u}),p?Object(e.jsx)(A.a,{}):Object(e.jsx)(Ae.a,{headerTitle:ae.formatMessage({id:"Consultations",defaultMessage:"Consultations"}),loading:p,rowKey:"consultation_term_id",search:!1,request:Object(ee.a)(Object($.a)().mark(function c(){return Object($.a)().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",{data:N,total:N.length,success:!0});case 1:case"end":return o.stop()}},c)})),columns:[].concat(Ie,[{title:Object(e.jsx)(a.a,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",width:"20%",render:function(M,o){return[Object(e.jsx)(Ue,{data:o,onChange:function(){return J()}})]}}])})]})},Ke=Re,Ye=t("J+hL"),Be=t("q34N"),Le=t("5RzD"),We=function(){var l=Object(a.i)(),f=Object(fe.l)(),s=f.consultation,D=f.tab,p=D===void 0?"attributes":D,T=s==="new",X=Object(m.useState)(!1),z=Object(U.a)(X,2),N=z[0],K=z[1],ae=Object(m.useState)(),J=Object(U.a)(ae,2),u=J[0],c=J[1],M=Object(Pe.a)(),o=M.manageCourseEdit,v=M.setManageCourseEdit,y=M.validateCourseEdit,x=r.a.useForm(),I=Object(U.a)(x,1),be=I[0],oe=Object(m.useCallback)(Object(ee.a)(Object($.a)().mark(function Y(){var C,Q;return Object($.a)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,Object(ne.e)(Number(s));case 2:C=w.sent,C.success&&(p==="attributes"&&y(C.data),c(Object(d.a)(Object(d.a)({},C.data),{},{author_id:C.data.author&&C.data.author.id,categories:(Q=C.data.categories)===null||Q===void 0?void 0:Q.map(re.a)})));case 4:case"end":return w.stop()}},Y)})),[s]);Object(m.useEffect)(function(){if(T){c({name:"new"});return}oe()},[s]);var se=Object(m.useMemo)(function(){return{onFinish:function(){var Y=Object(ee.a)(Object($.a)().mark(function Q(Oe){var w,_;return Object($.a)().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!o.disableEdit){H.next=3;break}return v({showModal:!0,disableEdit:!0,clicked:!1}),H.abrupt("return");case 3:if(w=Object(d.a)(Object(d.a)({},Oe),{},{image_url:u&&u.image_url,image_path:u&&u.image_url&&Object(re.e)(u.image_url),logotype_url:u&&u.logotype_url,logotype_path:u&&u.logotype_path&&Object(re.e)(u.logotype_path)}),!T){H.next=11;break}return H.next=7,Object(ne.c)(w);case 7:_=H.sent,_.success&&(K(!1),a.d.push("/consultations/".concat(_.data.id))),H.next=15;break;case 11:return H.next=13,Object(ne.g)(Number(s),w);case 13:_=H.sent,_.success&&(K(!1),y(_.data),a.d.push("/consultations/".concat(_.data.id,"/").concat(p)));case 15:O.default.success(_.message);case 16:case"end":return H.stop()}},Q)}));function C(Q){return Y.apply(this,arguments)}return C}(),initialValues:u}},[u,s,p,o]);return u?Object(e.jsx)(me.a,{title:T?Object(e.jsx)(a.a,{id:"consultation"}):Object(e.jsx)(a.a,{id:"consultations.edit"}),header:{breadcrumb:{routes:[{path:"consultations",breadcrumbName:l.formatMessage({id:"menu.Consultations"})},{path:String(s),breadcrumbName:l.formatMessage({id:"form"})},{path:"/",breadcrumbName:String(u.name)},{path:String(p),breadcrumbName:String(u.name)}]}},children:Object(e.jsxs)(n.a,{tabs:{type:"card",activeKey:p,onChange:function(C){return a.d.push("/consultations/".concat(s,"/").concat(C))}},children:[Object(e.jsxs)(n.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"attributes"}),children:[o.disableEdit&&Object(e.jsx)(B.a,{closable:!0,style:{marginBottom:"20px"},type:"warning",message:Object(e.jsx)(a.a,{id:"course_edit_warning_message",defaultMessage:"course_edit_warning_message"}),action:Object(e.jsx)(S.a,{onClick:function(){return v({showModal:!0,disableEdit:!0,clicked:!0})},type:"primary",children:Object(e.jsx)(a.a,{id:"questionnaire.submit",defaultMessage:"questionnaire.submit"})})}),Object(e.jsx)(ye.a,{show:N})," ",Object(e.jsx)(De.a,{visible:o.showModal,setManage:v}),Object(e.jsxs)(r.a,Object(d.a)(Object(d.a)({},se),{},{form:be,onValuesChange:function(){K(!0)},children:[Object(e.jsxs)(r.a.Group,{children:[Object(e.jsx)(i.a,{width:"md",name:"name",label:Object(e.jsx)(a.a,{id:"name"}),tooltip:Object(e.jsx)(a.a,{id:"name"}),placeholder:l.formatMessage({id:"name",defaultMessage:"name"}),required:!0,disabled:o.disableEdit}),Object(e.jsx)(i.a,{width:"sm",name:"duration",label:Object(e.jsx)(a.a,{id:"duration"}),tooltip:Object(e.jsx)(a.a,{id:"duration"}),placeholder:l.formatMessage({id:"duration",defaultMessage:"duration"}),disabled:o.disableEdit}),Object(e.jsx)(P.a,{name:"status",width:"sm",label:Object(e.jsx)(a.a,{id:"status"}),tooltip:Object(e.jsx)(a.a,{id:"status_consultation_tooltip"}),valueEnum:{draft:l.formatMessage({id:"draft",defaultMessage:"draft"}),published:l.formatMessage({id:"published",defaultMessage:"published"}),archived:l.formatMessage({id:"archived",defaultMessage:"archived"})},initialValue:ie.draft,placeholder:l.formatMessage({id:"status"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"select"})}],disabled:o.disableEdit})]}),Object(e.jsxs)(r.a.Group,{children:[Object(e.jsx)(L.a,{width:"sm",name:"active_from",label:Object(e.jsx)(a.a,{id:"active_from"}),tooltip:Object(e.jsx)(a.a,{id:"active_from"}),placeholder:l.formatMessage({id:"active_from",defaultMessage:"active_from"}),disabled:o.disableEdit}),Object(e.jsx)(L.a,{width:"sm",name:"active_to",label:Object(e.jsx)(a.a,{id:"active_to"}),tooltip:Object(e.jsx)(a.a,{id:"active_to"}),placeholder:l.formatMessage({id:"active_to",defaultMessage:"active_to"}),disabled:o.disableEdit}),Object(e.jsx)(r.a.Item,{name:"author_id",label:Object(e.jsx)(a.a,{id:"tutor"}),tooltip:Object(e.jsx)(a.a,{id:"tutor_consultation_tooltip"}),valuePropName:"value",required:!0,children:Object(e.jsx)(ve.a,{})})]}),Object(e.jsx)(r.a.Group,{children:Object(e.jsx)(r.a.Item,{name:"description",label:Object(e.jsx)(a.a,{id:"description"}),tooltip:Object(e.jsx)(a.a,{id:"description_tooltip"}),valuePropName:"value",required:!0,children:Object(e.jsx)(W.a,{directory:"consultation/".concat(s,"/wysiwyg")})})}),Object(e.jsx)(r.a.Group,{children:Object(e.jsx)(r.a.Item,{valuePropName:"value",name:"proposed_terms",tooltip:Object(e.jsx)(a.a,{id:"proposed_terms_tooltip"}),label:Object(e.jsx)(a.a,{id:"consultations.proposed_terms"}),children:Object(e.jsx)(Me,{})})})]}))]},"attributes"),!T&&Object(e.jsx)(n.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"product"}),disabled:o.disableEdit,children:s&&Object(e.jsx)(Be.a,{type:"line",productable:{class_type:"App\\Models\\Consultation",class_id:s,name:String(u.name),quantity:1}})},"product"),!T&&Object(e.jsx)(n.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"media"}),disabled:o.disableEdit,children:Object(e.jsx)(r.a,Object(d.a)(Object(d.a)({},se),{},{children:Object(e.jsx)(de.a,{folder:"consultation/".concat(s),title:"image",action:"/api/admin/consultations/".concat(s),src_name:"image_url",form_name:"image",getUploadedSrcField:function(C){return C.file.response.data.image_url},setPath:function(C){return c(function(Q){return Object(d.a)(Object(d.a)({},Q),C)})}})}))},"media"),!T&&Object(e.jsx)(n.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"categories"}),disabled:o.disableEdit,children:Object(e.jsx)(b.a,{children:Object(e.jsx)(g.a,{span:12,children:Object(e.jsx)(r.a,Object(d.a)(Object(d.a)({},se),{},{children:Object(e.jsx)(r.a.Item,{label:Object(e.jsx)(a.a,{id:"categories"}),name:"categories",valuePropName:"value",children:Object(e.jsx)(he.a,{})})}))})})},"categories")," ",!T&&Object(e.jsx)(n.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"branding"}),disabled:o.disableEdit,children:Object(e.jsx)(r.a,Object(d.a)(Object(d.a)({},se),{},{children:Object(e.jsx)(de.a,{folder:"consultation/".concat(s),title:l.formatMessage({id:"logotype"}),action:"/api/admin/consultations/".concat(s),src_name:"logotype_url",form_name:"logotype",getUploadedSrcField:function(C){return C.file.response.data.logotype_url},setPath:function(C){return c(function(Q){return Object(d.a)(Object(d.a)({},Q),C)})}})}))},"branding")," ",!T&&Object(e.jsx)(n.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"user_submission"}),disabled:o.disableEdit,children:Object(e.jsx)(b.a,{children:Object(e.jsx)(g.a,{span:12,children:s&&Object(e.jsx)(Le.a,{id:Number(s),type:"App\\Models\\Consultation"})})})},"user_submission"),!T&&Object(e.jsx)(n.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"consultations.calendar"}),children:Object(e.jsx)(Ke,{consultation:Number(s)})},"calendar")]})}):Object(e.jsx)(A.a,{})},Qe=h.default=We}}]);
