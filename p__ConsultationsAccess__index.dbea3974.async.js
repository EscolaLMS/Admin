"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[8382,2803,8047],{58664:function(Me,Y,e){e.d(Y,{T:function(){return ve}});var de=e(19632),j=e.n(de),ce=e(5574),F=e.n(ce),q=e(74656),_=e(74330),A=e(67294),K=e(51490),Z=e(99100),U=e(32283),me=e(80854),N=e(85893),w=function(S){return S.map(function(p){return"name"in p?{id:Number(p.id),name:p.name}:{id:Number(p.id),name:p.title?p.title:""}})},ve=function(S){var p=S.value,u=S.onChange,ee=S.multiple,te=ee===void 0?!1:ee,pe=S.defaultValue,L=S.modelType,O=L===void 0?"COURSE":L,J=(0,A.useState)([]),ne=F()(J,2),G=ne[0],re=ne[1],X=(0,A.useState)(!1),ae=F()(X,2),se=ae[0],oe=ae[1],o=(0,A.useRef)(),ie=(0,A.useCallback)(function(i){var h,y,M,D;switch(O){case"COURSE":return(0,Z.N7)(i,{signal:o==null||(h=o.current)===null||h===void 0?void 0:h.signal});case"WEBINAR":return(0,U.i5)(i,{signal:o==null||(y=o.current)===null||y===void 0?void 0:y.signal});case"CONSULTATIONS":return(0,K.sL)(i,{signal:o==null||(M=o.current)===null||M===void 0?void 0:M.signal});default:return(0,Z.N7)(i,{signal:o==null||(D=o.current)===null||D===void 0?void 0:D.signal})}},[O,o]),ge=(0,A.useCallback)(function(i){var h,y,M,D;switch(O){case"COURSE":return(0,Z.XR)(Number(i),{signal:(h=o.current)===null||h===void 0?void 0:h.signal});case"WEBINAR":return(0,U.tz)(Number(i),{signal:(y=o.current)===null||y===void 0?void 0:y.signal});case"CONSULTATIONS":return(0,K.hW)(Number(i),{signal:(M=o.current)===null||M===void 0?void 0:M.signal});default:return(0,Z.XR)(Number(i),{signal:(D=o.current)===null||D===void 0?void 0:D.signal})}},[O,o]),k=(0,A.useCallback)(function(i){oe(!0),o.current&&o.current.abort(),o.current=new AbortController,ie(i?{name:i}:{}).then(function(h){h.success&&re(w(h.data))}).catch(function(h){return console.error(h)}).finally(function(){oe(!1)})},[O]),H=(0,A.useCallback)(function(i){k(i)},[k]);return(0,A.useEffect)(function(){return o.current=new AbortController,p&&ge(Number(p)).then(function(i){i&&i.success&&re(function(h){return[].concat(j()(h),j()(w([i.data])))})}),function(){o.current&&o.current.abort()}},[p,O]),(0,N.jsx)(q.default,{defaultValue:pe,onFocus:function(){return k()},allowClear:!0,style:{width:"100%"},value:p,onChange:u,mode:te?"multiple":void 0,showSearch:!0,onSearch:H,placeholder:(0,N.jsx)(me.FormattedMessage,{id:"select_content",defaultMessage:"select_content"}),optionFilterProp:"children",filterOption:function(h,y){if(y&&y.children){var M;return(y==null||(M=y.children)===null||M===void 0?void 0:M.toString().toLowerCase().indexOf(h.toLowerCase()))>=0}return!0},loading:se,notFoundContent:se?(0,N.jsx)(_.Z,{size:"small"}):null,optionLabelProp:"label",children:G.map(function(i){return(0,N.jsx)(q.default.Option,{value:i.id,label:i.name,children:i.name},i.id)})})}},34626:function(Me,Y,e){e.r(Y),e.d(Y,{default:function(){return Re}});var de=e(15009),j=e.n(de),ce=e(99289),F=e.n(ce),q=e(97857),_=e.n(q),A=e(13769),K=e.n(A),Z=e(5574),U=e.n(Z),me=e(74453),N=e(16894),w=e(66309),ve=e(78957),z=e(14726),S=e(60943),p=e(67294),u=e(80854),ee=e(58664),te=e(62235),pe=e(44167),L=e(45919);function O(n,t){return J.apply(this,arguments)}function J(){return J=F()(j()().mark(function n(t,s){return j()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",(0,u.request)("/api/admin/consultation-access-enquiries",_()({method:"GET",params:t},s||{})));case 1:case"end":return g.stop()}},n)})),J.apply(this,arguments)}function ne(n,t,s){return G.apply(this,arguments)}function G(){return G=F()(j()().mark(function n(t,s,c){return j()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,u.request)("/api/admin/consultation-access-enquiries/approve/".concat(t),_()({data:s,method:"POST"},c||{})));case 1:case"end":return m.stop()}},n)})),G.apply(this,arguments)}function re(n,t,s){return X.apply(this,arguments)}function X(){return X=F()(j()().mark(function n(t,s,c){return j()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,u.request)("/api/admin/consultation-access-enquiries/disapprove/".concat(t),_()({data:s,method:"POST"},c||{})));case 1:case"end":return m.stop()}},n)})),X.apply(this,arguments)}var ae=e(19632),se=e.n(ae),oe=e(9783),o=e.n(oe),ie=e(184),ge=e(64317),k=e(5966),H=e(75842),i=e(26412),y={randomUUID:typeof crypto!="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let M;const D=new Uint8Array(16);function je(){if(!M&&(M=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!M))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return M(D)}const C=[];for(let n=0;n<256;++n)C.push((n+256).toString(16).slice(1));function he(n,t=0){return C[n[t+0]]+C[n[t+1]]+C[n[t+2]]+C[n[t+3]]+"-"+C[n[t+4]]+C[n[t+5]]+"-"+C[n[t+6]]+C[n[t+7]]+"-"+C[n[t+8]]+C[n[t+9]]+"-"+C[n[t+10]]+C[n[t+11]]+C[n[t+12]]+C[n[t+13]]+C[n[t+14]]+C[n[t+15]]}function Ue(n,t=0){const s=he(n,t);if(!validate(s))throw TypeError("Stringified UUID is invalid");return s}var Le=null;function Se(n,t,s){if(y.randomUUID&&!t&&!n)return y.randomUUID();n=n||{};const c=n.random||(n.rng||je)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,t){s=s||0;for(let g=0;g<16;++g)t[s+g]=c[g];return t}return he(c)}var xe=Se,Ae=e(57818),r=e(85893),E=function(n){return n.Custom="custom",n.Jitsi="jitsi",n.PencilSpaces="pencil-spaces",n}(E||{}),Te=function(t,s){return s?[t]:[]},Fe=function(){return"https://meet.jit.si/".concat(xe())},_e=function(t){var s,c=t.meeting_link,g=t.meeting_type,m=o()(o()(o()({},E.Custom,c),E.Jitsi,Fe()),E.PencilSpaces,null);return(s=m==null?void 0:m[g])!==null&&s!==void 0?s:c},De=function(t){var s=t.term,c=t.onClose,g=t.onSuccess,m=(0,u.useIntl)(),B=(0,u.useModel)("@@initialState"),T=B.initialState,$=H.Z.useForm(),P=U()($,1),W=P[0],ue=H.Z.useWatch("meeting_type",W),d=(0,p.useMemo)(function(){var l;return!!(!(T==null||(l=T.packages)===null||l===void 0)&&l[Ae.Z.PencilSpaces])},[T==null?void 0:T.packages]),v=(0,p.useMemo)(function(){return[{value:E.Custom,label:m.formatMessage({id:"ConsultationsAccess.meetingType.custom"})},{value:E.Jitsi,label:m.formatMessage({id:"ConsultationsAccess.meetingType.jitsi"})}].concat(se()(Te({value:E.PencilSpaces,label:m.formatMessage({id:"ConsultationsAccess.meetingType.pencil-spaces"})},d)))},[m,d]),a=(0,p.useCallback)(function(){var l=F()(j()().mark(function f(V){var b,I;return j()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(s){x.next=2;break}return x.abrupt("return");case 2:return b=_e(V),x.next=5,ne(s==null?void 0:s.id,{meeting_link:b});case 5:if(I=x.sent,I.success){x.next=8;break}return x.abrupt("return");case 8:c(),g();case 10:case"end":return x.stop()}},f)}));return function(f){return l.apply(this,arguments)}}(),[s]);return(0,r.jsxs)(ie.a,{title:(0,r.jsx)(u.FormattedMessage,{id:"approve_form",defaultMessage:"Approve Form"}),onVisibleChange:function(f){return!f&&c()},form:W,visible:!!s,autoFocusFirstInput:!0,drawerProps:{destroyOnClose:!0},submitTimeout:2e3,initialValues:{meeting_type:E.Custom},onFinish:a,children:[s&&(0,r.jsx)(i.Z,{column:2,children:(0,r.jsx)(i.Z.Item,{label:(0,r.jsx)(u.FormattedMessage,{id:"approve_date",defaultMessage:"Approved Date"}),children:(0,S.WU)(new Date(s.proposed_at),L.Cu)})}),(0,r.jsx)(ge.Z,{name:"meeting_type",options:v,label:(0,r.jsx)(u.FormattedMessage,{id:"ConsultationsAccess.meetingType"})}),ue===E.Custom&&(0,r.jsx)(k.Z,{rules:[{required:!0}],name:"meeting_link",label:(0,r.jsx)(u.FormattedMessage,{id:"ConsultationsAccess.meetingLink"})})]})},Ee=e(90672),be=function(t){var s=t.id,c=t.onClose,g=t.onSuccess,m=H.Z.useForm(),B=U()(m,1),T=B[0];return(0,r.jsx)(ie.a,{title:(0,r.jsx)(u.FormattedMessage,{id:"disapprove_form",defaultMessage:"Disapprove Form"}),onVisibleChange:function(P){return!P&&c()},form:T,visible:!!s,autoFocusFirstInput:!0,drawerProps:{destroyOnClose:!0},submitTimeout:2e3,onFinish:function(){var $=F()(j()().mark(function P(W){return j()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(!s){d.next=3;break}return d.next=3,re(s,W).then(function(v){v.success&&(c(),g())});case 3:return d.abrupt("return",!0);case 4:case"end":return d.stop()}},P)}));return function(P){return $.apply(this,arguments)}}(),children:(0,r.jsx)(Ee.Z,{name:"message",label:(0,r.jsx)(u.FormattedMessage,{id:"reason",defaultMessage:"Reason"}),tooltip:(0,r.jsx)(u.FormattedMessage,{id:"reason_tooltip",defaultMessage:"Reason"})})})},Ie=["type","defaultRender"],Oe=["type","defaultRender"],Pe=function(){var t=(0,p.useRef)(),s=(0,u.useIntl)(),c=(0,p.useState)(),g=U()(c,2),m=g[0],B=g[1],T=(0,p.useState)(),$=U()(T,2),P=$[0],W=$[1],ue=(0,p.useMemo)(function(){return[{title:(0,r.jsx)(u.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,defaultSortOrder:"descend",sorter:!0,width:"80px"},{title:(0,r.jsx)(u.FormattedMessage,{id:"description",defaultMessage:"Description"}),dataIndex:"description",hideInSearch:!0,sorter:!0},{title:(0,r.jsx)(u.FormattedMessage,{id:"user",defaultMessage:"User"}),dataIndex:"user_id",renderFormItem:function(v,a,l){var f=a.type,V=a.defaultRender,b=K()(a,Ie);if(f==="form")return null;var I=l.getFieldValue("state");return(0,r.jsx)(pe.Z,_()(_()({},b),{},{state:{type:I}}))},render:function(v,a){var l,f;return((l=a.user)===null||l===void 0?void 0:l.id)&&(0,r.jsx)(te.Z,{type:"EscolaLms\\Core\\Models\\User",type_id:(f=a.user)===null||f===void 0?void 0:f.id,children:(0,r.jsx)(w.Z,{children:a.user.email})},"user")}},{title:(0,r.jsx)(u.FormattedMessage,{id:"consultation_id",defaultMessage:"Consultation"}),dataIndex:"consultation_id",renderFormItem:function(v,a,l){var f=a.type,V=a.defaultRender,b=K()(a,Oe);if(f==="form")return null;var I=l.getFieldValue("state");return(0,r.jsx)(ee.T,_()(_()({modelType:"CONSULTATIONS"},b),{},{state:{type:I}}))},render:function(v,a){var l,f;return((l=a.consultation)===null||l===void 0?void 0:l.id)&&(0,r.jsx)(te.Z,{type:"EscolaLms\\Consultations\\Models\\Consultation",type_id:(f=a.consultation)===null||f===void 0?void 0:f.id,children:(0,r.jsx)(w.Z,{children:a.consultation.name})},"consultation_id")}},{title:(0,r.jsx)(u.FormattedMessage,{id:"consultation_term_date",defaultMessage:"Term Date"}),dataIndex:"consultation_term",hideInSearch:!0,sorter:!0,render:function(v,a){return a.consultation_term?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.FormattedMessage,{id:"approved_date",defaultMessage:"Approved Date"}),":",(0,S.WU)(new Date(a.consultation_term.date),L.Cu)]}):(0,r.jsx)(ve.Z,{direction:"vertical",children:a.proposed_terms.map(function(l){return(0,r.jsxs)(z.ZP,{size:"small",type:"primary",onClick:function(){W(l)},children:[(0,r.jsx)(u.FormattedMessage,{id:"approve",defaultMessage:"Approve Term"}),":",(0,S.WU)(new Date(l.proposed_at),L.Cu)]},l.id)})})}},{title:(0,r.jsx)(u.FormattedMessage,{id:"meeting_link",defaultMessage:"Meeting Link"}),dataIndex:"meeting_link",hideInSearch:!0,render:function(v,a){return a.meeting_link?(0,r.jsx)(z.ZP,{target:"_blank",type:"primary",href:a.meeting_link,children:new URL(a.meeting_link).host}):(0,r.jsx)(p.Fragment,{})}},{title:(0,r.jsx)(u.FormattedMessage,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",hideInSearch:!0,sorter:!0,render:function(v,a){return a.created_at&&(0,S.WU)(new Date(a.created_at),L.Cu)}},{title:(0,r.jsx)(u.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",sorter:!0,valueType:"select",valueEnum:{pending:{text:"pending",status:"pending"},approved:{text:"approved",status:"approved"}},render:function(v,a){return a.status==="pending"?(0,r.jsx)(z.ZP,{danger:!0,size:"small",type:"primary",onClick:function(){B(a.id)},children:(0,r.jsx)(u.FormattedMessage,{id:"disapprove",defaultMessage:"Disapprove"})}):a.status}}]},[]);return(0,r.jsxs)(me._z,{children:[(0,r.jsx)(De,{term:P,onClose:function(){return W(void 0)},onSuccess:function(){var v;return(v=t.current)===null||v===void 0?void 0:v.reload()}}),(0,r.jsx)(be,{id:m,onClose:function(){return B(void 0)},onSuccess:function(){var v;return(v=t.current)===null||v===void 0?void 0:v.reload()}}),(0,r.jsx)(N.ZP,{headerTitle:s.formatMessage({id:"menu.Other activities.Consultation Requests"}),search:{layout:"vertical"},actionRef:t,rowKey:"id",request:function(){var d=F()(j()().mark(function v(a,l){var f,V,b,I,fe,x,Ce,ye,Q,le;return j()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return f=a.pageSize,V=a.current,b=a.consultation_id,I=a.status,fe=a.user_id,x=a.is_coming,Ce=a.proposed_at_from,ye=a.proposed_at_to,Q=l&&Object.entries(l)[0],R.next=4,O({per_page:f,page:V,consultation_id:b,status:I,user_id:fe,is_coming:x,proposed_at_from:Ce,proposed_at_to:ye,order_by:Q&&Q[0],order:Q?Q[1]==="ascend"?"ASC":"DESC":void 0});case 4:if(le=R.sent,le.success){R.next=7;break}return R.abrupt("return",{data:[],total:0,success:!1});case 7:return R.abrupt("return",{data:le.data,total:le.meta.total,success:!0});case 8:case"end":return R.stop()}},v)}));return function(v,a){return d.apply(this,arguments)}}(),columns:ue})]})},Re=Pe}}]);

//# sourceMappingURL=p__ConsultationsAccess__index.dbea3974.async.js.map