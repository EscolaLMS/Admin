"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7937,2803],{56717:function(yt,He,u){var Ke=u(1413),m=u(67294),Ve=u(93696),Te=u(84089),je=function(Ge,h){return m.createElement(Te.Z,(0,Ke.Z)((0,Ke.Z)({},Ge),{},{ref:h,icon:Ve.Z}))};je.displayName="InfoCircleOutlined",He.Z=m.forwardRef(je)},78677:function(yt,He,u){var Ke=u(67294),m=u(84269),Ve=function(){return Ve=Object.assign||function(je){for(var K,Ge=1,h=arguments.length;Ge<h;Ge++){K=arguments[Ge];for(var v in K)Object.prototype.hasOwnProperty.call(K,v)&&(je[v]=K[v])}return je},Ve.apply(this,arguments)},Te=function(je){return Ke.createElement(m.P,Ve({},je,{chartType:"Column"}))};He.Z=Te},88280:function(yt,He,u){u.d(He,{Z:function(){return R}});var Ke=u(4942),m=u(97685),Ve=u(45987),Te=u(74165),je=u(15861),K=u(1413),Ge=u(87462),h=u(67294),v=u(42110),s=u(78026),ae=function(de,E){return h.createElement(s.Z,(0,Ge.Z)({},de,{ref:E,icon:v.Z}))},d=h.forwardRef(ae),Z=u(97462),i=u(952),b=u(10915),I=u(48171),ne=u(53914),P=u(22270),ee=u(60249),ue=u(14726),we=u(75842),se=u(21770),ut=u(88306),nt=u(8880),gt=u(72717),Fe=u(85893),ht=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],Mt=["record","position","creatorButtonText","newRecordType","parentKey","style"],vt=h.createContext(void 0);function be(g){var de=g.children,E=g.record,e=g.position,Ee=g.newRecordType,xe=g.parentKey,ve=(0,h.useContext)(vt);return h.cloneElement(de,(0,K.Z)((0,K.Z)({},de.props),{},{onClick:function(){var Re=(0,je.Z)((0,Te.Z)().mark(function De(Se){var Oe,ke,pe,ge;return(0,Te.Z)().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,(Oe=(ke=de.props).onClick)===null||Oe===void 0?void 0:Oe.call(ke,Se);case 2:if(ge=W.sent,ge!==!1){W.next=5;break}return W.abrupt("return");case 5:ve==null||(pe=ve.current)===null||pe===void 0||pe.addEditRecord(E,{position:e,newRecordType:Ee,parentKey:xe});case 6:case"end":return W.stop()}},De)}));function Ae(De){return Re.apply(this,arguments)}return Ae}()}))}function C(g){var de,E,e=(0,b.YB)(),Ee=g.onTableChange,xe=g.maxLength,ve=g.formItemProps,Re=g.recordCreatorProps,Ae=g.rowKey,De=g.controlled,Se=g.defaultValue,Oe=g.onChange,ke=g.editableFormRef,pe=(0,Ve.Z)(g,ht),ge=(0,h.useRef)(void 0),ce=(0,h.useRef)(),W=(0,h.useRef)();(0,h.useImperativeHandle)(pe.actionRef,function(){return ce.current},[ce.current]);var oe=(0,se.Z)(function(){return g.value||Se||[]},{value:g.value,onChange:g.onChange}),w=(0,m.Z)(oe,2),U=w[0],xt=w[1],Qe=h.useMemo(function(){return typeof Ae=="function"?Ae:function(G,H){return G[Ae]||H}},[Ae]),jt=(0,I.J)(function(G){if(typeof G=="number"&&!g.name){if(G>=U.length)return G;var H=U&&U[G];return Qe==null?void 0:Qe(H,G)}if((typeof G=="string"||G>=U.length)&&g.name){var z=U.findIndex(function(me,he){var ye;return(Qe==null||(ye=Qe(me,he))===null||ye===void 0?void 0:ye.toString())===(G==null?void 0:G.toString())});if(z!==-1)return z}return G});(0,h.useImperativeHandle)(ke,function(){var G=function(me){var he,ye;if(me==null)throw new Error("rowIndex is required");var Xe=jt(me),rt=[g.name,(he=Xe==null?void 0:Xe.toString())!==null&&he!==void 0?he:""].flat(1).filter(Boolean);return(ye=W.current)===null||ye===void 0?void 0:ye.getFieldValue(rt)},H=function(){var me,he=[g.name].flat(1).filter(Boolean);if(Array.isArray(he)&&he.length===0){var ye,Xe=(ye=W.current)===null||ye===void 0?void 0:ye.getFieldsValue();return Array.isArray(Xe)?Xe:Object.keys(Xe).map(function(rt){return Xe[rt]})}return(me=W.current)===null||me===void 0?void 0:me.getFieldValue(he)};return(0,K.Z)((0,K.Z)({},W.current),{},{getRowData:G,getRowsData:H,setRowData:function(me,he){var ye,Xe;if(me==null)throw new Error("rowIndex is required");var rt=jt(me),Ne=[g.name,(ye=rt==null?void 0:rt.toString())!==null&&ye!==void 0?ye:""].flat(1).filter(Boolean),Ot=Object.assign({},(0,K.Z)((0,K.Z)({},G(me)),he||{})),Et=(0,nt.Z)({},Ne,Ot);return(Xe=W.current)===null||Xe===void 0||Xe.setFieldsValue(Et),!0}})},[jt,g.name,W.current]),(0,h.useEffect)(function(){g.controlled&&(U||[]).forEach(function(G,H){var z;(z=W.current)===null||z===void 0||z.setFieldsValue((0,Ke.Z)({},"".concat(Qe(G,H)),G))},{})},[(0,ne.ZP)(U),g.controlled]),(0,h.useEffect)(function(){if(g.name){var G;W.current=g==null||(G=g.editable)===null||G===void 0?void 0:G.form}},[(de=g.editable)===null||de===void 0?void 0:de.form,g.name]);var qe=Re||{},_t=qe.record,bt=qe.position,It=qe.creatorButtonText,Ct=qe.newRecordType,Ft=qe.parentKey,Tt=qe.style,Gt=(0,Ve.Z)(qe,Mt),O=bt==="top",J=(0,h.useMemo)(function(){return typeof xe=="number"&&xe<=(U==null?void 0:U.length)?!1:Re!==!1&&(0,Fe.jsx)(be,{record:(0,P.h)(_t,U==null?void 0:U.length,U)||{},position:bt,parentKey:(0,P.h)(Ft,U==null?void 0:U.length,U),newRecordType:Ct,children:(0,Fe.jsx)(ue.ZP,(0,K.Z)((0,K.Z)({type:"dashed",style:(0,K.Z)({display:"block",margin:"10px 0",width:"100%"},Tt),icon:(0,Fe.jsx)(d,{})},Gt),{},{children:It||e.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[Re,xe,U==null?void 0:U.length]),Q=(0,h.useMemo)(function(){return J?O?{components:{header:{wrapper:function(H){var z,me=H.className,he=H.children;return(0,Fe.jsxs)("thead",{className:me,children:[he,(0,Fe.jsxs)("tr",{style:{position:"relative"},children:[(0,Fe.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:J}),(0,Fe.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(z=pe.columns)===null||z===void 0?void 0:z.length,children:J})]})]})}}}}:{tableViewRender:function(H,z){var me,he;return(0,Fe.jsxs)(Fe.Fragment,{children:[(me=(he=g.tableViewRender)===null||he===void 0?void 0:he.call(g,H,z))!==null&&me!==void 0?me:z,J]})}}:{}},[O,J]),V=(0,K.Z)({},g.editable),X=(0,I.J)(function(G,H){var z,me,he;if((z=g.editable)===null||z===void 0||(me=z.onValuesChange)===null||me===void 0||me.call(z,G,H),(he=g.onValuesChange)===null||he===void 0||he.call(g,H,G),g.controlled){var ye;g==null||(ye=g.onChange)===null||ye===void 0||ye.call(g,H)}});return(g!=null&&g.onValuesChange||(E=g.editable)!==null&&E!==void 0&&E.onValuesChange||g.controlled&&g!==null&&g!==void 0&&g.onChange)&&(V.onValuesChange=X),(0,Fe.jsxs)(Fe.Fragment,{children:[(0,Fe.jsx)(vt.Provider,{value:ce,children:(0,Fe.jsx)(gt.Z,(0,K.Z)((0,K.Z)((0,K.Z)({search:!1,options:!1,pagination:!1,rowKey:Ae,revalidateOnFocus:!1},pe),Q),{},{tableLayout:"fixed",actionRef:ce,onChange:Ee,editable:(0,K.Z)((0,K.Z)({},V),{},{formProps:(0,K.Z)({formRef:W},V.formProps)}),dataSource:U,onDataSourceChange:function(H){if(xt(H),g.name&&bt==="top"){var z,me=(0,nt.Z)({},[g.name].flat(1).filter(Boolean),H);(z=W.current)===null||z===void 0||z.setFieldsValue(me)}}}))}),g.name?(0,Fe.jsx)(Z.Z,{name:[g.name],children:function(H){var z,me;if(!ge.current)return ge.current=U,null;var he=(0,ut.Z)(H,[g.name].flat(1)),ye=he==null?void 0:he.find(function(Xe,rt){var Ne;return!(0,ee.A)(Xe,(Ne=ge.current)===null||Ne===void 0?void 0:Ne[rt])});return ge.current=U,ye&&(g==null||(z=g.editable)===null||z===void 0||(me=z.onValuesChange)===null||me===void 0||me.call(z,ye,he)),null}}):null]})}function le(g){var de=i.ZP.useFormInstance();return g.name?(0,Fe.jsx)(we.Z.Item,(0,K.Z)((0,K.Z)({style:{maxWidth:"100%"}},g==null?void 0:g.formItemProps),{},{name:g.name,shouldUpdate:function(e,Ee){var xe=[g.name].flat(1);try{return JSON.stringify((0,ut.Z)(e,xe))!==JSON.stringify((0,ut.Z)(Ee,xe))}catch(ve){return!0}},children:(0,Fe.jsx)(C,(0,K.Z)((0,K.Z)({},g),{},{editable:(0,K.Z)((0,K.Z)({},g.editable),{},{form:de})}))})):(0,Fe.jsx)(C,(0,K.Z)({},g))}le.RecordCreator=be;var R=le},11312:function(yt,He,u){u.d(He,{nu:function(){return E},rL:function(){return de},Du:function(){return g}});var Ke=u(9783),m=u.n(Ke),Ve=u(97857),Te=u.n(Ve),je=u(19632),K=u.n(je),Ge=u(5574),h=u.n(Ge),v=u(45919),s=u(66419),ae=u(78677),d=u(26271),Z=u(78957),i=u(66309),b=u(72051),I=u(71230),ne=u(72269),P=u(83863),ee=u(60943),ue=u(67294),we=u(70804),se=u(80854),ut=u(62235),nt=u(15009),gt=u.n(nt),Fe=u(99289),ht=u.n(Fe),Mt=u(58638),vt=u(14726),be=u(76841),C=u(85893),le=function(Ee){var xe=Ee.course_id,ve=Ee.stat,Re=ve===void 0?"EscolaLms\\Reports\\Stats\\Course\\FinishedTopics":ve,Ae=(0,ue.useState)(!1),De=h()(Ae,2),Se=De[0],Oe=De[1],ke=(0,ue.useCallback)(function(pe){return ht()(gt()().mark(function ge(){var ce,W;return gt()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return Oe(!0),w.prev=1,w.next=4,(0,be._g)(pe,{stat:Re});case 4:ce=w.sent,ce instanceof Blob&&(W=document.createElement("a"),W.href=window.URL.createObjectURL(ce),W.download="finished_topics_".concat(xe,".xlsx"),document.body.appendChild(W),W.click(),document.body.removeChild(W)),w.next=11;break;case 8:w.prev=8,w.t0=w.catch(1),console.error(w.t0);case 11:return w.prev=11,Oe(!1),w.finish(11);case 14:case"end":return w.stop()}},ge,null,[[1,8,11,14]])}))},[Re]);return(0,C.jsxs)(vt.ZP,{type:"primary",loading:Se,onClick:ke(xe),children:[(0,C.jsx)(Mt.Z,{})," ",(0,C.jsx)(se.FormattedMessage,{id:"export"})]})},R=function(Ee){return Ee.topicable.content.contents?Object.values(Ee.topicable.content.contents)[0].library:"H5P"},g=function(Ee){var xe=Ee.course_id,ve=Ee.topics,Re=Ee.stats,Ae=(0,ue.useState)(!1),De=h()(Ae,2),Se=De[0],Oe=De[1],ke=(0,ue.useMemo)(function(){return[{title:(0,C.jsx)(se.FormattedMessage,{id:"user"}),dataIndex:"id",render:function(ce){return(0,C.jsx)(ut.Z,{type:"App\\Models\\User",type_id:ce})}},{title:(0,C.jsx)(se.FormattedMessage,{id:"email"}),dataIndex:"email"}].concat(K()(ve.map(function(ge){var ce,W=(ce=ge.topicable_type)===null||ce===void 0?void 0:ce.split("\\").pop();return W==="H5P"&&(W=R(ge)),{render:function(w){var U=0;switch(w&&(w.started_at&&w.finished_at?U=1:w.started_at&&(U=2)),U){case 1:return(0,C.jsxs)(Z.Z,{children:[(0,C.jsx)(i.Z,{color:"success",children:"F"}),Se&&(w==null?void 0:w.seconds)&&(0,C.jsx)("small",{children:(0,s.Im)(w.seconds)})]});case 2:return(0,C.jsxs)(Z.Z,{children:[(0,C.jsx)(i.Z,{color:"blue",children:"S"}),Se&&(w==null?void 0:w.seconds)&&(0,C.jsx)("small",{children:(0,s.Im)(w.seconds)})]});case 0:default:return(0,C.jsx)(ue.Fragment,{children:(0,C.jsx)(i.Z,{color:"error",children:"N"})})}},title:(0,C.jsxs)("small",{children:[(0,C.jsx)(i.Z,{children:W})," ",ge.title]}),dataIndex:ge.id}})))},[ve,Se]),pe=(0,ue.useMemo)(function(){return Re.map(function(ge){return ve.reduce(function(ce,W){var oe=ge.topics.find(function(w){return w.id===W.id});return Te()(Te()({},ce),{},m()({},Number(W.id),oe!=null?oe:0))},{email:ge.email,id:ge.id})})},[Re,ve]);return(0,C.jsx)(b.Z,{title:function(){return(0,C.jsxs)(I.Z,{justify:"space-between",align:"middle",children:[(0,C.jsxs)(Z.Z,{children:[(0,C.jsx)(se.FormattedMessage,{id:"Finished",defaultMessage:"Finished:"})," ",(0,C.jsx)(i.Z,{color:"success",children:"F"}),(0,C.jsx)(se.FormattedMessage,{id:"Started",defaultMessage:"Started:"})," ",(0,C.jsx)(i.Z,{color:"blue",children:"S"}),(0,C.jsx)(se.FormattedMessage,{id:"NotStarted",defaultMessage:"Not Started:"})," ",(0,C.jsx)(i.Z,{color:"error",children:"N"}),(0,C.jsx)(se.FormattedMessage,{id:"ShowMinutes",defaultMessage:"Show minutes spent on topic:"})," ",(0,C.jsx)(ne.Z,{checked:Se,onChange:function(W){return Oe(W)}})]}),(0,C.jsx)(le,{course_id:xe})]})},columns:ke,dataSource:pe,size:"small",scroll:{x:1500},components:{table:function(ce){return(0,C.jsx)(we.Z,{horizontal:!0,style:{maxWidth:"auto"},hideScrollbars:!1,children:(0,C.jsx)("table",Te()({},ce))})}}})},de=function(Ee){var xe=Ee.stats,ve=Ee.attempts,Re=(0,ue.useMemo)(function(){return[{title:(0,C.jsx)(se.FormattedMessage,{id:"user"}),dataIndex:"id",render:function(Se){return(0,C.jsx)(ut.Z,{type:"App\\Models\\User",type_id:Se})}},{title:(0,C.jsx)(se.FormattedMessage,{id:"email"}),dataIndex:"email"},{title:(0,C.jsx)(se.FormattedMessage,{id:"attempt",defaultMessage:"Attempt"}),dataIndex:"attempt"},{title:(0,C.jsx)(se.FormattedMessage,{id:"finished_at",defaultMessage:"Finished at"}),dataIndex:"finished_at",render:function(Se){return Se?(0,ee.WU)(new Date(Se),v.Cu):""}}]},[]),Ae=(0,ue.useMemo)(function(){return xe.map(function(De){var Se=De.id,Oe=De.email,ke=De.finished_at,pe=ve==null?void 0:ve.find(function(ce){return ce.id===Se}),ge=Array.isArray(pe==null?void 0:pe.attempts)?pe==null?void 0:pe.attempts.length:0;return{id:Se,email:Oe,finished_at:ke,attempt:ge}})},[xe]);return(0,C.jsx)(b.Z,{title:function(){return(0,C.jsx)(Z.Z,{children:(0,C.jsx)(se.FormattedMessage,{id:"course.finished",defaultMessage:"Finished"})})},columns:Re,dataSource:Ae,size:"small",scroll:{x:500}})},E=function(Ee){var xe=Ee.stats,ve=(0,ue.useState)(null),Re=h()(ve,2),Ae=Re[0],De=Re[1],Se=(0,ue.useState)(null),Oe=h()(Se,2),ke=Oe[0],pe=Oe[1],ge=(0,se.useIntl)(),ce=(0,ue.useMemo)(function(){return xe.flatMap(function(oe){return Object.values(oe.attempts).flatMap(function(w){var U=w.dates,xt=w.attempt,Qe=Object.values(U).flatMap(function(jt){var qe=jt.date,_t=jt.seconds_total;return{date:qe,attempt:xt,seconds_total:_t,email:oe.email}});return Qe})})},[xe]),W={xField:"date",yField:"seconds_total",seriesField:"attempt",isStack:!0,xAxis:{label:{autoHide:!0,autoRotate:!1}},slider:{start:0,end:1},label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]}};return(0,C.jsx)(d.ZP,{title:(0,C.jsxs)(Z.Z,{children:[(0,C.jsx)(se.FormattedMessage,{id:"course.interactions_time_in_days"}),(0,C.jsx)(P.default,{showSearch:!0,value:Ae,onChange:function(w){De(w),pe(null)},placeholder:(0,C.jsx)(se.FormattedMessage,{id:"select_person",defaultMessage:"Select a person"}),children:xe.map(function(oe){var w=oe.id,U=oe.email;return(0,C.jsx)(P.default.Option,{value:U,children:U},w)})}),(0,C.jsx)(P.default,{value:ke,onChange:function(w){return pe(w)},disabled:Ae===null,placeholder:(0,C.jsx)(se.FormattedMessage,{id:"select_attempt",defaultMessage:"Select attempt"}),children:K()(new Set(ce.filter(function(oe){var w=oe.email;return w===Ae}).map(function(oe){var w=oe.attempt;return w}))).map(function(oe){return(0,C.jsxs)(P.default.Option,{value:oe,children:[(0,C.jsx)(se.FormattedMessage,{id:"attempt",defaultMessage:"Attempt"})," ",oe]},oe)})})]}),colSpan:12,layout:"center",children:(0,C.jsx)("div",{style:{overflow:"auto",minHeight:"400px",width:"100%"},children:(0,C.jsx)(ae.Z,Te()(Te()({},W),{},{tooltip:{title:"".concat(ge.formatMessage({id:"attempt"})),formatter:function(w){var U=Math.floor(+w.seconds_total/60),xt=+w.seconds_total>60?+w.seconds_total-U*60:0;return{name:w.attempt,value:"".concat(U,"m ").concat(xt,"s")}}},data:ce.filter(function(oe){var w=oe.email;return w===Ae}).filter(function(oe){var w=oe.attempt;return Number.isInteger(ke)?w===ke:!0})}))})})}},87366:function(yt,He,u){u.d(He,{Il:function(){return vt},_y:function(){return P},uS:function(){return we}});var Ke=u(15009),m=u.n(Ke),Ve=u(99289),Te=u.n(Ve),je=u(5574),K=u.n(je),Ge=u(97857),h=u.n(Ge),v=u(19632),s=u.n(v),ae=u(2453),d=u(67294),Z=u(80854),i=u(99100),b=u(31472),I=u(36309),ne=u(85893),P=d.createContext({}),ee=function(){return Math.round(Math.random()*99999)},ue=function be(C){return C.reduce(function(le,R){return[].concat(s()(le),s()(R.lessons?be(R.lessons):[]),[R])},[])},we=function be(C){return C.reduce(function(le,R){var g;return[].concat(s()(le),s()(R.lessons?be(R.lessons):[]),s()((g=R.topics)!==null&&g!==void 0?g:[]))},[])},se=function be(C,le,R){return C.map(function(g){var de,E;return h()(h()({},g),{},{lessons:g.lessons?be(g.lessons,le,R):[],topics:g.id===le?[].concat(s()((de=g.topics)!==null&&de!==void 0?de:[]),[R]):(E=g.topics)!==null&&E!==void 0?E:[]})})},ut=function be(C,le,R){return R?C.map(function(g){return h()(h()({},g),{},{lessons:[].concat(s()(g.lessons?be(g.lessons,le,R):[]),s()(g.id===R?[le]:[]))})}):[].concat(s()(C),[le])},nt=function be(C,le,R){return C.map(function(g){return h()(h()({},g.id===le?R:g),{},{lessons:g.lessons?be(g.lessons,le,R):[]})})},gt=function be(C,le){return C.map(function(R){return h()(h()({},R),{},{parent_id:le,lessons:R.lessons?be(R.lessons,R.id):[]})})},Fe=function be(C,le){return C.filter(function(R){return R.id!==le}).map(function(R){return h()(h()({},R),{},{lessons:R.lessons?be(R.lessons,le):[]})})},ht=function be(C,le){return C.map(function(R){return h()(h()({},R),{},{lessons:R.lessons?be(R.lessons,le):[],topics:R.topics?R.topics.filter(function(g){return g.id!==le}):[]})})},Mt=function be(C,le,R,g){return g==null?void 0:g.map(function(de){if(de.id===R){var E;return h()(h()({},de),{},{topics:(E=de.topics)===null||E===void 0?void 0:E.map(function(e){return e.id===C?le.file.response.data:e})})}else if(de.lessons)return h()(h()({},de),{},{lessons:be(C,le,R,de.lessons||[])});return de})},vt=function(C){var le=C.children,R=C.id,g=(0,d.useState)(),de=K()(g,2),E=de[0],e=de[1],Ee=(0,Z.useIntl)(),xe=(0,d.useMemo)(function(){return E&&E.lessons?we(E.lessons):[]},[E]),ve=(0,d.useMemo)(function(){return E&&E.lessons?ue(E.lessons):[]},[E]),Re=(0,d.useState)([]),Ae=K()(Re,2),De=Ae[0],Se=Ae[1],Oe=(0,d.useState)(void 0),ke=K()(Oe,2),pe=ke[0],ge=ke[1],ce=(0,Z.useLocation)(),W=(0,d.useMemo)(function(){var O=new URLSearchParams(ce.search);return{lesson:O.get("lesson"),topic:O.get("topic")}},[ce]),oe=(0,d.useCallback)(Te()(m()().mark(function O(){var J,Q;return m()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,(0,I.XU)({class_type:"EscolaLms\\Courses\\Models\\Lesson"});case 2:J=X.sent,J.success&&(Q=J.data.find(function(G){var H=G.name;return H==="assistant_id"}),ge(Q==null?void 0:Q.id));case 4:case"end":return X.stop()}},O)})),[]);(0,d.useEffect)(function(){oe(),Se([])},[]);var w=(0,d.useCallback)(function(){(0,i.Nx)(R).then(function(O){return O.success&&e(h()(h()({},O.data),{},{lessons:gt(O.data.lessons)}))})},[R]);(0,d.useEffect)(function(){w()},[w]);var U=(0,d.useCallback)(function(O){var J=ve.find(function(Q){var V;return Q==null||(V=Q.topics)===null||V===void 0?void 0:V.find(function(X){return X.id===O})});return J?J.id:null},[ve]),xt=(0,d.useMemo)(function(){return W.lesson?{mode:"lesson",id:Number(W.lesson),value:ve.find(function(O){return O.id===Number(W.lesson)})}:W.topic?{mode:"topic",id:Number(W.topic),value:xe.find(function(O){return O.id===Number(W.topic)})}:{mode:"init"}},[W,E,ve,xe]),Qe=(0,d.useCallback)(function(O){var J={course_id:R,topics:[],isNew:!0,id:E?E.lessons.length+1:ee(),order:0,title:Ee.formatMessage({id:"add_title_here"}),active:!0,parent_id:O};return e(function(Q){var V;return h()(h()({},Q),{},{lessons:ut((V=Q==null?void 0:Q.lessons)!==null&&V!==void 0?V:[],J,O)})}),J},[R,E]),jt=(0,d.useCallback)(function(O,J){var Q=ve.find(function(X){return X.id===O}),V=Q&&Q.isNew;return pe&&J.append("assistant_id","".concat(pe)),(V?(0,i.aA)(J):(0,i.sI)(O,J)).then(function(X){return ae.ZP.success(X.message),w(),X.success&&e(function(G){var H;return h()(h()({},G),{},{lessons:nt((H=G==null?void 0:G.lessons)!==null&&H!==void 0?H:[],O,h()(h()({},X.data),{},{isNew:!1}))})})})},[E,pe]),qe=(0,d.useCallback)(function(O){var J=ve.find(function(V){return V.id===O});if(J){var Q=J.isNew;Q?e(function(V){var X;return h()(h()({},V),{},{lessons:Fe((X=V==null?void 0:V.lessons)!==null&&X!==void 0?X:[],O)})}):(0,i.iI)(O).then(function(V){V.success&&(ae.ZP.success(V.message),e(function(X){var G;return h()(h()({},X),{},{lessons:Fe((G=X==null?void 0:X.lessons)!==null&&G!==void 0?G:[],O)})}))})}},[E]),_t=(0,d.useCallback)(function(O,J){var Q,V=U(O),X=ve.find(function(z){return z.id===V}),G=X&&((Q=X.topics)===null||Q===void 0?void 0:Q.find(function(z){return z.id===O})),H=G==null?void 0:G.isNew;return(H?(0,i.HV)(J):(0,i.Cn)(O,J)).then(function(z){z.success&&(ae.ZP.success(z.message),w(),Z.history.push("/courses/list/".concat(R,"/program/?topic=").concat(z.data.id)),(G==null?void 0:G.topicable_type)===b.oz.Video&&setTimeout(function(){w()},5e3))})},[U,E,w]),bt=(0,d.useCallback)(function(O){var J=U(O),Q=ve.find(function(G){return G.id===J});if(Q){var V=xe==null?void 0:xe.find(function(G){return G.id===O}),X=V==null?void 0:V.isNew;X&&!V.topicable?e(function(G){var H;return h()(h()({},G),{},{lessons:ht((H=G==null?void 0:G.lessons)!==null&&H!==void 0?H:[],O)})}):(0,i.vJ)(O).then(function(G){G.success&&(ae.ZP.success(G.message),e(function(H){var z;return h()(h()({},H),{},{lessons:ht((z=H==null?void 0:H.lessons)!==null&&z!==void 0?z:[],O)})}))})}},[E,U]),It=(0,d.useCallback)(function(O,J){var Q={lesson_id:O,isNew:!0,id:ee(),title:Ee.formatMessage({id:"add_title_here"}),active:!0,topicable_type:J};return e(function(V){var X;return h()(h()({},V),{},{lessons:se((X=V==null?void 0:V.lessons)!==null&&X!==void 0?X:[],O,Q)})}),Q},[]),Ct=function(J,Q){var V=U(J);e(function(X){return h()(h()({},X),{},{lessons:X?Mt(J,Q,V,X.lessons||[]):[]})}),Z.history.push("/courses/list/".concat(R,"/program/?topic=").concat(Q.file.response.data.id))},Ft=(0,d.useCallback)(function(O){return(0,i.Cx)(O).then(function(J){if(J.success){ae.ZP.success(J.message);var Q=U(O);e(function(V){var X;return h()(h()({},V),{},{lessons:V?(X=V.lessons)===null||X===void 0?void 0:X.map(function(G){if(G.id===Q){var H=G.topics||[];return h()(h()({},G),{},{topics:[].concat(s()(H),[J.data])})}return G}):[]})})}})},[E,U]),Tt=(0,d.useCallback)(function(O){return(0,i.if)(O).then(function(J){J.success&&(ae.ZP.success(J.message),e(function(Q){return h()(h()({},Q),{},{lessons:Q?[].concat(s()(Q.lessons),[J.data]):[]})}))})},[]),Gt={state:E,h5ps:De,id:R,addNewLesson:Qe,updateLesson:jt,updateTopic:_t,deleteLesson:qe,addNewTopic:It,deleteTopic:bt,onTopicUploaded:Ct,cloneTopic:Ft,cloneLesson:Tt,currentEditMode:xt,getLessons:w};return(0,ne.jsx)(P.Provider,{value:Gt,children:le})}},88030:function(yt,He,u){u.r(He),u.d(He,{default:function(){return Rr}});var Ke=u(97857),m=u.n(Ke),Ve=u(91115),Te=u(26114),je=u(26271),K=u(74453),Ge=u(75081),h=u(14726),v=u(67294),s=u(80854),ae=u(15009),d=u.n(ae),Z=u(99289),i=u.n(Z),b=u(19632),I=u.n(b),ne=u(5574),P=u.n(ne),ee=u(16894),ue=u(83062),we=u(2453),se=u(25093),ut=u(28248),nt=u(78957),gt=u(2487),Fe=u(96365),ht=u(75842);function Mt(o,n){return vt.apply(this,arguments)}function vt(){return vt=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/bookmarks",m()({method:"GET",params:n},t||{})));case 1:case"end":return a.stop()}},o)})),vt.apply(this,arguments)}function be(o,n){return C.apply(this,arguments)}function C(){return C=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/bookmarks",m()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return a.stop()}},o)})),C.apply(this,arguments)}function le(o,n,t){return R.apply(this,arguments)}function R(){return R=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/bookmarks/".concat(n),m()({method:"PATCH",headers:{"Content-Type":"application/json"},data:t},r||{})));case 1:case"end":return l.stop()}},o)})),R.apply(this,arguments)}function g(o,n,t){return de.apply(this,arguments)}function de(){return de=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/bookmarks/".concat(n),m()({method:"DELETE",headers:{"Content-Type":"application/json"},data:t},r||{})));case 1:case"end":return l.stop()}},o)})),de.apply(this,arguments)}var E=u(31472),e=u(85893),Ee=function(n){var t=n.visible,r=n.onClose,a=n.user,l=se.Z.Text,c=a.name,f=a.groupId,x=a.userId,_=(0,v.useState)(""),S=P()(_,2),M=S[0],T=S[1],p=(0,v.useState)(!1),j=P()(p,2),y=j[0],F=j[1],k=(0,v.useState)([]),D=P()(k,2),A=D[0],ie=D[1],Y=(0,v.useState)(null),te=P()(Y,2),N=te[0],L=te[1],$=(0,v.useState)({current_page:1,per_page:5,last_page:1,total:0}),B=P()($,2),fe=B[0],ze=B[1],Be=function(){var Le=i()(d()().mark(function q(_e){var re;return d()().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return Pe.next=2,Mt({bookmarkable_id:f,bookmarkable_type:E.h5.Group,user_id:x,page:_e,per_page:fe.per_page});case 2:re=Pe.sent,re.success&&(ie(re.data),ze(re.meta));case 4:case"end":return Pe.stop()}},q)}));return function(_e){return Le.apply(this,arguments)}}(),tt=function(){var Le=i()(d()().mark(function q(){var _e;return d()().wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return We.next=2,be({value:M,bookmarkable_id:f,bookmarkable_type:E.h5.Group,user_id:x});case 2:_e=We.sent,_e.success&&(Be(),F(!1),T(""));case 4:case"end":return We.stop()}},q)}));return function(){return Le.apply(this,arguments)}}(),Ye=function(){var Le=i()(d()().mark(function q(_e){var re;return d()().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return Pe.next=2,g(_e);case 2:re=Pe.sent,re.success&&Be();case 4:case"end":return Pe.stop()}},q)}));return function(_e){return Le.apply(this,arguments)}}(),Me=function(){var Le=i()(d()().mark(function q(_e){var re;return d()().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return Pe.next=2,le(_e,{value:(N==null?void 0:N.currentText)||"",bookmarkable_id:f,bookmarkable_type:E.h5.Group,user_id:x});case 2:re=Pe.sent,re.success&&(Be(),L(null));case 4:case"end":return Pe.stop()}},q)}));return function(_e){return Le.apply(this,arguments)}}();return(0,v.useEffect)(function(){Be()},[]),(0,e.jsxs)(ut.Z,{title:(0,e.jsxs)(nt.Z,{children:[(0,e.jsx)(s.FormattedMessage,{id:"notes"}),(0,e.jsx)(l,{children:"(".concat(c,")")})]}),open:t,onCancel:r,footer:[(0,e.jsx)(h.ZP,{onClick:r,children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})},"cancel")],children:[(0,e.jsx)(gt.Z,{dataSource:A,pagination:{onChange:function(q){return Be(q)},pageSize:fe.per_page,total:fe.total,current:fe.current_page},renderItem:function(q){return(0,e.jsx)(gt.Z.Item,{actions:[(0,e.jsx)(h.ZP,{danger:!0,onClick:function(){return Ye(q.id)},children:(0,e.jsx)(s.FormattedMessage,{id:"delete"})},q.id),(N==null?void 0:N.currentNoteId)===q.id?(0,e.jsxs)(nt.Z,{children:[(0,e.jsx)(h.ZP,{onClick:function(){return Me(q.id)},children:(0,e.jsx)(s.FormattedMessage,{id:"save"})}),(0,e.jsx)(h.ZP,{onClick:function(){return L(null)},children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})})]}):(0,e.jsx)(h.ZP,{onClick:function(){return L({currentNoteId:q.id,currentText:q.value||""})},children:(0,e.jsx)(s.FormattedMessage,{id:"edit"})},q.id)],children:(N==null?void 0:N.currentNoteId)===q.id&&(N==null?void 0:N.currentText)!==null?(0,e.jsx)(Fe.Z.TextArea,{value:N==null?void 0:N.currentText,onChange:function(re){return L(function(We){return m()(m()({},We),{},{currentText:re.target.value})})}}):q.value})}}),y?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ht.Z,{layout:"vertical",children:(0,e.jsx)(ht.Z.Item,{label:(0,e.jsx)(s.FormattedMessage,{id:"new_note"}),children:(0,e.jsx)(Fe.Z.TextArea,{value:M,onChange:function(q){return T(q.target.value)},autoSize:{minRows:3,maxRows:6}})})}),(0,e.jsxs)(nt.Z,{children:[(0,e.jsx)(h.ZP,{type:"primary",onClick:tt,children:(0,e.jsx)(s.FormattedMessage,{id:"save"})}),(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){return F(!1)},children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})})]})]}):(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){return F(!0)},children:(0,e.jsx)(s.FormattedMessage,{id:"add_note"})},"new")]})},xe=Ee;function ve(o,n){return Re.apply(this,arguments)}function Re(){return Re=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/schedules/groups/".concat(n),m()({method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},o)})),Re.apply(this,arguments)}function Ae(o,n,t,r){return De.apply(this,arguments)}function De(){return De=i()(d()().mark(function o(n,t,r,a){return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,s.request)("/api/admin/schedules/".concat(n,"/attendances"),m()({data:{attendances:[{user_id:t,value:r}]},method:"POST"},a||{})));case 1:case"end":return c.stop()}},o)})),De.apply(this,arguments)}function Se(o,n){return Oe.apply(this,arguments)}function Oe(){return Oe=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams",m()({method:"GET",useCache:!1,params:n},t||{})));case 1:case"end":return a.stop()}},o)})),Oe.apply(this,arguments)}function ke(o,n){return pe.apply(this,arguments)}function pe(){return pe=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams",m()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return a.stop()}},o)})),pe.apply(this,arguments)}function ge(o,n,t){return ce.apply(this,arguments)}function ce(){return ce=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n),m()({method:"PUT",data:t,useCache:!1},r||{})));case 1:case"end":return l.stop()}},o)})),ce.apply(this,arguments)}function W(o,n){return oe.apply(this,arguments)}function oe(){return oe=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n),m()({method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},o)})),oe.apply(this,arguments)}function w(o,n){return U.apply(this,arguments)}function U(){return U=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n),m()({method:"DELETE"},t||{})));case 1:case"end":return a.stop()}},o)})),U.apply(this,arguments)}function xt(o,n,t,r){return Qe.apply(this,arguments)}function Qe(){return Qe=i()(d()().mark(function o(n,t,r,a){return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n,"/users/").concat(t),m()({method:"POST",headers:{"Content-Type":"application/json"},data:r},a||{})));case 1:case"end":return c.stop()}},o)})),Qe.apply(this,arguments)}function jt(o,n,t){return qe.apply(this,arguments)}function qe(){return qe=_asyncToGenerator(_regeneratorRuntime().mark(function o(n,t,r){return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",request("/api/admin/exams/".concat(n,"/users/").concat(t),_objectSpread({method:"DELETE"},r||{})));case 1:case"end":return l.stop()}},o)})),qe.apply(this,arguments)}function _t(o,n,t){return bt.apply(this,arguments)}function bt(){return bt=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/semester-subjects/".concat(n,"/tutors/").concat(t,"/grades"),m()({method:"GET",useCache:!1},r||{})));case 1:case"end":return l.stop()}},o)})),bt.apply(this,arguments)}function It(o,n,t,r){return Ct.apply(this,arguments)}function Ct(){return Ct=i()(d()().mark(function o(n,t,r,a){return d()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",(0,s.request)("/api/admin/semester-subjects/".concat(n,"/tutors/").concat(t,"/grades"),m()({method:"POST",data:r},a||{})));case 1:case"end":return c.stop()}},o)})),Ct.apply(this,arguments)}function Ft(o,n){return Tt.apply(this,arguments)}function Tt(){return Tt=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/lesson-group-users",m()({method:"GET",params:{groups:n},useCache:!1},t||{})));case 1:case"end":return a.stop()}},o)})),Tt.apply(this,arguments)}function Gt(o,n,t){return O.apply(this,arguments)}function O(){return O=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/lesson-group-users/groups/".concat(n,"/users/").concat(t),m()({method:"GET",useCache:!1},r||{})));case 1:case"end":return l.stop()}},o)})),O.apply(this,arguments)}function J(o){return Q.apply(this,arguments)}function Q(){return Q=i()(d()().mark(function o(n){return d()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/admin/grade-terms",m()({method:"GET",useCache:!1},n||{})));case 1:case"end":return r.stop()}},o)})),Q.apply(this,arguments)}function V(o,n){return X.apply(this,arguments)}function X(){return X=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/grade-scales/".concat(n),m()({method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},o)})),X.apply(this,arguments)}function G(o,n){return H.apply(this,arguments)}function H(){return H=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/final-grades",m()({method:"POST",data:n},t||{})));case 1:case"end":return a.stop()}},o)})),H.apply(this,arguments)}function z(o,n,t){return me.apply(this,arguments)}function me(){return me=i()(d()().mark(function o(n,t,r){return d()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/final-grades/".concat(n),m()({method:"PATCH",data:t},r||{})));case 1:case"end":return l.stop()}},o)})),me.apply(this,arguments)}function he(o,n){return ye.apply(this,arguments)}function ye(){return ye=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/final-grades/".concat(n),m()({method:"DELETE"},t||{})));case 1:case"end":return a.stop()}},o)})),ye.apply(this,arguments)}var Xe=u(95213),rt=u(47389),Ne=u(7092),Ot=u(13769),Et=u.n(Ot),da=["results"],Kt=function(n,t){return n.reduce(function(r,a){var l=a.results,c=Et()(a,da),f=l.find(function(x){return x.user_id===t});return f?[].concat(I()(r),[m()(m()({},c),{},{result:f})]):r},[])},Vt=function(n,t){var r,a=n.reduce(function(p,j){var y=j.result,F=j.weight;return F&&typeof y.result=="number"?[p[0]+y.result*F,p[1]+F]:p},[0,0]),l=P()(a,2),c=l[0],f=l[1],x=Number.isNaN(c/f)?0:c/f,_=t.sort(function(p,j){return p.grade_value-j.grade_value}).reduce(function(p,j){return[].concat(I()(p),[m()(m()({},j),{},{isWeightedAverageGreater:x>=j.grade_value})])},[]);if(_.every(function(p){var j=p.isWeightedAverageGreater;return j})){var S,M;return(S=(M=_.at(-1))===null||M===void 0?void 0:M.name)!==null&&S!==void 0?S:""}var T=_.findIndex(function(p){var j=p.isWeightedAverageGreater;return!j});return T<0?"":(r=_[T-1])===null||r===void 0?void 0:r.name},Xt=function(n,t){var r;return(r=t.find(function(a){return a.s_subject_scale_form_id===n}))===null||r===void 0?void 0:r.scale},lt=u(73199),ca=u(9783),et=u.n(ca),zt=u(84567);function ma(o){var n,t=o===null?E.cX.ABSENT:o,r=et()(et()(et()(et()({},E.cX.PRESENT,{ch1:!0,ch2:!1}),E.cX.PRESENT_NOT_EXERCISING,{ch1:!0,ch2:!0}),E.cX.ABSENT,{ch1:!1,ch2:!1}),E.cX.EXCUSED_ABSENCE,{ch1:!1,ch2:!0});return(n=r[t])!==null&&n!==void 0?n:{ch1:!1,ch2:!1}}function fa(o){var n,t=o.ch1,r=o.ch2,a="".concat(t,"_").concat(r),l={true_false:E.cX.PRESENT,true_true:E.cX.PRESENT_NOT_EXERCISING,false_false:E.cX.ABSENT,false_true:E.cX.EXCUSED_ABSENCE};return(n=l[a])!==null&&n!==void 0?n:E.cX.ABSENT}var va=function(n){var t=n.groupAttendanceScheduleId,r=n.studentId,a=n.attendance,l=n.onSuccess,c=(0,v.useState)(ma(a)),f=P()(c,2),x=f[0],_=f[1],S=(0,v.useState)(!1),M=P()(S,2),T=M[0],p=M[1],j=(0,v.useRef)(!0),y=(0,v.useCallback)(function(D){p(!0),Ae(t,r,fa(D)).then(function(A){A.success&&(l==null||l())}).finally(function(){return p(!1)})},[]),F=(0,v.useCallback)(function(D){return _(D.target.checked?{ch1:!0,ch2:!1}:{ch1:!1,ch2:!1})},[]),k=(0,v.useCallback)(function(D){return _(function(A){return m()(m()({},A),{},{ch2:D.target.checked})})},[]);return(0,v.useEffect)(function(){if(j.current){j.current=!1;return}y(x)},[x,y]),(0,e.jsxs)(nt.Z,{children:[(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"present"}),children:(0,e.jsx)(zt.Z,{disabled:T,checked:x.ch1,onChange:F})}),(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:x.ch1?"not_exercising":"excused_absence"}),children:(0,e.jsx)(zt.Z,{disabled:T,checked:x.ch2,onChange:k})})]})},Ht=va,pt=u(45919),St=u(60943),Pt=u(83863),Yt=u(8925),pa=u(96486),ga=function(n){var t=n.exam_id,r=n.result,a=n.student_id,l=n.type,c=n.onSuccess,f=(0,v.useCallback)((0,pa.debounce)(function(_){xt(t,a,{result:_}).then(function(S){S.success&&(c==null||c(S.data))})},300),[t,r,a]),x=function(){switch(l){case E.UL.ManualPass:return(0,e.jsx)(Pt.default,{allowClear:!0,style:{width:"100%"},onChange:f,options:lt.FW,defaultValue:r,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_grade"})});case E.UL.ManualGrades:return(0,e.jsx)(Pt.default,{allowClear:!0,style:{width:"100%"},onChange:f,options:lt.BP,defaultValue:r,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_grade"})});default:return(0,e.jsx)(Yt.Z,{type:"number",min:0,max:100,onChange:f,defaultValue:r!=null?r:void 0})}};return x()},ha=function(n,t){var r;return(r=n.find(function(a){return a.name===t}))===null||r===void 0?void 0:r.id},xa=function(n){var t=n.term,r=n.gradeScales,a=n.defaultFinalGrade,l=n.finalGrades,c=(0,v.useState)(a),f=P()(c,2),x=f[0],_=f[1],S=(0,v.useState)(!1),M=P()(S,2),T=M[0],p=M[1],j=(0,v.useState)(!1),y=P()(j,2),F=y[0],k=y[1],D=(0,s.useIntl)(),A=(0,v.useMemo)(function(){return r.map(function(te){var N=te.name,L=te.id;return{value:L,label:N}})},[r]),ie=function(N){k(!0),we.ZP.error(D.formatMessage({id:N.data.message}))},Y=(0,v.useCallback)(function(te){if(l!=null&&l.id){if(te===void 0){if(!x)return;p(!0),he(x.id).then(function(N){N.success&&_(void 0)}).finally(function(){return p(!1)});return}if(x){p(!0),z(x.id,{grade_scale_id:te}).catch(function(N){var L;N!=null&&(L=N.data)!==null&&L!==void 0&&L.message&&ie(N)}).finally(function(){return p(!1)});return}p(!0),G({grade_term_id:t.id,grade_scale_id:te,lesson_group_user_id:l.id}).then(function(N){if(N.success){var L=N.data.grades.find(function($){return $.grade_term.id===t.id});_(L),F&&k(!1)}}).catch(function(N){var L;N!=null&&(L=N.data)!==null&&L!==void 0&&L.message&&ie(N)}).finally(function(){return p(!1)})}},[x,t.id,l==null?void 0:l.id]);return l?(0,e.jsx)(Pt.default,{allowClear:!0,status:F?"error":"",loading:T,disabled:T,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_final_grade"}),style:{width:"100%"},onChange:Y,options:A,defaultValue:ha(r,a==null?void 0:a.grade_name)}):null},ja=function(n){var t=n.reduce(function(r,a){return[].concat(I()(r),[{title:(0,St.WU)(new Date(a.date_from),pt.GC),dataIndex:"attendance-".concat(a.id),hideInSearch:!0,width:100,align:"center",render:function(c,f){return(0,e.jsx)(Ht,{groupAttendanceScheduleId:a.id,attendance:f["attendance-".concat(a==null?void 0:a.id)],studentId:f.id})}}])},[]);return t.length?{title:(0,e.jsx)(s.FormattedMessage,{id:"attendance"}),hideInSearch:!0,children:t}:{title:(0,e.jsx)(s.FormattedMessage,{id:"attendance"}),hideInSearch:!0,hideInTable:!0}},_a=function(n,t){return n.reduce(function(r,a){var l=a.attendances.find(function(c){return c.user_id===t});return l?m()(m()({},r),{},et()({},"attendance-".concat(a.id),l.value)):r},{})},ba=function(n){var t=n.reduce(function(r,a){return[].concat(I()(r),[{dataIndex:"exam-".concat(a.id),title:a.type===E.UL.Manual?(0,e.jsx)(s.FormattedMessage,{id:"examTitleWithWeight",values:a}):(0,e.jsx)(s.FormattedMessage,{id:"examTitleWithoutWeight",values:a}),hideInSearch:!0,width:100,render:function(c,f){var x;return(f==null||(x=f["exam-".concat(a.id)])===null||x===void 0?void 0:x.result)!==void 0?(0,e.jsx)(ga,{type:a.type,result:f==null?void 0:f["exam-".concat(a.id)].result,exam_id:a.id,student_id:f.id}):"-"}}])},[]);return t.length?{title:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),hideInSearch:!0,children:t}:{title:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),hideInSearch:!0,hideInTable:!0}},Sa=function(n){return n.reduce(function(t,r){var a=r.result,l=r.id;return m()(m()({},t),{},et()({},"exam-".concat(l),a))},{})},ya=function(n,t){return{title:(0,e.jsx)(s.FormattedMessage,{id:"final-grades"}),hideInSearch:!0,children:n.map(function(r){return{title:r.name,hideInSearch:!0,width:100,align:"center",render:function(l,c){var f;return(0,e.jsx)(xa,{defaultFinalGrade:c["final-grade-".concat(r.id)],finalGrades:c.final_grades,term:r,gradeScales:t},"".concat(c==null||(f=c.final_grades)===null||f===void 0?void 0:f.group_id,"-").concat(r.id))}}})}},Ma=function(n,t){return n.find(function(r){return r.user.id===t})},Ca=function(n){var t;return((t=n==null?void 0:n.grades)!==null&&t!==void 0?t:[]).reduce(function(r,a){return m()(m()({},r),{},et()({},"final-grade-".concat(a.grade_term.id),a))},{})},Ta=function(){var n,t=(0,Ne.Z)(),r=t.teacherSubjectData,a=t.semester_subject_id,l=(0,v.useState)([]),c=P()(l,2),f=c[0],x=c[1],_=(0,v.useState)(r==null||(n=r.groups)===null||n===void 0||(n=n[0])===null||n===void 0?void 0:n.name),S=P()(_,2),M=S[0],T=S[1],p=(0,v.useState)(null),j=P()(p,2),y=j[0],F=j[1],k=(0,s.useIntl)(),D=(0,v.useMemo)(function(){var Y;return((Y=r==null?void 0:r.groups)!==null&&Y!==void 0?Y:[]).map(function(te){var N=te.id,L=te.name;return{value:N,label:L}})},[r==null?void 0:r.groups]),A=(0,v.useRef)(),ie=(0,v.useMemo)(function(){var Y;return[{title:(0,e.jsx)(s.FormattedMessage,{id:"group"}),dataIndex:"group_id",hideInTable:!0,valueType:"select",fieldProps:{options:D,defaultValue:D==null||(Y=D[0])===null||Y===void 0?void 0:Y.value,allowClear:!1}},{title:(0,e.jsx)(s.FormattedMessage,{id:"surnameAndName",defaultMessage:"Name and surname"}),dataIndex:"full_name",fixed:"left"}].concat(I()(f),[{hideInSearch:!0,title:(0,e.jsx)(s.FormattedMessage,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",fixed:"right",width:60,render:function(N,L){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"notes",defaultMessage:"notes"}),children:(0,e.jsx)(h.ZP,{type:"primary",icon:(0,e.jsx)(rt.Z,{}),onClick:function(){return F({userName:L.full_name,userId:L.id,groupId:L.final_grades.group_id})}})})})}}])},[D,f]);return(0,e.jsxs)(e.Fragment,{children:[(y==null?void 0:y.userId)&&(0,e.jsx)(xe,{visible:!!y.userId,onClose:function(){return F(null)},user:{name:y.userName,userId:y.userId,groupId:y.groupId}}),(0,e.jsx)(ee.ZP,{sticky:!0,className:"table-standalone",request:function(){var Y=i()(d()().mark(function te(N){var L,$,B,fe,ze,Be,tt,Ye,Me,Le,q,_e,re,We,Pe,Ce,Ze,Ie,Ue,Je,mt;return d()().wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return fe=N.group_id,ze=fe===void 0?(L=D[0])===null||L===void 0?void 0:L.value:fe,Be=N.full_name,tt=Be===void 0?"":Be,$e.next=3,Ft([ze]);case 3:if(Ye=$e.sent,Me=D.find(function(st){var it=st.value;return it===ze}),!(!Ye.success||Ye.data[0]===void 0||a===null)){$e.next=8;break}return we.ZP.error(k.formatMessage({id:"groupDataMissing"},{group_name:Me==null?void 0:Me.label})),$e.abrupt("return",{data:[],total:0,success:!1});case 8:return $e.next=10,Promise.all([(0,Xe.X)(ze),ve(ze),Se({group_id:ze,per_page:-1}),_t(a,($=Ye.data)===null||$===void 0||($=$[0])===null||$===void 0?void 0:$.tutor_id),J(),V((B=Ye.data)===null||B===void 0||(B=B[0])===null||B===void 0?void 0:B.s_subject_scale_form_id)]);case 10:if(Le=$e.sent,q=P()(Le,6),_e=q[0],re=q[1],We=q[2],Pe=q[3],Ce=q[4],Ze=q[5],!(!_e.success||!re.success||!We.success||!Pe.success||!Ce.success||!Ze.success||!Me)){$e.next=21;break}return we.ZP.error(k.formatMessage({id:"groupDataMissing"},{group_name:Me==null?void 0:Me.label})),$e.abrupt("return",{data:[],total:0,success:!1});case 21:return T(Me.label),Ie=ja(re.data),Ue=ba(We.data),Je=ya(Ce.data,Ze.data),x([Ie,Ue,Je,{title:(0,e.jsx)(s.FormattedMessage,{id:"proposed_grade"}),hideInSearch:!0,dataIndex:"proposed_grade",align:"center",width:100}]),mt=_e.data.users.reduce(function(st,it){var $t,at,wt,Zt=it.id,$r=it.academic_teacher_id,Or=it.first_name,Nr=it.last_name,oa="".concat(Nr," ").concat(Or);if($r!==null||!oa.toLowerCase().includes(tt.toLowerCase()))return st;var Ur=_a(re.data,Zt),la=Kt(We.data,Zt),Dt=Ma(Ye.data,Zt),kr=($t=Xt((at=Dt==null?void 0:Dt.s_subject_scale_form_id)!==null&&at!==void 0?at:0,(wt=Pe.data.grade_scale)!==null&&wt!==void 0?wt:[]))!==null&&$t!==void 0?$t:[],Br=Vt(la,kr),Wr=Sa(la),Kr=Ca(Dt);return[].concat(I()(st),[m()(m()(m()(m()({id:Zt,full_name:oa},Ur),Wr),Kr),{},{proposed_grade:Br,final_grades:Dt})])},[]).sort(function(st,it){return st.full_name.localeCompare(it.full_name)}),$e.abrupt("return",{data:mt,total:mt.length,success:!0});case 28:case"end":return $e.stop()}},te)}));return function(te){return Y.apply(this,arguments)}}(),columns:ie,headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"classRegisterTitleWithGroupName",values:{groupName:M}}),search:{layout:"vertical"},scroll:{x:1500},actionRef:A,pagination:{defaultPageSize:lt.Sl,onChange:function(){var te;return(te=A.current)===null||te===void 0?void 0:te.reload()}},rowKey:"id"})]})},Jt=u(1413),Fa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM305.8 637.7c3.1 3.1 8.1 3.1 11.3 0l138.3-137.6L583 628.5c3.1 3.1 8.2 3.1 11.3 0l275.4-275.3c3.1-3.1 3.1-8.2 0-11.3l-39.6-39.6a8.03 8.03 0 00-11.3 0l-230 229.9L461.4 404a8.03 8.03 0 00-11.3 0L266.3 586.7a8.03 8.03 0 000 11.3l39.5 39.7z"}}]},name:"line-chart",theme:"outlined"},Ea=Fa,Pa=u(84089),Qt=function(n,t){return v.createElement(Pa.Z,(0,Jt.Z)((0,Jt.Z)({},n),{},{ref:t,icon:Ea}))};Qt.displayName="LineChartOutlined";var Za=v.forwardRef(Qt),qt=u(82061),ea=u(86738),Lt=u(62235),ot=u(952),Ia=u(5966),Ga=u(50335),ta=u(71230),dt=u(15746),wa=u(56717),aa=u(95830),Da=u(29477),ra=function(n){return n===E.UL.Manual||n===E.UL.ManualPass||n===E.UL.ManualGrades},La=function(n){var t=n.type,r=n.onDataConverted,a=n.groupSelectDisabled,l=(0,Ne.Z)(),c=l.semester_subject_id,f=l.teacherSubjectData,x=(0,v.useState)(null),_=P()(x,2),S=_[0],M=_[1],T=(0,v.useMemo)(function(){var y;return((y=f==null?void 0:f.groups)!==null&&y!==void 0?y:[]).map(function(F){var k=F.id,D=F.name;return{label:D,value:k}})},[]),p={type:t,group_id:S,semester_subject_id:c},j=(0,v.useCallback)(function(y){if(y.success){var F=y.data.results.filter(function(k){var D=k.user_id;return D!==null});if(!F.length)return;r({exam_results:F,group_id:y.data.group_id})}},[]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ot.ZP.Item,{label:(0,e.jsx)(s.FormattedMessage,{id:"group"}),children:(0,e.jsx)(Pt.default,{disabled:a,value:S,onChange:function(F){return M(F)},options:T,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_group"}),style:{width:"100%"}})}),(0,e.jsx)(Da.Z,{name:"file",url:"/api/admin/exams/parse",onUpload:j,onChange:function(F){return!F.fileList.length&&r(void 0)},maxFiles:1,data:p,disabled:!S})]})},Aa=function(n){var t=n.onDataConverted,r=(0,Ne.Z)(),a=r.teacherSubjectData,l=r.groupUsers,c=(0,v.useState)(null),f=P()(c,2),x=f[0],_=f[1],S=(0,v.useMemo)(function(){var T;return((T=a==null?void 0:a.groups)!==null&&T!==void 0?T:[]).map(function(p){var j=p.id,y=p.name;return{label:y,value:j}})},[]),M=(0,v.useCallback)(function(T){var p;_(T);var j=(p=l.byId)===null||p===void 0?void 0:p[T];if(j){var y=j.users.reduce(function(F,k){var D=k.id,A=k.email,ie=k.first_name,Y=k.last_name,te=k.academic_teacher_id;return te!==null?F:[].concat(I()(F),[{email:A,first_name:ie,last_name:Y,user_id:D,result:null}])},[]);t({group_id:T,exam_results:y})}},[l.byId]);return(0,e.jsx)(Pt.default,{value:x,onChange:M,options:S,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_group"}),style:{width:"100%"}})},At=et()(et()(et()(et()(et()(et()({},E.UL.TestPortal,["/teacher-examples/testPortal.png"]),E.UL.TeamsForms,["/teacher-examples/teamsForms.png"]),E.UL.TeamsLecture,["/teacher-examples/teamsLecture.png","/teacher-examples/teamsLectureWithoutMail.png"]),E.UL.Manual,[]),E.UL.ManualPass,[]),E.UL.ManualGrades,[]),Ra=function(n){var t=n.images,r=(0,v.useState)(!1),a=P()(r,2),l=a[0],c=a[1],f=(0,v.useCallback)(function(){return c(!0)},[]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"see_file_example_image"}),children:(0,e.jsx)(h.ZP,{onClick:f,icon:(0,e.jsx)(wa.Z,{})})}),(0,e.jsx)(aa.Z.PreviewGroup,{preview:{visible:l,onVisibleChange:c},children:t.map(function(x){return(0,e.jsx)(aa.Z,{style:{display:"none"},src:x},x)})})]})},$a=function(n){var t,r=n.type,a=n.onOk,l=n.onCancel,c=n.okDisabled,f=(t=At==null?void 0:At[r])!==null&&t!==void 0?t:At[E.UL.Manual];return(0,e.jsxs)(nt.Z,{style:{width:"100%",justifyContent:f.length?"space-between":"flex-end"},children:[!!f.length&&(0,e.jsx)(Ra,{images:f}),(0,e.jsxs)(nt.Z,{children:[(0,e.jsx)(h.ZP,{onClick:l,children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})}),(0,e.jsx)(h.ZP,{type:"primary",disabled:c,onClick:a,children:(0,e.jsx)(s.FormattedMessage,{id:"ok"})})]})]})},Oa=[E.UL.TeamsLecture,E.UL.TestPortal,E.UL.TeamsForms],Na=function(n){var t=n.open,r=n.closeModal,a=n.onSuccess,l=n.type,c=(0,Ne.Z)(),f=c.teacherSubjectData,x=c.fetchGroupUsers,_=(0,v.useState)(),S=P()(_,2),M=S[0],T=S[1];return(0,v.useEffect)(function(){if(ra(l)&&t){var p;f==null||(p=f.groups)===null||p===void 0||p.forEach(function(j){var y=j.id;return x(y)})}},[l,t]),(0,e.jsxs)(ut.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.".concat(l,"Convert")}),width:"40vw",open:t,onCancel:r,footer:(0,e.jsx)($a,{type:l,onOk:function(){M&&a(M)},onCancel:r,okDisabled:!M}),children:[Oa.includes(l)&&(0,e.jsx)(La,{type:l,onDataConverted:T,groupSelectDisabled:!!M}),ra(l)&&(0,e.jsx)(Aa,{onDataConverted:T,examType:l})]})},Ua=function(n){var t=n.onSelect;return(0,e.jsxs)(ta.Z,{gutter:[16,16],children:[(0,e.jsx)(dt.Z,{span:12,children:(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){return t(E.UL.TeamsForms)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadFile.MsTeamsForms",defaultMessage:"uploadFile.MsTeamsForms"})})}),(0,e.jsx)(dt.Z,{span:12,children:(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){return t(E.UL.TestPortal)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadFile.TestPortal",defaultMessage:"uploadFile.TestPortal"})})}),(0,e.jsx)(dt.Z,{span:12,children:(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){return t(E.UL.TeamsLecture)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadFile.MsTeams",defaultMessage:"uploadFile.MsTeams"})})}),(0,e.jsx)(dt.Z,{span:12,children:(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){return t(E.UL.Manual)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGradesManually",defaultMessage:"uploadGradesManually"})})}),(0,e.jsx)(dt.Z,{span:12,children:(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){return t(E.UL.ManualPass)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGradesManuallyPass",defaultMessage:"uploadGradesManuallyPass"})})}),(0,e.jsx)(dt.Z,{span:12,children:(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){return t(E.UL.ManualGrades)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGradesManuallyGrades",defaultMessage:"uploadGradesManuallyGrades"})})})]})},ka=[{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name"}),dataIndex:"first_name",editable:!1},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name"}),dataIndex:"last_name",editable:!1}],Ba=function(n){var t,r=n.exam_id,a=ot.ZP.useForm(),l=P()(a,1),c=l[0],f=(0,v.useState)(),x=P()(f,2),_=x[0],S=x[1],M=(0,v.useState)(),T=P()(M,2),p=T[0],j=T[1],y=(0,v.useState)(!1),F=P()(y,2),k=F[0],D=F[1],A=(0,Ne.Z)(),ie=A.semester_subject_id,Y=A.getGroupById,te=(0,v.useMemo)(function(){var L;return((L=p==null?void 0:p.exam_results)!==null&&L!==void 0?L:[]).map(function($){var B=$.user_id;return B})},[p==null?void 0:p.exam_results]);(0,v.useEffect)(function(){var L=Number(r);r==="new"&&(S(void 0),j(void 0),c.resetFields()),r!=="new"&&!Number.isNaN(L)&&(D(!0),W(L).then(function($){if($.success){var B=$.data,fe=B.type,ze=B.results,Be=B.title,tt=B.weight,Ye=B.passed_at,Me=B.group_id;S(fe),j({group_id:Me,exam_results:ze}),c.setFieldsValue({title:Be,weight:tt,passed_at:Ye})}}).finally(function(){return D(!1)}))},[r]);var N=(0,v.useCallback)(function(){S(void 0),j(void 0)},[]);return k?(0,e.jsx)(Ge.Z,{}):(0,e.jsxs)(e.Fragment,{children:[_&&(0,e.jsx)(Na,{open:!!(_&&!p),type:_,closeModal:N,onSuccess:j}),(0,e.jsxs)(ot.ZP,{form:c,submitter:_===void 0||!p?!1:void 0,onFinish:function(){var L=i()(d()().mark(function $(B){var fe,ze,Be,tt,Ye,Me,Le,q;return d()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(!(p&&typeof ie=="number")){re.next=16;break}if(fe=B.title,ze=B.passed_at,Be=B.weight,tt=Number(r),Ye=p.exam_results,Me=p.group_id,Le={type:_,semester_subject_id:ie,title:fe,passed_at:ze,weight:Be,group_id:Me,results:Ye},!Number.isNaN(tt)){re.next=11;break}return re.next=8,ke(Le);case 8:re.t0=re.sent,re.next=14;break;case 11:return re.next=13,ge(tt,Le);case 13:re.t0=re.sent;case 14:q=re.t0,q.success&&s.history.push("/teacher/subjects/".concat(ie,"/exams"));case 16:return re.abrupt("return",!0);case 17:case"end":return re.stop()}},$)}));return function($){return L.apply(this,arguments)}}(),onReset:N,children:[(0,e.jsxs)(ot.ZP.Group,{children:[(0,e.jsx)(Ia.Z,{label:(0,e.jsx)(s.FormattedMessage,{id:"examTitle",defaultMessage:"examTitle"}),rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],width:"lg",name:"title"}),(0,e.jsx)(Ga.Z,{label:(0,e.jsx)(s.FormattedMessage,{id:"datePassingExam",defaultMessage:"datePassingExam"}),rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],width:"lg",name:"passed_at"}),_!==E.UL.ManualGrades&&_!==E.UL.ManualPass&&(0,e.jsx)(ot.ZP.Item,{name:"weight",label:(0,e.jsx)(s.FormattedMessage,{id:"examImportance",defaultMessage:"examImportance"}),rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})},{type:"number",min:1,max:100,message:(0,e.jsx)(s.FormattedMessage,{id:"number_between",values:{min:1,max:100}})}],children:(0,e.jsx)(Yt.Z,{})})]}),_&&p&&(0,e.jsx)(ee.ZP,{rowKey:"user_id",headerTitle:(t=Y(p.group_id))===null||t===void 0?void 0:t.name,editable:{type:"single",editableKeys:te,onValuesChange:function($,B){return j({group_id:p.group_id,exam_results:B})}},cardProps:{bodyStyle:{paddingInline:0}},search:!1,dataSource:p.exam_results.sort(function(L,$){return L.last_name.localeCompare($.last_name)}),pagination:{defaultPageSize:lt.Sl},columns:[].concat(ka,[function(){switch(_){case E.UL.ManualPass:return{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",valueType:"select",fieldProps:{options:lt.FW}};case E.UL.ManualGrades:return{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",valueType:"select",fieldProps:{options:lt.BP}};default:return{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",valueType:"percent",formItemProps:{rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})},{type:"number",min:0,max:100,message:(0,e.jsx)(s.FormattedMessage,{id:"number_between",values:{min:0,max:100}})}]}}}}()])}),!p&&(0,e.jsx)(Ua,{onSelect:S})]})]})},Wa=[{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name"}),dataIndex:"first_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name"}),dataIndex:"last_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",hideInSearch:!0}],Ka=function(n){var t=n.exam_id,r=(0,v.useState)(""),a=P()(r,2),l=a[0],c=a[1];return(0,e.jsx)(ee.ZP,{className:"table-standalone",rowKey:"user_id",search:!1,headerTitle:l,pagination:{defaultPageSize:lt.Sl},request:i()(d()().mark(function f(){var x;return d()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,W(t);case 2:if(x=S.sent,!x.success){S.next=6;break}return c(x.data.title),S.abrupt("return",{total:x.data.results.length,success:!0,data:x.data.results});case 6:return S.abrupt("return",[]);case 7:case"end":return S.stop()}},f)})),columns:Wa})},Va=[{title:(0,e.jsx)(s.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",sorter:!0,width:"80px"},{title:(0,e.jsx)(s.FormattedMessage,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!0,sorter:!0},{title:(0,e.jsx)(s.FormattedMessage,{id:"type",defaultMessage:"type"}),dataIndex:"type",sorter:!0,render:function(n,t){return(0,e.jsx)(s.FormattedMessage,{id:"ExamGradeType.".concat(t.type)})}},{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.exam_date",defaultMessage:"Exam date"}),dataIndex:"passed_at",sorter:!0,render:function(n,t){return t.passed_at&&(0,St.WU)(new Date(t.passed_at),pt.GC)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",sorter:!0,render:function(n,t){return t.weight?t.weight+"%":""}},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",sorter:!0,render:function(n,t){return t.created_at&&(0,St.WU)(new Date(t.created_at),pt.GC)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"semester",defaultMessage:"Semester"}),dataIndex:"semester",sorter:!0,render:function(n,t){return(0,e.jsx)(s.FormattedMessage,{id:"SemesterType.".concat(t.semester.type),values:{year:t.semester.year}})}},{title:(0,e.jsx)(s.FormattedMessage,{id:"group",defaultMessage:"Group"}),dataIndex:"group_id",sorter:!0,render:function(n,t){return(0,e.jsx)(Lt.Z,{type:"Students",type_id:t.group_id},t.group_id)}}],Xa=function(){var n,t=(0,v.useRef)(),r=(0,Ne.Z)(),a=r.semester_subject_id,l=(0,s.useLocation)(),c=new URLSearchParams(l.search),f=(n=c.get("exam_id"))!==null&&n!==void 0?n:null,x=c.get("results");return x!==null&&!Number.isNaN(Number(x))?(0,e.jsx)(Ka,{exam_id:Number(x)}):f!==null?(0,e.jsx)(Ba,{exam_id:f}):(0,e.jsx)(ee.ZP,{className:"table-standalone",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),actionRef:t,search:!1,rowKey:"id",pagination:{defaultPageSize:lt.Sl},request:function(){var _=i()(d()().mark(function S(M,T){var p,j,y,F;return d()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(p=M.current,j=M.pageSize,a!==null){D.next=3;break}return D.abrupt("return",{data:[],total:0,success:!1});case 3:return y=T&&Object.entries(T)[0],D.next=6,Se({per_page:j,page:p,semester_subject_id:Number.isNaN(a)?void 0:a,order_by:y&&y[0],order:y&&(y[1]==="ascend"?"ASC":"DESC")});case 6:if(F=D.sent,!F.success){D.next=9;break}return D.abrupt("return",{data:F.data,total:F.meta.total,success:!0});case 9:return D.abrupt("return",{data:[],total:0,success:!1});case 10:case"end":return D.stop()}},S)}));return function(S,M){return _.apply(this,arguments)}}(),columns:[].concat(Va,[{title:(0,e.jsx)(s.FormattedMessage,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(S,M){return[(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(M.semester_subject_id,"/exams?exam_id=").concat(M.id),children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,e.jsx)(h.ZP,{type:"primary",icon:(0,e.jsx)(rt.Z,{})})})},"edit"),(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(M.semester_subject_id,"/exams?results=").concat(M.id),children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.results",defaultMessage:"results"}),children:(0,e.jsx)(h.ZP,{icon:(0,e.jsx)(Za,{})})})},"results"),(0,e.jsx)(ea.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:i()(d()().mark(function T(){var p;return d()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,w(M.id);case 2:p=y.sent,p.success&&t.current&&t.current.reload();case 4:case"end":return y.stop()}},T)})),okText:(0,e.jsx)(s.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(s.FormattedMessage,{id:"no"}),children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(h.ZP,{type:"primary",icon:(0,e.jsx)(qt.Z,{}),danger:!0})})},"delete")]}}])})},za=u(69753),na=u(44167),Ha=u(84665),Ya=["type","defaultRender"],Ja=["type","defaultRender"],Qa=function(n){var t=n.url;return(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"download"}),children:(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){window.open(t,"_blank","noopener noreferrer")},icon:(0,e.jsx)(za.Z,{})})})},qa=[{title:(0,e.jsx)(s.FormattedMessage,{id:"ID"}),dataIndex:"id",hideInSearch:!0},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_at"}),dataIndex:"created_at",hideInSearch:!0,render:function(n,t){return(0,St.WU)(new Date(t.created_at),pt.Cu)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_by"}),dataIndex:"created_by",renderFormItem:function(n,t,r){var a=t.type,l=t.defaultRender,c=Et()(t,Ya);if(a==="form")return null;var f=r.getFieldValue("state");return(0,e.jsx)(na.Z,m()(m()({},c),{},{state:{type:f}}))},render:function(n,t){var r,a;return(0,e.jsx)(Lt.Z,{type:"EscolaLms\\Core\\Models\\User",type_id:t.created_by.id,text:t!=null&&(r=t.created_by)!==null&&r!==void 0&&r.first_name&&t!==null&&t!==void 0&&(a=t.created_by)!==null&&a!==void 0&&a.last_name?"".concat(t.created_by.first_name," ").concat(t.created_by.last_name):void 0},t.created_by.id)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"exported_at"}),dataIndex:"exported_at",hideInSearch:!0,render:function(n,t){return(0,St.WU)(new Date(t.exported_at),pt.Cu)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"exported_by"}),dataIndex:"exported_by",renderFormItem:function(n,t,r){var a=t.type,l=t.defaultRender,c=Et()(t,Ja);if(a==="form")return null;var f=r.getFieldValue("state");return(0,e.jsx)(na.Z,m()(m()({},c),{},{state:{type:f}}))},render:function(n,t){var r,a;return(0,e.jsx)(Lt.Z,{type:"EscolaLms\\Core\\Models\\User",type_id:t.exported_by.id,text:t!=null&&(r=t.exported_by)!==null&&r!==void 0&&r.first_name&&t!==null&&t!==void 0&&(a=t.exported_by)!==null&&a!==void 0&&a.last_name?"".concat(t.exported_by.first_name," ").concat(t.exported_by.last_name):void 0},t.exported_by.id)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"version"}),dataIndex:"version",hideInSearch:!0},{title:(0,e.jsx)(s.FormattedMessage,{id:"options"}),valueType:"option",render:function(n,t){return[(0,e.jsx)(Qa,{url:t.url},"download")]}}],er=function(){var n,t=(0,Ne.Z)(),r=t.teacherSubjectData,a=(0,v.useMemo)(function(){var c;return((c=r==null?void 0:r.groups)!==null&&c!==void 0?c:[]).map(function(f){var x=f.id,_=f.name;return{value:x,label:_}})},[r==null?void 0:r.groups]),l=(0,v.useMemo)(function(){var c;return[{title:(0,e.jsx)(s.FormattedMessage,{id:"group"}),dataIndex:"group_id",hideInTable:!0,valueType:"select",fieldProps:{options:a,defaultValue:r==null||(c=r.groups)===null||c===void 0||(c=c[0])===null||c===void 0?void 0:c.id,allowClear:!1}}].concat(qa)},[r==null||(n=r.groups)===null||n===void 0||(n=n[0])===null||n===void 0?void 0:n.id,a]);return(0,e.jsx)(ee.ZP,{className:"table-standalone",request:function(){var c=i()(d()().mark(function f(x){var _,S,M,T,p,j;return d()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return S=x.group_id,M=S===void 0?r==null||(_=r.groups)===null||_===void 0||(_=_[0])===null||_===void 0?void 0:_.id:S,T=x.created_by,p=x.exported_by,F.next=3,(0,Ha.v)({group_id:M,created_by:T,exported_by:p});case 3:if(j=F.sent,j.success){F.next=6;break}return F.abrupt("return",{success:!1,data:[],total:0});case 6:return F.abrupt("return",{success:!0,data:j.data,total:j.data.length});case 7:case"end":return F.stop()}},f)}));return function(f){return c.apply(this,arguments)}}(),columns:l,search:{layout:"vertical"},scroll:{x:1500},pagination:{defaultPageSize:lt.Sl}})},sa=u(64317),Nt=u(96074),ia=u(11312),tr=u(87366),Ut=u(99100),ar=["attendances"];function rr(o){return function(t){o(function(r){return m()(m()({},r),{},{loading:t})})}}function ua(o,n){return kt.apply(this,arguments)}function kt(){return kt=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n(!0),a.prev=1,a.abrupt("return",t());case 3:return a.prev=3,n(!1),a.finish(3);case 6:case"end":return a.stop()}},o,null,[[1,,3,6]])})),kt.apply(this,arguments)}function nr(o,n){var t=(0,v.useState)({loading:!1}),r=P()(t,2),a=r[0],l=r[1],c=(0,v.useCallback)(rr(l),[]),f=(0,v.useCallback)(i()(d()().mark(function _(){var S;return d()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,Gt(o,n);case 2:if(S=T.sent,S.success){T.next=5;break}return T.abrupt("return",S);case 5:return l(function(p){return m()(m()({},p),{},{data:S.data})}),T.abrupt("return",S);case 7:case"end":return T.stop()}},_)})),[n,o]),x=(0,v.useCallback)(function(_){return ua(c,function(){return he(_).then(f)})},[f]);return(0,v.useEffect)(function(){ua(c,f)},[f]),{finalGrades:a,deleteFinalGrade:x}}function sr(){var o=(0,v.useState)({loading:!1}),n=P()(o,2),t=n[0],r=n[1];return(0,v.useEffect)(function(){r(function(a){return m()(m()({},a),{},{loading:!0})}),J().then(function(a){a.success&&r(function(l){return m()(m()({},l),{},{data:a.data})})}).finally(function(){r(function(a){return m()(m()({},a),{},{loading:!1})})})},[]),{gradeTerms:t}}function ir(o){var n=(0,v.useState)({loading:!1}),t=P()(n,2),r=t[0],a=t[1];return(0,v.useEffect)(function(){o!==void 0&&(a(function(l){return m()(m()({},l),{},{loading:!0})}),V(o).then(function(l){l.success&&a(function(c){return m()(m()({},c),{},{data:l.data})})}).finally(function(){a(function(l){return m()(m()({},l),{},{loading:!1})})}))},[o]),{subjectGradeScales:r}}function ur(o,n,t){var r=(0,v.useState)({loading:!1}),a=P()(r,2),l=a[0],c=a[1];return(0,v.useEffect)(function(){typeof o!="number"||typeof n!="number"||typeof t!="number"||(c(function(f){return m()(m()({},f),{},{loading:!0})}),_t(o,n).then(function(f){f.success&&c(function(x){var _,S;return m()(m()({},x),{},{data:(_=Xt(t,(S=f.data.grade_scale)!==null&&S!==void 0?S:[]))===null||_===void 0?void 0:_.map(function(M,T){return m()(m()({},M),{},{id:T})})})})}).finally(function(){c(function(f){return m()(m()({},f),{},{loading:!1})})}))},[o,n]),{tutorGradeScales:l}}function or(o,n){var t=(0,v.useState)({loading:!1}),r=P()(t,2),a=r[0],l=r[1],c=(0,v.useCallback)(function(){l(function(f){return m()(m()({},f),{},{loading:!0})}),ve(o).then(function(f){if(f.success){var x=f.data.reduce(function(_,S){var M=S.attendances,T=Et()(S,ar),p=M.find(function(j){return j.user_id===n});return p?[].concat(I()(_),[m()(m()({},T),{},{attendance:p})]):_},[]);l(function(_){return m()(m()({},_),{},{data:x})})}}).finally(function(){l(function(f){return m()(m()({},f),{},{loading:!1})})})},[o,n]);return(0,v.useEffect)(function(){c()},[c]),{userAttendanceSchedules:a,fetchUserAttendanceSchedules:c}}function lr(o,n){var t=(0,v.useState)({loading:!1}),r=P()(t,2),a=r[0],l=r[1];return(0,v.useEffect)(function(){n&&(l(function(c){return m()(m()({},c),{},{loading:!0})}),Se({student_id:o,semester_subject_id:n}).then(function(c){if(c.success){var f=Kt(c.data,o);l(function(x){return m()(m()({},x),{},{data:f})})}}).finally(function(){l(function(c){return m()(m()({},c),{},{loading:!1})})}))},[o,n]),{studentExams:a}}function dr(o,n){var t=(0,v.useState)({loading:!1}),r=P()(t,2),a=r[0],l=r[1],c=(0,v.useState)({loading:!1}),f=P()(c,2),x=f[0],_=f[1],S=(0,v.useState)({loading:!1}),M=P()(S,2),T=M[0],p=M[1];return(0,v.useEffect)(function(){l(function(j){return m()(m()({},j),{},{loading:!0})}),(0,Ut.N7)({group_id:o}).then(function(j){j.success&&l(function(y){return m()(m()({},y),{},{data:j.data})})}).finally(function(){l(function(j){return m()(m()({},j),{},{loading:!1})})})},[o]),(0,v.useEffect)(function(){a.data&&(p(function(j){return m()(m()({},j),{},{loading:!0})}),Promise.all(a.data.map(function(j){var y=j.id;return(0,Ut.Nx)(Number(y))})).then(function(j){j.forEach(function(y){y.success&&p(function(F){return m()(m()({},F),{},{data:m()(m()({},F.data),{},et()({},Number(y.data.id),(0,tr.uS)(y.data.lessons)))})})})}).finally(function(){p(function(j){return m()(m()({},j),{},{loading:!1})})}),_(function(j){return m()(m()({},j),{},{loading:!0})}),Promise.all(a.data.map(function(j){var y=j.id;return(0,Ut.ue)(Number(y),["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics","EscolaLms\\Reports\\Stats\\Course\\AttendanceList"]).then(function(F){if(F.success){var k,D,A=((k=F.data["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics"])!==null&&k!==void 0?k:[]).filter(function(Y){return Y.id===n}),ie=(D=F.data["EscolaLms\\Reports\\Stats\\Course\\AttendanceList"])!==null&&D!==void 0?D:[];_(function(Y){return m()(m()({},Y),{},{data:m()(m()({},Y.data),{},et()({},Number(y),{finishedTopics:A,attendanceList:ie}))})})}})})).finally(function(){return _(function(j){return m()(m()({},j),{},{loading:!1})})}))},[a.data,n]),{userCourses:a,userCoursesStats:x,userCoursesTopics:T}}var cr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"grade"},{title:(0,e.jsx)(s.FormattedMessage,{id:"degree"}),dataIndex:"name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent"}],mr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"date"}),dataIndex:"date_from",render:function(n,t){return(0,St.WU)(new Date(t.date_from),pt.GC)}}],fr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"name"}),dataIndex:"title"},{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",valueType:"percent"},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",render:function(n,t){return(0,St.WU)(new Date(t.created_at),pt.GC)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"result",render:function(n,t){return"".concat(t.result.result," ").concat(t.weight?"%":"")}}],vr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"name"}),dataIndex:"name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"issued_at"}),dataIndex:"grade",render:function(n,t){var r,a;return(r=t.grade)!==null&&r!==void 0&&r.grade_date?(0,St.WU)(new Date((a=t.grade)===null||a===void 0?void 0:a.grade_date),pt.GC):"-"}},{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"grade",render:function(n,t){var r,a;return(r=(a=t.grade)===null||a===void 0?void 0:a.grade_name)!==null&&r!==void 0?r:"-"}}],Rt=6,pr=function(n){var t,r,a,l,c=n.user_id,f=n.group_id,x=(0,Ne.Z)(),_=x.semester_subject_id,S=lr(c,_),M=S.studentExams,T=nr(f,c),p=T.finalGrades,j=T.deleteFinalGrade,y=sr(),F=y.gradeTerms,k=ir((t=p.data)===null||t===void 0?void 0:t.s_subject_scale_form_id),D=k.subjectGradeScales,A=ur(_,(r=p.data)===null||r===void 0?void 0:r.tutor_id,(a=p.data)===null||a===void 0?void 0:a.s_subject_scale_form_id),ie=A.tutorGradeScales,Y=or(f,c),te=Y.userAttendanceSchedules,N=Y.fetchUserAttendanceSchedules,L=dr(f,c),$=L.userCourses,B=L.userCoursesStats,fe=L.userCoursesTopics,ze=ot.ZP.useForm(),Be=P()(ze,1),tt=Be[0],Ye=(0,v.useMemo)(function(){var Ce;return((Ce=F.data)!==null&&Ce!==void 0?Ce:[]).map(function(Ze){var Ie=Ze.id,Ue=Ze.name;return{label:Ue,value:Ie}})},[F.data]),Me=(0,v.useMemo)(function(){var Ce;return((Ce=D.data)!==null&&Ce!==void 0?Ce:[]).map(function(Ze){var Ie=Ze.name,Ue=Ze.id;return{label:Ie,value:Ue}})},[D.data]),Le=(0,v.useMemo)(function(){var Ce,Ze;return Vt((Ce=M.data)!==null&&Ce!==void 0?Ce:[],(Ze=ie.data)!==null&&Ze!==void 0?Ze:[])},[M.data,ie.data]),q=(0,v.useCallback)(function(){var Ce=i()(d()().mark(function Ze(Ie){var Ue,Je,mt,ft,$e,st,it;return d()().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:if(mt=Ie.grade_scale_id,ft=Ie.grade_term_id,((Ue=p.data)===null||Ue===void 0?void 0:Ue.id)!==void 0){at.next=3;break}return at.abrupt("return");case 3:if($e=(Je=p.data)===null||Je===void 0?void 0:Je.grades.find(function(wt){var Zt=wt.grade_term;return Zt.id===ft}),!$e){at.next=11;break}return at.next=7,z($e.id,{grade_scale_id:mt});case 7:return st=at.sent,we.ZP[st.success?"success":"error"](st.message),st.success&&s.history.push("/teacher/subjects/".concat(_,"/final-grades")),at.abrupt("return");case 11:return at.next=13,G({grade_scale_id:mt,grade_term_id:ft,lesson_group_user_id:p.data.id});case 13:it=at.sent,we.ZP[it.success?"success":"error"](it.message),it.success&&s.history.push("/teacher/subjects/".concat(_,"/final-grades"));case 16:case"end":return at.stop()}},Ze)}));return function(Ze){return Ce.apply(this,arguments)}}(),[p.data,_]),_e=(0,v.useMemo)(function(){return[].concat(vr,[{title:(0,e.jsx)(s.FormattedMessage,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",render:function(Ze,Ie){var Ue;return typeof(Ie==null||(Ue=Ie.grade)===null||Ue===void 0?void 0:Ue.id)=="number"?[(0,e.jsx)(ea.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:function(){return j(Ie.grade.id)},okText:(0,e.jsx)(s.FormattedMessage,{id:"yes",defaultMessage:"Yes"}),cancelText:(0,e.jsx)(s.FormattedMessage,{id:"no",defaultMessage:"No"}),children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(h.ZP,{type:"primary",icon:(0,e.jsx)(qt.Z,{}),danger:!0})})},"delete")]:[]}}])},[]),re=(0,v.useMemo)(function(){var Ce;return((Ce=F.data)!==null&&Ce!==void 0?Ce:[]).map(function(Ze){var Ie;return m()(m()({},Ze),{},{grade:(Ie=p.data)===null||Ie===void 0?void 0:Ie.grades.find(function(Ue){var Je=Ue.grade_term;return Je.id===Ze.id})})})},[p.data,F.data]),We=$.loading&&!$.data||B.loading&&!B.data||fe.loading&&!fe.data,Pe=!!($.data&&B.data&&fe.data);return p.loading?(0,e.jsx)(Ge.Z,{}):(0,e.jsxs)(e.Fragment,{children:[p.data&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(se.Z.Text,{style:{fontSize:"16px",fontWeight:500},children:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.Student",values:p.data.user})}),(0,e.jsx)(Nt.Z,{})]}),(0,e.jsxs)(ta.Z,{gutter:[48,48],justify:"space-between",children:[(0,e.jsx)(dt.Z,{span:12,children:(0,e.jsx)(ee.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.StudentPartialGrades"}),search:!1,pagination:{pageSize:Rt},dataSource:M.data,loading:M.loading,columns:fr,options:!1,cardProps:{bodyStyle:{padding:0}}})}),(0,e.jsx)(dt.Z,{span:12,children:(0,e.jsx)(ee.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.FinalGrades"}),search:!1,pagination:{pageSize:Rt},dataSource:re,loading:p.loading||F.loading,columns:_e,options:!1,cardProps:{bodyStyle:{padding:0}}})}),(0,e.jsx)(dt.Z,{span:12,children:(0,e.jsx)(ee.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.Attendances"}),search:!1,options:!1,pagination:{pageSize:Rt},cardProps:{bodyStyle:{padding:0}},dataSource:te.data,loading:te.loading,columns:[].concat(mr,[{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.Attendance"}),dataIndex:"attendance",render:function(Ze,Ie){return(0,e.jsx)(Ht,{groupAttendanceScheduleId:Ie.id,studentId:c,attendance:Ie.attendance.value,onSuccess:N})}}])})}),(0,e.jsx)(dt.Z,{span:12,children:(0,e.jsx)(ee.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.GradesScale"}),search:!1,options:!1,pagination:{pageSize:Rt},cardProps:{bodyStyle:{padding:0}},dataSource:ie.data,loading:ie.loading,columns:cr})}),We&&(0,e.jsx)(Ge.Z,{}),Pe&&((l=$.data)===null||l===void 0?void 0:l.map(function(Ce){var Ze,Ie,Ue,Je,mt,ft,$e=Ce.id,st=Ce.title;return(0,e.jsxs)(dt.Z,{span:24,children:[(0,e.jsx)(se.Z.Text,{style:{fontSize:"16px",fontWeight:500},children:st}),(0,e.jsx)(ia.Du,{course_id:Number($e),topics:(Ze=(Ie=fe.data)===null||Ie===void 0?void 0:Ie[Number($e)])!==null&&Ze!==void 0?Ze:[],stats:(Ue=(Je=B.data)===null||Je===void 0||(Je=Je[Number($e)])===null||Je===void 0?void 0:Je.finishedTopics)!==null&&Ue!==void 0?Ue:[]}),(0,e.jsx)(ia.nu,{stats:(mt=(ft=B.data)===null||ft===void 0||(ft=ft[Number($e)])===null||ft===void 0?void 0:ft.attendanceList)!==null&&mt!==void 0?mt:[]})]},$e)}))]}),(0,e.jsx)(ot.ZP,{form:tt,onFinish:q,children:(0,e.jsxs)(ot.ZP.Group,{style:{display:"flex",flexDirection:"column",paddingTop:"48px"},title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.IssueAssessment"}),titleStyle:{flex:"unset"},align:"center",children:[(0,e.jsx)(sa.Z,{name:"grade_term_id",rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],label:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.GradeTerm"}),options:Ye,width:"sm",fieldProps:{loading:F.loading}}),(0,e.jsx)(sa.Z,{name:"grade_scale_id",rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],label:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.FinalGrade"}),options:Me,fieldProps:{loading:p.loading||D.loading}}),(0,e.jsx)(ot.ZP.Item,{children:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.ProposedGrade",values:{grade:Le}})})]})})]})},gr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name"}),dataIndex:"first_name",render:function(n,t){return t.user.first_name}},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name"}),dataIndex:"last_name",render:function(n,t){return t.user.last_name}},{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),hideInSearch:!0,dataIndex:"grades",render:function(n,t){return(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:t.grades.length?t.grades.map(function(r){var a=r.grade_name,l=r.grade_term,c=r.id;return(0,e.jsxs)(se.Z.Text,{children:[l.name,": ",a]},c)}):"-"})}}],hr=function(){var n,t,r=(0,s.useLocation)(),a=new URLSearchParams(r.search),l=(n=a.get("user_id"))!==null&&n!==void 0?n:null,c=(t=a.get("group_id"))!==null&&t!==void 0?t:null,f=(0,Ne.Z)(),x=f.teacherSubjectData,_=f.semester_subject_id,S=(0,v.useMemo)(function(){var M;return((M=x==null?void 0:x.groups)!==null&&M!==void 0?M:[]).map(function(T){var p=T.id,j=T.name;return{label:j,value:p}})},[x==null?void 0:x.groups]);return l!==null&&c!==null?(0,e.jsx)(pr,{user_id:Number(l),group_id:Number(c)}):(0,e.jsx)(ee.ZP,{className:"table-standalone",rowKey:"id",search:{layout:"vertical"},pagination:{defaultPageSize:lt.Sl},request:function(){var M=i()(d()().mark(function T(p){var j,y,F,k,D,A,ie,Y,te,N;return d()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return y=p.group_id,F=y===void 0?[]:y,k=p.first_name,D=k===void 0?"":k,A=p.last_name,ie=A===void 0?"":A,Y=((j=x==null?void 0:x.groups)!==null&&j!==void 0?j:[]).map(function(B){var fe=B.id;return fe}),$.next=4,Ft(F.length===0?Y:F);case 4:if(te=$.sent,te.success){$.next=7;break}return $.abrupt("return",{success:!1,total:0,data:[]});case 7:return N=te.data.filter(function(B){var fe=B.user;return fe.first_name.toLowerCase().includes(D.toLowerCase())&&fe.last_name.toLowerCase().includes(ie.toLowerCase())}),$.abrupt("return",{success:!0,total:N.length,data:N});case 9:case"end":return $.stop()}},T)}));return function(T){return M.apply(this,arguments)}}(),columns:[{title:(0,e.jsx)(s.FormattedMessage,{id:"group"}),dataIndex:"group_id",valueType:"select",fieldProps:{options:S,mode:"multiple"},render:function(T,p){return(0,e.jsx)(Lt.Z,{type:"Students",type_id:p.group_id},p.group_id)}}].concat(gr,[{title:(0,e.jsx)(s.FormattedMessage,{id:"options"}),hideInSearch:!0,render:function(T,p){return[(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(_,"/final-grades?user_id=").concat(p.user.id,"&group_id=").concat(p.group_id),children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"edit"}),children:(0,e.jsx)(h.ZP,{type:"primary",icon:(0,e.jsx)(rt.Z,{})})})},"edit")]}}])})},xr=u(88284),jr=u(88280),_r=[{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"grade",editable:!1},{title:(0,e.jsx)(s.FormattedMessage,{id:"degree"}),dataIndex:"name",editable:!1},{title:(0,e.jsx)(s.FormattedMessage,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent",formItemProps:{rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})},{type:"number",min:0,max:100,message:(0,e.jsx)(s.FormattedMessage,{id:"number_between",values:{min:0,max:100}})}]}}],br=function(n){var t=n.subjectTutorGradeScale,r=n.onFormSubmit,a=(0,v.useState)([]),l=P()(a,2),c=l[0],f=l[1],x=(0,v.useRef)(),_=ot.ZP.useForm(),S=P()(_,1),M=S[0];return(0,v.useEffect)(function(){var T,p=((T=t.scale)!==null&&T!==void 0?T:[]).map(function(j,y){return m()(m()({},j),{},{id:String((y+1)*100)})});M.setFieldValue("table",p)},[]),(0,e.jsx)(ot.ZP,{form:M,onFinish:r,submitter:{render:function(p,j){var y=P()(j,2),F=y[1];return[F]}},children:(0,e.jsx)(jr.Z,{name:"table",rowKey:"id",actionRef:x,formItemProps:{label:(0,e.jsx)(s.FormattedMessage,{id:"grades-scale"})},cardProps:{bodyStyle:{padding:0}},recordCreatorProps:!1,columns:[].concat(_r,[{title:(0,e.jsx)(s.FormattedMessage,{id:"options"}),valueType:"option",render:function(p,j){return(0,e.jsx)(h.ZP,{type:"primary",onClick:function(){var F;return(F=x.current)===null||F===void 0?void 0:F.startEditable(j.id)},icon:(0,e.jsx)(rt.Z,{})})}}]),editable:{form:M,type:"multiple",editableKeys:c,saveText:(0,e.jsx)(h.ZP,{type:"primary",icon:(0,e.jsx)(xr.Z,{})}),onChange:f,actionRender:function(p,j,y){return[y.save]}}})})},Sr=function(){var n,t,r=(0,s.useModel)("@@initialState"),a=r.initialState,l=(0,Ne.Z)(),c=l.semester_subject_id,f=l.tutors,x=(0,v.useState)(),_=P()(x,2),S=_[0],M=_[1],T=(0,v.useState)(!1),p=P()(T,2),j=p[0],y=p[1],F=(0,v.useState)(null),k=P()(F,2),D=k[0],A=k[1],ie=(0,v.useMemo)(function(){return!!f.data.find(function(L){var $,B=L.id;return B===(a==null||($=a.currentUser)===null||$===void 0?void 0:$.id)})},[f.data,a==null||(n=a.currentUser)===null||n===void 0?void 0:n.id]),Y=(0,v.useMemo)(function(){return f.data.map(function(L){var $=L.id,B=L.first_name,fe=L.last_name;return{label:"".concat(B," ").concat(fe),value:$}})},[f.data]),te=(0,v.useCallback)(function(){c===null||D===null||(y(!0),M(void 0),_t(c,D).then(function(L){L.success&&M(L.data)}).finally(function(){y(!1)}))},[c,D]),N=(0,v.useCallback)(function(L,$){return function(){var B=i()(d()().mark(function fe(ze){var Be,tt;return d()().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:if(!(c===null||D===null)){Me.next=2;break}return Me.abrupt("return");case 2:return Be=L.reduce(function(Le,q){return q.s_subject_scale_form_id===$?[].concat(I()(Le),[{s_subject_scale_form_id:$,scale:ze.table.map(function(_e){var re=_e.name,We=_e.grade,Pe=_e.grade_value;return{name:re,grade:We,grade_value:Pe}})}]):[].concat(I()(Le),[q])},[]),Me.next=5,It(c,D,{grade_scale:Be});case 5:tt=Me.sent,tt.success&&te();case 7:case"end":return Me.stop()}},fe)}));return function(fe){return B.apply(this,arguments)}}()},[D,c]);return(0,v.useEffect)(function(){var L,$;if(!ie||!(a!=null&&(L=a.currentUser)!==null&&L!==void 0&&L.id)){var B;if((B=f.data)!==null&&B!==void 0&&B[0]){var fe;A((fe=f.data)===null||fe===void 0?void 0:fe[0].id)}return}A(a==null||($=a.currentUser)===null||$===void 0?void 0:$.id)},[a==null||(t=a.currentUser)===null||t===void 0?void 0:t.id,ie]),(0,v.useEffect)(function(){te()},[te]),f.loading?(0,e.jsx)(Ge.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ot.ZP.Item,{label:(0,e.jsx)(s.FormattedMessage,{id:"menu.Teacher"}),children:(0,e.jsx)(Pt.default,{disabled:ie,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select"}),options:Y,value:D,onChange:function($){return A($)}})}),(0,e.jsx)(Nt.Z,{}),j&&!S&&(0,e.jsx)(Ge.Z,{}),S!=null&&S.grade_scale?S.grade_scale.map(function(L,$){var B;return(0,e.jsxs)(v.Fragment,{children:[$>0&&(0,e.jsx)(Nt.Z,{}),(0,e.jsx)(br,{subjectTutorGradeScale:L,onFormSubmit:N((B=S.grade_scale)!==null&&B!==void 0?B:[],L.s_subject_scale_form_id)})]},L.s_subject_scale_form_id)}):(0,e.jsx)(se.Z.Paragraph,{style:{textAlign:"center"},children:(0,e.jsx)(s.FormattedMessage,{id:"gradesScalesMissing"})})]})},yr=u(30814),Mr=u(40411),Cr=u(31156),Tr=u(27484),ct=u.n(Tr);function Fr(o,n){return Bt.apply(this,arguments)}function Bt(){return Bt=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/schedules",m()({params:n,method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},o)})),Bt.apply(this,arguments)}var Er=function(){var n=(0,v.useState)(null),t=P()(n,2),r=t[0],a=t[1],l=(0,v.useState)([]),c=P()(l,2),f=c[0],x=c[1],_=(0,Ne.Z)(),S=_.semester_subject_id,M=ct()(),T=(0,v.useMemo)(function(){return f.map(function(A){return{id:A.id,title:"".concat(A.group.name," (").concat(A.term_status.name,")"),start:ct()(A.date_from).toDate(),end:ct()(A.date_to).toDate(),tutor_name:"".concat(A.tutor.first_name," ").concat(A.tutor.last_name),tutor_email:A.tutor.email,semester:A.semester.name,group:A.group.name,subject:A.subject.name,ms_teams_join_url:A.ms_teams_join_url}})},[f]),p=(0,v.useCallback)(function(A,ie){Fr({semester_subject_id:S,date_form:A.toDate(),date_to:ie.toDate()}).then(function(Y){Y.success&&x(Y.data)})},[S]),j=(0,v.useCallback)(function(A){a(A)},[]),y=(0,v.useCallback)(function(){a(null)},[]),F=(0,v.useCallback)(function(A){return A.isSame(M,"day")?"warning":A.isAfter(M,"day")?"success":"error"},[]),k=(0,v.useCallback)(function(A){var ie=T.filter(function(Y){return ct()(Y.start).isSame(A,"day")});return(0,e.jsx)("ul",{className:"events",children:ie.map(function(Y){return(0,e.jsx)("li",{onClick:function(){return j(Y)},children:(0,e.jsx)(Mr.Z,{status:F(ct()(Y.start)),text:Y.title})},Y.id)})})},[f]),D=(0,v.useCallback)(function(A,ie){var Y=ct()(A).startOf(ie).subtract(1,"month"),te=ct()(A).endOf(ie).add(1,"month");p(Y,te)},[]);return(0,v.useEffect)(function(){var A=ct()().startOf("month"),ie=ct()().endOf("month");p(A,ie)},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(se.Z.Title,{level:4,children:(0,e.jsx)(s.FormattedMessage,{id:"schedule",defaultMessage:"Schedule"})}),(0,e.jsx)(Cr.Z,{dateCellRender:k,onPanelChange:D}),(0,e.jsxs)(ut.Z,{open:r!==null,title:"".concat(r==null?void 0:r.subject,": ").concat(r==null?void 0:r.title),onCancel:y,footer:null,children:[(0,e.jsxs)(se.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"tutorName",defaultMessage:"Tutor"}),": ",r==null?void 0:r.tutor_name]}),(0,e.jsxs)(se.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"email",defaultMessage:"Email"}),": ",r==null?void 0:r.tutor_email]}),(0,e.jsxs)(se.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"group",defaultMessage:"Group"}),": ",r==null?void 0:r.group]}),(0,e.jsxs)(se.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"semester",defaultMessage:"Semester"}),": ",r==null?void 0:r.semester]}),(0,e.jsxs)(se.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"started_at",defaultMessage:"Start date"}),":",r&&ct()(r.start).format(pt.E)]}),(0,e.jsxs)(se.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"end_at",defaultMessage:"End date"}),":",r&&ct()(r.end).format(pt.E)]}),(r==null?void 0:r.ms_teams_join_url)&&(0,e.jsx)(se.Z.Paragraph,{children:(0,e.jsx)("a",{href:r.ms_teams_join_url,target:"_blank",rel:"noreferrer",children:(0,e.jsx)(h.ZP,{type:"primary",children:(0,e.jsx)(s.FormattedMessage,{id:"msTeams"})})},"teamsLink")})]})]})},Pr=u(58638);function Zr(o,n){return Wt.apply(this,arguments)}function Wt(){return Wt=i()(d()().mark(function o(n,t){return d()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/chats/ms-teams",m()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return a.stop()}},o)})),Wt.apply(this,arguments)}var Ir=function(n){var t=n.student_id,r=(0,v.useState)(!1),a=P()(r,2),l=a[0],c=a[1],f=(0,v.useCallback)(i()(d()().mark(function x(){var _;return d()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return c(!0),M.next=3,Zr({user_id:t});case 3:if(_=M.sent,_.success){M.next=8;break}return we.ZP.error(_.message),c(!1),M.abrupt("return");case 8:window.open(_.data.web_url,"_blank","noopener noreferrer"),c(!1);case 10:case"end":return M.stop()}},x)})),[]);return(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"msTeams",defaultMessage:"teams"}),children:(0,e.jsx)(h.ZP,{loading:l,type:"primary",icon:(0,e.jsx)(Pr.Z,{}),onClick:f})})},Gr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"user_id",hideInSearch:!0,width:"80px"},{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name",defaultMessage:"First name"}),dataIndex:"first_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name",defaultMessage:"Last name"}),dataIndex:"last_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"email",defaultMessage:"email"}),dataIndex:"email"},{title:(0,e.jsx)(s.FormattedMessage,{id:"groupName",defaultMessage:"Group name"}),dataIndex:"group_name",hideInSearch:!0}],wr=function(n){return n.map(function(t){var r=t.id,a=t.name;return{label:a,value:r}})},Dr=function(n){return n.reduce(function(t,r){var a,l=r==null||(a=r.users)===null||a===void 0?void 0:a.reduce(function(c,f){return f.academic_teacher_id!==null?c:[].concat(I()(c),[{group_id:r.id,group_name:r.name,user_id:f.id,first_name:f.first_name,last_name:f.last_name,email:f.email}])},[]);return[].concat(I()(t),I()(l))},[])},Lr=function(){var n=(0,Ne.Z)(),t=n.teacherSubjectData,r=(0,v.useMemo)(function(){var a;return wr((a=t==null?void 0:t.groups)!==null&&a!==void 0?a:[])},[t==null?void 0:t.groups]);return(0,e.jsx)(ee.ZP,{className:"table-standalone",rowKey:function(l){return"".concat(l.group_id,"-").concat(l.user_id)},search:{layout:"vertical"},pagination:{defaultPageSize:lt.Sl},request:function(){var a=i()(d()().mark(function l(c){var f,x,_,S,M,T,p,j,y;return d()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return f=c.groups,x=c.first_name,_=x===void 0?"":x,S=c.last_name,M=S===void 0?"":S,T=c.email,p=T===void 0?"":T,k.next=3,(0,Xe.Z)({parent_id:t==null?void 0:t.group_id,"id[]":f});case 3:if(j=k.sent,j.success){k.next=6;break}return k.abrupt("return",{data:[],total:0,success:!1});case 6:return y=Dr(j.data).filter(function(D){return D.first_name.toLowerCase().includes(_.toLowerCase())&&D.last_name.toLowerCase().includes(M.toLowerCase())&&D.email.toLowerCase().includes(p.toLowerCase())}),k.abrupt("return",{data:y,total:y.length,success:!0});case 8:case"end":return k.stop()}},l)}));return function(l){return a.apply(this,arguments)}}(),columns:[{title:(0,e.jsx)(s.FormattedMessage,{id:"groups",defaultMessage:"Groups"}),dataIndex:"groups",hideInTable:!0,filterMultiple:!0,valueType:"select",fieldProps:{options:r,mode:"multiple"}}].concat(Gr,[{hideInSearch:!0,title:(0,e.jsx)(s.FormattedMessage,{id:"msTeams"}),dataIndex:"teamsLink",valueType:"option",render:function(l,c){return[(0,e.jsx)(Ir,{student_id:c.user_id},"teamsChat")]}}])})},Ar=function(n){var t,r,a=n.tab,l=(0,s.useIntl)(),c=(0,s.useModel)("@@initialState"),f=c.setInitialState,x=c.initialState,_=(0,Ne.Z)(),S=_.teacherSubjectData,M=_.semester_subject_id,T=_.tutors,p=(0,v.useCallback)((0,Te.X)(x==null?void 0:x.currentUser),[x==null?void 0:x.currentUser]),j=(0,v.useMemo)(function(){return!!T.data.find(function(y){var F,k=y.id;return k===(x==null||(F=x.currentUser)===null||F===void 0?void 0:F.id)})||p(Ve.Z.TeacherListGradeScale)},[]);return S?(0,e.jsx)(K._z,{title:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.FormattedMessage,{id:S==null||(t=S.subject)===null||t===void 0?void 0:t.name}),", ",(0,e.jsx)(s.FormattedMessage,{id:a})]}),tabBarExtraContent:(0,e.jsx)("div",{style:{display:"flex",padding:"12px",gap:"12px"},children:(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(M,"/exams?exam_id=new"),children:(0,e.jsx)(h.ZP,{type:"primary",children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGrades",defaultMessage:"uploadGrades"})})})}),header:{breadcrumb:{routes:[{path:"teacher",breadcrumbName:l.formatMessage({id:"menu.Teacher"})},{path:"subjects",breadcrumbName:l.formatMessage({id:"menu.Teacher.Subjects"})},{path:String(M),breadcrumbName:String((r=S.subject)===null||r===void 0?void 0:r.name)},{path:String(a),breadcrumbName:l.formatMessage({id:a,defaultMessage:String(a)})}]}},children:(0,e.jsxs)(je.ZP,{bodyStyle:{padding:"24px"},tabs:{type:"card",activeKey:a,onChange:function(F){f(m()({},x)),s.history.push("/teacher/subjects/".concat(M,"/").concat(F))}},children:[(0,e.jsx)(je.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"groups"}),children:(0,e.jsx)(yr.F,{})},"groups"),(0,e.jsx)(je.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"students"}),children:(0,e.jsx)(Lr,{})},"students"),(0,e.jsx)(je.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),children:(0,e.jsx)(Xa,{})},"exams"),(0,e.jsx)(je.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"schedule"}),children:(0,e.jsx)(Er,{})},"schedule"),(0,e.jsx)(je.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"class-register"}),children:(0,e.jsx)(Ta,{})},"class-register"),j&&(0,e.jsx)(je.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"grades-scale"}),children:(0,e.jsx)(Sr,{})},"grades-scale"),(0,e.jsx)(je.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"final-grades"}),children:(0,e.jsx)(hr,{})},"final-grades"),(0,e.jsx)(je.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"file-exports-history"}),children:(0,e.jsx)(er,{})},"file-exports-history")]})}):(0,e.jsx)(Ge.Z,{})},Rr=function(){var o=(0,s.useParams)(),n=o.subjectId,t=o.tab,r=t===void 0?"groups":t;return(0,e.jsx)(Ne.p,{semester_subject_id:Number(n),children:(0,e.jsx)(Ar,{tab:r})})}},76841:function(yt,He,u){u.d(He,{Gm:function(){return h},Sx:function(){return d},_g:function(){return s}});var Ke=u(15009),m=u.n(Ke),Ve=u(97857),Te=u.n(Ve),je=u(99289),K=u.n(je),Ge=u(80854);function h(i,b){return v.apply(this,arguments)}function v(){return v=K()(m()().mark(function i(b,I){return m()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.abrupt("return",(0,Ge.request)("/api/admin/reports/report",Te()({params:b,method:"GET",useCache:!1},I||{})));case 1:case"end":return P.stop()}},i)})),v.apply(this,arguments)}function s(i,b,I){return ae.apply(this,arguments)}function ae(){return ae=K()(m()().mark(function i(b,I,ne){return m()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.abrupt("return",(0,Ge.request)("/api/admin/stats/course/".concat(b,"/export"),Te()({params:I,method:"GET",useCache:!1,responseType:"blob",headers:{accept:"application/vnd.ms-excel"}},ne||{})));case 1:case"end":return ee.stop()}},i)})),ae.apply(this,arguments)}function d(i,b,I){return Z.apply(this,arguments)}function Z(){return Z=K()(m()().mark(function i(b,I,ne){return m()().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.abrupt("return",(0,Ge.request)("/api/admin/stats/topic/".concat(b,"/export"),Te()({method:"GET",useCache:!1,params:{stat:I},responseType:"blob",headers:{accept:"application/vnd.ms-excel"}},ne||{})));case 1:case"end":return ee.stop()}},i)})),Z.apply(this,arguments)}},70804:function(yt,He,u){var Ke=u(67294);var m=function(ae,d){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Z,i){Z.__proto__=i}||function(Z,i){for(var b in i)i.hasOwnProperty(b)&&(Z[b]=i[b])})(ae,d)},Ve,Te,je=(function(ae){(function(){var d={}.hasOwnProperty;function Z(){for(var i=[],b=0;b<arguments.length;b++){var I=arguments[b];if(I){var ne=typeof I;if(ne==="string"||ne==="number")i.push(I);else if(Array.isArray(I)&&I.length){var P=Z.apply(null,I);P&&i.push(P)}else if(ne==="object")for(var ee in I)d.call(I,ee)&&I[ee]&&i.push(ee)}}return i.join(" ")}ae.exports?(Z.default=Z,ae.exports=Z):window.classNames=Z})()}(Te={path:Ve,exports:{},require:function(ae,d){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(d==null&&Te.path)}},Te.exports),Te.exports);function K(ae,d,Z){var i,b,I,ne,P;function ee(){var we=Date.now()-ne;we<d&&we>=0?i=setTimeout(ee,d-we):(i=null,Z||(P=ae.apply(I,b),I=b=null))}d==null&&(d=100);var ue=function(){I=this,b=arguments,ne=Date.now();var we=Z&&!i;return i||(i=setTimeout(ee,d)),we&&(P=ae.apply(I,b),I=b=null),P};return ue.clear=function(){i&&(clearTimeout(i),i=null)},ue.flush=function(){i&&(P=ae.apply(I,b),I=b=null,clearTimeout(i),i=null)},ue}K.debounce=K;var Ge=K;(function(ae,d){d===void 0&&(d={});var Z=d.insertAt;if(ae&&typeof document!="undefined"){var i=document.head||document.getElementsByTagName("head")[0],b=document.createElement("style");b.type="text/css",Z==="top"&&i.firstChild?i.insertBefore(b,i.firstChild):i.appendChild(b),b.styleSheet?b.styleSheet.cssText=ae:b.appendChild(document.createTextNode(ae))}})(`.indiana-scroll-container {
  overflow: auto; }
  .indiana-scroll-container--dragging {
    scroll-behavior: auto !important; }
    .indiana-scroll-container--dragging > * {
      pointer-events: none;
      cursor: -webkit-grab;
      cursor: grab; }
  .indiana-scroll-container--hide-scrollbars {
    overflow: hidden;
    overflow: -moz-scrollbars-none;
    -ms-overflow-style: none;
    scrollbar-width: none; }
    .indiana-scroll-container--hide-scrollbars::-webkit-scrollbar {
      display: none !important;
      height: 0 !important;
      width: 0 !important;
      background: transparent !important;
      -webkit-appearance: none !important; }
  .indiana-scroll-container--native-scroll {
    overflow: auto; }

.indiana-dragging {
  cursor: -webkit-grab;
  cursor: grab; }
`);var h,v=(h="indiana-scroll-container",function(ae,d){if(!ae)return h;var Z;typeof ae=="string"?Z=ae:d=ae;var i=h;return Z&&(i+="__"+Z),i+(d?Object.keys(d).reduce(function(b,I){var ne=d[I];return ne&&(b+=" "+(typeof ne=="boolean"?i+"--"+I:i+"--"+I+"_"+ne)),b},""):"")}),s=function(ae){function d(Z){var i=ae.call(this,Z)||this;return i.onEndScroll=function(){i.scrolling=!1,!i.pressed&&i.started&&i.processEnd()},i.onScroll=function(b){var I=i.container.current;I.scrollLeft===i.scrollLeft&&I.scrollTop===i.scrollTop||(i.scrolling=!0,i.processScroll(b),i.onEndScroll())},i.onTouchStart=function(b){var I=i.props.nativeMobileScroll;if(i.isDraggable(b.target))if(i.internal=!0,I&&i.scrolling)i.pressed=!0;else{var ne=b.touches[0];i.processClick(b,ne.clientX,ne.clientY),!I&&i.props.stopPropagation&&b.stopPropagation()}},i.onTouchEnd=function(b){var I=i.props.nativeMobileScroll;i.pressed&&(!i.started||i.scrolling&&I?i.pressed=!1:i.processEnd(),i.forceUpdate())},i.onTouchMove=function(b){var I=i.props.nativeMobileScroll;if(i.pressed&&(!I||!i.isMobile)){var ne=b.touches[0];ne&&i.processMove(b,ne.clientX,ne.clientY),b.preventDefault(),i.props.stopPropagation&&b.stopPropagation()}},i.onMouseDown=function(b){i.isDraggable(b.target)&&i.isScrollable()&&(i.internal=!0,i.props.buttons.indexOf(b.button)!==-1&&(i.processClick(b,b.clientX,b.clientY),b.preventDefault(),i.props.stopPropagation&&b.stopPropagation()))},i.onMouseMove=function(b){i.pressed&&(i.processMove(b,b.clientX,b.clientY),b.preventDefault(),i.props.stopPropagation&&b.stopPropagation())},i.onMouseUp=function(b){i.pressed&&(i.started?i.processEnd():(i.internal=!1,i.pressed=!1,i.forceUpdate(),i.props.onClick&&i.props.onClick(b)),b.preventDefault(),i.props.stopPropagation&&b.stopPropagation())},i.container=Ke.createRef(),i.onEndScroll=Ge(i.onEndScroll,300),i.scrolling=!1,i.started=!1,i.pressed=!1,i.internal=!1,i.getRef=i.getRef.bind(i),i}return function(Z,i){function b(){this.constructor=Z}m(Z,i),Z.prototype=i===null?Object.create(i):(b.prototype=i.prototype,new b)}(d,ae),d.prototype.componentDidMount=function(){var Z=this.props.nativeMobileScroll,i=this.container.current;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd),i.addEventListener("touchstart",this.onTouchStart,{passive:!1}),i.addEventListener("mousedown",this.onMouseDown,{passive:!1}),Z&&(this.isMobile=this.isMobileDevice(),this.isMobile&&this.forceUpdate())},d.prototype.componentWillUnmount=function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},d.prototype.getElement=function(){return this.container.current},d.prototype.isMobileDevice=function(){return window.orientation!==void 0||navigator.userAgent.indexOf("IEMobile")!==-1},d.prototype.isDraggable=function(Z){var i=this.props.ignoreElements;if(i){var b=Z.closest(i);return b===null||b.contains(this.getElement())}return!0},d.prototype.isScrollable=function(){var Z=this.container.current;return Z&&(Z.scrollWidth>Z.clientWidth||Z.scrollHeight>Z.clientHeight)},d.prototype.processClick=function(Z,i,b){var I=this.container.current;this.scrollLeft=I.scrollLeft,this.scrollTop=I.scrollTop,this.clientX=i,this.clientY=b,this.pressed=!0},d.prototype.processStart=function(Z){Z===void 0&&(Z=!0);var i=this.props.onStartScroll;this.started=!0,Z&&document.body.classList.add("indiana-dragging"),i&&i({external:!this.internal}),this.forceUpdate()},d.prototype.processScroll=function(Z){if(this.started){var i=this.props.onScroll;i&&i({external:!this.internal})}else this.processStart(!1)},d.prototype.processMove=function(Z,i,b){var I=this.props,ne=I.horizontal,P=I.vertical,ee=I.activationDistance,ue=I.onScroll,we=this.container.current;this.started?(ne&&(we.scrollLeft-=i-this.clientX),P&&(we.scrollTop-=b-this.clientY),ue&&ue({external:!this.internal}),this.clientX=i,this.clientY=b,this.scrollLeft=we.scrollLeft,this.scrollTop=we.scrollTop):(ne&&Math.abs(i-this.clientX)>ee||P&&Math.abs(b-this.clientY)>ee)&&(this.clientX=i,this.clientY=b,this.processStart())},d.prototype.processEnd=function(){var Z=this.props.onEndScroll;this.container.current&&Z&&Z({external:!this.internal}),this.pressed=!1,this.started=!1,this.scrolling=!1,this.internal=!1,document.body.classList.remove("indiana-dragging"),this.forceUpdate()},d.prototype.getRef=function(Z){[this.container,this.props.innerRef].forEach(function(i){i&&(typeof i=="function"?i(Z):i.current=Z)})},d.prototype.render=function(){var Z=this.props,i=Z.children,b=Z.draggingClassName,I=Z.className,ne=Z.style,P=Z.hideScrollbars,ee=Z.component;return Ke.createElement(ee,{className:je(I,this.pressed&&b,v({dragging:this.pressed,"hide-scrollbars":P,"native-scroll":this.isMobile})),style:ne,ref:this.getRef,onScroll:this.onScroll},i)},d.defaultProps={nativeMobileScroll:!0,hideScrollbars:!0,activationDistance:10,vertical:!0,horizontal:!0,stopPropagation:!1,style:{},component:"div",buttons:[0]},d}(Ke.PureComponent);He.Z=s}}]);
