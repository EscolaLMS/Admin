(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"3fxf":function(le,F,e){"use strict";var R=e("DjyN"),z=e("NUBc"),U=e("Mwp2"),Y=e("VXEj"),C=e("+L6B"),i=e("2/Rp"),B=e("5NDa"),V=e("5rEg"),Z=e("oBTY"),a=e("k1fw"),L=e("tJVT"),D=e("DYRE"),K=e("zeV3"),x=e("tU7J"),M=e("wFql"),f=e("q1tI"),I=e.n(f),d=e("BAh9"),te=e("/MfK"),W=e("mAF4"),ie=e("dF/Y"),p=e("9kvl"),S=e("DBJ/"),Q=e("lLVY"),J=e.n(Q),O=e("nKUr"),re=e.n(O),be=function(ce){var de=ce.directory,je=ce.onUploaded;return Object(O.jsxs)(K.b,{align:"start",children:[Object(O.jsxs)(M.a.Text,{children:[Object(O.jsx)(p.a,{id:"pages.files.filesBrowser"}),Object(O.jsx)(M.a.Text,{code:!0,children:de})]}),Object(O.jsx)(S.a,{url:"/api/admin/file/upload",name:"file[]",data:{target:de},onUpload:function(fe){fe.success&&je(de,fe.data)}})]})},Fe=function(ce){var de=ce.defaultDirectory,je=de===void 0?"/":de,ue=ce.onFile,fe=ce.hideDeleteBtn,Ce=fe===void 0?!1:fe,Me=ce.forceLoading,De=Me===void 0?!1:Me,Ie=Object(p.j)(),ge=Object(f.useState)({loading:!1,name:"",directory:je,current_page:1,data:void 0,per_page:1,last_page:1,total:0}),pe=Object(L.a)(ge,2),G=pe[0],me=pe[1],oe=Object(f.useRef)(),ee=Object(f.useCallback)(function(N){me(function(o){return Object(a.a)(Object(a.a)({},o),{},{loading:N})})},[]),he=Object(f.useCallback)(function(N,o){N.success&&me(function($){return Object(a.a)(Object(a.a)(Object(a.a)({},$),N.data),{},{data:[{url:o.split("/").slice(0,-1).join("/"),name:"..",created_at:"",mime:"directory"}].concat(Object(Z.a)(N.data.data.map(function(X){return Object(a.a)(Object(a.a)({},X),{},{url:X.mime==="directory"?"".concat(o,"/").concat(X.name):X.url})}))).filter(function(X){return o==="/"||o===je?X.name!=="..":!0}),directory:o,loading:!1})})},[ee]),ne=Object(f.useCallback)(function(N){var o,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,X=function(){return oe.current&&oe.current.abort()};return X(),oe.current=new AbortController,ee(!0),Object(d.a)({directory:N,page:$},{signal:(o=oe.current)===null||o===void 0?void 0:o.signal}).then(function(se){se.success&&he(se,N)}).catch(function(){return ee(!1)}),function(){X()}},[ee]);Object(f.useEffect)(function(){return ne(je)},[je,ne]);var _e=Object(f.useCallback)(function(N){ee(!0),Object(d.c)(N).then(function(){ne(G.directory)}).catch(function(){ee(!1)})},[ne,ee,G.directory]),Re=Object(f.useCallback)(function(N,o){var $,X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,se=function(){return oe.current&&oe.current.abort()};return se(),oe.current=new AbortController,ee(!0),Object(d.b)({directory:N,name:o,page:X},{signal:($=oe.current)===null||$===void 0?void 0:$.signal}).then(function(Ee){Ee.success&&he(Ee,N)}).catch(function(){return ee(!1)}),function(){se()}},[ee]);return Object(O.jsxs)("div",{className:"file-browser",children:[Object(O.jsxs)("div",{className:"file-browser__header",children:[Object(O.jsx)(V.a,{placeholder:Ie.formatMessage({id:"search_file"}),className:"file-browser__input",onChange:function(o){return me(function($){return Object(a.a)(Object(a.a)({},$),{},{name:o.target.value})})},value:G.name}),Object(O.jsxs)("div",{children:[Object(O.jsx)(i.a,{className:"file-browser__button",onClick:function(){return ne(G.directory)},children:Object(O.jsx)(p.a,{id:"reset"})}),Object(O.jsx)(i.a,{className:"file-browser__button",type:"primary",onClick:function(){return Re(G.directory,G.name)},children:Object(O.jsx)(p.a,{id:"query"})})]})]}),Object(O.jsx)(Y.b,{loading:G.loading||De,size:"small",itemLayout:"horizontal",dataSource:G.data,header:Object(O.jsx)(be,{directory:G.directory,onUploaded:function(o,$){$&&(ne(o),ue&&ue($,o))}}),footer:Object(O.jsx)(be,{directory:G.directory,onUploaded:function(o,$){ne(o),$&&ue&&ue($,o)}}),renderItem:function(o){return Object(O.jsx)(Y.b.Item,{actions:o.mime!=="directory"&&!Ce?[Object(O.jsx)(i.a,{type:"default",danger:!0,icon:Object(O.jsx)(te.a,{}),size:"small",onClick:function(){return _e(o.url)}},"dir")]:[],children:Object(O.jsx)(Y.b.Item.Meta,{avatar:o.mime==="directory"?Object(O.jsx)(i.a,{type:"primary",icon:Object(O.jsx)(W.a,{}),size:"small",onClick:function(){return ne(o.url)}}):Object(O.jsx)("a",{href:o.url,target:"_blank",rel:"noreferrer",children:Object(O.jsx)(i.a,{type:"default",icon:Object(O.jsx)(ie.a,{}),size:"small"})}),description:Object(O.jsx)(I.a.Fragment,{children:Object(O.jsx)(i.a,{type:"text",size:"small",onClick:function(){return o.mime==="directory"?ne(o.url):ue&&ue(o,G.directory)},children:o.name})})})})}}),Object(O.jsx)(z.a,{pageSizeOptions:[],current:G.current_page,total:G.total,pageSize:G.per_page,onChange:function(o){return ne(G.directory,o)}})]})};F.a=Fe},"5qq5":function(le,F,e){"use strict";var R=e("7Kak"),z=e("9yH6"),U=e("VTBJ"),Y=e("Ff2n"),C=e("nKUr"),i=e.n(C),B=e("uX+g"),V=e("q1tI"),Z=e.n(V),a=e("WFLz"),L=e("adzw"),D=["fieldProps","options","radioType","layout","proFieldProps","valueEnum"],K=Z.a.forwardRef(function(I,d){var te=I.fieldProps,W=I.options,ie=I.radioType,p=I.layout,S=I.proFieldProps,Q=I.valueEnum,J=Object(Y.a)(I,D);return Object(C.jsx)(L.a,Object(U.a)(Object(U.a)({mode:"edit",valueType:ie==="button"?"radioButton":"radio",ref:d,valueEnum:Object(B.a)(Q,void 0)},J),{},{fieldProps:Object(U.a)({options:W,layout:p},te),proFieldProps:S,filedConfig:{customLightMode:!0}}))}),x=Z.a.forwardRef(function(I,d){var te=I.fieldProps,W=I.children;return Object(C.jsx)(z.a,Object(U.a)(Object(U.a)({},te),{},{ref:d,children:W}))}),M=Object(a.a)(x,{valuePropName:"checked",ignoreWidth:!0}),f=M;f.Group=K,f.Button=z.a.Button,f.displayName="ProFormComponent",F.a=f},BAh9:function(le,F,e){"use strict";e.d(F,"a",function(){return C}),e.d(F,"b",function(){return B}),e.d(F,"e",function(){return Z}),e.d(F,"d",function(){return L}),e.d(F,"c",function(){return D});var R=e("qLMh"),z=e("k1fw"),U=e("9og8"),Y=e("9kvl");function C(x,M){return i.apply(this,arguments)}function i(){return i=Object(U.a)(Object(R.a)().mark(function x(M,f){return Object(R.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(Y.g)("/api/admin/file/list",Object(z.a)({method:"GET",params:M},f||{})));case 1:case"end":return d.stop()}},x)})),i.apply(this,arguments)}function B(x,M){return V.apply(this,arguments)}function V(){return V=Object(U.a)(Object(R.a)().mark(function x(M,f){return Object(R.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(Y.g)("/api/admin/file/find",Object(z.a)({method:"GET",params:M},f||{})));case 1:case"end":return d.stop()}},x)})),V.apply(this,arguments)}function Z(x,M,f){return a.apply(this,arguments)}function a(){return a=Object(U.a)(Object(R.a)().mark(function x(M,f,I){var d;return Object(R.a)().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return d=new FormData,d.append("file[]",M),d.append("target",f),W.abrupt("return",Object(Y.g)("/api/admin/file/upload",Object(z.a)({method:"POST",data:d},I||{})));case 4:case"end":return W.stop()}},x)})),a.apply(this,arguments)}var L=function(M){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;return"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/images/img?path=").concat(M,"&w=").concat(f)};function D(x,M){return K.apply(this,arguments)}function K(){return K=Object(U.a)(Object(R.a)().mark(function x(M,f){return Object(R.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(Y.g)("/api/admin/file/delete",Object(z.a)({method:"DELETE",data:{url:M}},f||{})));case 1:case"end":return d.stop()}},x)})),K.apply(this,arguments)}},BiO0:function(le,F,e){"use strict";var R=e("VTBJ"),z=e("Ff2n"),U=e("nKUr"),Y=e.n(U),C=e("q1tI"),i=e.n(C),B=e("adzw"),V=["fieldProps","proFieldProps"],Z=function(L,D){var K=L.fieldProps,x=L.proFieldProps,M=Object(z.a)(L,V);return Object(U.jsx)(B.a,Object(R.a)({ref:D,mode:"edit",valueType:"textarea",fieldProps:K,proFieldProps:x},M))};F.a=i.a.forwardRef(Z)},"DBJ/":function(le,F,e){"use strict";var R=e("k1fw"),z=e("y8nQ"),U=e("Vl3Y"),Y=e("etVw"),C=e("9kvl"),i=e("qFDU"),B=e("nKUr"),V=e.n(B);function Z(a){var L=a.onChange,D=a.onUpload,K=a.url,x=a.name,M=a.extra,f=a.accept,I=a.data,d=a.wrapInForm,te=d===void 0?!0:d,W=a.title,ie=a.formProps,p=Object(C.j)();return I&&I[x]&&delete I[x],Object(B.jsx)(i.a,{condition:te,wrap:function(Q){return Object(B.jsx)(U.a,Object(R.a)(Object(R.a)({},ie),{},{children:Q}))},children:Object(B.jsx)(Y.a,{title:W||" ".concat(p.formatMessage({id:"upload_click_here"})),placeholder:p.formatMessage({id:"upload_click_here"}),onChange:function(Q){L&&L(Q),Q.file.status==="done"&&D&&D(Q.file.response)},label:Object(B.jsx)(C.a,{id:"upload"}),max:2,fieldProps:{data:I,accept:f,name:x,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}},action:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com").concat(K),extra:M})})}F.a=Z},"O/iA":function(le,F,e){},Qurx:function(le,F,e){"use strict";var R=e("VTBJ"),z=e("Ff2n"),U=e("nKUr"),Y=e.n(U),C=e("adzw"),i=["fieldProps","proFieldProps"],B=["fieldProps","proFieldProps"],V="text",Z=function(K){var x=K.fieldProps,M=K.proFieldProps,f=Object(z.a)(K,i);return Object(U.jsx)(C.a,Object(R.a)({mode:"edit",valueType:V,fieldProps:x,filedConfig:{valueType:V},proFieldProps:M},f))},a=function(K){var x=K.fieldProps,M=K.proFieldProps,f=Object(z.a)(K,B);return Object(U.jsx)(C.a,Object(R.a)({mode:"edit",valueType:"password",fieldProps:x,proFieldProps:M,filedConfig:{valueType:V}},f))},L=Z;L.Password=a,L.displayName="ProFormComponent",F.a=L},YjuE:function(le,F,e){"use strict";e.r(F);var R=e("fOrg"),z=e("+KLJ"),U=e("T2oS"),Y=e("W9HT"),C=e("tJVT"),i=e("q1tI"),B=e.n(i),V=e("nhC9"),Z=e("Ty5D"),a=e("9kvl"),L=e("tMyG"),D=e("+up7"),K=e("P2fV"),x=e("NJEC"),M=e("5Dmo"),f=e("3S7+"),I=e("+L6B"),d=e("2/Rp"),te=e("+BJd"),W=e("mr32"),ie=e("jrin"),p=e("qLMh"),S=e("k1fw"),Q=e("miYZ"),J=e("tsqr"),O=e("9og8"),re=e("xvlK"),be=e("Qiat"),Fe=e("EFp3"),Ue=e("O/iA"),ce=e("OaEy"),de=e("wx14"),je=e("U8pU"),ue=e("ODXe"),fe=e("TSYQ"),Ce=e.n(fe),Me=e("Zm9Q"),De=e("bT9E"),Ie=e("H84U"),ge=e("2fM7"),pe=e("0n0R"),G=ge.a.Option;function me(_){return _&&_.type&&(_.type.isSelectOption||_.type.isSelectOptGroup)}var oe=function(r,l){var u=r.prefixCls,c=r.className,E=r.popupClassName,n=r.dropdownClassName,v=r.children,y=r.dataSource,b=Object(Me.a)(v),A;if(b.length===1&&Object(pe.c)(b[0])&&!me(b[0])){var P=Object(ue.a)(b,1);A=P[0]}var m=A?function(){return A}:void 0,h;return b.length&&me(b[0])?h=v:h=y?y.map(function(s){if(Object(pe.c)(s))return s;switch(Object(je.a)(s)){case"string":return i.createElement(G,{key:s,value:s},s);case"object":{var j=s.value;return i.createElement(G,{key:j,value:j},s.text)}default:return}}):[],i.createElement(Ie.a,null,function(s){var j=s.getPrefixCls,g=j("select",u);return i.createElement(ge.a,Object(de.a)({ref:l},Object(De.a)(r,["dataSource"]),{prefixCls:g,dropdownClassName:E||n,className:Ce()("".concat(g,"-auto-complete"),c),mode:ge.a.SECRET_COMBOBOX_MODE_DO_NOT_USE},{getInputElement:m}),h)})},ee=i.forwardRef(oe);ee.Option=G;var he=ee,ne=e("y8nQ"),_e=e("Vl3Y"),Re=e("5NDa"),N=e("5rEg"),o=e("VMEa"),$=e("rmhi"),X=e("Qurx"),se=e("F/zT"),Ee=e("5qq5"),Be=e("BiO0"),Ne=e("hd5d"),Ve=e("3fxf"),$e=e("ovOe"),xe=e.n($e),t=e("nKUr"),we=function(r){var l=r.value,u=r.onChange,c=r.type,E=c===void 0?"file":c,n=Object(i.useState)(!1),v=Object(C.a)(n,2),y=v[0],b=v[1];return Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsxs)(o.a.Group,{children:[Object(t.jsx)(N.a,{value:l,readOnly:!0}),Object(t.jsxs)(d.a,{size:"small",type:"primary",onClick:function(){return b(!y)},children:["toggle ",E," browser"]})]}),y&&Object(t.jsx)(Ve.a,{onFile:function(P,m){return u&&u("".concat(m,"/").concat(P.name))}})]})},ze=function(r){var l=Object(a.j)(),u=r.visible,c=r.onVisibleChange,E=r.onFinish,n=r.id,v=r.initialData,y=r.groups,b=_e.a.useForm(),A=Object(C.a)(b,1),P=A[0],m=!n||n===-1,h=Object(i.useState)("text"),s=Object(C.a)(h,2),j=s[0],g=s[1],w=Object(i.useCallback)(function(){return!!(P.getFieldValue("group")==="global"||v)},[P,v]),T=Object(i.useState)(""),q=Object(C.a)(T,2),H=q[0],ae=q[1];Object(i.useEffect)(function(){typeof n=="object"?P.setFieldsValue(n):n&&n!==-1?Object(D.d)(Number(n)).then(function(k){k.success&&(P.setFieldsValue(k.data),g(k.data.type),ae(k.data.group))}):(P.resetFields(),g("text"))},[n,P,v]);var ve=Object(i.useCallback)(function(k){k.type&&k.type!==j&&g(k.type)},[j]);return Object(t.jsxs)($.a,{form:P,title:l.formatMessage({id:n?"editSetting":"newSetting",defaultMessage:n?"editSetting":"newSetting"}),width:"60vw",visible:!!u,onVisibleChange:c,onFinish:E,onValuesChange:ve,children:[Object(t.jsxs)(o.a.Group,{children:[v?Object(t.jsx)(X.a,{label:Object(t.jsx)(a.a,{id:"group",defaultMessage:"group"}),rules:[{required:!0}],width:"md",name:"group",disabled:w()}):Object(t.jsx)(o.a.Item,{label:Object(t.jsx)(a.a,{id:"group",defaultMessage:"group"}),name:"group",children:Object(t.jsx)(he,{style:{width:"300px"},autoFocus:!0,value:H,onChange:function(Pe){return ae(Pe)},filterOption:function(Pe,Ae){var Se;return(Ae==null||(Se=Ae.children)===null||Se===void 0?void 0:Se.toString().toLowerCase().indexOf(Pe.toLowerCase()))!==-1},children:y.map(function(k){return Object(t.jsx)(he.Option,{value:k,children:k},k)})})}),Object(t.jsx)(X.a,{label:Object(t.jsx)(a.a,{id:"key",defaultMessage:"key"}),rules:[{required:!0}],width:"md",name:"key",disabled:w()})]}),Object(t.jsxs)(o.a.Group,{children:[Object(t.jsx)(se.a,{name:"enumerable",disabled:w(),label:Object(t.jsx)(a.a,{id:"enumerable",defaultMessage:"enumerable"})}),Object(t.jsx)(se.a,{name:"public",disabled:w(),label:Object(t.jsx)(a.a,{id:"public",defaultMessage:"public"})})]}),Object(t.jsx)(o.a.Group,{children:Object(t.jsx)(Ee.a.Group,{disabled:!!(!m||v),name:"type",label:Object(t.jsx)(a.a,{id:"type"}),options:[{label:"text",value:"text"},{label:"markdown",value:"markdown"},{label:"json",value:"json"},{label:"file",value:"file"},{label:"image",value:"image"}]})}),Object(t.jsxs)("div",{children:[j==="text"&&Object(t.jsx)(X.a,{width:"lg",name:"value",label:Object(t.jsx)(a.a,{id:"value"})}),j==="json"&&Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(Be.a,{width:"lg",name:"value",label:Object(t.jsx)(a.a,{id:"value"}),tooltip:"".concat(l.formatMessage({id:"example_json"}),': {"name":"John", "age":30, "city":["New York","Warsaw"]}')}),Object(t.jsx)(o.a.Item,{noStyle:!0,shouldUpdate:!0,children:function(){try{return Object(t.jsx)(xe.a,{src:JSON.parse(P.getFieldValue("value"))})}catch(Pe){return Object(t.jsx)(xe.a,{src:JSON.parse('{ "error": "cannot parse this json" }')})}}})]}),(j==="file"||j==="image")&&Object(t.jsx)(o.a.Item,{name:"value",label:"value",tooltip:"select file from current repository or upload new one",valuePropName:"value",children:Object(t.jsx)(we,{type:j})}),j==="markdown"&&Object(t.jsx)(o.a.Item,{name:"value",label:"value",tooltip:"The editor is WYSIWYG and includes formatting tools whilst retaining the ability to write markdown shortcuts inline and output plain Markdown.",valuePropName:"value",children:Object(t.jsx)(Ne.a,{directory:"settings/wysiwyg"})})]})]})},Le=ze,Te=e("G3dp"),Ke=e("/MfK"),Ge=function(){var _=Object(O.a)(Object(p.a)().mark(function r(l,u,c){var E;return Object(p.a)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return E=J.b.loading(l.formatMessage({id:"loading"})),v.prev=1,v.next=4,c&&c!==-1?Object(D.h)(c,Object(S.a)({},u)):Object(D.b)(Object(S.a)({},u));case 4:return E(),J.b.success(l.formatMessage({id:"success"})),v.abrupt("return",!0);case 9:return v.prev=9,v.t0=v.catch(1),E(),J.b.error(l.formatMessage({id:"error"})),v.abrupt("return",!1);case 14:case"end":return v.stop()}},r,null,[[1,9]])}));return function(l,u,c){return _.apply(this,arguments)}}(),Je=function(){var _=Object(O.a)(Object(p.a)().mark(function r(l,u){var c;return Object(p.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return c=J.b.loading(l.formatMessage({id:"loading"})),n.prev=1,n.next=4,Object(D.c)(u);case 4:return c(),J.b.success(l.formatMessage({id:"success"})),n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(1),c(),J.b.error(l.formatMessage({id:"error"})),n.abrupt("return",!1);case 14:case"end":return n.stop()}},r,null,[[1,9]])}));return function(l,u){return _.apply(this,arguments)}}(),Ye=function(){var r=Object(i.useState)(!1),l=Object(C.a)(r,2),u=l[0],c=l[1],E=Object(i.useState)([]),n=Object(C.a)(E,2),v=n[0],y=n[1],b=Object(i.useRef)(),A=Object(a.j)(),P=Object(a.k)("@@initialState"),m=P.setInitialState;Object(i.useEffect)(function(){Object(D.e)().then(function(s){s.success&&y(s.data.filter(function(j){return j!=="global"}))})},[]);var h=[{title:Object(t.jsx)(a.a,{id:"group",defaultMessage:"group"}),dataIndex:"group",hideInSearch:!1,key:"group",valueType:"select",width:100,valueEnum:v.sort().reduce(function(s,j){return Object(S.a)(Object(S.a)({},s),{},Object(ie.a)({},j,j))},{})},{title:Object(t.jsx)(a.a,{id:"key",defaultMessage:"key"}),dataIndex:"key",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"type",defaultMessage:"type"}),dataIndex:"type",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"enumerable",defaultMessage:"enumerable"}),dataIndex:"enumerable",hideInForm:!0,hideInSearch:!0,render:function(j,g){return Object(t.jsx)(W.a,{color:g.enumerable?"success":"error",children:Object(t.jsx)(a.a,{id:g.enumerable?"true":"false",defaultMessage:g.enumerable?"true":"false"})})}},{title:Object(t.jsx)(a.a,{id:"public",defaultMessage:"public"}),dataIndex:"public",hideInForm:!0,hideInSearch:!0,render:function(j,g){return Object(t.jsx)(W.a,{color:g.public?"success":"error",children:Object(t.jsx)(a.a,{id:g.public?"true":"false",defaultMessage:g.public?"true":"false"})})}},{hideInSearch:!0,title:Object(t.jsx)(a.a,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",valueType:"option",render:function(j,g){return[Object(t.jsx)(f.a,{title:Object(t.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(t.jsx)(d.a,{type:"primary",icon:Object(t.jsx)(Te.a,{}),onClick:function(){return c(g.id)}})},"edit"),Object(t.jsx)(x.a,{title:Object(t.jsx)(a.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(O.a)(Object(p.a)().mark(function w(){var T;return Object(p.a)().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.next=2,Je(A,g.id);case 2:T=H.sent,T&&(c(!1),b.current&&b.current.reload());case 4:case"end":return H.stop()}},w)})),okText:Object(t.jsx)(a.a,{id:"yes",defaultMessage:"Yes"}),cancelText:Object(t.jsx)(a.a,{id:"no",defaultMessage:"No"}),children:Object(t.jsx)(f.a,{title:Object(t.jsx)(a.a,{id:"delete",defaultMessage:"delete"}),children:Object(t.jsx)(d.a,{type:"primary",icon:Object(t.jsx)(Ke.a,{}),danger:!0})})},"delete")]}}];return Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsx)(be.a,{headerTitle:A.formatMessage({id:"menu.settings"}),actionRef:b,rowKey:"id",search:{},toolBarRender:function(){return[Object(t.jsxs)(d.a,{type:"primary",onClick:function(){c(-1)},children:[Object(t.jsx)(re.a,{})," ",Object(t.jsx)(a.a,{id:"pages.searchTable.new"})]},"primary")]},request:function(j){var g=j.pageSize,w=j.current,T=j.group;return Object(D.f)({pageSize:g,current:w,group:T}).then(function(q){return q.success?{data:q.data.filter(function(H){return H.group!=="global"}),total:q.meta.total,success:!0}:[]})},columns:h}),Object(t.jsx)(Le,{groups:v,id:u,visible:Number.isInteger(u),onVisibleChange:function(j){return!j&&c(!1)},onFinish:function(){var s=Object(O.a)(Object(p.a)().mark(function j(g){var w,T,q;return Object(p.a)().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return w=g,ae.next=3,Ge(A,w,Number(u));case 3:if(T=ae.sent,!T){ae.next=12;break}if(c(!1),b.current&&b.current.reload(),w.group!=="global"){ae.next=12;break}return ae.next=10,Object(D.f)({current:1,pageSize:100,group:"global"});case 10:q=ae.sent,m(function(ve){return Object(S.a)(Object(S.a)({},ve),{},{config:q.success?q.data:ve==null?void 0:ve.config})});case 12:case"end":return ae.stop()}},j)}));return function(j){return s.apply(this,arguments)}}()})]})},Qe=Ye,jt=e("tU7J"),Xe=e("wFql"),He=e("Fghh"),Ze=Xe.a.Text,Oe;(function(_){_.Array="array",_.String="string"})(Oe||(Oe={}));var ke=function(r,l){return l===Oe.Array?r&&Array.isArray(r)?JSON.stringify(r):"[]":r},qe=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",l=arguments.length>1?arguments[1]:void 0;if(l===Oe.Array){var u=JSON.parse(r);return u&&Array.isArray(u)?u:[]}return r},et=function(r){var l=Object(He.j)(),u=r.visible,c=r.onVisibleChange,E=r.onFinish,n=r.value,v=_e.a.useForm(),y=Object(C.a)(v,1),b=y[0],A=Object(i.useMemo)(function(){return(n.rules||[]).includes(Oe.Array)?Oe.Array:Oe.String},[n.rules]);return Object(i.useEffect)(function(){b.setFieldsValue(Object(S.a)(Object(S.a)({},n),{},{value:ke(n.value,A)}))},[A,n,b]),Object(t.jsxs)($.a,{form:b,title:n.full_key,width:"60vw",visible:u,onVisibleChange:c,onFinish:Object(O.a)(Object(p.a)().mark(function P(){var m;return Object(p.a)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(D.g)({key:n.full_key,value:qe(b.getFieldsValue().value,A)});case 2:if(m=s.sent,!m.success){s.next=6;break}return E(m.success===!0),s.abrupt("return",m.success);case 6:return s.abrupt("return");case 7:case"end":return s.stop()}},P)})),children:[Object(t.jsxs)(o.a.Group,{children:[Object(t.jsx)(se.a,{disabled:!0,name:"public",label:Object(t.jsx)(a.a,{id:"public",defaultMessage:"public"})}),Object(t.jsx)(se.a,{disabled:!0,name:"readonly",label:Object(t.jsx)(a.a,{id:"readonly",defaultMessage:"readonly"})}),Object(t.jsx)(o.a.Item,{shouldUpdate:!0,label:Object(t.jsx)(a.a,{id:"rules",defaultMessage:"rules"}),children:function(){return Object(t.jsx)(Ze,{code:!0,children:JSON.stringify(b.getFieldValue("rules"))})}})]}),A===Oe.Array?Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(Be.a,{width:"lg",name:"value",label:Object(t.jsx)(a.a,{id:"value"}),tooltip:"".concat(l.formatMessage({id:"example_json"}),': ["first_field_name", "second_field_name"]')}),Object(t.jsx)(o.a.Item,{noStyle:!0,shouldUpdate:!0,children:function(){try{return Object(t.jsx)(xe.a,{src:JSON.parse(b.getFieldValue("value"))})}catch(m){return Object(t.jsx)(xe.a,{src:JSON.parse('{ "error": "cannot parse this array" }')})}}})]}):Object(t.jsx)(X.a,{width:"lg",name:"value",label:Object(t.jsx)(a.a,{id:"value"})})]})},tt=et,at=[{title:Object(t.jsx)(a.a,{id:"key",defaultMessage:"key"}),dataIndex:"key",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"readonly",defaultMessage:"readonly"}),dataIndex:"readonly",hideInForm:!0,hideInSearch:!0,render:function(r,l){return Object(t.jsx)(W.a,{color:l.readonly?"success":"error",children:Object(t.jsx)(a.a,{id:l.readonly?"true":"false",defaultMessage:l.readonly?"true":"false"})})}},{title:Object(t.jsx)(a.a,{id:"public",defaultMessage:"public"}),dataIndex:"public",hideInForm:!0,hideInSearch:!0,render:function(r,l){return Object(t.jsx)(W.a,{color:l.public?"success":"error",children:Object(t.jsx)(a.a,{id:l.public?"true":"false",defaultMessage:l.public?"true":"false"})})}},{title:Object(t.jsx)(a.a,{id:"value",defaultMessage:"value"}),dataIndex:"value",hideInForm:!0,hideInSearch:!0}],rt=function _(r,l){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];return!r||typeof r!="object"?!1:(Object.keys(r).forEach(function(c){var E=r[c];c===l?u.push(r):typeof E=="object"&&_(E,l,u)}),u)},nt=function(r){var l=r.packageName,u=r.values,c=r.onValueUpdated,E=Object(a.j)(),n=Object(i.useState)(),v=Object(C.a)(n,2),y=v[0],b=v[1],A=Object(i.useMemo)(function(){var P=u[l];return rt(P,"rules")},[u,l]);return Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsx)(be.a,{headerTitle:E.formatMessage({id:"menu.settings"}),rowKey:"key",search:{},dataSource:A,columns:[].concat(at,[{hideInSearch:!0,title:Object(t.jsx)(a.a,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",valueType:"option",render:function(m,h){return[Object(t.jsx)(f.a,{title:Object(t.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(t.jsx)(d.a,{type:"primary",icon:Object(t.jsx)(Te.a,{}),onClick:function(){return b(h)}})},"edit")]}}])}),y&&Object(t.jsx)(tt,{value:y,visible:y!==void 0,onVisibleChange:function(m){return m===!1&&b(void 0)},onFinish:Object(O.a)(Object(p.a)().mark(function P(){return Object(p.a)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:c();case 1:case"end":return h.stop()}},P)}))})]})},st=nt,We=e("oBTY"),lt=function(){var _=Object(O.a)(Object(p.a)().mark(function r(l,u,c){var E,n;return Object(p.a)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return E=J.b.loading(l.formatMessage({id:"loading"})),y.prev=1,y.next=4,c&&c!==-1?Object(D.h)(c,Object(S.a)({},u)):Object(D.b)(Object(S.a)({},u));case 4:return n=y.sent,E(),J.b.success(l.formatMessage({id:"success"})),y.abrupt("return",{success:!0,updatedSettings:n});case 10:return y.prev=10,y.t0=y.catch(1),E(),J.b.error(l.formatMessage({id:"error"})),y.abrupt("return",{success:!1,updateSettings:null});case 15:case"end":return y.stop()}},r,null,[[1,10]])}));return function(l,u,c){return _.apply(this,arguments)}}(),it=function(){var _=Object(O.a)(Object(p.a)().mark(function r(l,u){var c;return Object(p.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return c=J.b.loading(l.formatMessage({id:"loading"})),n.prev=1,n.next=4,Object(D.c)(u);case 4:return c(),J.b.success(l.formatMessage({id:"success"})),n.abrupt("return",!0);case 9:return n.prev=9,n.t0=n.catch(1),c(),J.b.error(l.formatMessage({id:"error"})),n.abrupt("return",!1);case 14:case"end":return n.stop()}},r,null,[[1,9]])}));return function(l,u){return _.apply(this,arguments)}}(),ye={logo:{id:-1,key:"logo",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"image",data:"EscolaLMS"},frontURL:{id:0,key:"frontURL",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"}},ot=function(){var r=Object(i.useState)(!1),l=Object(C.a)(r,2),u=l[0],c=l[1],E=Object(i.useRef)(),n=Object(a.j)(),v=Object(a.k)("@@initialState"),y=v.setInitialState,b=v.initialState,A=[{title:Object(t.jsx)(a.a,{id:"key",defaultMessage:"key"}),dataIndex:"key",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"type",defaultMessage:"type"}),dataIndex:"type",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"enumerable",defaultMessage:"enumerable"}),dataIndex:"enumerable",hideInForm:!0,hideInSearch:!0,render:function(h,s){return Object(t.jsx)(W.a,{color:s.enumerable?"success":"error",children:Object(t.jsx)(a.a,{id:s.enumerable?"true":"false",defaultMessage:s.enumerable?"true":"false"})})}},{title:Object(t.jsx)(a.a,{id:"public",defaultMessage:"public"}),dataIndex:"public",hideInForm:!0,hideInSearch:!0,render:function(h,s){return Object(t.jsx)(W.a,{color:s.public?"success":"error",children:Object(t.jsx)(a.a,{id:s.public?"true":"false",defaultMessage:s.public?"true":"false"})})}},{hideInSearch:!0,title:Object(t.jsx)(a.a,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",valueType:"option",render:function(h,s){return[s.id>0?Object(t.jsx)(f.a,{title:Object(t.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(t.jsx)(d.a,{type:"primary",icon:Object(t.jsx)(Te.a,{}),onClick:function(){return c(s.id)}})},"edit"):Object(t.jsx)(f.a,{title:Object(t.jsx)(a.a,{id:"create",defaultMessage:"create"}),children:Object(t.jsx)(d.a,{type:"primary",icon:Object(t.jsx)(re.a,{}),onClick:function(){c(ye[s.key]||-1)}})},"create"),Object(t.jsx)(x.a,{title:Object(t.jsx)(a.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(O.a)(Object(p.a)().mark(function j(){var g;return Object(p.a)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,it(n,s.id);case 2:g=T.sent,g&&(c(!1),E.current&&E.current.reload());case 4:case"end":return T.stop()}},j)})),okText:Object(t.jsx)(a.a,{id:"yes",defaultMessage:"Yes"}),cancelText:Object(t.jsx)(a.a,{id:"no",defaultMessage:"No"}),children:s.id>0?Object(t.jsx)(f.a,{title:Object(t.jsx)(a.a,{id:"delete",defaultMessage:"delete"}),children:Object(t.jsx)(d.a,{type:"primary",icon:Object(t.jsx)(Ke.a,{}),danger:!0})}):null},"delete")]}}],P=function(h){var s;if(!!h&&(!(b!=null&&(s=b.config)!==null&&s!==void 0&&s.length)&&h&&y(Object(S.a)(Object(S.a)({},b),{},{config:[h]})),!!(b!=null&&b.config))){var j=b==null?void 0:b.config.map(function(g){return g.key===h.key?Object(S.a)(Object(S.a)({},g),h):g});y(Object(S.a)(Object(S.a)({},b),{},{config:j}))}};return Object(t.jsxs)(B.a.Fragment,{children:[Object(t.jsx)(be.a,{headerTitle:n.formatMessage({id:"menu.settings"}),actionRef:E,rowKey:"id",request:function(h){var s=h.pageSize,j=h.current;return Object(D.f)({pageSize:s,current:j,group:"global"}).then(function(g){if(g.success){var w=[].concat(Object(We.a)(Object.keys(ye).map(function(T){return g.data.find(function(q){return q.key===T})||ye[T]})),Object(We.a)(g.data.filter(function(T){return!Object.keys(ye).includes(T.key)})));return{data:w,total:w.length,success:!0}}return[]})},columns:A}),Object(t.jsx)(Le,{groups:[],id:u,visible:u,initialData:ye,onVisibleChange:function(h){return!h&&c(!1)},onFinish:function(){var m=Object(O.a)(Object(p.a)().mark(function h(s){var j,g,w,T;return Object(p.a)().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return j=s,H.next=3,lt(n,j,Number(u));case 3:g=H.sent,w=g.success,T=g.updatedSettings,w&&(T!=null&&T.success&&P(T.data),c(!1),E.current&&E.current.reload());case 7:case"end":return H.stop()}},h)}));return function(h){return m.apply(this,arguments)}}()})]})},ut=ot,ct=e("I5X1"),dt=function(r){return r.replaceAll("escolalms","").split("_").join("")},Ot=F.default=function(){var _=Object(Z.l)(),r=Object(a.j)(),l=_.tab,u=l===void 0?"user_settings":l,c=Object(i.useState)(),E=Object(C.a)(c,2),n=E[0],v=E[1],y=Object(i.useCallback)(function(){Object(D.a)().then(function(m){m.success&&v(m.data)})},[]),b=Object(ct.a)("@@initialState"),A=b.initialState,P=Object(i.useCallback)(function(){var m;return(A==null||(m=A.config)===null||m===void 0?void 0:m.length)!==0},[A]);return Object(i.useEffect)(function(){y()},[]),n?Object(t.jsxs)(L.a,{title:Object(t.jsx)(a.a,{id:"settings"}),header:{breadcrumb:{routes:[{path:"settings",breadcrumbName:r.formatMessage({id:"menu.Configuration.settings"})},{path:String(u),breadcrumbName:String(u)}]}},children:[!P()&&Object(t.jsx)(z.a,{message:Object(t.jsx)(a.a,{id:"global_settings_alert_title",defaultMessage:"Add global settings"}),description:Object(t.jsx)(a.a,{id:"global_settings_alert_description",defaultMessage:"Global settings are used to configure the entire LMS. You can add global settings by clicking the button below."}),type:"warning",showIcon:!0,style:{marginBottom:"20px"}}),Object(t.jsxs)(V.a,{tabs:{type:"card",activeKey:u,onChange:function(h){return a.e.push("/configuration/settings/".concat(h))}},children:[Object(t.jsx)(V.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"user.settings"}),children:Object(t.jsx)(Qe,{})},"user_settings"),Object(t.jsx)(V.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"global_settings"}),children:Object(t.jsx)(ut,{})},"global_settings"),Object.keys(n).map(function(m){return Object(t.jsxs)(V.a.TabPane,{tab:Object(t.jsxs)("span",{children:[Object(t.jsx)(a.a,{id:"package"})," ",dt(m)]}),children:[Object(t.jsx)(st,{values:n,packageName:m,onValueUpdated:function(){return y()}}),m]},m)})]})]}):Object(t.jsx)(Y.a,{})}},hd5d:function(le,F,e){"use strict";var R=e("qLMh"),z=e("9og8"),U=e("q1tI"),Y=e.n(U),C=e("3Ef1"),i=e.n(C),B=e("BAh9"),V=e("vtG9"),Z=e.n(V),a=e("9kvl"),L=e("nKUr"),D=e.n(L),K=function(M){var f=M.value,I=M.onChange,d=M.directory,te=d===void 0?"/wysiwyg":d,W=Object(a.j)();return Object(L.jsx)("div",{className:"form-wysiwyg-markdown",children:Object(L.jsx)(i.a,{uploadImage:function(){var ie=Object(z.a)(Object(R.a)().mark(function p(S){var Q,J;return Object(R.a)().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,Object(B.e)(S,te);case 2:if(Q=re.sent,!Q.success){re.next=6;break}return J=Q.data[0].name.includes("/")?Q.data[0].name:"".concat(te).concat(Q.data[0].name),re.abrupt("return",Object(B.d)(J,1e3));case 6:throw new Error("Error while uploading");case 7:case"end":return re.stop()}},p)}));return function(p){return ie.apply(this,arguments)}}(),defaultValue:f||"",onChange:function(p){return I&&I(p())},placeholder:W.formatMessage({id:"wysiwyg_placeholder"})})})};F.a=K},lLVY:function(le,F,e){},vtG9:function(le,F,e){}}]);
