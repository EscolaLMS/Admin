(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"/y+f":function($e,ce,t){"use strict";t.d(ce,"f",function(){return i}),t.d(ce,"d",function(){return p}),t.d(ce,"e",function(){return P}),t.d(ce,"c",function(){return s}),t.d(ce,"a",function(){return ie}),t.d(ce,"b",function(){return Be});var i;(function(d){d.Unselected="",d.RichText="EscolaLms\\TopicTypes\\Models\\TopicContent\\RichText",d.OEmbed="EscolaLms\\TopicTypes\\Models\\TopicContent\\OEmbed",d.Audio="EscolaLms\\TopicTypes\\Models\\TopicContent\\Audio",d.Video="EscolaLms\\TopicTypes\\Models\\TopicContent\\Video",d.H5P="EscolaLms\\TopicTypes\\Models\\TopicContent\\H5P",d.Image="EscolaLms\\TopicTypes\\Models\\TopicContent\\Image",d.PDF="EscolaLms\\TopicTypes\\Models\\TopicContent\\PDF",d.SCORM="EscolaLms\\TopicTypes\\Models\\TopicContent\\ScormSco",d.Project="EscolaLms\\TopicTypeProject\\Models\\Project",d.GiftQuiz="EscolaLms\\TopicTypeGift\\Models\\GiftQuiz"})(i||(i={}));var w;(function(d){d.OrderPaid="EscolaLms\\Cart\\Events\\OrderPaid",d.UserLogged="EscolaLms\\Auth\\Events\\UserLogged"})(w||(w={}));var $;(function(d){d.draft="draft",d.published="published",d.archived="archived"})($||($={}));var p;(function(d){d.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",d.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",d.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel"})(p||(p={}));var P;(function(d){d.ManuallyTriggeredEvent="EscolaLms\\Templates\\Events\\ManuallyTriggeredEvent"})(P||(P={}));var l;(function(d){d.cart_fixed="cart_fixed",d.cart_percent="cart_percent",d.product_fixed="product_fixed",d.product_percent="product_percent"})(l||(l={}));var s;(function(d){d.MULTIPLE_CHOICE="multiple_choice",d.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS="multiple_choice_with_multiple_right_answers",d.TRUE_FALSE="true_false",d.SHORT_ANSWERS="short_answers",d.MATCHING="matching",d.NUMERICAL_QUESTION="numerical_question",d.ESSAY="essay",d.DESCRIPTION="description"})(s||(s={}));var ie;(function(d){d.PRESENT="present",d.ABSENT="absent"})(ie||(ie={}));var Be;(function(d){d.Manual="manual",d.TeamsForms="teams_forms",d.TeamsLecture="teams_lecture",d.TestPortal="test_portal"})(Be||(Be={}))},"0JQy":function($e,ce){var t="\\ud800-\\udfff",i="\\u0300-\\u036f",w="\\ufe20-\\ufe2f",$="\\u20d0-\\u20ff",p=i+w+$,P="\\ufe0e\\ufe0f",l="["+t+"]",s="["+p+"]",ie="\\ud83c[\\udffb-\\udfff]",Be="(?:"+s+"|"+ie+")",d="[^"+t+"]",q="(?:\\ud83c[\\udde6-\\uddff]){2}",Ce="[\\ud800-\\udbff][\\udc00-\\udfff]",xe="\\u200d",Z=Be+"?",Ie="["+P+"]?",ut="(?:"+xe+"(?:"+[d,q,Ce].join("|")+")"+Ie+Z+")*",Oe=Ie+Z+ut,et="(?:"+[d+s+"?",s,q,Ce,l].join("|")+")",ze=RegExp(ie+"(?="+ie+")|"+et+Oe,"g");function h(m){return m.match(ze)||[]}$e.exports=h},"5R/X":function($e,ce,t){},"5Syx":function($e,ce,t){"use strict";t.d(ce,"c",function(){return We}),t.d(ce,"b",function(){return it}),t.d(ce,"a",function(){return Q});var i=t("OaEy"),w=t("2fM7"),$=t("g9YV"),p=t("wCAj"),P=t("BoS7"),l=t("Sdc0"),s=t("jrin"),ie=t("k1fw"),Be=t("DYRE"),d=t("zeV3"),q=t("+BJd"),Ce=t("mr32"),xe=t("oBTY"),Z=t("tJVT"),Ie=t("q1tI"),ut=t.n(Ie),Oe=t("9kvl"),et=t("Vpfc"),ze=t("nhC9"),h=t("LDJE"),m=t("nKUr"),ke=t.n(m),tt=function(B){return B.topicable.content.contents?Object.values(B.topicable.content.contents)[0].library:"H5P"},We=function(B){var x=B.topics,K=B.stats,he=Object(Ie.useState)(!1),U=Object(Z.a)(he,2),b=U[0],ge=U[1],Me=Object(Ie.useMemo)(function(){return[{title:Object(m.jsx)(Oe.a,{id:"user"}),dataIndex:"id",render:function(Ge){return Object(m.jsx)(et.a,{type:"App\\Models\\User",type_id:Ge})}},{title:Object(m.jsx)(Oe.a,{id:"email"}),dataIndex:"email"}].concat(Object(xe.a)(x.map(function(Se){var Ge,Pe=(Ge=Se.topicable_type)===null||Ge===void 0?void 0:Ge.split("\\").pop();return Pe==="H5P"&&(Pe=tt(Se)),{render:function(R){var N=0,Ee=0;switch(R&&(R.started_at&&R.finished_at?N=1:R.started_at&&(N=2),Ee=R.seconds/60),N){case 1:return Object(m.jsxs)(d.b,{children:[Object(m.jsx)(Ce.a,{color:"success",children:"F"}),b&&Object(m.jsxs)("small",{children:[Ee.toFixed(2),"m"]})]});case 2:return Object(m.jsxs)(d.b,{children:[Object(m.jsx)(Ce.a,{color:"blue",children:"S"}),b&&Object(m.jsxs)("small",{children:[Ee.toFixed(2),"m"]})]});case 0:default:return Object(m.jsx)(ut.a.Fragment,{children:Object(m.jsx)(Ce.a,{color:"error",children:"N"})})}},title:Object(m.jsxs)("small",{children:[Object(m.jsx)(Ce.a,{children:Pe})," ",Se.title]}),dataIndex:Se.id}})))},[x,b]),Le=Object(Ie.useMemo)(function(){return K.map(function(Se){return x.reduce(function(Ge,Pe){var Ye=Se.topics.find(function(R){return R.id===Pe.id});return Object(ie.a)(Object(ie.a)({},Ge),{},Object(s.a)({},Number(Pe.id),Ye!=null?Ye:0))},{email:Se.email,id:Se.id})})},[K,x]);return Object(m.jsx)(p.a,{title:function(){return Object(m.jsxs)(d.b,{children:[Object(m.jsx)(Oe.a,{id:"Finished",defaultMessage:"Finished:"})," ",Object(m.jsx)(Ce.a,{color:"success",children:"F"}),Object(m.jsx)(Oe.a,{id:"Started",defaultMessage:"Started:"})," ",Object(m.jsx)(Ce.a,{color:"blue",children:"S"}),Object(m.jsx)(Oe.a,{id:"NotStarted",defaultMessage:"Not Started:"})," ",Object(m.jsx)(Ce.a,{color:"error",children:"N"}),Object(m.jsx)(Oe.a,{id:"ShowMinutes",defaultMessage:"Show minutes spent on topic:"})," ",Object(m.jsx)(l.a,{checked:b,onChange:function(Pe){return ge(Pe)}})]})},columns:Me,dataSource:Le,size:"small",scroll:{x:1500}})},it=function(B){var x=B.stats,K=Object(Ie.useMemo)(function(){return[{title:"user",dataIndex:"id",render:function(b){return Object(m.jsx)(et.a,{type:"App\\Models\\User",type_id:b})}},{title:"email",dataIndex:"email"},{title:Object(m.jsx)(Oe.a,{id:"finished_at",defaultMessage:"Finished at"}),dataIndex:"finished_at"}]},[]),he=Object(Ie.useMemo)(function(){return x.map(function(U){var b=U.id,ge=U.email,Me=U.finished_at;return{id:b,email:ge,finished_at:Me}})},[x]);return Object(m.jsx)(p.a,{title:function(){return Object(m.jsx)(d.b,{children:Object(m.jsx)(Oe.a,{id:"course.finished",defaultMessage:"Finished"})})},columns:K,dataSource:he,size:"small",scroll:{x:500}})},Q=function(B){var x=B.stats,K=Object(Ie.useState)(null),he=Object(Z.a)(K,2),U=he[0],b=he[1],ge=Object(Ie.useState)(null),Me=Object(Z.a)(ge,2),Le=Me[0],Se=Me[1],Ge=Object(Oe.l)(),Pe=Object(Ie.useMemo)(function(){return x.flatMap(function(R){return Object.values(R.attempts).flatMap(function(N){var Ee=N.dates,at=N.attempt,F=Object.values(Ee).flatMap(function(qe){var Xe=qe.date,lt=qe.seconds_total;return{date:Xe,attempt:at,seconds_total:lt,email:R.email}});return F})})},[x]),Ye={xField:"date",yField:"seconds_total",seriesField:"attempt",isStack:!0,xAxis:{label:{autoHide:!0,autoRotate:!1}},slider:{start:0,end:1},label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]}};return Object(m.jsx)(ze.a,{title:Object(m.jsxs)(d.b,{children:[Object(m.jsx)(Oe.a,{id:"course.interactions_time_in_days"}),Object(m.jsx)(w.a,{showSearch:!0,value:U,onChange:function(N){b(N),Se(null)},placeholder:Object(m.jsx)(Oe.a,{id:"select_person",defaultMessage:"Select a person"}),children:x.map(function(R){var N=R.id,Ee=R.email;return Object(m.jsx)(w.a.Option,{value:Ee,children:Ee},N)})}),Object(m.jsx)(w.a,{value:Le,onChange:function(N){return Se(N)},disabled:U===null,placeholder:Object(m.jsx)(Oe.a,{id:"select_attempt",defaultMessage:"Select attempt"}),children:Object(xe.a)(new Set(Pe.filter(function(R){var N=R.email;return N===U}).map(function(R){var N=R.attempt;return N}))).map(function(R){return Object(m.jsxs)(w.a.Option,{value:R,children:[Object(m.jsx)(Oe.a,{id:"attempt",defaultMessage:"Attempt"})," ",R]},R)})})]}),colSpan:12,layout:"center",children:Object(m.jsx)("div",{style:{overflow:"auto",minHeight:"400px",width:"100%"},children:Object(m.jsx)(h.a,Object(ie.a)(Object(ie.a)({},Ye),{},{tooltip:{title:"".concat(Ge.formatMessage({id:"attempt"})),formatter:function(N){var Ee=Math.floor(+N.seconds_total/60),at=+N.seconds_total>60?+N.seconds_total-Ee*60:0;return{name:N.attempt,value:"".concat(Ee,"m ").concat(at,"s")}}},data:Pe.filter(function(R){var N=R.email;return N===U}).filter(function(R){var N=R.attempt;return Number.isInteger(Le)?N===Le:!0})}))})})}},Em2t:function($e,ce,t){var i=t("bahg"),w=t("quyA"),$=t("0JQy");function p(P){return w(P)?$(P):i(P)}$e.exports=p},Hn4i:function($e,ce,t){"use strict";var i=t("y8nQ"),w=t("Vl3Y"),$=t("+L6B"),p=t("2/Rp"),P=t("rePB"),l=t("ODXe"),s=t("Ff2n"),ie=t("x+uP"),Be=t("HaE+"),d=t("VTBJ"),q=t("nKUr"),Ce=t.n(q),xe=t("xvlK"),Z=t("WuYN"),Ie=t("VMEa"),ut=t("LQCs"),Oe=t("ft2k"),et=t("uX+g"),ze=t("+i8S"),h=t("ipCM"),m=t("6cGi"),ke=t("ub+h"),tt=t("bG1m"),We=t("q1tI"),it=t.n(We),Q=t("mWMg"),J=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],B=["record","position","creatorButtonText","newRecordType","parentKey","style"],x=it.a.createContext(void 0);function K(b){var ge=b.children,Me=b.record,Le=b.position,Se=b.newRecordType,Ge=b.parentKey,Pe=Object(We.useContext)(x);return it.a.cloneElement(ge,Object(d.a)(Object(d.a)({},ge.props),{},{onClick:function(){var Ye=Object(Be.a)(Object(ie.a)().mark(function N(Ee){var at,F,qe,Xe;return Object(ie.a)().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.next=2,(at=(F=ge.props).onClick)===null||at===void 0?void 0:at.call(F,Ee);case 2:if(Xe=ne.sent,Xe!==!1){ne.next=5;break}return ne.abrupt("return");case 5:Pe==null||(qe=Pe.current)===null||qe===void 0||qe.addEditRecord(Me,{position:Le,newRecordType:Se,parentKey:Ge});case 6:case"end":return ne.stop()}},N)}));function R(N){return Ye.apply(this,arguments)}return R}()}))}function he(b){var ge,Me,Le=Object(ut.d)(),Se=b.onTableChange,Ge=b.maxLength,Pe=b.formItemProps,Ye=b.recordCreatorProps,R=b.rowKey,N=b.controlled,Ee=b.defaultValue,at=b.onChange,F=b.editableFormRef,qe=Object(s.a)(b,J),Xe=Object(Oe.a)(b.value),lt=Object(We.useRef)(),ne=Object(We.useRef)();Object(We.useImperativeHandle)(qe.actionRef,function(){return lt.current});var we=Object(m.a)(function(){return b.value||Ee||[]},{value:b.value,onChange:b.onChange}),mt=Object(l.a)(we,2),de=mt[0],Ue=mt[1],ct=it.a.useMemo(function(){return typeof R=="function"?R:function(Ae,X){return Ae[R]||X}},[R]),L=function(X){if(typeof X=="number"&&!b.name){if(X>=de.length)return X;var ee=de&&de[X];return ct==null?void 0:ct(ee,X)}if((typeof X=="string"||X>=de.length)&&b.name){var te=de.findIndex(function(le,oe){var Re;return(ct==null||(Re=ct(le,oe))===null||Re===void 0?void 0:Re.toString())===(X==null?void 0:X.toString())});return te}return X};Object(We.useImperativeHandle)(F,function(){var Ae=function(te){var le,oe;if(te==null)throw new Error("rowIndex is required");var Re=L(te),nt=[b.name,(le=Re==null?void 0:Re.toString())!==null&&le!==void 0?le:""].flat(1).filter(Boolean);return(oe=ne.current)===null||oe===void 0?void 0:oe.getFieldValue(nt)},X=function(){var te,le=[b.name].flat(1).filter(Boolean);if(Array.isArray(le)&&le.length===0){var oe,Re=(oe=ne.current)===null||oe===void 0?void 0:oe.getFieldsValue();return Array.isArray(Re)?Re:Object.keys(Re).map(function(nt){return Re[nt]})}return(te=ne.current)===null||te===void 0?void 0:te.getFieldValue(le)};return Object(d.a)(Object(d.a)({},ne.current),{},{getRowData:Ae,getRowsData:X,setRowData:function(te,le){var oe,Re,nt,jt;if(te==null)throw new Error("rowIndex is required");var Ot=L(te),Et=[b.name,(oe=Ot==null?void 0:Ot.toString())!==null&&oe!==void 0?oe:""].flat(1).filter(Boolean),yt=((Re=ne.current)===null||Re===void 0||(nt=Re.getFieldsValue)===null||nt===void 0?void 0:nt.call(Re))||{},Tt=Object(tt.a)(yt,Et,Object(d.a)(Object(d.a)({},Ae(te)),le||{}));return(jt=ne.current)===null||jt===void 0?void 0:jt.setFieldsValue(Tt)}})}),Object(We.useEffect)(function(){!b.controlled||de.forEach(function(Ae,X){var ee;(ee=ne.current)===null||ee===void 0||ee.setFieldsValue(Object(P.a)({},ct(Ae,X),Ae))},{})},[de,b.controlled]),Object(We.useEffect)(function(){if(b.name){var Ae;ne.current=b==null||(Ae=b.editable)===null||Ae===void 0?void 0:Ae.form}},[(ge=b.editable)===null||ge===void 0?void 0:ge.form,b.name]);var D=Ye||{},V=D.record,A=D.position,H=D.creatorButtonText,e=D.newRecordType,Fe=D.parentKey,Ze=D.style,_t=Object(s.a)(D,B),ht=A==="top",ot=Object(We.useMemo)(function(){return Ge&&Ge<=(de==null?void 0:de.length)?!1:Ye!==!1&&Object(q.jsx)(K,{record:Object(et.a)(V,de==null?void 0:de.length,de)||{},position:A,parentKey:Object(et.a)(Fe,de==null?void 0:de.length,de),newRecordType:e,children:Object(q.jsx)(p.a,Object(d.a)(Object(d.a)({type:"dashed",style:Object(d.a)({display:"block",margin:"10px 0",width:"100%"},Ze),icon:Object(q.jsx)(xe.a,{})},_t),{},{children:H||Le.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[Ye,Ge,de==null?void 0:de.length]),xt=Object(We.useMemo)(function(){return ot?ht?{components:{header:{wrapper:function(X){var ee,te=X.className,le=X.children;return Object(q.jsxs)("thead",{className:te,children:[le,Object(q.jsxs)("tr",{style:{position:"relative"},children:[Object(q.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:ot}),Object(q.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(ee=qe.columns)===null||ee===void 0?void 0:ee.length,children:ot})]})]})}}}}:{tableViewRender:function(X,ee){var te,le;return Object(q.jsxs)(q.Fragment,{children:[(te=(le=b.tableViewRender)===null||le===void 0?void 0:le.call(b,X,ee))!==null&&te!==void 0?te:ee,ot]})}}:{}},[ht,ot]),vt=Object(d.a)({},b.editable),St=Object(ze.a)(function(Ae,X){var ee,te,le;if((ee=b.editable)===null||ee===void 0||(te=ee.onValuesChange)===null||te===void 0||te.call(ee,Ae,X),(le=b.onValuesChange)===null||le===void 0||le.call(b,X,Ae),b.controlled){var oe;b==null||(oe=b.onChange)===null||oe===void 0||oe.call(b,X)}});return((b==null?void 0:b.onValuesChange)||((Me=b.editable)===null||Me===void 0?void 0:Me.onValuesChange)||b.controlled&&(b==null?void 0:b.onChange))&&(vt.onValuesChange=St),Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(x.Provider,{value:lt,children:Object(q.jsx)(Q.a,Object(d.a)(Object(d.a)(Object(d.a)({search:!1,options:!1,pagination:!1,rowKey:R,revalidateOnFocus:!1},qe),xt),{},{tableLayout:"fixed",actionRef:lt,onChange:Se,editable:Object(d.a)(Object(d.a)({},vt),{},{formProps:Object(d.a)({formRef:ne},vt.formProps)}),dataSource:de,onDataSourceChange:function(X){if(Ue(X),b.name&&A==="top"){var ee,te=Object(tt.a)({},[b.name].flat(1).filter(Boolean),X);(ee=ne.current)===null||ee===void 0||ee.setFieldsValue(te)}}}))}),b.name?Object(q.jsx)(Z.a,{name:[b.name],children:function(X){var ee,te,le=Object(ke.a)(X,[b.name].flat(1)),oe=le==null?void 0:le.find(function(Re,nt){return!Object(h.a)(Re,Xe==null?void 0:Xe[nt])});return oe&&Xe&&(b==null||(ee=b.editable)===null||ee===void 0||(te=ee.onValuesChange)===null||te===void 0||te.call(ee,oe,le)),null}}):null]})}function U(b){var ge=Ie.a.useFormInstance();return b.name?Object(q.jsx)(w.a.Item,Object(d.a)(Object(d.a)({style:{maxWidth:"100%"}},b==null?void 0:b.formItemProps),{},{name:b.name,children:Object(q.jsx)(he,Object(d.a)(Object(d.a)({},b),{},{editable:Object(d.a)(Object(d.a)({},b.editable),{},{form:ge})}))})):Object(q.jsx)(he,Object(d.a)({},b))}U.RecordCreator=K,ce.a=U},KxBF:function($e,ce){function t(i,w,$){var p=-1,P=i.length;w<0&&(w=-w>P?0:P+w),$=$>P?P:$,$<0&&($+=P),P=w>$?0:$-w>>>0,w>>>=0;for(var l=Array(P);++p<P;)l[p]=i[p+w];return l}$e.exports=t},LDJE:function($e,ce,t){"use strict";var i=t("q1tI"),w=t.n(i),$=t("ma/q"),p=t("ZIEt"),P=t("QpZ9"),l=t("GzfL"),s=t("Scwr"),ie=function(d,q){var Ce={};for(var xe in d)Object.prototype.hasOwnProperty.call(d,xe)&&q.indexOf(xe)<0&&(Ce[xe]=d[xe]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Z=0,xe=Object.getOwnPropertySymbols(d);Z<xe.length;Z++)q.indexOf(xe[Z])<0&&Object.prototype.propertyIsEnumerable.call(d,xe[Z])&&(Ce[xe[Z]]=d[xe[Z]]);return Ce},Be=Object(i.forwardRef)(function(d,q){var Ce=d.chartRef,xe=d.style,Z=xe===void 0?{height:"inherit"}:xe,Ie=d.className,ut=d.loading,Oe=d.loadingTemplate,et=d.errorTemplate,ze=ie(d,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),h=Object(p.a)($.a,ze),m=h.chart,ke=h.container;return Object(i.useEffect)(function(){Object(P.a)(Ce,m.current)},[m.current]),Object(i.useImperativeHandle)(q,function(){return{getChart:function(){return m.current}}}),w.a.createElement(l.a,{errorTemplate:et},ut&&w.a.createElement(s.a,{loadingTemplate:Oe,theme:d.theme}),w.a.createElement("div",{className:Ie,style:Z,ref:ke}))});ce.a=Be},bahg:function($e,ce){function t(i){return i.split("")}$e.exports=t},olry:function($e,ce,t){"use strict";t.r(ce);var i=t("k1fw"),w=t("+L6B"),$=t("2/Rp"),p=t("T2oS"),P=t("W9HT"),l=t("q1tI"),s=t("9kvl"),ie=t("55Ip"),Be=t("Ty5D"),d=t("nhC9"),q=t("tMyG"),Ce=t("my69"),xe=t("huej"),Z=t("mJ0o"),Ie=t("EhlZ"),ut=t("P2fV"),Oe=t("NJEC"),et=t("5Dmo"),ze=t("3S7+"),h=t("qLMh"),m=t("9og8"),ke=t("sWYD"),tt=t("G3dp"),We=t("lbgm"),it=t("/MfK"),Q=t("Qiat"),J=t("mGZj");function B(o,u){return x.apply(this,arguments)}function x(){return x=Object(m.a)(Object(h.a)().mark(function o(u,n){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(s.i)("/api/admin/exams",Object(i.a)({method:"GET",useCache:!1,params:u},n||{})));case 1:case"end":return a.stop()}},o)})),x.apply(this,arguments)}function K(o,u){return he.apply(this,arguments)}function he(){return he=Object(m.a)(Object(h.a)().mark(function o(u,n){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(s.i)("/api/admin/exams",Object(i.a)({method:"POST",headers:{"Content-Type":"application/json"},data:u},n||{})));case 1:case"end":return a.stop()}},o)})),he.apply(this,arguments)}function U(o,u,n){return b.apply(this,arguments)}function b(){return b=Object(m.a)(Object(h.a)().mark(function o(u,n,r){return Object(h.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(s.i)("/api/admin/exams/".concat(u),Object(i.a)({method:"PUT",data:n,useCache:!1},r||{})));case 1:case"end":return c.stop()}},o)})),b.apply(this,arguments)}function ge(o,u){return Me.apply(this,arguments)}function Me(){return Me=Object(m.a)(Object(h.a)().mark(function o(u,n){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(s.i)("/api/admin/exams/".concat(u),Object(i.a)({method:"GET",useCache:!1},n||{})));case 1:case"end":return a.stop()}},o)})),Me.apply(this,arguments)}function Le(o,u){return Se.apply(this,arguments)}function Se(){return Se=Object(m.a)(Object(h.a)().mark(function o(u,n){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(s.i)("/api/admin/exams/".concat(u),Object(i.a)({method:"DELETE"},n||{})));case 1:case"end":return a.stop()}},o)})),Se.apply(this,arguments)}function Ge(o,u,n,r){return Pe.apply(this,arguments)}function Pe(){return Pe=Object(m.a)(Object(h.a)().mark(function o(u,n,r,a){return Object(h.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(s.i)("/api/admin/exams/".concat(u,"/users/").concat(n),Object(i.a)({method:"POST",headers:{"Content-Type":"application/json"},data:r},a||{})));case 1:case"end":return j.stop()}},o)})),Pe.apply(this,arguments)}function Ye(o,u,n){return R.apply(this,arguments)}function R(){return R=Object(m.a)(Object(h.a)().mark(function o(u,n,r){return Object(h.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(s.i)("/api/admin/exams/".concat(u,"/users/").concat(n),Object(i.a)({method:"DELETE"},r||{})));case 1:case"end":return c.stop()}},o)})),R.apply(this,arguments)}var N=t("Vpfc"),Ee=t("giR+"),at=t("fyUT"),F=t("tJVT"),qe=t("14J3"),Xe=t("BMrR"),lt=t("jCWc"),ne=t("kPKH"),we=t("VMEa"),mt=t("Qurx"),de=t("lR9U"),Ue=t("/y+f"),ct=t("2qtc"),L=t("kLXV"),D=t("oBTY"),V=t("OaEy"),A=t("2fM7"),H=t("DBJ/"),e=t("nKUr"),Fe=function(u){var n=u.type,r=u.onDataConverted,a=u.groupSelectDisabled,c=Object(Z.b)(),j=c.semester_subject_id,E=c.teacherSubjectData,g=Object(l.useState)(null),y=Object(F.a)(g,2),S=y[0],v=y[1],_=Object(l.useMemo)(function(){var T;return((T=E==null?void 0:E.groups)!==null&&T!==void 0?T:[]).map(function(M){var I=M.id,se=M.name;return{label:se,value:I}})},[]),f={type:n,group_id:S,semester_subject_id:j},O=Object(l.useCallback)(function(T){if(T.success){var M=T.data.results.filter(function(I){var se=I.user_id;return se!==null});if(!M.length)return;r({exam_results:M,group_id:T.data.group_id})}},[]);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(we.a.Item,{label:Object(e.jsx)(s.a,{id:"group"}),children:Object(e.jsx)(A.a,{disabled:a,value:S,onChange:function(M){return v(M)},options:_,placeholder:Object(e.jsx)(s.a,{id:"select_group"}),style:{width:"100%"}})}),Object(e.jsx)(H.a,{name:"file",url:"/api/admin/exams/parse",onUpload:O,onChange:function(M){return!M.fileList.length&&r(void 0)},maxFiles:1,data:f,disabled:!S})]})},Ze=function(u){var n=u.onDataConverted,r=Object(Z.b)(),a=r.teacherSubjectData,c=r.groupUsers,j=Object(l.useState)(null),E=Object(F.a)(j,2),g=E[0],y=E[1],S=Object(l.useMemo)(function(){var _;return((_=a==null?void 0:a.groups)!==null&&_!==void 0?_:[]).map(function(f){var O=f.id,T=f.name;return{label:T,value:O}})},[]),v=Object(l.useCallback)(function(_){var f;y(_);var O=(f=c.byId)===null||f===void 0?void 0:f[_];if(!!O){var T=O.users.reduce(function(M,I){var se=I.id,C=I.email,je=I.first_name,Y=I.last_name,be=I.academic_teacher_id;return be!==null?M:[].concat(Object(D.a)(M),[{email:C,first_name:je,last_name:Y,user_id:se,result:0}])},[]);n({group_id:_,exam_results:T})}},[c.byId]);return Object(e.jsx)(A.a,{value:g,onChange:v,options:S,placeholder:Object(e.jsx)(s.a,{id:"select_group"}),style:{width:"100%"}})},_t=[Ue.b.TeamsLecture,Ue.b.TestPortal,Ue.b.TeamsForms],ht=function(u){var n=u.open,r=u.closeModal,a=u.onSuccess,c=u.type,j=Object(Z.b)(),E=j.teacherSubjectData,g=j.fetchGroupUsers,y=Object(l.useState)(),S=Object(F.a)(y,2),v=S[0],_=S[1];return Object(l.useEffect)(function(){if(c===Ue.b.Manual&&n){var f;E==null||(f=E.groups)===null||f===void 0||f.forEach(function(O){var T=O.id;return g(T)})}},[c,n]),Object(e.jsxs)(L.a,{title:Object(e.jsx)(s.a,{id:"TeacherSubjects.Exams.".concat(c,"Convert")}),width:"40vw",open:n,onCancel:r,onOk:function(){v&&a(v)},okButtonProps:{disabled:!v},children:[_t.includes(c)&&Object(e.jsx)(Fe,{type:c,onDataConverted:_,groupSelectDisabled:!!v}),c===Ue.b.Manual&&Object(e.jsx)(Ze,{onDataConverted:_})]})},ot=function(u){var n=u.onSelect;return Object(e.jsxs)(Xe.a,{gutter:[16,16],children:[Object(e.jsx)(ne.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return n(Ue.b.TeamsForms)},children:Object(e.jsx)(s.a,{id:"uploadFile.MsTeamsForms",defaultMessage:"uploadFile.MsTeamsForms"})})}),Object(e.jsx)(ne.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return n(Ue.b.TestPortal)},children:Object(e.jsx)(s.a,{id:"uploadFile.TestPortal",defaultMessage:"uploadFile.TestPortal"})})}),Object(e.jsx)(ne.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return n(Ue.b.TeamsLecture)},children:Object(e.jsx)(s.a,{id:"uploadFile.MsTeams",defaultMessage:"uploadFile.MsTeams"})})}),Object(e.jsx)(ne.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return n(Ue.b.Manual)},children:Object(e.jsx)(s.a,{id:"uploadGradesManually",defaultMessage:"uploadGradesManually"})})})]})},xt=[{title:Object(e.jsx)(s.a,{id:"first_name"}),dataIndex:"first_name",editable:!1},{title:Object(e.jsx)(s.a,{id:"last_name"}),dataIndex:"last_name",editable:!1},{title:Object(e.jsx)(s.a,{id:"examResult"}),dataIndex:"result",valueType:"percent",formItemProps:{rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(e.jsx)(s.a,{id:"number_between",values:{min:0,max:100}})}]}}],vt=function(u){var n,r=u.exam_id,a=we.a.useForm(),c=Object(F.a)(a,1),j=c[0],E=Object(l.useState)(),g=Object(F.a)(E,2),y=g[0],S=g[1],v=Object(l.useState)(),_=Object(F.a)(v,2),f=_[0],O=_[1],T=Object(l.useState)(!1),M=Object(F.a)(T,2),I=M[0],se=M[1],C=Object(Z.b)(),je=C.semester_subject_id,Y=C.getGroupById,be=Object(l.useMemo)(function(){var De;return((De=f==null?void 0:f.exam_results)!==null&&De!==void 0?De:[]).map(function(ue){var pe=ue.user_id;return pe})},[f==null?void 0:f.exam_results]);Object(l.useEffect)(function(){var De=Number(r);r==="new"&&(S(void 0),O(void 0),j.resetFields()),r!=="new"&&!Number.isNaN(De)&&(se(!0),ge(De).then(function(ue){if(ue.success){var pe=ue.data,k=pe.type,ae=pe.results,me=pe.title,ye=pe.weight,Te=pe.passed_at,dt=pe.group_id;S(k),O({group_id:dt,exam_results:ae}),j.setFieldsValue({title:me,weight:ye,passed_at:Te})}}).finally(function(){return se(!1)}))},[r]);var Ke=Object(l.useCallback)(function(){S(void 0),O(void 0)},[]);return I?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[y&&Object(e.jsx)(ht,{open:Boolean(y&&!f),type:y,closeModal:Ke,onSuccess:O}),Object(e.jsxs)(we.a,{form:j,submitter:y===void 0||!f?!1:void 0,onFinish:function(){var De=Object(m.a)(Object(h.a)().mark(function ue(pe){var k,ae,me,ye,Te,dt,fe,G,W,z;return Object(h.a)().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(ae=f==null||(k=f.exam_results)===null||k===void 0?void 0:k.every(function(He){var Ve=He.result;return typeof Ve=="number"&&Ve>=0&&Ve<=100}),!(f&&ae&&typeof je=="number")){re.next=17;break}if(me=pe.title,ye=pe.passed_at,Te=pe.weight,dt=Number(r),fe=f.exam_results,G=f.group_id,W={type:y,semester_subject_id:je,title:me,passed_at:ye,weight:Te,group_id:G,results:fe},!Number.isNaN(dt)){re.next=12;break}return re.next=9,K(W);case 9:re.t0=re.sent,re.next=15;break;case 12:return re.next=14,U(dt,W);case 14:re.t0=re.sent;case 15:z=re.t0,z.success&&s.f.push("/teacher/subjects/".concat(je,"/exams"));case 17:return re.abrupt("return",!0);case 18:case"end":return re.stop()}},ue)}));return function(ue){return De.apply(this,arguments)}}(),onReset:Ke,children:[Object(e.jsxs)(we.a.Group,{children:[Object(e.jsx)(mt.a,{label:Object(e.jsx)(s.a,{id:"examTitle",defaultMessage:"examTitle"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],width:"lg",name:"title"}),Object(e.jsx)(de.a,{label:Object(e.jsx)(s.a,{id:"datePassingExam",defaultMessage:"datePassingExam"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],width:"lg",name:"passed_at"}),Object(e.jsx)(we.a.Item,{name:"weight",label:Object(e.jsx)(s.a,{id:"examImportance",defaultMessage:"examImportance"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})},{type:"number",min:1,max:100,message:Object(e.jsx)(s.a,{id:"number_between",values:{min:1,max:100}})}],children:Object(e.jsx)(at.a,{})})]}),y&&f&&Object(e.jsx)(Q.a,{rowKey:"user_id",headerTitle:(n=Y(f.group_id))===null||n===void 0?void 0:n.name,editable:{type:"single",editableKeys:be,onValuesChange:function(ue,pe){return O({group_id:f.group_id,exam_results:pe})}},cardProps:{bodyStyle:{paddingInline:0}},search:!1,dataSource:f.exam_results,columns:xt}),!f&&Object(e.jsx)(ot,{onSelect:S})]})]})},St=[{title:Object(e.jsx)(s.a,{id:"first_name"}),dataIndex:"first_name"},{title:Object(e.jsx)(s.a,{id:"last_name"}),dataIndex:"last_name"},{title:Object(e.jsx)(s.a,{id:"examResult"}),dataIndex:"result",hideInSearch:!0}],Ae=function(u){var n=u.exam_id;return Object(e.jsx)(Q.a,{rowKey:"user_id",search:!1,headerTitle:Object(e.jsx)(s.a,{id:"examResults"}),request:Object(m.a)(Object(h.a)().mark(function r(){var a;return Object(h.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,ge(n);case 2:if(a=j.sent,!a.success){j.next=5;break}return j.abrupt("return",{total:a.data.results.length,success:!0,data:a.data.results});case 5:return j.abrupt("return",[]);case 6:case"end":return j.stop()}},r)})),columns:St})},X=[{title:Object(e.jsx)(s.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",sorter:!0},{title:Object(e.jsx)(s.a,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!0,sorter:!0},{title:Object(e.jsx)(s.a,{id:"type",defaultMessage:"type"}),dataIndex:"type",sorter:!0,render:function(u,n){return Object(e.jsx)(s.a,{id:"ExamGradeType.".concat(n.type)})}},{title:Object(e.jsx)(s.a,{id:"TeacherSubjects.Exams.exam_date",defaultMessage:"Exam date"}),dataIndex:"passed_at",sorter:!0,render:function(u,n){return n.passed_at&&Object(ke.a)(new Date(n.passed_at),J.c)}},{title:Object(e.jsx)(s.a,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",sorter:!0,render:function(u,n){return n.weight+"%"}},{title:Object(e.jsx)(s.a,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",sorter:!0,render:function(u,n){return n.created_at&&Object(ke.a)(new Date(n.created_at),J.c)}},{title:Object(e.jsx)(s.a,{id:"semester",defaultMessage:"Semester"}),dataIndex:"semester",sorter:!0,render:function(u,n){return Object(e.jsx)(s.a,{id:"SemesterType.".concat(n.semester.type),values:{year:n.semester.year}})}},{title:Object(e.jsx)(s.a,{id:"group",defaultMessage:"Group"}),dataIndex:"group_id",sorter:!0,render:function(u,n){return Object(e.jsx)(N.a,{type:"Students",type_id:n.group_id},n.group_id)}}],ee=function(){var u,n,r=Object(l.useRef)(),a=Object(Z.b)(),c=a.semester_subject_id,j=Object(Be.k)(),E=Object(l.useMemo)(function(){var S,v,_;return{exam_id:(S=(v=j.query)===null||v===void 0?void 0:v.exam_id)!==null&&S!==void 0?S:null,results:(_=j.query)===null||_===void 0?void 0:_.results}},[(u=j.query)===null||u===void 0?void 0:u.exam_id,(n=j.query)===null||n===void 0?void 0:n.results]),g=E.exam_id,y=E.results;return y!==null&&!Number.isNaN(Number(y))?Object(e.jsx)(Ae,{exam_id:Number(y)}):g!==null?Object(e.jsx)(vt,{exam_id:g}):Object(e.jsx)(Q.a,{headerTitle:Object(e.jsx)(s.a,{id:"exams"}),actionRef:r,search:!1,rowKey:"id",request:function(){var S=Object(m.a)(Object(h.a)().mark(function v(_,f){var O,T,M,I;return Object(h.a)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(O=_.current,T=_.pageSize,c!==null){C.next=3;break}return C.abrupt("return",{data:[],total:0,success:!1});case 3:return M=f&&Object.entries(f)[0],C.next=6,B({per_page:T,page:O,semester_subject_id:Number.isNaN(c)?void 0:c,order_by:M&&M[0],order:M&&(M[1]==="ascend"?"ASC":"DESC")});case 6:if(I=C.sent,!I.success){C.next=9;break}return C.abrupt("return",{data:I.data,total:I.meta.total,success:!0});case 9:return C.abrupt("return",{data:[],total:0,success:!1});case 10:case"end":return C.stop()}},v)}));return function(v,_){return S.apply(this,arguments)}}(),columns:[].concat(X,[{title:Object(e.jsx)(s.a,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(v,_){return[Object(e.jsx)(ie.a,{to:"/teacher/subjects/".concat(_.semester_subject_id,"/exams?exam_id=").concat(_.id),children:Object(e.jsx)(ze.a,{title:Object(e.jsx)(s.a,{id:"edit",defaultMessage:"edit"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(tt.a,{})})})},"edit"),Object(e.jsx)(ie.a,{to:"/teacher/subjects/".concat(_.semester_subject_id,"/exams?results=").concat(_.id),children:Object(e.jsx)(ze.a,{title:Object(e.jsx)(s.a,{id:"TeacherSubjects.Exams.results",defaultMessage:"results"}),children:Object(e.jsx)($.a,{icon:Object(e.jsx)(We.a,{})})})},"results"),Object(e.jsx)(Oe.a,{title:Object(e.jsx)(s.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(m.a)(Object(h.a)().mark(function f(){var O;return Object(h.a)().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,Le(_.id);case 2:O=M.sent,O.success&&r.current&&r.current.reload();case 4:case"end":return M.stop()}},f)})),okText:Object(e.jsx)(s.a,{id:"yes"}),cancelText:Object(e.jsx)(s.a,{id:"no"}),children:Object(e.jsx)(ze.a,{title:Object(e.jsx)(s.a,{id:"delete",defaultMessage:"delete"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(it.a,{}),danger:!0})})},"delete")]}}])})},te=t("o0Ox"),le=t("miYZ"),oe=t("tsqr"),Re=t("4KAj");function nt(o,u){return jt.apply(this,arguments)}function jt(){return jt=Object(m.a)(Object(h.a)().mark(function o(u,n){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(s.i)("/api/admin/chats/ms-teams",Object(i.a)({method:"POST",headers:{"Content-Type":"application/json"},data:u},n||{})));case 1:case"end":return a.stop()}},o)})),jt.apply(this,arguments)}var Ot=function(u){var n=u.student_id,r=Object(l.useState)(!1),a=Object(F.a)(r,2),c=a[0],j=a[1],E=Object(l.useCallback)(Object(m.a)(Object(h.a)().mark(function g(){var y;return Object(h.a)().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return j(!0),v.next=3,nt({user_id:n});case 3:if(y=v.sent,y.success){v.next=8;break}return oe.b.error(y.message),j(!1),v.abrupt("return");case 8:window.open(y.data.web_url,"_blank","noopener noreferrer"),j(!1);case 10:case"end":return v.stop()}},g)})),[]);return Object(e.jsx)(ze.a,{title:Object(e.jsx)(s.a,{id:"msTeams",defaultMessage:"teams"}),children:Object(e.jsx)($.a,{loading:c,type:"primary",icon:Object(e.jsx)(Re.a,{}),onClick:E})})},Et=[{title:Object(e.jsx)(s.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"user_id",hideInSearch:!0},{title:Object(e.jsx)(s.a,{id:"first_name",defaultMessage:"First name"}),dataIndex:"first_name"},{title:Object(e.jsx)(s.a,{id:"last_name",defaultMessage:"Last name"}),dataIndex:"last_name"},{title:Object(e.jsx)(s.a,{id:"email",defaultMessage:"email"}),dataIndex:"email"},{title:Object(e.jsx)(s.a,{id:"groupName",defaultMessage:"Group name"}),dataIndex:"group_name",hideInSearch:!0}],yt=function(u){return u.map(function(n){var r=n.id,a=n.name;return{label:a,value:r}})},Tt=function(u){return u.reduce(function(n,r){var a,c=r==null||(a=r.users)===null||a===void 0?void 0:a.map(function(j){return{group_id:r.id,group_name:r.name,user_id:j.id,first_name:j.first_name,last_name:j.last_name,email:j.email}});return[].concat(Object(D.a)(n),Object(D.a)(c))},[])},Yt=function(){var u=Object(Z.b)(),n=u.teacherSubjectData,r=Object(l.useMemo)(function(){var a;return yt((a=n==null?void 0:n.groups)!==null&&a!==void 0?a:[])},[n==null?void 0:n.groups]);return Object(e.jsx)(Q.a,{rowKey:function(c){return"".concat(c.group_id,"-").concat(c.user_id)},search:{layout:"vertical"},request:function(){var a=Object(m.a)(Object(h.a)().mark(function c(j){var E,g,y,S,v,_,f,O,T;return Object(h.a)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return E=j.groups,g=j.first_name,y=g===void 0?"":g,S=j.last_name,v=S===void 0?"":S,_=j.email,f=_===void 0?"":_,I.next=3,Object(te.a)({parent_id:n==null?void 0:n.group_id,"id[]":E});case 3:if(O=I.sent,O.success){I.next=6;break}return I.abrupt("return",{data:[],total:0,success:!1});case 6:return T=Tt(O.data).filter(function(se){return se.first_name.toLowerCase().includes(y.toLowerCase())&&se.last_name.toLowerCase().includes(v.toLowerCase())&&se.email.toLowerCase().includes(f.toLowerCase())}),I.abrupt("return",{data:T,total:T.length,success:!0});case 8:case"end":return I.stop()}},c)}));return function(c){return a.apply(this,arguments)}}(),columns:[{title:Object(e.jsx)(s.a,{id:"groups",defaultMessage:"Groups"}),dataIndex:"groups",hideInTable:!0,filterMultiple:!0,valueType:"select",fieldProps:{options:r,mode:"multiple"}}].concat(Et,[{hideInSearch:!0,title:Object(e.jsx)(s.a,{id:"msTeams"}),dataIndex:"teamsLink",valueType:"option",render:function(c,j){return[Object(e.jsx)(Ot,{student_id:j.user_id},"teamsChat")]}}])})},Aa=t("/zsF"),Ct=t("PArb"),Mt=t("jrin");function Pt(o,u){return Dt.apply(this,arguments)}function Dt(){return Dt=Object(m.a)(Object(h.a)().mark(function o(u,n){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(s.i)("/api/admin/schedules/groups/".concat(u),Object(i.a)({method:"GET",useCache:!1},n||{})));case 1:case"end":return a.stop()}},o)})),Dt.apply(this,arguments)}function Wt(o,u,n,r){return It.apply(this,arguments)}function It(){return It=Object(m.a)(Object(h.a)().mark(function o(u,n,r,a){return Object(h.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(s.i)("/api/admin/schedules/".concat(u,"/attendances"),Object(i.a)({data:{attendances:[{user_id:n,value:r}]},method:"POST"},a||{})));case 1:case"end":return j.stop()}},o)})),It.apply(this,arguments)}var Ra=t("sRBo"),wt=t("kaz8"),Zt=function(u){var n=u.currentData,r=u.recordData,a=u.groupId,c=u.onSuccess,j=Object(l.useState)(!1),E=Object(F.a)(j,2),g=E[0],y=E[1],S=function(){y(!0),Wt(n.id,r.id,(r==null?void 0:r[String(n.date_from)])===Ue.a.PRESENT?Ue.a.ABSENT:Ue.a.PRESENT).then(function(_){_.success&&Pt(Number(a)).then(function(f){f.success&&(c(f.data),y(!1))})})};return g?Object(e.jsx)(P.a,{size:"small"}):Object(e.jsx)(wt.a,{checked:(r==null?void 0:r[String(n.date_from)])===Ue.a.PRESENT,onChange:function(){return S()}})},Qt=Zt,Xt=function(){var u,n,r,a=Object(Z.b)(),c=a.teacherSubjectData,j=Object(s.l)(),E=Object(l.useState)(!1),g=Object(F.a)(E,2),y=g[0],S=g[1],v=Object(l.useState)(),_=Object(F.a)(v,2),f=_[0],O=_[1],T=Object(l.useState)(),M=Object(F.a)(T,2),I=M[0],se=M[1],C=Object(l.useState)({full_name:""}),je=Object(F.a)(C,2),Y=je[0],be=je[1],Ke=Object(l.useState)((u=c==null||(n=c.groups)===null||n===void 0||(r=n[0])===null||r===void 0?void 0:r.id)!==null&&u!==void 0?u:null),De=Object(F.a)(Ke,2),ue=De[0],pe=De[1],k=Object(l.useMemo)(function(){var G;return((G=I==null?void 0:I.users)!==null&&G!==void 0?G:[]).reduce(function(W,z){var ve=z.id,re=z.first_name,He=z.last_name,Ve=z.academic_teacher_id,Ne={id:ve,full_name:"".concat(re," ").concat(He),academic_teacher_id:Ve};if(!Ne.full_name.toLowerCase().includes(Y.full_name.toLowerCase())||Ve!==null)return W;var Qe=(f!=null?f:[]).reduce(function(_e,Je){var ft=Je.attendances.find(function(pt){return pt.user_id===ve});return Object(i.a)(Object(i.a)({},_e),{},Object(Mt.a)({},String(Je.date_from),ft==null?void 0:ft.value))},{}),bt=Object(i.a)(Object(i.a)({},Ne),Qe);return[].concat(Object(D.a)(W),[bt])},[])},[I,f,Y==null?void 0:Y.full_name]),ae=Object(l.useMemo)(function(){var G=(f!=null?f:[]).reduce(function(W,z){return[].concat(Object(D.a)(W),[{title:String(Object(ke.a)(new Date(z.date_from),J.c)),dataIndex:String(z.date_from),hideInSearch:!0,width:100,align:"center",render:function(re,He){return Object(e.jsx)(Qt,{currentData:z,recordData:He,onSuccess:function(Ne){return O(Ne)},groupId:ue})}}])},[]);return S(!1),[{title:Object(e.jsx)(s.a,{id:"nameAndSurname",defaultMessage:"Name and surname"}),dataIndex:"full_name",fixed:"left"}].concat(Object(D.a)(G))},[f]),me=Object(l.useCallback)(function(G){var W,z;if(G===null)return"";var ve=c==null||(W=c.groups)===null||W===void 0?void 0:W.find(function(re){return re.id===G});return(z=ve==null?void 0:ve.name)!==null&&z!==void 0?z:""},[c==null?void 0:c.groups]),ye=Object(l.useCallback)(function(){return be({full_name:""})},[]),Te=Object(l.useCallback)(function(G){var W=G.full_name,z=W===void 0?"":W;return be({full_name:z})},[]),dt=Object(l.useMemo)(function(){var G;return((G=c==null?void 0:c.groups)!==null&&G!==void 0?G:[]).map(function(W){var z=W.id,ve=W.name;return{value:z,label:ve}})},[c==null?void 0:c.groups]),fe=Object(l.useCallback)(function(G){ye(),S(!0),pe(G)},[]);return Object(l.useEffect)(function(){ue!==null&&(Pt(ue).then(function(G){G.success&&O(G.data)}),Object(te.b)(ue).then(function(G){G.success&&se(G.data)}))},[ue]),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(we.a.Item,{label:Object(e.jsx)(s.a,{id:"group"}),children:Object(e.jsx)(A.a,{onChange:fe,value:ue,options:dt})}),Object(e.jsx)(Ct.a,{}),ae.length===1?Object(e.jsx)(s.a,{id:"noAttendanceSchedule",defaultMessage:"No attendance schedule for this group..."}):Object(e.jsx)(Q.a,{className:"attendances-table",headerTitle:"".concat(j.formatMessage({id:"attendances",defaultMessage:"Attendances"})," (").concat(me(ue),")"),rowKey:"id",onSubmit:Te,onReset:ye,search:{layout:"vertical"},loading:y,dataSource:k,scroll:{x:1500},columns:ae})]})},kt=t("Hn4i"),qt=t("bRQS");function Vt(o,u,n){return At.apply(this,arguments)}function At(){return At=Object(m.a)(Object(h.a)().mark(function o(u,n,r){return Object(h.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(s.i)("/api/admin/semester-subjects/".concat(u,"/tutors/").concat(n,"/grades"),Object(i.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return c.stop()}},o)})),At.apply(this,arguments)}function ea(o,u,n,r){return Rt.apply(this,arguments)}function Rt(){return Rt=Object(m.a)(Object(h.a)().mark(function o(u,n,r,a){return Object(h.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(s.i)("/api/admin/semester-subjects/".concat(u,"/tutors/").concat(n,"/grades"),Object(i.a)({method:"POST",data:r},a||{})));case 1:case"end":return j.stop()}},o)})),Rt.apply(this,arguments)}function ta(o,u){return Lt.apply(this,arguments)}function Lt(){return Lt=Object(m.a)(Object(h.a)().mark(function o(u,n){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(s.i)("/api/admin/lesson-group-users",Object(i.a)({method:"GET",params:{"groups[]":u},useCache:!1},n||{})));case 1:case"end":return a.stop()}},o)})),Lt.apply(this,arguments)}function aa(o,u,n){return Gt.apply(this,arguments)}function Gt(){return Gt=Object(m.a)(Object(h.a)().mark(function o(u,n,r){return Object(h.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(s.i)("/api/admin/lesson-group-users/groups/".concat(u,"/users/").concat(n),Object(i.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return c.stop()}},o)})),Gt.apply(this,arguments)}function na(o){return Ut.apply(this,arguments)}function Ut(){return Ut=Object(m.a)(Object(h.a)().mark(function o(u){return Object(h.a)().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",Object(s.i)("/api/admin/grade-terms",Object(i.a)({method:"GET",useCache:!1},u||{})));case 1:case"end":return r.stop()}},o)})),Ut.apply(this,arguments)}function ra(o,u){return Ft.apply(this,arguments)}function Ft(){return Ft=Object(m.a)(Object(h.a)().mark(function o(u,n){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(s.i)("/api/admin/grade-scales/".concat(u),Object(i.a)({method:"GET",useCache:!1},n||{})));case 1:case"end":return a.stop()}},o)})),Ft.apply(this,arguments)}function sa(o,u){return $t.apply(this,arguments)}function $t(){return $t=Object(m.a)(Object(h.a)().mark(function o(u,n){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(s.i)("/api/admin/final-grades",Object(i.a)({method:"POST",data:u},n||{})));case 1:case"end":return a.stop()}},o)})),$t.apply(this,arguments)}function ua(o,u,n){return Bt.apply(this,arguments)}function Bt(){return Bt=Object(m.a)(Object(h.a)().mark(function o(u,n,r){return Object(h.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(s.i)("/api/admin/final-grades/".concat(u),Object(i.a)({method:"PATCH",data:n},r||{})));case 1:case"end":return c.stop()}},o)})),Bt.apply(this,arguments)}var ca=[{title:Object(e.jsx)(s.a,{id:"grade"}),dataIndex:"grade",editable:!1},{title:Object(e.jsx)(s.a,{id:"degree"}),dataIndex:"name",editable:!1},{title:Object(e.jsx)(s.a,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent",formItemProps:{rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(e.jsx)(s.a,{id:"number_between",values:{min:0,max:100}})}]}}],ia=function(){var u,n,r=Object(s.m)("@@initialState"),a=r.initialState,c=Object(Z.b)(),j=c.semester_subject_id,E=c.tutors,g=we.a.useForm(),y=Object(F.a)(g,1),S=y[0],v=Object(l.useState)([]),_=Object(F.a)(v,2),f=_[0],O=_[1],T=Object(l.useRef)(),M=Object(l.useState)(!1),I=Object(F.a)(M,2),se=I[0],C=I[1],je=Object(l.useState)(null),Y=Object(F.a)(je,2),be=Y[0],Ke=Y[1],De=Object(l.useMemo)(function(){return!!E.data.find(function(k){var ae,me=k.id;return me===(a==null||(ae=a.currentUser)===null||ae===void 0?void 0:ae.id)})},[E.data,a==null||(u=a.currentUser)===null||u===void 0?void 0:u.id]),ue=Object(l.useMemo)(function(){return E.data.map(function(k){var ae=k.id,me=k.first_name,ye=k.last_name;return{label:"".concat(me," ").concat(ye),value:ae}})},[E.data]);Object(l.useEffect)(function(){var k,ae;if(!De||!(a!=null&&(k=a.currentUser)!==null&&k!==void 0&&k.id)){var me;if((me=E.data)!==null&&me!==void 0&&me[0]){var ye;Ke((ye=E.data)===null||ye===void 0?void 0:ye[0].id)}return}Ke(a==null||(ae=a.currentUser)===null||ae===void 0?void 0:ae.id)},[a==null||(n=a.currentUser)===null||n===void 0?void 0:n.id,De]),Object(l.useEffect)(function(){j===null||be===null||(C(!0),Vt(j,be).then(function(k){if(k.success){var ae,me=((ae=k.data.grade_scale)!==null&&ae!==void 0?ae:[]).map(function(ye,Te){return Object(i.a)(Object(i.a)({},ye),{},{id:String((Te+1)*100)})});S.setFieldValue("table",me)}}).finally(function(){C(!1)}))},[j,be]);var pe=Object(l.useCallback)(function(){var k=Object(m.a)(Object(h.a)().mark(function ae(me){return Object(h.a)().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:if(!(j===null||be===null)){Te.next=2;break}return Te.abrupt("return");case 2:return Te.next=4,ea(j,be,{grade_scale:me.table});case 4:case"end":return Te.stop()}},ae)}));return function(ae){return k.apply(this,arguments)}}(),[be,j]);return E.loading?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(we.a.Item,{label:Object(e.jsx)(s.a,{id:"menu.Teacher"}),children:Object(e.jsx)(A.a,{disabled:De,placeholder:Object(e.jsx)(s.a,{id:"select"}),options:ue,value:be,onChange:function(ae){return Ke(ae)}})}),Object(e.jsx)(Ct.a,{}),Object(e.jsx)(we.a,{form:S,onFinish:pe,submitter:{render:function(ae,me){var ye=Object(F.a)(me,2),Te=ye[1];return[Te]}},children:Object(e.jsx)(kt.a,{name:"table",rowKey:"id",actionRef:T,formItemProps:{label:Object(e.jsx)(s.a,{id:"grades-scale"})},cardProps:{bodyStyle:{padding:0}},recordCreatorProps:!1,loading:se,columns:[].concat(ca,[{title:Object(e.jsx)(s.a,{id:"options"}),valueType:"option",render:function(ae,me){return Object(e.jsx)($.a,{type:"primary",onClick:function(){var Te;return(Te=T.current)===null||Te===void 0?void 0:Te.startEditable(me.id)},icon:Object(e.jsx)(tt.a,{})})}}]),editable:{form:S,type:"multiple",editableKeys:f,saveText:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(qt.a,{})}),onChange:O,actionRender:function(ae,me,ye){return[ye.save]}}})})]})},La=t("qbNl"),la=t("JBPa"),Ga=t("tU7J"),rt=t("wFql"),Ua=t("Awhp"),da=t("KrTs"),oa=t("wd/R"),st=t.n(oa);function ja(o,u){return Kt.apply(this,arguments)}function Kt(){return Kt=Object(m.a)(Object(h.a)().mark(function o(u,n){return Object(h.a)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(s.i)("/api/admin/schedules",Object(i.a)({params:u,method:"GET",useCache:!1},n||{})));case 1:case"end":return a.stop()}},o)})),Kt.apply(this,arguments)}var Fa=t("5R/X"),ba=function(){var u=Object(l.useState)(null),n=Object(F.a)(u,2),r=n[0],a=n[1],c=Object(l.useState)([]),j=Object(F.a)(c,2),E=j[0],g=j[1],y=Object(Z.b)(),S=y.semester_subject_id,v=st()(),_=Object(l.useMemo)(function(){return E.map(function(C){return{id:C.id,title:"".concat(C.group.name," (").concat(C.term_status.name,")"),start:st()(C.date_from).toDate(),end:st()(C.date_to).toDate(),tutor_name:"".concat(C.tutor.first_name," ").concat(C.tutor.last_name),tutor_email:C.tutor.email,semester:C.semester.name,group:C.group.name,subject:C.subject.name,ms_teams_join_url:C.ms_teams_join_url}})},[E]),f=Object(l.useCallback)(function(C,je){ja({semester_subject_id:S,date_form:C.toDate(),date_to:je.toDate()}).then(function(Y){Y.success&&g(Y.data)})},[S]),O=Object(l.useCallback)(function(C){a(C)},[]),T=Object(l.useCallback)(function(){a(null)},[]),M=Object(l.useCallback)(function(C){return C.isSame(v,"day")?"warning":C.isAfter(v,"day")?"success":"error"},[]),I=Object(l.useCallback)(function(C){var je=_.filter(function(Y){return st()(Y.start).isSame(C,"day")});return Object(e.jsx)("ul",{className:"events",children:je.map(function(Y){return Object(e.jsx)("li",{onClick:function(){return O(Y)},children:Object(e.jsx)(da.a,{status:M(st()(Y.start)),text:Y.title})},Y.id)})})},[E]),se=Object(l.useCallback)(function(C,je){var Y=st()(C).startOf(je).subtract(1,"month"),be=st()(C).endOf(je).add(1,"month");f(Y,be)},[]);return Object(l.useEffect)(function(){var C=st()().startOf("month"),je=st()().endOf("month");f(C,je)},[]),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(rt.a.Title,{level:4,children:Object(e.jsx)(s.a,{id:"schedule",defaultMessage:"Schedule"})}),Object(e.jsx)(la.a,{dateCellRender:I,onPanelChange:se}),Object(e.jsxs)(L.a,{open:r!==null,title:"".concat(r==null?void 0:r.subject,": ").concat(r==null?void 0:r.title),onCancel:T,footer:null,children:[Object(e.jsxs)(rt.a.Paragraph,{children:[Object(e.jsx)(s.a,{id:"tutorName",defaultMessage:"Tutor"}),": ",r==null?void 0:r.tutor_name]}),Object(e.jsxs)(rt.a.Paragraph,{children:[Object(e.jsx)(s.a,{id:"email",defaultMessage:"Email"}),": ",r==null?void 0:r.tutor_email]}),Object(e.jsxs)(rt.a.Paragraph,{children:[Object(e.jsx)(s.a,{id:"group",defaultMessage:"Group"}),": ",r==null?void 0:r.group]}),Object(e.jsxs)(rt.a.Paragraph,{children:[Object(e.jsx)(s.a,{id:"semester",defaultMessage:"Semester"}),": ",r==null?void 0:r.semester]}),Object(e.jsxs)(rt.a.Paragraph,{children:[Object(e.jsx)(s.a,{id:"started_at",defaultMessage:"Start date"}),":",r&&st()(r.start).format(J.b)]}),Object(e.jsxs)(rt.a.Paragraph,{children:[Object(e.jsx)(s.a,{id:"end_at",defaultMessage:"End date"}),":",r&&st()(r.end).format(J.b)]}),(r==null?void 0:r.ms_teams_join_url)&&Object(e.jsx)(rt.a.Paragraph,{children:Object(e.jsx)("a",{href:r.ms_teams_join_url,target:"_blank",rel:"noreferrer",children:Object(e.jsx)($.a,{type:"primary",children:Object(e.jsx)(s.a,{id:"msTeams"})})},"teamsLink")})]})]})},Ht=t("yj/a"),Jt=t("5Syx"),zt=t("PpiC"),Nt=t("H6aw"),fa=t("p3I6"),ma=["attendances"],va=["results"];function Oa(o,u){var n=Object(l.useState)({loading:!1}),r=Object(F.a)(n,2),a=r[0],c=r[1];return Object(l.useEffect)(function(){c(function(j){return Object(i.a)(Object(i.a)({},j),{},{loading:!0})}),aa(o,u).then(function(j){j.success&&c(function(E){return Object(i.a)(Object(i.a)({},E),{},{data:j.data})})}).finally(function(){c(function(j){return Object(i.a)(Object(i.a)({},j),{},{loading:!1})})})},[u,o]),{finalGrades:a}}function ha(){var o=Object(l.useState)({loading:!1}),u=Object(F.a)(o,2),n=u[0],r=u[1];return Object(l.useEffect)(function(){r(function(a){return Object(i.a)(Object(i.a)({},a),{},{loading:!0})}),na().then(function(a){a.success&&r(function(c){return Object(i.a)(Object(i.a)({},c),{},{data:a.data})})}).finally(function(){r(function(a){return Object(i.a)(Object(i.a)({},a),{},{loading:!1})})})},[]),{gradeTerms:n}}function ga(o){var u=Object(l.useState)({loading:!1}),n=Object(F.a)(u,2),r=n[0],a=n[1];return Object(l.useEffect)(function(){o!==void 0&&(a(function(c){return Object(i.a)(Object(i.a)({},c),{},{loading:!0})}),ra(o).then(function(c){c.success&&a(function(j){return Object(i.a)(Object(i.a)({},j),{},{data:c.data})})}).finally(function(){a(function(c){return Object(i.a)(Object(i.a)({},c),{},{loading:!1})})}))},[o]),{subjectGradeScales:r}}function pa(o,u){var n=Object(l.useState)({loading:!1}),r=Object(F.a)(n,2),a=r[0],c=r[1];return Object(l.useEffect)(function(){typeof o!="number"||typeof u!="number"||(c(function(j){return Object(i.a)(Object(i.a)({},j),{},{loading:!0})}),Vt(o,u).then(function(j){j.success&&c(function(E){return Object(i.a)(Object(i.a)({},E),{},{data:j.data.grade_scale.map(function(g,y){return Object(i.a)(Object(i.a)({},g),{},{id:y})})})})}).finally(function(){c(function(j){return Object(i.a)(Object(i.a)({},j),{},{loading:!1})})}))},[o,u]),{tutorGradeScales:a}}function _a(o,u){var n=Object(l.useState)({loading:!1}),r=Object(F.a)(n,2),a=r[0],c=r[1],j=Object(l.useCallback)(function(){c(function(g){return Object(i.a)(Object(i.a)({},g),{},{loading:!0})}),Pt(o).then(function(g){if(g.success){var y=g.data.reduce(function(S,v){var _=v.attendances,f=Object(zt.a)(v,ma),O=_.find(function(T){return T.user_id===u});return O?[].concat(Object(D.a)(S),[Object(i.a)(Object(i.a)({},f),{},{attendance:O})]):S},[]);c(function(S){return Object(i.a)(Object(i.a)({},S),{},{data:y})})}}).finally(function(){c(function(g){return Object(i.a)(Object(i.a)({},g),{},{loading:!1})})})},[o,u]),E=Object(l.useCallback)(function(g,y){c(function(S){return Object(i.a)(Object(i.a)({},S),{},{loading:!0})}),Wt(g,u,y).then(function(S){S.success?oe.b.success(S.message):oe.b.error(S.message)}).finally(function(){j(),c(function(S){return Object(i.a)(Object(i.a)({},S),{},{loading:!1})})})},[j,u]);return Object(l.useEffect)(function(){j()},[j]),{userAttendanceSchedules:a,fetchUserAttendanceSchedules:j,updateUserAttendanceSchedules:E}}function xa(o,u){var n=Object(l.useState)({loading:!1}),r=Object(F.a)(n,2),a=r[0],c=r[1];return Object(l.useEffect)(function(){!u||(c(function(j){return Object(i.a)(Object(i.a)({},j),{},{loading:!0})}),B({student_id:o,semester_subject_id:u}).then(function(j){if(j.success){var E=j.data.reduce(function(g,y){var S=Object(F.a)(y.results,1),v=S[0],_=Object(zt.a)(y,va);return v?[].concat(Object(D.a)(g),[Object(i.a)(Object(i.a)({},_),{},{result:v})]):g},[]);c(function(g){return Object(i.a)(Object(i.a)({},g),{},{data:E})})}}).finally(function(){c(function(j){return Object(i.a)(Object(i.a)({},j),{},{loading:!1})})}))},[o,u]),{studentExams:a}}function Sa(o,u){var n=Object(l.useState)({loading:!1}),r=Object(F.a)(n,2),a=r[0],c=r[1],j=Object(l.useState)({loading:!1}),E=Object(F.a)(j,2),g=E[0],y=E[1],S=Object(l.useState)({loading:!1}),v=Object(F.a)(S,2),_=v[0],f=v[1];return Object(l.useEffect)(function(){c(function(O){return Object(i.a)(Object(i.a)({},O),{},{loading:!0})}),Object(Nt.e)({group_id:o}).then(function(O){O.success&&c(function(T){return Object(i.a)(Object(i.a)({},T),{},{data:O.data})})}).finally(function(){c(function(O){return Object(i.a)(Object(i.a)({},O),{},{loading:!1})})})},[o]),Object(l.useEffect)(function(){!a.data||(f(function(O){return Object(i.a)(Object(i.a)({},O),{},{loading:!0})}),Promise.all(a.data.map(function(O){var T=O.id;return Object(Nt.m)(Number(T))})).then(function(O){O.forEach(function(T){T.success&&f(function(M){return Object(i.a)(Object(i.a)({},M),{},{data:Object(i.a)(Object(i.a)({},M.data),{},Object(Mt.a)({},Number(T.data.id),Object(fa.c)(T.data.lessons)))})})})}).finally(function(){f(function(O){return Object(i.a)(Object(i.a)({},O),{},{loading:!1})})}),y(function(O){return Object(i.a)(Object(i.a)({},O),{},{loading:!0})}),Promise.all(a.data.map(function(O){var T=O.id;return Object(Nt.l)(Number(T),["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics","EscolaLms\\Reports\\Stats\\Course\\AttendanceList"]).then(function(M){if(M.success){var I,se,C=((I=M.data["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics"])!==null&&I!==void 0?I:[]).filter(function(Y){return Y.id===u}),je=(se=M.data["EscolaLms\\Reports\\Stats\\Course\\AttendanceList"])!==null&&se!==void 0?se:[];y(function(Y){return Object(i.a)(Object(i.a)({},Y),{},{data:Object(i.a)(Object(i.a)({},Y.data),{},Object(Mt.a)({},Number(T),{finishedTopics:C,attendanceList:je}))})})}})})).finally(function(){return y(function(O){return Object(i.a)(Object(i.a)({},O),{},{loading:!1})})}))},[a.data,u]),{userCourses:a,userCoursesStats:g,userCoursesTopics:_}}var Ea=[{title:Object(e.jsx)(s.a,{id:"grade"}),dataIndex:"grade"},{title:Object(e.jsx)(s.a,{id:"degree"}),dataIndex:"name"},{title:Object(e.jsx)(s.a,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent"}],ya=[{title:Object(e.jsx)(s.a,{id:"date"}),dataIndex:"date_from",render:function(u,n){return Object(ke.a)(new Date(n.date_from),J.c)}}],Ta=[{title:Object(e.jsx)(s.a,{id:"name"}),dataIndex:"title"},{title:Object(e.jsx)(s.a,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",valueType:"percent"},{title:Object(e.jsx)(s.a,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",render:function(u,n){return Object(ke.a)(new Date(n.created_at),J.c)}},{title:Object(e.jsx)(s.a,{id:"grade"}),dataIndex:"result",render:function(u,n){return"".concat(n.result.result,"%")}}],Ca=[{title:Object(e.jsx)(s.a,{id:"name"}),dataIndex:"name"},{title:Object(e.jsx)(s.a,{id:"issued_at"}),dataIndex:"grade",render:function(u,n){var r,a;return(r=n.grade)!==null&&r!==void 0&&r.grade_date?Object(ke.a)(new Date((a=n.grade)===null||a===void 0?void 0:a.grade_date),J.c):"-"}},{title:Object(e.jsx)(s.a,{id:"grade"}),dataIndex:"grade",render:function(u,n){var r,a;return(r=(a=n.grade)===null||a===void 0?void 0:a.grade_name)!==null&&r!==void 0?r:"-"}}],gt=6,Ma=function(u){var n,r,a=u.user_id,c=u.group_id,j=Object(Z.b)(),E=j.semester_subject_id,g=xa(a,E),y=g.studentExams,S=Oa(c,a),v=S.finalGrades,_=ha(),f=_.gradeTerms,O=ga((n=v.data)===null||n===void 0?void 0:n.s_subject_scale_form_id),T=O.subjectGradeScales,M=pa(E,(r=v.data)===null||r===void 0?void 0:r.tutor_id),I=M.tutorGradeScales,se=_a(c,a),C=se.userAttendanceSchedules,je=se.updateUserAttendanceSchedules,Y=Sa(c,a),be=Y.userCourses,Ke=Y.userCoursesStats,De=Y.userCoursesTopics,ue=we.a.useForm(),pe=Object(F.a)(ue,1),k=pe[0],ae=Object(l.useMemo)(function(){var fe;return((fe=f.data)!==null&&fe!==void 0?fe:[]).map(function(G){var W=G.id,z=G.name;return{label:z,value:W}})},[f.data]),me=Object(l.useMemo)(function(){var fe;return((fe=T.data)!==null&&fe!==void 0?fe:[]).map(function(G){var W=G.name,z=G.id;return{label:W,value:z}})},[T.data]),ye=Object(l.useMemo)(function(){var fe,G,W,z=((fe=y.data)!==null&&fe!==void 0?fe:[]).reduce(function(_e,Je){var ft=Je.result,pt=Je.weight;return[_e[0]+ft.result*pt,_e[1]+pt]},[0,0]),ve=Object(F.a)(z,2),re=ve[0],He=ve[1],Ve=Number.isNaN(re/He)?0:re/He,Ne=((G=I.data)!==null&&G!==void 0?G:[]).sort(function(_e,Je){return _e.grade_value-Je.grade_value}).reduce(function(_e,Je){return[].concat(Object(D.a)(_e),[Object(i.a)(Object(i.a)({},Je),{},{isWeightedAverageGreater:Ve>=Je.grade_value})])},[]);if(Ne.every(function(_e){var Je=_e.isWeightedAverageGreater;return Je})){var Qe;return(Qe=Ne.at(-1))===null||Qe===void 0?void 0:Qe.name}var bt=Ne.findIndex(function(_e){var Je=_e.isWeightedAverageGreater;return!Je});return bt<0?"":(W=Ne[bt-1])===null||W===void 0?void 0:W.name},[y.data,I.data]),Te=Object(l.useCallback)(function(){var fe=Object(m.a)(Object(h.a)().mark(function G(W){var z,ve,re,He,Ve,Ne,Qe;return Object(h.a)().wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:if(re=W.grade_scale_id,He=W.grade_term_id,((z=v.data)===null||z===void 0?void 0:z.id)!==void 0){_e.next=3;break}return _e.abrupt("return");case 3:if(Ve=(ve=v.data)===null||ve===void 0?void 0:ve.grades.find(function(Je){var ft=Je.grade_term;return ft.id===He}),!Ve){_e.next=11;break}return _e.next=7,ua(Ve.id,{grade_scale_id:re});case 7:return Ne=_e.sent,oe.b[Ne.success?"success":"error"](Ne.message),Ne.success&&s.f.push("/teacher/subjects/".concat(E,"/final-grades")),_e.abrupt("return");case 11:return _e.next=13,sa({grade_scale_id:re,grade_term_id:He,lesson_group_user_id:v.data.id});case 13:Qe=_e.sent,oe.b[Qe.success?"success":"error"](Qe.message),Qe.success&&s.f.push("/teacher/subjects/".concat(E,"/final-grades"));case 16:case"end":return _e.stop()}},G)}));return function(G){return fe.apply(this,arguments)}}(),[v.data,E]),dt=Object(l.useMemo)(function(){var fe;return((fe=f.data)!==null&&fe!==void 0?fe:[]).map(function(G){var W;return Object(i.a)(Object(i.a)({},G),{},{grade:(W=v.data)===null||W===void 0?void 0:W.grades.find(function(z){var ve=z.grade_term;return ve.id===G.id})})})},[v.data,f.data]);return v.loading?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[v.data&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(rt.a.Text,{style:{fontSize:"16px",fontWeight:500},children:Object(e.jsx)(s.a,{id:"TeacherSubjects.FinalGrades.Student",values:v.data.user})}),Object(e.jsx)(Ct.a,{})]}),Object(e.jsxs)(Xe.a,{gutter:[48,48],justify:"space-between",children:[Object(e.jsx)(ne.a,{span:12,children:Object(e.jsx)(Q.a,{rowKey:"id",headerTitle:Object(e.jsx)(s.a,{id:"TeacherSubjects.FinalGrades.StudentPartialGrades"}),search:!1,pagination:{pageSize:gt},dataSource:y.data,loading:y.loading,columns:Ta,options:!1,cardProps:{bodyStyle:{padding:0}}})}),Object(e.jsx)(ne.a,{span:12,children:Object(e.jsx)(Q.a,{rowKey:"id",headerTitle:Object(e.jsx)(s.a,{id:"TeacherSubjects.FinalGrades.FinalGrades"}),search:!1,pagination:{pageSize:gt},dataSource:dt,loading:v.loading||f.loading,columns:Ca,options:!1,cardProps:{bodyStyle:{padding:0}}})}),Object(e.jsx)(ne.a,{span:12,children:Object(e.jsx)(Q.a,{rowKey:"id",headerTitle:Object(e.jsx)(s.a,{id:"TeacherSubjects.FinalGrades.Attendances"}),search:!1,options:!1,pagination:{pageSize:gt},cardProps:{bodyStyle:{padding:0}},dataSource:C.data,loading:C.loading,columns:[].concat(ya,[{title:Object(e.jsx)(s.a,{id:"TeacherSubjects.FinalGrades.Attendance"}),dataIndex:"attendance",render:function(G,W){return Object(e.jsx)(wt.a,{onChange:function(ve){return je(W.id,ve.target.checked?Ue.a.PRESENT:Ue.a.ABSENT)},checked:W.attendance.value===Ue.a.PRESENT})}}])})}),Object(e.jsx)(ne.a,{span:12,children:Object(e.jsx)(Q.a,{rowKey:"id",headerTitle:Object(e.jsx)(s.a,{id:"TeacherSubjects.FinalGrades.GradesScale"}),search:!1,options:!1,pagination:{pageSize:gt},cardProps:{bodyStyle:{padding:0}},dataSource:I.data,loading:I.loading,columns:Ea})}),be.loading&&!be.data||Ke.loading&&!Ke.data||De.loading&&!De.data&&Object(e.jsx)(P.a,{}),be.data&&Ke.data&&De.data&&be.data.map(function(fe){var G,W,z,ve,re,He,Ve,Ne,Qe=fe.id,bt=fe.title;return Object(e.jsxs)(ne.a,{span:24,children:[Object(e.jsx)(rt.a.Text,{style:{fontSize:"16px",fontWeight:500},children:bt}),Object(e.jsx)(Jt.c,{topics:(G=(W=De.data)===null||W===void 0?void 0:W[Number(Qe)])!==null&&G!==void 0?G:[],stats:(z=(ve=Ke.data)===null||ve===void 0||(re=ve[Number(Qe)])===null||re===void 0?void 0:re.finishedTopics)!==null&&z!==void 0?z:[]}),Object(e.jsx)(Jt.a,{stats:(He=(Ve=Ke.data)===null||Ve===void 0||(Ne=Ve[Number(Qe)])===null||Ne===void 0?void 0:Ne.attendanceList)!==null&&He!==void 0?He:[]})]},Qe)})]}),Object(e.jsx)(we.a,{form:k,onFinish:Te,children:Object(e.jsxs)(we.a.Group,{style:{display:"flex",flexDirection:"column",paddingTop:"48px"},title:Object(e.jsx)(s.a,{id:"TeacherSubjects.FinalGrades.IssueAssessment"}),titleStyle:{flex:"unset"},align:"center",children:[Object(e.jsx)(Ht.a,{name:"grade_term_id",rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],label:Object(e.jsx)(s.a,{id:"TeacherSubjects.FinalGrades.GradeTerm"}),options:ae,width:"sm",fieldProps:{loading:f.loading}}),Object(e.jsx)(Ht.a,{name:"grade_scale_id",rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],label:Object(e.jsx)(s.a,{id:"TeacherSubjects.FinalGrades.FinalGrade"}),options:me,fieldProps:{loading:v.loading||T.loading}}),Object(e.jsx)(we.a.Item,{children:Object(e.jsx)(s.a,{id:"TeacherSubjects.FinalGrades.ProposedGrade",values:{grade:ye}})})]})})]})},Pa=[{title:Object(e.jsx)(s.a,{id:"first_name"}),dataIndex:"first_name",render:function(u,n){return n.user.first_name}},{title:Object(e.jsx)(s.a,{id:"last_name"}),dataIndex:"last_name",render:function(u,n){return n.user.last_name}},{title:Object(e.jsx)(s.a,{id:"grade"}),hideInSearch:!0,dataIndex:"grades",render:function(u,n){return Object(e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:n.grades.length?n.grades.map(function(r){var a=r.grade_name,c=r.grade_term,j=r.id;return Object(e.jsxs)(rt.a.Text,{children:[c.name,": ",a]},j)}):"-"})}}],Da=function(){var u,n,r=Object(Be.k)(),a=Object(l.useMemo)(function(){var v,_,f,O;return{user_id:Number.isNaN(Number((v=r.query)===null||v===void 0?void 0:v.user_id))?null:Number((_=r.query)===null||_===void 0?void 0:_.user_id),group_id:Number.isNaN(Number((f=r.query)===null||f===void 0?void 0:f.group_id))?null:Number((O=r.query)===null||O===void 0?void 0:O.group_id)}},[(u=r.query)===null||u===void 0?void 0:u.user_id,(n=r.query)===null||n===void 0?void 0:n.group_id]),c=a.user_id,j=a.group_id,E=Object(Z.b)(),g=E.teacherSubjectData,y=E.semester_subject_id,S=Object(l.useMemo)(function(){var v;return((v=g==null?void 0:g.groups)!==null&&v!==void 0?v:[]).map(function(_){var f=_.id,O=_.name;return{label:O,value:f}})},[g==null?void 0:g.groups]);return c!==null&&j!==null?Object(e.jsx)(Ma,{user_id:c,group_id:j}):Object(e.jsx)(Q.a,{rowKey:"id",search:{layout:"vertical"},request:function(){var v=Object(m.a)(Object(h.a)().mark(function _(f){var O,T,M,I,se,C,je,Y,be,Ke;return Object(h.a)().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return T=f.group_id,M=T===void 0?[]:T,I=f.first_name,se=I===void 0?"":I,C=f.last_name,je=C===void 0?"":C,Y=((O=g==null?void 0:g.groups)!==null&&O!==void 0?O:[]).map(function(pe){var k=pe.id;return k}),ue.next=4,ta(M.length===0?Y:M);case 4:if(be=ue.sent,be.success){ue.next=7;break}return ue.abrupt("return",{success:!1,total:0,data:[]});case 7:return Ke=be.data.filter(function(pe){var k=pe.user;return k.first_name.toLowerCase().includes(se.toLowerCase())&&k.last_name.toLowerCase().includes(je.toLowerCase())}),ue.abrupt("return",{success:!0,total:Ke.length,data:Ke});case 9:case"end":return ue.stop()}},_)}));return function(_){return v.apply(this,arguments)}}(),columns:[{title:Object(e.jsx)(s.a,{id:"group"}),dataIndex:"group_id",valueType:"select",fieldProps:{options:S,mode:"multiple"},render:function(_,f){return Object(e.jsx)(N.a,{type:"Students",type_id:f.group_id},f.group_id)}}].concat(Pa,[{title:Object(e.jsx)(s.a,{id:"options"}),hideInSearch:!0,render:function(_,f){return[Object(e.jsx)(ie.a,{to:"/teacher/subjects/".concat(y,"/final-grades?user_id=").concat(f.user.id,"&group_id=").concat(f.group_id),children:Object(e.jsx)(ze.a,{title:Object(e.jsx)(s.a,{id:"edit"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(tt.a,{})})})},"edit")]}}])})},Ia=function(u){var n,r,a=u.tab,c=Object(s.l)(),j=Object(s.m)("@@initialState"),E=j.setInitialState,g=j.initialState,y=Object(Z.b)(),S=y.teacherSubjectData,v=y.semester_subject_id,_=y.tutors,f=Object(l.useCallback)(Object(xe.a)(g==null?void 0:g.currentUser),[g==null?void 0:g.currentUser]),O=Object(l.useMemo)(function(){return!!_.data.find(function(T){var M,I=T.id;return I===(g==null||(M=g.currentUser)===null||M===void 0?void 0:M.id)})||f(Ce.a.TeacherListGradeScale)},[]);return S?Object(e.jsx)(q.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(s.a,{id:S==null||(n=S.subject)===null||n===void 0?void 0:n.name}),", ",Object(e.jsx)(s.a,{id:a})]}),tabBarExtraContent:Object(e.jsx)("div",{style:{display:"flex",padding:"12px",gap:"12px"},children:Object(e.jsx)(ie.a,{to:"/teacher/subjects/".concat(v,"/exams?exam_id=new"),children:Object(e.jsx)($.a,{type:"primary",children:Object(e.jsx)(s.a,{id:"uploadGrades",defaultMessage:"uploadGrades"})})})}),header:{breadcrumb:{routes:[{path:"teacher",breadcrumbName:c.formatMessage({id:"Teacher"})},{path:"subjects",breadcrumbName:c.formatMessage({id:"Subjects"})},{path:String(v),breadcrumbName:String((r=S.subject)===null||r===void 0?void 0:r.name)},{path:String(a),breadcrumbName:c.formatMessage({id:a,defaultMessage:String(a)})}]}},children:Object(e.jsxs)(d.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",activeKey:a,onChange:function(M){E(Object(i.a)({},g)),s.f.push("/teacher/subjects/".concat(v,"/").concat(M))}},children:[Object(e.jsx)(d.a.TabPane,{tab:Object(e.jsx)(s.a,{id:"groups"}),children:Object(e.jsx)(Ie.a,{})},"groups"),Object(e.jsx)(d.a.TabPane,{tab:Object(e.jsx)(s.a,{id:"students"}),children:Object(e.jsx)(Yt,{})},"students"),Object(e.jsx)(d.a.TabPane,{tab:Object(e.jsx)(s.a,{id:"exams"}),children:Object(e.jsx)(ee,{})},"exams"),Object(e.jsx)(d.a.TabPane,{tab:Object(e.jsx)(s.a,{id:"schedule"}),children:Object(e.jsx)(ba,{})},"schedule"),Object(e.jsx)(d.a.TabPane,{tab:Object(e.jsx)(s.a,{id:"attendance"}),children:Object(e.jsx)(Xt,{})},"attendance"),O&&Object(e.jsx)(d.a.TabPane,{tab:Object(e.jsx)(s.a,{id:"grades-scale"}),children:Object(e.jsx)(ia,{})},"grades-scale"),Object(e.jsx)(d.a.TabPane,{tab:Object(e.jsx)(s.a,{id:"final-grades"}),children:Object(e.jsx)(Da,{})},"final-grades")]})}):Object(e.jsx)(P.a,{})},$a=ce.default=function(){var o=Object(Be.l)(),u=o.subjectId,n=o.tab,r=n===void 0?"groups":n;return Object(e.jsx)(Z.a,{semester_subject_id:Number(u),children:Object(e.jsx)(Ia,{tab:r})})}},p3I6:function($e,ce,t){"use strict";t.d(ce,"b",function(){return Z}),t.d(ce,"c",function(){return Oe}),t.d(ce,"a",function(){return it});var i=t("miYZ"),w=t("tsqr"),$=t("tJVT"),p=t("k1fw"),P=t("oBTY"),l=t("q1tI"),s=t.n(l),ie=t("9kvl"),Be=t("Ty5D"),d=t("H6aw"),q=t("/y+f"),Ce=t("nKUr"),xe=t.n(Ce),Z=s.a.createContext({}),Ie=function(){return Math.round(Math.random()*99999)},ut=function Q(J){return J.reduce(function(B,x){return[].concat(Object(P.a)(B),Object(P.a)(x.lessons?Q(x.lessons):[]),[x])},[])},Oe=function Q(J){return J.reduce(function(B,x){var K;return[].concat(Object(P.a)(B),Object(P.a)(x.lessons?Q(x.lessons):[]),Object(P.a)((K=x.topics)!==null&&K!==void 0?K:[]))},[])},et=function Q(J,B,x){return J.map(function(K){var he,U;return Object(p.a)(Object(p.a)({},K),{},{lessons:K.lessons?Q(K.lessons,B,x):[],topics:K.id===B?[].concat(Object(P.a)((he=K.topics)!==null&&he!==void 0?he:[]),[x]):(U=K.topics)!==null&&U!==void 0?U:[]})})},ze=function Q(J,B,x){return J.map(function(K){var he,U,b;return Object(p.a)(Object(p.a)({},K),{},{lessons:Q((he=K.lessons)!==null&&he!==void 0?he:[],B,x),topics:(U=(b=K.topics)===null||b===void 0?void 0:b.map(function(ge){return ge.id===B?x:ge}))!==null&&U!==void 0?U:[]})})},h=function Q(J,B,x){return x?J.map(function(K){return Object(p.a)(Object(p.a)({},K),{},{lessons:[].concat(Object(P.a)(K.lessons?Q(K.lessons,B,x):[]),Object(P.a)(K.id===x?[B]:[]))})}):[].concat(Object(P.a)(J),[B])},m=function Q(J,B,x){return J.map(function(K){return Object(p.a)(Object(p.a)({},K.id===B?x:K),{},{lessons:K.lessons?Q(K.lessons,B,x):[]})})},ke=function Q(J,B){return J.map(function(x){return Object(p.a)(Object(p.a)({},x),{},{parent_id:B,lessons:x.lessons?Q(x.lessons,x.id):[]})})},tt=function Q(J,B){return J.filter(function(x){return x.id!==B}).map(function(x){return Object(p.a)(Object(p.a)({},x),{},{lessons:x.lessons?Q(x.lessons,B):[]})})},We=function Q(J,B){return J.map(function(x){return Object(p.a)(Object(p.a)({},x),{},{lessons:x.lessons?Q(x.lessons,B):[],topics:x.topics?x.topics.filter(function(K){return K.id!==B}):[]})})},it=function(J){var B=J.children,x=J.id,K=Object(l.useState)(),he=Object($.a)(K,2),U=he[0],b=he[1],ge=Object(ie.l)(),Me=Object(l.useMemo)(function(){return U&&U.lessons?Oe(U.lessons):[]},[U]),Le=Object(l.useMemo)(function(){return U&&U.lessons?ut(U.lessons):[]},[U]),Se=Object(l.useState)([]),Ge=Object($.a)(Se,2),Pe=Ge[0],Ye=Ge[1],R=Object(Be.k)();Object(l.useEffect)(function(){Ye([])},[]);var N=Object(l.useCallback)(function(){Object(d.m)(x).then(function(L){return L.success&&b(Object(p.a)(Object(p.a)({},L.data),{},{lessons:ke(L.data.lessons)}))})},[x]);Object(l.useEffect)(function(){N()},[N]);var Ee=Object(l.useCallback)(function(L){var D=Le.find(function(V){var A;return V==null||(A=V.topics)===null||A===void 0?void 0:A.find(function(H){return H.id===L})});return D?D.id:null},[Le]),at=Object(l.useMemo)(function(){var L,D;return(L=R.query)!==null&&L!==void 0&&L.lesson?{mode:"lesson",id:Number(R.query.lesson),value:Le.find(function(V){return V.id===Number(R.query.lesson)})}:(D=R.query)!==null&&D!==void 0&&D.topic?{mode:"topic",id:Number(R.query.topic),value:Me.find(function(V){return V.id===Number(R.query.topic)})}:{mode:"init"}},[R.query,U,Le,Me]),F=Object(l.useCallback)(function(L){var D={course_id:x,topics:[],isNew:!0,id:U?U.lessons.length+1:Ie(),order:0,title:ge.formatMessage({id:"add_title_here"}),active:!0,parent_id:L};return b(function(V){var A;return Object(p.a)(Object(p.a)({},V),{},{lessons:h((A=V==null?void 0:V.lessons)!==null&&A!==void 0?A:[],D,L)})}),D},[x,U]),qe=Object(l.useCallback)(function(L,D){var V=Le.find(function(H){return H.id===L}),A=V&&V.isNew;return(A?Object(d.g)(D):Object(d.u)(L,D)).then(function(H){return w.b.success(H.message),N(),H.success&&b(function(e){var Fe;return Object(p.a)(Object(p.a)({},e),{},{lessons:m((Fe=e==null?void 0:e.lessons)!==null&&Fe!==void 0?Fe:[],L,Object(p.a)(Object(p.a)({},H.data),{},{isNew:!1}))})})})},[U]),Xe=Object(l.useCallback)(function(L){var D=Le.find(function(A){return A.id===L});if(!!D){var V=D.isNew;V?b(function(A){var H;return Object(p.a)(Object(p.a)({},A),{},{lessons:tt((H=A==null?void 0:A.lessons)!==null&&H!==void 0?H:[],L)})}):Object(d.o)(L).then(function(A){A.success&&(w.b.success(A.message),b(function(H){var e;return Object(p.a)(Object(p.a)({},H),{},{lessons:tt((e=H==null?void 0:H.lessons)!==null&&e!==void 0?e:[],L)})}))})}},[U]),lt=Object(l.useCallback)(function(L,D){var V,A=Ee(L),H=Le.find(function(Ze){return Ze.id===A}),e=H&&((V=H.topics)===null||V===void 0?void 0:V.find(function(Ze){return Ze.id===L})),Fe=e==null?void 0:e.isNew;return(Fe?Object(d.h)(D):Object(d.v)(L,D)).then(function(Ze){Ze.success&&(w.b.success(Ze.message),N(),ie.f.push("/courses/list/".concat(x,"/program/?topic=").concat(Ze.data.id)),(e==null?void 0:e.topicable_type)===q.f.Video&&setTimeout(function(){N()},5e3))})},[Ee,U,N]),ne=Object(l.useCallback)(function(L){var D=Ee(L),V=Le.find(function(e){return e.id===D});if(!!V){var A=Me==null?void 0:Me.find(function(e){return e.id===L}),H=A==null?void 0:A.isNew;H&&!A.topicable?b(function(e){var Fe;return Object(p.a)(Object(p.a)({},e),{},{lessons:We((Fe=e==null?void 0:e.lessons)!==null&&Fe!==void 0?Fe:[],L)})}):Object(d.p)(L).then(function(e){e.success&&(w.b.success(e.message),b(function(Fe){var Ze;return Object(p.a)(Object(p.a)({},Fe),{},{lessons:We((Ze=Fe==null?void 0:Fe.lessons)!==null&&Ze!==void 0?Ze:[],L)})}))})}},[U,Ee]),we=Object(l.useCallback)(function(L,D){var V={lesson_id:L,isNew:!0,id:Ie(),title:ge.formatMessage({id:"add_title_here"}),active:!0,topicable_type:D};return b(function(A){var H;return Object(p.a)(Object(p.a)({},A),{},{lessons:et((H=A==null?void 0:A.lessons)!==null&&H!==void 0?H:[],L,V)})}),V},[]),mt=function(D,V){b(function(A){var H;return Object(p.a)(Object(p.a)({},A),{},{lessons:ze((H=A==null?void 0:A.lessons)!==null&&H!==void 0?H:[],D,V.file.response.data)})}),ie.f.push("/courses/list/".concat(x,"/program/?topic=").concat(V.file.response.data.id))},de=Object(l.useCallback)(function(L){return Object(d.d)(L).then(function(D){if(D.success){w.b.success(D.message);var V=Ee(L);b(function(A){var H;return Object(p.a)(Object(p.a)({},A),{},{lessons:A?(H=A.lessons)===null||H===void 0?void 0:H.map(function(e){if(e.id===V){var Fe=e.topics||[];return Object(p.a)(Object(p.a)({},e),{},{topics:[].concat(Object(P.a)(Fe),[D.data])})}return e}):[]})})}})},[U,Ee]),Ue=Object(l.useCallback)(function(L){return Object(d.c)(L).then(function(D){D.success&&(w.b.success(D.message),b(function(V){return Object(p.a)(Object(p.a)({},V),{},{lessons:V?[].concat(Object(P.a)(V.lessons),[D.data]):[]})}))})},[]),ct={state:U,h5ps:Pe,id:x,addNewLesson:F,updateLesson:qe,updateTopic:lt,deleteLesson:Xe,addNewTopic:we,deleteTopic:ne,onTopicUploaded:mt,cloneTopic:de,cloneLesson:Ue,currentEditMode:at,getLessons:N};return Object(Ce.jsx)(Z.Provider,{value:ct,children:B})}},quyA:function($e,ce){var t="\\ud800-\\udfff",i="\\u0300-\\u036f",w="\\ufe20-\\ufe2f",$="\\u20d0-\\u20ff",p=i+w+$,P="\\ufe0e\\ufe0f",l="\\u200d",s=RegExp("["+l+t+p+P+"]");function ie(Be){return s.test(Be)}$e.exports=ie},wy8a:function($e,ce,t){var i=t("KxBF");function w($,p,P){var l=$.length;return P=P===void 0?l:P,!p&&P>=l?$:i($,p,P)}$e.exports=w}}]);
