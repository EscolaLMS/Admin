(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"60mZ":function(Xe,q,e){},EKp7:function(Xe,q,e){"use strict";e.r(q);var C=e("T2oS"),re=e("W9HT"),O=e("q1tI"),c=e("9kvl"),je=e("Ty5D"),Ee=e("tMyG"),Me=e("nhC9"),X=e("tKSU"),$=e("qLMh"),Le=e("miYZ"),ne=e("tsqr"),Q=e("9og8"),Z=e("k1fw"),F=e("PpiC"),h=e("tJVT"),j=e("VMEa"),g=e("Qurx"),i=e("yj/a"),se=e("F/zT"),k=e("BiO0"),p=e("CEpB"),b=e("0WSk"),E=e("Gn8c"),H=e("hd5d"),m=e("YRX9"),ie=e("/y+f"),r=e("nKUr"),w=["authors","category"],he=Object.values(ie.b).map(function(ve){return{value:ve,label:Object(r.jsx)(c.a,{id:"CompetencyChallenges.types.".concat(ve)})}}),we=function(){var z=Object(X.b)(),l=z.competencyChallenge,ee=z.categoryDepths,D=z.refreshData,te=Object(je.l)(),K=Number(te.id),ce=Object(c.l)(),pe=j.a.useForm(),Ae=Object(h.a)(pe,1),ae=Ae[0],ye=j.a.useWatch("type",ae),Se=Number.isNaN(K),Ce=Object(O.useMemo)(function(){if(!(l!=null&&l.data))return{};var P=l==null?void 0:l.data,U=P.authors,Oe=P.category,J=Object(F.a)(P,w);return Object(Z.a)(Object(Z.a)({},J),{},{authors:U.map(function(G){var B=G.id;return B}),category_id:Oe==null?void 0:Oe.id})},[l==null?void 0:l.data]),be=Object(O.useCallback)(function(){var P=Object(Q.a)(Object($.a)().mark(function U(Oe){var J,G,B,le,W,M,Fe,xe;return Object($.a)().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return J=Oe.name,G=Oe.type,B=Oe.is_active,le=B===void 0?!1:B,W=Oe.is_highlighted,M=W===void 0?!1:W,Fe=Oe.category_id,V.prev=1,V.next=4,Object(m.a)({name:J,is_active:le,is_highlighted:M,type:G,category_id:Fe});case 4:if(xe=V.sent,xe.success){V.next=8;break}return ne.b.error(xe.message),V.abrupt("return");case 8:return ne.b.success(ce.formatMessage({id:xe.message})),c.f.push("/competency-challenges/".concat(xe.data.id,"/main")),V.next=12,D();case 12:V.next=17;break;case 14:V.prev=14,V.t0=V.catch(1),ne.b.error(ce.formatMessage({id:"error"}));case 17:case"end":return V.stop()}},U,null,[[1,14]])}));return function(U){return P.apply(this,arguments)}}(),[]),Be=Object(O.useCallback)(function(){var P=Object(Q.a)(Object($.a)().mark(function U(Oe){var J,G,B,le;return Object($.a)().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.prev=0,J=ae.getFieldsValue(["image_url","image_path"]),G=J.image_url,B=J.image_path,M.next=4,Object(m.g)(K,Object(Z.a)(Object(Z.a)({},Oe),{},{image_url:G,image_path:B}));case 4:if(le=M.sent,le.success){M.next=8;break}return ne.b.error(le.message),M.abrupt("return");case 8:return ne.b.success(ce.formatMessage({id:le.message})),M.next=11,D();case 11:M.next=16;break;case 13:M.prev=13,M.t0=M.catch(0),ne.b.error(ce.formatMessage({id:"error"}));case 16:case"end":return M.stop()}},U,null,[[0,13]])}));return function(U){return P.apply(this,arguments)}}(),[K]);return Object(r.jsxs)(j.a,{form:ae,initialValues:Ce,onFinish:Se?be:Be,onValuesChange:function(U){(U==null?void 0:U.type)==="complex"&&ae.setFieldValue("category",null)},children:[Object(r.jsxs)(j.a.Group,{title:Object(r.jsx)(c.a,{id:"CompetencyChallenges.base"}),children:[Object(r.jsx)(g.a,{width:"md",name:"name",label:Object(r.jsx)(c.a,{id:"name"}),placeholder:ce.formatMessage({id:"name"}),required:!0,rules:[{required:!0,message:ce.formatMessage({id:"field_required"})}]}),Object(r.jsx)(i.a,{width:"md",name:"type",label:Object(r.jsx)(c.a,{id:"type"}),options:he,required:!0,rules:[{required:!0,message:ce.formatMessage({id:"field_required"})}]}),ye==="simple"&&Object(r.jsx)(j.a.Item,{name:"category_id",required:!0,label:Object(r.jsx)(c.a,{id:"category"}),rules:[{required:!0,message:ce.formatMessage({id:"field_required"})}],children:Object(r.jsx)(p.a,{enabledDepth:ee.role})}),Object(r.jsx)(se.a,{name:"is_active",label:Object(r.jsx)(c.a,{id:"is_active"})}),Object(r.jsx)(se.a,{name:"is_highlighted",label:Object(r.jsx)(c.a,{id:"is_highlighted"}),tooltip:Object(r.jsx)(c.a,{id:"CompetencyChallenges.highlighted"})})]}),!Se&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(j.a.Group,{title:Object(r.jsx)(c.a,{id:"CompetencyChallenges.additional"}),children:[Object(r.jsx)(j.a.Item,{name:"description",label:Object(r.jsx)(c.a,{id:"description"}),valuePropName:"value",style:{width:440},children:Object(r.jsx)(H.a,{directory:"competency-challenges/".concat(K)})}),Object(r.jsx)(k.a,{width:"lg",name:"summary",label:Object(r.jsx)(c.a,{id:"summary"})}),Object(r.jsx)(j.a.Item,{name:"authors",label:Object(r.jsx)(c.a,{id:"author"}),style:{width:"100%",maxWidth:440},children:Object(r.jsx)(b.a,{multiple:!0})})]}),Object(r.jsx)(E.a,{wrapInForm:!1,folder:"/competency-challenges/".concat(K),title:"image",action:"/api/admin/competency-challenges/".concat(K,"?_method=PATCH"),src_name:"image_url",form_name:"image",getUploadedSrcField:function(U){return U.file.response.data.image_url},setPath:function(U){return ae.setFieldsValue(U)}})]})]})},Ke=e("P2fV"),t=e("NJEC"),Te=e("5Dmo"),Ue=e("3S7+"),x=e("+L6B"),oe=e("2/Rp"),$e=e("G3dp"),Pe=e("/MfK"),R=e("Hn4i"),Ge=e("enqX"),at=["scale_min","category_id"],Ze=[{title:Object(r.jsx)(c.a,{id:"ID"}),dataIndex:"id",editable:!1,render:function(z,l){if(typeof l.id!="string")return"-";var ee=l.id.split("-"),D=Object(h.a)(ee,2),te=D[0],K=D[1];return te==="new"?"-":K}},{title:Object(r.jsx)(c.a,{id:"min_points"}),dataIndex:"scale_min",valueType:"digit",formItemProps:{rules:[{required:!0,message:Object(r.jsx)(c.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(r.jsx)(c.a,{id:"number_between",values:{min:0}})}]},fieldProps:{min:0}},{title:Object(r.jsx)(c.a,{id:"category"}),dataIndex:"category_id",render:function(z,l){return l.category_name},formItemProps:{rules:[{required:!0,message:Object(r.jsx)(c.a,{id:"field_required"})}]},renderFormItem:function(z,l,ee){var D,te=((D=ee.getFieldValue("table"))!==null&&D!==void 0?D:[]).map(function(K){return K.category_id});return Object(r.jsx)(Ge.a,{disabledNodes:te})}}],_e=function(z){return z.map(function(l){var ee=l.id,D=l.scale_min,te=l.category;return{id:"old-".concat(ee),scale_min:D,category_id:te.id,category_name:te.name_with_breadcrumbs}})},ge=function(){var z,l,ee=Object(X.b)(),D=ee.competencyChallenge,te=ee.refreshData,K=Object(je.l)(),ce=Number(K.id),pe=(z=D==null||(l=D.data)===null||l===void 0?void 0:l.scales)!==null&&z!==void 0?z:[],Ae=Object(O.useState)([]),ae=Object(h.a)(Ae,2),ye=ae[0],Se=ae[1],Ce=Object(c.l)(),be=Object(O.useRef)(),Be=Object(O.useRef)(),P=Object(O.useRef)(),U=Object(O.useMemo)(function(){return _e(pe)},[pe]),Oe=Object(O.useMemo)(function(){return[].concat(Ze,[{valueType:"option",title:Object(r.jsx)(c.a,{id:"options"}),render:function(G,B,le,W){return[Object(r.jsx)(Ue.a,{title:Object(r.jsx)(c.a,{id:"edit",defaultMessage:"edit"}),children:Object(r.jsx)(oe.a,{type:"primary",icon:Object(r.jsx)($e.a,{}),onClick:function(){return W==null?void 0:W.startEditable(B.id)}})},"edit"),Object(r.jsx)(t.a,{title:Object(r.jsx)(c.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(Q.a)(Object($.a)().mark(function M(){var Fe,xe,Ve,V,Ye,u,a,s;return Object($.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(typeof B.id=="string"){n.next=2;break}return n.abrupt("return");case 2:if(Fe=B.id.split("-"),xe=Object(h.a)(Fe,2),Ve=xe[0],V=xe[1],Ve!=="new"){n.next=7;break}return a=(Ye=be.current)===null||Ye===void 0?void 0:Ye.getFieldValue("table"),(u=be.current)===null||u===void 0||u.setFieldValue("table",a.filter(function(v){var d=v.id;return d!==B.id})),n.abrupt("return");case 7:return n.next=9,Object(m.d)(+V);case 9:if(s=n.sent,!s.success){n.next=13;break}return n.next=13,te();case 13:case"end":return n.stop()}},M)})),okText:Object(r.jsx)(c.a,{id:"ok"}),cancelText:Object(r.jsx)(c.a,{id:"cancel"}),children:Object(r.jsx)(Ue.a,{title:Object(r.jsx)(c.a,{id:"delete",defaultMessage:"delete"}),children:Object(r.jsx)(oe.a,{type:"primary",icon:Object(r.jsx)(Pe.a,{}),danger:!0})})},"delete")]}}])},[]);return Object(r.jsx)(j.a,{formRef:be,initialValues:{table:U},submitter:!1,children:Object(r.jsx)(R.a,{rowKey:function(G){return G.id},editableFormRef:Be,controlled:!0,actionRef:P,name:"table",columns:Oe,recordCreatorProps:{creatorButtonText:Object(r.jsx)(c.a,{id:"CompetencyChallenges.addNewRow"}),disabled:ye.length>0,record:function(G){return{id:"new-".concat(G)}}},editable:{onlyOneLineEditorAlertMessage:Ce.formatMessage({id:"CompetencyChallenges.onlyOneRowIsEditable"}),onSave:function(){var J=Object(Q.a)(Object($.a)().mark(function B(le,W){var M,Fe,xe,Ve,V,Ye,u,a,s;return Object($.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(M=W.scale_min,Fe=W.category_id,xe=Object(F.a)(W,at),typeof xe.id=="string"){n.next=3;break}return n.abrupt("return");case 3:if(Ve=xe.id.split("-"),V=Object(h.a)(Ve,2),Ye=V[0],u=V[1],Ye!=="new"){n.next=12;break}return n.next=7,Object(m.b)({scale_min:M,category_id:Fe,competency_challenge_id:ce});case 7:if(a=n.sent,!a.success){n.next=11;break}return n.next=11,te();case 11:return n.abrupt("return");case 12:return n.next=14,Object(m.h)(+u,{scale_min:M,category_id:Fe,competency_challenge_id:ce});case 14:if(s=n.sent,!s.success){n.next=18;break}return n.next=18,te();case 18:return n.abrupt("return");case 19:case"end":return n.stop()}},B)}));function G(B,le){return J.apply(this,arguments)}return G}(),deletePopconfirmMessage:Object(r.jsx)(c.a,{id:"deleteQuestion"}),actionRender:function(G,B,le){if(typeof G.id!="string")return[];var W=G.id.split("-"),M=Object(h.a)(W,1),Fe=M[0];return Fe==="new"?[le.save,le.delete]:[le.save,le.cancel]},type:"single",editableKeys:ye,onChange:Se}})})},qe=e("/zsF"),He=e("PArb"),rt=e("DYRE"),Re=e("zeV3"),ke=e("uD7z"),Je=e("FJDo"),et=e("4KAj"),ot=e("yioT"),de=e("qRSf"),ct=e("rmhi"),lt=function(z){var l=z.quiz_id,ee=z.visible,D=z.onVisibleChange,te=j.a.useForm(),K=Object(h.a)(te,1),ce=K[0],pe=Object(O.useCallback)(function(){var Ae=Object(Q.a)(Object($.a)().mark(function ae(ye){var Se,Ce,be;return Object($.a)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return Se=ye.category_ids,P.prev=1,P.next=4,Object(de.c)({quiz_id:l,category_ids:Se});case 4:Ce=P.sent,Ce instanceof Blob&&(be=document.createElement("a"),be.href=window.URL.createObjectURL(Ce),be.download="quiz_".concat(l,"_questions_by_category_id.xlsx"),document.body.appendChild(be),be.click(),document.body.removeChild(be)),P.next=11;break;case 8:P.prev=8,P.t0=P.catch(1),console.error(P.t0);case 11:return P.prev=11,D(!1),P.finish(11);case 14:case"end":return P.stop()}},ae,null,[[1,8,11,14]])}));return function(ae){return Ae.apply(this,arguments)}}(),[l]);return Object(r.jsx)(ct.a,{title:Object(r.jsx)(c.a,{id:"exportQuestions"}),form:ce,visible:ee,onVisibleChange:D,onFinish:pe,children:Object(r.jsx)(j.a.Item,{name:"category_ids",label:Object(r.jsx)(c.a,{id:"categories"}),required:!0,rules:[{required:!0,message:Object(r.jsx)(c.a,{id:"field_required"})}],children:Object(r.jsx)(Ge.a,{multiple:!0,type:"question"})})})},ut=function(){var z=Object(X.b)(),l=z.competencyChallenge.data,ee=Object(O.useState)(!1),D=Object(h.a)(ee,2),te=D[0],K=D[1],ce=Object(O.useState)(!1),pe=Object(h.a)(ce,2),Ae=pe[0],ae=pe[1],ye=Object(O.useState)(),Se=Object(h.a)(ye,2),Ce=Se[0],be=Se[1],Be=Object(c.l)(),P=Object(O.useCallback)(function(){return K(!0)},[]),U=Object(O.useCallback)(function(){(l==null?void 0:l.quiz_id)!==void 0&&(ae(!0),Object(de.d)(l==null?void 0:l.quiz_id).then(function(J){J.success&&be(J.data)}).finally(function(){return ae(!1)}))},[l==null?void 0:l.quiz_id]),Oe=Object(O.useCallback)(function(){var J=Object(Q.a)(Object($.a)().mark(function G(B){return Object($.a)().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if((l==null?void 0:l.quiz_id)!==void 0){W.next=2;break}return W.abrupt("return");case 2:ae(!0),Object(de.g)(l==null?void 0:l.quiz_id,Object(Z.a)(Object(Z.a)({},B),{},{value:"diagnostic-test"})).then(function(M){M.success&&be(M.data)}).finally(function(){return ae(!1)});case 4:case"end":return W.stop()}},G)}));return function(G){return J.apply(this,arguments)}}(),[]);return Object(O.useEffect)(function(){U()},[U]),Ce?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(lt,{visible:te,onVisibleChange:K,quiz_id:Ce.id}),Object(r.jsxs)("div",{style:{position:"relative",paddingBottom:"64px"},children:[Object(r.jsx)(j.a,{submitter:{render:function(G,B){var le=Object(h.a)(B,2),W=le[0],M=le[1];return Object(r.jsxs)(Re.b,{style:{position:"absolute",bottom:0,left:0},children:[W,M]})}},initialValues:Ce,onFinish:Oe,children:Object(r.jsxs)(ke.a,{children:[Object(r.jsx)(Je.a,{name:"max_attempts",label:Object(r.jsx)(c.a,{id:"max_attempts"}),tooltip:Object(r.jsx)(c.a,{id:"max_attempts"}),placeholder:Be.formatMessage({id:"max_attempts",defaultMessage:"max_attempts"})}),Object(r.jsx)(Je.a,{name:"max_execution_time",label:Object(r.jsx)(c.a,{id:"max_execution_time"}),tooltip:Object(r.jsx)(c.a,{id:"max_execution_time"}),placeholder:Be.formatMessage({id:"max_execution_time",defaultMessage:"max_execution_time"})})]})}),Object(r.jsx)(He.a,{}),Object(r.jsx)(ot.a,{questions:Ce.questions,quizId:Ce.id,onAdded:U,onEdited:U,onRemoved:U,tableHeader:Object(r.jsx)(c.a,{id:"questions"}),tableLoading:Ae,questionsCategory:{type:"question"},customToolbarElements:[Object(r.jsxs)(oe.a,{type:"primary",icon:Object(r.jsx)(et.a,{}),onClick:P,children:[" ",Object(r.jsx)(c.a,{id:"exportQuestionsByCategory"})]},"export_by_category")]})]})]}):Object(r.jsx)(re.a,{})},dt=function(){var z,l=Object(X.b)(),ee=l.competencyChallenge,D=Object(c.l)(),te=Object(je.l)(),K=te.id,ce=te.tab,pe=ce===void 0?"main":ce,Ae=K==="new",ae=Object(O.useMemo)(function(){var ye;return Ae?D.formatMessage({id:"CompetencyChallenges.new_challenge"}):(ye=ee.data)!==null&&ye!==void 0&&ye.name?ee.data.name:D.formatMessage({id:"menu.Competency challenges"})},[D,(z=ee.data)===null||z===void 0?void 0:z.name]);return Object(r.jsx)(Ee.a,{title:ae,header:{breadcrumb:{routes:[{path:"competency-challenges",breadcrumbName:D.formatMessage({id:"menu.Competency challenges"})},{path:String(K),breadcrumbName:ae},{path:pe,breadcrumbName:D.formatMessage({id:"CompetencyChallenges.".concat(pe)})}]}},children:Object(r.jsxs)(Me.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",cardProps:{loading:ee.loading&&Object(r.jsx)(re.a,{})},activeKey:pe,onChange:function(Se){c.f.push("/competency-challenges/".concat(K,"/").concat(Se))}},children:[Object(r.jsx)(Me.a.TabPane,{tab:Object(r.jsx)(c.a,{id:"CompetencyChallenges.main"}),children:Object(r.jsx)(we,{})},"main"),Object(r.jsx)(Me.a.TabPane,{tab:Object(r.jsx)(c.a,{id:"CompetencyChallenges.scales"}),disabled:Ae,children:Object(r.jsx)(ge,{})},"scales"),Object(r.jsx)(Me.a.TabPane,{tab:Object(r.jsx)(c.a,{id:"CompetencyChallenges.diagnostic-test"}),disabled:Ae,children:Object(r.jsx)(ut,{})},"diagnostic-test")]})})},mt=function(){return Object(r.jsx)(X.a,{children:Object(r.jsx)(dt,{})})},vt=q.default=mt},YRX9:function(Xe,q,e){"use strict";e.d(q,"f",function(){return je}),e.d(q,"e",function(){return Me}),e.d(q,"a",function(){return $}),e.d(q,"g",function(){return ne}),e.d(q,"c",function(){return Z}),e.d(q,"b",function(){return h}),e.d(q,"h",function(){return g}),e.d(q,"d",function(){return se});var C=e("qLMh"),re=e("k1fw"),O=e("9og8"),c=e("9kvl");function je(p,b){return Ee.apply(this,arguments)}function Ee(){return Ee=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(c.i)("/api/admin/competency-challenges",Object(re.a)({method:"GET",useCache:!1,params:b},E||{})));case 1:case"end":return m.stop()}},p)})),Ee.apply(this,arguments)}function Me(p,b){return X.apply(this,arguments)}function X(){return X=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(c.i)("/api/admin/competency-challenges/".concat(b),Object(re.a)({method:"GET",useCache:!1},E||{})));case 1:case"end":return m.stop()}},p)})),X.apply(this,arguments)}function $(p,b){return Le.apply(this,arguments)}function Le(){return Le=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(c.i)("/api/admin/competency-challenges",Object(re.a)({method:"POST",headers:{"Content-Type":"application/json"},data:b},E||{})));case 1:case"end":return m.stop()}},p)})),Le.apply(this,arguments)}function ne(p,b,E){return Q.apply(this,arguments)}function Q(){return Q=Object(O.a)(Object(C.a)().mark(function p(b,E,H){return Object(C.a)().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.abrupt("return",Object(c.i)("/api/admin/competency-challenges/".concat(b),Object(re.a)({method:"PUT",headers:{"Content-Type":"application/json"},data:E},H||{})));case 1:case"end":return ie.stop()}},p)})),Q.apply(this,arguments)}function Z(p,b){return F.apply(this,arguments)}function F(){return F=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(c.i)("/api/admin/competency-challenges/".concat(b),Object(re.a)({method:"DELETE"},E||{})));case 1:case"end":return m.stop()}},p)})),F.apply(this,arguments)}function h(p,b){return j.apply(this,arguments)}function j(){return j=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(c.i)("/api/admin/competency-challenges/scales",Object(re.a)({method:"POST",headers:{"Content-Type":"application/json"},data:b},E||{})));case 1:case"end":return m.stop()}},p)})),j.apply(this,arguments)}function g(p,b,E){return i.apply(this,arguments)}function i(){return i=Object(O.a)(Object(C.a)().mark(function p(b,E,H){return Object(C.a)().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.abrupt("return",Object(c.i)("/api/admin/competency-challenges/scales/".concat(b),Object(re.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:E},H||{})));case 1:case"end":return ie.stop()}},p)})),i.apply(this,arguments)}function se(p,b){return k.apply(this,arguments)}function k(){return k=Object(O.a)(Object(C.a)().mark(function p(b,E){return Object(C.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(c.i)("/api/admin/competency-challenges/scales/".concat(b),Object(re.a)({method:"DELETE"},E||{})));case 1:case"end":return m.stop()}},p)})),k.apply(this,arguments)}},enqX:function(Xe,q,e){"use strict";e.d(q,"a",function(){return Q});var C=e("nRaC"),re=e("5RzL"),O=e("tJVT"),c=e("q1tI"),je=e.n(c),Ee=e("9kvl"),Me=e("JifO"),X=e("tKSU"),$=e("nKUr"),Le=e.n($),ne=function Z(F,h,j){var g,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return(g=F.subcategories)!==null&&g!==void 0&&g.length?{title:F.name,value:F.id,disabled:i!==j||h.includes(F.id),children:F.subcategories.map(function(se){return Z(se,h,j,i+1)})}:{title:F.name,value:F.id,disabled:i!==j||h.includes(F.id)}},Q=function(F){var h,j,g,i=F.value,se=F.onChange,k=F.type,p=k===void 0?"scale":k,b=F.disabledNodes,E=b===void 0?[]:b,H=F.multiple,m=H===void 0?!1:H,ie=Object(c.useState)([]),r=Object(O.a)(ie,2),w=r[0],he=r[1],we=Object(X.b)(),Ke=we.categoryDepths,t=we.competencyChallenge,Te=Object(c.useMemo)(function(){var x;return((x=t.data)===null||x===void 0?void 0:x.type)==="simple"?w.filter(function(oe){var $e,Pe;return oe.id===(($e=t.data)===null||$e===void 0||(Pe=$e.category)===null||Pe===void 0?void 0:Pe.id)}):w},[w,(h=t.data)===null||h===void 0?void 0:h.type,(j=t.data)===null||j===void 0||(g=j.category)===null||g===void 0?void 0:g.id]),Ue=Object(c.useMemo)(function(){return Te.map(function(x){return ne(x,E,Ke[p])})},[Te,E,p]);return Object(c.useEffect)(function(){Object(Me.c)().then(function(x){x.success&&he(x.data)})},[]),Object($.jsx)(re.a,{loading:w.length===0,showSearch:!0,multiple:m,value:i,dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:Object($.jsx)(Ee.a,{id:"select",defaultMessage:"Please select"}),allowClear:!0,treeDefaultExpandAll:!0,onChange:se,treeData:Ue,disabled:w.length===0})}},hd5d:function(Xe,q,e){"use strict";var C=e("qLMh"),re=e("9og8"),O=e("q1tI"),c=e.n(O),je=e("acco"),Ee=e.n(je),Me=e("BAh9"),X=e("vtG9"),$=e.n(X),Le=e("9kvl"),ne=e("nKUr"),Q=e.n(ne),Z=function(j){var g=j.attrs,i=g.href,se=i.split("/").pop();return Object(ne.jsx)("p",{children:Object(ne.jsx)("a",{rel:"noreferrer",href:i,target:"_blank",children:se})})},F=function(j){var g=j.value,i=j.onChange,se=j.directory,k=se===void 0?"/wysiwyg":se,p=Object(Le.l)();return Object(ne.jsx)("div",{className:"form-wysiwyg-markdown",children:Object(ne.jsx)(Ee.a,{excludeBlockMenuItems:["Sketch"],embeds:[{matcher:function(E){return!0},component:Z}],uploadImage:function(){var b=Object(re.a)(Object(C.a)().mark(function E(H){var m,ie;return Object(C.a)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,Object(Me.e)(H,k);case 2:if(m=w.sent,!m.success){w.next=8;break}if(!H.type.includes("image/")){w.next=7;break}return ie=m.data[0].name.includes("/")?m.data[0].name:"".concat(k).concat(m.data[0].name),w.abrupt("return",Object(Me.d)(ie,1e3));case 7:return w.abrupt("return",m.data[0].url);case 8:throw new Error("Error while uploading");case 9:case"end":return w.stop()}},E)}));return function(E){return b.apply(this,arguments)}}(),defaultValue:g||"",onChange:function(E){return i&&i(E())},placeholder:p.formatMessage({id:"wysiwyg_placeholder"})})})};q.a=F},tKSU:function(Xe,q,e){"use strict";e.d(q,"b",function(){return F}),e.d(q,"a",function(){return h});var C=e("k1fw"),re=e("tJVT"),O=e("qLMh"),c=e("9og8"),je=e("q1tI"),Ee=e.n(je),Me=e("Ty5D"),X=e("YRX9"),$=e("+up7"),Le=e("nKUr"),ne=e.n(Le),Q={categoryDepths:{scale:2,question:1,role:0},competencyChallenge:{data:null,loading:!1},refreshData:function(){var j=Object(c.a)(Object(O.a)().mark(function i(){return Object(O.a)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.abrupt("return",console.warn("CONTEXT INIT"));case 1:case"end":return k.stop()}},i)}));function g(){return j.apply(this,arguments)}return g}()},Z=Ee.a.createContext(Q),F=function(){return Object(je.useContext)(Z)},h=function(g){var i=g.children,se=Object(je.useState)(Q.competencyChallenge),k=Object(re.a)(se,2),p=k[0],b=k[1],E=Object(je.useState)(Q.categoryDepths),H=Object(re.a)(E,2),m=H[0],ie=H[1],r=Object(Me.l)(),w=r.id,he=Number(w),we=Object(je.useCallback)(Object(c.a)(Object(O.a)().mark(function t(){var Te;return Object(O.a)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(!Number.isNaN(he)){x.next=2;break}return x.abrupt("return");case 2:return x.prev=2,b(function(oe){return Object(C.a)(Object(C.a)({},oe),{},{loading:!0})}),x.next=6,Object(X.e)(he);case 6:if(Te=x.sent,Te.success){x.next=10;break}return b(function(oe){return Object(C.a)(Object(C.a)({},oe),{},{error:Te.errors})}),x.abrupt("return");case 10:b(function(oe){return Object(C.a)(Object(C.a)({},oe),{},{data:Te.data})}),x.next=16;break;case 13:x.prev=13,x.t0=x.catch(2),b(function(oe){return Object(C.a)(Object(C.a)({},oe),{},{error:x.t0})});case 16:return x.prev=16,b(function(oe){return Object(C.a)(Object(C.a)({},oe),{},{loading:!1})}),x.finish(16);case 19:case"end":return x.stop()}},t,null,[[2,13,16,19]])})),[he]),Ke=Object(je.useCallback)(Object(c.a)(Object(O.a)().mark(function t(){var Te,Ue,x,oe,$e,Pe,R,Ge,at,Ze,_e,ge,qe,He,rt,Re,ke,Je,et;return Object(O.a)().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.prev=0,de.next=3,Object($.a)();case 3:if(Re=de.sent,Re.success){de.next=6;break}return de.abrupt("return");case 6:ke=Number((Te=Re.data)===null||Te===void 0||(Ue=Te.escolalms_competency_challenge)===null||Ue===void 0||(x=Ue.category)===null||x===void 0||(oe=x.scale)===null||oe===void 0||($e=oe.depth)===null||$e===void 0?void 0:$e.value),Je=Number((Pe=Re.data)===null||Pe===void 0||(R=Pe.escolalms_competency_challenge)===null||R===void 0||(Ge=R.category)===null||Ge===void 0||(at=Ge.question)===null||at===void 0||(Ze=at.depth)===null||Ze===void 0?void 0:Ze.value),et=Number((_e=Re.data)===null||_e===void 0||(ge=_e.escolalms_competency_challenge)===null||ge===void 0||(qe=ge.category)===null||qe===void 0||(He=qe.role)===null||He===void 0||(rt=He.depth)===null||rt===void 0?void 0:rt.value),ie({scale:Number.isNaN(ke)?2:ke,question:Number.isNaN(Je)?1:Je,role:Number.isNaN(et)?0:et}),de.next=15;break;case 12:de.prev=12,de.t0=de.catch(0),console.error(de.t0);case 15:case"end":return de.stop()}},t,null,[[0,12]])})),[]);return Object(je.useEffect)(function(){we(),Ke()},[we,Ke]),Object(Le.jsx)(Z.Provider,{value:{categoryDepths:m,competencyChallenge:p,refreshData:we},children:i})}},vtG9:function(Xe,q,e){},yioT:function(Xe,q,e){"use strict";e.d(q,"a",function(){return Ye});var C=e("tU7J"),re=e("wFql"),O=e("BoS7"),c=e("Sdc0"),je=e("miYZ"),Ee=e("tsqr"),Me=e("+L6B"),X=e("2/Rp"),$=e("oBTY"),Le=e("bbsP"),ne=e("/wGt"),Q=e("qLMh"),Z=e("9og8"),F=e("PpiC"),h=e("tJVT"),j=e("k1fw"),g=e("q1tI"),i=e("9kvl"),se=e("YJCA"),k=e("wYyv"),p=e("smpX"),b=e("eyie"),E=e("w5pM"),H=e("4KAj"),m=e("mWMg"),ie=e("DBJ/"),r=e("Vpfc"),w=e("qRSf"),he=e("VMEa"),we=e("rmhi"),Ke=e("yj/a"),t=e("nKUr"),Te=function(a){var s=a.quiz_id,o=a.quizQuestions,n=a.visible,v=a.onVisibleChange,d=he.a.useForm(),y=Object(h.a)(d,1),I=y[0],A=Object(i.l)(),T=Object(g.useCallback)(function(){var _=Object(Z.a)(Object(Q.a)().mark(function L(De){var N,Ne,Ie;return Object(Q.a)().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return N=De.ids,ue.prev=1,ue.next=4,Object(w.c)({quiz_id:s,ids:N});case 4:Ne=ue.sent,Ne instanceof Blob&&(Ie=document.createElement("a"),Ie.href=window.URL.createObjectURL(Ne),Ie.download="quiz_questions_".concat(s,".xlsx"),document.body.appendChild(Ie),Ie.click(),document.body.removeChild(Ie)),ue.next=11;break;case 8:ue.prev=8,ue.t0=ue.catch(1),console.error(ue.t0);case 11:return ue.prev=11,v(!1),ue.finish(11);case 14:case"end":return ue.stop()}},L,null,[[1,8,11,14]])}));return function(L){return _.apply(this,arguments)}}(),[s]),S=Object(g.useMemo)(function(){return o.map(function(_){var L=_.id,De=_.value;try{var N=Object(p.parse)(De);if(!(N!=null&&N[0])||!("stem"in N[0]))return{value:L,label:A.formatMessage({id:"ExportQuestions.questionTitle"},{id:L})};var Ne=N[0].stem.text;return{value:L,label:Ne}}catch(Ie){return console.error(Ie),{value:L,label:A.formatMessage({id:"ExportQuestions.questionTitle"},{id:L})}}})},[o]);return Object(t.jsx)(we.a,{title:Object(t.jsx)(i.a,{id:"exportQuestions"}),form:I,visible:n,onVisibleChange:v,onFinish:T,children:Object(t.jsx)(Ke.a,{mode:"multiple",options:S,name:"ids",label:Object(t.jsx)(i.a,{id:"questions"}),required:!0,rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}]})})},Ue=e("DYRE"),x=e("zeV3"),oe=e("/zsF"),$e=e("PArb"),Pe=e("FJDo"),R=e("/y+f"),Ge=e("enqX"),at=e("5Dmo"),Ze=e("3S7+"),_e=e("jrin"),ge=e("Qurx"),qe=e("x1Ii"),He=e("tneF"),rt=e("/MfK"),Re,ke=(Re={},Object(_e.a)(Re,R.e.MULTIPLE_CHOICE,[{isCorrect:!1,value:""},{isCorrect:!1,value:""}]),Object(_e.a)(Re,R.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS,[{value:"",weight:""},{value:"",weight:""}]),Re),Je=function(a){var s,o=a.type,n=Object(i.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ge.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(qe.b,{name:"answers",creatorButtonProps:{creatorButtonText:n.formatMessage({id:"Questions.addAnswer"})},actionRender:function(){return[]},initialValue:(s=ke[o])!==null&&s!==void 0?s:[],children:function(d,y,I,A){return Object(t.jsxs)(he.a.Group,{title:Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(i.a,{id:"Questions.answer",values:{ordinalNumber:y+1}}),A>2&&Object(t.jsx)(Ze.a,{title:n.formatMessage({id:"Questions.deleteAnswer"}),children:Object(t.jsx)(X.a,{type:"text",icon:Object(t.jsx)(rt.a,{}),onClick:function(){return I.remove(d.name)}})})]}),titleStyle:{width:"100%",display:"flex",justifyContent:"space-between"},children:[o===R.e.MULTIPLE_CHOICE&&Object(t.jsx)(He.a,{name:"isCorrect",label:Object(t.jsx)(i.a,{id:"Questions.correctAnswer",defaultMessage:"Is Correct Answer?"}),rules:[function(T){var S=T.getFieldValue;return{validator:function(){var L,De=(L=S("answers"))!==null&&L!==void 0?L:[];return De.filter(function(N){return N==null?void 0:N.isCorrect}).length>1?Promise.reject("Only one answer can be correct"):Promise.resolve()},message:Object(t.jsx)(i.a,{id:"Questions.onlyOneAnswerIsCorrect"})}}]}),Object(t.jsx)(ge.a,{name:"value",rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],label:Object(t.jsx)(i.a,{id:"content",defaultMessage:"Content"})}),o===R.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS&&Object(t.jsx)(Pe.a,{name:"weight",rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],fieldProps:{min:-Number.MAX_SAFE_INTEGER,addonAfter:"%"},label:Object(t.jsx)(i.a,{id:"weight",defaultMessage:"Weight"})})]})}})]})},et=function(){return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ge.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(He.a,{name:"isCorrect",label:Object(t.jsx)(i.a,{id:"Questions.correctAnswer"})})]})},ot=[{value:""}],de=function(){var a=Object(i.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ge.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(qe.b,{name:"answers",creatorButtonProps:{creatorButtonText:a.formatMessage({id:"Questions.addAnswer"})},deleteIconProps:{tooltipText:a.formatMessage({id:"Questions.deleteAnswer"})},actionRender:function(o,n,v){var d=Object(h.a)(v,2),y=d[1];return[y]},min:1,initialValue:ot,children:function(o,n){return Object(t.jsx)(ge.a,{name:"value",rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],label:Object(t.jsx)(i.a,{id:"Questions.answer",values:{ordinalNumber:n+1},defaultMessage:"Answer ".concat(n+1)})})}})]})},ct=[{firstOfPair:"",secondOfPair:""}],lt=function(){var a=Object(i.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ge.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(qe.b,{name:"answers",creatorButtonProps:{creatorButtonText:a.formatMessage({id:"Questions.addMatchingPair",defaultMessage:"Add Matching Pair"})},deleteIconProps:{tooltipText:a.formatMessage({id:"Questions.deletePair"})},actionRender:function(o,n,v){var d=Object(h.a)(v,2),y=d[1];return[y]},min:1,initialValue:ct,children:function(o,n){return Object(t.jsxs)(he.a.Group,{direction:"horizontal",align:"baseline",size:"small",spaceProps:{style:{flexWrap:"nowrap"}},title:Object(t.jsx)(i.a,{id:"Questions.pair",values:{ordinalNumber:n+1},defaultMessage:"Pair ".concat(n+1)}),children:[Object(t.jsx)(ge.a,{name:"firstOfPair",rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}]}),Object(t.jsx)(ge.a,{name:"secondOfPair",rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}]})]})}})]})},ut=function(){return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ge.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Pe.a,{name:"answer",label:Object(t.jsx)(i.a,{id:"answer"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Pe.a,{name:"errorMargin",fieldProps:{addonAfter:"+/-"},label:Object(t.jsx)(i.a,{id:"Questions.errorMargin"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0})]})},dt=e("BiO0"),mt=function(){return Object(t.jsx)(dt.a,{name:"question",label:Object(t.jsx)(i.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0})},vt=function(a){var s=a.type;if(!s)return null;switch(s){case R.e.MULTIPLE_CHOICE:case R.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return Object(t.jsx)(Je,{type:s});case R.e.TRUE_FALSE:return Object(t.jsx)(et,{});case R.e.SHORT_ANSWERS:return Object(t.jsx)(de,{});case R.e.MATCHING:return Object(t.jsx)(lt,{});case R.e.NUMERICAL_QUESTION:return Object(t.jsx)(ut,{});case R.e.ESSAY:case R.e.DESCRIPTION:return Object(t.jsx)(mt,{})}return Object(t.jsxs)("pre",{children:["Unsupported type ",s]})},ve=e("rAM+"),z=["question"],l=function(a){for(var s=["~","=","#","{","}",":"],o="",n=0;n<a.length;n++){var v=a[n];s.includes(v)?o+="\\".concat(v):o+=v}return o},ee=function(a){var s=a.question,o=a.answers;if(o.length===0)return"".concat(s,"{}");var n=o.map(function(_){var L=_.isCorrect,De=_.value;return{isCorrect:L,value:l(De)}}),v="".concat(s,"{"),d=Object(ve.a)(n),y;try{for(d.s();!(y=d.n()).done;){var I=y.value,A=I.isCorrect,T=I.value,S=A?"=":"~";v+="".concat(S).concat(T)}}catch(_){d.e(_)}finally{d.f()}return v+="}",v.trim()},D=function(a){var s=a.question,o=a.answers;if(o.length==0)return"".concat(s,"{}");var n="".concat(s,"{"),v=o.map(function(S){var _=S.weight,L=S.value;return{weight:_,value:l(L)}}),d=Object(ve.a)(v),y;try{for(d.s();!(y=d.n()).done;){var I=y.value,A=I.value,T=I.weight;n+="~%".concat(T,"%").concat(A)}}catch(S){d.e(S)}finally{d.f()}return n+="}",n.trim()},te=function(a){var s=a.question,o=a.isCorrect;return"".concat(s,"{").concat(o?"T":"F","}")},K=function(a){var s=a.question,o=a.answers;if(o.length===0)return"".concat(s,"{}");var n="".concat(s,"{"),v=o.map(function(T){var S=T.value;return{value:l(S)}}),d=Object(ve.a)(v),y;try{for(d.s();!(y=d.n()).done;){var I=y.value,A=I.value;n+="=".concat(A)}}catch(T){d.e(T)}finally{d.f()}return n+="}",n.trim()},ce=function(a){var s=a.question,o=a.answers;if(o.length===0)return"".concat(s,"{}");var n="".concat(s,"{"),v=o.map(function(S){var _=S.firstOfPair,L=S.secondOfPair;return{firstOfPair:l(_),secondOfPair:l(L)}}),d=Object(ve.a)(v),y;try{for(d.s();!(y=d.n()).done;){var I=y.value,A=I.firstOfPair,T=I.secondOfPair;n+="=".concat(A,"->").concat(T)}}catch(S){d.e(S)}finally{d.f()}return n+="}",n.trim()},pe=function(a){var s=a.question,o=a.answer,n=a.errorMargin;return"".concat(s,"{#").concat(o,":").concat(n,"}")},Ae=function(a){var s=a.question;return"".concat(s,"{}")},ae=function(a){var s=a.question;return s},ye=function(a){var s=a.question,o=Object(F.a)(a,z),n=Object(j.a)({question:l(s)},o);switch(n.type){case R.e.MULTIPLE_CHOICE:return ee(n);case R.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return D(n);case R.e.TRUE_FALSE:return te(n);case R.e.SHORT_ANSWERS:return K(n);case R.e.MATCHING:return ce(n);case R.e.NUMERICAL_QUESTION:return pe(n);case R.e.ESSAY:return Ae(n);case R.e.DESCRIPTION:return ae(n);default:throw new Error("Unsupported type: ".concat(n.type))}},Se=function(a,s){var o=s.type,n=s.score,v=s.category_id,d=a==null?void 0:a.stem.text,y=a.choices.every(function(T){var S=T.weight;return S===null});if(y){var I=a.choices.map(function(T){var S=T.isCorrect,_=T.text;return{isCorrect:S,value:_.text}});return{type:o,score:n,category_id:v,question:d,answers:I}}var A=a.choices.reduce(function(T,S){var _=S.weight,L=S.text;return _!==null?[].concat(Object($.a)(T),[{weight:_,value:L.text}]):T},[]);return{type:o,score:n,category_id:v,question:d,answers:A}},Ce=function(a,s){var o=s.type,n=s.score,v=s.category_id,d=a==null?void 0:a.stem.text,y=a.isTrue;return{type:o,score:n,category_id:v,question:d,isCorrect:y}},be=function(a,s){var o=s.type,n=s.score,v=s.category_id,d=a==null?void 0:a.stem.text,y=a.choices.map(function(I){var A=I.text;return{value:A.text}});return{type:o,score:n,category_id:v,question:d,answers:y}},Be=function(a,s){var o=s.type,n=s.score,v=s.category_id,d=a==null?void 0:a.stem.text,y=a.matchPairs.map(function(I){var A=I.subquestion,T=I.subanswer;return{firstOfPair:A.text,secondOfPair:T}});return{type:o,score:n,category_id:v,question:d,answers:y}},P=function(a,s){var o=s.type,n=s.score,v=s.category_id,d=a==null?void 0:a.stem.text;if(Array.isArray(a==null?void 0:a.choices))throw new Error("Unsupported choices type: array");var y=a==null?void 0:a.choices.number,I=a==null?void 0:a.choices.range;if(y===void 0||I===void 0)throw new Error("Value undefined - answer: ".concat(y," errorMargin: ").concat(I));return{type:o,score:n,category_id:v,question:d,answer:y,errorMargin:I}},U=function(a,s){var o=s.type,n=s.score,v=s.category_id,d=a==null?void 0:a.stem.text;return{type:o,score:n,category_id:v,question:d}};function Oe(u){if(!!u)try{var a=Object(p.parse)(u.value),s=Object(h.a)(a,1),o=s[0];switch(o.type){case"MC":return Se(o,u);case"TF":return Ce(o,u);case"Short":return be(o,u);case"Matching":return Be(o,u);case"Numerical":return P(o,u);case"Description":case"Essay":return U(o,u);default:throw new Error("Unsupported type: ".concat(o==null?void 0:o.type))}}catch(n){console.error(n);return}}var J=["type","score","category"],G=Object.values(R.e).reduce(function(u,a){return a?[].concat(Object($.a)(u),[{value:a,label:Object(t.jsx)(i.a,{id:"gift_type.".concat(a)})}]):u},[]),B=function(a){var s=a.onSubmit,o=a.values,n=a.competencyChallengeCategoryTreeProps,v=n===void 0?!1:n,d=Object(i.l)(),y=he.a.useForm(),I=Object(h.a)(y,1),A=I[0],T=he.a.useWatch("type",A),S=Object(g.useMemo)(function(){return Oe(o)},[o]),_=Object(g.useCallback)(function(){var L=Object(Z.a)(Object(Q.a)().mark(function De(N){var Ne,Ie,nt,ue;return Object(Q.a)().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return Ne=ye(N),Ie=N.score,nt=N.category_id,ze.next=4,s({value:Ne,score:Ie,category_id:nt});case 4:if(ue=ze.sent,ue){ze.next=7;break}return ze.abrupt("return");case 7:A.resetFields();case 8:case"end":return ze.stop()}},De)}));return function(De){return L.apply(this,arguments)}}(),[]);return Object(g.useEffect)(function(){A.resetFields()},[S]),Object(g.useEffect)(function(){if(T){var L=A.getFieldsValue(),De=Object.keys(L).filter(function(N){return!J.includes(N)});A.resetFields(De)}},[T]),Object(t.jsxs)(x.b,{direction:"vertical",style:{display:"flex"},children:[Object(t.jsx)($e.a,{children:Object(t.jsx)(i.a,{id:S?"Questions.edit":"addNewQuestion"})}),Object(t.jsxs)(he.a,{layout:"horizontal",form:A,onFinish:_,initialValues:S,children:[Object(t.jsx)(Ke.a,{name:"type",placeholder:d.formatMessage({id:"selectNewQuestionType",defaultMessage:"Select new question type"}),label:Object(t.jsx)(i.a,{id:"type",defaultMessage:"Type:"}),options:G,rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(vt,{type:T}),Object(t.jsx)(Pe.a,{name:"score",label:Object(t.jsx)(i.a,{id:"Questions.score",defaultMessage:"Score"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}]}),v&&Object(t.jsx)(he.a.Item,{name:"category_id",label:Object(t.jsx)(i.a,{id:"category",defaultMessage:"Category"}),rules:[{required:!0,message:Object(t.jsx)(i.a,{id:"field_required"})}],required:!0,children:Object(t.jsx)(Ge.a,Object(j.a)({},typeof v=="object"?v:{}))})]})]})},le=e("60mZ"),W=["className","style"],M=Object(se.c)(function(){return Object(t.jsx)(b.a,{style:{cursor:"grab",color:"#999"}})}),Fe=Object(se.b)(function(u){return Object(t.jsx)("tr",Object(j.a)({},u))}),xe=Object(se.a)(function(u){return Object(t.jsx)("tbody",Object(j.a)({},u))}),Ve=[{title:Object(t.jsx)(i.a,{id:"sort",defaultMessage:"sort"}),dataIndex:"id",width:60,className:"drag-visible",render:function(){return Object(t.jsx)(M,{})}},{title:Object(t.jsx)(i.a,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,s){return Object(t.jsx)(i.a,{id:"gift_type.".concat(s.type)})}},{title:Object(t.jsx)(i.a,{id:"question",defaultMessage:"Question"}),dataIndex:"question",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,s){try{var o=Object(p.parse)(s.value);return o!=null&&o[0]&&"stem"in o[0]?o[0].stem.text:"question"}catch(n){return console.error(n),"question"}}}],V={title:Object(t.jsx)(i.a,{id:"category",defaultMessage:"Category"}),dataIndex:"category_id",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,s){return typeof s.category_id=="number"?Object(t.jsx)(r.a,{type:"Category",type_id:s.category_id}):"-"}},Ye=function(a){var s=a.questions,o=a.onAdded,n=a.onRemoved,v=a.onEdited,d=a.quizId,y=a.tableLoading,I=a.tableHeader,A=a.questionsCategory,T=a.customToolbarElements,S=T===void 0?[]:T,_=Object(g.useState)(!1),L=Object(h.a)(_,2),De=L[0],N=L[1],Ne=Object(g.useState)(!1),Ie=Object(h.a)(Ne,2),nt=Ie[0],ue=Ie[1],bt=Object(g.useState)(),ze=Object(h.a)(bt,2),We=ze[0],jt=ze[1],yt=Object(g.useState)(!1),Ot=Object(h.a)(yt,2),Ct=Ot[0],ft=Ot[1],xt=Object(g.useState)(!1),ht=Object(h.a)(xt,2),Et=ht[0],Mt=ht[1],Tt=Object(g.useState)(s),gt=Object(h.a)(Tt,2),it=gt[0],pt=gt[1],Pt=Object(i.l)(),St=Object(g.useRef)();Object(g.useEffect)(function(){var fe;(fe=St.current)===null||fe===void 0||fe.reload(),pt(s)},[s]);var Dt=function(Y){var me=Y.oldIndex,Qe=Y.newIndex;if(me!==Qe){var tt=Object(k.a)(it.slice(),me,Qe).filter(Boolean).map(function(f,st){return Object(j.a)(Object(j.a)({},f),{},{order:st})});tt.forEach(function(f,st){f.id!==it[st].id&&Object(w.h)(f.id,Object(j.a)(Object(j.a)({},f),{},{order:st+1,topic_gift_quiz_id:d}))}),pt(tt)}},It=function(Y){return Object(t.jsx)(xe,Object(j.a)({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:Dt},Y))},At=function(Y){var me=Y.className,Qe=Y.style,tt=Object(F.a)(Y,W),f=it.findIndex(function(st){return st.id===tt["data-row-key"]});return Object(t.jsx)(Fe,Object(j.a)({index:f},tt))},Ft=Object(g.useCallback)(function(){var fe=Object(Z.a)(Object(Q.a)().mark(function Y(me){var Qe;return Object(Q.a)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,N(!0),f.next=4,Object(w.a)(Object(j.a)({topic_gift_quiz_id:d},me));case 4:return Qe=f.sent,ue(!1),o==null||o(),f.abrupt("return",Qe.success);case 10:return f.prev=10,f.t0=f.catch(0),console.log(f.t0),f.abrupt("return",!1);case 14:return f.prev=14,N(!1),f.finish(14);case 17:case"end":return f.stop()}},Y,null,[[0,10,14,17]])}));return function(Y){return fe.apply(this,arguments)}}(),[nt,d]),Rt=Object(g.useCallback)(function(){var fe=Object(Z.a)(Object(Q.a)().mark(function Y(me){var Qe;return Object(Q.a)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if((We==null?void 0:We.id)!==void 0){f.next=2;break}return f.abrupt("return",!1);case 2:return f.prev=2,N(!0),f.next=6,Object(w.h)(We.id,Object(j.a)({topic_gift_quiz_id:d},me));case 6:return Qe=f.sent,jt(void 0),v==null||v(),f.abrupt("return",Qe.success);case 12:return f.prev=12,f.t0=f.catch(2),console.log(f.t0),f.abrupt("return",!1);case 16:return f.prev=16,N(!1),f.finish(16);case 19:case"end":return f.stop()}},Y,null,[[2,12,16,19]])}));return function(Y){return fe.apply(this,arguments)}}(),[We==null?void 0:We.id,d]);return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(ne.a,{open:nt,onClose:function(){return ue(!1)},children:Object(t.jsx)(B,{onSubmit:Ft,competencyChallengeCategoryTreeProps:A})}),Object(t.jsx)(ne.a,{open:!!We,onClose:function(){return jt(void 0)},children:Object(t.jsx)(B,{onSubmit:Rt,competencyChallengeCategoryTreeProps:A,values:We})}),Object(t.jsx)(Te,{quiz_id:d,quizQuestions:it,visible:Ct,onVisibleChange:ft}),Object(t.jsx)(m.a,{search:!1,cardProps:{bodyStyle:{padding:0}},loading:y,headerTitle:I,toolbar:{settings:[]},toolBarRender:function(){return[Object(t.jsxs)(X.a,{icon:Object(t.jsx)(E.a,{}),type:"primary",onClick:function(){return ue(!0)},children:[" ",Object(t.jsx)(i.a,{id:"addNewQuestion",defaultMessage:"Add new question"})]},"add"),Object(t.jsx)(ie.a,{title:Pt.formatMessage({id:"importQuestions"}),hideLabel:!0,showUploadList:!1,url:"/api/admin/gift-questions/import",name:"file",accept:".xlsx",data:{topic_gift_quiz_id:d},onChange:function(me){me.file.status==="done"&&me.file.response&&me.file.response.success&&(Ee.b.success(me.file.response.message),o==null||o()),me.file.response&&me.file.status==="error"&&(Ee.b.error(me.file.response.message),console.error(me.file.response))}},"import"),Object(t.jsxs)(X.a,{icon:Object(t.jsx)(H.a,{}),type:"primary",onClick:function(){return ft(!0)},children:[" ",Object(t.jsx)(i.a,{id:"exportQuestions"})]},"export")].concat(Object($.a)(S))},columns:[].concat(Ve,Object($.a)(A?[V]:[]),[{title:Object(t.jsx)(i.a,{id:"actions",defaultMessage:"Actions"}),dataIndex:"address",valueType:"option",render:function(Y,me){return[Object(t.jsx)(X.a,{size:"small",type:"primary",onClick:function(){jt(me)},children:Object(t.jsx)(i.a,{id:"Questions.edit",defaultMessage:"Edit Question"})},"edit"),Object(t.jsx)(X.a,{loading:De,size:"small",danger:!0,onClick:function(){N(!0),Object(w.b)(me.id).then(function(){n&&n()}).finally(function(){N(!1)})},children:Object(t.jsx)(i.a,{id:"Questions.delete",defaultMessage:"Delete Question"})},"delete")]}}]),rowKey:function(Y){return Y.id},pagination:!1,dataSource:it,components:{body:{wrapper:It,row:At}}}),Object(t.jsxs)(re.a,{style:{marginTop:"3em"},children:["Debug GIFT: ",Object(t.jsx)(c.a,{checked:Et,onChange:function(Y){return Mt(Y)}})]})]})}}}]);

//# sourceMappingURL=p__CompetencyChallenges__form.d7cc02cd.async.js.map