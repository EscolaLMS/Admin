(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"4f6N":function(X,y,e){"use strict";var B=e("2qtc"),A=e("kLXV"),D=e("9kvl"),f=e("nKUr"),Z=e.n(f),Y=function(x){var F=x.visible,E=x.setManage;return Object(f.jsx)(A.a,{width:"600px",title:Object(f.jsx)(D.a,{id:"course.validate_edit.header",defaultMessage:"course.validate_edit.header"}),visible:F,onOk:function(){return E({showModal:!1,disableEdit:!1,clicked:!0})},onCancel:function(){return E({showModal:!1,disableEdit:!0,clicked:!1})},okText:"OK",cancelText:"Cancel",children:Object(f.jsx)("p",{children:Object(f.jsx)(D.a,{id:"course.validate_edit.content",defaultMessage:"course.validate_edit.content"})})})};y.a=Y},CiB2:function(X,y,e){"use strict";e.d(y,"a",function(){return B});function B(A){if(A==null)throw new TypeError("Cannot destructure undefined")}},CiXh:function(X,y,e){"use strict";var B=e("2qtc"),A=e("kLXV"),D=e("9kvl"),f=e("nKUr"),Z=e.n(f),Y=function(x){var F=x.open,E=x.onOk,L=x.onCancel,P=x.title,T=x.content,a=x.okText,z=x.loading;return Object(f.jsx)(A.a,{width:"600px",title:P!=null?P:Object(f.jsx)(D.a,{id:"confirmModal.title"}),open:F,onOk:E,onCancel:L,okText:a!=null?a:Object(f.jsx)(D.a,{id:"save"}),cancelText:Object(f.jsx)(D.a,{id:"cancel"}),confirmLoading:z,children:T!=null?T:Object(f.jsx)("p",{children:Object(f.jsx)(D.a,{id:"confirmModal.content"})})})};y.a=Y},GZq3:function(X,y,e){},"J+hL":function(X,y,e){},eFHa:function(X,y,e){"use strict";e.d(y,"a",function(){return k});var B=e("k1fw"),A=e("tJVT"),D=e("q1tI"),f=e("/Tr7"),Z=e("jIYg");function Y(x){return Object(Z.a)(1,arguments),Object(f.a)(x).getTime()<Date.now()}function k(){var x=Object(D.useState)({showModal:!1,disableEdit:!1,clicked:!1}),F=Object(A.a)(x,2),E=F[0],L=F[1],P=function(a){(a==null?void 0:a.status)==="published"&&a!==null&&a!==void 0&&a.active_from&&Y(new Date(a==null?void 0:a.active_from))&&!E.clicked?L(Object(B.a)(Object(B.a)({},E),{},{showModal:!1,disableEdit:!0,clicked:!1})):L(Object(B.a)(Object(B.a)({},E),{},{showModal:!1,disableEdit:!1,clicked:!1}))};return{manageCourseEdit:E,setManageCourseEdit:L,validateCourseEdit:P}}},q34N:function(X,y,e){"use strict";var B=e("tJVT"),A=e("0eZe"),D=e("q1tI"),f=e.n(D),Z=e("nKUr"),Y=e.n(Z),k=function(F){var E=F.productable,L=F.type,P=L===void 0?"card":L,T=Object(D.useState)("attributes"),a=Object(B.a)(T,2),z=a[0],W=a[1];return Object(Z.jsx)(A.a,{productable:E,tab:z,onTabChange:function(q){return W(q)},type:P})};y.a=k},rh3J:function(X,y,e){"use strict";e.r(y);var B=e("14J3"),A=e("BMrR"),D=e("jCWc"),f=e("kPKH"),Z=e("fOrg"),Y=e("+KLJ"),k=e("+L6B"),x=e("2/Rp"),F=e("T2oS"),E=e("W9HT"),L=e("miYZ"),P=e("tsqr"),T=e("qLMh"),a=e("k1fw"),z=e("9og8"),W=e("tJVT"),g=e("q1tI"),q=e.n(g),S=e("VMEa"),at=e("Qurx"),ct=e("yj/a"),nt=e("lR9U"),$=e("nhC9"),ut=e("hd5d"),jt=e("tMyG"),n=e("9kvl"),bt=e("Ty5D"),Ot=e("0WSk"),ft=e("TWax"),_=e("Gb5Y"),Nt=e("OaEy"),vt=e("2fM7"),Ft=e("iQDF"),st=e("+eQT"),Kt=e("+BJd"),mt=e("mr32"),ht=e("oBTY"),gt=e("wd/R"),w=e.n(gt),Wt=e("GZq3"),t=e("nKUr"),rt=function(i){return i.local().valueOf()},xt=function(i){var O=i.value,s=O===void 0?[]:O,C=i.onChange,m=i.format,M=m===void 0?"DD-MM-YYYY HH:mm":m,V=i.selectProps,H=V===void 0?{}:V,c=Object(g.useState)(!1),I=Object(W.a)(c,2),G=I[0],r=I[1],p=Object(g.useCallback)(function(j){var b=rt(j),o=s.indexOf(b),l=Object(ht.a)(s);o>-1?l.splice(o,1):l.push(b),C(l)},[s]),u=Object(g.useCallback)(function(j){var b=s.indexOf(rt(j))>-1;return Object(t.jsx)("div",{className:"ant-picker-cell-inner",style:b?{position:"relative",zIndex:2,display:"inlineBlock",width:"24px",height:"22px",lineHeight:"22px",backgroundColor:"#1890ff",color:"#fff",margin:"auto",borderRadius:"2px",transition:"background 0.3s, border 0.3s"}:{},children:j.date()})},[s]),h=Object(g.useCallback)(function(j){var b=j.value,o=j.onClose,l=function(){o(),C(s.filter(function(U){return U!==b}))};return Object(t.jsx)(mt.a,{onClose:l,closable:!0,children:w()(b).format(M)})},[s]),R=function(){return{disabledMinutes:function(){return Array.from({length:59},function(o,l){return l+1})}}};return Object(t.jsx)(vt.a,Object(a.a)(Object(a.a)({},H),{},{allowClear:!0,mode:"multiple",value:s,onClear:function(){return C&&C([])},tagRender:h,open:G,onFocus:function(){return r(!0)},onBlur:function(){return r(!1)},dropdownMatchSelectWidth:!1,dropdownClassName:"multipleDropdownClassName",dropdownStyle:{height:"310px",width:"335px",minWidth:"0"},dropdownRender:function(){return Object(t.jsx)(st.a,{disabledDate:function(o){var l=new Date;return o&&o.valueOf()<=l.setDate(l.getDate()-1)},showTime:{format:"HH"},disabledTime:R,onChange:function(o){return o&&p(o)},open:!0,dateRender:u,style:{visibility:"hidden"},getPopupContainer:function(o){var l=o.parentNode;return l},defaultValue:w()("00:00","HH")})}}))},pt=xt,tt=e("c+yx"),ot=e("Gn8c"),et;(function(v){v.draft="draft",v.published="published",v.archived="archived"})(et||(et={}));var Ct=e("eFHa"),Mt=e("4f6N"),Et=e("CiB2"),Vt=e("qbNl"),yt=e("JBPa"),Ht=e("5Dmo"),Dt=e("3S7+"),Gt=e("Awhp"),it=e("KrTs"),Pt=e("Qiat"),Tt=function(i){var O=i.data,s=i.onChange,C=Object(g.useState)(!1),m=Object(W.a)(C,2),M=m[0],V=m[1],H=Object(g.useState)(w()(O.date)),c=Object(W.a)(H,2),I=c[0],G=c[1],r=Object(g.useCallback)(function(p){G(w()(p)),V(!0),Object(_.a)(O.consultation_term_id,p).then(function(u){u.success?(P.b.success(u.message),s(I)):P.b.error(u.message)}).catch(function(u){return P.b.error(u.toString())}).finally(function(){return V(!1)})},[I]);return Object(t.jsx)(q.a.Fragment,{children:Object(t.jsx)(st.a,{disabledDate:function(u){var h=new Date;return u&&u.valueOf()<=h.setDate(h.getDate()-1)},disabled:M,value:I,showTime:{format:"HH"},onChange:function(u){u&&r(u.toISOString())}})})},lt={reported:"warning",reject:"error",approved:"success"},St=[{title:Object(t.jsx)(n.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"consultation_term_id",hideInSearch:!0,sorter:!0,width:"80px"},{title:Object(t.jsx)(n.a,{id:"user",defaultMessage:"user"}),dataIndex:"user",render:function(i,O){var s,C,m;return"".concat((s=O.user)===null||s===void 0?void 0:s.first_name," ").concat((C=O.user)===null||C===void 0?void 0:C.last_name," ").concat((m=O.user)===null||m===void 0?void 0:m.email)},sorter:!0},{title:Object(t.jsx)(n.a,{id:"date",defaultMessage:"date"}),dataIndex:"date",sorter:!0,render:function(i,O){return w()(O.date).format("yyyy-MM-DD HH:mm")}},{title:Object(t.jsx)(n.a,{id:"status",defaultMessage:"status"}),dataIndex:"status",sorter:!0,render:function(i,O){return Object(t.jsx)(it.a,{status:lt[O.status],text:Object(t.jsx)(n.a,{id:O.status})})}}],It=function(i){var O=i.consultation,s=Object(g.useState)(!1),C=Object(W.a)(s,2),m=C[0],M=C[1],V=Object(g.useState)([]),H=Object(W.a)(V,2),c=H[0],I=H[1],G=Object(n.l)(),r=Object(g.useCallback)(function(){M(!0),Object(_.f)(O).then(function(u){u.success&&I(u.data)}).catch(function(){P.b.error(Object(t.jsx)(n.a,{id:"error",defaultMessage:"error"}))}).finally(function(){return M(!1)})},[O]);Object(g.useEffect)(function(){r()},[O]);var p=Object(g.useCallback)(function(u){return Object(t.jsx)("ul",{className:"events",children:c.map(function(h){if(u.format("yyyy-MM-DD")===w()(h.date).format("yyyy-MM-DD")){var R,j,b,o;return Object(t.jsx)("li",{children:Object(t.jsx)(it.a,{status:lt[h.status],text:Object(t.jsx)(q.a.Fragment,{children:Object(t.jsxs)(Dt.a,{title:"".concat((R=h.user)===null||R===void 0?void 0:R.first_name," ").concat((j=h.user)===null||j===void 0?void 0:j.last_name," ").concat((b=h.user)===null||b===void 0?void 0:b.email),children:[Object(t.jsx)("small",{children:w()(h.date).format("HH:mm")})," ",(o=h.user)===null||o===void 0?void 0:o.email]})})})},h.consultation_term_id)}return null})})},[c]);return Object(t.jsxs)(q.a.Fragment,{children:[m&&Object(t.jsx)(E.a,{}),Object(t.jsx)(yt.a,{dateCellRender:p}),m?Object(t.jsx)(E.a,{}):Object(t.jsx)(Pt.a,{headerTitle:G.formatMessage({id:"Consultations",defaultMessage:"Consultations"}),loading:m,rowKey:"consultation_term_id",search:!1,request:function(){var u=Object(z.a)(Object(T.a)().mark(function h(R,j){var b,o;return Object(T.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return Object(Et.a)(R),b=j&&Object.entries(j)[0],o=c,b&&(o=Object(tt.i)(o,b[0],b[1]!=="ascend")),d.abrupt("return",{data:o,total:o.length,success:!0});case 5:case"end":return d.stop()}},h)}));return function(h,R){return u.apply(this,arguments)}}(),columns:[].concat(St,[{title:Object(t.jsx)(n.a,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",width:"20%",render:function(h,R){return[Object(t.jsx)(Tt,{data:R,onChange:function(){return r()}},"change_date")]}}])})]})},At=It,Rt=e("q34N"),Ut=e("5RzD"),Bt=e("CiXh"),Jt=e("J+hL"),K;(function(v){v.ATTRIBUTES="attributes",v.PRODUCT="product",v.MEDIA="media",v.CATEGORIES="categories",v.BRANDING="branding",v.USER_SUBMISSION="user_submission",v.CALENDAR="calendar"})(K||(K={}));var Lt=function(){var i=Object(n.l)(),O=Object(bt.l)(),s=O.consultation,C=O.tab,m=C===void 0?"attributes":C,M=s==="new",V=Object(g.useState)(),H=Object(W.a)(V,2),c=H[0],I=H[1],G=Object(Ct.a)(),r=G.manageCourseEdit,p=G.setManageCourseEdit,u=G.validateCourseEdit,h=S.a.useForm(),R=Object(W.a)(h,1),j=R[0],b=Object(g.useCallback)(Object(z.a)(Object(T.a)().mark(function l(){var d,U;return Object(T.a)().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,Object(_.e)(Number(s));case 2:d=J.sent,d.success&&(m==="attributes"&&u(d.data),I(Object(a.a)(Object(a.a)({},d.data),{},{author_id:d.data.author&&d.data.author.id,categories:(U=d.data.categories)===null||U===void 0?void 0:U.map(tt.a)})));case 4:case"end":return J.stop()}},l)})),[s]);Object(g.useEffect)(function(){if(M){I({name:"new"});return}b()},[s]);var o=Object(g.useMemo)(function(){return{onValuesChange:function(){p(Object(a.a)(Object(a.a)({},r),{},{valuesChanged:!0}))},onFinish:function(){var l=Object(z.a)(Object(T.a)().mark(function U(dt){var J,Q;return Object(T.a)().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:if(!r.disableEdit){N.next=3;break}return p({showModal:!0,disableEdit:!0,clicked:!1}),N.abrupt("return");case 3:if(J=Object(a.a)(Object(a.a)({},dt),{},{image_url:c&&c.image_url,image_path:c&&c.image_url&&Object(tt.k)(c.image_url),logotype_url:c&&c.logotype_url,logotype_path:c&&c.logotype_path&&Object(tt.k)(c.logotype_path)}),!M){N.next=11;break}return N.next=7,Object(_.c)(J);case 7:Q=N.sent,Q.success&&n.f.push("/other/consultations/".concat(Q.data.id)),N.next=15;break;case 11:return N.next=13,Object(_.g)(Number(s),J);case 13:Q=N.sent,Q.success&&(u(Q.data),n.f.push("/other/consultations/".concat(Q.data.id,"/").concat(m)));case 15:P.b.success(Q.message),p(Object(a.a)(Object(a.a)({},r),{},{showConfirmModal:!1,loading:!1,valuesChanged:!1}));case 17:case"end":return N.stop()}},U)}));function d(U){return l.apply(this,arguments)}return d}(),initialValues:c}},[c,s,m,r]);return c?Object(t.jsxs)(jt.a,{title:M?Object(t.jsx)(n.a,{id:"consultation"}):Object(t.jsx)(n.a,{id:"consultations.edit"}),header:{breadcrumb:{routes:[{path:"other/consultations",breadcrumbName:i.formatMessage({id:"menu.Other activities.Consultations"})},{path:String(s),breadcrumbName:i.formatMessage({id:"form"})},{path:"/",breadcrumbName:String(c.name)},{path:String(m),breadcrumbName:String(c.name)}]}},children:[Object(t.jsxs)($.a,{tabs:{type:"card",activeKey:m,onChange:function(d){d!==K.ATTRIBUTES&&r.valuesChanged?p(Object(a.a)(Object(a.a)({},r),{},{showConfirmModal:!0})):n.f.push("/other/consultations/".concat(s,"/").concat(d))}},children:[Object(t.jsxs)($.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"attributes"}),children:[r.disableEdit&&Object(t.jsx)(Y.a,{closable:!0,style:{marginBottom:"20px"},type:"warning",message:Object(t.jsx)(n.a,{id:"course_edit_warning_message",defaultMessage:"course_edit_warning_message"}),action:Object(t.jsx)(x.a,{onClick:function(){return p({showModal:!0,disableEdit:!0,clicked:!0})},type:"primary",children:Object(t.jsx)(n.a,{id:"questionnaire.submit",defaultMessage:"questionnaire.submit"})})}),Object(t.jsx)(Mt.a,{visible:r.showModal,setManage:p}),Object(t.jsxs)(S.a,Object(a.a)(Object(a.a)({},o),{},{form:j,children:[Object(t.jsxs)(S.a.Group,{children:[Object(t.jsx)(at.a,{width:"md",name:"name",label:Object(t.jsx)(n.a,{id:"name"}),tooltip:Object(t.jsx)(n.a,{id:"name"}),placeholder:i.formatMessage({id:"name",defaultMessage:"name"}),required:!0,disabled:r.disableEdit}),Object(t.jsx)(at.a,{width:"sm",name:"duration",label:Object(t.jsx)(n.a,{id:"duration"}),tooltip:Object(t.jsx)(n.a,{id:"consultations.duration_tooltip"}),placeholder:i.formatMessage({id:"duration",defaultMessage:"duration"}),disabled:r.disableEdit}),Object(t.jsx)(ct.a,{name:"status",width:"sm",label:Object(t.jsx)(n.a,{id:"status"}),tooltip:Object(t.jsx)(n.a,{id:"status_consultation_tooltip"}),valueEnum:{draft:i.formatMessage({id:"draft",defaultMessage:"draft"}),published:i.formatMessage({id:"published",defaultMessage:"published"}),archived:i.formatMessage({id:"archived",defaultMessage:"archived"})},initialValue:et.draft,placeholder:i.formatMessage({id:"status"}),rules:[{required:!0,message:Object(t.jsx)(n.a,{id:"select"})}],disabled:r.disableEdit})]}),Object(t.jsxs)(S.a.Group,{children:[Object(t.jsx)(nt.a,{width:"sm",name:"active_from",label:Object(t.jsx)(n.a,{id:"active_from"}),tooltip:Object(t.jsx)(n.a,{id:"active_from"}),placeholder:i.formatMessage({id:"active_from",defaultMessage:"active_from"}),disabled:r.disableEdit}),Object(t.jsx)(nt.a,{width:"sm",name:"active_to",label:Object(t.jsx)(n.a,{id:"active_to"}),tooltip:Object(t.jsx)(n.a,{id:"active_to"}),placeholder:i.formatMessage({id:"active_to",defaultMessage:"active_to"}),disabled:r.disableEdit}),Object(t.jsx)(S.a.Item,{name:"author_id",label:Object(t.jsx)(n.a,{id:"tutor"}),tooltip:Object(t.jsx)(n.a,{id:"tutor_consultation_tooltip"}),valuePropName:"value",required:!0,children:Object(t.jsx)(Ot.a,{})})]}),Object(t.jsx)(S.a.Group,{children:Object(t.jsx)(S.a.Item,{name:"description",label:Object(t.jsx)(n.a,{id:"description"}),tooltip:Object(t.jsx)(n.a,{id:"description_tooltip"}),valuePropName:"value",required:!0,children:Object(t.jsx)(ut.a,{directory:"consultation/".concat(s,"/wysiwyg")})})}),Object(t.jsx)(S.a.Group,{children:Object(t.jsx)(S.a.Item,{valuePropName:"value",name:"proposed_terms",tooltip:Object(t.jsx)(n.a,{id:"proposed_terms_tooltip"}),label:Object(t.jsx)(n.a,{id:"consultations.proposed_terms"}),children:Object(t.jsx)(pt,{})})})]}))]},K.ATTRIBUTES),!M&&Object(t.jsx)($.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"product"}),disabled:r.disableEdit,children:s&&Object(t.jsx)(Rt.a,{type:"line",productable:{class_type:"App\\Models\\Consultation",class_id:s,name:String(c.name),quantity:1}})},K.PRODUCT),!M&&Object(t.jsx)($.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"media"}),disabled:r.disableEdit,children:Object(t.jsx)(S.a,Object(a.a)(Object(a.a)({},o),{},{children:Object(t.jsx)(ot.a,{folder:"consultation/".concat(s),title:"image",action:"/api/admin/consultations/".concat(s),src_name:"image_url",form_name:"image",getUploadedSrcField:function(d){return d.file.response.data.image_url},setPath:function(d){return I(function(U){return Object(a.a)(Object(a.a)({},U),d)})}})}))},K.MEDIA),!M&&Object(t.jsx)($.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"categories"}),disabled:r.disableEdit,children:Object(t.jsx)(A.a,{children:Object(t.jsx)(f.a,{span:12,children:Object(t.jsx)(S.a,Object(a.a)(Object(a.a)({},o),{},{children:Object(t.jsx)(S.a.Item,{label:Object(t.jsx)(n.a,{id:"categories"}),name:"categories",valuePropName:"value",children:Object(t.jsx)(ft.a,{})})}))})})},K.CATEGORIES)," ",!M&&Object(t.jsx)($.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"branding"}),disabled:r.disableEdit,children:Object(t.jsx)(S.a,Object(a.a)(Object(a.a)({},o),{},{children:Object(t.jsx)(ot.a,{folder:"consultation/".concat(s),title:i.formatMessage({id:"logotype"}),action:"/api/admin/consultations/".concat(s),src_name:"logotype_url",form_name:"logotype",getUploadedSrcField:function(d){return d.file.response.data.logotype_url},setPath:function(d){return I(function(U){return Object(a.a)(Object(a.a)({},U),d)})}})}))},K.BRANDING)," ",!M&&Object(t.jsx)($.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"user_submission"}),disabled:r.disableEdit,children:Object(t.jsx)(A.a,{children:Object(t.jsx)(f.a,{span:12,children:s&&Object(t.jsx)(Ut.a,{id:Number(s),type:"App\\Models\\Consultation"})})})},K.USER_SUBMISSION),!M&&Object(t.jsx)($.a.TabPane,{tab:Object(t.jsx)(n.a,{id:"consultations.calendar"}),children:Object(t.jsx)(At,{consultation:Number(s)})},K.CALENDAR)]}),Object(t.jsx)(Bt.a,{open:!!r.showConfirmModal,onOk:function(){p(Object(a.a)(Object(a.a)({},r),{},{loading:!0})),j.submit()},onCancel:function(){p(Object(a.a)(Object(a.a)({},r),{},{showConfirmModal:!1}))},loading:!!r.loading})]}):Object(t.jsx)(E.a,{})},Yt=y.default=Lt}}]);

//# sourceMappingURL=p__Consultations__form.7844b3ea.async.js.map