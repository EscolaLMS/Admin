(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"60mZ":function(qe,V,e){},EKp7:function(qe,V,e){"use strict";e.r(V);var C=e("T2oS"),J=e("W9HT"),f=e("q1tI"),c=e("9kvl"),X=e("Ty5D"),Se=e("tMyG"),me=e("nhC9"),N=e("tKSU"),$=e("qLMh"),Me=e("miYZ"),F=e("tsqr"),S=e("9og8"),E=e("k1fw"),s=e("PpiC"),A=e("tJVT"),g=e("VMEa"),W=e("Qurx"),K=e("yj/a"),ue=e("F/zT"),Z=e("BiO0"),y=e("CEpB"),O=e("0WSk"),M=e("Gn8c"),Q=e("hd5d"),d=e("YRX9"),ne=e("/y+f"),r=e("nKUr"),t=["authors","category"],Qe=Object.values(ne.b).map(function(ye){return{value:ye,label:Object(r.jsx)(c.a,{id:"CompetencyChallenges.types.".concat(ye)})}}),we=function(){var z=Object(N.b)(),b=z.competencyChallenge,ee=z.categoryDepths,R=z.refreshData,te=Object(X.l)(),_=Number(te.id),se=Object(c.l)(),be=g.a.useForm(),Te=Object(A.a)(be,1),ae=Te[0],Oe=g.a.useWatch("type",ae),Ce=Number.isNaN(_),fe=Object(f.useMemo)(function(){if(!(b!=null&&b.data))return{};var D=b==null?void 0:b.data,w=D.authors,ve=D.category,Y=Object(s.a)(D,t);return Object(E.a)(Object(E.a)({},Y),{},{authors:w.map(function(G){var q=G.id;return q}),category_id:ve==null?void 0:ve.id})},[b==null?void 0:b.data]),de=Object(f.useCallback)(function(){var D=Object(S.a)(Object($.a)().mark(function w(ve){var Y,G,q,re,B,T,Pe,l;return Object($.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Y=ve.name,G=ve.type,q=ve.is_active,re=q===void 0?!1:q,B=ve.is_highlighted,T=B===void 0?!1:B,Pe=ve.category_id,n.prev=1,n.next=4,Object(d.a)({name:Y,is_active:re,is_highlighted:T,type:G,category_id:Pe});case 4:if(l=n.sent,l.success){n.next=8;break}return F.b.error(l.message),n.abrupt("return");case 8:return F.b.success(se.formatMessage({id:l.message})),c.f.push("/competency-challenges/".concat(l.data.id,"/main")),n.next=12,R();case 12:n.next=17;break;case 14:n.prev=14,n.t0=n.catch(1),F.b.error(se.formatMessage({id:"error"}));case 17:case"end":return n.stop()}},w,null,[[1,14]])}));return function(w){return D.apply(this,arguments)}}(),[]),ze=Object(f.useCallback)(function(){var D=Object(S.a)(Object($.a)().mark(function w(ve){var Y,G,q,re;return Object($.a)().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.prev=0,Y=ae.getFieldsValue(["image_url","image_path"]),G=Y.image_url,q=Y.image_path,T.next=4,Object(d.g)(_,Object(E.a)(Object(E.a)({},ve),{},{image_url:G,image_path:q}));case 4:if(re=T.sent,re.success){T.next=8;break}return F.b.error(re.message),T.abrupt("return");case 8:return F.b.success(se.formatMessage({id:re.message})),T.next=11,R();case 11:T.next=16;break;case 13:T.prev=13,T.t0=T.catch(0),F.b.error(se.formatMessage({id:"error"}));case 16:case"end":return T.stop()}},w,null,[[0,13]])}));return function(w){return D.apply(this,arguments)}}(),[_]);return Object(r.jsxs)(g.a,{form:ae,initialValues:fe,onFinish:Ce?de:ze,onValuesChange:function(w){(w==null?void 0:w.type)==="complex"&&ae.setFieldValue("category",null)},children:[Object(r.jsxs)(g.a.Group,{title:Object(r.jsx)(c.a,{id:"CompetencyChallenges.base"}),children:[Object(r.jsx)(W.a,{width:"md",name:"name",label:Object(r.jsx)(c.a,{id:"name"}),placeholder:se.formatMessage({id:"name"}),required:!0,rules:[{required:!0,message:se.formatMessage({id:"field_required"})}]}),Object(r.jsx)(K.a,{width:"md",name:"type",label:Object(r.jsx)(c.a,{id:"type"}),options:Qe,required:!0,rules:[{required:!0,message:se.formatMessage({id:"field_required"})}]}),Oe==="simple"&&Object(r.jsx)(g.a.Item,{name:"category_id",required:!0,label:Object(r.jsx)(c.a,{id:"category"}),rules:[{required:!0,message:se.formatMessage({id:"field_required"})}],children:Object(r.jsx)(y.a,{enabledDepth:ee.role})}),Object(r.jsx)(ue.a,{name:"is_active",label:Object(r.jsx)(c.a,{id:"is_active"})}),Object(r.jsx)(ue.a,{name:"is_highlighted",label:Object(r.jsx)(c.a,{id:"is_highlighted"}),tooltip:Object(r.jsx)(c.a,{id:"CompetencyChallenges.highlighted"})})]}),!Ce&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(g.a.Group,{title:Object(r.jsx)(c.a,{id:"CompetencyChallenges.additional"}),children:[Object(r.jsx)(g.a.Item,{name:"description",label:Object(r.jsx)(c.a,{id:"description"}),valuePropName:"value",style:{width:440},children:Object(r.jsx)(Q.a,{directory:"competency-challenges/".concat(_)})}),Object(r.jsx)(Z.a,{width:"lg",name:"summary",label:Object(r.jsx)(c.a,{id:"summary"})}),Object(r.jsx)(g.a.Item,{name:"authors",label:Object(r.jsx)(c.a,{id:"author"}),style:{width:"100%",maxWidth:440},children:Object(r.jsx)(O.a,{multiple:!0})})]}),Object(r.jsx)(M.a,{wrapInForm:!1,folder:"/competency-challenges/".concat(_),title:"image",action:"/api/admin/competency-challenges/".concat(_,"?_method=PATCH"),src_name:"image_url",form_name:"image",getUploadedSrcField:function(w){return w.file.response.data.image_url},setPath:function(w){return ae.setFieldsValue(w)}})]})]})},He=e("P2fV"),De=e("NJEC"),pe=e("5Dmo"),ge=e("3S7+"),j=e("+L6B"),k=e("2/Rp"),Re=e("G3dp"),Ie=e("/MfK"),We=e("Hn4i"),je=e("enqX"),Ue=["scale_min","category_id"],Ke=[{title:Object(r.jsx)(c.a,{id:"ID"}),dataIndex:"id",editable:!1,render:function(z,b){if(typeof b.id!="string")return"-";var ee=b.id.split("-"),R=Object(A.a)(ee,2),te=R[0],_=R[1];return te==="new"?"-":_}},{title:Object(r.jsx)(c.a,{id:"min_points"}),dataIndex:"scale_min",valueType:"digit",formItemProps:{rules:[{required:!0,message:Object(r.jsx)(c.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(r.jsx)(c.a,{id:"number_between",values:{min:0}})}]},fieldProps:{min:0}},{title:Object(r.jsx)(c.a,{id:"category"}),dataIndex:"category_id",render:function(z,b){return b.category_name},formItemProps:{rules:[{required:!0,message:Object(r.jsx)(c.a,{id:"field_required"})}]},renderFormItem:function(z,b,ee){var R,te=((R=ee.getFieldValue("table"))!==null&&R!==void 0?R:[]).map(function(_){return _.category_id});return Object(r.jsx)(je.a,{disabledNodes:te})}}],Ve=function(z){return z.map(function(b){var ee=b.id,R=b.scale_min,te=b.category;return{id:"old-".concat(ee),scale_min:R,category_id:te.id,category_name:te.name_with_breadcrumbs}})},Fe=function(){var z,b,ee=Object(N.b)(),R=ee.competencyChallenge,te=ee.refreshData,_=Object(X.l)(),se=Number(_.id),be=(z=R==null||(b=R.data)===null||b===void 0?void 0:b.scales)!==null&&z!==void 0?z:[],Te=Object(f.useState)([]),ae=Object(A.a)(Te,2),Oe=ae[0],Ce=ae[1],fe=Object(c.l)(),de=Object(f.useRef)(),ze=Object(f.useRef)(),D=Object(f.useRef)(),w=Object(f.useMemo)(function(){return Ve(be)},[be]),ve=Object(f.useMemo)(function(){return[].concat(Ke,[{valueType:"option",title:Object(r.jsx)(c.a,{id:"options"}),render:function(G,q,re,B){return[Object(r.jsx)(ge.a,{title:Object(r.jsx)(c.a,{id:"edit",defaultMessage:"edit"}),children:Object(r.jsx)(k.a,{type:"primary",icon:Object(r.jsx)(Re.a,{}),onClick:function(){return B==null?void 0:B.startEditable(q.id)}})},"edit"),Object(r.jsx)(De.a,{title:Object(r.jsx)(c.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(S.a)(Object($.a)().mark(function T(){var Pe,l,a,n,i,o,v,m;return Object($.a)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(typeof q.id=="string"){u.next=2;break}return u.abrupt("return");case 2:if(Pe=q.id.split("-"),l=Object(A.a)(Pe,2),a=l[0],n=l[1],a!=="new"){u.next=7;break}return v=(i=de.current)===null||i===void 0?void 0:i.getFieldValue("table"),(o=de.current)===null||o===void 0||o.setFieldValue("table",v.filter(function(P){var x=P.id;return x!==q.id})),u.abrupt("return");case 7:return u.next=9,Object(d.d)(+n);case 9:if(m=u.sent,!m.success){u.next=13;break}return u.next=13,te();case 13:case"end":return u.stop()}},T)})),okText:Object(r.jsx)(c.a,{id:"ok"}),cancelText:Object(r.jsx)(c.a,{id:"cancel"}),children:Object(r.jsx)(ge.a,{title:Object(r.jsx)(c.a,{id:"delete",defaultMessage:"delete"}),children:Object(r.jsx)(k.a,{type:"primary",icon:Object(r.jsx)(Ie.a,{}),danger:!0})})},"delete")]}}])},[]);return Object(r.jsx)(g.a,{formRef:de,initialValues:{table:w},submitter:!1,children:Object(r.jsx)(We.a,{rowKey:function(G){return G.id},editableFormRef:ze,controlled:!0,actionRef:D,name:"table",columns:ve,recordCreatorProps:{creatorButtonText:Object(r.jsx)(c.a,{id:"CompetencyChallenges.addNewRow"}),disabled:Oe.length>0,record:function(G){return{id:"new-".concat(G)}}},editable:{onlyOneLineEditorAlertMessage:fe.formatMessage({id:"CompetencyChallenges.onlyOneRowIsEditable"}),onSave:function(){var Y=Object(S.a)(Object($.a)().mark(function q(re,B){var T,Pe,l,a,n,i,o,v,m;return Object($.a)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(T=B.scale_min,Pe=B.category_id,l=Object(s.a)(B,Ue),typeof l.id=="string"){u.next=3;break}return u.abrupt("return");case 3:if(a=l.id.split("-"),n=Object(A.a)(a,2),i=n[0],o=n[1],i!=="new"){u.next=12;break}return u.next=7,Object(d.b)({scale_min:T,category_id:Pe,competency_challenge_id:se});case 7:if(v=u.sent,!v.success){u.next=11;break}return u.next=11,te();case 11:return u.abrupt("return");case 12:return u.next=14,Object(d.h)(+o,{scale_min:T,category_id:Pe,competency_challenge_id:se});case 14:if(m=u.sent,!m.success){u.next=18;break}return u.next=18,te();case 18:return u.abrupt("return");case 19:case"end":return u.stop()}},q)}));function G(q,re){return Y.apply(this,arguments)}return G}(),deletePopconfirmMessage:Object(r.jsx)(c.a,{id:"deleteQuestion"}),actionRender:function(G,q,re){if(typeof G.id!="string")return[];var B=G.id.split("-"),T=Object(A.a)(B,1),Pe=T[0];return Pe==="new"?[re.save,re.delete]:[re.save,re.cancel]},type:"single",editableKeys:Oe,onChange:Ce}})})},ke=e("/zsF"),Ye=e("PArb"),et=e("DYRE"),Ne=e("zeV3"),Je=e("uD7z"),_e=e("FJDo"),Xe=e("4KAj"),st=e("yioT"),ce=e("qRSf"),it=e("rmhi"),ot=function(z){var b=z.quiz_id,ee=z.visible,R=z.onVisibleChange,te=g.a.useForm(),_=Object(A.a)(te,1),se=_[0],be=Object(f.useCallback)(function(){var Te=Object(S.a)(Object($.a)().mark(function ae(Oe){var Ce,fe,de;return Object($.a)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return Ce=Oe.category_ids,D.prev=1,D.next=4,Object(ce.c)({quiz_id:b,category_ids:Ce});case 4:fe=D.sent,fe instanceof Blob&&(de=document.createElement("a"),de.href=window.URL.createObjectURL(fe),de.download="quiz_".concat(b,"_questions_by_category_id.xlsx"),document.body.appendChild(de),de.click(),document.body.removeChild(de)),D.next=11;break;case 8:D.prev=8,D.t0=D.catch(1),console.error(D.t0);case 11:return D.prev=11,R(!1),D.finish(11);case 14:case"end":return D.stop()}},ae,null,[[1,8,11,14]])}));return function(ae){return Te.apply(this,arguments)}}(),[b]);return Object(r.jsx)(it.a,{title:Object(r.jsx)(c.a,{id:"exportQuestions"}),form:se,visible:ee,onVisibleChange:R,onFinish:be,children:Object(r.jsx)(g.a.Item,{name:"category_ids",label:Object(r.jsx)(c.a,{id:"categories"}),required:!0,rules:[{required:!0,message:Object(r.jsx)(c.a,{id:"field_required"})}],children:Object(r.jsx)(je.a,{multiple:!0,type:"question"})})})},tt=function(){var z=Object(N.b)(),b=z.competencyChallenge.data,ee=Object(f.useState)(!1),R=Object(A.a)(ee,2),te=R[0],_=R[1],se=Object(f.useState)(!1),be=Object(A.a)(se,2),Te=be[0],ae=be[1],Oe=Object(f.useState)(),Ce=Object(A.a)(Oe,2),fe=Ce[0],de=Ce[1],ze=Object(c.l)(),D=Object(f.useCallback)(function(){return _(!0)},[]),w=Object(f.useCallback)(function(){(b==null?void 0:b.quiz_id)!==void 0&&(ae(!0),Object(ce.d)(b==null?void 0:b.quiz_id).then(function(Y){Y.success&&de(Y.data)}).finally(function(){return ae(!1)}))},[b==null?void 0:b.quiz_id]),ve=Object(f.useCallback)(function(){var Y=Object(S.a)(Object($.a)().mark(function G(q){return Object($.a)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if((b==null?void 0:b.quiz_id)!==void 0){B.next=2;break}return B.abrupt("return");case 2:ae(!0),Object(ce.g)(b==null?void 0:b.quiz_id,Object(E.a)(Object(E.a)({},q),{},{value:"diagnostic-test"})).then(function(T){T.success&&de(T.data)}).finally(function(){return ae(!1)});case 4:case"end":return B.stop()}},G)}));return function(G){return Y.apply(this,arguments)}}(),[]);return Object(f.useEffect)(function(){w()},[w]),fe?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ot,{visible:te,onVisibleChange:_,quiz_id:fe.id}),Object(r.jsxs)("div",{style:{position:"relative",paddingBottom:"64px"},children:[Object(r.jsx)(g.a,{submitter:{render:function(G,q){var re=Object(A.a)(q,2),B=re[0],T=re[1];return Object(r.jsxs)(Ne.b,{style:{position:"absolute",bottom:0,left:0},children:[B,T]})}},initialValues:fe,onFinish:ve,children:Object(r.jsxs)(Je.a,{children:[Object(r.jsx)(_e.a,{name:"max_attempts",label:Object(r.jsx)(c.a,{id:"max_attempts"}),tooltip:Object(r.jsx)(c.a,{id:"max_attempts"}),placeholder:ze.formatMessage({id:"max_attempts",defaultMessage:"max_attempts"})}),Object(r.jsx)(_e.a,{name:"max_execution_time",label:Object(r.jsx)(c.a,{id:"max_execution_time"}),tooltip:Object(r.jsx)(c.a,{id:"max_execution_time"}),placeholder:ze.formatMessage({id:"max_execution_time",defaultMessage:"max_execution_time"})})]})}),Object(r.jsx)(Ye.a,{}),Object(r.jsx)(st.a,{questions:fe.questions,quizId:fe.id,onAdded:w,onEdited:w,onRemoved:w,tableHeader:Object(r.jsx)(c.a,{id:"questions"}),tableLoading:Te,questionsCategory:{type:"question"},customToolbarElements:[Object(r.jsxs)(k.a,{type:"primary",icon:Object(r.jsx)(Xe.a,{}),onClick:D,children:[" ",Object(r.jsx)(c.a,{id:"exportQuestionsByCategory"})]},"export_by_category")]})]})]}):Object(r.jsx)(J.a,{})},ct=function(){var z,b=Object(N.b)(),ee=b.competencyChallenge,R=Object(c.l)(),te=Object(X.l)(),_=te.id,se=te.tab,be=se===void 0?"main":se,Te=_==="new",ae=Object(f.useMemo)(function(){var Oe;return Te?R.formatMessage({id:"CompetencyChallenges.new_challenge"}):(Oe=ee.data)!==null&&Oe!==void 0&&Oe.name?ee.data.name:R.formatMessage({id:"menu.Competency challenges"})},[R,(z=ee.data)===null||z===void 0?void 0:z.name]);return Object(r.jsx)(Se.a,{title:ae,header:{breadcrumb:{routes:[{path:"competency-challenges",breadcrumbName:R.formatMessage({id:"menu.Competency challenges"})},{path:String(_),breadcrumbName:ae},{path:be,breadcrumbName:R.formatMessage({id:"CompetencyChallenges.".concat(be)})}]}},children:Object(r.jsxs)(me.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",cardProps:{loading:ee.loading&&Object(r.jsx)(J.a,{})},activeKey:be,onChange:function(Ce){c.f.push("/competency-challenges/".concat(_,"/").concat(Ce))}},children:[Object(r.jsx)(me.a.TabPane,{tab:Object(r.jsx)(c.a,{id:"CompetencyChallenges.main"}),children:Object(r.jsx)(we,{})},"main"),Object(r.jsx)(me.a.TabPane,{tab:Object(r.jsx)(c.a,{id:"CompetencyChallenges.scales"}),disabled:Te,children:Object(r.jsx)(Fe,{})},"scales"),Object(r.jsx)(me.a.TabPane,{tab:Object(r.jsx)(c.a,{id:"CompetencyChallenges.diagnostic-test"}),disabled:Te,children:Object(r.jsx)(tt,{})},"diagnostic-test")]})})},Ge=function(){return Object(r.jsx)(N.a,{children:Object(r.jsx)(ct,{})})},ut=V.default=Ge},YRX9:function(qe,V,e){"use strict";e.d(V,"f",function(){return X}),e.d(V,"e",function(){return me}),e.d(V,"a",function(){return $}),e.d(V,"g",function(){return F}),e.d(V,"c",function(){return E}),e.d(V,"b",function(){return A}),e.d(V,"h",function(){return W}),e.d(V,"d",function(){return ue});var C=e("qLMh"),J=e("k1fw"),f=e("9og8"),c=e("9kvl");function X(y,O){return Se.apply(this,arguments)}function Se(){return Se=Object(f.a)(Object(C.a)().mark(function y(O,M){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges",Object(J.a)({method:"GET",useCache:!1,params:O},M||{})));case 1:case"end":return d.stop()}},y)})),Se.apply(this,arguments)}function me(y,O){return N.apply(this,arguments)}function N(){return N=Object(f.a)(Object(C.a)().mark(function y(O,M){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges/".concat(O),Object(J.a)({method:"GET",useCache:!1},M||{})));case 1:case"end":return d.stop()}},y)})),N.apply(this,arguments)}function $(y,O){return Me.apply(this,arguments)}function Me(){return Me=Object(f.a)(Object(C.a)().mark(function y(O,M){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges",Object(J.a)({method:"POST",headers:{"Content-Type":"application/json"},data:O},M||{})));case 1:case"end":return d.stop()}},y)})),Me.apply(this,arguments)}function F(y,O,M){return S.apply(this,arguments)}function S(){return S=Object(f.a)(Object(C.a)().mark(function y(O,M,Q){return Object(C.a)().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.abrupt("return",Object(c.i)("/api/admin/competency-challenges/".concat(O),Object(J.a)({method:"PUT",headers:{"Content-Type":"application/json"},data:M},Q||{})));case 1:case"end":return ne.stop()}},y)})),S.apply(this,arguments)}function E(y,O){return s.apply(this,arguments)}function s(){return s=Object(f.a)(Object(C.a)().mark(function y(O,M){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges/".concat(O),Object(J.a)({method:"DELETE"},M||{})));case 1:case"end":return d.stop()}},y)})),s.apply(this,arguments)}function A(y,O){return g.apply(this,arguments)}function g(){return g=Object(f.a)(Object(C.a)().mark(function y(O,M){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges/scales",Object(J.a)({method:"POST",headers:{"Content-Type":"application/json"},data:O},M||{})));case 1:case"end":return d.stop()}},y)})),g.apply(this,arguments)}function W(y,O,M){return K.apply(this,arguments)}function K(){return K=Object(f.a)(Object(C.a)().mark(function y(O,M,Q){return Object(C.a)().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.abrupt("return",Object(c.i)("/api/admin/competency-challenges/scales/".concat(O),Object(J.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:M},Q||{})));case 1:case"end":return ne.stop()}},y)})),K.apply(this,arguments)}function ue(y,O){return Z.apply(this,arguments)}function Z(){return Z=Object(f.a)(Object(C.a)().mark(function y(O,M){return Object(C.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(c.i)("/api/admin/competency-challenges/scales/".concat(O),Object(J.a)({method:"DELETE"},M||{})));case 1:case"end":return d.stop()}},y)})),Z.apply(this,arguments)}},enqX:function(qe,V,e){"use strict";e.d(V,"a",function(){return S});var C=e("nRaC"),J=e("5RzL"),f=e("tJVT"),c=e("q1tI"),X=e.n(c),Se=e("9kvl"),me=e("JifO"),N=e("tKSU"),$=e("nKUr"),Me=e.n($),F=function E(s,A,g){var W,K=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return(W=s.subcategories)!==null&&W!==void 0&&W.length?{title:s.name,value:s.id,disabled:K!==g||A.includes(s.id),children:s.subcategories.map(function(ue){return E(ue,A,g,K+1)})}:{title:s.name,value:s.id,disabled:K!==g||A.includes(s.id)}},S=function(s){var A,g,W,K=s.value,ue=s.onChange,Z=s.type,y=Z===void 0?"scale":Z,O=s.disabledNodes,M=O===void 0?[]:O,Q=s.multiple,d=Q===void 0?!1:Q,ne=Object(c.useState)([]),r=Object(f.a)(ne,2),t=r[0],Qe=r[1],we=Object(N.b)(),He=we.categoryDepths,De=we.competencyChallenge,pe=Object(c.useMemo)(function(){var j;return((j=De.data)===null||j===void 0?void 0:j.type)==="simple"?t.filter(function(k){var Re,Ie;return k.id===((Re=De.data)===null||Re===void 0||(Ie=Re.category)===null||Ie===void 0?void 0:Ie.id)}):t},[t,(A=De.data)===null||A===void 0?void 0:A.type,(g=De.data)===null||g===void 0||(W=g.category)===null||W===void 0?void 0:W.id]),ge=Object(c.useMemo)(function(){return pe.map(function(j){return F(j,M,He[y])})},[pe,M,y]);return Object(c.useEffect)(function(){Object(me.c)().then(function(j){j.success&&Qe(j.data)})},[]),Object($.jsx)(J.a,{loading:t.length===0,showSearch:!0,multiple:d,value:K,dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:Object($.jsx)(Se.a,{id:"select",defaultMessage:"Please select"}),allowClear:!0,treeDefaultExpandAll:!0,onChange:ue,treeData:ge,disabled:t.length===0})}},hd5d:function(qe,V,e){"use strict";var C=e("qLMh"),J=e("9og8"),f=e("q1tI"),c=e.n(f),X=e("acco"),Se=e.n(X),me=e("BAh9"),N=e("vtG9"),$=e.n(N),Me=e("9kvl"),F=e("nKUr"),S=e.n(F),E=function(g){var W=g.attrs,K=W.href,ue=K.split("/").pop();return Object(F.jsx)("p",{children:Object(F.jsx)("a",{rel:"noreferrer",href:K,target:"_blank",children:ue})})},s=function(g){var W=g.value,K=g.onChange,ue=g.directory,Z=ue===void 0?"/wysiwyg":ue,y=Object(Me.l)();return Object(F.jsx)("div",{className:"form-wysiwyg-markdown",children:Object(F.jsx)(Se.a,{excludeBlockMenuItems:["Sketch"],embeds:[{matcher:function(M){return!0},component:E}],uploadImage:function(){var O=Object(J.a)(Object(C.a)().mark(function M(Q){var d,ne;return Object(C.a)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(me.e)(Q,Z);case 2:if(d=t.sent,!d.success){t.next=8;break}if(!Q.type.includes("image/")){t.next=7;break}return ne=d.data[0].name.includes("/")?d.data[0].name:"".concat(Z).concat(d.data[0].name),t.abrupt("return",Object(me.d)(ne,1e3));case 7:return t.abrupt("return",d.data[0].url);case 8:throw new Error("Error while uploading");case 9:case"end":return t.stop()}},M)}));return function(M){return O.apply(this,arguments)}}(),defaultValue:W||"",onChange:function(M){return K&&K(M())},placeholder:y.formatMessage({id:"wysiwyg_placeholder"})})})};V.a=s},tKSU:function(qe,V,e){"use strict";e.d(V,"b",function(){return s}),e.d(V,"a",function(){return A});var C=e("k1fw"),J=e("tJVT"),f=e("qLMh"),c=e("9og8"),X=e("q1tI"),Se=e.n(X),me=e("Ty5D"),N=e("YRX9"),$=e("+up7"),Me=e("nKUr"),F=e.n(Me),S={categoryDepths:{scale:2,question:1,role:0},competencyChallenge:{data:null,loading:!1},refreshData:function(){var g=Object(c.a)(Object(f.a)().mark(function K(){return Object(f.a)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",console.warn("CONTEXT INIT"));case 1:case"end":return Z.stop()}},K)}));function W(){return g.apply(this,arguments)}return W}()},E=Se.a.createContext(S),s=function(){return Object(X.useContext)(E)},A=function(W){var K=W.children,ue=Object(X.useState)(S.competencyChallenge),Z=Object(J.a)(ue,2),y=Z[0],O=Z[1],M=Object(X.useState)(S.categoryDepths),Q=Object(J.a)(M,2),d=Q[0],ne=Q[1],r=Object(me.l)(),t=r.id,Qe=Number(t),we=Object(X.useCallback)(Object(c.a)(Object(f.a)().mark(function De(){var pe;return Object(f.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!Number.isNaN(Qe)){j.next=2;break}return j.abrupt("return");case 2:return j.prev=2,O(function(k){return Object(C.a)(Object(C.a)({},k),{},{loading:!0})}),j.next=6,Object(N.e)(Qe);case 6:if(pe=j.sent,pe.success){j.next=10;break}return O(function(k){return Object(C.a)(Object(C.a)({},k),{},{error:pe.errors})}),j.abrupt("return");case 10:O(function(k){return Object(C.a)(Object(C.a)({},k),{},{data:pe.data})}),j.next=16;break;case 13:j.prev=13,j.t0=j.catch(2),O(function(k){return Object(C.a)(Object(C.a)({},k),{},{error:j.t0})});case 16:return j.prev=16,O(function(k){return Object(C.a)(Object(C.a)({},k),{},{loading:!1})}),j.finish(16);case 19:case"end":return j.stop()}},De,null,[[2,13,16,19]])})),[Qe]),He=Object(X.useCallback)(Object(c.a)(Object(f.a)().mark(function De(){var pe,ge,j,k,Re,Ie,We,je,Ue,Ke,Ve,Fe,ke,Ye,et,Ne,Je,_e,Xe;return Object(f.a)().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.prev=0,ce.next=3,Object($.a)();case 3:if(Ne=ce.sent,Ne.success){ce.next=6;break}return ce.abrupt("return");case 6:Je=Number((pe=Ne.data)===null||pe===void 0||(ge=pe.escolalms_competency_challenge)===null||ge===void 0||(j=ge.category)===null||j===void 0||(k=j.scale)===null||k===void 0||(Re=k.depth)===null||Re===void 0?void 0:Re.value),_e=Number((Ie=Ne.data)===null||Ie===void 0||(We=Ie.escolalms_competency_challenge)===null||We===void 0||(je=We.category)===null||je===void 0||(Ue=je.question)===null||Ue===void 0||(Ke=Ue.depth)===null||Ke===void 0?void 0:Ke.value),Xe=Number((Ve=Ne.data)===null||Ve===void 0||(Fe=Ve.escolalms_competency_challenge)===null||Fe===void 0||(ke=Fe.category)===null||ke===void 0||(Ye=ke.role)===null||Ye===void 0||(et=Ye.depth)===null||et===void 0?void 0:et.value),ne({scale:Number.isNaN(Je)?2:Je,question:Number.isNaN(_e)?1:_e,role:Number.isNaN(Xe)?0:Xe}),ce.next=15;break;case 12:ce.prev=12,ce.t0=ce.catch(0),console.error(ce.t0);case 15:case"end":return ce.stop()}},De,null,[[0,12]])})),[]);return Object(X.useEffect)(function(){we(),He()},[we,He]),Object(Me.jsx)(E.Provider,{value:{categoryDepths:d,competencyChallenge:y,refreshData:we},children:K})}},vtG9:function(qe,V,e){},yioT:function(qe,V,e){"use strict";e.d(V,"a",function(){return Pe});var C=e("miYZ"),J=e("tsqr"),f=e("+L6B"),c=e("2/Rp"),X=e("oBTY"),Se=e("bbsP"),me=e("/wGt"),N=e("qLMh"),$=e("9og8"),Me=e("PpiC"),F=e("tJVT"),S=e("k1fw"),E=e("q1tI"),s=e("9kvl"),A=e("YJCA"),g=e("wYyv"),W=e("smpX"),K=e("eyie"),ue=e("w5pM"),Z=e("4KAj"),y=e("mWMg"),O=e("DBJ/"),M=e("Vpfc"),Q=e("qRSf"),d=e("VMEa"),ne=e("rmhi"),r=e("yj/a"),t=e("nKUr"),Qe=function(a){var n=a.quiz_id,i=a.quizQuestions,o=a.visible,v=a.onVisibleChange,m=d.a.useForm(),p=Object(F.a)(m,1),u=p[0],P=Object(s.l)(),x=Object(E.useCallback)(function(){var H=Object($.a)(Object(N.a)().mark(function L(xe){var U,Le,Ee;return Object(N.a)().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return U=xe.ids,ie.prev=1,ie.next=4,Object(Q.c)({quiz_id:n,ids:U});case 4:Le=ie.sent,Le instanceof Blob&&(Ee=document.createElement("a"),Ee.href=window.URL.createObjectURL(Le),Ee.download="quiz_questions_".concat(n,".xlsx"),document.body.appendChild(Ee),Ee.click(),document.body.removeChild(Ee)),ie.next=11;break;case 8:ie.prev=8,ie.t0=ie.catch(1),console.error(ie.t0);case 11:return ie.prev=11,v(!1),ie.finish(11);case 14:case"end":return ie.stop()}},L,null,[[1,8,11,14]])}));return function(L){return H.apply(this,arguments)}}(),[n]),I=Object(E.useMemo)(function(){return i.map(function(H){var L=H.id,xe=H.value;try{var U=Object(W.parse)(xe);if(!(U!=null&&U[0])||!("stem"in U[0]))return{value:L,label:P.formatMessage({id:"ExportQuestions.questionTitle"},{id:L})};var Le=U[0].stem.text;return{value:L,label:Le}}catch(Ee){return console.error(Ee),{value:L,label:P.formatMessage({id:"ExportQuestions.questionTitle"},{id:L})}}})},[i]);return Object(t.jsx)(ne.a,{title:Object(t.jsx)(s.a,{id:"exportQuestions"}),form:u,visible:o,onVisibleChange:v,onFinish:x,children:Object(t.jsx)(r.a,{mode:"multiple",options:I,name:"ids",label:Object(t.jsx)(s.a,{id:"questions"}),required:!0,rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}]})})},we=e("DYRE"),He=e("zeV3"),De=e("/zsF"),pe=e("PArb"),ge=e("FJDo"),j=e("/y+f"),k=e("enqX"),Re=e("5Dmo"),Ie=e("3S7+"),We=e("jrin"),je=e("Qurx"),Ue=e("x1Ii"),Ke=e("tneF"),Ve=e("/MfK"),Fe,ke=(Fe={},Object(We.a)(Fe,j.e.MULTIPLE_CHOICE,[{isCorrect:!1,value:""},{isCorrect:!1,value:""}]),Object(We.a)(Fe,j.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS,[{value:"",weight:""},{value:"",weight:""}]),Fe),Ye=function(a){var n,i=a.type,o=Object(s.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(je.a,{name:"question",label:Object(t.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Ue.b,{name:"answers",creatorButtonProps:{creatorButtonText:o.formatMessage({id:"Questions.addAnswer"})},actionRender:function(){return[]},initialValue:(n=ke[i])!==null&&n!==void 0?n:[],children:function(m,p,u,P){return Object(t.jsxs)(d.a.Group,{title:Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(s.a,{id:"Questions.answer",values:{ordinalNumber:p+1}}),P>2&&Object(t.jsx)(Ie.a,{title:o.formatMessage({id:"Questions.deleteAnswer"}),children:Object(t.jsx)(c.a,{type:"text",icon:Object(t.jsx)(Ve.a,{}),onClick:function(){return u.remove(m.name)}})})]}),titleStyle:{width:"100%",display:"flex",justifyContent:"space-between"},children:[i===j.e.MULTIPLE_CHOICE&&Object(t.jsx)(Ke.a,{name:"isCorrect",label:Object(t.jsx)(s.a,{id:"Questions.correctAnswer",defaultMessage:"Is Correct Answer?"}),rules:[function(x){var I=x.getFieldValue;return{validator:function(){var L,xe=(L=I("answers"))!==null&&L!==void 0?L:[];return xe.filter(function(U){return U==null?void 0:U.isCorrect}).length>1?Promise.reject("Only one answer can be correct"):Promise.resolve()},message:Object(t.jsx)(s.a,{id:"Questions.onlyOneAnswerIsCorrect"})}}]}),Object(t.jsx)(je.a,{name:"value",rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],label:Object(t.jsx)(s.a,{id:"content",defaultMessage:"Content"})}),i===j.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS&&Object(t.jsx)(ge.a,{name:"weight",rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],fieldProps:{min:-Number.MAX_SAFE_INTEGER,addonAfter:"%"},label:Object(t.jsx)(s.a,{id:"weight",defaultMessage:"Weight"})})]})}})]})},et=function(){return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(je.a,{name:"question",label:Object(t.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Ke.a,{name:"isCorrect",label:Object(t.jsx)(s.a,{id:"Questions.correctAnswer"})})]})},Ne=[{value:""}],Je=function(){var a=Object(s.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(je.a,{name:"question",label:Object(t.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Ue.b,{name:"answers",creatorButtonProps:{creatorButtonText:a.formatMessage({id:"Questions.addAnswer"})},deleteIconProps:{tooltipText:a.formatMessage({id:"Questions.deleteAnswer"})},actionRender:function(i,o,v){var m=Object(F.a)(v,2),p=m[1];return[p]},min:1,initialValue:Ne,children:function(i,o){return Object(t.jsx)(je.a,{name:"value",rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],label:Object(t.jsx)(s.a,{id:"Questions.answer",values:{ordinalNumber:o+1},defaultMessage:"Answer ".concat(o+1)})})}})]})},_e=[{firstOfPair:"",secondOfPair:""}],Xe=function(){var a=Object(s.l)();return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(je.a,{name:"question",label:Object(t.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(Ue.b,{name:"answers",creatorButtonProps:{creatorButtonText:a.formatMessage({id:"Questions.addMatchingPair",defaultMessage:"Add Matching Pair"})},deleteIconProps:{tooltipText:a.formatMessage({id:"Questions.deletePair"})},actionRender:function(i,o,v){var m=Object(F.a)(v,2),p=m[1];return[p]},min:1,initialValue:_e,children:function(i,o){return Object(t.jsxs)(d.a.Group,{direction:"horizontal",align:"baseline",size:"small",spaceProps:{style:{flexWrap:"nowrap"}},title:Object(t.jsx)(s.a,{id:"Questions.pair",values:{ordinalNumber:o+1},defaultMessage:"Pair ".concat(o+1)}),children:[Object(t.jsx)(je.a,{name:"firstOfPair",rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}]}),Object(t.jsx)(je.a,{name:"secondOfPair",rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}]})]})}})]})},st=function(){return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(je.a,{name:"question",label:Object(t.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(ge.a,{name:"answer",label:Object(t.jsx)(s.a,{id:"answer"}),rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(ge.a,{name:"errorMargin",fieldProps:{addonAfter:"+/-"},label:Object(t.jsx)(s.a,{id:"Questions.errorMargin"}),rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],required:!0})]})},ce=e("BiO0"),it=function(){return Object(t.jsx)(ce.a,{name:"question",label:Object(t.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],required:!0})},ot=function(a){var n=a.type;if(!n)return null;switch(n){case j.e.MULTIPLE_CHOICE:case j.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return Object(t.jsx)(Ye,{type:n});case j.e.TRUE_FALSE:return Object(t.jsx)(et,{});case j.e.SHORT_ANSWERS:return Object(t.jsx)(Je,{});case j.e.MATCHING:return Object(t.jsx)(Xe,{});case j.e.NUMERICAL_QUESTION:return Object(t.jsx)(st,{});case j.e.ESSAY:case j.e.DESCRIPTION:return Object(t.jsx)(it,{})}return Object(t.jsxs)("pre",{children:["Unsupported type ",n]})},tt=e("rAM+"),ct=["question"],Ge=function(a){for(var n=["~","=","#","{","}",":"],i="",o=0;o<a.length;o++){var v=a[o];n.includes(v)?i+="\\".concat(v):i+=v}return i},ut=function(a){var n=a.question,i=a.answers;if(i.length===0)return"".concat(n,"{}");var o=i.map(function(H){var L=H.isCorrect,xe=H.value;return{isCorrect:L,value:Ge(xe)}}),v="".concat(n,"{"),m=Object(tt.a)(o),p;try{for(m.s();!(p=m.n()).done;){var u=p.value,P=u.isCorrect,x=u.value,I=P?"=":"~";v+="".concat(I).concat(x)}}catch(H){m.e(H)}finally{m.f()}return v+="}",v.trim()},ye=function(a){var n=a.question,i=a.answers;if(i.length==0)return"".concat(n,"{}");var o="".concat(n,"{"),v=i.map(function(I){var H=I.weight,L=I.value;return{weight:H,value:Ge(L)}}),m=Object(tt.a)(v),p;try{for(m.s();!(p=m.n()).done;){var u=p.value,P=u.value,x=u.weight;o+="~%".concat(x,"%").concat(P)}}catch(I){m.e(I)}finally{m.f()}return o+="}",o.trim()},z=function(a){var n=a.question,i=a.isCorrect;return"".concat(n,"{").concat(i?"T":"F","}")},b=function(a){var n=a.question,i=a.answers;if(i.length===0)return"".concat(n,"{}");var o="".concat(n,"{"),v=i.map(function(x){var I=x.value;return{value:Ge(I)}}),m=Object(tt.a)(v),p;try{for(m.s();!(p=m.n()).done;){var u=p.value,P=u.value;o+="=".concat(P)}}catch(x){m.e(x)}finally{m.f()}return o+="}",o.trim()},ee=function(a){var n=a.question,i=a.answers;if(i.length===0)return"".concat(n,"{}");var o="".concat(n,"{"),v=i.map(function(I){var H=I.firstOfPair,L=I.secondOfPair;return{firstOfPair:Ge(H),secondOfPair:Ge(L)}}),m=Object(tt.a)(v),p;try{for(m.s();!(p=m.n()).done;){var u=p.value,P=u.firstOfPair,x=u.secondOfPair;o+="=".concat(P,"->").concat(x)}}catch(I){m.e(I)}finally{m.f()}return o+="}",o.trim()},R=function(a){var n=a.question,i=a.answer,o=a.errorMargin;return"".concat(n,"{#").concat(i,":").concat(o,"}")},te=function(a){var n=a.question;return"".concat(n,"{}")},_=function(a){var n=a.question;return n},se=function(a){var n=a.question,i=Object(Me.a)(a,ct),o=Object(S.a)({question:Ge(n)},i);switch(o.type){case j.e.MULTIPLE_CHOICE:return ut(o);case j.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return ye(o);case j.e.TRUE_FALSE:return z(o);case j.e.SHORT_ANSWERS:return b(o);case j.e.MATCHING:return ee(o);case j.e.NUMERICAL_QUESTION:return R(o);case j.e.ESSAY:return te(o);case j.e.DESCRIPTION:return _(o);default:throw new Error("Unsupported type: ".concat(o.type))}},be=function(a,n){var i=n.type,o=n.score,v=n.category_id,m=a==null?void 0:a.stem.text,p=a.choices.every(function(x){var I=x.weight;return I===null});if(p){var u=a.choices.map(function(x){var I=x.isCorrect,H=x.text;return{isCorrect:I,value:H.text}});return{type:i,score:o,category_id:v,question:m,answers:u}}var P=a.choices.reduce(function(x,I){var H=I.weight,L=I.text;return H!==null?[].concat(Object(X.a)(x),[{weight:H,value:L.text}]):x},[]);return{type:i,score:o,category_id:v,question:m,answers:P}},Te=function(a,n){var i=n.type,o=n.score,v=n.category_id,m=a==null?void 0:a.stem.text,p=a.isTrue;return{type:i,score:o,category_id:v,question:m,isCorrect:p}},ae=function(a,n){var i=n.type,o=n.score,v=n.category_id,m=a==null?void 0:a.stem.text,p=a.choices.map(function(u){var P=u.text;return{value:P.text}});return{type:i,score:o,category_id:v,question:m,answers:p}},Oe=function(a,n){var i=n.type,o=n.score,v=n.category_id,m=a==null?void 0:a.stem.text,p=a.matchPairs.map(function(u){var P=u.subquestion,x=u.subanswer;return{firstOfPair:P.text,secondOfPair:x}});return{type:i,score:o,category_id:v,question:m,answers:p}},Ce=function(a,n){var i=n.type,o=n.score,v=n.category_id,m=a==null?void 0:a.stem.text;if(Array.isArray(a==null?void 0:a.choices))throw new Error("Unsupported choices type: array");var p=a==null?void 0:a.choices.number,u=a==null?void 0:a.choices.range;if(p===void 0||u===void 0)throw new Error("Value undefined - answer: ".concat(p," errorMargin: ").concat(u));return{type:i,score:o,category_id:v,question:m,answer:p,errorMargin:u}},fe=function(a,n){var i=n.type,o=n.score,v=n.category_id,m=a==null?void 0:a.stem.text;return{type:i,score:o,category_id:v,question:m}};function de(l){if(!!l)try{var a=Object(W.parse)(l.value),n=Object(F.a)(a,1),i=n[0];switch(i.type){case"MC":return be(i,l);case"TF":return Te(i,l);case"Short":return ae(i,l);case"Matching":return Oe(i,l);case"Numerical":return Ce(i,l);case"Description":case"Essay":return fe(i,l);default:throw new Error("Unsupported type: ".concat(i==null?void 0:i.type))}}catch(o){console.error(o);return}}var ze=["type","score","category"],D=Object.values(j.e).reduce(function(l,a){return a?[].concat(Object(X.a)(l),[{value:a,label:Object(t.jsx)(s.a,{id:"gift_type.".concat(a)})}]):l},[]),w=function(a){var n=a.onSubmit,i=a.values,o=a.competencyChallengeCategoryTreeProps,v=o===void 0?!1:o,m=Object(s.l)(),p=d.a.useForm(),u=Object(F.a)(p,1),P=u[0],x=d.a.useWatch("type",P),I=Object(E.useMemo)(function(){return de(i)},[i]),H=Object(E.useCallback)(function(){var L=Object($.a)(Object(N.a)().mark(function xe(U){var Le,Ee,at,ie;return Object(N.a)().wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return Le=se(U),Ee=U.score,at=U.category_id,$e.next=4,n({value:Le,score:Ee,category_id:at});case 4:if(ie=$e.sent,ie){$e.next=7;break}return $e.abrupt("return");case 7:P.resetFields();case 8:case"end":return $e.stop()}},xe)}));return function(xe){return L.apply(this,arguments)}}(),[]);return Object(E.useEffect)(function(){P.resetFields()},[I]),Object(E.useEffect)(function(){if(x){var L=P.getFieldsValue(),xe=Object.keys(L).filter(function(U){return!ze.includes(U)});P.resetFields(xe)}},[x]),Object(t.jsxs)(He.b,{direction:"vertical",style:{display:"flex"},children:[Object(t.jsx)(pe.a,{children:Object(t.jsx)(s.a,{id:I?"Questions.edit":"addNewQuestion"})}),Object(t.jsxs)(d.a,{layout:"horizontal",form:P,onFinish:H,initialValues:I,children:[Object(t.jsx)(r.a,{name:"type",placeholder:m.formatMessage({id:"selectNewQuestionType",defaultMessage:"Select new question type"}),label:Object(t.jsx)(s.a,{id:"type",defaultMessage:"Type:"}),options:D,rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(t.jsx)(ot,{type:x}),Object(t.jsx)(ge.a,{name:"score",label:Object(t.jsx)(s.a,{id:"Questions.score",defaultMessage:"Score"}),rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}]}),v&&Object(t.jsx)(d.a.Item,{name:"category_id",label:Object(t.jsx)(s.a,{id:"category",defaultMessage:"Category"}),rules:[{required:!0,message:Object(t.jsx)(s.a,{id:"field_required"})}],required:!0,children:Object(t.jsx)(k.a,Object(S.a)({},typeof v=="object"?v:{}))})]})]})},ve=e("60mZ"),Y=["className","style"],G=Object(A.c)(function(){return Object(t.jsx)(K.a,{style:{cursor:"grab",color:"#999"}})}),q=Object(A.b)(function(l){return Object(t.jsx)("tr",Object(S.a)({},l))}),re=Object(A.a)(function(l){return Object(t.jsx)("tbody",Object(S.a)({},l))}),B=[{title:Object(t.jsx)(s.a,{id:"sort",defaultMessage:"sort"}),dataIndex:"id",width:60,className:"drag-visible",render:function(){return Object(t.jsx)(G,{})}},{title:Object(t.jsx)(s.a,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,n){return Object(t.jsx)(s.a,{id:"gift_type.".concat(n.type)})}},{title:Object(t.jsx)(s.a,{id:"question",defaultMessage:"Question"}),dataIndex:"question",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,n){try{var i=Object(W.parse)(n.value);return i!=null&&i[0]&&"stem"in i[0]?i[0].stem.text:"question"}catch(o){return console.error(o),"question"}}}],T={title:Object(t.jsx)(s.a,{id:"category",defaultMessage:"Category"}),dataIndex:"category_id",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,n){return typeof n.category_id=="number"?Object(t.jsx)(M.a,{type:"Category",type_id:n.category_id}):"-"}},Pe=function(a){var n=a.questions,i=a.onAdded,o=a.onRemoved,v=a.onEdited,m=a.quizId,p=a.tableLoading,u=a.tableHeader,P=a.questionsCategory,x=a.customToolbarElements,I=x===void 0?[]:x,H=Object(E.useState)(!1),L=Object(F.a)(H,2),xe=L[0],U=L[1],Le=Object(E.useState)(!1),Ee=Object(F.a)(Le,2),at=Ee[0],ie=Ee[1],dt=Object(E.useState)(),$e=Object(F.a)(dt,2),Be=$e[0],lt=$e[1],Ot=Object(E.useState)(!1),mt=Object(F.a)(Ot,2),ft=mt[0],jt=mt[1],ht=Object(E.useState)(n),vt=Object(F.a)(ht,2),nt=vt[0],bt=vt[1],pt=Object(s.l)(),gt=Object(E.useRef)();Object(E.useEffect)(function(){var he;(he=gt.current)===null||he===void 0||he.reload(),bt(n)},[n]);var yt=function(oe){var le=oe.oldIndex,Ae=oe.newIndex;if(le!==Ae){var Ze=Object(g.a)(nt.slice(),le,Ae).filter(Boolean).map(function(h,rt){return Object(S.a)(Object(S.a)({},h),{},{order:rt})});Ze.forEach(function(h,rt){h.id!==nt[rt].id&&Object(Q.h)(h.id,Object(S.a)(Object(S.a)({},h),{},{order:rt+1,topic_gift_quiz_id:m}))}),bt(Ze)}},Ct=function(oe){return Object(t.jsx)(re,Object(S.a)({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:yt},oe))},xt=function(oe){var le=oe.className,Ae=oe.style,Ze=Object(Me.a)(oe,Y),h=nt.findIndex(function(rt){return rt.id===Ze["data-row-key"]});return Object(t.jsx)(q,Object(S.a)({index:h},Ze))},Et=Object(E.useCallback)(function(){var he=Object($.a)(Object(N.a)().mark(function oe(le){var Ae;return Object(N.a)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.prev=0,U(!0),h.next=4,Object(Q.a)(Object(S.a)({topic_gift_quiz_id:m},le));case 4:return Ae=h.sent,ie(!1),i==null||i(),h.abrupt("return",Ae.success);case 10:return h.prev=10,h.t0=h.catch(0),console.log(h.t0),h.abrupt("return",!1);case 14:return h.prev=14,U(!1),h.finish(14);case 17:case"end":return h.stop()}},oe,null,[[0,10,14,17]])}));return function(oe){return he.apply(this,arguments)}}(),[at,m]),Mt=Object(E.useCallback)(function(){var he=Object($.a)(Object(N.a)().mark(function oe(le){var Ae;return Object(N.a)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if((Be==null?void 0:Be.id)!==void 0){h.next=2;break}return h.abrupt("return",!1);case 2:return h.prev=2,U(!0),h.next=6,Object(Q.h)(Be.id,Object(S.a)({topic_gift_quiz_id:m},le));case 6:return Ae=h.sent,lt(void 0),v==null||v(),h.abrupt("return",Ae.success);case 12:return h.prev=12,h.t0=h.catch(2),console.log(h.t0),h.abrupt("return",!1);case 16:return h.prev=16,U(!1),h.finish(16);case 19:case"end":return h.stop()}},oe,null,[[2,12,16,19]])}));return function(oe){return he.apply(this,arguments)}}(),[Be==null?void 0:Be.id,m]);return Object(t.jsxs)(t.Fragment,{children:[Object(t.jsx)(me.a,{open:at,onClose:function(){return ie(!1)},children:Object(t.jsx)(w,{onSubmit:Et,competencyChallengeCategoryTreeProps:P})}),Object(t.jsx)(me.a,{open:!!Be,onClose:function(){return lt(void 0)},children:Object(t.jsx)(w,{onSubmit:Mt,competencyChallengeCategoryTreeProps:P,values:Be})}),Object(t.jsx)(Qe,{quiz_id:m,quizQuestions:nt,visible:ft,onVisibleChange:jt}),Object(t.jsx)(y.a,{search:!1,cardProps:{bodyStyle:{padding:0}},loading:p,headerTitle:u,toolbar:{settings:[]},toolBarRender:function(){return[Object(t.jsxs)(c.a,{icon:Object(t.jsx)(ue.a,{}),type:"primary",onClick:function(){return ie(!0)},children:[" ",Object(t.jsx)(s.a,{id:"addNewQuestion",defaultMessage:"Add new question"})]},"add"),Object(t.jsx)(O.a,{title:pt.formatMessage({id:"importQuestions"}),hideLabel:!0,showUploadList:!1,url:"/api/admin/gift-questions/import",name:"file",accept:".xlsx",data:{topic_gift_quiz_id:m},onChange:function(le){le.file.status==="done"&&le.file.response&&le.file.response.success&&(J.b.success(le.file.response.message),i==null||i()),le.file.response&&le.file.status==="error"&&(J.b.error(le.file.response.message),console.error(le.file.response))}},"import"),Object(t.jsxs)(c.a,{icon:Object(t.jsx)(Z.a,{}),type:"primary",onClick:function(){return jt(!0)},children:[" ",Object(t.jsx)(s.a,{id:"exportQuestions"})]},"export")].concat(Object(X.a)(I))},columns:[].concat(B,Object(X.a)(P?[T]:[]),[{title:Object(t.jsx)(s.a,{id:"actions",defaultMessage:"Actions"}),dataIndex:"address",valueType:"option",render:function(oe,le){return[Object(t.jsx)(c.a,{size:"small",type:"primary",onClick:function(){lt(le)},children:Object(t.jsx)(s.a,{id:"Questions.edit",defaultMessage:"Edit Question"})},"edit"),Object(t.jsx)(c.a,{loading:xe,size:"small",danger:!0,onClick:function(){U(!0),Object(Q.b)(le.id).then(function(){o&&o()}).finally(function(){U(!1)})},children:Object(t.jsx)(s.a,{id:"Questions.delete",defaultMessage:"Delete Question"})},"delete")]}}]),rowKey:function(oe){return oe.id},pagination:!1,dataSource:nt,components:{body:{wrapper:Ct,row:xt}}})]})}}}]);

//# sourceMappingURL=p__CompetencyChallenges__form.766ad639.async.js.map