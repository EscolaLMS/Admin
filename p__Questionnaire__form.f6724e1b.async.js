"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7480,2803,8047],{78677:function(Ce,k,t){var ee=t(67294),q=t(2759),J=function(){return J=Object.assign||function(Y){for(var u,R=1,S=arguments.length;R<S;R++){u=arguments[R];for(var z in u)Object.prototype.hasOwnProperty.call(u,z)&&(Y[z]=u[z])}return Y},J.apply(this,arguments)},H=(0,ee.forwardRef)(function(Y,u){return ee.createElement(q.P,J({},Y,{chartType:"Column",ref:u}))});k.Z=H},58664:function(Ce,k,t){t.d(k,{T:function(){return $}});var ee=t(19632),q=t.n(ee),J=t(5574),H=t.n(J),Y=t(74656),u=t(74330),R=t(67294),S=t(51490),z=t(99100),G=t(32283),pe=t(80854),Z=t(85893),ce=function(w){return w.map(function(_){return"name"in _?{id:Number(_.id),name:_.name}:{id:Number(_.id),name:_.title?_.title:""}})},$=function(w){var _=w.value,te=w.onChange,se=w.multiple,me=se===void 0?!1:se,Me=w.defaultValue,ne=w.modelType,K=ne===void 0?"COURSE":ne,U=(0,R.useState)([]),ie=H()(U,2),ae=ie[0],m=ie[1],a=(0,R.useState)(!1),fe=H()(a,2),je=fe[0],oe=fe[1],p=(0,R.useRef)(),xe=(0,R.useCallback)(function(g){var E,D,L,X;switch(K){case"COURSE":return(0,z.N7)(g,{signal:p==null||(E=p.current)===null||E===void 0?void 0:E.signal});case"WEBINAR":return(0,G.i5)(g,{signal:p==null||(D=p.current)===null||D===void 0?void 0:D.signal});case"CONSULTATIONS":return(0,S.sL)(g,{signal:p==null||(L=p.current)===null||L===void 0?void 0:L.signal});default:return(0,z.N7)(g,{signal:p==null||(X=p.current)===null||X===void 0?void 0:X.signal})}},[K,p]),ve=(0,R.useCallback)(function(g){var E,D,L,X;switch(K){case"COURSE":return(0,z.XR)(Number(g),{signal:(E=p.current)===null||E===void 0?void 0:E.signal});case"WEBINAR":return(0,G.tz)(Number(g),{signal:(D=p.current)===null||D===void 0?void 0:D.signal});case"CONSULTATIONS":return(0,S.hW)(Number(g),{signal:(L=p.current)===null||L===void 0?void 0:L.signal});default:return(0,z.XR)(Number(g),{signal:(X=p.current)===null||X===void 0?void 0:X.signal})}},[K,p]),ue=(0,R.useCallback)(function(g){oe(!0),p.current&&p.current.abort(),p.current=new AbortController,xe(g?{title:g}:{}).then(function(E){E.success&&m(ce(E.data)),oe(!1)}).catch(function(){return oe(!1)})},[K]),e=(0,R.useCallback)(function(g){ue(g)},[ue]);return(0,R.useEffect)(function(){return p.current=new AbortController,_&&ve(Number(_)).then(function(g){g&&g.success&&m(function(E){return[].concat(q()(E),q()(ce([g.data])))})}),function(){p.current&&p.current.abort()}},[_,K]),(0,Z.jsx)(Y.default,{defaultValue:Me,onFocus:function(){return ue()},allowClear:!0,style:{width:"100%"},value:_,onChange:te,mode:me?"multiple":void 0,showSearch:!0,onSearch:e,placeholder:(0,Z.jsx)(pe.FormattedMessage,{id:"select_content",defaultMessage:"select_content"}),optionFilterProp:"children",filterOption:function(E,D){if(D&&D.children){var L;return(D==null||(L=D.children)===null||L===void 0?void 0:L.toString().toLowerCase().indexOf(E.toLowerCase()))>=0}return!0},notFoundContent:je?(0,Z.jsx)(u.Z,{size:"small"}):null,optionLabelProp:"label",children:ae.map(function(g){return(0,Z.jsx)(Y.default.Option,{value:g.id,label:g.name,children:g.name},g.id)})})}},92008:function(Ce,k,t){t.r(k),t.d(k,{QuestionareForm:function(){return Ie},default:function(){return ke}});var ee=t(19632),q=t.n(ee),J=t(9783),H=t.n(J),Y=t(97857),u=t.n(Y),R=t(15009),S=t.n(R),z=t(99289),G=t.n(z),pe=t(5574),Z=t.n(pe),ce=t(58664),$=t(95020),B=t(78715),w=t(952),_=t(5966),te=t(52688),se=t(64317),me=t(31199),Me=t(74453),ne=t(71471),K=t(75842),U=t(2453),ie=t(74330),ae=t(14726),m=t(67294),a=t(80854),fe=t(13769),je=t.n(fe),oe=t(62235),p=t(44167),xe=t(45919),ve=t(16894),ue=t(60943),e=t(85893),g=["type"],E=function(C){var l=C.record,y=K.Z.useForm(),F=Z()(y,1),x=F[0],f=(0,a.useIntl)(),Q=(0,m.useMemo)(function(){return{onValuesChange:function(h,d){var b=d,n=b.visible_on_front;(0,$.lt)(l.id,{visible_on_front:n}).then(function(N){U.ZP.success((0,e.jsx)(a.FormattedMessage,{id:"question_answer_visibility_changed",defaultMessage:N.message}))}).catch(function(){return U.ZP.error((0,e.jsx)(a.FormattedMessage,{id:"error",defaultMessage:"error"}))})},submitter:{render:function(){return null}}}},[]);return(0,e.jsx)(w.ZP,u()(u()({form:x},Q),{},{children:(0,e.jsx)(te.Z,{name:"visible_on_front",initialValue:l.visible_on_front,checkedChildren:f.formatMessage({id:"visible",defaultMessage:"visible"}),unCheckedChildren:f.formatMessage({id:"hidden",defaultMessage:"hidden"})})}))},D=function(C){var l=C.questionnaireId,y=C.questions,F=(0,m.useMemo)(function(){return y&&y.reduce(function(I,h){return u()(u()({},I),{},H()({},h.id,h.title))},{})},[y]),x=[{title:(0,e.jsx)(a.FormattedMessage,{id:"questions",defaultMessage:"questions"}),dataIndex:"question_id",hideInSearch:!1,valueEnum:F,valueType:"select"}],f=(0,a.useIntl)(),Q=[{title:(0,e.jsx)(a.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,e.jsx)(a.FormattedMessage,{id:"updated_at",defaultMessage:"updated_at"}),dataIndex:"updated_at",hideInSearch:!0,render:function(h,d){return d.updated_at?new Date(d.updated_at).toLocaleString():"-"},sorter:!0},{title:(0,e.jsx)(a.FormattedMessage,{id:"updated_at",defaultMessage:"updated_at"}),dataIndex:"date",hideInSearch:!1,hideInForm:!0,hideInTable:!0,valueType:"date",fieldProps:{allowEmpty:[!0]}},{title:(0,e.jsx)(a.FormattedMessage,{id:"title",defaultMessage:"title"}),dataIndex:"question_title",hideInSearch:!0,sorter:!0},{title:(0,e.jsx)(a.FormattedMessage,{id:"note",defaultMessage:"note"}),dataIndex:"note",hideInSearch:!0,sorter:!0,render:function(h,d){var b,n;return d.note&&((b=d.note)===null||b===void 0?void 0:b.length)>64?((n=d.note)===null||n===void 0?void 0:n.slice(0,64))+"...":d.note}},{title:(0,e.jsx)(a.FormattedMessage,{id:"user",defaultMessage:"user"}),dataIndex:"user_id",hideInSearch:!1,render:function(h,d){var b,n;return(0,e.jsxs)("div",{children:[(0,e.jsx)(oe.Z,{type:"App\\Models\\User",type_id:d.user_id}),(0,e.jsx)("p",{className:"list-paragraph",children:(b=d.user)===null||b===void 0?void 0:b.name}),(0,e.jsx)("p",{className:"list-paragraph",children:(n=d.user)===null||n===void 0?void 0:n.email})]})},renderFormItem:function(h,d,b){var n=d.type,N=je()(d,g);if(n==="form")return null;var M=b.getFieldValue("state");return(0,e.jsx)(p.Z,u()(u()({},N),{},{state:{type:M}}))}},{title:(0,e.jsx)(a.FormattedMessage,{id:"sum_rate",defaultMessage:"sum_rate"}),dataIndex:"rate",hideInSearch:!0,sorter:!0},{title:(0,e.jsx)(a.FormattedMessage,{id:"show_hide_on_front",defaultMessage:"show_hide_on_front"}),dataIndex:"visible_on_front",hideInSearch:!0,sorter:!1,render:function(h,d){return(0,e.jsx)(E,{record:d})}}];return(0,e.jsx)(ve.ZP,{headerTitle:f.formatMessage({id:"answers",defaultMessage:"answers"}),search:{layout:"vertical"},rowKey:"id",request:function(h,d){var b=h.pageSize,n=h.current,N=h.question_id,M=h.user_id,r=h.date,j=d&&Object.entries(d)[0];return(0,$.l)(l,{per_page:b,page:n,question_id:N,user_id:M,updated_at:r?(0,ue.WU)(new Date(r),xe.Cu):void 0,order_by:j&&j[0],order:j?j[1]==="ascend"?"ASC":"DESC":void 0}).then(function(s){return s.success?{data:s.data,success:!0}:[]})},columns:[].concat(Q,x)})},L=D,X=t(66419),$e=t(51042),Ve=t(47389),we=t(82061),ye=t(83062),Le=t(86738),ge=t(31472),Ue=t(37476),Qe=function(C){var l=(0,a.useIntl)(),y=C.visible,F=C.onVisibleChange,x=C.onFinish,f=C.id,Q=C.questionsList,I=K.Z.useForm(),h=Z()(I,1),d=h[0];(0,m.useEffect)(function(){typeof f=="number"&&f>0?(0,$.a5)(f).then(function(n){n.success&&d.setFieldsValue(n.data)}):d.resetFields()},[f,d]);var b=Object.values(ge.Yo).map(function(n){return{name:n,label:l.formatMessage({id:"QuestionType.".concat(n)}),value:n,disabled:n===ge.Yo.Review&&Q.findIndex(function(N){var M=N.type;return M===ge.Yo.Review})!==-1}});return(0,e.jsxs)(Ue.Y,{form:d,title:l.formatMessage({id:typeof f=="number"&&f>0?"question_edit":"question_add",defaultMessage:typeof f=="number"&&f>0?"question_edit":"question_add"}),width:"400px",visible:y,onVisibleChange:F,onFinish:x,children:[(0,e.jsx)(se.Z,{name:"type",options:b,label:(0,e.jsx)(a.FormattedMessage,{id:"type"}),initialValue:ge.Yo.Rate}),(0,e.jsx)(_.Z,{width:"lg",name:"title",label:(0,e.jsx)(a.FormattedMessage,{id:"title"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"title"}),placeholder:l.formatMessage({id:"title"})}),(0,e.jsx)(_.Z,{width:"lg",name:"description",label:(0,e.jsx)(a.FormattedMessage,{id:"description"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"description"}),placeholder:l.formatMessage({id:"description"})}),(0,e.jsx)(me.Z,{width:"lg",name:"position",label:(0,e.jsx)(a.FormattedMessage,{id:"position"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"position"}),placeholder:l.formatMessage({id:"position",defaultMessage:"position"}),min:0,max:9999,fieldProps:{step:1}}),(0,e.jsx)(te.Z,{initialValue:!0,name:"active",label:(0,e.jsx)(a.FormattedMessage,{id:"is_active",defaultMessage:"is_active"})}),(0,e.jsx)(te.Z,{initialValue:!0,name:"public_answers",label:(0,e.jsx)(a.FormattedMessage,{id:"show_hide_on_front",defaultMessage:"show_hide_on_front"})})]})},We=Qe,Be=function(C){var l=C.questionnaireId,y=C.questions,F=C.fetchData,x=(0,a.useIntl)(),f=(0,m.useState)(!1),Q=Z()(f,2),I=Q[0],h=Q[1],d=(0,m.useMemo)(function(){return[{title:(0,e.jsx)(a.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,e.jsx)(a.FormattedMessage,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!1,sorter:!0},{title:(0,e.jsx)(a.FormattedMessage,{id:"type",defaultMessage:"type"}),dataIndex:"type",hideInSearch:!0,sorter:!0,renderText:function(r,j){return x.formatMessage({id:"QuestionType.".concat(j.type)})}},{title:(0,e.jsx)(a.FormattedMessage,{id:"description",defaultMessage:"description"}),dataIndex:"description",hideInSearch:!0,sorter:!0},{title:(0,e.jsx)(a.FormattedMessage,{id:"position",defaultMessage:"position"}),dataIndex:"position",hideInSearch:!0,sorter:!0}]},[]),b=(0,m.useRef)(),n=function(){var M=G()(S()().mark(function r(j,s){var W;return S()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return W=U.ZP.loading(x.formatMessage({id:"loading"})),T.prev=1,T.next=4,s&&s!==-1?(0,$.WW)(s,u()(u()({},j),{},{questionnaire_id:l})):(0,$.xL)(u()(u()({},j),{},{questionnaire_id:l}));case 4:return W(),F(),U.ZP.success(x.formatMessage({id:"success"})),T.abrupt("return",!0);case 10:return T.prev=10,T.t0=T.catch(1),W(),U.ZP.error(x.formatMessage({id:"error"})),T.abrupt("return",!1);case 15:case"end":return T.stop()}},r,null,[[1,10]])}));return function(j,s){return M.apply(this,arguments)}}(),N=(0,m.useCallback)(function(){var M=G()(S()().mark(function r(j){var s;return S()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return s=U.ZP.loading(x.formatMessage({id:"loading"})),P.prev=1,P.next=4,(0,$.Km)(j);case 4:return s(),F(),P.abrupt("return",!0);case 9:return P.prev=9,P.t0=P.catch(1),s(),U.ZP.error((0,e.jsx)(a.FormattedMessage,{id:"error",defaultMessage:"error"})),P.abrupt("return",!1);case 14:case"end":return P.stop()}},r,null,[[1,9]])}));return function(r){return M.apply(this,arguments)}}(),[b,x]);return(0,m.useEffect)(function(){var M;(M=b.current)===null||M===void 0||M.reload()},[y,F]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ve.ZP,{headerTitle:x.formatMessage({id:"question_list",defaultMessage:"question_list"}),actionRef:b,rowKey:"id",search:{layout:"vertical"},toolBarRender:function(){return[(0,e.jsxs)(ae.ZP,{type:"primary",onClick:function(){h(-1)},children:[(0,e.jsx)($e.Z,{})," ",(0,e.jsx)(a.FormattedMessage,{id:"pages.searchTable.new",defaultMessage:"\u65B0\u5EFA"})]},"primary")]},columns:[].concat(q()(d),[{title:(0,e.jsx)(a.FormattedMessage,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",render:function(r,j){return[(0,e.jsx)(ye.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,e.jsx)(ae.ZP,{type:"primary",icon:(0,e.jsx)(Ve.Z,{}),onClick:function(){return j.id&&h(j.id)}})},"edit"),(0,e.jsx)(Le.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:function(){return j.id&&N(j.id)},okText:(0,e.jsx)(a.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(a.FormattedMessage,{id:"no"}),children:(0,e.jsx)(ye.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(ae.ZP,{type:"primary",icon:(0,e.jsx)(we.Z,{}),danger:!0})})},"delete")]}}]),request:function(r,j){var s=r.title,W=j&&Object.entries(j)[0];return new Promise(function(P){var T=y?q()(y):[];s&&(T=T.filter(function(be){return be.title.toLowerCase().includes(s.toLowerCase())})),W&&(T=(0,X.Pf)(T,W[0],W[1]!=="ascend")),P({data:T,success:!0,total:T.length})})}}),(0,e.jsx)(We,{id:I,visible:Number.isInteger(I),onVisibleChange:function(r){return r===!1&&h(!1)},questionsList:y!=null?y:[],onFinish:function(){var M=G()(S()().mark(function r(j){var s;return S()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,n(j,Number(I));case 2:s=P.sent,s&&h(!1);case 4:case"end":return P.stop()}},r)}));return function(r){return M.apply(this,arguments)}}()})]})},Ke=Be,Pe=t(74656),qe=t(78677),ze=t(38925),Ge={isGroup:!0,xField:"label",yField:"value",seriesField:"type",marginRatio:0},Ye=function(C){var l=C.state,y=(0,a.useIntl)();return(0,e.jsxs)(B.ZP,{headerBordered:!0,style:{height:"500px"},children:[l.mode==="loading"&&(0,e.jsx)(ie.Z,{}),l.mode==="loaded"&&l.value.length>0?(0,e.jsx)(qe.Z,u()(u()({},Ge),{},{data:[].concat(q()(l.value),q()(l.value)).map(function(F,x){return{label:F.title,value:x>l.value.length-1?F.count_answers:Number(F.avg_rate),type:x>l.value.length-1?y.formatMessage({id:"answers"}):"Rating"}})})):l.mode!=="loading"&&(0,e.jsx)("p",{children:(0,e.jsx)(a.FormattedMessage,{id:"no_data",defaultMessage:"no_data"})}),l.mode==="error"&&(0,e.jsx)(ze.Z,{message:l.error.data.message,type:"error"})]})},Xe=Ye,He=function(C){var l=C.questionnaireId,y=C.models,F=(0,m.useState)(""),x=Z()(F,2),f=x[0],Q=x[1],I=(0,m.useState)({mode:"init"}),h=Z()(I,2),d=h[0],b=h[1];return(0,m.useEffect)(function(){b({mode:"loading"});var n=function(){var N=G()(S()().mark(function M(){var r;return S()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,!f){s.next=7;break}return s.next=4,(0,$.Cq)(l,Number(f.split("/")[0]),Number(f.split("/")[1]));case 4:s.t0=s.sent,s.next=10;break;case 7:return s.next=9,(0,$.Cq)(l);case 9:s.t0=s.sent;case 10:r=s.t0,r.success&&b({mode:"loaded",value:r.data}),s.next=17;break;case 14:s.prev=14,s.t1=s.catch(0),b({mode:"error",error:s.t1});case 17:case"end":return s.stop()}},M,null,[[0,14]])}));return function(){return N.apply(this,arguments)}}();n()},[l,y,f]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ne.Z.Title,{level:5,children:(0,e.jsx)(a.FormattedMessage,{id:"questionnaire.raports.filter",defaultMessage:"questionnaire.raports.filter"})}),(0,e.jsx)(Pe.default,{allowClear:!0,style:{minWidth:"400px"},onChange:function(N){return Q(N)},children:y.map(function(n){return(0,e.jsxs)(Pe.default.Option,{value:"".concat(n.model_type_id,"/").concat(n.model_id),children:[(0,e.jsx)(a.FormattedMessage,{id:n.model_type_title,defaultMessage:n.model_type_title})," ","- ",n.model_title]},n.id)})}),(0,e.jsx)(B.ZP,{split:"vertical",children:(0,e.jsx)(B.ZP,{colSpan:24,layout:"center",children:(0,e.jsx)(Xe,{state:d})})})]})},Je=He,Se=ne.Z.Title,Ie=function(){var C,l,y=(0,a.useParams)(),F=y.questionnaireId,x=(0,a.useIntl)(),f=F==="new",Q=K.Z.useForm(),I=Z()(Q,1),h=I[0],d=K.Z.useForm(),b=Z()(d,1),n=b[0],N=(0,m.useState)(),M=Z()(N,2),r=M[0],j=M[1],s=(0,m.useState)("questionnaire"),W=Z()(s,2),P=W[0],T=W[1],be=(0,m.useState)(),Te=Z()(be,2),Ze=Te[0],et=Te[1],tt=(0,m.useState)({}),Ee=Z()(tt,2),le=Ee[0],Oe=Ee[1],at=(0,m.useState)({}),Ae=Z()(at,2),_e=Ae[0],rt=Ae[1],De=(0,m.useCallback)(G()(S()().mark(function i(){var o;return S()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,$.xR)();case 2:o=c.sent,o.success&&et(o.data);case 4:case"end":return c.stop()}},i)})),[]),Ne=(0,m.useCallback)(function(i,o){return i.reduce(function(v,c){return(v[c[o]]=v[c[o]]||[]).push(c.model_id),v},{})},[]),de=(0,m.useCallback)(G()(S()().mark(function i(){var o;return S()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,$.Iu)(Number(F));case 2:o=c.sent,o.success&&(j(u()({},o.data)),o.data.models&&Oe(Ne(o.data.models,"model_type_id")));case 4:case"end":return c.stop()}},i)})),[F,Ne]);(0,m.useEffect)(function(){if(De(),f){j({title:"new"});return}de()},[F,de,De,f]);var st=(0,m.useCallback)(function(i,o){Oe(function(v){return u()(u()({},v),{},H()({},o,i))})},[]),Fe=(0,m.useCallback)(function(i){var o=[];return Object.keys(i).map(function(v){o.push.apply(o,q()(i[v].map(function(c){return{model_id:Number(c),model_type_id:Number(v),target_group:n.getFieldValue("models.".concat(Number(v),".").concat(Number(c),".target_group")),display_frequency_minutes:n.getFieldValue("models.".concat(Number(v),".").concat(Number(c),".display_frequency_minutes"))}})))}),o},[n]),nt=(0,m.useMemo)(function(){return{onFinish:function(){var i=G()(S()().mark(function v(c){var V,O;return S()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(A.prev=0,!f){A.next=9;break}return A.next=4,(0,$.wW)(u()(u()({},c),{},{models:Fe(le)}));case 4:V=A.sent,V.success&&a.history.push("/other/questionnaire/".concat(V.data.id)),U.ZP.success((0,e.jsx)(a.FormattedMessage,{id:"success",defaultMessage:"success"})),A.next=14;break;case 9:return A.next=11,(0,$.xN)(Number(r==null?void 0:r.id),u()(u()({},c),{},{models:Fe(le)}));case 11:O=A.sent,O.success&&de(),U.ZP.success((0,e.jsx)(a.FormattedMessage,{id:"success",defaultMessage:"success"}));case 14:A.next=19;break;case 16:A.prev=16,A.t0=A.catch(0),U.ZP.error((0,e.jsx)(a.FormattedMessage,{id:"error",defaultMessage:"error"}));case 19:case"end":return A.stop()}},v,null,[[0,16]])}));function o(v){return i.apply(this,arguments)}return o}(),initialValues:r}},[r,le,de,Fe,f]),Re=(0,m.useCallback)(function(i){var o;return r&&((o=r.models)===null||o===void 0?void 0:o.filter(function(v){return v.model_type_title===i}))},[r]),it=(0,m.useCallback)(function(i,o,v,c){var V;return((V=Re(o))===null||V===void 0||(V=V.find(function(O){return O.model_id===Number(i)}))===null||V===void 0?void 0:V.model_title)||_e[c][v]},[Re,_e]),ot=(0,m.useMemo)(function(){var i;return r==null||(i=r.models)===null||i===void 0?void 0:i.reduce(function(o,v){var c="models.".concat(v.model_type_id,".").concat(v.model_id);return o["".concat(c,".target_group")]=v.target_group,o["".concat(c,".display_frequency_minutes")]=v.display_frequency_minutes,o},{})},[r==null?void 0:r.models]);if(!r)return(0,e.jsx)(ie.Z,{});var ut=[{label:(0,e.jsx)(a.FormattedMessage,{id:"author"}),value:"author"},{label:(0,e.jsx)(a.FormattedMessage,{id:"users"}),value:"user"}];return(0,e.jsx)(Me._z,{title:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.FormattedMessage,{id:r!=null&&r.title?"questionnaire":"new_questionnaire"})}),header:{breadcrumb:{routes:[{path:"other/questionnaire",breadcrumbName:x.formatMessage({id:"menu.Other activities.Questionnaire"})},{path:String(F),breadcrumbName:x.formatMessage({id:"form"})},{path:"/",breadcrumbName:String(r==null?void 0:r.title)}]}},children:(0,e.jsxs)(B.ZP,{tabs:{type:"card",defaultActiveKey:"questionnaire",activeKey:P,onChange:function(o){return T(o)}},children:[(0,e.jsxs)(B.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"questionnaire",defaultMessage:"questionnaire"}),children:[(0,e.jsx)(Se,{level:3,children:(0,e.jsx)(a.FormattedMessage,{id:"questionnaire",defaultMessage:"questionnaire"})}),(0,e.jsx)(w.ZP,u()(u()({},nt),{},{form:h,children:(0,e.jsxs)(w.ZP.Group,{children:[(0,e.jsx)(_.Z,{label:(0,e.jsx)(a.FormattedMessage,{id:"title",defaultMessage:"title"}),rules:[{required:!0}],width:"md",name:"title"}),(0,e.jsx)(te.Z,{width:"md",initialValue:!0,name:"active",label:(0,e.jsx)(a.FormattedMessage,{id:"is_active",defaultMessage:"is_active"})})," "]})}))]},"questionnaire"),(0,e.jsx)(B.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"questions",defaultMessage:"questions"}),disabled:f,children:(0,e.jsx)(Ke,{questionnaireId:Number(F),questions:r.questions||[],fetchData:de})},"questions"),(0,e.jsx)(B.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"answers",defaultMessage:"answers"}),disabled:f,children:(0,e.jsx)(L,{questionnaireId:Number(F),questions:r.questions||[]})},"answers"),Ze&&Ze.map(function(i){var o,v,c,V;return(0,e.jsxs)(B.ZP.TabPane,{tab:"".concat(x.formatMessage({id:"assign"})," ").concat(x.formatMessage({id:"to"})," ").concat(x.formatMessage({id:(o=i.title)===null||o===void 0?void 0:o.replace(i.title.charAt(0),i.title.charAt(0).toUpperCase())})),disabled:f,children:[(0,e.jsx)(ce.T,{defaultValue:((v=r.models)===null||v===void 0?void 0:v.filter(function(O){return O.model_type_title===i.title}).map(function(O){return{value:O.model_id,label:O.model_title}}))||[],multiple:!0,onChange:function(he,A){return[st(he,i.id),rt(function(lt){return u()(u()({},lt),{},H()({},i.id,A.map(function(dt){return dt.label})))})]},modelType:(c=i.title)===null||c===void 0?void 0:c.toUpperCase()}),(0,e.jsx)(w.ZP,{form:n,submitter:!1,initialValues:ot,style:{marginTop:"20px"},children:le[i.id]&&((V=le[i.id])===null||V===void 0?void 0:V.map(function(O,he){return(0,e.jsxs)("div",{children:[(0,e.jsx)(Se,{level:5,children:it(Number(O),i.title,he,i.id)}),(0,e.jsxs)(w.ZP.Group,{children:[(0,e.jsx)(se.Z,{width:"md",name:"models.".concat(i.id,".").concat(O,".target_group"),label:(0,e.jsx)(a.FormattedMessage,{id:"target_group",defaultMessage:"target_group"}),initialValue:"user",options:ut}),(0,e.jsx)(me.Z,{width:"md",name:"models.".concat(i.id,".").concat(O,".display_frequency_minutes"),label:(0,e.jsx)(a.FormattedMessage,{id:"display_frequency_minutes",defaultMessage:"display_frequency_minutes"})})]})]},String(O))}))}),(0,e.jsx)(ae.ZP,{className:"submit-btn",type:"primary",onClick:function(){return h.submit()},children:(0,e.jsx)(a.FormattedMessage,{id:"questionnaire.submit",defaultMessage:"questionnaire.submit"})})]},String(i.id))}),(0,e.jsx)(B.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"menu.reports",defaultMessage:"menu.reports"}),disabled:f||((C=r.models)===null||C===void 0?void 0:C.length)===0,children:(r==null?void 0:r.models)&&(r==null||(l=r.models)===null||l===void 0?void 0:l.length)>0&&(0,e.jsx)(Je,{questionnaireId:Number(F),models:r.models})},"raport")]})})},ke=Ie}}]);
