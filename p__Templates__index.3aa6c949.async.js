"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4519],{82061:function(X,P,t){var l=t(1413),m=t(67294),M=t(47046),r=t(84089),x=function(S,O){return m.createElement(r.Z,(0,l.Z)((0,l.Z)({},S),{},{ref:O,icon:M.Z}))},C=m.forwardRef(x);P.Z=C},47389:function(X,P,t){var l=t(1413),m=t(67294),M=t(27363),r=t(84089),x=function(S,O){return m.createElement(r.Z,(0,l.Z)((0,l.Z)({},S),{},{ref:O,icon:M.Z}))},C=m.forwardRef(x);P.Z=C},51042:function(X,P,t){var l=t(1413),m=t(67294),M=t(42110),r=t(84089),x=function(S,O){return m.createElement(r.Z,(0,l.Z)((0,l.Z)({},S),{},{ref:O,icon:M.Z}))},C=m.forwardRef(x);P.Z=C},16894:function(X,P,t){var l=t(72717);P.ZP=l.Z},27226:function(X,P,t){t.r(P),t.d(P,{channelType:function(){return u},default:function(){return h}});var l=t(26271),m=t(74453),M=t(67294),r=t(80854),x=function(){var e,i=(0,r.useModel)("@@initialState"),d=i.initialState,a=(d==null||(e=d.currentUser)===null||e===void 0?void 0:e.roles)||[],o=(0,M.useCallback)(function(E){var p,b=d==null||(p=d.config)===null||p===void 0||(p=p.find(function(g){return g.key===E}))===null||p===void 0?void 0:p.data;return Array.isArray(a)&&Array.isArray(b)?a.every(function(g){return b.includes(g)}):typeof b=="boolean"?b:!1},[]);return{checkRoles:o}},C=t(15009),_=t.n(C),S=t(99289),O=t.n(S),J=t(5574),z=t.n(J),Y=t(45919),R=t(40658),k=t(51042),B=t(47389),w=t(82061),W=t(16894),V=t(66309),K=t(2453),N=t(14726),U=t(83062),q=t(86738),H=t(60943),n=t(85893),A=function(e){var i=e.templateType,d=e.channel,a=(0,M.useRef)(),o=(0,r.useIntl)(),E=(0,M.useState)(!1),p=z()(E,2),b=p[0],g=p[1],G=[{title:(0,n.jsx)(r.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,n.jsx)(r.FormattedMessage,{id:"created_at",defaultMessage:"created_at"}),dataIndex:"created_at",hideInSearch:!0,sorter:!0,render:function(T,v){return v.created_at&&(0,H.WU)(new Date(v.created_at),Y.Cu)}},{title:(0,n.jsx)(r.FormattedMessage,{id:"name",defaultMessage:"name"}),dataIndex:"name",hideInSearch:!1,sorter:!0},{title:(0,n.jsx)(r.FormattedMessage,{id:"event",defaultMessage:"event"}),dataIndex:"event",hideInSearch:!0,sorter:!1,render:function(T,v){return(0,n.jsx)(r.FormattedMessage,{id:v.event,defaultMessage:v.event})}},{title:(0,n.jsx)(r.FormattedMessage,{id:"templates.is_default"}),dataIndex:"default",hideInSearch:!0,valueEnum:{true:(0,n.jsx)(V.Z,{color:"success",children:(0,n.jsx)(r.FormattedMessage,{id:"yes"})}),false:(0,n.jsx)(V.Z,{color:"error",children:(0,n.jsx)(r.FormattedMessage,{id:"no"})})}}],I=(0,M.useCallback)(function(){var $=O()(_()().mark(function T(v){var Z,L;return _()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return g(!0),Z=K.ZP.loading((0,n.jsx)(r.FormattedMessage,{id:"loading",defaultMessage:"loading"})),y.prev=2,y.next=5,(0,R.Xc)(v).then(function(F){g(!1),F.success&&K.ZP.success(F.message)});case 5:return Z(),g(!1),(L=a.current)===null||L===void 0||L.reload(),y.abrupt("return",!0);case 11:return y.prev=11,y.t0=y.catch(2),Z(),K.ZP.error((0,n.jsx)(r.FormattedMessage,{id:"error",defaultMessage:"error"})),g(!1),y.abrupt("return",!1);case 17:case"end":return y.stop()}},T,null,[[2,11]])}));return function(T){return $.apply(this,arguments)}}(),[a]);return(0,n.jsx)(W.ZP,{headerTitle:o.formatMessage({id:"templates",defaultMessage:"templates"}),loading:b,actionRef:a,rowKey:"id",search:{layout:"vertical"},toolBarRender:function(){return[(0,n.jsx)(r.Link,{to:"/configuration/templates/".concat(i,"/new"),children:(0,n.jsxs)(N.ZP,{type:"primary",children:[(0,n.jsx)(k.Z,{})," ",(0,n.jsx)(r.FormattedMessage,{id:"new",defaultMessage:"new"})]},"primary")},"new")]},request:function(T,v){var Z=T.pageSize,L=T.current,j=T.name;g(!0);var y=v&&Object.entries(v)[0];return(0,R.zd)({per_page:Z,page:L,channel:d,name:j||void 0,order_by:y&&y[0],order:y?y[1]==="ascend"?"ASC":"DESC":void 0}).then(function(F){return F.success?(g(!1),{data:F.data,total:F.meta.total,success:!0}):[]})},columns:[].concat(G,[{hideInSearch:!0,title:(0,n.jsx)(r.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"option"}),dataIndex:"option",valueType:"option",render:function(T,v){return[(0,n.jsx)(r.Link,{to:"/configuration/templates/".concat(i,"/").concat(v.id),children:(0,n.jsx)(U.Z,{title:(0,n.jsx)(r.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,n.jsx)(N.ZP,{type:"primary",icon:(0,n.jsx)(B.Z,{})})})},"edit"),(0,n.jsx)(q.Z,{title:(0,n.jsx)(r.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:function(){return I(v.id)},okText:(0,n.jsx)(r.FormattedMessage,{id:"yes"}),cancelText:(0,n.jsx)(r.FormattedMessage,{id:"no"}),children:(0,n.jsx)(U.Z,{title:(0,n.jsx)(r.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,n.jsx)(N.ZP,{type:"primary",icon:(0,n.jsx)(w.Z,{}),danger:!0})})},"delete")]}}])})},c=A,u=function(s){return s.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",s.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",s.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel",s}({}),f=function(){var e=(0,r.useParams)(),i=e.template,d=(0,r.useAccess)(),a=x(),o=a.checkRoles,E=o("hideTemplateTab-sms"),p=o("hideTemplateTab-email");return(0,n.jsx)(m._z,{children:(0,n.jsxs)(l.ZP,{tabs:{type:"card",activeKey:i,onChange:function(g){return r.history.push("/configuration/templates/".concat(g))}},children:[!p&&(0,n.jsx)(l.ZP.TabPane,{tab:(0,n.jsx)(r.FormattedMessage,{id:"email"}),children:(0,n.jsx)(c,{templateType:"email",channel:u.email})},"email"),d.certificatesPermission&&(0,n.jsx)(l.ZP.TabPane,{tab:(0,n.jsx)(r.FormattedMessage,{id:"PDF"}),children:(0,n.jsx)(c,{templateType:"pdf",channel:u.pdf})},"pdf"),!E&&(0,n.jsx)(l.ZP.TabPane,{tab:(0,n.jsx)("span",{children:(0,n.jsx)(r.FormattedMessage,{id:"SMS"})}),children:(0,n.jsx)(c,{templateType:"sms",channel:u.sms})},"sms")]})})},h=f},40658:function(X,P,t){t.d(P,{MZ:function(){return q},Mn:function(){return Y},QB:function(){return k},RN:function(){return N},Rl:function(){return V},XK:function(){return J},Xc:function(){return w},zB:function(){return n},zd:function(){return S}});var l=t(15009),m=t.n(l),M=t(97857),r=t.n(M),x=t(99289),C=t.n(x),_=t(80854);function S(c,u){return O.apply(this,arguments)}function O(){return O=C()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,_.request)("/api/admin/templates",r()({method:"GET",useCache:!1,params:u},f||{})));case 1:case"end":return s.stop()}},c)})),O.apply(this,arguments)}function J(c,u){return z.apply(this,arguments)}function z(){return z=C()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,_.request)("/api/admin/templates/".concat(u),r()({method:"GET"},f||{})));case 1:case"end":return s.stop()}},c)})),z.apply(this,arguments)}function Y(c,u){return R.apply(this,arguments)}function R(){return R=C()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,_.request)("/api/admin/templates",r()({method:"POST",headers:{"Content-Type":"application/json"},data:u},f||{})));case 1:case"end":return s.stop()}},c)})),R.apply(this,arguments)}function k(c,u,f){return B.apply(this,arguments)}function B(){return B=C()(m()().mark(function c(u,f,h){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/admin/templates/".concat(u),r()({method:"PATCH",headers:{"Content-Type":"application/json"},data:f},h||{})));case 1:case"end":return e.stop()}},c)})),B.apply(this,arguments)}function w(c,u){return W.apply(this,arguments)}function W(){return W=C()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,_.request)("/api/admin/templates/".concat(u),r()({method:"DELETE",headers:{"Content-Type":"application/json"}},f||{})));case 1:case"end":return s.stop()}},c)})),W.apply(this,arguments)}function V(c){return K.apply(this,arguments)}function K(){return K=C()(m()().mark(function c(u){return m()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,_.request)("/api/admin/templates/variables",r()({method:"GET"},u||{})));case 1:case"end":return h.stop()}},c)})),K.apply(this,arguments)}function N(c,u){return U.apply(this,arguments)}function U(){return U=C()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,_.request)("/api/admin/templates/".concat(u,"/preview"),r()({method:"GET"},f||{})));case 1:case"end":return s.stop()}},c)})),U.apply(this,arguments)}function q(c,u,f){return H.apply(this,arguments)}function H(){return H=C()(m()().mark(function c(u,f,h){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/admin/events/trigger-manually/".concat(u),r()({method:"POST",headers:{"Content-Type":"application/json"},data:{users:f}},h||{})));case 1:case"end":return e.stop()}},c)})),H.apply(this,arguments)}function n(c,u,f){return A.apply(this,arguments)}function A(){return A=C()(m()().mark(function c(u,f,h){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,_.request)("/api/admin/products/".concat(f,"/trigger-event-manually/").concat(u),r()({method:"POST",headers:{"Content-Type":"application/json"}},h||{})));case 1:case"end":return e.stop()}},c)})),A.apply(this,arguments)}},66309:function(X,P,t){t.d(P,{Z:function(){return s}});var l=t(67294),m=t(62208),M=t(93967),r=t.n(M),x=t(98787),C=t(69760),_=t(45353),S=t(53124),O=t(6731),J=t(10274),z=t(14747),Y=t(45503),R=t(91945);const k=e=>{const{paddingXXS:i,lineWidth:d,tagPaddingHorizontal:a,componentCls:o,calc:E}=e,p=E(a).sub(d).equal(),b=E(i).sub(d).equal();return{[o]:Object.assign(Object.assign({},(0,z.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:p,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,O.unit)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${o}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${o}-close-icon`]:{marginInlineStart:b,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${o}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},["&-checkable"]:{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${o}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},["&-hidden"]:{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:p}}),[`${o}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},B=e=>{const{lineWidth:i,fontSizeIcon:d,calc:a}=e,o=e.fontSizeSM;return(0,Y.TS)(e,{tagFontSize:o,tagLineHeight:(0,O.unit)(a(e.lineHeightSM).mul(o).equal()),tagIconSize:a(d).sub(a(i).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},w=e=>({defaultBg:new J.C(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var W=(0,R.I$)("Tag",e=>{const i=B(e);return k(i)},w),V=function(e,i){var d={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&i.indexOf(a)<0&&(d[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)i.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(d[a[o]]=e[a[o]]);return d},N=l.forwardRef((e,i)=>{const{prefixCls:d,style:a,className:o,checked:E,onChange:p,onClick:b}=e,g=V(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:G,tag:I}=l.useContext(S.E_),$=y=>{p==null||p(!E),b==null||b(y)},T=G("tag",d),[v,Z,L]=W(T),j=r()(T,`${T}-checkable`,{[`${T}-checkable-checked`]:E},I==null?void 0:I.className,o,Z,L);return v(l.createElement("span",Object.assign({},g,{ref:i,style:Object.assign(Object.assign({},a),I==null?void 0:I.style),className:j,onClick:$})))}),U=t(98719);const q=e=>(0,U.Z)(e,(i,d)=>{let{textColor:a,lightBorderColor:o,lightColor:E,darkColor:p}=d;return{[`${e.componentCls}${e.componentCls}-${i}`]:{color:a,background:E,borderColor:o,"&-inverse":{color:e.colorTextLightSolid,background:p,borderColor:p},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}});var H=(0,R.bk)(["Tag","preset"],e=>{const i=B(e);return q(i)},w);function n(e){return typeof e!="string"?e:e.charAt(0).toUpperCase()+e.slice(1)}const A=(e,i,d)=>{const a=n(d);return{[`${e.componentCls}${e.componentCls}-${i}`]:{color:e[`color${d}`],background:e[`color${a}Bg`],borderColor:e[`color${a}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var c=(0,R.bk)(["Tag","status"],e=>{const i=B(e);return[A(i,"success","Success"),A(i,"processing","Info"),A(i,"error","Error"),A(i,"warning","Warning")]},w),u=function(e,i){var d={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&i.indexOf(a)<0&&(d[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)i.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(d[a[o]]=e[a[o]]);return d};const f=(e,i)=>{const{prefixCls:d,className:a,rootClassName:o,style:E,children:p,icon:b,color:g,onClose:G,closeIcon:I,closable:$,bordered:T=!0}=e,v=u(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","closeIcon","closable","bordered"]),{getPrefixCls:Z,direction:L,tag:j}=l.useContext(S.E_),[y,F]=l.useState(!0);l.useEffect(()=>{"visible"in v&&F(v.visible)},[v.visible]);const te=(0,x.o2)(g),ne=(0,x.yT)(g),ee=te||ne,oe=Object.assign(Object.assign({backgroundColor:g&&!ee?g:void 0},j==null?void 0:j.style),E),D=Z("tag",d),[le,ie,ce]=W(D),ue=r()(D,j==null?void 0:j.className,{[`${D}-${g}`]:ee,[`${D}-has-color`]:g&&!ee,[`${D}-hidden`]:!y,[`${D}-rtl`]:L==="rtl",[`${D}-borderless`]:!T},a,o,ie,ce),re=Q=>{Q.stopPropagation(),G==null||G(Q),!Q.defaultPrevented&&F(!1)},[,de]=(0,C.Z)({closable:$,closeIcon:I!=null?I:j==null?void 0:j.closeIcon,customCloseIconRender:Q=>Q===null?l.createElement(m.Z,{className:`${D}-close-icon`,onClick:re}):l.createElement("span",{className:`${D}-close-icon`,onClick:re},Q),defaultCloseIcon:null,defaultClosable:!1}),me=typeof v.onClick=="function"||p&&p.type==="a",ae=b||null,pe=ae?l.createElement(l.Fragment,null,ae,p&&l.createElement("span",null,p)):p,se=l.createElement("span",Object.assign({},v,{ref:i,className:ue,style:oe}),pe,de,te&&l.createElement(H,{key:"preset",prefixCls:D}),ne&&l.createElement(c,{key:"status",prefixCls:D}));return le(me?l.createElement(_.Z,{component:"Tag"},se):se)},h=l.forwardRef(f);h.CheckableTag=N;var s=h}}]);
