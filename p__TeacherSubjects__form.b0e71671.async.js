(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"/y+f":function(Ke,oe,t){"use strict";t.d(oe,"f",function(){return c}),t.d(oe,"d",function(){return f}),t.d(oe,"e",function(){return P}),t.d(oe,"c",function(){return je}),t.d(oe,"a",function(){return a}),t.d(oe,"b",function(){return Ie});var c;(function(l){l.Unselected="",l.RichText="EscolaLms\\TopicTypes\\Models\\TopicContent\\RichText",l.OEmbed="EscolaLms\\TopicTypes\\Models\\TopicContent\\OEmbed",l.Audio="EscolaLms\\TopicTypes\\Models\\TopicContent\\Audio",l.Video="EscolaLms\\TopicTypes\\Models\\TopicContent\\Video",l.H5P="EscolaLms\\TopicTypes\\Models\\TopicContent\\H5P",l.Image="EscolaLms\\TopicTypes\\Models\\TopicContent\\Image",l.PDF="EscolaLms\\TopicTypes\\Models\\TopicContent\\PDF",l.SCORM="EscolaLms\\TopicTypes\\Models\\TopicContent\\ScormSco",l.Project="EscolaLms\\TopicTypeProject\\Models\\Project",l.GiftQuiz="EscolaLms\\TopicTypeGift\\Models\\GiftQuiz"})(c||(c={}));var F;(function(l){l.OrderPaid="EscolaLms\\Cart\\Events\\OrderPaid",l.UserLogged="EscolaLms\\Auth\\Events\\UserLogged"})(F||(F={}));var $;(function(l){l.draft="draft",l.published="published",l.archived="archived"})($||($={}));var f;(function(l){l.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",l.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",l.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel"})(f||(f={}));var P;(function(l){l.ManuallyTriggeredEvent="EscolaLms\\Templates\\Events\\ManuallyTriggeredEvent"})(P||(P={}));var u;(function(l){l.cart_fixed="cart_fixed",l.cart_percent="cart_percent",l.product_fixed="product_fixed",l.product_percent="product_percent"})(u||(u={}));var je;(function(l){l.MULTIPLE_CHOICE="multiple_choice",l.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS="multiple_choice_with_multiple_right_answers",l.TRUE_FALSE="true_false",l.SHORT_ANSWERS="short_answers",l.MATCHING="matching",l.NUMERICAL_QUESTION="numerical_question",l.ESSAY="essay",l.DESCRIPTION="description"})(je||(je={}));var a;(function(l){l.PRESENT="present",l.ABSENT="absent"})(a||(a={}));var Ie;(function(l){l.Manual="manual",l.TeamsForms="teams_forms",l.TeamsLecture="teams_lecture",l.TestPortal="test_portal"})(Ie||(Ie={}))},"0JQy":function(Ke,oe){var t="\\ud800-\\udfff",c="\\u0300-\\u036f",F="\\ufe20-\\ufe2f",$="\\u20d0-\\u20ff",f=c+F+$,P="\\ufe0e\\ufe0f",u="["+t+"]",je="["+f+"]",a="\\ud83c[\\udffb-\\udfff]",Ie="(?:"+je+"|"+a+")",l="[^"+t+"]",se="(?:\\ud83c[\\udde6-\\uddff]){2}",me="[\\ud800-\\udbff][\\udc00-\\udfff]",ge="\\u200d",q=Ie+"?",_e="["+P+"]?",Xe="(?:"+ge+"(?:"+[l,se,me].join("|")+")"+_e+q+")*",pe=_e+q+Xe,Ne="(?:"+[l+je+"?",je,se,me,u].join("|")+")",We=RegExp(a+"(?="+a+")|"+Ne+pe,"g");function h(O){return O.match(We)||[]}Ke.exports=h},"5R/X":function(Ke,oe,t){},"5Syx":function(Ke,oe,t){"use strict";t.d(oe,"c",function(){return we}),t.d(oe,"b",function(){return dt}),t.d(oe,"a",function(){return ae});var c=t("OaEy"),F=t("2fM7"),$=t("g9YV"),f=t("wCAj"),P=t("BoS7"),u=t("Sdc0"),je=t("jrin"),a=t("k1fw"),Ie=t("DYRE"),l=t("zeV3"),se=t("+BJd"),me=t("mr32"),ge=t("oBTY"),q=t("tJVT"),_e=t("q1tI"),Xe=t.n(_e),pe=t("9kvl"),Ne=t("Vpfc"),We=t("jsgi"),h=t("nhC9"),O=t("nKUr"),ze=t.n(O),ke=function(J){return J.topicable.content.contents?Object.values(J.topicable.content.contents)[0].library:"H5P"},we=function(J){var m=J.topics,Z=J.stats,xe=Object(_e.useState)(!1),E=Object(q.a)(xe,2),j=E[0],Ee=E[1],ye=Object(_e.useMemo)(function(){return[{title:Object(O.jsx)(pe.a,{id:"user"}),dataIndex:"id",render:function(Re){return Object(O.jsx)(Ne.a,{type:"App\\Models\\User",type_id:Re})}},{title:Object(O.jsx)(pe.a,{id:"email"}),dataIndex:"email"}].concat(Object(ge.a)(m.map(function(Te){var Re,Le=(Re=Te.topicable_type)===null||Re===void 0?void 0:Re.split("\\").pop();return Le==="H5P"&&(Le=ke(Te)),{render:function(N){var Ge=0,$e=0;switch(N&&(N.started_at&&N.finished_at?Ge=1:N.started_at&&(Ge=2),$e=N.seconds/60),Ge){case 1:return Object(O.jsxs)(l.b,{children:[Object(O.jsx)(me.a,{color:"success",children:"F"}),j&&Object(O.jsxs)("small",{children:[$e.toFixed(2),"m"]})]});case 2:return Object(O.jsxs)(l.b,{children:[Object(O.jsx)(me.a,{color:"blue",children:"S"}),j&&Object(O.jsxs)("small",{children:[$e.toFixed(2),"m"]})]});case 0:default:return Object(O.jsx)(Xe.a.Fragment,{children:Object(O.jsx)(me.a,{color:"error",children:"N"})})}},title:Object(O.jsxs)("small",{children:[Object(O.jsx)(me.a,{children:Le})," ",Te.title]}),dataIndex:Te.id}})))},[m,j]),Ce=Object(_e.useMemo)(function(){return Z.map(function(Te){return m.reduce(function(Re,Le){var ce=Te.topics.find(function(N){return N.id===Le.id});return Object(a.a)(Object(a.a)({},Re),{},Object(je.a)({},Number(Le.id),ce!=null?ce:0))},{email:Te.email,id:Te.id})})},[Z,m]);return Object(O.jsx)(f.a,{title:function(){return Object(O.jsxs)(l.b,{children:[Object(O.jsx)(pe.a,{id:"Finished",defaultMessage:"Finished:"})," ",Object(O.jsx)(me.a,{color:"success",children:"F"}),Object(O.jsx)(pe.a,{id:"Started",defaultMessage:"Started:"})," ",Object(O.jsx)(me.a,{color:"blue",children:"S"}),Object(O.jsx)(pe.a,{id:"NotStarted",defaultMessage:"Not Started:"})," ",Object(O.jsx)(me.a,{color:"error",children:"N"}),Object(O.jsx)(pe.a,{id:"ShowMinutes",defaultMessage:"Show minutes spent on topic:"})," ",Object(O.jsx)(u.a,{checked:j,onChange:function(Le){return Ee(Le)}})]})},columns:ye,dataSource:Ce,size:"small",scroll:{x:1500}})},dt=function(J){var m=J.stats,Z=Object(_e.useMemo)(function(){return[{title:"user",dataIndex:"id",render:function(j){return Object(O.jsx)(Ne.a,{type:"App\\Models\\User",type_id:j})}},{title:"email",dataIndex:"email"},{title:Object(O.jsx)(pe.a,{id:"finished_at",defaultMessage:"Finished at"}),dataIndex:"finished_at"}]},[]),xe=Object(_e.useMemo)(function(){return m.map(function(E){var j=E.id,Ee=E.email,ye=E.finished_at;return{id:j,email:Ee,finished_at:ye}})},[m]);return Object(O.jsx)(f.a,{title:function(){return Object(O.jsx)(l.b,{children:Object(O.jsx)(pe.a,{id:"course.finished",defaultMessage:"Finished"})})},columns:Z,dataSource:xe,size:"small",scroll:{x:500}})},ae=function(J){var m=J.stats,Z=Object(_e.useState)(null),xe=Object(q.a)(Z,2),E=xe[0],j=xe[1],Ee=Object(_e.useState)(null),ye=Object(q.a)(Ee,2),Ce=ye[0],Te=ye[1],Re=Object(_e.useMemo)(function(){return m.flatMap(function(ce){return Object.values(ce.attempts).flatMap(function(N){var Ge=N.dates,$e=N.attempt,w=Object.values(Ge).flatMap(function(it){var Qe=it.date,qe=it.seconds_total;return{date:Qe,attempt:$e,seconds_total:qe,email:ce.email}});return w})})},[m]),Le={xField:"date",yField:"seconds_total",seriesField:"attempt",isStack:!0,xAxis:{label:{autoHide:!0,autoRotate:!1}},slider:{start:0,end:1},label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]}};return Object(O.jsx)(h.a,{colSpan:12,layout:"center",children:Object(O.jsx)(We.a,{config:Le,title:Object(O.jsxs)(l.b,{children:[Object(O.jsx)(pe.a,{id:"course.interactions_in_days"}),Object(O.jsx)(F.a,{showSearch:!0,value:E,onChange:function(N){j(N),Te(null)},placeholder:Object(O.jsx)(pe.a,{id:"select_person",defaultMessage:"Select a person"}),children:m.map(function(ce){var N=ce.id,Ge=ce.email;return Object(O.jsx)(F.a.Option,{value:Ge,children:Ge},N)})}),Object(O.jsx)(F.a,{value:Ce,onChange:function(N){return Te(N)},disabled:E===null,placeholder:Object(O.jsx)(pe.a,{id:"select_attempt",defaultMessage:"Select attempt"}),children:Object(ge.a)(new Set(Re.filter(function(ce){var N=ce.email;return N===E}).map(function(ce){var N=ce.attempt;return N}))).map(function(ce){return Object(O.jsxs)(F.a.Option,{value:ce,children:[Object(O.jsx)(pe.a,{id:"attempt",defaultMessage:"Attempt"})," ",ce]},ce)})})]}),value:Re.filter(function(ce){var N=ce.email;return N===E}).filter(function(ce){var N=ce.attempt;return Number.isInteger(Ce)?N===Ce:!0})})})}},Em2t:function(Ke,oe,t){var c=t("bahg"),F=t("quyA"),$=t("0JQy");function f(P){return F(P)?$(P):c(P)}Ke.exports=f},Hn4i:function(Ke,oe,t){"use strict";var c=t("y8nQ"),F=t("Vl3Y"),$=t("+L6B"),f=t("2/Rp"),P=t("rePB"),u=t("ODXe"),je=t("Ff2n"),a=t("x+uP"),Ie=t("HaE+"),l=t("VTBJ"),se=t("nKUr"),me=t.n(se),ge=t("xvlK"),q=t("WuYN"),_e=t("VMEa"),Xe=t("LQCs"),pe=t("ft2k"),Ne=t("uX+g"),We=t("+i8S"),h=t("ipCM"),O=t("6cGi"),ze=t("ub+h"),ke=t("bG1m"),we=t("q1tI"),dt=t.n(we),ae=t("mWMg"),k=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],J=["record","position","creatorButtonText","newRecordType","parentKey","style"],m=dt.a.createContext(void 0);function Z(j){var Ee=j.children,ye=j.record,Ce=j.position,Te=j.newRecordType,Re=j.parentKey,Le=Object(we.useContext)(m);return dt.a.cloneElement(Ee,Object(l.a)(Object(l.a)({},Ee.props),{},{onClick:function(){var ce=Object(Ie.a)(Object(a.a)().mark(function Ge($e){var w,it,Qe,qe;return Object(a.a)().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return ie.next=2,(w=(it=Ee.props).onClick)===null||w===void 0?void 0:w.call(it,$e);case 2:if(qe=ie.sent,qe!==!1){ie.next=5;break}return ie.abrupt("return");case 5:Le==null||(Qe=Le.current)===null||Qe===void 0||Qe.addEditRecord(ye,{position:Ce,newRecordType:Te,parentKey:Re});case 6:case"end":return ie.stop()}},Ge)}));function N(Ge){return ce.apply(this,arguments)}return N}()}))}function xe(j){var Ee,ye,Ce=Object(Xe.d)(),Te=j.onTableChange,Re=j.maxLength,Le=j.formItemProps,ce=j.recordCreatorProps,N=j.rowKey,Ge=j.controlled,$e=j.defaultValue,w=j.onChange,it=j.editableFormRef,Qe=Object(je.a)(j,k),qe=Object(pe.a)(j.value),He=Object(we.useRef)(),ie=Object(we.useRef)();Object(we.useImperativeHandle)(Qe.actionRef,function(){return He.current});var Ot=Object(O.a)(function(){return j.value||$e||[]},{value:j.value,onChange:j.onChange}),ft=Object(u.a)(Ot,2),z=ft[0],xt=ft[1],et=dt.a.useMemo(function(){return typeof N=="function"?N:function(be,ee){return be[N]||ee}},[N]),vt=function(ee){if(typeof ee=="number"&&!j.name){if(ee>=z.length)return ee;var ne=z&&z[ee];return et==null?void 0:et(ne,ee)}if((typeof ee=="string"||ee>=z.length)&&j.name){var fe=z.findIndex(function(Q,Pe){var De;return(et==null||(De=et(Q,Pe))===null||De===void 0?void 0:De.toString())===(ee==null?void 0:ee.toString())});return fe}return ee};Object(we.useImperativeHandle)(it,function(){var be=function(fe){var Q,Pe;if(fe==null)throw new Error("rowIndex is required");var De=vt(fe),rt=[j.name,(Q=De==null?void 0:De.toString())!==null&&Q!==void 0?Q:""].flat(1).filter(Boolean);return(Pe=ie.current)===null||Pe===void 0?void 0:Pe.getFieldValue(rt)},ee=function(){var fe,Q=[j.name].flat(1).filter(Boolean);if(Array.isArray(Q)&&Q.length===0){var Pe,De=(Pe=ie.current)===null||Pe===void 0?void 0:Pe.getFieldsValue();return Array.isArray(De)?De:Object.keys(De).map(function(rt){return De[rt]})}return(fe=ie.current)===null||fe===void 0?void 0:fe.getFieldValue(Q)};return Object(l.a)(Object(l.a)({},ie.current),{},{getRowData:be,getRowsData:ee,setRowData:function(fe,Q){var Pe,De,rt,mt;if(fe==null)throw new Error("rowIndex is required");var ht=vt(fe),gt=[j.name,(Pe=ht==null?void 0:ht.toString())!==null&&Pe!==void 0?Pe:""].flat(1).filter(Boolean),pt=((De=ie.current)===null||De===void 0||(rt=De.getFieldsValue)===null||rt===void 0?void 0:rt.call(De))||{},_t=Object(ke.a)(pt,gt,Object(l.a)(Object(l.a)({},be(fe)),Q||{}));return(mt=ie.current)===null||mt===void 0?void 0:mt.setFieldsValue(_t)}})}),Object(we.useEffect)(function(){!j.controlled||z.forEach(function(be,ee){var ne;(ne=ie.current)===null||ne===void 0||ne.setFieldsValue(Object(P.a)({},et(be,ee),be))},{})},[z,j.controlled]),Object(we.useEffect)(function(){if(j.name){var be;ie.current=j==null||(be=j.editable)===null||be===void 0?void 0:be.form}},[(Ee=j.editable)===null||Ee===void 0?void 0:Ee.form,j.name]);var Ve=ce||{},Ye=Ve.record,bt=Ve.position,e=Ve.creatorButtonText,R=Ve.newRecordType,S=Ve.parentKey,g=Ve.style,p=Object(je.a)(Ve,J),U=bt==="top",K=Object(we.useMemo)(function(){return Re&&Re<=(z==null?void 0:z.length)?!1:ce!==!1&&Object(se.jsx)(Z,{record:Object(Ne.a)(Ye,z==null?void 0:z.length,z)||{},position:bt,parentKey:Object(Ne.a)(S,z==null?void 0:z.length,z),newRecordType:R,children:Object(se.jsx)(f.a,Object(l.a)(Object(l.a)({type:"dashed",style:Object(l.a)({display:"block",margin:"10px 0",width:"100%"},g),icon:Object(se.jsx)(ge.a,{})},p),{},{children:e||Ce.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[ce,Re,z==null?void 0:z.length]),Me=Object(we.useMemo)(function(){return K?U?{components:{header:{wrapper:function(ee){var ne,fe=ee.className,Q=ee.children;return Object(se.jsxs)("thead",{className:fe,children:[Q,Object(se.jsxs)("tr",{style:{position:"relative"},children:[Object(se.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:K}),Object(se.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(ne=Qe.columns)===null||ne===void 0?void 0:ne.length,children:K})]})]})}}}}:{tableViewRender:function(ee,ne){var fe,Q;return Object(se.jsxs)(se.Fragment,{children:[(fe=(Q=j.tableViewRender)===null||Q===void 0?void 0:Q.call(j,ee,ne))!==null&&fe!==void 0?fe:ne,K]})}}:{}},[U,K]),ut=Object(l.a)({},j.editable),Ze=Object(We.a)(function(be,ee){var ne,fe,Q;if((ne=j.editable)===null||ne===void 0||(fe=ne.onValuesChange)===null||fe===void 0||fe.call(ne,be,ee),(Q=j.onValuesChange)===null||Q===void 0||Q.call(j,ee,be),j.controlled){var Pe;j==null||(Pe=j.onChange)===null||Pe===void 0||Pe.call(j,ee)}});return((j==null?void 0:j.onValuesChange)||((ye=j.editable)===null||ye===void 0?void 0:ye.onValuesChange)||j.controlled&&(j==null?void 0:j.onChange))&&(ut.onValuesChange=Ze),Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(m.Provider,{value:He,children:Object(se.jsx)(ae.a,Object(l.a)(Object(l.a)(Object(l.a)({search:!1,options:!1,pagination:!1,rowKey:N,revalidateOnFocus:!1},Qe),Me),{},{tableLayout:"fixed",actionRef:He,onChange:Te,editable:Object(l.a)(Object(l.a)({},ut),{},{formProps:Object(l.a)({formRef:ie},ut.formProps)}),dataSource:z,onDataSourceChange:function(ee){if(xt(ee),j.name&&bt==="top"){var ne,fe=Object(ke.a)({},[j.name].flat(1).filter(Boolean),ee);(ne=ie.current)===null||ne===void 0||ne.setFieldsValue(fe)}}}))}),j.name?Object(se.jsx)(q.a,{name:[j.name],children:function(ee){var ne,fe,Q=Object(ze.a)(ee,[j.name].flat(1)),Pe=Q==null?void 0:Q.find(function(De,rt){return!Object(h.a)(De,qe==null?void 0:qe[rt])});return Pe&&qe&&(j==null||(ne=j.editable)===null||ne===void 0||(fe=ne.onValuesChange)===null||fe===void 0||fe.call(ne,Pe,Q)),null}}):null]})}function E(j){var Ee=_e.a.useFormInstance();return j.name?Object(se.jsx)(F.a.Item,Object(l.a)(Object(l.a)({style:{maxWidth:"100%"}},j==null?void 0:j.formItemProps),{},{name:j.name,children:Object(se.jsx)(xe,Object(l.a)(Object(l.a)({},j),{},{editable:Object(l.a)(Object(l.a)({},j.editable),{},{form:Ee})}))})):Object(se.jsx)(xe,Object(l.a)({},j))}E.RecordCreator=Z,oe.a=E},KxBF:function(Ke,oe){function t(c,F,$){var f=-1,P=c.length;F<0&&(F=-F>P?0:P+F),$=$>P?P:$,$<0&&($+=P),P=F>$?0:$-F>>>0,F>>>=0;for(var u=Array(P);++f<P;)u[f]=c[f+F];return u}Ke.exports=t},LDJE:function(Ke,oe,t){"use strict";var c=t("q1tI"),F=t.n(c),$=t("ma/q"),f=t("ZIEt"),P=t("QpZ9"),u=t("GzfL"),je=t("Scwr"),a=function(l,se){var me={};for(var ge in l)Object.prototype.hasOwnProperty.call(l,ge)&&se.indexOf(ge)<0&&(me[ge]=l[ge]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var q=0,ge=Object.getOwnPropertySymbols(l);q<ge.length;q++)se.indexOf(ge[q])<0&&Object.prototype.propertyIsEnumerable.call(l,ge[q])&&(me[ge[q]]=l[ge[q]]);return me},Ie=Object(c.forwardRef)(function(l,se){var me=l.chartRef,ge=l.style,q=ge===void 0?{height:"inherit"}:ge,_e=l.className,Xe=l.loading,pe=l.loadingTemplate,Ne=l.errorTemplate,We=a(l,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),h=Object(f.a)($.a,We),O=h.chart,ze=h.container;return Object(c.useEffect)(function(){Object(P.a)(me,O.current)},[O.current]),Object(c.useImperativeHandle)(se,function(){return{getChart:function(){return O.current}}}),F.a.createElement(u.a,{errorTemplate:Ne},Xe&&F.a.createElement(je.a,{loadingTemplate:pe,theme:l.theme}),F.a.createElement("div",{className:_e,style:q,ref:ze}))});oe.a=Ie},bahg:function(Ke,oe){function t(c){return c.split("")}Ke.exports=t},jsgi:function(Ke,oe,t){"use strict";var c=t("k1fw"),F=t("q1tI"),$=t.n(F),f=t("nhC9"),P=t("LDJE"),u=t("nKUr"),je=t.n(u),a=function(l){var se=l.config,me=l.value,ge=l.title,q=l.children,_e=l.valueLabel,Xe=Object(F.useCallback)(function(Ne,We){var h,O=(h=me.find(function(ze){return ze.type===We.type}))===null||h===void 0?void 0:h.topic;return O?"".concat(O.topicable_type.split("\\").pop(),":").concat(O.title):Ne},[me]),pe=Object(F.useCallback)(function(Ne){return{name:_e||Ne.type,value:Ne.value}},[_e]);return Object(u.jsx)(f.a,{title:ge,headerBordered:!0,children:Object(u.jsxs)("div",{style:{overflow:"auto",minHeight:"400px"},children:[Object(u.jsx)(P.a,Object(c.a)(Object(c.a)({},se),{},{tooltip:{formatter:pe,title:Xe},data:me})),q&&q]})})};oe.a=a},olry:function(Ke,oe,t){"use strict";t.r(oe);var c=t("k1fw"),F=t("+L6B"),$=t("2/Rp"),f=t("T2oS"),P=t("W9HT"),u=t("q1tI"),je=t("nhC9"),a=t("9kvl"),Ie=t("55Ip"),l=t("Ty5D"),se=t("tMyG"),me=t("my69"),ge=t("huej"),q=t("mJ0o"),_e=t("EhlZ"),Xe=t("P2fV"),pe=t("NJEC"),Ne=t("5Dmo"),We=t("3S7+"),h=t("qLMh"),O=t("9og8"),ze=t("sWYD"),ke=t("G3dp"),we=t("lbgm"),dt=t("/MfK"),ae=t("Qiat"),k=t("mGZj");function J(o,i){return m.apply(this,arguments)}function m(){return m=Object(O.a)(Object(h.a)().mark(function o(i,r){return Object(h.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams",Object(c.a)({method:"GET",useCache:!1,params:i},r||{})));case 1:case"end":return n.stop()}},o)})),m.apply(this,arguments)}function Z(o,i){return xe.apply(this,arguments)}function xe(){return xe=Object(O.a)(Object(h.a)().mark(function o(i,r){return Object(h.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams",Object(c.a)({method:"POST",headers:{"Content-Type":"application/json"},data:i},r||{})));case 1:case"end":return n.stop()}},o)})),xe.apply(this,arguments)}function E(o,i,r){return j.apply(this,arguments)}function j(){return j=Object(O.a)(Object(h.a)().mark(function o(i,r,s){return Object(h.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i),Object(c.a)({method:"PUT",data:r,useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),j.apply(this,arguments)}function Ee(o,i){return ye.apply(this,arguments)}function ye(){return ye=Object(O.a)(Object(h.a)().mark(function o(i,r){return Object(h.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i),Object(c.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),ye.apply(this,arguments)}function Ce(o,i){return Te.apply(this,arguments)}function Te(){return Te=Object(O.a)(Object(h.a)().mark(function o(i,r){return Object(h.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i),Object(c.a)({method:"DELETE"},r||{})));case 1:case"end":return n.stop()}},o)})),Te.apply(this,arguments)}function Re(o,i,r,s){return Le.apply(this,arguments)}function Le(){return Le=Object(O.a)(Object(h.a)().mark(function o(i,r,s,n){return Object(h.a)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i,"/users/").concat(r),Object(c.a)({method:"POST",headers:{"Content-Type":"application/json"},data:s},n||{})));case 1:case"end":return b.stop()}},o)})),Le.apply(this,arguments)}function ce(o,i,r){return N.apply(this,arguments)}function N(){return N=Object(O.a)(Object(h.a)().mark(function o(i,r,s){return Object(h.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i,"/users/").concat(r),Object(c.a)({method:"DELETE"},s||{})));case 1:case"end":return d.stop()}},o)})),N.apply(this,arguments)}var Ge=t("giR+"),$e=t("fyUT"),w=t("tJVT"),it=t("14J3"),Qe=t("BMrR"),qe=t("jCWc"),He=t("kPKH"),ie=t("VMEa"),Ot=t("Qurx"),ft=t("lR9U"),z=t("/y+f"),xt=t("2qtc"),et=t("kLXV"),vt=t("OaEy"),Ve=t("2fM7"),Ye=t("oBTY"),bt=t("DBJ/"),e=t("nKUr"),R=[z.b.TeamsLecture,z.b.TestPortal,z.b.TeamsForms];function S(o){var i=o.showSelectAll,r=i===void 0?!0:i,s=o.options,n=s===void 0?[]:s,d=o.value,b=o.onChange,v=Object(u.useCallback)(function(){b==null||b(n.map(function(C){return C.value}),n)},[b,n]),T=Object(u.useCallback)(function(){b==null||b([],[])},[b]),y=Object(u.useMemo)(function(){return r?[{label:d!=null&&d.length?Object(e.jsx)($.a,{type:"link",onClick:T,children:Object(e.jsx)(a.a,{id:"deselect_all"})}):Object(e.jsx)($.a,{type:"link",onClick:v,children:Object(e.jsx)(a.a,{id:"select_all"})}),options:n}]:n},[v,T,n,r,d==null?void 0:d.length]);return{options:y,value:d,onChange:b}}var g=function(i){var r=i.open,s=i.closeModal,n=i.onSuccess,d=i.type,b=Object(q.b)(),v=b.teacherSubjectData,T=b.semester_subject_id,y=b.groupUsers,C=b.getGroupUsers,D=Object(u.useState)(),A=Object(w.a)(D,2),L=A[0],M=A[1],Y=Object(u.useState)([]),x=Object(w.a)(Y,2),V=x[0],he=x[1],_={type:d,semester_subject_id:T},H=Object(u.useCallback)(function(B){B.success&&M(B.data.results)},[]),G=Object(u.useMemo)(function(){var B;return((B=v==null?void 0:v.groups)!==null&&B!==void 0?B:[]).map(function(Se){var Ae=Se.id,ue=Se.name;return{label:ue,value:Ae}})},[]),W=Object(u.useCallback)(function(B){he(B);var Se=B.reduce(function(Ae,ue){var re,Oe=(re=y.byId)===null||re===void 0?void 0:re[ue];if(!Oe)return Ae;var X=Oe.users.map(function(te){var Be=te.id,I=te.email,ve=te.first_name,de=te.last_name;return{email:I,first_name:ve,last_name:de,user_id:Be,result:0}});return[].concat(Object(Ye.a)(Ae),Object(Ye.a)(X))},[]);M(Se!=null&&Se.length?Se:void 0)},[y.byId]),le=S({options:G,onChange:W,value:V});return Object(u.useEffect)(function(){if(d===z.b.Manual&&r){var B;v==null||(B=v.groups)===null||B===void 0||B.forEach(function(Se){var Ae=Se.id;return C(Ae)})}},[d,r]),Object(e.jsxs)(et.a,{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.".concat(d,"Convert")}),width:"40vw",open:r,onCancel:s,onOk:function(){L&&n(L)},okButtonProps:{disabled:!L},children:[R.includes(d)&&Object(e.jsx)(bt.a,{name:"file",url:"/api/admin/exams/parse",onUpload:H,onChange:function(Se){return!Se.fileList.length&&M(void 0)},maxFiles:1,data:_,hideLabel:!0}),d===z.b.Manual&&Object(e.jsx)(Ve.a,Object(c.a)(Object(c.a)({},le),{},{placeholder:Object(e.jsx)(a.a,{id:"select_groups"}),mode:"multiple",style:{width:"100%"}}))]})},p=function(i){var r=i.onSelect;return Object(e.jsxs)(Qe.a,{gutter:[16,16],children:[Object(e.jsx)(He.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(z.b.TeamsForms)},children:Object(e.jsx)(a.a,{id:"uploadFile.MsTeamsForms",defaultMessage:"uploadFile.MsTeamsForms"})})}),Object(e.jsx)(He.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(z.b.TestPortal)},children:Object(e.jsx)(a.a,{id:"uploadFile.TestPortal",defaultMessage:"uploadFile.TestPortal"})})}),Object(e.jsx)(He.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(z.b.TeamsLecture)},children:Object(e.jsx)(a.a,{id:"uploadFile.MsTeams",defaultMessage:"uploadFile.MsTeams"})})}),Object(e.jsx)(He.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(z.b.Manual)},children:Object(e.jsx)(a.a,{id:"uploadGradesManually",defaultMessage:"uploadGradesManually"})})})]})},U=[{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"first_name",editable:!1},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"last_name",editable:!1},{title:Object(e.jsx)(a.a,{id:"examResult"}),dataIndex:"result",valueType:"percent",formItemProps:{rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:0,max:100}})}]}}],K=function(i){var r=i.exam_id,s=ie.a.useForm(),n=Object(w.a)(s,1),d=n[0],b=Object(u.useState)(),v=Object(w.a)(b,2),T=v[0],y=v[1],C=Object(u.useState)(),D=Object(w.a)(C,2),A=D[0],L=D[1],M=Object(u.useState)(!1),Y=Object(w.a)(M,2),x=Y[0],V=Y[1],he=Object(q.b)(),_=he.semester_subject_id,H=Object(u.useMemo)(function(){return(A!=null?A:[]).map(function(W){var le=W.user_id;return le})},[A]);Object(u.useEffect)(function(){var W=Number(r);r==="new"&&(y(void 0),L(void 0),d.resetFields()),r!=="new"&&!Number.isNaN(W)&&(V(!0),Ee(W).then(function(le){if(le.success){var B=le.data,Se=B.type,Ae=B.results,ue=B.title,re=B.weight,Oe=B.passed_at;y(Se),L(Ae),d.setFieldsValue({title:ue,weight:re,passed_at:Oe})}}).finally(function(){return V(!1)}))},[r]);var G=Object(u.useCallback)(function(){y(void 0),L(void 0)},[]);return x?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[T&&Object(e.jsx)(g,{open:Boolean(T&&!A),type:T,closeModal:G,onSuccess:L}),Object(e.jsxs)(ie.a,{form:d,submitter:T===void 0||!A?!1:void 0,onFinish:function(){var W=Object(O.a)(Object(h.a)().mark(function le(B){var Se,Ae,ue,re,Oe,X,te;return Object(h.a)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(Se=A==null?void 0:A.every(function(ve){var de=ve.result;return typeof de=="number"&&de>=0&&de<=100}),!(Se&&typeof _=="number")){I.next=16;break}if(Ae=B.title,ue=B.passed_at,re=B.weight,Oe=Number(r),X={type:T,semester_subject_id:_,title:Ae,passed_at:ue,weight:re,results:A},!Number.isNaN(Oe)){I.next=11;break}return I.next=8,Z(X);case 8:I.t0=I.sent,I.next=14;break;case 11:return I.next=13,E(Oe,X);case 13:I.t0=I.sent;case 14:te=I.t0,te.success&&a.f.push("/teacher/subjects/".concat(_,"/exams"));case 16:return I.abrupt("return",!0);case 17:case"end":return I.stop()}},le)}));return function(le){return W.apply(this,arguments)}}(),onReset:G,children:[Object(e.jsxs)(ie.a.Group,{children:[Object(e.jsx)(Ot.a,{label:Object(e.jsx)(a.a,{id:"examTitle",defaultMessage:"examTitle"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],width:"lg",name:"title"}),Object(e.jsx)(ft.a,{label:Object(e.jsx)(a.a,{id:"datePassingExam",defaultMessage:"datePassingExam"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],width:"lg",name:"passed_at"}),Object(e.jsx)(ie.a.Item,{name:"weight",label:Object(e.jsx)(a.a,{id:"examImportance",defaultMessage:"examImportance"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:1,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:1,max:100}})}],children:Object(e.jsx)($e.a,{})})]}),T&&A&&Object(e.jsx)(ae.a,{rowKey:"user_id",editable:{type:"single",editableKeys:H,onValuesChange:function(le,B){return L(B)}},cardProps:{bodyStyle:{paddingInline:0}},search:!1,dataSource:A,columns:U}),!A&&Object(e.jsx)(p,{onSelect:y})]})]})},Me=[{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"first_name"},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"last_name"},{title:Object(e.jsx)(a.a,{id:"examResult"}),dataIndex:"result",hideInSearch:!0}],ut=function(i){var r=i.exam_id;return Object(e.jsx)(ae.a,{rowKey:"user_id",search:!1,headerTitle:Object(e.jsx)(a.a,{id:"examResults"}),request:Object(O.a)(Object(h.a)().mark(function s(){var n;return Object(h.a)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,Ee(r);case 2:if(n=b.sent,!n.success){b.next=5;break}return b.abrupt("return",{total:n.data.results.length,success:!0,data:n.data.results});case 5:return b.abrupt("return",[]);case 6:case"end":return b.stop()}},s)})),columns:Me})},Ze=[{title:Object(e.jsx)(a.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",sorter:!0},{title:Object(e.jsx)(a.a,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!0,sorter:!0},{title:Object(e.jsx)(a.a,{id:"type",defaultMessage:"type"}),dataIndex:"type",sorter:!0,render:function(i,r){return Object(e.jsx)(a.a,{id:"ExamGradeType.".concat(r.type)})}},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.exam_date",defaultMessage:"Exam date"}),dataIndex:"passed_at",sorter:!0,render:function(i,r){return r.passed_at&&Object(ze.a)(new Date(r.passed_at),k.c)}},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",sorter:!0,render:function(i,r){return r.weight+"%"}},{title:Object(e.jsx)(a.a,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",sorter:!0,render:function(i,r){return r.created_at&&Object(ze.a)(new Date(r.created_at),k.c)}},{title:Object(e.jsx)(a.a,{id:"semester",defaultMessage:"Semester"}),dataIndex:"semester",sorter:!0,render:function(i,r){return Object(e.jsx)(a.a,{id:"SemesterType.".concat(r.semester.type),values:{year:r.semester.year}})}}],be=function(){var i,r,s=Object(u.useRef)(),n=Object(q.b)(),d=n.semester_subject_id,b=Object(l.k)(),v=Object(u.useMemo)(function(){var C,D,A;return{exam_id:(C=(D=b.query)===null||D===void 0?void 0:D.exam_id)!==null&&C!==void 0?C:null,results:(A=b.query)===null||A===void 0?void 0:A.results}},[(i=b.query)===null||i===void 0?void 0:i.exam_id,(r=b.query)===null||r===void 0?void 0:r.results]),T=v.exam_id,y=v.results;return y!==null&&!Number.isNaN(Number(y))?Object(e.jsx)(ut,{exam_id:Number(y)}):T!==null?Object(e.jsx)(K,{exam_id:T}):Object(e.jsx)(ae.a,{headerTitle:Object(e.jsx)(a.a,{id:"exams"}),actionRef:s,search:!1,rowKey:"id",request:function(){var C=Object(O.a)(Object(h.a)().mark(function D(A,L){var M,Y,x,V;return Object(h.a)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(M=A.current,Y=A.pageSize,d!==null){_.next=3;break}return _.abrupt("return",{data:[],total:0,success:!1});case 3:return x=L&&Object.entries(L)[0],_.next=6,J({per_page:Y,page:M,semester_subject_id:Number.isNaN(d)?void 0:d,order_by:x&&x[0],order:x&&(x[1]==="ascend"?"ASC":"DESC")});case 6:if(V=_.sent,!V.success){_.next=9;break}return _.abrupt("return",{data:V.data,total:V.meta.total,success:!0});case 9:return _.abrupt("return",{data:[],total:0,success:!1});case 10:case"end":return _.stop()}},D)}));return function(D,A){return C.apply(this,arguments)}}(),columns:[].concat(Ze,[{title:Object(e.jsx)(a.a,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(D,A){return[Object(e.jsx)(Ie.a,{to:"/teacher/subjects/".concat(A.semester_subject_id,"/exams?exam_id=").concat(A.id),children:Object(e.jsx)(We.a,{title:Object(e.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(ke.a,{})})})},"edit"),Object(e.jsx)(Ie.a,{to:"/teacher/subjects/".concat(A.semester_subject_id,"/exams?results=").concat(A.id),children:Object(e.jsx)(We.a,{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.results",defaultMessage:"results"}),children:Object(e.jsx)($.a,{icon:Object(e.jsx)(we.a,{})})})},"results"),Object(e.jsx)(pe.a,{title:Object(e.jsx)(a.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(O.a)(Object(h.a)().mark(function L(){var M;return Object(h.a)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,Ce(A.id);case 2:M=x.sent,M.success&&s.current&&s.current.reload();case 4:case"end":return x.stop()}},L)})),okText:Object(e.jsx)(a.a,{id:"yes"}),cancelText:Object(e.jsx)(a.a,{id:"no"}),children:Object(e.jsx)(We.a,{title:Object(e.jsx)(a.a,{id:"delete",defaultMessage:"delete"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(dt.a,{}),danger:!0})})},"delete")]}}])})},ee=t("DYRE"),ne=t("zeV3"),fe=t("tU7J"),Q=t("wFql"),Pe=t("4KAj"),De=t("o0Ox"),rt=[{title:Object(e.jsx)(a.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"user_id",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"first_name",defaultMessage:"First name"}),dataIndex:"first_name",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"last_name",defaultMessage:"Last name"}),dataIndex:"last_name",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"email",defaultMessage:"email"}),dataIndex:"email",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"groupName",defaultMessage:"Group name"}),dataIndex:"group_name",hideInSearch:!0}],mt=function(){var i,r=Object(u.useState)(!1),s=Object(w.a)(r,2),n=s[0],d=s[1],b=Object(q.b)(),v=b.teacherSubjectData,T=Object(u.useState)([]),y=Object(w.a)(T,2),C=y[0],D=y[1],A=Object(u.useRef)(),L=Object(u.useMemo)(function(){return C.reduce(function(x,V){var he,_=[];return V==null||(he=V.users)===null||he===void 0||he.reduce(function(H,G){var W={group_id:V.id,group_name:V.name,user_id:G.id,first_name:G.first_name,last_name:G.last_name,email:G.email};return _.push(W),Object(c.a)(Object(c.a)({},H),W)},{}),d(!1),[].concat(Object(Ye.a)(x),_)},[])},[C]),M=function(V){Object(De.a)({parent_id:v==null?void 0:v.group_id,"id[]":V}).then(function(he){he.success&&D(he.data)})},Y=function(V){d(!0),M(V)};return Object(u.useEffect)(function(){M()},[]),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(je.a,{children:Object(e.jsxs)(ne.b,{children:[Object(e.jsx)(Q.a.Title,{level:5,children:Object(e.jsx)(a.a,{id:"select_user_group",defaultMessage:"Select group"})}),Object(e.jsx)(Ve.a,{allowClear:!0,mode:"multiple",style:{minWidth:"400px"},onChange:Y,onClear:M,children:v==null||(i=v.groups)===null||i===void 0?void 0:i.map(function(x){return Object(e.jsx)(Ve.a.Option,{value:x.id,children:x.name},x.id)})})]})}),Object(e.jsx)(ae.a,{actionRef:A,rowKey:"user_id",search:!1,loading:n,dataSource:L!=null?L:[],columns:[].concat(rt,[{hideInSearch:!0,title:Object(e.jsx)(a.a,{id:"msTeams"}),dataIndex:"teamsLink",valueType:"option",render:function(){return[Object(e.jsx)(Ie.a,{to:"#",children:Object(e.jsx)(We.a,{title:Object(e.jsx)(a.a,{id:"msTeams",defaultMessage:"teams"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(Pe.a,{})})})},"teamsLink")]}}])})]})},ht=mt,gt=t("jrin");function pt(o,i){return _t.apply(this,arguments)}function _t(){return _t=Object(O.a)(Object(h.a)().mark(function o(i,r){return Object(h.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/schedules/groups/".concat(i),Object(c.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),_t.apply(this,arguments)}function Kt(o,i,r,s){return Tt.apply(this,arguments)}function Tt(){return Tt=Object(O.a)(Object(h.a)().mark(function o(i,r,s,n){return Object(h.a)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",Object(a.i)("/api/admin/schedules/".concat(i,"/attendances"),Object(c.a)({data:{attendances:[{user_id:r,value:s}]},method:"POST"},n||{})));case 1:case"end":return b.stop()}},o)})),Tt.apply(this,arguments)}var Ia=t("sRBo"),Bt=t("kaz8"),Vt=function(i){var r=i.currentData,s=i.recordData,n=i.groupId,d=i.onSuccess,b=Object(u.useState)(!1),v=Object(w.a)(b,2),T=v[0],y=v[1],C=function(){y(!0),Kt(r.id,s.id,(s==null?void 0:s[String(r.date_from)])===z.a.PRESENT?z.a.ABSENT:z.a.PRESENT).then(function(A){A.success&&pt(Number(n)).then(function(L){L.success&&(d(L.data),y(!1))})})};return T?Object(e.jsx)(P.a,{size:"small"}):Object(e.jsx)(Bt.a,{checked:(s==null?void 0:s[String(r.date_from)])===z.a.PRESENT,onChange:function(){return C()}})},Ht=Vt,Jt=function(){var i,r,s,n,d,b=Object(q.b)(),v=b.teacherSubjectData,T=Object(u.useRef)(),y=Object(a.l)(),C=Object(u.useState)(!1),D=Object(w.a)(C,2),A=D[0],L=D[1],M=Object(u.useState)(),Y=Object(w.a)(M,2),x=Y[0],V=Y[1],he=Object(u.useState)(),_=Object(w.a)(he,2),H=_[0],G=_[1],W=Object(u.useState)({id:(i=v==null||(r=v.groups)===null||r===void 0?void 0:r[0].id)!==null&&i!==void 0?i:null,name:v==null||(s=v.groups)===null||s===void 0?void 0:s[0].name}),le=Object(w.a)(W,2),B=le[0],Se=le[1],Ae=Object(u.useMemo)(function(){var X;return((X=H==null?void 0:H.users)!==null&&X!==void 0?X:[]).reduce(function(te,Be){var I={id:Be.id,first_name:Be.first_name,last_name:Be.last_name,academic_teacher_id:Be.academic_teacher_id},ve=(x!=null?x:[]).reduce(function(de,Ue){var Fe=Ue.attendances.find(function(tt){return tt.user_id===Be.id});return Object(c.a)(Object(c.a)({},de),{},Object(gt.a)({},String(Ue.date_from),Fe==null?void 0:Fe.value))},{});return I.academic_teacher_id?Object(Ye.a)(te):[].concat(Object(Ye.a)(te),[Object(c.a)(Object(c.a)({},I),ve)])},[])},[H,x]),ue=Object(u.useMemo)(function(){var X=(x!=null?x:[]).reduce(function(te,Be){return[].concat(Object(Ye.a)(te),[{title:String(Object(ze.a)(new Date(Be.date_from),k.c)),dataIndex:String(Be.date_from),hideInSearch:!0,width:100,align:"center",render:function(ve,de){return Object(e.jsx)(Ht,{currentData:Be,recordData:de,onSuccess:function(Fe){return V(Fe)},groupId:B.id})}}])},[]);return console.log({columns:ue}),L(!1),[{title:Object(e.jsx)(a.a,{id:"nameAndSurname",defaultMessage:"Name and surname"}),hideInSearch:!0,fixed:"left",render:function(Be,I){return"".concat(I.first_name," ").concat(I.last_name)}}].concat(Object(Ye.a)(X))},[x]),re=function(te){var Be,I=v==null||(Be=v.groups)===null||Be===void 0?void 0:Be.find(function(ve){return ve.id===te});return I?I==null?void 0:I.name:""},Oe=function(te){L(!0),Se({id:te,name:re(te)})};return Object(u.useEffect)(function(){B.id&&(pt(B.id).then(function(X){X.success&&V(X.data)}),Object(De.b)(B.id).then(function(X){X.success&&G(X.data)}))},[B]),console.log({studentAttendanceList:Ae}),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(je.a,{children:Object(e.jsxs)(ne.b,{children:[Object(e.jsx)(Q.a.Title,{level:5,children:Object(e.jsx)(a.a,{id:"select_user_group",defaultMessage:"Select group"})}),Object(e.jsx)(Ve.a,{style:{minWidth:"400px"},onChange:Oe,defaultValue:v==null||(n=v.groups)===null||n===void 0?void 0:n[0].id,children:v==null||(d=v.groups)===null||d===void 0?void 0:d.map(function(X){return Object(e.jsx)(Ve.a.Option,{value:X.id,children:X.name},X.id)})})]})}),ue.length===1?Object(e.jsx)(a.a,{id:"noAttendanceSchedule",defaultMessage:"No attendance schedule for this group..."}):Object(e.jsx)(ae.a,{headerTitle:"".concat(y.formatMessage({id:"attendances",defaultMessage:"Attendances"})," (").concat(B.name,")"),actionRef:T,rowKey:"group_id",search:!1,loading:A,dataSource:Ae!=null?Ae:[],scroll:{x:1500},columns:Object(Ye.a)(ue)})]})},zt=Jt,Ra=t("/zsF"),yt=t("PArb"),Yt=t("Hn4i"),Zt=t("bRQS");function $t(o,i,r){return Ct.apply(this,arguments)}function Ct(){return Ct=Object(O.a)(Object(h.a)().mark(function o(i,r,s){return Object(h.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/semester-subjects/".concat(i,"/tutors/").concat(r,"/grades"),Object(c.a)({method:"GET",useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),Ct.apply(this,arguments)}function Qt(o,i,r,s){return Mt.apply(this,arguments)}function Mt(){return Mt=Object(O.a)(Object(h.a)().mark(function o(i,r,s,n){return Object(h.a)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",Object(a.i)("/api/admin/semester-subjects/".concat(i,"/tutors/").concat(r,"/grades"),Object(c.a)({method:"POST",data:s},n||{})));case 1:case"end":return b.stop()}},o)})),Mt.apply(this,arguments)}function Xt(o,i){return Pt.apply(this,arguments)}function Pt(){return Pt=Object(O.a)(Object(h.a)().mark(function o(i,r){return Object(h.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/lesson-group-users",Object(c.a)({method:"GET",params:{"groups[]":i},useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),Pt.apply(this,arguments)}function kt(o,i,r){return Dt.apply(this,arguments)}function Dt(){return Dt=Object(O.a)(Object(h.a)().mark(function o(i,r,s){return Object(h.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/lesson-group-users/groups/".concat(i,"/users/").concat(r),Object(c.a)({method:"GET",useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),Dt.apply(this,arguments)}function qt(o){return At.apply(this,arguments)}function At(){return At=Object(O.a)(Object(h.a)().mark(function o(i){return Object(h.a)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",Object(a.i)("/api/admin/grade-terms",Object(c.a)({method:"GET",useCache:!1},i||{})));case 1:case"end":return s.stop()}},o)})),At.apply(this,arguments)}function ea(o,i){return It.apply(this,arguments)}function It(){return It=Object(O.a)(Object(h.a)().mark(function o(i,r){return Object(h.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/grade-scales/".concat(i),Object(c.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),It.apply(this,arguments)}function ta(o,i){return Rt.apply(this,arguments)}function Rt(){return Rt=Object(O.a)(Object(h.a)().mark(function o(i,r){return Object(h.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/final-grades",Object(c.a)({method:"POST",data:i},r||{})));case 1:case"end":return n.stop()}},o)})),Rt.apply(this,arguments)}function aa(o,i,r){return Lt.apply(this,arguments)}function Lt(){return Lt=Object(O.a)(Object(h.a)().mark(function o(i,r,s){return Object(h.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/final-grades/".concat(i),Object(c.a)({method:"PATCH",data:r},s||{})));case 1:case"end":return d.stop()}},o)})),Lt.apply(this,arguments)}var na=[{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade",editable:!1},{title:Object(e.jsx)(a.a,{id:"degree"}),dataIndex:"name",editable:!1},{title:Object(e.jsx)(a.a,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent",formItemProps:{rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:0,max:100}})}]}}],ra=function(){var i,r,s=Object(a.m)("@@initialState"),n=s.initialState,d=Object(q.b)(),b=d.semester_subject_id,v=d.tutors,T=ie.a.useForm(),y=Object(w.a)(T,1),C=y[0],D=Object(u.useState)([]),A=Object(w.a)(D,2),L=A[0],M=A[1],Y=Object(u.useRef)(),x=Object(u.useState)(!1),V=Object(w.a)(x,2),he=V[0],_=V[1],H=Object(u.useState)(null),G=Object(w.a)(H,2),W=G[0],le=G[1],B=Object(u.useMemo)(function(){return!!v.data.find(function(ue){var re,Oe=ue.id;return Oe===(n==null||(re=n.currentUser)===null||re===void 0?void 0:re.id)})},[v.data,n==null||(i=n.currentUser)===null||i===void 0?void 0:i.id]),Se=Object(u.useMemo)(function(){return v.data.map(function(ue){var re=ue.id,Oe=ue.first_name,X=ue.last_name;return{label:"".concat(Oe," ").concat(X),value:re}})},[v.data]);Object(u.useEffect)(function(){var ue,re;if(!B||!(n!=null&&(ue=n.currentUser)!==null&&ue!==void 0&&ue.id)){var Oe;if((Oe=v.data)!==null&&Oe!==void 0&&Oe[0]){var X;le((X=v.data)===null||X===void 0?void 0:X[0].id)}return}le(n==null||(re=n.currentUser)===null||re===void 0?void 0:re.id)},[n==null||(r=n.currentUser)===null||r===void 0?void 0:r.id,B]),Object(u.useEffect)(function(){b===null||W===null||(_(!0),$t(b,W).then(function(ue){if(ue.success){var re,Oe=((re=ue.data.grade_scale)!==null&&re!==void 0?re:[]).map(function(X,te){return Object(c.a)(Object(c.a)({},X),{},{id:String((te+1)*100)})});C.setFieldValue("table",Oe)}}).finally(function(){_(!1)}))},[b,W]);var Ae=Object(u.useCallback)(function(){var ue=Object(O.a)(Object(h.a)().mark(function re(Oe){return Object(h.a)().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:if(!(b===null||W===null)){te.next=2;break}return te.abrupt("return");case 2:return te.next=4,Qt(b,W,{grade_scale:Oe.table});case 4:case"end":return te.stop()}},re)}));return function(re){return ue.apply(this,arguments)}}(),[W,b]);return v.loading?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(ie.a.Item,{label:Object(e.jsx)(a.a,{id:"menu.Teacher"}),children:Object(e.jsx)(Ve.a,{disabled:B,placeholder:Object(e.jsx)(a.a,{id:"select"}),options:Se,value:W,onChange:function(re){return le(re)}})}),Object(e.jsx)(yt.a,{}),Object(e.jsx)(ie.a,{form:C,onFinish:Ae,submitter:{render:function(re,Oe){var X=Object(w.a)(Oe,2),te=X[1];return[te]}},children:Object(e.jsx)(Yt.a,{name:"table",rowKey:"id",actionRef:Y,formItemProps:{label:Object(e.jsx)(a.a,{id:"grades-scale"})},cardProps:{bodyStyle:{padding:0}},recordCreatorProps:!1,loading:he,columns:[].concat(na,[{title:Object(e.jsx)(a.a,{id:"options"}),valueType:"option",render:function(re,Oe){return Object(e.jsx)($.a,{type:"primary",onClick:function(){var te;return(te=Y.current)===null||te===void 0?void 0:te.startEditable(Oe.id)},icon:Object(e.jsx)(ke.a,{})})}}]),editable:{form:C,type:"multiple",editableKeys:L,saveText:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(Zt.a,{})}),onChange:M,actionRender:function(re,Oe,X){return[X.save]}}})})]})},La=t("qbNl"),sa=t("JBPa"),Ga=t("Awhp"),ca=t("KrTs"),ia=t("wd/R"),st=t.n(ia),Ua=t("5R/X");function ua(o,i){return Gt.apply(this,arguments)}function Gt(){return Gt=Object(O.a)(Object(h.a)().mark(function o(i,r){return Object(h.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/schedules",Object(c.a)({params:i,method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),Gt.apply(this,arguments)}var la=function(){var i=Object(u.useState)(null),r=Object(w.a)(i,2),s=r[0],n=r[1],d=Object(u.useState)([]),b=Object(w.a)(d,2),v=b[0],T=b[1],y=Object(q.b)(),C=y.semester_subject_id,D=st()(),A=Object(u.useMemo)(function(){return v.map(function(_){return{id:_.id,title:"".concat(_.group.name," (").concat(_.term_status.name,")"),start:st()(_.date_from).toDate(),end:st()(_.date_to).toDate(),tutor_name:"".concat(_.tutor.first_name," ").concat(_.tutor.last_name),tutor_email:_.tutor.email,semester:_.semester.name,group:_.group.name,subject:_.subject.name}})},[v]),L=Object(u.useCallback)(function(_,H){ua({semester_subject_id:C,date_form:_.toDate(),date_to:H.toDate()}).then(function(G){G.success&&T(G.data)})},[C]),M=Object(u.useCallback)(function(_){n(_)},[]),Y=Object(u.useCallback)(function(){n(null)},[]),x=Object(u.useCallback)(function(_){return _.isSame(D,"day")?"warning":_.isAfter(D,"day")?"success":"error"},[]),V=Object(u.useCallback)(function(_){var H=A.filter(function(G){return st()(G.start).isSame(_,"day")});return Object(e.jsx)("ul",{className:"events",children:H.map(function(G){return Object(e.jsx)("li",{onClick:function(){return M(G)},children:Object(e.jsx)(ca.a,{status:x(st()(G.start)),text:G.title})},G.id)})})},[v]),he=Object(u.useCallback)(function(_,H){var G=st()(_).startOf(H).subtract(1,"month"),W=st()(_).endOf(H).add(1,"month");L(G,W)},[]);return Object(u.useEffect)(function(){var _=st()().startOf("month"),H=st()().endOf("month");L(_,H)},[]),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Q.a.Title,{level:4,children:Object(e.jsx)(a.a,{id:"schedule",defaultMessage:"Schedule"})}),Object(e.jsx)(sa.a,{dateCellRender:V,onPanelChange:he}),Object(e.jsxs)(et.a,{open:s!==null,title:"".concat(s==null?void 0:s.subject,": ").concat(s==null?void 0:s.title),onCancel:Y,footer:null,children:[Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"tutorName",defaultMessage:"Tutor"}),": ",s==null?void 0:s.tutor_name]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"email",defaultMessage:"Email"}),": ",s==null?void 0:s.tutor_email]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"group",defaultMessage:"Group"}),": ",s==null?void 0:s.group]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"semester",defaultMessage:"Semester"}),": ",s==null?void 0:s.semester]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"started_at",defaultMessage:"Start date"}),":",s&&st()(s.start).format(k.b)]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"end_at",defaultMessage:"End date"}),":",s&&st()(s.end).format(k.b)]})]})]})},da=la,Ut=t("PpiC"),oa=t("Vpfc"),Fa=t("miYZ"),Et=t("tsqr"),Nt=t("yj/a"),Wt=t("5Syx"),Ft=t("H6aw"),ja=t("p3I6"),ba=["attendances"],fa=["results"];function Oa(o,i){var r=Object(u.useState)({loading:!1}),s=Object(w.a)(r,2),n=s[0],d=s[1];return Object(u.useEffect)(function(){d(function(b){return Object(c.a)(Object(c.a)({},b),{},{loading:!0})}),kt(o,i).then(function(b){b.success&&d(function(v){return Object(c.a)(Object(c.a)({},v),{},{data:b.data})})}).finally(function(){d(function(b){return Object(c.a)(Object(c.a)({},b),{},{loading:!1})})})},[i,o]),{finalGrades:n}}function va(){var o=Object(u.useState)({loading:!1}),i=Object(w.a)(o,2),r=i[0],s=i[1];return Object(u.useEffect)(function(){s(function(n){return Object(c.a)(Object(c.a)({},n),{},{loading:!0})}),qt().then(function(n){n.success&&s(function(d){return Object(c.a)(Object(c.a)({},d),{},{data:n.data})})}).finally(function(){s(function(n){return Object(c.a)(Object(c.a)({},n),{},{loading:!1})})})},[]),{gradeTerms:r}}function ma(o){var i=Object(u.useState)({loading:!1}),r=Object(w.a)(i,2),s=r[0],n=r[1];return Object(u.useEffect)(function(){o!==void 0&&(n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!0})}),ea(o).then(function(d){d.success&&n(function(b){return Object(c.a)(Object(c.a)({},b),{},{data:d.data})})}).finally(function(){n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!1})})}))},[o]),{subjectGradeScales:s}}function ha(o,i){var r=Object(u.useState)({loading:!1}),s=Object(w.a)(r,2),n=s[0],d=s[1];return Object(u.useEffect)(function(){typeof o!="number"||typeof i!="number"||(d(function(b){return Object(c.a)(Object(c.a)({},b),{},{loading:!0})}),$t(o,i).then(function(b){b.success&&d(function(v){return Object(c.a)(Object(c.a)({},v),{},{data:b.data.grade_scale})})}).finally(function(){d(function(b){return Object(c.a)(Object(c.a)({},b),{},{loading:!1})})}))},[o,i]),{tutorGradeScales:n}}function ga(o,i){var r=Object(u.useState)({loading:!1}),s=Object(w.a)(r,2),n=s[0],d=s[1],b=Object(u.useCallback)(function(){d(function(T){return Object(c.a)(Object(c.a)({},T),{},{loading:!0})}),pt(o).then(function(T){if(T.success){var y=T.data.reduce(function(C,D){var A=D.attendances,L=Object(Ut.a)(D,ba),M=A.find(function(Y){return Boolean(Y.user_id)});return M?[].concat(Object(Ye.a)(C),[Object(c.a)(Object(c.a)({},L),{},{attendance:M})]):C},[]);d(function(C){return Object(c.a)(Object(c.a)({},C),{},{data:y})})}}).finally(function(){d(function(T){return Object(c.a)(Object(c.a)({},T),{},{loading:!1})})})},[o,i]),v=Object(u.useCallback)(function(T,y){d(function(C){return Object(c.a)(Object(c.a)({},C),{},{loading:!0})}),Kt(T,i,y).then(function(C){C.success?Et.b.success(C.message):Et.b.error(C.message)}).finally(function(){b(),d(function(C){return Object(c.a)(Object(c.a)({},C),{},{loading:!1})})})},[b,i]);return Object(u.useEffect)(function(){b()},[b]),{userAttendanceSchedules:n,fetchUserAttendanceSchedules:b,updateUserAttendanceSchedules:v}}function pa(o){var i=Object(u.useState)({loading:!1}),r=Object(w.a)(i,2),s=r[0],n=r[1];return Object(u.useEffect)(function(){n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!0})}),J({student_id:o}).then(function(d){if(d.success){var b=d.data.reduce(function(v,T){var y=Object(w.a)(T.results,1),C=y[0],D=Object(Ut.a)(T,fa);return C?[].concat(Object(Ye.a)(v),[Object(c.a)(Object(c.a)({},D),{},{result:C})]):v},[]);n(function(v){return Object(c.a)(Object(c.a)({},v),{},{data:b})})}}).finally(function(){n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!1})})})},[o]),{studentExams:s}}function _a(o,i){var r=Object(u.useState)({loading:!1}),s=Object(w.a)(r,2),n=s[0],d=s[1],b=Object(u.useState)({loading:!1}),v=Object(w.a)(b,2),T=v[0],y=v[1],C=Object(u.useState)({loading:!1}),D=Object(w.a)(C,2),A=D[0],L=D[1];return Object(u.useEffect)(function(){d(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!0})}),Object(Ft.e)({group_id:o}).then(function(M){M.success&&d(function(Y){return Object(c.a)(Object(c.a)({},Y),{},{data:M.data})})}).finally(function(){d(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!1})})})},[o]),Object(u.useEffect)(function(){!n.data||(L(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!0})}),Promise.all(n.data.map(function(M){var Y=M.id;return Object(Ft.m)(Number(Y))})).then(function(M){M.forEach(function(Y){Y.success&&L(function(x){return Object(c.a)(Object(c.a)({},x),{},{data:Object(c.a)(Object(c.a)({},x.data),{},Object(gt.a)({},Number(Y.data.id),Object(ja.c)(Y.data.lessons)))})})})}).finally(function(){L(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!1})})}),y(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!0})}),Promise.all(n.data.map(function(M){var Y=M.id;return Object(Ft.l)(Number(Y),["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics","EscolaLms\\Reports\\Stats\\Course\\AttendanceList"]).then(function(x){if(x.success){var V,he,_=((V=x.data["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics"])!==null&&V!==void 0?V:[]).filter(function(G){return G.id===i}),H=(he=x.data["EscolaLms\\Reports\\Stats\\Course\\AttendanceList"])!==null&&he!==void 0?he:[];y(function(G){return Object(c.a)(Object(c.a)({},G),{},{data:Object(c.a)(Object(c.a)({},G.data),{},Object(gt.a)({},Number(Y),{finishedTopics:_,attendanceList:H}))})})}})})).finally(function(){return y(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!1})})}))},[n.data,i]),{userCourses:n,userCoursesStats:T,userCoursesTopics:A}}var xa=[{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade"},{title:Object(e.jsx)(a.a,{id:"degree"}),dataIndex:"name"},{title:Object(e.jsx)(a.a,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent"}],Ea=[{title:Object(e.jsx)(a.a,{id:"date"}),dataIndex:"date_from",render:function(i,r){return Object(ze.a)(new Date(r.date_from),k.c)}}],Sa=[{title:Object(e.jsx)(a.a,{id:"name"}),dataIndex:"title"},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",valueType:"percent"},{title:Object(e.jsx)(a.a,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",render:function(i,r){return Object(ze.a)(new Date(r.created_at),k.c)}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"result",render:function(i,r){return"".concat(r.result.result,"%")}}],Ta=[{title:Object(e.jsx)(a.a,{id:"name"}),dataIndex:"name"},{title:Object(e.jsx)(a.a,{id:"issued_at"}),dataIndex:"grade",render:function(i,r){var s,n;return(s=r.grade)!==null&&s!==void 0&&s.grade_date?Object(ze.a)(new Date((n=r.grade)===null||n===void 0?void 0:n.grade_date),k.c):"-"}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade",render:function(i,r){var s,n;return(s=(n=r.grade)===null||n===void 0?void 0:n.grade_name)!==null&&s!==void 0?s:"-"}}],St=6,ya=function(i){var r,s,n=i.user_id,d=i.group_id,b=Object(q.b)(),v=b.semester_subject_id,T=pa(n),y=T.studentExams,C=Oa(d,n),D=C.finalGrades,A=va(),L=A.gradeTerms,M=ma((r=D.data)===null||r===void 0?void 0:r.s_subject_scale_form_id),Y=M.subjectGradeScales,x=ha(v,(s=D.data)===null||s===void 0?void 0:s.tutor_id),V=x.tutorGradeScales,he=ga(d,n),_=he.userAttendanceSchedules,H=he.updateUserAttendanceSchedules,G=_a(d,n),W=G.userCourses,le=G.userCoursesStats,B=G.userCoursesTopics,Se=ie.a.useForm(),Ae=Object(w.a)(Se,1),ue=Ae[0],re=Object(u.useMemo)(function(){var I;return((I=L.data)!==null&&I!==void 0?I:[]).map(function(ve){var de=ve.id,Ue=ve.name;return{label:Ue,value:de}})},[L.data]),Oe=Object(u.useMemo)(function(){var I;return((I=Y.data)!==null&&I!==void 0?I:[]).map(function(ve){var de=ve.name,Ue=ve.id;return{label:de,value:Ue}})},[Y.data]),X=Object(u.useMemo)(function(){var I,ve,de,Ue=((I=y.data)!==null&&I!==void 0?I:[]).reduce(function(nt,ct){var Aa=ct.result,wt=ct.weight;return[nt[0]+Aa.result*wt,nt[1]+wt]},[0,0]),Fe=Object(w.a)(Ue,2),tt=Fe[0],lt=Fe[1],ot=Number.isNaN(tt/lt)?0:tt/lt,jt=((ve=V.data)!==null&&ve!==void 0?ve:[]).sort(function(nt,ct){return nt.grade_value-ct.grade_value}).reduce(function(nt,ct){return[].concat(Object(Ye.a)(nt),[Object(c.a)(Object(c.a)({},ct),{},{isWeightedAverageGreater:ot>=ct.grade_value})])},[]);if(jt.every(function(nt){var ct=nt.isWeightedAverageGreater;return ct})){var Je;return(Je=jt.at(-1))===null||Je===void 0?void 0:Je.name}var at=jt.findIndex(function(nt){var ct=nt.isWeightedAverageGreater;return!ct});return at<0?"":(de=jt[at-1])===null||de===void 0?void 0:de.name},[y.data,V.data]),te=Object(u.useCallback)(function(){var I=Object(O.a)(Object(h.a)().mark(function ve(de){var Ue,Fe,tt,lt,ot;return Object(h.a)().wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(tt=de.grade_scale_id,lt=de.grade_term_id,((Ue=D.data)===null||Ue===void 0?void 0:Ue.id)!==void 0){Je.next=3;break}return Je.abrupt("return");case 3:if(ot=(Fe=D.data)===null||Fe===void 0?void 0:Fe.grades.find(function(at){var nt=at.grade_term;return nt.id===lt}),!ot){Je.next=7;break}return aa(ot.id,{grade_scale_id:tt}).then(function(at){Et.b[at.success?"success":"error"](at.message),a.f.push("/teacher/subjects/".concat(v,"/final-grades"))}),Je.abrupt("return");case 7:ta({grade_scale_id:tt,grade_term_id:lt,lesson_group_user_id:D.data.id}).then(function(at){Et.b[at.success?"success":"error"](at.message),a.f.push("/teacher/subjects/".concat(v,"/final-grades"))});case 8:case"end":return Je.stop()}},ve)}));return function(ve){return I.apply(this,arguments)}}(),[D.data,v]),Be=Object(u.useMemo)(function(){var I;return((I=L.data)!==null&&I!==void 0?I:[]).map(function(ve){var de;return Object(c.a)(Object(c.a)({},ve),{},{grade:(de=D.data)===null||de===void 0?void 0:de.grades.find(function(Ue){var Fe=Ue.grade_term;return Fe.id===ve.id})})})},[D.data,L.data]);return D.loading?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[D.data&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Q.a.Text,{style:{fontSize:"16px",fontWeight:500},children:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Student",values:D.data.user})}),Object(e.jsx)(yt.a,{})]}),Object(e.jsxs)(Qe.a,{gutter:[48,48],justify:"space-between",children:[Object(e.jsx)(He.a,{span:12,children:Object(e.jsx)(ae.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.StudentPartialGrades"}),search:!1,pagination:{pageSize:St},dataSource:y.data,loading:y.loading,columns:Sa,options:!1,cardProps:{bodyStyle:{padding:0}}})}),Object(e.jsx)(He.a,{span:12,children:Object(e.jsx)(ae.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.FinalGrades"}),search:!1,pagination:{pageSize:St},dataSource:Be,loading:D.loading||L.loading,columns:Ta,options:!1,cardProps:{bodyStyle:{padding:0}}})}),Object(e.jsx)(He.a,{span:12,children:Object(e.jsx)(ae.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Attendances"}),search:!1,options:!1,pagination:{pageSize:St},cardProps:{bodyStyle:{padding:0}},dataSource:_.data,loading:_.loading,columns:[].concat(Ea,[{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Attendance"}),dataIndex:"attendance",render:function(ve,de){return Object(e.jsx)(Bt.a,{onChange:function(Fe){return H(de.id,Fe.target.checked?z.a.PRESENT:z.a.ABSENT)},checked:de.attendance.value===z.a.PRESENT})}}])})}),Object(e.jsx)(He.a,{span:12,children:Object(e.jsx)(ae.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.GradesScale"}),search:!1,options:!1,pagination:{pageSize:St},cardProps:{bodyStyle:{padding:0}},dataSource:V.data,loading:V.loading,columns:xa})}),W.loading&&!W.data||le.loading&&!le.data||B.loading&&!B.data&&Object(e.jsx)(P.a,{}),W.data&&le.data&&B.data&&W.data.map(function(I){var ve,de,Ue,Fe,tt,lt,ot,jt,Je=I.id,at=I.title;return Object(e.jsxs)(He.a,{span:24,children:[Object(e.jsx)(Q.a.Text,{style:{fontSize:"16px",fontWeight:500},children:at}),Object(e.jsx)(Wt.c,{topics:(ve=(de=B.data)===null||de===void 0?void 0:de[Number(Je)])!==null&&ve!==void 0?ve:[],stats:(Ue=(Fe=le.data)===null||Fe===void 0||(tt=Fe[Number(Je)])===null||tt===void 0?void 0:tt.finishedTopics)!==null&&Ue!==void 0?Ue:[]}),Object(e.jsx)(Wt.a,{stats:(lt=(ot=le.data)===null||ot===void 0||(jt=ot[Number(Je)])===null||jt===void 0?void 0:jt.attendanceList)!==null&&lt!==void 0?lt:[]})]},Je)})]}),Object(e.jsx)(ie.a,{form:ue,onFinish:te,children:Object(e.jsxs)(ie.a.Group,{style:{display:"flex",flexDirection:"column",paddingTop:"48px"},title:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.IssueAssessment"}),titleStyle:{flex:"unset"},align:"center",children:[Object(e.jsx)(Nt.a,{name:"grade_term_id",rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],label:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.GradeTerm"}),options:re,width:"sm",fieldProps:{loading:L.loading}}),Object(e.jsx)(Nt.a,{name:"grade_scale_id",rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],label:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.FinalGrade"}),options:Oe,fieldProps:{loading:D.loading||Y.loading}}),Object(e.jsx)(ie.a.Item,{children:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.ProposedGrade",values:{grade:X}})})]})})]})},Ca=["grades"],Ma=[{title:Object(e.jsx)(a.a,{id:"group"}),dataIndex:"group_id",render:function(i,r){return Object(e.jsx)(oa.a,{type:"Students",type_id:r.group_id},r.group_id)}},{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"user",render:function(i,r){return r.user.first_name}},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"user",render:function(i,r){return r.user.last_name}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grades",render:function(i,r){return Object(e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:r.grades.length?r.grades.map(function(s){var n=s.grade_name,d=s.grade_term,b=s.id;return Object(e.jsxs)(Q.a.Text,{children:[d.name,": ",n]},b)}):"-"})}}],Pa=function(){var i,r,s,n=Object(l.k)(),d=Object(u.useMemo)(function(){var H,G,W,le;return{user_id:Number.isNaN(Number((H=n.query)===null||H===void 0?void 0:H.user_id))?null:Number((G=n.query)===null||G===void 0?void 0:G.user_id),group_id:Number.isNaN(Number((W=n.query)===null||W===void 0?void 0:W.group_id))?null:Number((le=n.query)===null||le===void 0?void 0:le.group_id)}},[(i=n.query)===null||i===void 0?void 0:i.user_id,(r=n.query)===null||r===void 0?void 0:r.group_id]),b=d.user_id,v=d.group_id,T=Object(q.b)(),y=T.teacherSubjectData,C=T.semester_subject_id,D=Object(u.useState)({loading:!1}),A=Object(w.a)(D,2),L=A[0],M=A[1],Y=Object(u.useState)([Number(y==null||(s=y.groups)===null||s===void 0?void 0:s[0].id)]),x=Object(w.a)(Y,2),V=x[0],he=x[1],_=Object(u.useMemo)(function(){var H;return((H=y==null?void 0:y.groups)!==null&&H!==void 0?H:[]).map(function(G){var W=G.id,le=G.name;return{label:le,value:W}})},[y==null?void 0:y.groups]);return Object(u.useEffect)(function(){if(typeof b!="number"){if(!V.length){M({loading:!1});return}M(function(H){return Object(c.a)(Object(c.a)({},H),{},{loading:!0})}),Xt(V).then(function(H){if(H.success){var G=H.data.map(function(W){var le=W.grades,B=Object(Ut.a)(W,Ca);return Object(c.a)(Object(c.a)({},B),{},{grades:le.sort(function(Se,Ae){return new Date(Ae.grade_date).getTime()-new Date(Se.grade_date).getTime()})})});M(function(W){return Object(c.a)(Object(c.a)({},W),{},{dataSource:G})})}}).finally(function(){M(function(H){return Object(c.a)(Object(c.a)({},H),{},{loading:!1})})})}},[V,b]),b!==null&&v!==null?Object(e.jsx)(ya,{user_id:b,group_id:v}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(ie.a.Item,{label:Object(e.jsx)(a.a,{id:"group"}),children:Object(e.jsx)(Ve.a,{allowClear:!0,mode:"multiple",options:_,value:V,onChange:function(G){return he(G)}})}),Object(e.jsx)(yt.a,{}),Object(e.jsx)(ae.a,{rowKey:"id",search:!1,loading:L.loading,dataSource:L.dataSource,columns:[].concat(Ma,[{title:Object(e.jsx)(a.a,{id:"options"}),render:function(G,W){return[Object(e.jsx)(Ie.a,{to:"/teacher/subjects/".concat(C,"/final-grades?user_id=").concat(W.user.id,"&group_id=").concat(W.group_id),children:Object(e.jsx)(We.a,{title:Object(e.jsx)(a.a,{id:"edit"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(ke.a,{})})})},"edit")]}}])})]})},Da=function(i){var r,s,n=i.tab,d=Object(a.l)(),b=Object(a.m)("@@initialState"),v=b.setInitialState,T=b.initialState,y=Object(q.b)(),C=y.teacherSubjectData,D=y.semester_subject_id,A=y.tutors,L=Object(u.useCallback)(Object(ge.a)(T==null?void 0:T.currentUser),[T==null?void 0:T.currentUser]),M=Object(u.useMemo)(function(){return!!A.data.find(function(Y){var x,V=Y.id;return V===(T==null||(x=T.currentUser)===null||x===void 0?void 0:x.id)})||L(me.a.TeacherListGradeScale)},[]);return C?Object(e.jsx)(se.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(a.a,{id:C==null||(r=C.subject)===null||r===void 0?void 0:r.name}),", ",Object(e.jsx)(a.a,{id:n})]}),tabBarExtraContent:Object(e.jsxs)("div",{style:{display:"flex",padding:"12px",gap:"12px"},children:[Object(e.jsx)($.a,{type:"primary",onClick:function(){return console.log("MSTeams")},children:Object(e.jsx)(a.a,{id:"msTeams",defaultMessage:"msTeams"})}),Object(e.jsx)(Ie.a,{to:"/teacher/subjects/".concat(D,"/exams?exam_id=new"),children:Object(e.jsx)($.a,{type:"primary",children:Object(e.jsx)(a.a,{id:"uploadGrades",defaultMessage:"uploadGrades"})})})]}),header:{breadcrumb:{routes:[{path:"teacher",breadcrumbName:d.formatMessage({id:"Teacher"})},{path:"subjects",breadcrumbName:d.formatMessage({id:"Subjects"})},{path:String(D),breadcrumbName:String((s=C.subject)===null||s===void 0?void 0:s.name)},{path:String(n),breadcrumbName:d.formatMessage({id:n,defaultMessage:String(n)})}]}},children:Object(e.jsxs)(je.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",activeKey:n,onChange:function(x){v(Object(c.a)({},T)),a.f.push("/teacher/subjects/".concat(D,"/").concat(x))}},children:[Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"groups"}),children:Object(e.jsx)(_e.b,{})},"groups"),Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"students"}),children:Object(e.jsx)(ht,{})},"students"),Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"exams"}),children:Object(e.jsx)(be,{})},"exams"),Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"schedule"}),children:Object(e.jsx)(da,{})},"schedule"),Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"attendance"}),children:Object(e.jsx)(zt,{})},"attendance"),M&&Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"grades-scale"}),children:Object(e.jsx)(ra,{})},"grades-scale"),Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"final-grades"}),children:Object(e.jsx)(Pa,{})},"final-grades")]})}):Object(e.jsx)(P.a,{})},Ka=oe.default=function(){var o=Object(l.l)(),i=o.subjectId,r=o.tab,s=r===void 0?"groups":r;return Object(e.jsx)(q.a,{semester_subject_id:Number(i),children:Object(e.jsx)(Da,{tab:s})})}},p3I6:function(Ke,oe,t){"use strict";t.d(oe,"b",function(){return q}),t.d(oe,"c",function(){return pe}),t.d(oe,"a",function(){return dt});var c=t("miYZ"),F=t("tsqr"),$=t("tJVT"),f=t("k1fw"),P=t("oBTY"),u=t("q1tI"),je=t.n(u),a=t("9kvl"),Ie=t("Ty5D"),l=t("H6aw"),se=t("/y+f"),me=t("nKUr"),ge=t.n(me),q=je.a.createContext({}),_e=function(){return Math.round(Math.random()*99999)},Xe=function ae(k){return k.reduce(function(J,m){return[].concat(Object(P.a)(J),Object(P.a)(m.lessons?ae(m.lessons):[]),[m])},[])},pe=function ae(k){return k.reduce(function(J,m){var Z;return[].concat(Object(P.a)(J),Object(P.a)(m.lessons?ae(m.lessons):[]),Object(P.a)((Z=m.topics)!==null&&Z!==void 0?Z:[]))},[])},Ne=function ae(k,J,m){return k.map(function(Z){var xe,E;return Object(f.a)(Object(f.a)({},Z),{},{lessons:Z.lessons?ae(Z.lessons,J,m):[],topics:Z.id===J?[].concat(Object(P.a)((xe=Z.topics)!==null&&xe!==void 0?xe:[]),[m]):(E=Z.topics)!==null&&E!==void 0?E:[]})})},We=function ae(k,J,m){return k.map(function(Z){var xe,E,j;return Object(f.a)(Object(f.a)({},Z),{},{lessons:ae((xe=Z.lessons)!==null&&xe!==void 0?xe:[],J,m),topics:(E=(j=Z.topics)===null||j===void 0?void 0:j.map(function(Ee){return Ee.id===J?m:Ee}))!==null&&E!==void 0?E:[]})})},h=function ae(k,J,m){return m?k.map(function(Z){return Object(f.a)(Object(f.a)({},Z),{},{lessons:[].concat(Object(P.a)(Z.lessons?ae(Z.lessons,J,m):[]),Object(P.a)(Z.id===m?[J]:[]))})}):[].concat(Object(P.a)(k),[J])},O=function ae(k,J,m){return k.map(function(Z){return Object(f.a)(Object(f.a)({},Z.id===J?m:Z),{},{lessons:Z.lessons?ae(Z.lessons,J,m):[]})})},ze=function ae(k,J){return k.map(function(m){return Object(f.a)(Object(f.a)({},m),{},{parent_id:J,lessons:m.lessons?ae(m.lessons,m.id):[]})})},ke=function ae(k,J){return k.filter(function(m){return m.id!==J}).map(function(m){return Object(f.a)(Object(f.a)({},m),{},{lessons:m.lessons?ae(m.lessons,J):[]})})},we=function ae(k,J){return k.map(function(m){return Object(f.a)(Object(f.a)({},m),{},{lessons:m.lessons?ae(m.lessons,J):[],topics:m.topics?m.topics.filter(function(Z){return Z.id!==J}):[]})})},dt=function(k){var J=k.children,m=k.id,Z=Object(u.useState)(),xe=Object($.a)(Z,2),E=xe[0],j=xe[1],Ee=Object(a.l)(),ye=Object(u.useMemo)(function(){return E&&E.lessons?pe(E.lessons):[]},[E]),Ce=Object(u.useMemo)(function(){return E&&E.lessons?Xe(E.lessons):[]},[E]),Te=Object(u.useState)([]),Re=Object($.a)(Te,2),Le=Re[0],ce=Re[1],N=Object(Ie.k)();Object(u.useEffect)(function(){ce([])},[]);var Ge=Object(u.useCallback)(function(){Object(l.m)(m).then(function(e){return e.success&&j(Object(f.a)(Object(f.a)({},e.data),{},{lessons:ze(e.data.lessons)}))})},[m]);Object(u.useEffect)(function(){Ge()},[Ge]);var $e=Object(u.useCallback)(function(e){var R=Ce.find(function(S){var g;return S==null||(g=S.topics)===null||g===void 0?void 0:g.find(function(p){return p.id===e})});return R?R.id:null},[Ce]),w=Object(u.useMemo)(function(){var e,R;return(e=N.query)!==null&&e!==void 0&&e.lesson?{mode:"lesson",id:Number(N.query.lesson),value:Ce.find(function(S){return S.id===Number(N.query.lesson)})}:(R=N.query)!==null&&R!==void 0&&R.topic?{mode:"topic",id:Number(N.query.topic),value:ye.find(function(S){return S.id===Number(N.query.topic)})}:{mode:"init"}},[N.query,E,Ce,ye]),it=Object(u.useCallback)(function(e){var R={course_id:m,topics:[],isNew:!0,id:E?E.lessons.length+1:_e(),order:0,title:Ee.formatMessage({id:"add_title_here"}),active:!0,parent_id:e};return j(function(S){var g;return Object(f.a)(Object(f.a)({},S),{},{lessons:h((g=S==null?void 0:S.lessons)!==null&&g!==void 0?g:[],R,e)})}),R},[m,E]),Qe=Object(u.useCallback)(function(e,R){var S=Ce.find(function(p){return p.id===e}),g=S&&S.isNew;return(g?Object(l.g)(R):Object(l.u)(e,R)).then(function(p){return F.b.success(p.message),Ge(),p.success&&j(function(U){var K;return Object(f.a)(Object(f.a)({},U),{},{lessons:O((K=U==null?void 0:U.lessons)!==null&&K!==void 0?K:[],e,Object(f.a)(Object(f.a)({},p.data),{},{isNew:!1}))})})})},[E]),qe=Object(u.useCallback)(function(e){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,S=(E==null?void 0:E.lessons.findIndex(function(K){return K.id===e}))||0,g=R?S-1:S+1,p=E==null?void 0:E.lessons.map(function(K,Me,ut){var Ze=Me==S?ut[g]:Me==g?ut[S]:K;return Object(f.a)(Object(f.a)({},Ze),{},{order:Me})});j(function(K){return Object(f.a)(Object(f.a)({},K),{},{lessons:p||[]})});var U=p==null?void 0:p.filter(function(K){return!K.isNew}).map(function(K){return[K.id,K.order]});Object(l.s)({class:"Lesson",orders:U,course_id:m}).then(function(K){K.success&&F.b.success(K.message)})},[E,m]),He=Object(u.useCallback)(function(e,R){var S,g,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,U=Ce.find(function(Ze){return Ze.id===e}),K=U==null||(S=U.topics)===null||S===void 0?void 0:S.findIndex(function(Ze){return Ze.id===R});if(!(K===void 0||K===-1)){var Me=p?K-1:K+1,ut=(U==null||(g=U.topics)===null||g===void 0?void 0:g.map(function(Ze,be,ee){var ne=be==K?ee[Me]:be==Me?ee[K]:Ze;return Object(f.a)(Object(f.a)({},ne),{},{order:be})}))||[];j(function(Ze){return Object(f.a)(Object(f.a)({},Ze),{},{lessons:Ze?Ze.lessons.map(function(be){return be.id===e?Object(f.a)(Object(f.a)({},be),{},{topics:ut}):be}):[]})})}},[E]),ie=Object(u.useCallback)(function(e){var R,S=Ce.find(function(p){return p.id===e}),g=S==null||(R=S.topics)===null||R===void 0?void 0:R.filter(function(p){return!p.isNew}).map(function(p){return[p.id,p.order]});Object(l.s)({class:"Topic",orders:g,course_id:m}).then(function(p){p.success&&F.b.success(p.message)})},[E,m]),Ot=Object(u.useCallback)(function(e,R){j(function(g){return Object(f.a)(Object(f.a)({},g),{},{lessons:g?g.lessons.map(function(p){return p.id===e?Object(f.a)(Object(f.a)({},p),{},{topics:R}):p}):[]})});var S=R.map(function(g){return[g.id,g.order]});Object(l.s)({class:"Topic",orders:S,course_id:m}).then(function(g){g.success&&F.b.success(g.message)})},[E]),ft=Object(u.useCallback)(function(e){var R=Ce.find(function(g){return g.id===e});if(!!R){var S=R.isNew;S?j(function(g){var p;return Object(f.a)(Object(f.a)({},g),{},{lessons:ke((p=g==null?void 0:g.lessons)!==null&&p!==void 0?p:[],e)})}):Object(l.o)(e).then(function(g){g.success&&(F.b.success(g.message),j(function(p){var U;return Object(f.a)(Object(f.a)({},p),{},{lessons:ke((U=p==null?void 0:p.lessons)!==null&&U!==void 0?U:[],e)})}))})}},[E]),z=Object(u.useCallback)(function(e,R){var S,g=$e(e),p=Ce.find(function(Me){return Me.id===g}),U=p&&((S=p.topics)===null||S===void 0?void 0:S.find(function(Me){return Me.id===e})),K=U==null?void 0:U.isNew;return(K?Object(l.h)(R):Object(l.v)(e,R)).then(function(Me){Me.success&&(F.b.success(Me.message),Ge(),a.f.push("/courses/list/".concat(m,"/program/?topic=").concat(Me.data.id)),(U==null?void 0:U.topicable_type)===se.f.Video&&setTimeout(function(){Ge()},5e3))})},[$e,E,Ge]),xt=Object(u.useCallback)(function(e){var R=$e(e),S=Ce.find(function(U){return U.id===R});if(!!S){var g=ye==null?void 0:ye.find(function(U){return U.id===e}),p=g==null?void 0:g.isNew;p&&!g.topicable?j(function(U){var K;return Object(f.a)(Object(f.a)({},U),{},{lessons:we((K=U==null?void 0:U.lessons)!==null&&K!==void 0?K:[],e)})}):Object(l.p)(e).then(function(U){U.success&&(F.b.success(U.message),j(function(K){var Me;return Object(f.a)(Object(f.a)({},K),{},{lessons:we((Me=K==null?void 0:K.lessons)!==null&&Me!==void 0?Me:[],e)})}))})}},[E,$e]),et=Object(u.useCallback)(function(e,R){var S={lesson_id:e,isNew:!0,id:_e(),title:Ee.formatMessage({id:"add_title_here"}),active:!0,topicable_type:R};return j(function(g){var p;return Object(f.a)(Object(f.a)({},g),{},{lessons:Ne((p=g==null?void 0:g.lessons)!==null&&p!==void 0?p:[],e,S)})}),S},[]),vt=function(R,S){j(function(g){var p;return Object(f.a)(Object(f.a)({},g),{},{lessons:We((p=g==null?void 0:g.lessons)!==null&&p!==void 0?p:[],R,S.file.response.data)})}),a.f.push("/courses/list/".concat(m,"/program/?topic=").concat(S.file.response.data.id))},Ve=Object(u.useCallback)(function(e){return Object(l.d)(e).then(function(R){if(R.success){F.b.success(R.message);var S=$e(e);j(function(g){var p;return Object(f.a)(Object(f.a)({},g),{},{lessons:g?(p=g.lessons)===null||p===void 0?void 0:p.map(function(U){if(U.id===S){var K=U.topics||[];return Object(f.a)(Object(f.a)({},U),{},{topics:[].concat(Object(P.a)(K),[R.data])})}return U}):[]})})}})},[E,$e]),Ye=Object(u.useCallback)(function(e){return Object(l.c)(e).then(function(R){R.success&&(F.b.success(R.message),j(function(S){return Object(f.a)(Object(f.a)({},S),{},{lessons:S?[].concat(Object(P.a)(S.lessons),[R.data]):[]})}))})},[]),bt={state:E,h5ps:Le,id:m,addNewLesson:it,updateLesson:Qe,updateTopic:z,deleteLesson:ft,sortLesson:qe,addNewTopic:et,deleteTopic:xt,sortTopic:He,sortTopics:Ot,updateTopicsOrder:ie,onTopicUploaded:vt,cloneTopic:Ve,cloneLesson:Ye,currentEditMode:w,getLessons:Ge};return Object(me.jsx)(q.Provider,{value:bt,children:J})}},quyA:function(Ke,oe){var t="\\ud800-\\udfff",c="\\u0300-\\u036f",F="\\ufe20-\\ufe2f",$="\\u20d0-\\u20ff",f=c+F+$,P="\\ufe0e\\ufe0f",u="\\u200d",je=RegExp("["+u+t+f+P+"]");function a(Ie){return je.test(Ie)}Ke.exports=a},wy8a:function(Ke,oe,t){var c=t("KxBF");function F($,f,P){var u=$.length;return P=P===void 0?u:P,!f&&P>=u?$:c($,f,P)}Ke.exports=F}}]);
