(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{"/y+f":function(Fe,de,t){"use strict";t.d(de,"f",function(){return c}),t.d(de,"d",function(){return f}),t.d(de,"e",function(){return P}),t.d(de,"c",function(){return oe}),t.d(de,"a",function(){return a}),t.d(de,"b",function(){return Ae});var c;(function(l){l.Unselected="",l.RichText="EscolaLms\\TopicTypes\\Models\\TopicContent\\RichText",l.OEmbed="EscolaLms\\TopicTypes\\Models\\TopicContent\\OEmbed",l.Audio="EscolaLms\\TopicTypes\\Models\\TopicContent\\Audio",l.Video="EscolaLms\\TopicTypes\\Models\\TopicContent\\Video",l.H5P="EscolaLms\\TopicTypes\\Models\\TopicContent\\H5P",l.Image="EscolaLms\\TopicTypes\\Models\\TopicContent\\Image",l.PDF="EscolaLms\\TopicTypes\\Models\\TopicContent\\PDF",l.SCORM="EscolaLms\\TopicTypes\\Models\\TopicContent\\ScormSco",l.Project="EscolaLms\\TopicTypeProject\\Models\\Project",l.GiftQuiz="EscolaLms\\TopicTypeGift\\Models\\GiftQuiz"})(c||(c={}));var K;(function(l){l.OrderPaid="EscolaLms\\Cart\\Events\\OrderPaid",l.UserLogged="EscolaLms\\Auth\\Events\\UserLogged"})(K||(K={}));var $;(function(l){l.draft="draft",l.published="published",l.archived="archived"})($||($={}));var f;(function(l){l.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",l.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",l.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel"})(f||(f={}));var P;(function(l){l.ManuallyTriggeredEvent="EscolaLms\\Templates\\Events\\ManuallyTriggeredEvent"})(P||(P={}));var u;(function(l){l.cart_fixed="cart_fixed",l.cart_percent="cart_percent",l.product_fixed="product_fixed",l.product_percent="product_percent"})(u||(u={}));var oe;(function(l){l.MULTIPLE_CHOICE="multiple_choice",l.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS="multiple_choice_with_multiple_right_answers",l.TRUE_FALSE="true_false",l.SHORT_ANSWERS="short_answers",l.MATCHING="matching",l.NUMERICAL_QUESTION="numerical_question",l.ESSAY="essay",l.DESCRIPTION="description"})(oe||(oe={}));var a;(function(l){l.PRESENT="present",l.ABSENT="absent"})(a||(a={}));var Ae;(function(l){l.Manual="manual",l.TeamsForms="teams_forms",l.TeamsLecture="teams_lecture",l.TestPortal="test_portal"})(Ae||(Ae={}))},"0JQy":function(Fe,de){var t="\\ud800-\\udfff",c="\\u0300-\\u036f",K="\\ufe20-\\ufe2f",$="\\u20d0-\\u20ff",f=c+K+$,P="\\ufe0e\\ufe0f",u="["+t+"]",oe="["+f+"]",a="\\ud83c[\\udffb-\\udfff]",Ae="(?:"+oe+"|"+a+")",l="[^"+t+"]",re="(?:\\ud83c[\\udde6-\\uddff]){2}",he="[\\ud800-\\udbff][\\udc00-\\udfff]",xe="\\u200d",q=Ae+"?",_e="["+P+"]?",Xe="(?:"+xe+"(?:"+[l,re,he].join("|")+")"+_e+q+")*",ge=_e+q+Xe,$e="(?:"+[l+oe+"?",oe,re,he,u].join("|")+")",Ne=RegExp(a+"(?="+a+")|"+$e+ge,"g");function v(O){return O.match(Ne)||[]}Fe.exports=v},"5R/X":function(Fe,de,t){},"5Syx":function(Fe,de,t){"use strict";t.d(de,"c",function(){return He}),t.d(de,"b",function(){return pe}),t.d(de,"a",function(){return te});var c=t("OaEy"),K=t("2fM7"),$=t("g9YV"),f=t("wCAj"),P=t("BoS7"),u=t("Sdc0"),oe=t("jrin"),a=t("k1fw"),Ae=t("DYRE"),l=t("zeV3"),re=t("+BJd"),he=t("mr32"),xe=t("oBTY"),q=t("tJVT"),_e=t("q1tI"),Xe=t.n(_e),ge=t("9kvl"),$e=t("Vpfc"),Ne=t("jsgi"),v=t("nhC9"),O=t("nKUr"),Ve=t.n(O),ke=function(h){return h.topicable.content.contents?Object.values(h.topicable.content.contents)[0].library:"H5P"},He=function(h){var w=h.topics,Be=h.stats,U=Object(_e.useState)(!1),se=Object(q.a)(U,2),b=se[0],Ee=se[1],ve=Object(_e.useMemo)(function(){return[{title:Object(O.jsx)(ge.a,{id:"user"}),dataIndex:"id",render:function(Le){return Object(O.jsx)($e.a,{type:"App\\Models\\User",type_id:Le})}},{title:Object(O.jsx)(ge.a,{id:"email"}),dataIndex:"email"}].concat(Object(xe.a)(w.map(function(Se){var Le,Ie=(Le=Se.topicable_type)===null||Le===void 0?void 0:Le.split("\\").pop();return Ie==="H5P"&&(Ie=ke(Se)),{render:function(F){var Re=0,Qe=0;switch(F&&(F.started_at&&F.finished_at?Re=1:F.started_at&&(Re=2),Qe=F.seconds/60),Re){case 1:return Object(O.jsxs)(l.b,{children:[Object(O.jsx)(he.a,{color:"success",children:"F"}),b&&Object(O.jsxs)("small",{children:[Qe.toFixed(2),"m"]})]});case 2:return Object(O.jsxs)(l.b,{children:[Object(O.jsx)(he.a,{color:"blue",children:"S"}),b&&Object(O.jsxs)("small",{children:[Qe.toFixed(2),"m"]})]});case 0:default:return Object(O.jsx)(Xe.a.Fragment,{children:Object(O.jsx)(he.a,{color:"error",children:"N"})})}},title:Object(O.jsxs)("small",{children:[Object(O.jsx)(he.a,{children:Ie})," ",Se.title]}),dataIndex:Se.id}})))},[w,b]),Ze=Object(_e.useMemo)(function(){return Be.map(function(Se){return w.reduce(function(Le,Ie){var Z=Se.topics.find(function(F){return F.id===Ie.id});return Object(a.a)(Object(a.a)({},Le),{},Object(oe.a)({},Number(Ie.id),Z!=null?Z:0))},{email:Se.email,id:Se.id})})},[Be,w]);return Object(O.jsx)(f.a,{title:function(){return Object(O.jsxs)(l.b,{children:[Object(O.jsx)(ge.a,{id:"Finished",defaultMessage:"Finished:"})," ",Object(O.jsx)(he.a,{color:"success",children:"F"}),Object(O.jsx)(ge.a,{id:"Started",defaultMessage:"Started:"})," ",Object(O.jsx)(he.a,{color:"blue",children:"S"}),Object(O.jsx)(ge.a,{id:"NotStarted",defaultMessage:"Not Started:"})," ",Object(O.jsx)(he.a,{color:"error",children:"N"}),Object(O.jsx)(ge.a,{id:"ShowMinutes",defaultMessage:"Show minutes spent on topic:"})," ",Object(O.jsx)(u.a,{checked:b,onChange:function(Ie){return Ee(Ie)}})]})},columns:ve,dataSource:Ze,size:"small",scroll:{x:1500}})},pe=function(h){var w=h.stats,Be=Object(_e.useMemo)(function(){return[{title:"user",dataIndex:"id",render:function(b){return Object(O.jsx)($e.a,{type:"App\\Models\\User",type_id:b})}},{title:"email",dataIndex:"email"},{title:Object(O.jsx)(ge.a,{id:"finished_at",defaultMessage:"Finished at"}),dataIndex:"finished_at"}]},[]),U=Object(_e.useMemo)(function(){return w.map(function(se){var b=se.id,Ee=se.email,ve=se.finished_at;return{id:b,email:Ee,finished_at:ve}})},[w]);return Object(O.jsx)(f.a,{title:function(){return Object(O.jsx)(l.b,{children:Object(O.jsx)(ge.a,{id:"course.finished",defaultMessage:"Finished"})})},columns:Be,dataSource:U,size:"small",scroll:{x:500}})},te=function(h){var w=h.stats,Be=Object(_e.useState)(null),U=Object(q.a)(Be,2),se=U[0],b=U[1],Ee=Object(_e.useState)(null),ve=Object(q.a)(Ee,2),Ze=ve[0],Se=ve[1],Le=Object(_e.useMemo)(function(){return w.map(function(Z){return Object.values(Z.attempts).flatMap(function(F){var Re=F.dates,Qe=F.attempt,N=Object.values(Re)[0],dt=N.date,Ye=N.times;return{date:dt,attempt:Qe,times:Ye.length,email:Z.email}})})},[w]),Ie={xField:"date",yField:"times",seriesField:"attempt",isStack:!0,xAxis:{label:{autoHide:!0,autoRotate:!1}},slider:{start:0,end:1},label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]}};return Object(O.jsx)(v.a,{colSpan:12,layout:"center",children:Object(O.jsx)(Ne.a,{config:Ie,title:Object(O.jsxs)(l.b,{children:[Object(O.jsx)(ge.a,{id:"course.interactions_in_days"}),Object(O.jsx)(K.a,{showSearch:!0,value:se,onChange:function(F){b(F),Se(null)},placeholder:Object(O.jsx)(ge.a,{id:"select_person",defaultMessage:"Select a person"}),children:w.map(function(Z){var F=Z.id,Re=Z.email;return Object(O.jsx)(K.a.Option,{value:Re,children:Re},F)})}),Object(O.jsx)(K.a,{value:Ze,onChange:function(F){return Se(F)},disabled:se===null,placeholder:Object(O.jsx)(ge.a,{id:"select_attempt",defaultMessage:"Select attempt"}),children:Le.flatMap(function(Z){return Z}).filter(function(Z){var F=Z.email;return F===se}).map(function(Z){var F=Z.attempt;return Object(O.jsxs)(K.a.Option,{value:F,children:[Object(O.jsx)(ge.a,{id:"attempt",defaultMessage:"Attempt"})," ",F]},F)})})]}),value:Le.flatMap(function(Z){return Z}).filter(function(Z){var F=Z.email;return F===se}).filter(function(Z){var F=Z.attempt;return Number.isInteger(Ze)?F===Ze:!0})})})}},Em2t:function(Fe,de,t){var c=t("bahg"),K=t("quyA"),$=t("0JQy");function f(P){return K(P)?$(P):c(P)}Fe.exports=f},Hn4i:function(Fe,de,t){"use strict";var c=t("y8nQ"),K=t("Vl3Y"),$=t("+L6B"),f=t("2/Rp"),P=t("rePB"),u=t("ODXe"),oe=t("Ff2n"),a=t("x+uP"),Ae=t("HaE+"),l=t("VTBJ"),re=t("nKUr"),he=t.n(re),xe=t("xvlK"),q=t("WuYN"),_e=t("VMEa"),Xe=t("LQCs"),ge=t("ft2k"),$e=t("uX+g"),Ne=t("+i8S"),v=t("ipCM"),O=t("6cGi"),Ve=t("ub+h"),ke=t("bG1m"),He=t("q1tI"),pe=t.n(He),te=t("mWMg"),k=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],h=["record","position","creatorButtonText","newRecordType","parentKey","style"],w=pe.a.createContext(void 0);function Be(b){var Ee=b.children,ve=b.record,Ze=b.position,Se=b.newRecordType,Le=b.parentKey,Ie=Object(He.useContext)(w);return pe.a.cloneElement(Ee,Object(l.a)(Object(l.a)({},Ee.props),{},{onClick:function(){var Z=Object(Ae.a)(Object(a.a)().mark(function Re(Qe){var N,dt,Ye,ut;return Object(a.a)().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.next=2,(N=(dt=Ee.props).onClick)===null||N===void 0?void 0:N.call(dt,Qe);case 2:if(ut=ce.sent,ut!==!1){ce.next=5;break}return ce.abrupt("return");case 5:Ie==null||(Ye=Ie.current)===null||Ye===void 0||Ye.addEditRecord(ve,{position:Ze,newRecordType:Se,parentKey:Le});case 6:case"end":return ce.stop()}},Re)}));function F(Re){return Z.apply(this,arguments)}return F}()}))}function U(b){var Ee,ve,Ze=Object(Xe.d)(),Se=b.onTableChange,Le=b.maxLength,Ie=b.formItemProps,Z=b.recordCreatorProps,F=b.rowKey,Re=b.controlled,Qe=b.defaultValue,N=b.onChange,dt=b.editableFormRef,Ye=Object(oe.a)(b,k),ut=Object(ge.a)(b.value),Je=Object(He.useRef)(),ce=Object(He.useRef)();Object(He.useImperativeHandle)(Ye.actionRef,function(){return Je.current});var bt=Object(O.a)(function(){return b.value||Qe||[]},{value:b.value,onChange:b.onChange}),jt=Object(u.a)(bt,2),J=jt[0],_t=jt[1],qe=pe.a.useMemo(function(){return typeof F=="function"?F:function(Te,ae){return Te[F]||ae}},[F]),ft=function(ae){if(typeof ae=="number"&&!b.name){if(ae>=J.length)return ae;var ue=J&&J[ae];return qe==null?void 0:qe(ue,ae)}if((typeof ae=="string"||ae>=J.length)&&b.name){var fe=J.findIndex(function(Q,Me){var Pe;return(qe==null||(Pe=qe(Q,Me))===null||Pe===void 0?void 0:Pe.toString())===(ae==null?void 0:ae.toString())});return fe}return ae};Object(He.useImperativeHandle)(dt,function(){var Te=function(fe){var Q,Me;if(fe==null)throw new Error("rowIndex is required");var Pe=ft(fe),rt=[b.name,(Q=Pe==null?void 0:Pe.toString())!==null&&Q!==void 0?Q:""].flat(1).filter(Boolean);return(Me=ce.current)===null||Me===void 0?void 0:Me.getFieldValue(rt)},ae=function(){var fe,Q=[b.name].flat(1).filter(Boolean);if(Array.isArray(Q)&&Q.length===0){var Me,Pe=(Me=ce.current)===null||Me===void 0?void 0:Me.getFieldsValue();return Array.isArray(Pe)?Pe:Object.keys(Pe).map(function(rt){return Pe[rt]})}return(fe=ce.current)===null||fe===void 0?void 0:fe.getFieldValue(Q)};return Object(l.a)(Object(l.a)({},ce.current),{},{getRowData:Te,getRowsData:ae,setRowData:function(fe,Q){var Me,Pe,rt,Ot;if(fe==null)throw new Error("rowIndex is required");var mt=ft(fe),vt=[b.name,(Me=mt==null?void 0:mt.toString())!==null&&Me!==void 0?Me:""].flat(1).filter(Boolean),ht=((Pe=ce.current)===null||Pe===void 0||(rt=Pe.getFieldsValue)===null||rt===void 0?void 0:rt.call(Pe))||{},gt=Object(ke.a)(ht,vt,Object(l.a)(Object(l.a)({},Te(fe)),Q||{}));return(Ot=ce.current)===null||Ot===void 0?void 0:Ot.setFieldsValue(gt)}})}),Object(He.useEffect)(function(){!b.controlled||J.forEach(function(Te,ae){var ue;(ue=ce.current)===null||ue===void 0||ue.setFieldsValue(Object(P.a)({},qe(Te,ae),Te))},{})},[J,b.controlled]),Object(He.useEffect)(function(){if(b.name){var Te;ce.current=b==null||(Te=b.editable)===null||Te===void 0?void 0:Te.form}},[(Ee=b.editable)===null||Ee===void 0?void 0:Ee.form,b.name]);var We=Z||{},ze=We.record,_=We.position,e=We.creatorButtonText,S=We.newRecordType,p=We.parentKey,x=We.style,R=Object(oe.a)(We,h),L=_==="top",je=Object(He.useMemo)(function(){return Le&&Le<=(J==null?void 0:J.length)?!1:Z!==!1&&Object(re.jsx)(Be,{record:Object($e.a)(ze,J==null?void 0:J.length,J)||{},position:_,parentKey:Object($e.a)(p,J==null?void 0:J.length,J),newRecordType:S,children:Object(re.jsx)(f.a,Object(l.a)(Object(l.a)({type:"dashed",style:Object(l.a)({display:"block",margin:"10px 0",width:"100%"},x),icon:Object(re.jsx)(xe.a,{})},R),{},{children:e||Ze.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[Z,Le,J==null?void 0:J.length]),at=Object(He.useMemo)(function(){return je?L?{components:{header:{wrapper:function(ae){var ue,fe=ae.className,Q=ae.children;return Object(re.jsxs)("thead",{className:fe,children:[Q,Object(re.jsxs)("tr",{style:{position:"relative"},children:[Object(re.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:je}),Object(re.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(ue=Ye.columns)===null||ue===void 0?void 0:ue.length,children:je})]})]})}}}}:{tableViewRender:function(ae,ue){var fe,Q;return Object(re.jsxs)(re.Fragment,{children:[(fe=(Q=b.tableViewRender)===null||Q===void 0?void 0:Q.call(b,ae,ue))!==null&&fe!==void 0?fe:ue,je]})}}:{}},[L,je]),we=Object(l.a)({},b.editable),nt=Object(Ne.a)(function(Te,ae){var ue,fe,Q;if((ue=b.editable)===null||ue===void 0||(fe=ue.onValuesChange)===null||fe===void 0||fe.call(ue,Te,ae),(Q=b.onValuesChange)===null||Q===void 0||Q.call(b,ae,Te),b.controlled){var Me;b==null||(Me=b.onChange)===null||Me===void 0||Me.call(b,ae)}});return((b==null?void 0:b.onValuesChange)||((ve=b.editable)===null||ve===void 0?void 0:ve.onValuesChange)||b.controlled&&(b==null?void 0:b.onChange))&&(we.onValuesChange=nt),Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(w.Provider,{value:Je,children:Object(re.jsx)(te.a,Object(l.a)(Object(l.a)(Object(l.a)({search:!1,options:!1,pagination:!1,rowKey:F,revalidateOnFocus:!1},Ye),at),{},{tableLayout:"fixed",actionRef:Je,onChange:Se,editable:Object(l.a)(Object(l.a)({},we),{},{formProps:Object(l.a)({formRef:ce},we.formProps)}),dataSource:J,onDataSourceChange:function(ae){if(_t(ae),b.name&&_==="top"){var ue,fe=Object(ke.a)({},[b.name].flat(1).filter(Boolean),ae);(ue=ce.current)===null||ue===void 0||ue.setFieldsValue(fe)}}}))}),b.name?Object(re.jsx)(q.a,{name:[b.name],children:function(ae){var ue,fe,Q=Object(Ve.a)(ae,[b.name].flat(1)),Me=Q==null?void 0:Q.find(function(Pe,rt){return!Object(v.a)(Pe,ut==null?void 0:ut[rt])});return Me&&ut&&(b==null||(ue=b.editable)===null||ue===void 0||(fe=ue.onValuesChange)===null||fe===void 0||fe.call(ue,Me,Q)),null}}):null]})}function se(b){var Ee=_e.a.useFormInstance();return b.name?Object(re.jsx)(K.a.Item,Object(l.a)(Object(l.a)({style:{maxWidth:"100%"}},b==null?void 0:b.formItemProps),{},{name:b.name,children:Object(re.jsx)(U,Object(l.a)(Object(l.a)({},b),{},{editable:Object(l.a)(Object(l.a)({},b.editable),{},{form:Ee})}))})):Object(re.jsx)(U,Object(l.a)({},b))}se.RecordCreator=Be,de.a=se},KxBF:function(Fe,de){function t(c,K,$){var f=-1,P=c.length;K<0&&(K=-K>P?0:P+K),$=$>P?P:$,$<0&&($+=P),P=K>$?0:$-K>>>0,K>>>=0;for(var u=Array(P);++f<P;)u[f]=c[f+K];return u}Fe.exports=t},LDJE:function(Fe,de,t){"use strict";var c=t("q1tI"),K=t.n(c),$=t("ma/q"),f=t("ZIEt"),P=t("QpZ9"),u=t("GzfL"),oe=t("Scwr"),a=function(l,re){var he={};for(var xe in l)Object.prototype.hasOwnProperty.call(l,xe)&&re.indexOf(xe)<0&&(he[xe]=l[xe]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var q=0,xe=Object.getOwnPropertySymbols(l);q<xe.length;q++)re.indexOf(xe[q])<0&&Object.prototype.propertyIsEnumerable.call(l,xe[q])&&(he[xe[q]]=l[xe[q]]);return he},Ae=Object(c.forwardRef)(function(l,re){var he=l.chartRef,xe=l.style,q=xe===void 0?{height:"inherit"}:xe,_e=l.className,Xe=l.loading,ge=l.loadingTemplate,$e=l.errorTemplate,Ne=a(l,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),v=Object(f.a)($.a,Ne),O=v.chart,Ve=v.container;return Object(c.useEffect)(function(){Object(P.a)(he,O.current)},[O.current]),Object(c.useImperativeHandle)(re,function(){return{getChart:function(){return O.current}}}),K.a.createElement(u.a,{errorTemplate:$e},Xe&&K.a.createElement(oe.a,{loadingTemplate:ge,theme:l.theme}),K.a.createElement("div",{className:_e,style:q,ref:Ve}))});de.a=Ae},bahg:function(Fe,de){function t(c){return c.split("")}Fe.exports=t},jsgi:function(Fe,de,t){"use strict";var c=t("k1fw"),K=t("q1tI"),$=t.n(K),f=t("nhC9"),P=t("LDJE"),u=t("nKUr"),oe=t.n(u),a=function(l){var re=l.config,he=l.value,xe=l.title,q=l.children,_e=l.valueLabel,Xe=Object(K.useCallback)(function($e,Ne){var v,O=(v=he.find(function(Ve){return Ve.type===Ne.type}))===null||v===void 0?void 0:v.topic;return O?"".concat(O.topicable_type.split("\\").pop(),":").concat(O.title):$e},[he]),ge=Object(K.useCallback)(function($e){return{name:_e||$e.type,value:$e.value}},[_e]);return Object(u.jsx)(f.a,{title:xe,headerBordered:!0,children:Object(u.jsxs)("div",{style:{overflow:"auto",minHeight:"400px"},children:[Object(u.jsx)(P.a,Object(c.a)(Object(c.a)({},re),{},{tooltip:{formatter:ge,title:Xe},data:he})),q&&q]})})};de.a=a},olry:function(Fe,de,t){"use strict";t.r(de);var c=t("k1fw"),K=t("+L6B"),$=t("2/Rp"),f=t("T2oS"),P=t("W9HT"),u=t("q1tI"),oe=t("nhC9"),a=t("9kvl"),Ae=t("55Ip"),l=t("Ty5D"),re=t("tMyG"),he=t("my69"),xe=t("huej"),q=t("mJ0o"),_e=t("EhlZ"),Xe=t("P2fV"),ge=t("NJEC"),$e=t("5Dmo"),Ne=t("3S7+"),v=t("qLMh"),O=t("9og8"),Ve=t("sWYD"),ke=t("G3dp"),He=t("lbgm"),pe=t("/MfK"),te=t("Qiat"),k=t("mGZj");function h(o,i){return w.apply(this,arguments)}function w(){return w=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams",Object(c.a)({method:"GET",useCache:!1,params:i},r||{})));case 1:case"end":return n.stop()}},o)})),w.apply(this,arguments)}function Be(o,i){return U.apply(this,arguments)}function U(){return U=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams",Object(c.a)({method:"POST",headers:{"Content-Type":"application/json"},data:i},r||{})));case 1:case"end":return n.stop()}},o)})),U.apply(this,arguments)}function se(o,i,r){return b.apply(this,arguments)}function b(){return b=Object(O.a)(Object(v.a)().mark(function o(i,r,s){return Object(v.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i),Object(c.a)({method:"PUT",data:r,useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),b.apply(this,arguments)}function Ee(o,i){return ve.apply(this,arguments)}function ve(){return ve=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i),Object(c.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),ve.apply(this,arguments)}function Ze(o,i){return Se.apply(this,arguments)}function Se(){return Se=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i),Object(c.a)({method:"DELETE"},r||{})));case 1:case"end":return n.stop()}},o)})),Se.apply(this,arguments)}function Le(o,i,r,s){return Ie.apply(this,arguments)}function Ie(){return Ie=Object(O.a)(Object(v.a)().mark(function o(i,r,s,n){return Object(v.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i,"/users/").concat(r),Object(c.a)({method:"POST",headers:{"Content-Type":"application/json"},data:s},n||{})));case 1:case"end":return j.stop()}},o)})),Ie.apply(this,arguments)}function Z(o,i,r){return F.apply(this,arguments)}function F(){return F=Object(O.a)(Object(v.a)().mark(function o(i,r,s){return Object(v.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i,"/users/").concat(r),Object(c.a)({method:"DELETE"},s||{})));case 1:case"end":return d.stop()}},o)})),F.apply(this,arguments)}var Re=t("giR+"),Qe=t("fyUT"),N=t("tJVT"),dt=t("14J3"),Ye=t("BMrR"),ut=t("jCWc"),Je=t("kPKH"),ce=t("VMEa"),bt=t("Qurx"),jt=t("lR9U"),J=t("/y+f"),_t=t("2qtc"),qe=t("kLXV"),ft=t("OaEy"),We=t("2fM7"),ze=t("oBTY"),_=t("DBJ/"),e=t("nKUr"),S=[J.b.TeamsLecture,J.b.TestPortal,J.b.TeamsForms];function p(o){var i=o.showSelectAll,r=i===void 0?!0:i,s=o.options,n=s===void 0?[]:s,d=o.value,j=o.onChange,m=Object(u.useCallback)(function(){j==null||j(n.map(function(C){return C.value}),n)},[j,n]),T=Object(u.useCallback)(function(){j==null||j([],[])},[j]),y=Object(u.useMemo)(function(){return r?[{label:d!=null&&d.length?Object(e.jsx)($.a,{type:"link",onClick:T,children:Object(e.jsx)(a.a,{id:"deselect_all"})}):Object(e.jsx)($.a,{type:"link",onClick:m,children:Object(e.jsx)(a.a,{id:"select_all"})}),options:n}]:n},[m,T,n,r,d==null?void 0:d.length]);return{options:y,value:d,onChange:j}}var x=function(i){var r=i.open,s=i.closeModal,n=i.onSuccess,d=i.type,j=Object(q.b)(),m=j.teacherSubjectData,T=j.semester_subject_id,y=j.groupUsers,C=j.getGroupUsers,D=Object(u.useState)(),A=Object(N.a)(D,2),G=A[0],M=A[1],z=Object(u.useState)([]),E=Object(N.a)(z,2),V=E[0],ye=E[1],g={type:d,semester_subject_id:T},Y=Object(u.useCallback)(function(B){B.success&&M(B.data.results)},[]),H=Object(u.useMemo)(function(){var B;return((B=m==null?void 0:m.groups)!==null&&B!==void 0?B:[]).map(function(Ce){var De=Ce.id,ie=Ce.name;return{label:ie,value:De}})},[]),W=Object(u.useCallback)(function(B){ye(B);var Ce=B.reduce(function(De,ie){var ne,Oe=(ne=y.byId)===null||ne===void 0?void 0:ne[ie];if(!Oe)return De;var X=Oe.users.map(function(ee){var Ke=ee.id,I=ee.email,me=ee.first_name,le=ee.last_name;return{email:I,first_name:me,last_name:le,user_id:Ke,result:0}});return[].concat(Object(ze.a)(De),Object(ze.a)(X))},[]);M(Ce!=null&&Ce.length?Ce:void 0)},[y.byId]),be=p({options:H,onChange:W,value:V});return Object(u.useEffect)(function(){if(d===J.b.Manual&&r){var B;m==null||(B=m.groups)===null||B===void 0||B.forEach(function(Ce){var De=Ce.id;return C(De)})}},[d,r]),Object(e.jsxs)(qe.a,{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.".concat(d,"Convert")}),width:"40vw",open:r,onCancel:s,onOk:function(){G&&n(G)},okButtonProps:{disabled:!G},children:[S.includes(d)&&Object(e.jsx)(_.a,{name:"file",url:"/api/admin/exams/parse",onUpload:Y,onChange:function(Ce){return!Ce.fileList.length&&M(void 0)},maxFiles:1,data:g,hideLabel:!0}),d===J.b.Manual&&Object(e.jsx)(We.a,Object(c.a)(Object(c.a)({},be),{},{placeholder:Object(e.jsx)(a.a,{id:"select_groups"}),mode:"multiple",style:{width:"100%"}}))]})},R=function(i){var r=i.onSelect;return Object(e.jsxs)(Ye.a,{gutter:[16,16],children:[Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(J.b.TeamsForms)},children:Object(e.jsx)(a.a,{id:"uploadFile.MsTeamsForms",defaultMessage:"uploadFile.MsTeamsForms"})})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(J.b.TestPortal)},children:Object(e.jsx)(a.a,{id:"uploadFile.TestPortal",defaultMessage:"uploadFile.TestPortal"})})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(J.b.TeamsLecture)},children:Object(e.jsx)(a.a,{id:"uploadFile.MsTeams",defaultMessage:"uploadFile.MsTeams"})})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(J.b.Manual)},children:Object(e.jsx)(a.a,{id:"uploadGradesManually",defaultMessage:"uploadGradesManually"})})})]})},L=[{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"first_name",editable:!1},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"last_name",editable:!1},{title:Object(e.jsx)(a.a,{id:"examResult"}),dataIndex:"result",valueType:"percent",formItemProps:{rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:0,max:100}})}]}}],je=function(i){var r=i.exam_id,s=ce.a.useForm(),n=Object(N.a)(s,1),d=n[0],j=Object(u.useState)(),m=Object(N.a)(j,2),T=m[0],y=m[1],C=Object(u.useState)(),D=Object(N.a)(C,2),A=D[0],G=D[1],M=Object(u.useState)(!1),z=Object(N.a)(M,2),E=z[0],V=z[1],ye=Object(q.b)(),g=ye.semester_subject_id,Y=Object(u.useMemo)(function(){return(A!=null?A:[]).map(function(W){var be=W.user_id;return be})},[A]);Object(u.useEffect)(function(){var W=Number(r);r==="new"&&(y(void 0),G(void 0),d.resetFields()),r!=="new"&&!Number.isNaN(W)&&(V(!0),Ee(W).then(function(be){if(be.success){var B=be.data,Ce=B.type,De=B.results,ie=B.title,ne=B.weight,Oe=B.passed_at;y(Ce),G(De),d.setFieldsValue({title:ie,weight:ne,passed_at:Oe})}}).finally(function(){return V(!1)}))},[r]);var H=Object(u.useCallback)(function(){y(void 0),G(void 0)},[]);return E?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[T&&Object(e.jsx)(x,{open:Boolean(T&&!A),type:T,closeModal:H,onSuccess:G}),Object(e.jsxs)(ce.a,{form:d,submitter:T===void 0||!A?!1:void 0,onFinish:function(){var W=Object(O.a)(Object(v.a)().mark(function be(B){var Ce,De,ie,ne,Oe,X,ee;return Object(v.a)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(Ce=A==null?void 0:A.every(function(me){var le=me.result;return typeof le=="number"&&le>=0&&le<=100}),!(Ce&&typeof g=="number")){I.next=16;break}if(De=B.title,ie=B.passed_at,ne=B.weight,Oe=Number(r),X={type:T,semester_subject_id:g,title:De,passed_at:ie,weight:ne,results:A},!Number.isNaN(Oe)){I.next=11;break}return I.next=8,Be(X);case 8:I.t0=I.sent,I.next=14;break;case 11:return I.next=13,se(Oe,X);case 13:I.t0=I.sent;case 14:ee=I.t0,ee.success&&a.f.push("/teacher/subjects/".concat(g,"/exams"));case 16:return I.abrupt("return",!0);case 17:case"end":return I.stop()}},be)}));return function(be){return W.apply(this,arguments)}}(),onReset:H,children:[Object(e.jsxs)(ce.a.Group,{children:[Object(e.jsx)(bt.a,{label:Object(e.jsx)(a.a,{id:"examTitle",defaultMessage:"examTitle"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],width:"lg",name:"title"}),Object(e.jsx)(jt.a,{label:Object(e.jsx)(a.a,{id:"datePassingExam",defaultMessage:"datePassingExam"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],width:"lg",name:"passed_at"}),Object(e.jsx)(ce.a.Item,{name:"weight",label:Object(e.jsx)(a.a,{id:"examImportance",defaultMessage:"examImportance"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:1,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:1,max:100}})}],children:Object(e.jsx)(Qe.a,{})})]}),T&&A&&Object(e.jsx)(te.a,{rowKey:"user_id",editable:{type:"single",editableKeys:Y,onValuesChange:function(be,B){return G(B)}},cardProps:{bodyStyle:{paddingInline:0}},search:!1,dataSource:A,columns:L}),!A&&Object(e.jsx)(R,{onSelect:y})]})]})},at=[{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"first_name"},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"last_name"},{title:Object(e.jsx)(a.a,{id:"examResult"}),dataIndex:"result",hideInSearch:!0}],we=function(i){var r=i.exam_id;return Object(e.jsx)(te.a,{rowKey:"user_id",search:!1,headerTitle:Object(e.jsx)(a.a,{id:"examResults"}),request:Object(O.a)(Object(v.a)().mark(function s(){var n;return Object(v.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,Ee(r);case 2:if(n=j.sent,!n.success){j.next=5;break}return j.abrupt("return",{total:n.data.results.length,success:!0,data:n.data.results});case 5:return j.abrupt("return",[]);case 6:case"end":return j.stop()}},s)})),columns:at})},nt=[{title:Object(e.jsx)(a.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",sorter:!0},{title:Object(e.jsx)(a.a,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!0,sorter:!0},{title:Object(e.jsx)(a.a,{id:"type",defaultMessage:"type"}),dataIndex:"type",sorter:!0,render:function(i,r){return Object(e.jsx)(a.a,{id:"ExamGradeType.".concat(r.type)})}},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.exam_date",defaultMessage:"Exam date"}),dataIndex:"passed_at",sorter:!0,render:function(i,r){return r.passed_at&&Object(Ve.a)(new Date(r.passed_at),k.c)}},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",sorter:!0,render:function(i,r){return r.weight+"%"}},{title:Object(e.jsx)(a.a,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",sorter:!0,render:function(i,r){return r.created_at&&Object(Ve.a)(new Date(r.created_at),k.c)}},{title:Object(e.jsx)(a.a,{id:"semester",defaultMessage:"Semester"}),dataIndex:"semester",sorter:!0,render:function(i,r){return Object(e.jsx)(a.a,{id:"SemesterType.".concat(r.semester.type),values:{year:r.semester.year}})}}],Te=function(){var i,r,s=Object(u.useRef)(),n=Object(q.b)(),d=n.semester_subject_id,j=Object(l.k)(),m=Object(u.useMemo)(function(){var C,D,A;return{exam_id:(C=(D=j.query)===null||D===void 0?void 0:D.exam_id)!==null&&C!==void 0?C:null,results:(A=j.query)===null||A===void 0?void 0:A.results}},[(i=j.query)===null||i===void 0?void 0:i.exam_id,(r=j.query)===null||r===void 0?void 0:r.results]),T=m.exam_id,y=m.results;return y!==null&&!Number.isNaN(Number(y))?Object(e.jsx)(we,{exam_id:Number(y)}):T!==null?Object(e.jsx)(je,{exam_id:T}):Object(e.jsx)(te.a,{headerTitle:Object(e.jsx)(a.a,{id:"exams"}),actionRef:s,search:!1,rowKey:"id",request:function(){var C=Object(O.a)(Object(v.a)().mark(function D(A,G){var M,z,E,V;return Object(v.a)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(M=A.current,z=A.pageSize,d!==null){g.next=3;break}return g.abrupt("return",{data:[],total:0,success:!1});case 3:return E=G&&Object.entries(G)[0],g.next=6,h({per_page:z,page:M,semester_subject_id:Number.isNaN(d)?void 0:d,order_by:E&&E[0],order:E&&(E[1]==="ascend"?"ASC":"DESC")});case 6:if(V=g.sent,!V.success){g.next=9;break}return g.abrupt("return",{data:V.data,total:V.meta.total,success:!0});case 9:return g.abrupt("return",{data:[],total:0,success:!1});case 10:case"end":return g.stop()}},D)}));return function(D,A){return C.apply(this,arguments)}}(),columns:[].concat(nt,[{title:Object(e.jsx)(a.a,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(D,A){return[Object(e.jsx)(Ae.a,{to:"/teacher/subjects/".concat(A.semester_subject_id,"/exams?exam_id=").concat(A.id),children:Object(e.jsx)(Ne.a,{title:Object(e.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(ke.a,{})})})},"edit"),Object(e.jsx)(Ae.a,{to:"/teacher/subjects/".concat(A.semester_subject_id,"/exams?results=").concat(A.id),children:Object(e.jsx)(Ne.a,{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.results",defaultMessage:"results"}),children:Object(e.jsx)($.a,{icon:Object(e.jsx)(He.a,{})})})},"results"),Object(e.jsx)(ge.a,{title:Object(e.jsx)(a.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(O.a)(Object(v.a)().mark(function G(){var M;return Object(v.a)().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,Ze(A.id);case 2:M=E.sent,M.success&&s.current&&s.current.reload();case 4:case"end":return E.stop()}},G)})),okText:Object(e.jsx)(a.a,{id:"yes"}),cancelText:Object(e.jsx)(a.a,{id:"no"}),children:Object(e.jsx)(Ne.a,{title:Object(e.jsx)(a.a,{id:"delete",defaultMessage:"delete"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(pe.a,{}),danger:!0})})},"delete")]}}])})},ae=t("DYRE"),ue=t("zeV3"),fe=t("tU7J"),Q=t("wFql"),Me=t("4KAj"),Pe=t("o0Ox"),rt=[{title:Object(e.jsx)(a.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"user_id",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"first_name",defaultMessage:"First name"}),dataIndex:"first_name",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"last_name",defaultMessage:"Last name"}),dataIndex:"last_name",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"email",defaultMessage:"email"}),dataIndex:"email",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"groupName",defaultMessage:"Group name"}),dataIndex:"group_name",hideInSearch:!0}],Ot=function(){var i,r=Object(u.useState)(!1),s=Object(N.a)(r,2),n=s[0],d=s[1],j=Object(q.b)(),m=j.teacherSubjectData,T=Object(u.useState)([]),y=Object(N.a)(T,2),C=y[0],D=y[1],A=Object(u.useRef)(),G=Object(u.useMemo)(function(){return C.reduce(function(E,V){var ye,g=[];return V==null||(ye=V.users)===null||ye===void 0||ye.reduce(function(Y,H){var W={group_id:V.id,group_name:V.name,user_id:H.id,first_name:H.first_name,last_name:H.last_name,email:H.email};return g.push(W),Object(c.a)(Object(c.a)({},Y),W)},{}),d(!1),[].concat(Object(ze.a)(E),g)},[])},[C]),M=function(V){Object(Pe.a)({parent_id:m==null?void 0:m.group_id,"id[]":V}).then(function(ye){ye.success&&D(ye.data)})},z=function(V){d(!0),M(V)};return Object(u.useEffect)(function(){M()},[]),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(oe.a,{children:Object(e.jsxs)(ue.b,{children:[Object(e.jsx)(Q.a.Title,{level:5,children:Object(e.jsx)(a.a,{id:"select_user_group",defaultMessage:"Select group"})}),Object(e.jsx)(We.a,{allowClear:!0,mode:"multiple",style:{minWidth:"400px"},onChange:z,onClear:M,children:m==null||(i=m.groups)===null||i===void 0?void 0:i.map(function(E){return Object(e.jsx)(We.a.Option,{value:E.id,children:E.name},E.id)})})]})}),Object(e.jsx)(te.a,{actionRef:A,rowKey:"user_id",search:!1,loading:n,dataSource:G!=null?G:[],columns:[].concat(rt,[{hideInSearch:!0,title:Object(e.jsx)(a.a,{id:"msTeams"}),dataIndex:"teamsLink",valueType:"option",render:function(){return[Object(e.jsx)(Ae.a,{to:"#",children:Object(e.jsx)(Ne.a,{title:Object(e.jsx)(a.a,{id:"msTeams",defaultMessage:"teams"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(Me.a,{})})})},"teamsLink")]}}])})]})},mt=Ot,vt=t("jrin");function ht(o,i){return gt.apply(this,arguments)}function gt(){return gt=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/schedules/groups/".concat(i),Object(c.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),gt.apply(this,arguments)}function Kt(o,i,r,s){return Tt.apply(this,arguments)}function Tt(){return Tt=Object(O.a)(Object(v.a)().mark(function o(i,r,s,n){return Object(v.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(a.i)("/api/admin/schedules/".concat(i,"/attendances"),Object(c.a)({data:{attendances:[{user_id:r,value:s}]},method:"POST"},n||{})));case 1:case"end":return j.stop()}},o)})),Tt.apply(this,arguments)}var Ia=t("sRBo"),Bt=t("kaz8"),wt=function(i){var r=i.currentData,s=i.recordData,n=i.groupId,d=i.onSuccess,j=Object(u.useState)(!1),m=Object(N.a)(j,2),T=m[0],y=m[1],C=function(){y(!0),Kt(r.id,s.id,(s==null?void 0:s[String(r.date_from)])===J.a.PRESENT?J.a.ABSENT:J.a.PRESENT).then(function(A){A.success&&ht(Number(n)).then(function(G){G.success&&(d(G.data),y(!1))})})};return T?Object(e.jsx)(P.a,{size:"small"}):Object(e.jsx)(Bt.a,{checked:(s==null?void 0:s[String(r.date_from)])===J.a.PRESENT,onChange:function(){return C()}})},Vt=wt,Ht=function(){var i,r,s,n,d,j=Object(q.b)(),m=j.teacherSubjectData,T=Object(u.useRef)(),y=Object(a.l)(),C=Object(u.useState)(!1),D=Object(N.a)(C,2),A=D[0],G=D[1],M=Object(u.useState)(),z=Object(N.a)(M,2),E=z[0],V=z[1],ye=Object(u.useState)(),g=Object(N.a)(ye,2),Y=g[0],H=g[1],W=Object(u.useState)({id:(i=m==null||(r=m.groups)===null||r===void 0?void 0:r[0].id)!==null&&i!==void 0?i:null,name:m==null||(s=m.groups)===null||s===void 0?void 0:s[0].name}),be=Object(N.a)(W,2),B=be[0],Ce=be[1],De=Object(u.useMemo)(function(){var X;return((X=Y==null?void 0:Y.users)!==null&&X!==void 0?X:[]).reduce(function(ee,Ke){var I={id:Ke.id,first_name:Ke.first_name,last_name:Ke.last_name,academic_teacher_id:Ke.academic_teacher_id},me=(E!=null?E:[]).reduce(function(le,Ge){var Ue=Ge.attendances.find(function(et){return et.user_id===Ke.id});return Object(c.a)(Object(c.a)({},le),{},Object(vt.a)({},String(Ge.date_from),Ue==null?void 0:Ue.value))},{});return I.academic_teacher_id?Object(ze.a)(ee):[].concat(Object(ze.a)(ee),[Object(c.a)(Object(c.a)({},I),me)])},[])},[Y,E]),ie=Object(u.useMemo)(function(){var X=(E!=null?E:[]).reduce(function(ee,Ke){return[].concat(Object(ze.a)(ee),[{title:String(Object(Ve.a)(new Date(Ke.date_from),k.c)),dataIndex:String(Ke.date_from),hideInSearch:!0,width:100,align:"center",render:function(me,le){return Object(e.jsx)(Vt,{currentData:Ke,recordData:le,onSuccess:function(Ue){return V(Ue)},groupId:B.id})}}])},[]);return console.log({columns:ie}),G(!1),[{title:Object(e.jsx)(a.a,{id:"nameAndSurname",defaultMessage:"Name and surname"}),hideInSearch:!0,fixed:"left",render:function(Ke,I){return"".concat(I.first_name," ").concat(I.last_name)}}].concat(Object(ze.a)(X))},[E]),ne=function(ee){var Ke,I=m==null||(Ke=m.groups)===null||Ke===void 0?void 0:Ke.find(function(me){return me.id===ee});return I?I==null?void 0:I.name:""},Oe=function(ee){G(!0),Ce({id:ee,name:ne(ee)})};return Object(u.useEffect)(function(){B.id&&(ht(B.id).then(function(X){X.success&&V(X.data)}),Object(Pe.b)(B.id).then(function(X){X.success&&H(X.data)}))},[B]),console.log({studentAttendanceList:De}),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(oe.a,{children:Object(e.jsxs)(ue.b,{children:[Object(e.jsx)(Q.a.Title,{level:5,children:Object(e.jsx)(a.a,{id:"select_user_group",defaultMessage:"Select group"})}),Object(e.jsx)(We.a,{style:{minWidth:"400px"},onChange:Oe,defaultValue:m==null||(n=m.groups)===null||n===void 0?void 0:n[0].id,children:m==null||(d=m.groups)===null||d===void 0?void 0:d.map(function(X){return Object(e.jsx)(We.a.Option,{value:X.id,children:X.name},X.id)})})]})}),ie.length===1?Object(e.jsx)(a.a,{id:"noAttendanceSchedule",defaultMessage:"No attendance schedule for this group..."}):Object(e.jsx)(te.a,{headerTitle:"".concat(y.formatMessage({id:"attendances",defaultMessage:"Attendances"})," (").concat(B.name,")"),actionRef:T,rowKey:"group_id",search:!1,loading:A,dataSource:De!=null?De:[],scroll:{x:1500},columns:Object(ze.a)(ie)})]})},Jt=Ht,Ra=t("/zsF"),yt=t("PArb"),zt=t("Hn4i"),Yt=t("bRQS");function $t(o,i,r){return Ct.apply(this,arguments)}function Ct(){return Ct=Object(O.a)(Object(v.a)().mark(function o(i,r,s){return Object(v.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/semester-subjects/".concat(i,"/tutors/").concat(r,"/grades"),Object(c.a)({method:"GET",useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),Ct.apply(this,arguments)}function Zt(o,i,r,s){return Mt.apply(this,arguments)}function Mt(){return Mt=Object(O.a)(Object(v.a)().mark(function o(i,r,s,n){return Object(v.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(a.i)("/api/admin/semester-subjects/".concat(i,"/tutors/").concat(r,"/grades"),Object(c.a)({method:"POST",data:s},n||{})));case 1:case"end":return j.stop()}},o)})),Mt.apply(this,arguments)}function Qt(o,i){return Pt.apply(this,arguments)}function Pt(){return Pt=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/lesson-group-users",Object(c.a)({method:"GET",params:{"groups[]":i},useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),Pt.apply(this,arguments)}function Xt(o,i,r){return Dt.apply(this,arguments)}function Dt(){return Dt=Object(O.a)(Object(v.a)().mark(function o(i,r,s){return Object(v.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/lesson-group-users/groups/".concat(i,"/users/").concat(r),Object(c.a)({method:"GET",useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),Dt.apply(this,arguments)}function kt(o){return At.apply(this,arguments)}function At(){return At=Object(O.a)(Object(v.a)().mark(function o(i){return Object(v.a)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",Object(a.i)("/api/admin/grade-terms",Object(c.a)({method:"GET",useCache:!1},i||{})));case 1:case"end":return s.stop()}},o)})),At.apply(this,arguments)}function qt(o,i){return It.apply(this,arguments)}function It(){return It=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/grade-scales/".concat(i),Object(c.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),It.apply(this,arguments)}function ea(o,i){return Rt.apply(this,arguments)}function Rt(){return Rt=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/final-grades",Object(c.a)({method:"POST",data:i},r||{})));case 1:case"end":return n.stop()}},o)})),Rt.apply(this,arguments)}function ta(o,i,r){return Lt.apply(this,arguments)}function Lt(){return Lt=Object(O.a)(Object(v.a)().mark(function o(i,r,s){return Object(v.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/final-grades/".concat(i),Object(c.a)({method:"PATCH",data:r},s||{})));case 1:case"end":return d.stop()}},o)})),Lt.apply(this,arguments)}var aa=[{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade",editable:!1},{title:Object(e.jsx)(a.a,{id:"degree"}),dataIndex:"name",editable:!1},{title:Object(e.jsx)(a.a,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent",formItemProps:{rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:0,max:100}})}]}}],na=function(){var i,r,s=Object(a.m)("@@initialState"),n=s.initialState,d=Object(q.b)(),j=d.semester_subject_id,m=d.tutors,T=ce.a.useForm(),y=Object(N.a)(T,1),C=y[0],D=Object(u.useState)([]),A=Object(N.a)(D,2),G=A[0],M=A[1],z=Object(u.useRef)(),E=Object(u.useState)(!1),V=Object(N.a)(E,2),ye=V[0],g=V[1],Y=Object(u.useState)(null),H=Object(N.a)(Y,2),W=H[0],be=H[1],B=Object(u.useMemo)(function(){return!!m.data.find(function(ie){var ne,Oe=ie.id;return Oe===(n==null||(ne=n.currentUser)===null||ne===void 0?void 0:ne.id)})},[m.data,n==null||(i=n.currentUser)===null||i===void 0?void 0:i.id]),Ce=Object(u.useMemo)(function(){return m.data.map(function(ie){var ne=ie.id,Oe=ie.first_name,X=ie.last_name;return{label:"".concat(Oe," ").concat(X),value:ne}})},[m.data]);Object(u.useEffect)(function(){var ie,ne;if(!B||!(n!=null&&(ie=n.currentUser)!==null&&ie!==void 0&&ie.id)){var Oe;if((Oe=m.data)!==null&&Oe!==void 0&&Oe[0]){var X;be((X=m.data)===null||X===void 0?void 0:X[0].id)}return}be(n==null||(ne=n.currentUser)===null||ne===void 0?void 0:ne.id)},[n==null||(r=n.currentUser)===null||r===void 0?void 0:r.id,B]),Object(u.useEffect)(function(){j===null||W===null||(g(!0),$t(j,W).then(function(ie){if(ie.success){var ne,Oe=((ne=ie.data.grade_scale)!==null&&ne!==void 0?ne:[]).map(function(X,ee){return Object(c.a)(Object(c.a)({},X),{},{id:String((ee+1)*100)})});C.setFieldValue("table",Oe)}}).finally(function(){g(!1)}))},[j,W]);var De=Object(u.useCallback)(function(){var ie=Object(O.a)(Object(v.a)().mark(function ne(Oe){return Object(v.a)().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(!(j===null||W===null)){ee.next=2;break}return ee.abrupt("return");case 2:return ee.next=4,Zt(j,W,{grade_scale:Oe.table});case 4:case"end":return ee.stop()}},ne)}));return function(ne){return ie.apply(this,arguments)}}(),[W,j]);return m.loading?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(ce.a.Item,{label:Object(e.jsx)(a.a,{id:"menu.Teacher"}),children:Object(e.jsx)(We.a,{disabled:B,placeholder:Object(e.jsx)(a.a,{id:"select"}),options:Ce,value:W,onChange:function(ne){return be(ne)}})}),Object(e.jsx)(yt.a,{}),Object(e.jsx)(ce.a,{form:C,onFinish:De,submitter:{render:function(ne,Oe){var X=Object(N.a)(Oe,2),ee=X[1];return[ee]}},children:Object(e.jsx)(zt.a,{name:"table",rowKey:"id",actionRef:z,formItemProps:{label:Object(e.jsx)(a.a,{id:"grades-scale"})},cardProps:{bodyStyle:{padding:0}},recordCreatorProps:!1,loading:ye,columns:[].concat(aa,[{title:Object(e.jsx)(a.a,{id:"options"}),valueType:"option",render:function(ne,Oe){return Object(e.jsx)($.a,{type:"primary",onClick:function(){var ee;return(ee=z.current)===null||ee===void 0?void 0:ee.startEditable(Oe.id)},icon:Object(e.jsx)(ke.a,{})})}}]),editable:{form:C,type:"multiple",editableKeys:G,saveText:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(Yt.a,{})}),onChange:M,actionRender:function(ne,Oe,X){return[X.save]}}})})]})},La=t("qbNl"),ra=t("JBPa"),Ga=t("Awhp"),sa=t("KrTs"),ca=t("wd/R"),st=t.n(ca),Ua=t("5R/X");function ia(o,i){return Gt.apply(this,arguments)}function Gt(){return Gt=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/schedules",Object(c.a)({params:i,method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),Gt.apply(this,arguments)}var ua=function(){var i=Object(u.useState)(null),r=Object(N.a)(i,2),s=r[0],n=r[1],d=Object(u.useState)([]),j=Object(N.a)(d,2),m=j[0],T=j[1],y=Object(q.b)(),C=y.semester_subject_id,D=st()(),A=Object(u.useMemo)(function(){return m.map(function(g){return{id:g.id,title:"".concat(g.group.name," (").concat(g.term_status.name,")"),start:st()(g.date_from).toDate(),end:st()(g.date_to).toDate(),tutor_name:"".concat(g.tutor.first_name," ").concat(g.tutor.last_name),tutor_email:g.tutor.email,semester:g.semester.name,group:g.group.name,subject:g.subject.name}})},[m]),G=Object(u.useCallback)(function(g,Y){ia({semester_subject_id:C,date_form:g.toDate(),date_to:Y.toDate()}).then(function(H){H.success&&T(H.data)})},[C]),M=Object(u.useCallback)(function(g){n(g)},[]),z=Object(u.useCallback)(function(){n(null)},[]),E=Object(u.useCallback)(function(g){return g.isSame(D,"day")?"warning":g.isAfter(D,"day")?"success":"error"},[]),V=Object(u.useCallback)(function(g){var Y=A.filter(function(H){return st()(H.start).isSame(g,"day")});return Object(e.jsx)("ul",{className:"events",children:Y.map(function(H){return Object(e.jsx)("li",{onClick:function(){return M(H)},children:Object(e.jsx)(sa.a,{status:E(st()(H.start)),text:H.title})},H.id)})})},[m]),ye=Object(u.useCallback)(function(g,Y){var H=st()(g).startOf(Y).subtract(1,"month"),W=st()(g).endOf(Y).add(1,"month");G(H,W)},[]);return Object(u.useEffect)(function(){var g=st()().startOf("month"),Y=st()().endOf("month");G(g,Y)},[]),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Q.a.Title,{level:4,children:Object(e.jsx)(a.a,{id:"schedule",defaultMessage:"Schedule"})}),Object(e.jsx)(ra.a,{dateCellRender:V,onPanelChange:ye}),Object(e.jsxs)(qe.a,{open:s!==null,title:"".concat(s==null?void 0:s.subject,": ").concat(s==null?void 0:s.title),onCancel:z,footer:null,children:[Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"tutorName",defaultMessage:"Tutor"}),": ",s==null?void 0:s.tutor_name]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"email",defaultMessage:"Email"}),": ",s==null?void 0:s.tutor_email]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"group",defaultMessage:"Group"}),": ",s==null?void 0:s.group]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"semester",defaultMessage:"Semester"}),": ",s==null?void 0:s.semester]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"started_at",defaultMessage:"Start date"}),":",s&&st()(s.start).format(k.b)]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"end_at",defaultMessage:"End date"}),":",s&&st()(s.end).format(k.b)]})]})]})},la=ua,Ut=t("PpiC"),da=t("Vpfc"),Fa=t("miYZ"),Et=t("tsqr"),Nt=t("yj/a"),oa=t("5Syx"),Ft=t("H6aw"),ja=t("p3I6"),ba=["attendances"],fa=["results"];function Oa(o,i){var r=Object(u.useState)({loading:!1}),s=Object(N.a)(r,2),n=s[0],d=s[1];return Object(u.useEffect)(function(){d(function(j){return Object(c.a)(Object(c.a)({},j),{},{loading:!0})}),Xt(o,i).then(function(j){j.success&&d(function(m){return Object(c.a)(Object(c.a)({},m),{},{data:j.data})})}).finally(function(){d(function(j){return Object(c.a)(Object(c.a)({},j),{},{loading:!1})})})},[i,o]),{finalGrades:n}}function ma(){var o=Object(u.useState)({loading:!1}),i=Object(N.a)(o,2),r=i[0],s=i[1];return Object(u.useEffect)(function(){s(function(n){return Object(c.a)(Object(c.a)({},n),{},{loading:!0})}),kt().then(function(n){n.success&&s(function(d){return Object(c.a)(Object(c.a)({},d),{},{data:n.data})})}).finally(function(){s(function(n){return Object(c.a)(Object(c.a)({},n),{},{loading:!1})})})},[]),{gradeTerms:r}}function va(o){var i=Object(u.useState)({loading:!1}),r=Object(N.a)(i,2),s=r[0],n=r[1];return Object(u.useEffect)(function(){o!==void 0&&(n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!0})}),qt(o).then(function(d){d.success&&n(function(j){return Object(c.a)(Object(c.a)({},j),{},{data:d.data})})}).finally(function(){n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!1})})}))},[o]),{subjectGradeScales:s}}function ha(o,i){var r=Object(u.useState)({loading:!1}),s=Object(N.a)(r,2),n=s[0],d=s[1];return Object(u.useEffect)(function(){typeof o!="number"||typeof i!="number"||(d(function(j){return Object(c.a)(Object(c.a)({},j),{},{loading:!0})}),$t(o,i).then(function(j){j.success&&d(function(m){return Object(c.a)(Object(c.a)({},m),{},{data:j.data.grade_scale})})}).finally(function(){d(function(j){return Object(c.a)(Object(c.a)({},j),{},{loading:!1})})}))},[o,i]),{tutorGradeScales:n}}function ga(o,i){var r=Object(u.useState)({loading:!1}),s=Object(N.a)(r,2),n=s[0],d=s[1],j=Object(u.useCallback)(function(){d(function(T){return Object(c.a)(Object(c.a)({},T),{},{loading:!0})}),ht(o).then(function(T){if(T.success){var y=T.data.reduce(function(C,D){var A=D.attendances,G=Object(Ut.a)(D,ba),M=A.find(function(z){return Boolean(z.user_id)});return M?[].concat(Object(ze.a)(C),[Object(c.a)(Object(c.a)({},G),{},{attendance:M})]):C},[]);d(function(C){return Object(c.a)(Object(c.a)({},C),{},{data:y})})}}).finally(function(){d(function(T){return Object(c.a)(Object(c.a)({},T),{},{loading:!1})})})},[o,i]),m=Object(u.useCallback)(function(T,y){d(function(C){return Object(c.a)(Object(c.a)({},C),{},{loading:!0})}),Kt(T,i,y).then(function(C){C.success?Et.b.success(C.message):Et.b.error(C.message)}).finally(function(){j(),d(function(C){return Object(c.a)(Object(c.a)({},C),{},{loading:!1})})})},[j,i]);return Object(u.useEffect)(function(){j()},[j]),{userAttendanceSchedules:n,fetchUserAttendanceSchedules:j,updateUserAttendanceSchedules:m}}function pa(o){var i=Object(u.useState)({loading:!1}),r=Object(N.a)(i,2),s=r[0],n=r[1];return Object(u.useEffect)(function(){n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!0})}),h({student_id:o}).then(function(d){if(d.success){var j=d.data.reduce(function(m,T){var y=Object(N.a)(T.results,1),C=y[0],D=Object(Ut.a)(T,fa);return C?[].concat(Object(ze.a)(m),[Object(c.a)(Object(c.a)({},D),{},{result:C})]):m},[]);n(function(m){return Object(c.a)(Object(c.a)({},m),{},{data:j})})}}).finally(function(){n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!1})})})},[o]),{studentExams:s}}function xa(o,i){var r=Object(u.useState)({loading:!1}),s=Object(N.a)(r,2),n=s[0],d=s[1],j=Object(u.useState)({loading:!1}),m=Object(N.a)(j,2),T=m[0],y=m[1],C=Object(u.useState)({loading:!1}),D=Object(N.a)(C,2),A=D[0],G=D[1];return Object(u.useEffect)(function(){d(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!0})}),Object(Ft.e)({group_id:o}).then(function(M){M.success&&d(function(z){return Object(c.a)(Object(c.a)({},z),{},{data:M.data})})}).finally(function(){d(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!1})})})},[o]),Object(u.useEffect)(function(){!n.data||(G(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!0})}),Promise.all(n.data.map(function(M){var z=M.id;return Object(Ft.m)(Number(z))})).then(function(M){M.forEach(function(z){z.success&&G(function(E){return Object(c.a)(Object(c.a)({},E),{},{data:Object(c.a)(Object(c.a)({},E.data),{},Object(vt.a)({},Number(z.data.id),Object(ja.c)(z.data.lessons)))})})})}).finally(function(){G(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!1})})}),y(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!0})}),Promise.all(n.data.map(function(M){var z=M.id;return Object(Ft.l)(Number(z),["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics"]).then(function(E){if(E.success){var V,ye=((V=E.data["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics"])!==null&&V!==void 0?V:[]).filter(function(g){return g.id===i});y(function(g){return Object(c.a)(Object(c.a)({},g),{},{data:Object(c.a)(Object(c.a)({},g.data),{},Object(vt.a)({},Number(z),ye))})})}})})).finally(function(){return y(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!1})})}))},[n.data,i]),{userCourses:n,userCoursesStats:T,userCoursesTopics:A}}var _a=[{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade"},{title:Object(e.jsx)(a.a,{id:"degree"}),dataIndex:"name"},{title:Object(e.jsx)(a.a,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent"}],Ea=[{title:Object(e.jsx)(a.a,{id:"date"}),dataIndex:"date_from",render:function(i,r){return Object(Ve.a)(new Date(r.date_from),k.c)}}],Sa=[{title:Object(e.jsx)(a.a,{id:"name"}),dataIndex:"title"},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",valueType:"percent"},{title:Object(e.jsx)(a.a,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",render:function(i,r){return Object(Ve.a)(new Date(r.created_at),k.c)}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"result",render:function(i,r){return"".concat(r.result.result,"%")}}],Ta=[{title:Object(e.jsx)(a.a,{id:"name"}),dataIndex:"name"},{title:Object(e.jsx)(a.a,{id:"issued_at"}),dataIndex:"grade",render:function(i,r){var s,n;return(s=r.grade)!==null&&s!==void 0&&s.grade_date?Object(Ve.a)(new Date((n=r.grade)===null||n===void 0?void 0:n.grade_date),k.c):"-"}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade",render:function(i,r){var s,n;return(s=(n=r.grade)===null||n===void 0?void 0:n.grade_name)!==null&&s!==void 0?s:"-"}}],St=6,ya=function(i){var r,s,n=i.user_id,d=i.group_id,j=Object(q.b)(),m=j.semester_subject_id,T=pa(n),y=T.studentExams,C=Oa(d,n),D=C.finalGrades,A=ma(),G=A.gradeTerms,M=va((r=D.data)===null||r===void 0?void 0:r.s_subject_scale_form_id),z=M.subjectGradeScales,E=ha(m,(s=D.data)===null||s===void 0?void 0:s.tutor_id),V=E.tutorGradeScales,ye=ga(d,n),g=ye.userAttendanceSchedules,Y=ye.updateUserAttendanceSchedules,H=xa(d,n),W=H.userCourses,be=H.userCoursesStats,B=H.userCoursesTopics,Ce=ce.a.useForm(),De=Object(N.a)(Ce,1),ie=De[0],ne=Object(u.useMemo)(function(){var I;return((I=G.data)!==null&&I!==void 0?I:[]).map(function(me){var le=me.id,Ge=me.name;return{label:Ge,value:le}})},[G.data]),Oe=Object(u.useMemo)(function(){var I;return((I=z.data)!==null&&I!==void 0?I:[]).map(function(me){var le=me.name,Ge=me.id;return{label:le,value:Ge}})},[z.data]),X=Object(u.useMemo)(function(){var I,me,le,Ge=((I=y.data)!==null&&I!==void 0?I:[]).reduce(function(tt,it){var Aa=it.result,Wt=it.weight;return[tt[0]+Aa.result*Wt,tt[1]+Wt]},[0,0]),Ue=Object(N.a)(Ge,2),et=Ue[0],ot=Ue[1],pt=Number.isNaN(et/ot)?0:et/ot,xt=((me=V.data)!==null&&me!==void 0?me:[]).sort(function(tt,it){return tt.grade_value-it.grade_value}).reduce(function(tt,it){return[].concat(Object(ze.a)(tt),[Object(c.a)(Object(c.a)({},it),{},{isWeightedAverageGreater:pt>=it.grade_value})])},[]);if(xt.every(function(tt){var it=tt.isWeightedAverageGreater;return it})){var ct;return(ct=xt.at(-1))===null||ct===void 0?void 0:ct.name}var lt=xt.findIndex(function(tt){var it=tt.isWeightedAverageGreater;return!it});return lt<0?"":(le=xt[lt-1])===null||le===void 0?void 0:le.name},[y.data,V.data]),ee=Object(u.useCallback)(function(){var I=Object(O.a)(Object(v.a)().mark(function me(le){var Ge,Ue,et,ot,pt;return Object(v.a)().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:if(et=le.grade_scale_id,ot=le.grade_term_id,((Ge=D.data)===null||Ge===void 0?void 0:Ge.id)!==void 0){ct.next=3;break}return ct.abrupt("return");case 3:if(pt=(Ue=D.data)===null||Ue===void 0?void 0:Ue.grades.find(function(lt){var tt=lt.grade_term;return tt.id===ot}),!pt){ct.next=7;break}return ta(pt.id,{grade_scale_id:et}).then(function(lt){Et.b[lt.success?"success":"error"](lt.message),a.f.push("/teacher/subjects/".concat(m,"/final-grades"))}),ct.abrupt("return");case 7:ea({grade_scale_id:et,grade_term_id:ot,lesson_group_user_id:D.data.id}).then(function(lt){Et.b[lt.success?"success":"error"](lt.message),a.f.push("/teacher/subjects/".concat(m,"/final-grades"))});case 8:case"end":return ct.stop()}},me)}));return function(me){return I.apply(this,arguments)}}(),[D.data,m]),Ke=Object(u.useMemo)(function(){var I;return((I=G.data)!==null&&I!==void 0?I:[]).map(function(me){var le;return Object(c.a)(Object(c.a)({},me),{},{grade:(le=D.data)===null||le===void 0?void 0:le.grades.find(function(Ge){var Ue=Ge.grade_term;return Ue.id===me.id})})})},[D.data,G.data]);return D.loading?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[D.data&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Q.a.Text,{style:{fontSize:"16px",fontWeight:500},children:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Student",values:D.data.user})}),Object(e.jsx)(yt.a,{})]}),Object(e.jsxs)(Ye.a,{gutter:[48,48],justify:"space-between",children:[Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)(te.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.StudentPartialGrades"}),search:!1,pagination:{pageSize:St},dataSource:y.data,loading:y.loading,columns:Sa,options:!1,cardProps:{bodyStyle:{padding:0}}})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)(te.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.FinalGrades"}),search:!1,pagination:{pageSize:St},dataSource:Ke,loading:D.loading||G.loading,columns:Ta,options:!1,cardProps:{bodyStyle:{padding:0}}})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)(te.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Attendances"}),search:!1,options:!1,pagination:{pageSize:St},cardProps:{bodyStyle:{padding:0}},dataSource:g.data,loading:g.loading,columns:[].concat(Ea,[{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Attendance"}),dataIndex:"attendance",render:function(me,le){return Object(e.jsx)(Bt.a,{onChange:function(Ue){return Y(le.id,Ue.target.checked?J.a.PRESENT:J.a.ABSENT)},checked:le.attendance.value===J.a.PRESENT})}}])})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)(te.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.GradesScale"}),search:!1,options:!1,pagination:{pageSize:St},cardProps:{bodyStyle:{padding:0}},dataSource:V.data,loading:V.loading,columns:_a})}),W.loading&&!W.data||be.loading&&!be.data||B.loading&&!B.data&&Object(e.jsx)(P.a,{}),W.data&&be.data&&B.data&&W.data.map(function(I){var me,le,Ge,Ue,et=I.id,ot=I.title;return Object(e.jsxs)(Je.a,{span:24,children:[Object(e.jsx)(Q.a.Text,{style:{fontSize:"16px",fontWeight:500},children:ot}),Object(e.jsx)(oa.c,{topics:(me=(le=B.data)===null||le===void 0?void 0:le[Number(et)])!==null&&me!==void 0?me:[],stats:(Ge=(Ue=be.data)===null||Ue===void 0?void 0:Ue[Number(et)])!==null&&Ge!==void 0?Ge:[]})]},et)})]}),Object(e.jsx)(ce.a,{form:ie,onFinish:ee,children:Object(e.jsxs)(ce.a.Group,{style:{display:"flex",flexDirection:"column",paddingTop:"48px"},title:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.IssueAssessment"}),titleStyle:{flex:"unset"},align:"center",children:[Object(e.jsx)(Nt.a,{name:"grade_term_id",rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],label:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.GradeTerm"}),options:ne,width:"sm",fieldProps:{loading:G.loading}}),Object(e.jsx)(Nt.a,{name:"grade_scale_id",rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],label:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.FinalGrade"}),options:Oe,fieldProps:{loading:D.loading||z.loading}}),Object(e.jsx)(ce.a.Item,{children:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.ProposedGrade",values:{grade:X}})})]})})]})},Ca=["grades"],Ma=[{title:Object(e.jsx)(a.a,{id:"group"}),dataIndex:"group_id",render:function(i,r){return Object(e.jsx)(da.a,{type:"Students",type_id:r.group_id},r.group_id)}},{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"user",render:function(i,r){return r.user.first_name}},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"user",render:function(i,r){return r.user.last_name}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grades",render:function(i,r){return Object(e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:r.grades.length?r.grades.map(function(s){var n=s.grade_name,d=s.grade_term,j=s.id;return Object(e.jsxs)(Q.a.Text,{children:[d.name,": ",n]},j)}):"-"})}}],Pa=function(){var i,r,s,n=Object(l.k)(),d=Object(u.useMemo)(function(){var Y,H,W,be;return{user_id:Number.isNaN(Number((Y=n.query)===null||Y===void 0?void 0:Y.user_id))?null:Number((H=n.query)===null||H===void 0?void 0:H.user_id),group_id:Number.isNaN(Number((W=n.query)===null||W===void 0?void 0:W.group_id))?null:Number((be=n.query)===null||be===void 0?void 0:be.group_id)}},[(i=n.query)===null||i===void 0?void 0:i.user_id,(r=n.query)===null||r===void 0?void 0:r.group_id]),j=d.user_id,m=d.group_id,T=Object(q.b)(),y=T.teacherSubjectData,C=T.semester_subject_id,D=Object(u.useState)({loading:!1}),A=Object(N.a)(D,2),G=A[0],M=A[1],z=Object(u.useState)([Number(y==null||(s=y.groups)===null||s===void 0?void 0:s[0].id)]),E=Object(N.a)(z,2),V=E[0],ye=E[1],g=Object(u.useMemo)(function(){var Y;return((Y=y==null?void 0:y.groups)!==null&&Y!==void 0?Y:[]).map(function(H){var W=H.id,be=H.name;return{label:be,value:W}})},[y==null?void 0:y.groups]);return Object(u.useEffect)(function(){if(typeof j!="number"){if(!V.length){M({loading:!1});return}M(function(Y){return Object(c.a)(Object(c.a)({},Y),{},{loading:!0})}),Qt(V).then(function(Y){if(Y.success){var H=Y.data.map(function(W){var be=W.grades,B=Object(Ut.a)(W,Ca);return Object(c.a)(Object(c.a)({},B),{},{grades:be.sort(function(Ce,De){return new Date(De.grade_date).getTime()-new Date(Ce.grade_date).getTime()})})});M(function(W){return Object(c.a)(Object(c.a)({},W),{},{dataSource:H})})}}).finally(function(){M(function(Y){return Object(c.a)(Object(c.a)({},Y),{},{loading:!1})})})}},[V,j]),j!==null&&m!==null?Object(e.jsx)(ya,{user_id:j,group_id:m}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(ce.a.Item,{label:Object(e.jsx)(a.a,{id:"group"}),children:Object(e.jsx)(We.a,{allowClear:!0,mode:"multiple",options:g,value:V,onChange:function(H){return ye(H)}})}),Object(e.jsx)(yt.a,{}),Object(e.jsx)(te.a,{rowKey:"id",search:!1,loading:G.loading,dataSource:G.dataSource,columns:[].concat(Ma,[{title:Object(e.jsx)(a.a,{id:"options"}),render:function(H,W){return[Object(e.jsx)(Ae.a,{to:"/teacher/subjects/".concat(C,"/final-grades?user_id=").concat(W.user.id,"&group_id=").concat(W.group_id),children:Object(e.jsx)(Ne.a,{title:Object(e.jsx)(a.a,{id:"edit"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(ke.a,{})})})},"edit")]}}])})]})},Da=function(i){var r,s,n=i.tab,d=Object(a.l)(),j=Object(a.m)("@@initialState"),m=j.setInitialState,T=j.initialState,y=Object(q.b)(),C=y.teacherSubjectData,D=y.semester_subject_id,A=y.tutors,G=Object(u.useCallback)(Object(xe.a)(T==null?void 0:T.currentUser),[T==null?void 0:T.currentUser]),M=Object(u.useMemo)(function(){return!!A.data.find(function(z){var E,V=z.id;return V===(T==null||(E=T.currentUser)===null||E===void 0?void 0:E.id)})||G(he.a.TeacherListGradeScale)},[]);return C?Object(e.jsx)(re.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(a.a,{id:C==null||(r=C.subject)===null||r===void 0?void 0:r.name}),", ",Object(e.jsx)(a.a,{id:n})]}),tabBarExtraContent:Object(e.jsxs)("div",{style:{display:"flex",padding:"12px",gap:"12px"},children:[Object(e.jsx)($.a,{type:"primary",onClick:function(){return console.log("MSTeams")},children:Object(e.jsx)(a.a,{id:"msTeams",defaultMessage:"msTeams"})}),Object(e.jsx)(Ae.a,{to:"/teacher/subjects/".concat(D,"/exams?exam_id=new"),children:Object(e.jsx)($.a,{type:"primary",children:Object(e.jsx)(a.a,{id:"uploadGrades",defaultMessage:"uploadGrades"})})})]}),header:{breadcrumb:{routes:[{path:"teacher",breadcrumbName:d.formatMessage({id:"Teacher"})},{path:"subjects",breadcrumbName:d.formatMessage({id:"Subjects"})},{path:String(D),breadcrumbName:String((s=C.subject)===null||s===void 0?void 0:s.name)},{path:String(n),breadcrumbName:d.formatMessage({id:n,defaultMessage:String(n)})}]}},children:Object(e.jsxs)(oe.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",activeKey:n,onChange:function(E){m(Object(c.a)({},T)),a.f.push("/teacher/subjects/".concat(D,"/").concat(E))}},children:[Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"groups"}),children:Object(e.jsx)(_e.b,{})},"groups"),Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"students"}),children:Object(e.jsx)(mt,{})},"students"),Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"exams"}),children:Object(e.jsx)(Te,{})},"exams"),Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"schedule"}),children:Object(e.jsx)(la,{})},"schedule"),Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"attendance"}),children:Object(e.jsx)(Jt,{})},"attendance"),M&&Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"grades-scale"}),children:Object(e.jsx)(na,{})},"grades-scale"),Object(e.jsx)(oe.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"final-grades"}),children:Object(e.jsx)(Pa,{})},"final-grades")]})}):Object(e.jsx)(P.a,{})},Ka=de.default=function(){var o=Object(l.l)(),i=o.subjectId,r=o.tab,s=r===void 0?"groups":r;return Object(e.jsx)(q.a,{semester_subject_id:Number(i),children:Object(e.jsx)(Da,{tab:s})})}},p3I6:function(Fe,de,t){"use strict";t.d(de,"b",function(){return q}),t.d(de,"c",function(){return ge}),t.d(de,"a",function(){return He});var c=t("miYZ"),K=t("tsqr"),$=t("tJVT"),f=t("k1fw"),P=t("oBTY"),u=t("q1tI"),oe=t.n(u),a=t("9kvl"),Ae=t("Ty5D"),l=t("H6aw"),re=t("/y+f"),he=t("nKUr"),xe=t.n(he),q=oe.a.createContext({}),_e=function(){return Math.round(Math.random()*99999)},Xe=function pe(te){return te.reduce(function(k,h){return[].concat(Object(P.a)(k),Object(P.a)(h.lessons?pe(h.lessons):[]),[h])},[])},ge=function pe(te){return te.reduce(function(k,h){var w;return[].concat(Object(P.a)(k),Object(P.a)(h.lessons?pe(h.lessons):[]),Object(P.a)((w=h.topics)!==null&&w!==void 0?w:[]))},[])},$e=function pe(te,k,h){return te.map(function(w){var Be,U;return Object(f.a)(Object(f.a)({},w),{},{lessons:w.lessons?pe(w.lessons,k,h):[],topics:w.id===k?[].concat(Object(P.a)((Be=w.topics)!==null&&Be!==void 0?Be:[]),[h]):(U=w.topics)!==null&&U!==void 0?U:[]})})},Ne=function pe(te,k,h){return h?te.map(function(w){return Object(f.a)(Object(f.a)({},w),{},{lessons:[].concat(Object(P.a)(w.lessons?pe(w.lessons,k,h):[]),Object(P.a)(w.id===h?[k]:[]))})}):[].concat(Object(P.a)(te),[k])},v=function pe(te,k,h){return te.map(function(w){return Object(f.a)(Object(f.a)({},w.id===k?h:w),{},{lessons:w.lessons?pe(w.lessons,k,h):[]})})},O=function pe(te,k){return te.map(function(h){return Object(f.a)(Object(f.a)({},h),{},{parent_id:k,lessons:h.lessons?pe(h.lessons,h.id):[]})})},Ve=function pe(te,k){return te.filter(function(h){return h.id!==k}).map(function(h){return Object(f.a)(Object(f.a)({},h),{},{lessons:h.lessons?pe(h.lessons,k):[]})})},ke=function pe(te,k){return te.map(function(h){return Object(f.a)(Object(f.a)({},h),{},{lessons:h.lessons?pe(h.lessons,k):[],topics:h.topics?h.topics.filter(function(w){return w.id!==k}):[]})})},He=function(te){var k=te.children,h=te.id,w=Object(u.useState)(),Be=Object($.a)(w,2),U=Be[0],se=Be[1],b=Object(a.l)(),Ee=Object(u.useMemo)(function(){return U&&U.lessons?ge(U.lessons):[]},[U]),ve=Object(u.useMemo)(function(){return U&&U.lessons?Xe(U.lessons):[]},[U]),Ze=Object(u.useState)([]),Se=Object($.a)(Ze,2),Le=Se[0],Ie=Se[1],Z=Object(Ae.k)();Object(u.useEffect)(function(){Ie([])},[]);var F=Object(u.useCallback)(function(){Object(l.m)(h).then(function(_){return _.success&&se(Object(f.a)(Object(f.a)({},_.data),{},{lessons:O(_.data.lessons)}))})},[h]);Object(u.useEffect)(function(){F()},[F]);var Re=Object(u.useCallback)(function(_){var e=ve.find(function(S){var p;return S==null||(p=S.topics)===null||p===void 0?void 0:p.find(function(x){return x.id===_})});return e?e.id:null},[ve]),Qe=Object(u.useMemo)(function(){var _,e;return(_=Z.query)!==null&&_!==void 0&&_.lesson?{mode:"lesson",id:Number(Z.query.lesson),value:ve.find(function(S){return S.id===Number(Z.query.lesson)})}:(e=Z.query)!==null&&e!==void 0&&e.topic?{mode:"topic",id:Number(Z.query.topic),value:Ee.find(function(S){return S.id===Number(Z.query.topic)})}:{mode:"init"}},[Z.query,U,ve,Ee]),N=Object(u.useCallback)(function(_){var e={course_id:h,topics:[],isNew:!0,id:U?U.lessons.length+1:_e(),order:0,title:b.formatMessage({id:"add_title_here"}),active:!0,parent_id:_};return se(function(S){var p;return Object(f.a)(Object(f.a)({},S),{},{lessons:Ne((p=S==null?void 0:S.lessons)!==null&&p!==void 0?p:[],e,_)})}),e},[h,U]),dt=Object(u.useCallback)(function(_,e){var S=ve.find(function(x){return x.id===_}),p=S&&S.isNew;return(p?Object(l.g)(e):Object(l.u)(_,e)).then(function(x){return K.b.success(x.message),F(),x.success&&se(function(R){var L;return Object(f.a)(Object(f.a)({},R),{},{lessons:v((L=R==null?void 0:R.lessons)!==null&&L!==void 0?L:[],_,Object(f.a)(Object(f.a)({},x.data),{},{isNew:!1}))})})})},[U]),Ye=Object(u.useCallback)(function(_){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,S=(U==null?void 0:U.lessons.findIndex(function(L){return L.id===_}))||0,p=e?S-1:S+1,x=U==null?void 0:U.lessons.map(function(L,je,at){var we=je==S?at[p]:je==p?at[S]:L;return Object(f.a)(Object(f.a)({},we),{},{order:je})});se(function(L){return Object(f.a)(Object(f.a)({},L),{},{lessons:x||[]})});var R=x==null?void 0:x.filter(function(L){return!L.isNew}).map(function(L){return[L.id,L.order]});Object(l.s)({class:"Lesson",orders:R,course_id:h}).then(function(L){L.success&&K.b.success(L.message)})},[U,h]),ut=Object(u.useCallback)(function(_,e){var S,p,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,R=ve.find(function(we){return we.id===_}),L=R==null||(S=R.topics)===null||S===void 0?void 0:S.findIndex(function(we){return we.id===e});if(!(L===void 0||L===-1)){var je=x?L-1:L+1,at=(R==null||(p=R.topics)===null||p===void 0?void 0:p.map(function(we,nt,Te){var ae=nt==L?Te[je]:nt==je?Te[L]:we;return Object(f.a)(Object(f.a)({},ae),{},{order:nt})}))||[];se(function(we){return Object(f.a)(Object(f.a)({},we),{},{lessons:we?we.lessons.map(function(nt){return nt.id===_?Object(f.a)(Object(f.a)({},nt),{},{topics:at}):nt}):[]})})}},[U]),Je=Object(u.useCallback)(function(_){var e,S=ve.find(function(x){return x.id===_}),p=S==null||(e=S.topics)===null||e===void 0?void 0:e.filter(function(x){return!x.isNew}).map(function(x){return[x.id,x.order]});Object(l.s)({class:"Topic",orders:p,course_id:h}).then(function(x){x.success&&K.b.success(x.message)})},[U,h]),ce=Object(u.useCallback)(function(_,e){se(function(p){return Object(f.a)(Object(f.a)({},p),{},{lessons:p?p.lessons.map(function(x){return x.id===_?Object(f.a)(Object(f.a)({},x),{},{topics:e}):x}):[]})});var S=e.map(function(p){return[p.id,p.order]});Object(l.s)({class:"Topic",orders:S,course_id:h}).then(function(p){p.success&&K.b.success(p.message)})},[U]),bt=Object(u.useCallback)(function(_){var e=ve.find(function(p){return p.id===_});if(!!e){var S=e.isNew;S?se(function(p){var x;return Object(f.a)(Object(f.a)({},p),{},{lessons:Ve((x=p==null?void 0:p.lessons)!==null&&x!==void 0?x:[],_)})}):Object(l.o)(_).then(function(p){p.success&&(K.b.success(p.message),se(function(x){var R;return Object(f.a)(Object(f.a)({},x),{},{lessons:Ve((R=x==null?void 0:x.lessons)!==null&&R!==void 0?R:[],_)})}))})}},[U]),jt=Object(u.useCallback)(function(_,e){var S,p=Re(_),x=ve.find(function(je){return je.id===p}),R=x&&((S=x.topics)===null||S===void 0?void 0:S.find(function(je){return je.id===_})),L=R==null?void 0:R.isNew;return(L?Object(l.h)(e):Object(l.v)(_,e)).then(function(je){je.success&&(K.b.success(je.message),F(),a.f.push("/courses/list/".concat(h,"/program/?topic=").concat(je.data.id)),(R==null?void 0:R.topicable_type)===re.f.Video&&setTimeout(function(){F()},5e3))})},[Re,U,F]),J=Object(u.useCallback)(function(_){var e=Re(_),S=ve.find(function(R){return R.id===e});if(!!S){var p=Ee==null?void 0:Ee.find(function(R){return R.id===_}),x=p==null?void 0:p.isNew;x&&!p.topicable?se(function(R){var L;return Object(f.a)(Object(f.a)({},R),{},{lessons:ke((L=R==null?void 0:R.lessons)!==null&&L!==void 0?L:[],_)})}):Object(l.p)(_).then(function(R){R.success&&(K.b.success(R.message),se(function(L){var je;return Object(f.a)(Object(f.a)({},L),{},{lessons:ke((je=L==null?void 0:L.lessons)!==null&&je!==void 0?je:[],_)})}))})}},[U,Re]),_t=Object(u.useCallback)(function(_,e){var S={lesson_id:_,isNew:!0,id:_e(),title:b.formatMessage({id:"add_title_here"}),active:!0,topicable_type:e};return se(function(p){var x;return Object(f.a)(Object(f.a)({},p),{},{lessons:$e((x=p==null?void 0:p.lessons)!==null&&x!==void 0?x:[],_,S)})}),S},[]),qe=function(e,S){var p=Re(e);se(function(x){var R;return Object(f.a)(Object(f.a)({},x),{},{lessons:x?(R=x.lessons)===null||R===void 0?void 0:R.map(function(L){if(L.id===p){var je;return Object(f.a)(Object(f.a)({},L),{},{topics:(je=L.topics)===null||je===void 0?void 0:je.map(function(at){return at.id===e?S.file.response.data:at})})}return L}):[]})}),a.f.push("/courses/list/".concat(h,"/program/?topic=").concat(S.file.response.data.id))},ft=Object(u.useCallback)(function(_){return Object(l.d)(_).then(function(e){if(e.success){K.b.success(e.message);var S=Re(_);se(function(p){var x;return Object(f.a)(Object(f.a)({},p),{},{lessons:p?(x=p.lessons)===null||x===void 0?void 0:x.map(function(R){if(R.id===S){var L=R.topics||[];return Object(f.a)(Object(f.a)({},R),{},{topics:[].concat(Object(P.a)(L),[e.data])})}return R}):[]})})}})},[U,Re]),We=Object(u.useCallback)(function(_){return Object(l.c)(_).then(function(e){e.success&&(K.b.success(e.message),se(function(S){return Object(f.a)(Object(f.a)({},S),{},{lessons:S?[].concat(Object(P.a)(S.lessons),[e.data]):[]})}))})},[]),ze={state:U,h5ps:Le,id:h,addNewLesson:N,updateLesson:dt,updateTopic:jt,deleteLesson:bt,sortLesson:Ye,addNewTopic:_t,deleteTopic:J,sortTopic:ut,sortTopics:ce,updateTopicsOrder:Je,onTopicUploaded:qe,cloneTopic:ft,cloneLesson:We,currentEditMode:Qe,getLessons:F};return Object(he.jsx)(q.Provider,{value:ze,children:k})}},quyA:function(Fe,de){var t="\\ud800-\\udfff",c="\\u0300-\\u036f",K="\\ufe20-\\ufe2f",$="\\u20d0-\\u20ff",f=c+K+$,P="\\ufe0e\\ufe0f",u="\\u200d",oe=RegExp("["+u+t+f+P+"]");function a(Ae){return oe.test(Ae)}Fe.exports=a},wy8a:function(Fe,de,t){var c=t("KxBF");function K($,f,P){var u=$.length;return P=P===void 0?u:P,!f&&P>=u?$:c($,f,P)}Fe.exports=K}}]);
