"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7480,2803,8047],{78677:function(ye,te,t){var ae=t(67294),z=t(2759),k=function(){return k=Object.assign||function(X){for(var c,$=1,T=arguments.length;$<T;$++){c=arguments[$];for(var G in c)Object.prototype.hasOwnProperty.call(c,G)&&(X[G]=c[G])}return X},k.apply(this,arguments)},J=(0,ae.forwardRef)(function(X,c){return ae.createElement(z.P,k({},X,{chartType:"Column",ref:c}))});te.Z=J},58664:function(ye,te,t){t.d(te,{T:function(){return R}});var ae=t(19632),z=t.n(ae),k=t(5574),J=t.n(k),X=t(74656),c=t(74330),$=t(67294),T=t(51490),G=t(99100),K=t(32283),xe=t(80854),E=t(85893),ve=function(V){return V.map(function(N){return"name"in N?{id:Number(N.id),name:N.name}:{id:Number(N.id),name:N.title?N.title:""}})},R=function(V){var N=V.value,re=V.onChange,oe=V.multiple,le=oe===void 0?!1:oe,Ce=V.defaultValue,ue=V.modelType,Y=ue===void 0?"COURSE":ue,W=(0,$.useState)([]),de=J()(W,2),ee=de[0],m=de[1],a=(0,$.useState)(!1),ge=J()(a,2),he=ge[0],pe=ge[1],x=(0,$.useRef)(),Me=(0,$.useCallback)(function(j){var _,w,Q,H;switch(Y){case"COURSE":return(0,G.N7)(j,{signal:x==null||(_=x.current)===null||_===void 0?void 0:_.signal});case"WEBINAR":return(0,K.i5)(j,{signal:x==null||(w=x.current)===null||w===void 0?void 0:w.signal});case"CONSULTATIONS":return(0,T.sL)(j,{signal:x==null||(Q=x.current)===null||Q===void 0?void 0:Q.signal});default:return(0,G.N7)(j,{signal:x==null||(H=x.current)===null||H===void 0?void 0:H.signal})}},[Y,x]),je=(0,$.useCallback)(function(j){var _,w,Q,H;switch(Y){case"COURSE":return(0,G.XR)(Number(j),{signal:(_=x.current)===null||_===void 0?void 0:_.signal});case"WEBINAR":return(0,K.tz)(Number(j),{signal:(w=x.current)===null||w===void 0?void 0:w.signal});case"CONSULTATIONS":return(0,T.hW)(Number(j),{signal:(Q=x.current)===null||Q===void 0?void 0:Q.signal});default:return(0,G.XR)(Number(j),{signal:(H=x.current)===null||H===void 0?void 0:H.signal})}},[Y,x]),se=(0,$.useCallback)(function(j){pe(!0),x.current&&x.current.abort(),x.current=new AbortController,Me(j?{name:j}:{}).then(function(_){_.success&&m(ve(_.data))}).catch(function(_){return console.error(_)}).finally(function(){pe(!1)})},[Y]),e=(0,$.useCallback)(function(j){se(j)},[se]);return(0,$.useEffect)(function(){return x.current=new AbortController,N&&je(Number(N)).then(function(j){j&&j.success&&m(function(_){return[].concat(z()(_),z()(ve([j.data])))})}),function(){x.current&&x.current.abort()}},[N,Y]),(0,E.jsx)(X.default,{defaultValue:Ce,onFocus:function(){return se()},allowClear:!0,style:{width:"100%"},value:N,onChange:re,mode:le?"multiple":void 0,showSearch:!0,onSearch:e,placeholder:(0,E.jsx)(xe.FormattedMessage,{id:"select_content",defaultMessage:"select_content"}),optionFilterProp:"children",filterOption:function(_,w){if(w&&w.children){var Q;return(w==null||(Q=w.children)===null||Q===void 0?void 0:Q.toString().toLowerCase().indexOf(_.toLowerCase()))>=0}return!0},loading:he,notFoundContent:he?(0,E.jsx)(c.Z,{size:"small"}):null,optionLabelProp:"label",children:ee.map(function(j){return(0,E.jsx)(X.default.Option,{value:j.id,label:j.name,children:j.name},j.id)})})}},92008:function(ye,te,t){t.r(te),t.d(te,{QuestionareForm:function(){return Te},default:function(){return ke}});var ae=t(19632),z=t.n(ae),k=t(9783),J=t.n(k),X=t(97857),c=t.n(X),$=t(15009),T=t.n($),G=t(99289),K=t.n(G),xe=t(5574),E=t.n(xe),ve=t(58664),R=t(95020),q=t(78715),V=t(952),N=t(5966),re=t(52688),oe=t(64317),le=t(31199),Ce=t(74453),ue=t(71471),Y=t(75842),W=t(2453),de=t(74330),ee=t(14726),m=t(67294),a=t(80854),ge=t(13769),he=t.n(ge),pe=t(62235),x=t(44167),Me=t(45919),je=t(16894),se=t(60943),e=t(85893),j=["type"],_=function(I){var n=I.record,Z=Y.Z.useForm(),y=E()(Z,1),S=y[0],b=(0,a.useIntl)(),B=(0,m.useMemo)(function(){return{onValuesChange:function(g,i){var C=i,P=C.visible_on_front;(0,R.lt)(n.id,{visible_on_front:P}).then(function(L){W.ZP.success((0,e.jsx)(a.FormattedMessage,{id:"question_answer_visibility_changed",defaultMessage:L.message}))}).catch(function(){return W.ZP.error((0,e.jsx)(a.FormattedMessage,{id:"error",defaultMessage:"error"}))})},submitter:{render:function(){return null}}}},[]);return(0,e.jsx)(V.ZP,c()(c()({form:S},B),{},{children:(0,e.jsx)(re.Z,{name:"visible_on_front",initialValue:n.visible_on_front,checkedChildren:b.formatMessage({id:"visible",defaultMessage:"visible"}),unCheckedChildren:b.formatMessage({id:"hidden",defaultMessage:"hidden"})})}))},w=function(I){var n=I.questionnaireId,Z=I.questions,y=(0,m.useMemo)(function(){return Z&&Z.reduce(function(O,g){return c()(c()({},O),{},J()({},g.id,g.title))},{})},[Z]),S=[{title:(0,e.jsx)(a.FormattedMessage,{id:"questions",defaultMessage:"questions"}),dataIndex:"question_id",hideInSearch:!1,valueEnum:y,valueType:"select"}],b=(0,a.useIntl)(),B=[{title:(0,e.jsx)(a.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,e.jsx)(a.FormattedMessage,{id:"updated_at",defaultMessage:"updated_at"}),dataIndex:"updated_at",hideInSearch:!0,render:function(g,i){return i.updated_at?new Date(i.updated_at).toLocaleString():"-"},sorter:!0},{title:(0,e.jsx)(a.FormattedMessage,{id:"from",defaultMessage:"from"}),dataIndex:"date",hideInSearch:!1,hideInForm:!0,hideInTable:!0,valueType:"date"},{title:(0,e.jsx)(a.FormattedMessage,{id:"to",defaultMessage:"to"}),dataIndex:"dateto",hideInSearch:!1,hideInForm:!0,hideInTable:!0,valueType:"date"},{title:(0,e.jsx)(a.FormattedMessage,{id:"title",defaultMessage:"title"}),dataIndex:"question_title",hideInSearch:!0,sorter:!0},{title:(0,e.jsx)(a.FormattedMessage,{id:"note",defaultMessage:"note"}),dataIndex:"note",hideInSearch:!0,sorter:!0,render:function(g,i){var C,P;return i.note&&((C=i.note)===null||C===void 0?void 0:C.length)>64?((P=i.note)===null||P===void 0?void 0:P.slice(0,64))+"...":i.note}},{title:(0,e.jsx)(a.FormattedMessage,{id:"user",defaultMessage:"user"}),dataIndex:"user_id",hideInSearch:!1,render:function(g,i){var C,P;return(0,e.jsxs)("div",{children:[(0,e.jsx)(pe.Z,{type:"App\\Models\\User",type_id:i.user_id}),(0,e.jsx)("p",{className:"list-paragraph",children:(C=i.user)===null||C===void 0?void 0:C.name}),(0,e.jsx)("p",{className:"list-paragraph",children:(P=i.user)===null||P===void 0?void 0:P.email})]})},renderFormItem:function(g,i,C){var P=i.type,L=he()(i,j);if(P==="form")return null;var h=C.getFieldValue("state");return(0,e.jsx)(x.Z,c()(c()({},L),{},{state:{type:h}}))}},{title:(0,e.jsx)(a.FormattedMessage,{id:"sum_rate",defaultMessage:"sum_rate"}),dataIndex:"rate",hideInSearch:!0,sorter:!0},{title:(0,e.jsx)(a.FormattedMessage,{id:"show_hide_on_front",defaultMessage:"show_hide_on_front"}),dataIndex:"visible_on_front",hideInSearch:!0,sorter:!1,render:function(g,i){return(0,e.jsx)(_,{record:i})}}];return(0,e.jsx)(je.ZP,{headerTitle:b.formatMessage({id:"answers",defaultMessage:"answers"}),search:{layout:"vertical"},rowKey:"id",request:function(g,i){var C=g.pageSize,P=g.current,L=g.question_id,h=g.user_id,r=g.date,u=g.dateto,s=i&&Object.entries(i)[0];return(0,R.l)(n,{per_page:C,page:P,question_id:L,user_id:h,updated_at_from:r?(0,se.WU)(new Date(r),Me.Cu):void 0,updated_at_to:u?(0,se.WU)(new Date(u),Me.Cu):void 0,order_by:s&&s[0],order:s?s[1]==="ascend"?"ASC":"DESC":void 0}).then(function(F){return F.success?{data:F.data,success:!0}:[]})},columns:[].concat(B,S)})},Q=w,H=t(66419),we=t(51042),$e=t(47389),Le=t(82061),Se=t(83062),Ue=t(86738),ne=t(31472),Ve=t(37476),Qe=function(I){var n=(0,a.useIntl)(),Z=m.useState(!1),y=E()(Z,2),S=y[0],b=y[1],B=I.visible,O=I.onVisibleChange,g=I.onFinish,i=I.id,C=I.questionsList,P=Y.Z.useForm(),L=E()(P,1),h=L[0];(0,m.useEffect)(function(){typeof i=="number"&&i>0?(0,R.a5)(i).then(function(u){u.success&&(h.setFieldsValue(u.data),u.data.type===ne.Yo.Review&&b(!0))}):h.resetFields()},[i,h]);var r=Object.values(ne.Yo).map(function(u){return{name:u,label:n.formatMessage({id:"QuestionType.".concat(u)}),value:u,disabled:u===ne.Yo.Review&&C.findIndex(function(s){var F=s.type;return F===ne.Yo.Review})!==-1}});return(0,e.jsxs)(Ve.Y,{form:h,title:n.formatMessage({id:typeof i=="number"&&i>0?"question_edit":"question_add",defaultMessage:typeof i=="number"&&i>0?"question_edit":"question_add"}),width:"400px",visible:B,onVisibleChange:O,onFinish:g,children:[(0,e.jsx)(oe.Z,{name:"type",options:r,label:(0,e.jsx)(a.FormattedMessage,{id:"type"}),initialValue:ne.Yo.Text,onChange:function(s){s===ne.Yo.Review?b(!0):b(!1)}}),(0,e.jsx)(N.Z,{width:"lg",name:"title",label:(0,e.jsx)(a.FormattedMessage,{id:"title"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"title"}),placeholder:n.formatMessage({id:"title"})}),(0,e.jsx)(N.Z,{width:"lg",name:"description",label:(0,e.jsx)(a.FormattedMessage,{id:"description"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"description"}),placeholder:n.formatMessage({id:"description"})}),S&&(0,e.jsx)(le.Z,{width:"lg",name:"max_score",label:(0,e.jsx)(a.FormattedMessage,{id:"max_score"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"max_score"}),placeholder:n.formatMessage({id:"max_score",defaultMessage:"max_score"}),min:0,max:9999,fieldProps:{step:1}}),(0,e.jsx)(le.Z,{width:"lg",name:"position",label:(0,e.jsx)(a.FormattedMessage,{id:"position"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"position"}),placeholder:n.formatMessage({id:"position",defaultMessage:"position"}),min:0,max:9999,fieldProps:{step:1}}),(0,e.jsx)(re.Z,{initialValue:!0,name:"active",label:(0,e.jsx)(a.FormattedMessage,{id:"is_active",defaultMessage:"is_active"})}),(0,e.jsx)(re.Z,{initialValue:!0,name:"public_answers",label:(0,e.jsx)(a.FormattedMessage,{id:"show_hide_on_front",defaultMessage:"show_hide_on_front"})})]})},We=Qe,Be=function(I){var n=I.questionnaireId,Z=I.questions,y=I.fetchData,S=(0,a.useIntl)(),b=(0,m.useState)(!1),B=E()(b,2),O=B[0],g=B[1],i=(0,m.useMemo)(function(){return[{title:(0,e.jsx)(a.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,e.jsx)(a.FormattedMessage,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!1,sorter:!0},{title:(0,e.jsx)(a.FormattedMessage,{id:"type",defaultMessage:"type"}),dataIndex:"type",hideInSearch:!0,sorter:!0,renderText:function(r,u){return S.formatMessage({id:"QuestionType.".concat(u.type)})}},{title:(0,e.jsx)(a.FormattedMessage,{id:"description",defaultMessage:"description"}),dataIndex:"description",hideInSearch:!0,sorter:!0},{title:(0,e.jsx)(a.FormattedMessage,{id:"position",defaultMessage:"position"}),dataIndex:"position",hideInSearch:!0,sorter:!0}]},[]),C=(0,m.useRef)(),P=function(){var h=K()(T()().mark(function r(u,s){var F;return T()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return F=W.ZP.loading(S.formatMessage({id:"loading"})),v.prev=1,v.next=4,s&&s!==-1?(0,R.WW)(s,c()(c()({},u),{},{questionnaire_id:n})):(0,R.xL)(c()(c()({},u),{},{questionnaire_id:n}));case 4:return F(),y(),W.ZP.success(S.formatMessage({id:"success"})),v.abrupt("return",!0);case 10:return v.prev=10,v.t0=v.catch(1),F(),W.ZP.error(S.formatMessage({id:"error"})),v.abrupt("return",!1);case 15:case"end":return v.stop()}},r,null,[[1,10]])}));return function(u,s){return h.apply(this,arguments)}}(),L=(0,m.useCallback)(function(){var h=K()(T()().mark(function r(u){var s;return T()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return s=W.ZP.loading(S.formatMessage({id:"loading"})),p.prev=1,p.next=4,(0,R.Km)(u);case 4:return s(),y(),p.abrupt("return",!0);case 9:return p.prev=9,p.t0=p.catch(1),s(),W.ZP.error((0,e.jsx)(a.FormattedMessage,{id:"error",defaultMessage:"error"})),p.abrupt("return",!1);case 14:case"end":return p.stop()}},r,null,[[1,9]])}));return function(r){return h.apply(this,arguments)}}(),[C,S]);return(0,m.useEffect)(function(){var h;(h=C.current)===null||h===void 0||h.reload()},[Z,y]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(je.ZP,{headerTitle:S.formatMessage({id:"question_list",defaultMessage:"question_list"}),actionRef:C,rowKey:"id",search:{layout:"vertical"},toolBarRender:function(){return[(0,e.jsxs)(ee.ZP,{type:"primary",onClick:function(){g(-1)},children:[(0,e.jsx)(we.Z,{})," ",(0,e.jsx)(a.FormattedMessage,{id:"pages.searchTable.new",defaultMessage:"\u65B0\u5EFA"})]},"primary")]},columns:[].concat(z()(i),[{title:(0,e.jsx)(a.FormattedMessage,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",render:function(r,u){return[(0,e.jsx)(Se.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,e.jsx)(ee.ZP,{type:"primary",icon:(0,e.jsx)($e.Z,{}),onClick:function(){return u.id&&g(u.id)}})},"edit"),(0,e.jsx)(Ue.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:function(){return u.id&&L(u.id)},okText:(0,e.jsx)(a.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(a.FormattedMessage,{id:"no"}),children:(0,e.jsx)(Se.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(ee.ZP,{type:"primary",icon:(0,e.jsx)(Le.Z,{}),danger:!0})})},"delete")]}}]),request:function(r,u){var s=r.title,F=u&&Object.entries(u)[0];return new Promise(function(p){var v=Z?z()(Z):[];s&&(v=v.filter(function(ce){return ce.title.toLowerCase().includes(s.toLowerCase())})),F&&(v=(0,H.Pf)(v,F[0],F[1]!=="ascend")),p({data:v,success:!0,total:v.length})})}}),(0,e.jsx)(We,{id:O,visible:Number.isInteger(O),onVisibleChange:function(r){return r===!1&&g(!1)},questionsList:Z!=null?Z:[],onFinish:function(){var h=K()(T()().mark(function r(u){var s;return T()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,P(u,Number(O));case 2:s=p.sent,s&&g(!1);case 4:case"end":return p.stop()}},r)}));return function(r){return h.apply(this,arguments)}}()})]})},Ke=Be,Pe=t(74656),qe=t(78677),Ye=t(38925),ze={isGroup:!0,xField:"label",yField:"value",seriesField:"type",marginRatio:0},Ge=function(I){var n=I.state,Z=(0,a.useIntl)();return(0,e.jsxs)(q.ZP,{headerBordered:!0,style:{height:"500px"},children:[n.mode==="loading"&&(0,e.jsx)(de.Z,{}),n.mode==="loaded"&&n.value.length>0?(0,e.jsx)(qe.Z,c()(c()({},ze),{},{data:[].concat(z()(n.value),z()(n.value)).map(function(y,S){return{label:y.title,value:S>n.value.length-1?y.count_answers:Number(y.avg_rate),type:S>n.value.length-1?Z.formatMessage({id:"answers"}):"Rating"}})})):n.mode!=="loading"&&(0,e.jsx)("p",{children:(0,e.jsx)(a.FormattedMessage,{id:"no_data",defaultMessage:"no_data"})}),n.mode==="error"&&(0,e.jsx)(Ye.Z,{message:n.error.data.message,type:"error"})]})},Xe=Ge,He=function(I){var n=I.questionnaireId,Z=I.models,y=(0,m.useState)(""),S=E()(y,2),b=S[0],B=S[1],O=(0,m.useState)({mode:"init"}),g=E()(O,2),i=g[0],C=g[1],P=(0,m.useState)(!1),L=E()(P,2),h=L[0],r=L[1],u=(0,m.useCallback)(K()(T()().mark(function s(){var F,p,v;return T()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return F=b.split("/"),r(!0),d.prev=2,d.next=5,(0,R.Hp)(F[2],Number(F[1]),Number(n));case 5:p=d.sent,p instanceof Blob&&(v=document.createElement("a"),v.href=window.URL.createObjectURL(p),v.download="raport_questionaire_".concat(F[2],"_").concat(n,".xlsx"),document.body.appendChild(v),v.click(),document.body.removeChild(v)),d.next=12;break;case 9:d.prev=9,d.t0=d.catch(2),C({mode:"error",error:d.t0});case 12:return d.prev=12,r(!1),d.finish(12);case 15:case"end":return d.stop()}},s,null,[[2,9,12,15]])})),[b,n]);return(0,m.useEffect)(function(){C({mode:"loading"});var s=function(){var F=K()(T()().mark(function p(){var v;return T()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(d.prev=0,!b){d.next=7;break}return d.next=4,(0,R.Cq)(n,Number(b.split("/")[0]),Number(b.split("/")[1]));case 4:d.t0=d.sent,d.next=10;break;case 7:return d.next=9,(0,R.Cq)(n);case 9:d.t0=d.sent;case 10:v=d.t0,v.success&&C({mode:"loaded",value:v.data}),d.next=17;break;case 14:d.prev=14,d.t1=d.catch(0),C({mode:"error",error:d.t1});case 17:case"end":return d.stop()}},p,null,[[0,14]])}));return function(){return F.apply(this,arguments)}}();s()},[n,Z,b]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ue.Z.Title,{level:5,children:(0,e.jsx)(a.FormattedMessage,{id:"questionnaire.raports.filter",defaultMessage:"questionnaire.raports.filter"})}),(0,e.jsx)(Pe.default,{allowClear:!0,style:{minWidth:"400px"},onChange:function(F){return B(F)},children:Z.map(function(s){return(0,e.jsxs)(Pe.default.Option,{value:"".concat(s.model_type_id,"/").concat(s.model_id,"/").concat(s.model_type_title),children:[(0,e.jsx)(a.FormattedMessage,{id:s.model_type_title,defaultMessage:s.model_type_title})," ","- ",s.model_title]},s.id)})}),b&&(0,e.jsxs)("div",{children:[(0,e.jsx)("br",{}),(0,e.jsx)(ee.ZP,{onClick:u,loading:h,children:(0,e.jsx)(a.FormattedMessage,{id:"download"})})]}),(0,e.jsx)("hr",{}),(0,e.jsx)(q.ZP,{split:"vertical",children:(0,e.jsx)(q.ZP,{colSpan:24,layout:"center",children:(0,e.jsx)(Xe,{state:i})})})]})},Je=He,Ie=ue.Z.Title,Te=function(){var I,n,Z=(0,a.useParams)(),y=Z.questionnaireId,S=(0,a.useIntl)(),b=y==="new",B=Y.Z.useForm(),O=E()(B,1),g=O[0],i=Y.Z.useForm(),C=E()(i,1),P=C[0],L=(0,m.useState)(),h=E()(L,2),r=h[0],u=h[1],s=(0,m.useState)("questionnaire"),F=E()(s,2),p=F[0],v=F[1],ce=(0,m.useState)(),d=E()(ce,2),Ze=d[0],et=d[1],tt=(0,m.useState)({}),Ee=E()(tt,2),me=Ee[0],Oe=Ee[1],at=(0,m.useState)({}),_e=E()(at,2),Ae=_e[0],rt=_e[1],De=(0,m.useCallback)(K()(T()().mark(function o(){var l;return T()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,R.xR)();case 2:l=f.sent,l.success&&et(l.data);case 4:case"end":return f.stop()}},o)})),[]),Re=(0,m.useCallback)(function(o,l){return o.reduce(function(M,f){return(M[f[l]]=M[f[l]]||[]).push(f.model_id),M},{})},[]),fe=(0,m.useCallback)(K()(T()().mark(function o(){var l;return T()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,(0,R.Iu)(Number(y));case 2:l=f.sent,l.success&&(u(c()({},l.data)),l.data.models&&Oe(Re(l.data.models,"model_type_id")));case 4:case"end":return f.stop()}},o)})),[y,Re]);(0,m.useEffect)(function(){if(De(),b){u({title:"new"});return}fe()},[y,fe,De,b]);var st=(0,m.useCallback)(function(o,l){Oe(function(M){return c()(c()({},M),{},J()({},l,o))})},[]),Fe=(0,m.useCallback)(function(o){var l=[];return Object.keys(o).map(function(M){l.push.apply(l,z()(o[M].map(function(f){return{model_id:Number(f),model_type_id:Number(M),target_group:P.getFieldValue("models.".concat(Number(M),".").concat(Number(f),".target_group")),display_frequency_minutes:P.getFieldValue("models.".concat(Number(M),".").concat(Number(f),".display_frequency_minutes"))}})))}),l},[P]),nt=(0,m.useMemo)(function(){return{onFinish:function(){var o=K()(T()().mark(function M(f){var U,A;return T()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(D.prev=0,!b){D.next=9;break}return D.next=4,(0,R.wW)(c()(c()({},f),{},{models:Fe(me)}));case 4:U=D.sent,U.success&&a.history.push("/other/questionnaire/".concat(U.data.id)),W.ZP.success((0,e.jsx)(a.FormattedMessage,{id:"success",defaultMessage:"success"})),D.next=14;break;case 9:return D.next=11,(0,R.xN)(Number(r==null?void 0:r.id),c()(c()({},f),{},{models:Fe(me)}));case 11:A=D.sent,A.success&&fe(),W.ZP.success((0,e.jsx)(a.FormattedMessage,{id:"success",defaultMessage:"success"}));case 14:D.next=19;break;case 16:D.prev=16,D.t0=D.catch(0),W.ZP.error((0,e.jsx)(a.FormattedMessage,{id:"error",defaultMessage:"error"}));case 19:case"end":return D.stop()}},M,null,[[0,16]])}));function l(M){return o.apply(this,arguments)}return l}(),initialValues:r}},[r,me,fe,Fe,b]),Ne=(0,m.useCallback)(function(o){var l;return r&&((l=r.models)===null||l===void 0?void 0:l.filter(function(M){return M.model_type_title===o}))},[r]),it=(0,m.useCallback)(function(o,l,M,f){var U;return((U=Ne(l))===null||U===void 0||(U=U.find(function(A){return A.model_id===Number(o)}))===null||U===void 0?void 0:U.model_title)||Ae[f][M]},[Ne,Ae]),ot=(0,m.useMemo)(function(){var o;return r==null||(o=r.models)===null||o===void 0?void 0:o.reduce(function(l,M){var f="models.".concat(M.model_type_id,".").concat(M.model_id);return l["".concat(f,".target_group")]=M.target_group,l["".concat(f,".display_frequency_minutes")]=M.display_frequency_minutes,l},{})},[r==null?void 0:r.models]);if(!r)return(0,e.jsx)(de.Z,{});var lt=[{label:(0,e.jsx)(a.FormattedMessage,{id:"author"}),value:"author"},{label:(0,e.jsx)(a.FormattedMessage,{id:"users"}),value:"user"}];return(0,e.jsx)(Ce._z,{title:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.FormattedMessage,{id:r!=null&&r.title?"questionnaire":"new_questionnaire"})}),header:{breadcrumb:{routes:[{path:"other/questionnaire",breadcrumbName:S.formatMessage({id:"menu.Other activities.Questionnaire"})},{path:String(y),breadcrumbName:S.formatMessage({id:"form"})},{path:"/",breadcrumbName:String(r==null?void 0:r.title)}]}},children:(0,e.jsxs)(q.ZP,{tabs:{type:"card",defaultActiveKey:"questionnaire",activeKey:p,onChange:function(l){return v(l)}},children:[(0,e.jsxs)(q.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"questionnaire",defaultMessage:"questionnaire"}),children:[(0,e.jsx)(Ie,{level:3,children:(0,e.jsx)(a.FormattedMessage,{id:"questionnaire",defaultMessage:"questionnaire"})}),(0,e.jsx)(V.ZP,c()(c()({},nt),{},{form:g,children:(0,e.jsxs)(V.ZP.Group,{children:[(0,e.jsx)(N.Z,{label:(0,e.jsx)(a.FormattedMessage,{id:"title",defaultMessage:"title"}),rules:[{required:!0}],width:"md",name:"title"}),(0,e.jsx)(re.Z,{width:"md",initialValue:!0,name:"active",label:(0,e.jsx)(a.FormattedMessage,{id:"is_active",defaultMessage:"is_active"})})]})}))]},"questionnaire"),(0,e.jsx)(q.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"questions",defaultMessage:"questions"}),disabled:b,children:(0,e.jsx)(Ke,{questionnaireId:Number(y),questions:r.questions||[],fetchData:fe})},"questions"),(0,e.jsx)(q.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"answers",defaultMessage:"answers"}),disabled:b,children:(0,e.jsx)(Q,{questionnaireId:Number(y),questions:r.questions||[]})},"answers"),Ze&&Ze.map(function(o){var l,M,f,U;return(0,e.jsxs)(q.ZP.TabPane,{tab:"".concat(S.formatMessage({id:"assign"})," ").concat(S.formatMessage({id:"to"})," ").concat(S.formatMessage({id:(l=o.title)===null||l===void 0?void 0:l.replace(o.title.charAt(0),o.title.charAt(0).toUpperCase())})),disabled:b,children:[(0,e.jsx)(ve.T,{defaultValue:((M=r.models)===null||M===void 0?void 0:M.filter(function(A){return A.model_type_title===o.title}).map(function(A){return{value:A.model_id,label:A.model_title}}))||[],multiple:!0,onChange:function(be,D){return[st(be,o.id),rt(function(ut){return c()(c()({},ut),{},J()({},o.id,D.map(function(dt){return dt.label})))})]},modelType:(f=o.title)===null||f===void 0?void 0:f.toUpperCase()}),(0,e.jsx)(V.ZP,{form:P,submitter:!1,initialValues:ot,style:{marginTop:"20px"},children:me[o.id]&&((U=me[o.id])===null||U===void 0?void 0:U.map(function(A,be){return(0,e.jsxs)("div",{children:[(0,e.jsx)(Ie,{level:5,children:it(Number(A),o.title,be,o.id)}),(0,e.jsxs)(V.ZP.Group,{children:[(0,e.jsx)(oe.Z,{width:"md",name:"models.".concat(o.id,".").concat(A,".target_group"),label:(0,e.jsx)(a.FormattedMessage,{id:"target_group",defaultMessage:"target_group"}),initialValue:"user",options:lt}),(0,e.jsx)(le.Z,{width:"md",name:"models.".concat(o.id,".").concat(A,".display_frequency_minutes"),label:(0,e.jsx)(a.FormattedMessage,{id:"display_frequency_minutes",defaultMessage:"display_frequency_minutes"})})]})]},String(A))}))}),(0,e.jsx)(ee.ZP,{className:"submit-btn",type:"primary",onClick:function(){return g.submit()},children:(0,e.jsx)(a.FormattedMessage,{id:"questionnaire.submit",defaultMessage:"questionnaire.submit"})})]},String(o.id))}),(0,e.jsx)(q.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"menu.reports",defaultMessage:"menu.reports"}),disabled:b||((I=r.models)===null||I===void 0?void 0:I.length)===0,children:(r==null?void 0:r.models)&&(r==null||(n=r.models)===null||n===void 0?void 0:n.length)>0&&(0,e.jsx)(Je,{questionnaireId:Number(y),models:r.models})},"raport")]})})},ke=Te}}]);

//# sourceMappingURL=p__Questionnaire__form.7e11afbb.async.js.map