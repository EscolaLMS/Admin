"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4519],{82061:function(X,M,t){var o=t(1413),m=t(67294),O=t(47046),a=t(84089),b=function(v,x){return m.createElement(a.Z,(0,o.Z)((0,o.Z)({},v),{},{ref:x,icon:O.Z}))};b.displayName="DeleteOutlined",M.Z=m.forwardRef(b)},47389:function(X,M,t){var o=t(1413),m=t(67294),O=t(27363),a=t(84089),b=function(v,x){return m.createElement(a.Z,(0,o.Z)((0,o.Z)({},v),{},{ref:x,icon:O.Z}))};b.displayName="EditOutlined",M.Z=m.forwardRef(b)},51042:function(X,M,t){var o=t(1413),m=t(67294),O=t(42110),a=t(84089),b=function(v,x){return m.createElement(a.Z,(0,o.Z)((0,o.Z)({},v),{},{ref:x,icon:O.Z}))};b.displayName="PlusOutlined",M.Z=m.forwardRef(b)},16894:function(X,M,t){var o=t(72717);M.ZP=o.Z},27226:function(X,M,t){t.r(M),t.d(M,{channelType:function(){return u},default:function(){return C}});var o=t(26271),m=t(74453),O=t(67294),a=t(80854),b=function(){var e,i=(0,a.useModel)("@@initialState"),d=i.initialState,r=(d==null||(e=d.currentUser)===null||e===void 0?void 0:e.roles)||[],l=(0,O.useCallback)(function(E){var p,P=d==null||(p=d.config)===null||p===void 0||(p=p.find(function(g){return g.key===E}))===null||p===void 0?void 0:p.data;return Array.isArray(r)&&Array.isArray(P)?r.every(function(g){return P.includes(g)}):typeof P=="boolean"?P:!1},[]);return{checkRoles:l}},_=t(15009),v=t.n(_),x=t(99289),F=t.n(x),J=t(5574),z=t.n(J),Y=t(45919),D=t(40658),k=t(51042),Z=t(47389),N=t(82061),W=t(16894),V=t(66309),K=t(2453),w=t(14726),U=t(83062),q=t(86738),H=t(60943),n=t(85893),A=function(e){var i=e.templateType,d=e.channel,r=(0,O.useRef)(),l=(0,a.useIntl)(),E=(0,O.useState)(!1),p=z()(E,2),P=p[0],g=p[1],G=[{title:(0,n.jsx)(a.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,n.jsx)(a.FormattedMessage,{id:"created_at",defaultMessage:"created_at"}),dataIndex:"created_at",hideInSearch:!0,sorter:!0,render:function(T,h){return h.created_at&&(0,H.WU)(new Date(h.created_at),Y.Cu)}},{title:(0,n.jsx)(a.FormattedMessage,{id:"name",defaultMessage:"name"}),dataIndex:"name",hideInSearch:!1,sorter:!0},{title:(0,n.jsx)(a.FormattedMessage,{id:"event",defaultMessage:"event"}),dataIndex:"event",hideInSearch:!0,sorter:!1,render:function(T,h){return(0,n.jsx)(a.FormattedMessage,{id:h.event,defaultMessage:h.event})}},{title:(0,n.jsx)(a.FormattedMessage,{id:"templates.is_default"}),dataIndex:"default",hideInSearch:!0,valueEnum:{true:(0,n.jsx)(V.Z,{color:"success",children:(0,n.jsx)(a.FormattedMessage,{id:"yes"})}),false:(0,n.jsx)(V.Z,{color:"error",children:(0,n.jsx)(a.FormattedMessage,{id:"no"})})}}],S=(0,O.useCallback)(function(){var R=F()(v()().mark(function T(h){var $,B;return v()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return g(!0),$=K.ZP.loading((0,n.jsx)(a.FormattedMessage,{id:"loading",defaultMessage:"loading"})),y.prev=2,y.next=5,(0,D.Xc)(h).then(function(L){g(!1),L.success&&K.ZP.success(L.message)});case 5:return $(),g(!1),(B=r.current)===null||B===void 0||B.reload(),y.abrupt("return",!0);case 11:return y.prev=11,y.t0=y.catch(2),$(),K.ZP.error((0,n.jsx)(a.FormattedMessage,{id:"error",defaultMessage:"error"})),g(!1),y.abrupt("return",!1);case 17:case"end":return y.stop()}},T,null,[[2,11]])}));return function(T){return R.apply(this,arguments)}}(),[r]);return(0,n.jsx)(W.ZP,{headerTitle:l.formatMessage({id:"templates",defaultMessage:"templates"}),loading:P,actionRef:r,rowKey:"id",search:{layout:"vertical"},toolBarRender:function(){return[(0,n.jsx)(a.Link,{to:"/configuration/templates/".concat(i,"/new"),children:(0,n.jsxs)(w.ZP,{type:"primary",children:[(0,n.jsx)(k.Z,{})," ",(0,n.jsx)(a.FormattedMessage,{id:"new",defaultMessage:"new"})]},"primary")},"new")]},request:function(T,h){var $=T.pageSize,B=T.current,j=T.name;g(!0);var y=h&&Object.entries(h)[0];return(0,D.zd)({per_page:$,page:B,channel:d,name:j||void 0,order_by:y&&y[0],order:y?y[1]==="ascend"?"ASC":"DESC":void 0}).then(function(L){return L.success?(g(!1),{data:L.data,total:L.meta.total,success:!0}):[]})},columns:[].concat(G,[{hideInSearch:!0,title:(0,n.jsx)(a.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"option"}),dataIndex:"option",valueType:"option",render:function(T,h){return[(0,n.jsx)(a.Link,{to:"/configuration/templates/".concat(i,"/").concat(h.id),children:(0,n.jsx)(U.Z,{title:(0,n.jsx)(a.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,n.jsx)(w.ZP,{type:"primary",icon:(0,n.jsx)(Z.Z,{})})})},"edit"),(0,n.jsx)(q.Z,{title:(0,n.jsx)(a.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:function(){return S(h.id)},okText:(0,n.jsx)(a.FormattedMessage,{id:"yes"}),cancelText:(0,n.jsx)(a.FormattedMessage,{id:"no"}),children:(0,n.jsx)(U.Z,{title:(0,n.jsx)(a.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,n.jsx)(w.ZP,{type:"primary",icon:(0,n.jsx)(N.Z,{}),danger:!0})})},"delete")]}}])})},c=A,u=function(s){return s.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",s.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",s.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel",s}({}),f=function(){var e=(0,a.useParams)(),i=e.template,d=(0,a.useAccess)(),r=b(),l=r.checkRoles,E=l("hideTemplateTab-sms"),p=l("hideTemplateTab-email");return(0,n.jsx)(m._z,{children:(0,n.jsxs)(o.ZP,{tabs:{type:"card",activeKey:i,onChange:function(g){return a.history.push("/configuration/templates/".concat(g))}},children:[!p&&(0,n.jsx)(o.ZP.TabPane,{tab:(0,n.jsx)(a.FormattedMessage,{id:"email"}),children:(0,n.jsx)(c,{templateType:"email",channel:u.email})},"email"),d.certificatesPermission&&(0,n.jsx)(o.ZP.TabPane,{tab:(0,n.jsx)(a.FormattedMessage,{id:"PDF"}),children:(0,n.jsx)(c,{templateType:"pdf",channel:u.pdf})},"pdf"),!E&&(0,n.jsx)(o.ZP.TabPane,{tab:(0,n.jsx)("span",{children:(0,n.jsx)(a.FormattedMessage,{id:"SMS"})}),children:(0,n.jsx)(c,{templateType:"sms",channel:u.sms})},"sms")]})})},C=f},40658:function(X,M,t){t.d(M,{MZ:function(){return q},Mn:function(){return Y},QB:function(){return k},RN:function(){return w},Rl:function(){return V},XK:function(){return J},Xc:function(){return N},zB:function(){return n},zd:function(){return x}});var o=t(15009),m=t.n(o),O=t(97857),a=t.n(O),b=t(99289),_=t.n(b),v=t(80854);function x(c,u){return F.apply(this,arguments)}function F(){return F=_()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,v.request)("/api/admin/templates",a()({method:"GET",useCache:!1,params:u},f||{})));case 1:case"end":return s.stop()}},c)})),F.apply(this,arguments)}function J(c,u){return z.apply(this,arguments)}function z(){return z=_()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,v.request)("/api/admin/templates/".concat(u),a()({method:"GET"},f||{})));case 1:case"end":return s.stop()}},c)})),z.apply(this,arguments)}function Y(c,u){return D.apply(this,arguments)}function D(){return D=_()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,v.request)("/api/admin/templates",a()({method:"POST",headers:{"Content-Type":"application/json"},data:u},f||{})));case 1:case"end":return s.stop()}},c)})),D.apply(this,arguments)}function k(c,u,f){return Z.apply(this,arguments)}function Z(){return Z=_()(m()().mark(function c(u,f,C){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.request)("/api/admin/templates/".concat(u),a()({method:"PATCH",headers:{"Content-Type":"application/json"},data:f},C||{})));case 1:case"end":return e.stop()}},c)})),Z.apply(this,arguments)}function N(c,u){return W.apply(this,arguments)}function W(){return W=_()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,v.request)("/api/admin/templates/".concat(u),a()({method:"DELETE",headers:{"Content-Type":"application/json"}},f||{})));case 1:case"end":return s.stop()}},c)})),W.apply(this,arguments)}function V(c){return K.apply(this,arguments)}function K(){return K=_()(m()().mark(function c(u){return m()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",(0,v.request)("/api/admin/templates/variables",a()({method:"GET"},u||{})));case 1:case"end":return C.stop()}},c)})),K.apply(this,arguments)}function w(c,u){return U.apply(this,arguments)}function U(){return U=_()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,v.request)("/api/admin/templates/".concat(u,"/preview"),a()({method:"GET"},f||{})));case 1:case"end":return s.stop()}},c)})),U.apply(this,arguments)}function q(c,u,f){return H.apply(this,arguments)}function H(){return H=_()(m()().mark(function c(u,f,C){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.request)("/api/admin/events/trigger-manually/".concat(u),a()({method:"POST",headers:{"Content-Type":"application/json"},data:{users:f}},C||{})));case 1:case"end":return e.stop()}},c)})),H.apply(this,arguments)}function n(c,u,f){return A.apply(this,arguments)}function A(){return A=_()(m()().mark(function c(u,f,C){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.request)("/api/admin/products/".concat(f,"/trigger-event-manually/").concat(u),a()({method:"POST",headers:{"Content-Type":"application/json"}},C||{})));case 1:case"end":return e.stop()}},c)})),A.apply(this,arguments)}},66309:function(X,M,t){t.d(M,{Z:function(){return s}});var o=t(67294),m=t(62208),O=t(93967),a=t.n(O),b=t(98787),_=t(69760),v=t(45353),x=t(53124),F=t(6731),J=t(10274),z=t(14747),Y=t(45503),D=t(91945);const k=e=>{const{paddingXXS:i,lineWidth:d,tagPaddingHorizontal:r,componentCls:l,calc:E}=e,p=E(r).sub(d).equal(),P=E(i).sub(d).equal();return{[l]:Object.assign(Object.assign({},(0,z.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:p,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,F.unit)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${l}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${l}-close-icon`]:{marginInlineStart:P,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${l}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},["&-checkable"]:{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${l}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},["&-hidden"]:{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:p}}),[`${l}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},Z=e=>{const{lineWidth:i,fontSizeIcon:d,calc:r}=e,l=e.fontSizeSM;return(0,Y.TS)(e,{tagFontSize:l,tagLineHeight:(0,F.unit)(r(e.lineHeightSM).mul(l).equal()),tagIconSize:r(d).sub(r(i).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},N=e=>({defaultBg:new J.C(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var W=(0,D.I$)("Tag",e=>{const i=Z(e);return k(i)},N),V=function(e,i){var d={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&i.indexOf(r)<0&&(d[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,r=Object.getOwnPropertySymbols(e);l<r.length;l++)i.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(d[r[l]]=e[r[l]]);return d},w=o.forwardRef((e,i)=>{const{prefixCls:d,style:r,className:l,checked:E,onChange:p,onClick:P}=e,g=V(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:G,tag:S}=o.useContext(x.E_),R=y=>{p==null||p(!E),P==null||P(y)},T=G("tag",d),[h,$,B]=W(T),j=a()(T,`${T}-checkable`,{[`${T}-checkable-checked`]:E},S==null?void 0:S.className,l,$,B);return h(o.createElement("span",Object.assign({},g,{ref:i,style:Object.assign(Object.assign({},r),S==null?void 0:S.style),className:j,onClick:R})))}),U=t(98719);const q=e=>(0,U.Z)(e,(i,d)=>{let{textColor:r,lightBorderColor:l,lightColor:E,darkColor:p}=d;return{[`${e.componentCls}${e.componentCls}-${i}`]:{color:r,background:E,borderColor:l,"&-inverse":{color:e.colorTextLightSolid,background:p,borderColor:p},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}});var H=(0,D.bk)(["Tag","preset"],e=>{const i=Z(e);return q(i)},N);function n(e){return typeof e!="string"?e:e.charAt(0).toUpperCase()+e.slice(1)}const A=(e,i,d)=>{const r=n(d);return{[`${e.componentCls}${e.componentCls}-${i}`]:{color:e[`color${d}`],background:e[`color${r}Bg`],borderColor:e[`color${r}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var c=(0,D.bk)(["Tag","status"],e=>{const i=Z(e);return[A(i,"success","Success"),A(i,"processing","Info"),A(i,"error","Error"),A(i,"warning","Warning")]},N),u=function(e,i){var d={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&i.indexOf(r)<0&&(d[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,r=Object.getOwnPropertySymbols(e);l<r.length;l++)i.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(d[r[l]]=e[r[l]]);return d};const f=(e,i)=>{const{prefixCls:d,className:r,rootClassName:l,style:E,children:p,icon:P,color:g,onClose:G,closeIcon:S,closable:R,bordered:T=!0}=e,h=u(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","closeIcon","closable","bordered"]),{getPrefixCls:$,direction:B,tag:j}=o.useContext(x.E_),[y,L]=o.useState(!0);o.useEffect(()=>{"visible"in h&&L(h.visible)},[h.visible]);const te=(0,b.o2)(g),ne=(0,b.yT)(g),ee=te||ne,le=Object.assign(Object.assign({backgroundColor:g&&!ee?g:void 0},j==null?void 0:j.style),E),I=$("tag",d),[oe,ie,ce]=W(I),ue=a()(I,j==null?void 0:j.className,{[`${I}-${g}`]:ee,[`${I}-has-color`]:g&&!ee,[`${I}-hidden`]:!y,[`${I}-rtl`]:B==="rtl",[`${I}-borderless`]:!T},r,l,ie,ce),ae=Q=>{Q.stopPropagation(),G==null||G(Q),!Q.defaultPrevented&&L(!1)},[,de]=(0,_.Z)({closable:R,closeIcon:S!=null?S:j==null?void 0:j.closeIcon,customCloseIconRender:Q=>Q===null?o.createElement(m.Z,{className:`${I}-close-icon`,onClick:ae}):o.createElement("span",{className:`${I}-close-icon`,onClick:ae},Q),defaultCloseIcon:null,defaultClosable:!1}),me=typeof h.onClick=="function"||p&&p.type==="a",re=P||null,pe=re?o.createElement(o.Fragment,null,re,p&&o.createElement("span",null,p)):p,se=o.createElement("span",Object.assign({},h,{ref:i,className:ue,style:le}),pe,de,te&&o.createElement(H,{key:"preset",prefixCls:I}),ne&&o.createElement(c,{key:"status",prefixCls:I}));return oe(me?o.createElement(v.Z,{component:"Tag"},se):se)},C=o.forwardRef(f);C.CheckableTag=w;var s=C}}]);
