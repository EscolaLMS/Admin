(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4173,2803],{63434:function(ve,oe,t){"use strict";var B=t(1413),re=t(45987),M=t(22270),y=t(84567),r=t(67294),m=t(90789),Z=t(41550),C=t(85893),z=["options","fieldProps","proFieldProps","valueEnum"],H=r.forwardRef(function(Q,j){var J=Q.options,L=Q.fieldProps,k=Q.proFieldProps,de=Q.valueEnum,_=(0,re.Z)(Q,z);return(0,C.jsx)(Z.Z,(0,B.Z)({ref:j,valueType:"checkbox",valueEnum:(0,M.h)(de,void 0),fieldProps:(0,B.Z)({options:J},L),lightProps:(0,B.Z)({labelFormatter:function(){return(0,C.jsx)(Z.Z,(0,B.Z)({ref:j,valueType:"checkbox",mode:"read",valueEnum:(0,M.h)(de,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,B.Z)({options:J},L),proFieldProps:k},_))}},_.lightProps),proFieldProps:k},_))}),O=r.forwardRef(function(Q,j){var J=Q.fieldProps,L=Q.children;return(0,C.jsx)(y.Z,(0,B.Z)((0,B.Z)({ref:j},J),{},{children:L}))}),U=(0,m.G)(O,{valuePropName:"checked"}),A=U;A.Group=H,oe.Z=A},88280:function(ve,oe,t){"use strict";t.d(oe,{Z:function(){return Ie}});var B=t(4942),re=t(97685),M=t(45987),y=t(74165),r=t(15861),m=t(1413),Z=t(87462),C=t(67294),z=t(42110),H=t(78026),O=function(w,ie){return C.createElement(H.Z,(0,Z.Z)({},w,{ref:ie,icon:z.Z}))},U=C.forwardRef(O),A=t(97462),Q=t(952),j=t(10915),J=t(48171),L=t(53914),k=t(22270),de=t(60249),_=t(14726),fe=t(75842),ne=t(21770),q=t(88306),ee=t(8880),ge=t(72717),e=t(85893),Y=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],Be=["record","position","creatorButtonText","newRecordType","parentKey","style"],De=C.createContext(void 0);function Ze(a){var w=a.children,ie=a.record,he=a.position,ye=a.newRecordType,le=a.parentKey,te=(0,C.useContext)(De);return C.cloneElement(w,(0,m.Z)((0,m.Z)({},w.props),{},{onClick:function(){var pe=(0,r.Z)((0,y.Z)().mark(function Me(Re){var Ce,je,ce,se;return(0,y.Z)().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,(Ce=(je=w.props).onClick)===null||Ce===void 0?void 0:Ce.call(je,Re);case 2:if(se=D.sent,se!==!1){D.next=5;break}return D.abrupt("return");case 5:te==null||(ce=te.current)===null||ce===void 0||ce.addEditRecord(ie,{position:he,newRecordType:ye,parentKey:le});case 6:case"end":return D.stop()}},Me)}));function ue(Me){return pe.apply(this,arguments)}return ue}()}))}function Se(a){var w,ie,he=(0,j.YB)(),ye=a.onTableChange,le=a.maxLength,te=a.formItemProps,pe=a.recordCreatorProps,ue=a.rowKey,Me=a.controlled,Re=a.defaultValue,Ce=a.onChange,je=a.editableFormRef,ce=(0,M.Z)(a,Y),se=(0,C.useRef)(void 0),xe=(0,C.useRef)(),D=(0,C.useRef)();(0,C.useImperativeHandle)(ce.actionRef,function(){return xe.current},[xe.current]);var Ae=(0,ne.Z)(function(){return a.value||Re||[]},{value:a.value,onChange:a.onChange}),Oe=(0,re.Z)(Ae,2),x=Oe[0],we=Oe[1],me=C.useMemo(function(){return typeof ue=="function"?ue:function(s,u){return s[ue]||u}},[ue]),Ee=(0,J.J)(function(s){if(typeof s=="number"&&!a.name){if(s>=x.length)return s;var u=x&&x[s];return me==null?void 0:me(u,s)}if((typeof s=="string"||s>=x.length)&&a.name){var o=x.findIndex(function(n,i){var d;return(me==null||(d=me(n,i))===null||d===void 0?void 0:d.toString())===(s==null?void 0:s.toString())});if(o!==-1)return o}return s});(0,C.useImperativeHandle)(je,function(){var s=function(n){var i,d;if(n==null)throw new Error("rowIndex is required");var c=Ee(n),v=[a.name,(i=c==null?void 0:c.toString())!==null&&i!==void 0?i:""].flat(1).filter(Boolean);return(d=D.current)===null||d===void 0?void 0:d.getFieldValue(v)},u=function(){var n,i=[a.name].flat(1).filter(Boolean);if(Array.isArray(i)&&i.length===0){var d,c=(d=D.current)===null||d===void 0?void 0:d.getFieldsValue();return Array.isArray(c)?c:Object.keys(c).map(function(v){return c[v]})}return(n=D.current)===null||n===void 0?void 0:n.getFieldValue(i)};return(0,m.Z)((0,m.Z)({},D.current),{},{getRowData:s,getRowsData:u,setRowData:function(n,i){var d,c;if(n==null)throw new Error("rowIndex is required");var v=Ee(n),p=[a.name,(d=v==null?void 0:v.toString())!==null&&d!==void 0?d:""].flat(1).filter(Boolean),$=Object.assign({},(0,m.Z)((0,m.Z)({},s(n)),i||{})),P=(0,ee.Z)({},p,$);return(c=D.current)===null||c===void 0||c.setFieldsValue(P),!0}})},[Ee,a.name,D.current]),(0,C.useEffect)(function(){a.controlled&&(x||[]).forEach(function(s,u){var o;(o=D.current)===null||o===void 0||o.setFieldsValue((0,B.Z)({},"".concat(me(s,u)),s))},{})},[(0,L.ZP)(x),a.controlled]),(0,C.useEffect)(function(){if(a.name){var s;D.current=a==null||(s=a.editable)===null||s===void 0?void 0:s.form}},[(w=a.editable)===null||w===void 0?void 0:w.form,a.name]);var S=pe||{},b=S.record,l=S.position,R=S.creatorButtonText,g=S.newRecordType,E=S.parentKey,F=S.style,V=(0,M.Z)(S,Be),W=l==="top",K=(0,C.useMemo)(function(){return typeof le=="number"&&le<=(x==null?void 0:x.length)?!1:pe!==!1&&(0,e.jsx)(Ze,{record:(0,k.h)(b,x==null?void 0:x.length,x)||{},position:l,parentKey:(0,k.h)(E,x==null?void 0:x.length,x),newRecordType:g,children:(0,e.jsx)(_.ZP,(0,m.Z)((0,m.Z)({type:"dashed",style:(0,m.Z)({display:"block",margin:"10px 0",width:"100%"},F),icon:(0,e.jsx)(U,{})},V),{},{children:R||he.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[pe,le,x==null?void 0:x.length]),T=(0,C.useMemo)(function(){return K?W?{components:{header:{wrapper:function(u){var o,n=u.className,i=u.children;return(0,e.jsxs)("thead",{className:n,children:[i,(0,e.jsxs)("tr",{style:{position:"relative"},children:[(0,e.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:K}),(0,e.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(o=ce.columns)===null||o===void 0?void 0:o.length,children:K})]})]})}}}}:{tableViewRender:function(u,o){var n,i;return(0,e.jsxs)(e.Fragment,{children:[(n=(i=a.tableViewRender)===null||i===void 0?void 0:i.call(a,u,o))!==null&&n!==void 0?n:o,K]})}}:{}},[W,K]),N=(0,m.Z)({},a.editable),G=(0,J.J)(function(s,u){var o,n,i;if((o=a.editable)===null||o===void 0||(n=o.onValuesChange)===null||n===void 0||n.call(o,s,u),(i=a.onValuesChange)===null||i===void 0||i.call(a,u,s),a.controlled){var d;a==null||(d=a.onChange)===null||d===void 0||d.call(a,u)}});return(a!=null&&a.onValuesChange||(ie=a.editable)!==null&&ie!==void 0&&ie.onValuesChange||a.controlled&&a!==null&&a!==void 0&&a.onChange)&&(N.onValuesChange=G),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(De.Provider,{value:xe,children:(0,e.jsx)(ge.Z,(0,m.Z)((0,m.Z)((0,m.Z)({search:!1,options:!1,pagination:!1,rowKey:ue,revalidateOnFocus:!1},ce),T),{},{tableLayout:"fixed",actionRef:xe,onChange:ye,editable:(0,m.Z)((0,m.Z)({},N),{},{formProps:(0,m.Z)({formRef:D},N.formProps)}),dataSource:x,onDataSourceChange:function(u){if(we(u),a.name&&l==="top"){var o,n=(0,ee.Z)({},[a.name].flat(1).filter(Boolean),u);(o=D.current)===null||o===void 0||o.setFieldsValue(n)}}}))}),a.name?(0,e.jsx)(A.Z,{name:[a.name],children:function(u){var o,n;if(!se.current)return se.current=x,null;var i=(0,q.Z)(u,[a.name].flat(1)),d=i==null?void 0:i.find(function(c,v){var p;return!(0,de.A)(c,(p=se.current)===null||p===void 0?void 0:p[v])});return se.current=x,d&&(a==null||(o=a.editable)===null||o===void 0||(n=o.onValuesChange)===null||n===void 0||n.call(o,d,i)),null}}):null]})}function Ve(a){var w=Q.ZP.useFormInstance();return a.name?(0,e.jsx)(fe.Z.Item,(0,m.Z)((0,m.Z)({style:{maxWidth:"100%"}},a==null?void 0:a.formItemProps),{},{name:a.name,shouldUpdate:function(he,ye){var le=[a.name].flat(1);try{return JSON.stringify((0,q.Z)(he,le))!==JSON.stringify((0,q.Z)(ye,le))}catch(te){return!0}},children:(0,e.jsx)(Se,(0,m.Z)((0,m.Z)({},a),{},{editable:(0,m.Z)((0,m.Z)({},a.editable),{},{form:w})}))})):(0,e.jsx)(Se,(0,m.Z)({},a))}Ve.RecordCreator=Ze;var Ie=Ve},19411:function(ve,oe,t){"use strict";t.d(oe,{ZP:function(){return A}});var B=t(15009),re=t.n(B),M=t(99289),y=t.n(M),r=t(17578),m=t(2800),Z=t.n(m),C=t(67294),z=t(80854),H=t(85893),O=function(j){var J=j.attrs,L=J.href,k=L.split("/").pop();return(0,H.jsx)("p",{children:(0,H.jsx)("a",{rel:"noreferrer",href:L,target:"_blank",children:k})})},U=function(j){var J=j.value,L=j.onChange,k=j.directory,de=k===void 0?"/wysiwyg":k,_=(0,z.useIntl)();return(0,H.jsx)("div",{className:"form-wysiwyg-markdown",children:(0,H.jsx)(Z(),{excludeBlockMenuItems:["Sketch"],embeds:[{matcher:function(){return!0},component:O}],uploadImage:function(){var fe=y()(re()().mark(function ne(q){var ee,ge;return re()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.next=2,(0,r.ws)(q,de);case 2:if(ee=Y.sent,!ee.success){Y.next=8;break}if(!q.type.includes("image/")){Y.next=7;break}return ge=ee.data[0].name.includes("/")?ee.data[0].name:"".concat(de).concat(ee.data[0].name),Y.abrupt("return",(0,r.pV)(ge,1e3));case 7:return Y.abrupt("return",ee.data[0].url);case 8:throw new Error("Error while uploading");case 9:case"end":return Y.stop()}},ne)}));return function(ne){return fe.apply(this,arguments)}}(),defaultValue:J||"",onChange:function(ne){return L&&L(ne())},placeholder:_.formatMessage({id:"wysiwyg_placeholder"})})})},A=U},63740:function(ve,oe,t){"use strict";t.r(oe),t.d(oe,{default:function(){return Ee}});var B=t(26271),re=t(74453),M=t(75081),y=t(67294),r=t(80854),m=t(15009),Z=t.n(m),C=t(97857),z=t.n(C),H=t(99289),O=t.n(H),U=t(5574),A=t.n(U),Q=t(58638),j=t(952),J=t(24739),L=t(31199),k=t(78957),de=t(96074),_=t(14726),fe=t(38751),ne=t(3598),q=t(7014),ee=t(37476),ge=t(89974),e=t(85893),Y=function(b){var l=b.quiz_id,R=b.visible,g=b.onVisibleChange,E=j.ZP.useForm(),F=A()(E,1),V=F[0],W=(0,y.useCallback)(function(){var K=O()(Z()().mark(function T(N){var G,s,u;return Z()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return G=N.category_ids,n.prev=1,n.next=4,(0,ne.qp)({quiz_id:l,category_ids:G});case 4:s=n.sent,s instanceof Blob&&(u=document.createElement("a"),u.href=window.URL.createObjectURL(s),u.download="quiz_".concat(l,"_questions_by_category_id.xlsx"),document.body.appendChild(u),u.click(),document.body.removeChild(u)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),console.error(n.t0);case 11:return n.prev=11,g(!1),n.finish(11);case 14:case"end":return n.stop()}},T,null,[[1,8,11,14]])}));return function(T){return K.apply(this,arguments)}}(),[l]);return(0,e.jsx)(ee.Y,{title:(0,e.jsx)(r.FormattedMessage,{id:"exportQuestions"}),form:V,visible:R,onVisibleChange:g,onFinish:W,children:(0,e.jsx)(j.ZP.Item,{name:"category_ids",label:(0,e.jsx)(r.FormattedMessage,{id:"categories"}),required:!0,rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"field_required"})}],children:(0,e.jsx)(ge.b,{multiple:!0,type:"question"})})})},Be=function(){var b=(0,q.O)(),l=b.competencyChallenge.data,R=(0,y.useState)(!1),g=A()(R,2),E=g[0],F=g[1],V=(0,y.useState)(!1),W=A()(V,2),K=W[0],T=W[1],N=(0,y.useState)(),G=A()(N,2),s=G[0],u=G[1],o=(0,r.useIntl)(),n=(0,y.useCallback)(function(){return F(!0)},[]),i=(0,y.useCallback)(function(){(l==null?void 0:l.quiz_id)!==void 0&&(T(!0),(0,ne.E8)(l==null?void 0:l.quiz_id).then(function(c){c.success&&u(c.data)}).finally(function(){return T(!1)}))},[l==null?void 0:l.quiz_id]),d=(0,y.useCallback)(function(){var c=O()(Z()().mark(function v(p){return Z()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if((l==null?void 0:l.quiz_id)!==void 0){P.next=2;break}return P.abrupt("return");case 2:T(!0),(0,ne.Lz)(l==null?void 0:l.quiz_id,z()(z()({},p),{},{value:"diagnostic-test"})).then(function(f){f.success&&u(f.data)}).finally(function(){return T(!1)});case 4:case"end":return P.stop()}},v)}));return function(v){return c.apply(this,arguments)}}(),[]);return(0,y.useEffect)(function(){i()},[i]),s?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Y,{visible:E,onVisibleChange:F,quiz_id:s.id}),(0,e.jsxs)("div",{style:{position:"relative",paddingBottom:"64px"},children:[(0,e.jsx)(j.ZP,{submitter:{render:function(v,p){var $=A()(p,2),P=$[0],f=$[1];return(0,e.jsxs)(k.Z,{style:{position:"absolute",bottom:0,left:0},children:[P,f]})}},initialValues:s,onFinish:d,children:(0,e.jsxs)(J.UW,{children:[(0,e.jsx)(L.Z,{name:"max_attempts",label:(0,e.jsx)(r.FormattedMessage,{id:"max_attempts"}),tooltip:(0,e.jsx)(r.FormattedMessage,{id:"max_attempts"}),placeholder:o.formatMessage({id:"max_attempts",defaultMessage:"max_attempts"})}),(0,e.jsx)(L.Z,{name:"max_execution_time",label:(0,e.jsx)(r.FormattedMessage,{id:"max_execution_time"}),tooltip:(0,e.jsx)(r.FormattedMessage,{id:"max_execution_time"}),placeholder:o.formatMessage({id:"max_execution_time",defaultMessage:"max_execution_time"})})]})}),(0,e.jsx)(de.Z,{}),(0,e.jsx)(fe.i,{questions:s.questions,quizId:s.id,onAdded:i,onEdited:i,onRemoved:i,tableHeader:(0,e.jsx)(r.FormattedMessage,{id:"questions"}),tableLoading:K,questionsCategory:{type:"question"},customToolbarElements:[(0,e.jsxs)(_.ZP,{type:"primary",icon:(0,e.jsx)(Q.Z,{}),onClick:n,children:[" ",(0,e.jsx)(r.FormattedMessage,{id:"exportQuestionsByCategory"})]},"export_by_category")]})]})]}):(0,e.jsx)(M.Z,{})},De=t(13769),Ze=t.n(De),Se=t(5966),Ve=t(64317),Ie=t(52688),a=t(90672),w=t(2453),ie=t(86273),he=t(23535),ye=t(44167),le=t(19411),te=t(21711),pe=t(31472),ue=["authors","category"],Me=Object.values(pe.Fh).map(function(S){return{value:S,label:(0,e.jsx)(r.FormattedMessage,{id:"CompetencyChallenges.types.".concat(S)})}}),Re=function(){var b=(0,q.O)(),l=b.competencyChallenge,R=b.categoryDepths,g=b.refreshData,E=(0,r.useParams)(),F=Number(E.id),V=(0,r.useIntl)(),W=j.ZP.useForm(),K=A()(W,1),T=K[0],N=j.ZP.useWatch("type",T),G=Number.isNaN(F),s=(0,y.useMemo)(function(){if(!(l!=null&&l.data))return{};var n=l==null?void 0:l.data,i=n.authors,d=n.category,c=Ze()(n,ue);return z()(z()({},c),{},{authors:i.map(function(v){var p=v.id;return p}),category_id:d==null?void 0:d.id})},[l==null?void 0:l.data]),u=(0,y.useCallback)(function(){var n=O()(Z()().mark(function i(d){var c,v,p,$,P,f,ae,X;return Z()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return c=d.name,v=d.type,p=d.is_active,$=p===void 0?!1:p,P=d.is_highlighted,f=P===void 0?!1:P,ae=d.category_id,I.prev=1,I.next=4,(0,te.v8)({name:c,is_active:$,is_highlighted:f,type:v,category_id:ae});case 4:if(X=I.sent,X.success){I.next=8;break}return w.ZP.error(X.message),I.abrupt("return");case 8:return w.ZP.success(V.formatMessage({id:X.message})),r.history.push("/competency-challenges/".concat(X.data.id,"/main")),I.next=12,g();case 12:I.next=17;break;case 14:I.prev=14,I.t0=I.catch(1),w.ZP.error(V.formatMessage({id:"error"}));case 17:case"end":return I.stop()}},i,null,[[1,14]])}));return function(i){return n.apply(this,arguments)}}(),[]),o=(0,y.useCallback)(function(){var n=O()(Z()().mark(function i(d){var c,v,p,$;return Z()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,c=T.getFieldsValue(["image_url","image_path"]),v=c.image_url,p=c.image_path,f.next=4,(0,te.dA)(F,z()(z()({},d),{},{image_url:v,image_path:p}));case 4:if($=f.sent,$.success){f.next=8;break}return w.ZP.error($.message),f.abrupt("return");case 8:return w.ZP.success(V.formatMessage({id:$.message})),f.next=11,g();case 11:f.next=16;break;case 13:f.prev=13,f.t0=f.catch(0),w.ZP.error(V.formatMessage({id:"error"}));case 16:case"end":return f.stop()}},i,null,[[0,13]])}));return function(i){return n.apply(this,arguments)}}(),[F]);return(0,e.jsxs)(j.ZP,{form:T,initialValues:s,onFinish:G?u:o,onValuesChange:function(i){(i==null?void 0:i.type)==="complex"&&T.setFieldValue("category",null)},children:[(0,e.jsxs)(j.ZP.Group,{title:(0,e.jsx)(r.FormattedMessage,{id:"CompetencyChallenges.base"}),children:[(0,e.jsx)(Se.Z,{width:"md",name:"name",label:(0,e.jsx)(r.FormattedMessage,{id:"name"}),placeholder:V.formatMessage({id:"name"}),required:!0,rules:[{required:!0,message:V.formatMessage({id:"field_required"})}]}),(0,e.jsx)(Ve.Z,{width:"md",name:"type",label:(0,e.jsx)(r.FormattedMessage,{id:"type"}),options:Me,required:!0,rules:[{required:!0,message:V.formatMessage({id:"field_required"})}]}),N==="simple"&&(0,e.jsx)(j.ZP.Item,{name:"category_id",required:!0,label:(0,e.jsx)(r.FormattedMessage,{id:"category"}),rules:[{required:!0,message:V.formatMessage({id:"field_required"})}],children:(0,e.jsx)(ie.Z,{enabledDepth:R.role})}),(0,e.jsx)(Ie.Z,{name:"is_active",label:(0,e.jsx)(r.FormattedMessage,{id:"is_active"})}),(0,e.jsx)(Ie.Z,{name:"is_highlighted",label:(0,e.jsx)(r.FormattedMessage,{id:"is_highlighted"}),tooltip:(0,e.jsx)(r.FormattedMessage,{id:"CompetencyChallenges.highlighted"})})]}),!G&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(j.ZP.Group,{title:(0,e.jsx)(r.FormattedMessage,{id:"CompetencyChallenges.additional"}),children:[(0,e.jsx)(j.ZP.Item,{name:"description",label:(0,e.jsx)(r.FormattedMessage,{id:"description"}),valuePropName:"value",style:{width:440},children:(0,e.jsx)(le.ZP,{directory:"competency-challenges/".concat(F)})}),(0,e.jsx)(a.Z,{width:"lg",name:"summary",label:(0,e.jsx)(r.FormattedMessage,{id:"summary"})}),(0,e.jsx)(j.ZP.Item,{name:"authors",label:(0,e.jsx)(r.FormattedMessage,{id:"author"}),style:{width:"100%",maxWidth:440},children:(0,e.jsx)(ye.Z,{multiple:!0})})]}),(0,e.jsx)(he.Z,{wrapInForm:!1,folder:"/competency-challenges/".concat(F),title:"image",action:"/api/admin/competency-challenges/".concat(F,"?_method=PATCH"),src_name:"image_url",form_name:"image",getUploadedSrcField:function(i){return i.file.response.data.image_url},setPath:function(i){return T.setFieldsValue(i)}})]})]})},Ce=t(47389),je=t(82061),ce=t(88280),se=t(83062),xe=t(86738),D=["scale_min","category_id"],Ae=[{title:(0,e.jsx)(r.FormattedMessage,{id:"ID"}),dataIndex:"id",editable:!1,render:function(b,l){if(typeof l.id!="string")return"-";var R=l.id.split("-"),g=A()(R,2),E=g[0],F=g[1];return E==="new"?"-":F}},{title:(0,e.jsx)(r.FormattedMessage,{id:"min_points"}),dataIndex:"scale_min",valueType:"digit",formItemProps:{rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"field_required"})},{type:"number",min:0,max:100,message:(0,e.jsx)(r.FormattedMessage,{id:"number_between",values:{min:0}})}]},fieldProps:{min:0}},{title:(0,e.jsx)(r.FormattedMessage,{id:"category"}),dataIndex:"category_id",render:function(b,l){return l.category_name},formItemProps:{rules:[{required:!0,message:(0,e.jsx)(r.FormattedMessage,{id:"field_required"})}]},renderFormItem:function(b,l,R){var g,E=((g=R.getFieldValue("table"))!==null&&g!==void 0?g:[]).map(function(F){return F.category_id});return(0,e.jsx)(ge.b,{disabledNodes:E})}}],Oe=function(b){return b.map(function(l){var R=l.id,g=l.scale_min,E=l.category;return{id:"old-".concat(R),scale_min:g,category_id:E.id,category_name:E.name_with_breadcrumbs}})},x=function(){var b,l,R=(0,q.O)(),g=R.competencyChallenge,E=R.refreshData,F=(0,r.useParams)(),V=Number(F.id),W=(b=g==null||(l=g.data)===null||l===void 0?void 0:l.scales)!==null&&b!==void 0?b:[],K=(0,y.useState)([]),T=A()(K,2),N=T[0],G=T[1],s=(0,r.useIntl)(),u=(0,y.useRef)(),o=(0,y.useRef)(),n=(0,y.useRef)(),i=(0,y.useMemo)(function(){return Oe(W)},[W]),d=(0,y.useMemo)(function(){return[].concat(Ae,[{valueType:"option",title:(0,e.jsx)(r.FormattedMessage,{id:"options"}),render:function(v,p,$,P){return[(0,e.jsx)(se.Z,{title:(0,e.jsx)(r.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,e.jsx)(_.ZP,{type:"primary",icon:(0,e.jsx)(Ce.Z,{}),onClick:function(){return P==null?void 0:P.startEditable(p.id)}})},"edit"),(0,e.jsx)(xe.Z,{title:(0,e.jsx)(r.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:O()(Z()().mark(function f(){var ae,X,be,I,Pe,Fe,Te,$e;return Z()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(typeof p.id=="string"){h.next=2;break}return h.abrupt("return");case 2:if(ae=p.id.split("-"),X=A()(ae,2),be=X[0],I=X[1],be!=="new"){h.next=7;break}return Te=(Pe=u.current)===null||Pe===void 0?void 0:Pe.getFieldValue("table"),(Fe=u.current)===null||Fe===void 0||Fe.setFieldValue("table",Te.filter(function(Ne){var We=Ne.id;return We!==p.id})),h.abrupt("return");case 7:return h.next=9,(0,te.sm)(+I);case 9:if($e=h.sent,!$e.success){h.next=13;break}return h.next=13,E();case 13:case"end":return h.stop()}},f)})),okText:(0,e.jsx)(r.FormattedMessage,{id:"ok"}),cancelText:(0,e.jsx)(r.FormattedMessage,{id:"cancel"}),children:(0,e.jsx)(se.Z,{title:(0,e.jsx)(r.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(_.ZP,{type:"primary",icon:(0,e.jsx)(je.Z,{}),danger:!0})})},"delete")]}}])},[]);return(0,e.jsx)(j.ZP,{formRef:u,initialValues:{table:i},submitter:!1,children:(0,e.jsx)(ce.Z,{rowKey:function(v){return v.id},editableFormRef:o,controlled:!0,actionRef:n,name:"table",columns:d,recordCreatorProps:{creatorButtonText:(0,e.jsx)(r.FormattedMessage,{id:"CompetencyChallenges.addNewRow"}),disabled:N.length>0,record:function(v){return{id:"new-".concat(v)}}},editable:{onlyOneLineEditorAlertMessage:s.formatMessage({id:"CompetencyChallenges.onlyOneRowIsEditable"}),onSave:function(){var c=O()(Z()().mark(function p($,P){var f,ae,X,be,I,Pe,Fe,Te,$e;return Z()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(f=P.scale_min,ae=P.category_id,X=Ze()(P,D),typeof X.id=="string"){h.next=3;break}return h.abrupt("return");case 3:if(be=X.id.split("-"),I=A()(be,2),Pe=I[0],Fe=I[1],Pe!=="new"){h.next=12;break}return h.next=7,(0,te.Qd)({scale_min:f,category_id:ae,competency_challenge_id:V});case 7:if(Te=h.sent,!Te.success){h.next=11;break}return h.next=11,E();case 11:return h.abrupt("return");case 12:return h.next=14,(0,te.U_)(+Fe,{scale_min:f,category_id:ae,competency_challenge_id:V});case 14:if($e=h.sent,!$e.success){h.next=18;break}return h.next=18,E();case 18:return h.abrupt("return");case 19:case"end":return h.stop()}},p)}));function v(p,$){return c.apply(this,arguments)}return v}(),deletePopconfirmMessage:(0,e.jsx)(r.FormattedMessage,{id:"deleteQuestion"}),actionRender:function(v,p,$){if(typeof v.id!="string")return[];var P=v.id.split("-"),f=A()(P,1),ae=f[0];return ae==="new"?[$.save,$.delete]:[$.save,$.cancel]},type:"single",editableKeys:N,onChange:G}})})},we=function(){var b,l=(0,q.O)(),R=l.competencyChallenge,g=(0,r.useIntl)(),E=(0,r.useParams)(),F=E.id,V=E.tab,W=V===void 0?"main":V,K=F==="new",T=(0,y.useMemo)(function(){var N;return K?g.formatMessage({id:"CompetencyChallenges.new_challenge"}):(N=R.data)!==null&&N!==void 0&&N.name?R.data.name:g.formatMessage({id:"menu.Competency challenges"})},[g,(b=R.data)===null||b===void 0?void 0:b.name]);return(0,e.jsx)(re._z,{title:T,header:{breadcrumb:{items:[{path:"competency-challenges",breadcrumbName:g.formatMessage({id:"menu.Competency challenges"})},{path:String(F),breadcrumbName:T},{path:W,breadcrumbName:g.formatMessage({id:"CompetencyChallenges.".concat(W)})}]}},children:(0,e.jsxs)(B.ZP,{bodyStyle:{padding:"24px"},tabs:{type:"card",cardProps:{loading:R.loading&&(0,e.jsx)(M.Z,{})},activeKey:W,onChange:function(G){r.history.push("/competency-challenges/".concat(F,"/").concat(G))}},children:[(0,e.jsx)(B.ZP.TabPane,{tab:(0,e.jsx)(r.FormattedMessage,{id:"CompetencyChallenges.main"}),children:(0,e.jsx)(Re,{})},"main"),(0,e.jsx)(B.ZP.TabPane,{tab:(0,e.jsx)(r.FormattedMessage,{id:"CompetencyChallenges.scales"}),disabled:K,children:(0,e.jsx)(x,{})},"scales"),(0,e.jsx)(B.ZP.TabPane,{tab:(0,e.jsx)(r.FormattedMessage,{id:"CompetencyChallenges.diagnostic-test"}),disabled:K,children:(0,e.jsx)(Be,{})},"diagnostic-test")]})})},me=function(){return(0,e.jsx)(q.F,{children:(0,e.jsx)(we,{})})},Ee=me},64599:function(ve,oe,t){var B=t(96263);function re(M,y){var r=typeof Symbol!="undefined"&&M[Symbol.iterator]||M["@@iterator"];if(!r){if(Array.isArray(M)||(r=B(M))||y&&M&&typeof M.length=="number"){r&&(M=r);var m=0,Z=function(){};return{s:Z,n:function(){return m>=M.length?{done:!0}:{done:!1,value:M[m++]}},e:function(U){throw U},f:Z}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var C=!0,z=!1,H;return{s:function(){r=r.call(M)},n:function(){var U=r.next();return C=U.done,U},e:function(U){z=!0,H=U},f:function(){try{!C&&r.return!=null&&r.return()}finally{if(z)throw H}}}}ve.exports=re,ve.exports.__esModule=!0,ve.exports.default=ve.exports}}]);
