(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"4f6N":function(w,m,e){"use strict";var O=e("2qtc"),u=e("kLXV"),I=e("9kvl"),i=e("nKUr"),P=e.n(i),Z=function(W){var S=W.visible,K=W.setManage;return Object(i.jsx)(u.a,{width:"600px",title:Object(i.jsx)(I.a,{id:"course.validate_edit.header",defaultMessage:"course.validate_edit.header"}),visible:S,onOk:function(){return K({showModal:!1,disableEdit:!1,clicked:!0})},onCancel:function(){return K({showModal:!1,disableEdit:!0,clicked:!1})},okText:"OK",cancelText:"Cancel",children:Object(i.jsx)("p",{children:Object(i.jsx)(I.a,{id:"course.validate_edit.content",defaultMessage:"course.validate_edit.content"})})})};m.a=Z},GZq3:function(w,m,e){},Gb5Y:function(w,m,e){"use strict";e.d(m,"b",function(){return Z}),e.d(m,"c",function(){return W}),e.d(m,"e",function(){return K}),e.d(m,"g",function(){return g}),e.d(m,"d",function(){return _}),e.d(m,"f",function(){return ne}),e.d(m,"a",function(){return b});var O=e("k1fw"),u=e("9og8"),I=e("WmNS"),i=e.n(I),P=e("9kvl");function Z(r,o){return R.apply(this,arguments)}function R(){return R=Object(u.a)(i.a.mark(function r(o,y){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(P.f)("/api/admin/consultations",Object(O.a)({method:"GET",useCache:!1,params:Object(O.a)(Object(O.a)({},o),{},{per_page:o&&o.pageSize,page:o&&o.current})},y||{})));case 1:case"end":return n.stop()}},r)})),R.apply(this,arguments)}function W(r,o){return S.apply(this,arguments)}function S(){return S=Object(u.a)(i.a.mark(function r(o,y){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(P.f)("/api/admin/consultations",Object(O.a)({method:"POST",headers:{"Content-Type":"application/json"},data:o},y||{})));case 1:case"end":return n.stop()}},r)})),S.apply(this,arguments)}function K(r,o){return G.apply(this,arguments)}function G(){return G=Object(u.a)(i.a.mark(function r(o,y){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(P.f)("/api/admin/consultations/".concat(o),Object(O.a)({method:"GET",useCache:!1},y||{})));case 1:case"end":return n.stop()}},r)})),G.apply(this,arguments)}function g(r,o,y){return j.apply(this,arguments)}function j(){return j=Object(u.a)(i.a.mark(function r(o,y,F){return i.a.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.abrupt("return",Object(P.f)("/api/admin/consultations/".concat(o),Object(O.a)({method:"PUT",headers:{"Content-Type":"application/json"},data:y},F||{})));case 1:case"end":return N.stop()}},r)})),j.apply(this,arguments)}function _(r,o){return A.apply(this,arguments)}function A(){return A=Object(u.a)(i.a.mark(function r(o,y){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(P.f)("/api/admin/consultations/".concat(o),Object(O.a)({method:"DELETE",useCache:!1},y||{})));case 1:case"end":return n.stop()}},r)})),A.apply(this,arguments)}function ne(r,o){return B.apply(this,arguments)}function B(){return B=Object(u.a)(i.a.mark(function r(o,y){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(P.f)("/api/admin/consultations/".concat(o,"/schedule"),Object(O.a)({method:"GET",useCache:!1},y||{})));case 1:case"end":return n.stop()}},r)})),B.apply(this,arguments)}function b(r,o,y){return q.apply(this,arguments)}function q(){return q=Object(u.a)(i.a.mark(function r(o,y,F){return i.a.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.abrupt("return",Object(P.f)("/api/admin/consultations/change-term/".concat(o),Object(O.a)({method:"POST",headers:{"Content-Type":"application/json"},data:{executed_at:y}},F||{})));case 1:case"end":return N.stop()}},r)})),q.apply(this,arguments)}},"J+hL":function(w,m,e){},VlvL:function(w,m,e){"use strict";var O=e("9kvl"),u=e("Ty5D"),I=e("nKUr"),i=e.n(I),P=function(R){var W=R.show,S=Object(O.i)();return Object(I.jsx)(u.b,{when:W,message:S.formatMessage({id:"unsaved_changes"})})};m.a=P},eFHa:function(w,m,e){"use strict";e.d(m,"a",function(){return P});var O=e("tJVT"),u=e("q1tI"),I=e.n(u),i=e("HZtn");function P(){var Z=Object(u.useState)({showModal:!1,disableEdit:!1,clicked:!1}),R=Object(O.a)(Z,2),W=R[0],S=R[1],K=function(g){(g==null?void 0:g.status)==="published"&&g!==null&&g!==void 0&&g.active_from&&Object(i.a)(new Date(g==null?void 0:g.active_from))&&!W.clicked?S({showModal:!1,disableEdit:!0,clicked:!1}):S({showModal:!1,disableEdit:!1,clicked:!1})};return{manageCourseEdit:W,setManageCourseEdit:S,validateCourseEdit:K}}},q34N:function(w,m,e){"use strict";var O=e("tJVT"),u=e("0eZe"),I=e("q1tI"),i=e.n(I),P=e("nKUr"),Z=e.n(P),R=function(S){var K=S.productable,G=S.type,g=G===void 0?"card":G,j=Object(I.useState)("attributes"),_=Object(O.a)(j,2),A=_[0],ne=_[1];return Object(P.jsx)(u.a,{productable:K,tab:A,onTabChange:function(b){return ne(b)},type:g})};m.a=R},rh3J:function(w,m,e){"use strict";e.r(m);var O=e("14J3"),u=e("BMrR"),I=e("jCWc"),i=e("kPKH"),P=e("fOrg"),Z=e("+KLJ"),R=e("+L6B"),W=e("2/Rp"),S=e("T2oS"),K=e("W9HT"),G=e("miYZ"),g=e("tsqr"),j=e("k1fw"),_=e("9og8"),A=e("tJVT"),ne=e("WmNS"),B=e.n(ne),b=e("q1tI"),q=e.n(b),r=e("VMEa"),o=e("Qurx"),y=e("yj/a"),F=e("lR9U"),n=e("nhC9"),N=e("hd5d"),Oe=e("tMyG"),a=e("9kvl"),ve=e("Ty5D"),he=e("0WSk"),ge=e("TWax"),se=e("Gb5Y"),Ne=e("OaEy"),pe=e("2fM7"),Ve=e("iQDF"),le=e("+eQT"),He=e("+BJd"),xe=e("mr32"),Ce=e("oBTY"),Ee=e("wd/R"),ae=e.n(Ee),Ge=e("GZq3"),t=e("nKUr"),de=function(f){return f.local().valueOf()},Me=function(f){var v=f.value,s=v===void 0?[]:v,D=f.onChange,p=f.format,T=p===void 0?"DD-MM-YYYY HH:mm":p,Q=f.selectProps,z=Q===void 0?{}:Q,V=Object(b.useState)(!1),L=Object(A.a)(V,2),te=L[0],$=L[1],c=Object(b.useCallback)(function(h){var M=de(h),x=s.indexOf(M),U=Object(Ce.a)(s);x>-1?U.splice(x,1):U.push(M),D(U)},[s]),d=Object(b.useCallback)(function(h){var M=s.indexOf(de(h))>-1;return Object(t.jsx)("div",{className:"ant-picker-cell-inner",style:M?{position:"relative",zIndex:2,display:"inlineBlock",width:"24px",height:"22px",lineHeight:"22px",backgroundColor:"#1890ff",color:"#fff",margin:"auto",borderRadius:"2px",transition:"background 0.3s, border 0.3s"}:{},children:h.date()})},[s]),E=Object(b.useCallback)(function(h){var M=h.value,x=h.onClose,U=function(){x(),D(s.filter(function(oe){return oe!==M}))};return Object(t.jsx)(xe.a,{onClose:U,closable:!0,children:ae()(M).format(T)})},[s]),l=function(){return{disabledMinutes:function(){return Array.from({length:59},function(x,U){return U+1})}}};return Object(t.jsx)(pe.a,Object(j.a)(Object(j.a)({},z),{},{allowClear:!0,mode:"multiple",value:s,onClear:function(){return D&&D([])},tagRender:E,open:te,onFocus:function(){return $(!0)},onBlur:function(){return $(!1)},dropdownMatchSelectWidth:!1,dropdownClassName:"multipleDropdownClassName",dropdownStyle:{height:"310px",width:"335px",minWidth:"0"},dropdownRender:function(){return Object(t.jsx)(le.a,{disabledDate:function(x){var U=new Date;return x&&x.valueOf()<=U.setDate(U.getDate()-1)},showTime:{format:"HH"},disabledTime:l,onChange:function(x){return x&&c(x)},open:!0,dateRender:d,style:{visibility:"hidden"},getPopupContainer:function(x){var U=x.parentNode;return U},defaultValue:ae()("00:00","HH")})}}))},ye=Me,ie=e("c+yx"),ce=e("Gn8c"),Pe=e("VlvL"),ue=e("viv7"),De=e("eFHa"),Te=e("4f6N"),$e=e("qbNl"),Se=e("JBPa"),Je=e("5Dmo"),Ae=e("3S7+"),Ye=e("Awhp"),je=e("KrTs"),Ue=e("Qiat"),Ie=function(f){var v=f.data,s=f.onChange,D=Object(b.useState)(!1),p=Object(A.a)(D,2),T=p[0],Q=p[1],z=Object(b.useState)(ae()(v.date)),V=Object(A.a)(z,2),L=V[0],te=V[1],$=Object(b.useCallback)(function(c){te(c),Q(!0),Object(se.a)(v.consultation_term_id,c.format()).then(function(d){d.success?(g.default.success(d.message),s(L)):g.default.error(d.message)}).catch(function(d){return g.default.error(d.toString())}).finally(function(){return Q(!1)})},[L]);return Object(t.jsx)(q.a.Fragment,{children:Object(t.jsx)(le.a,{disabledDate:function(d){var E=new Date;return d&&d.valueOf()<=E.setDate(E.getDate()-1)},disabled:T,value:L,showTime:{format:"HH"},onChange:function(d){d&&$(d)}})})},me={reported:"warning",reject:"error",approved:"success"},Re=[{title:Object(t.jsx)(a.a,{id:"id",defaultMessage:"id"}),dataIndex:"consultation_term_id",hideInSearch:!0},{title:Object(t.jsx)(a.a,{id:"user",defaultMessage:"user"}),dataIndex:"user",render:function(f,v){var s,D,p;return"".concat((s=v.user)===null||s===void 0?void 0:s.first_name," ").concat((D=v.user)===null||D===void 0?void 0:D.last_name," ").concat((p=v.user)===null||p===void 0?void 0:p.email)}},{title:Object(t.jsx)(a.a,{id:"date",defaultMessage:"date"}),dataIndex:"date",render:function(f,v){return ae()(v.date).format("yyyy-MM-DD HH:mm")}},{title:Object(t.jsx)(a.a,{id:"status",defaultMessage:"status"}),dataIndex:"status",render:function(f,v){return Object(t.jsx)(je.a,{status:me[v.status],text:Object(t.jsx)(a.a,{id:v.status})})}}],We=function(f){var v=f.consultation,s=Object(b.useState)(!1),D=Object(A.a)(s,2),p=D[0],T=D[1],Q=Object(b.useState)([]),z=Object(A.a)(Q,2),V=z[0],L=z[1],te=Object(a.i)(),$=Object(b.useCallback)(function(){T(!0),Object(se.f)(v).then(function(d){d.success&&L(d.data)}).catch(function(){g.default.error(Object(t.jsx)(a.a,{id:"error",defaultMessage:"error"}))}).finally(function(){return T(!1)})},[v]);Object(b.useEffect)(function(){$()},[v]);var c=Object(b.useCallback)(function(d){return Object(t.jsx)("ul",{className:"events",children:V.map(function(E){if(d.format("yyyy-MM-DD")===ae()(E.date).format("yyyy-MM-DD")){var l,h,M,x;return Object(t.jsx)("li",{children:Object(t.jsx)(je.a,{status:me[E.status],text:Object(t.jsx)(q.a.Fragment,{children:Object(t.jsxs)(Ae.a,{title:"".concat((l=E.user)===null||l===void 0?void 0:l.first_name," ").concat((h=E.user)===null||h===void 0?void 0:h.last_name," ").concat((M=E.user)===null||M===void 0?void 0:M.email),children:[Object(t.jsx)("small",{children:ae()(E.date).format("HH:mm")})," ",(x=E.user)===null||x===void 0?void 0:x.email]})})})})}return null})})},[V]);return Object(t.jsxs)(q.a.Fragment,{children:[p&&Object(t.jsx)(K.a,{}),Object(t.jsx)(Se.a,{dateCellRender:c}),p?Object(t.jsx)(K.a,{}):Object(t.jsx)(Ue.a,{headerTitle:te.formatMessage({id:"Consultations",defaultMessage:"Consultations"}),loading:p,rowKey:"consultation_term_id",search:!1,request:Object(_.a)(B.a.mark(function d(){return B.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",{data:V,total:V.length,success:!0});case 1:case"end":return l.stop()}},d)})),columns:[].concat(Re,[{title:Object(t.jsx)(a.a,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",width:"10%",render:function(E,l){return[Object(t.jsx)(Ie,{data:l,onChange:function(){return $()}})]}}])})]})},Ke=We,Ze=e("J+hL"),Le=e("q34N"),Be=e("5RzD"),Fe=function(){var f=Object(a.i)(),v=Object(ve.l)(),s=v.consultation,D=v.tab,p=D===void 0?"attributes":D,T=s==="new",Q=Object(b.useState)(!1),z=Object(A.a)(Q,2),V=z[0],L=z[1],te=Object(b.useState)(),$=Object(A.a)(te,2),c=$[0],d=$[1],E=Object(De.a)(),l=E.manageCourseEdit,h=E.setManageCourseEdit,M=E.validateCourseEdit,x=r.a.useForm(),U=Object(A.a)(x,1),be=U[0],oe=Object(b.useCallback)(Object(_.a)(B.a.mark(function J(){var C,Y;return B.a.wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,Object(se.e)(Number(s));case 2:C=X.sent,C.success&&(p==="attributes"&&M(C.data),d(Object(j.a)(Object(j.a)({},C.data),{},{author_id:C.data.author&&C.data.author.id,categories:(Y=C.data.categories)===null||Y===void 0?void 0:Y.map(ie.a)})));case 4:case"end":return X.stop()}},J)})),[s]);Object(b.useEffect)(function(){if(T){d({name:"new"});return}oe()},[s]);var re=Object(b.useMemo)(function(){return{onFinish:function(){var J=Object(_.a)(B.a.mark(function Y(fe){var X,k;return B.a.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(!l.disableEdit){H.next=3;break}return h({showModal:!0,disableEdit:!0,clicked:!1}),H.abrupt("return");case 3:if(X=Object(j.a)(Object(j.a)({},fe),{},{image_url:c&&c.image_url,image_path:c&&c.image_url&&Object(ie.e)(c.image_url),logotype_url:c&&c.logotype_url,logotype_path:c&&c.logotype_path&&Object(ie.e)(c.logotype_path)}),!T){H.next=11;break}return H.next=7,Object(se.c)(X);case 7:k=H.sent,k.success&&(L(!1),a.d.push("/consultations/".concat(k.data.id))),H.next=15;break;case 11:return H.next=13,Object(se.g)(Number(s),X);case 13:k=H.sent,k.success&&(L(!1),M(k.data),a.d.push("/consultations/".concat(k.data.id,"/").concat(p)));case 15:g.default.success(k.message);case 16:case"end":return H.stop()}},Y)}));function C(Y){return J.apply(this,arguments)}return C}(),initialValues:c}},[c,s,p,l]);return c?Object(t.jsx)(Oe.a,{title:T?Object(t.jsx)(a.a,{id:"consultation"}):Object(t.jsx)(a.a,{id:"consultations.edit"}),header:{breadcrumb:{routes:[{path:"consultations",breadcrumbName:f.formatMessage({id:"menu.Consultations"})},{path:String(s),breadcrumbName:f.formatMessage({id:"form"})},{path:"/",breadcrumbName:String(c.name)},{path:String(p),breadcrumbName:String(c.name)}]}},children:Object(t.jsxs)(n.a,{tabs:{type:"card",activeKey:p,onChange:function(C){return a.d.push("/consultations/".concat(s,"/").concat(C))}},children:[Object(t.jsxs)(n.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"attributes"}),children:[l.disableEdit&&Object(t.jsx)(Z.a,{closable:!0,style:{marginBottom:"20px"},type:"warning",message:Object(t.jsx)(a.a,{id:"course_edit_warning_message",defaultMessage:"course_edit_warning_message"}),action:Object(t.jsx)(W.a,{onClick:function(){return h({showModal:!0,disableEdit:!0,clicked:!0})},type:"primary",children:Object(t.jsx)(a.a,{id:"questionnaire.submit",defaultMessage:"questionnaire.submit"})})}),Object(t.jsx)(Pe.a,{show:V})," ",Object(t.jsx)(Te.a,{visible:l.showModal,setManage:h}),Object(t.jsxs)(r.a,Object(j.a)(Object(j.a)({},re),{},{form:be,onValuesChange:function(){L(!0)},children:[Object(t.jsxs)(r.a.Group,{children:[Object(t.jsx)(o.a,{width:"md",name:"name",label:Object(t.jsx)(a.a,{id:"name"}),tooltip:Object(t.jsx)(a.a,{id:"name"}),placeholder:f.formatMessage({id:"name",defaultMessage:"name"}),required:!0,disabled:l.disableEdit}),Object(t.jsx)(o.a,{width:"sm",name:"duration",label:Object(t.jsx)(a.a,{id:"duration"}),tooltip:Object(t.jsx)(a.a,{id:"duration"}),placeholder:f.formatMessage({id:"duration",defaultMessage:"duration"}),disabled:l.disableEdit}),Object(t.jsx)(y.a,{name:"status",width:"xs",label:Object(t.jsx)(a.a,{id:"status"}),tooltip:Object(t.jsx)(a.a,{id:"status_consultation_tooltip"}),valueEnum:ue.a,initialValue:ue.a.draft,placeholder:f.formatMessage({id:"status"}),rules:[{required:!0,message:Object(t.jsx)(a.a,{id:"select"})}],disabled:l.disableEdit})]}),Object(t.jsxs)(r.a.Group,{children:[Object(t.jsx)(F.a,{width:"sm",name:"active_from",label:Object(t.jsx)(a.a,{id:"active_from"}),tooltip:Object(t.jsx)(a.a,{id:"active_from"}),placeholder:f.formatMessage({id:"active_from",defaultMessage:"active_from"}),disabled:l.disableEdit}),Object(t.jsx)(F.a,{width:"sm",name:"active_to",label:Object(t.jsx)(a.a,{id:"active_to"}),tooltip:Object(t.jsx)(a.a,{id:"active_to"}),placeholder:f.formatMessage({id:"active_to",defaultMessage:"active_to"}),disabled:l.disableEdit}),Object(t.jsx)(r.a.Item,{name:"author_id",label:Object(t.jsx)(a.a,{id:"tutor"}),tooltip:Object(t.jsx)(a.a,{id:"tutor_consultation_tooltip"}),valuePropName:"value",required:!0,children:Object(t.jsx)(he.a,{})})]}),Object(t.jsx)(r.a.Group,{children:Object(t.jsx)(r.a.Item,{name:"description",label:Object(t.jsx)(a.a,{id:"description"}),tooltip:Object(t.jsx)(a.a,{id:"description_tooltip"}),valuePropName:"value",required:!0,children:Object(t.jsx)(N.a,{directory:"consultation/".concat(s,"/wysiwyg")})})}),Object(t.jsx)(r.a.Group,{children:Object(t.jsx)(r.a.Item,{valuePropName:"value",name:"proposed_terms",tooltip:Object(t.jsx)(a.a,{id:"proposed_terms_tooltip"}),label:Object(t.jsx)(a.a,{id:"consultations.proposed_terms"}),children:Object(t.jsx)(ye,{})})})]}))]},"attributes"),!T&&Object(t.jsx)(n.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"product"}),disabled:l.disableEdit,children:s&&Object(t.jsx)(Le.a,{type:"line",productable:{class_type:"App\\Models\\Consultation",class_id:s,name:String(c.name)}})},"product"),!T&&Object(t.jsx)(n.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"media"}),disabled:l.disableEdit,children:Object(t.jsx)(r.a,Object(j.a)(Object(j.a)({},re),{},{children:Object(t.jsx)(ce.a,{folder:"consultation/".concat(s),title:"image",action:"/api/admin/consultations/".concat(s),src_name:"image_url",form_name:"image",getUploadedSrcField:function(C){return C.file.response.data.image_url},setPath:function(C){return d(function(Y){return Object(j.a)(Object(j.a)({},Y),C)})}})}))},"media"),!T&&Object(t.jsx)(n.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"categories"}),disabled:l.disableEdit,children:Object(t.jsx)(u.a,{children:Object(t.jsx)(i.a,{span:12,children:Object(t.jsx)(r.a,Object(j.a)(Object(j.a)({},re),{},{children:Object(t.jsx)(r.a.Item,{label:Object(t.jsx)(a.a,{id:"categories"}),name:"categories",valuePropName:"value",children:Object(t.jsx)(ge.a,{})})}))})})},"categories")," ",!T&&Object(t.jsx)(n.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"branding"}),disabled:l.disableEdit,children:Object(t.jsx)(r.a,Object(j.a)(Object(j.a)({},re),{},{children:Object(t.jsx)(ce.a,{folder:"consultation/".concat(s),title:"logotype",action:"/api/admin/consultations/".concat(s),src_name:"logotype_url",form_name:"logotype",getUploadedSrcField:function(C){return C.file.response.data.logotype_url},setPath:function(C){return d(function(Y){return Object(j.a)(Object(j.a)({},Y),C)})}})}))},"branding")," ",!T&&Object(t.jsx)(n.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"user_submission"}),disabled:l.disableEdit,children:Object(t.jsx)(u.a,{children:Object(t.jsx)(i.a,{span:12,children:s&&Object(t.jsx)(Be.a,{id:Number(s),type:"App\\Models\\Consultation"})})})},"user_submission"),!T&&Object(t.jsx)(n.a.TabPane,{tab:Object(t.jsx)(a.a,{id:"consultations.calendar"}),children:Object(t.jsx)(Ke,{consultation:Number(s)})},"calendar")]})}):Object(t.jsx)(K.a,{})},Qe=m.default=Fe},viv7:function(w,m,e){"use strict";e.d(m,"a",function(){return O});var O;(function(u){u.draft="draft",u.published="published",u.archived="archived",u.published_unactivated="published_unactivated"})(O||(O={}))}}]);
