"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[7937,2803],{56717:function(_t,et,o){var He=o(1413),c=o(67294),Ye=o(93696),I=o(84089),ye=function(he,C){return c.createElement(I.Z,(0,He.Z)((0,He.Z)({},he),{},{ref:C,icon:Ye.Z}))};ye.displayName="InfoCircleOutlined",et.Z=c.forwardRef(ye)},78677:function(_t,et,o){var He=o(67294),c=o(74559),Ye=function(){return Ye=Object.assign||function(ye){for(var A,he=1,C=arguments.length;he<C;he++){A=arguments[he];for(var v in A)Object.prototype.hasOwnProperty.call(A,v)&&(ye[v]=A[v])}return ye},Ye.apply(this,arguments)},I=function(ye){return He.createElement(c.P,Ye({},ye,{chartType:"Column"}))};et.Z=I},88280:function(_t,et,o){o.d(et,{Z:function(){return xt}});var He=o(4942),c=o(97685),Ye=o(45987),I=o(74165),ye=o(15861),A=o(1413),he=o(87462),C=o(67294),v=o(42110),s=o(78026),le=function(Te,N){return C.createElement(s.Z,(0,he.Z)({},Te,{ref:N,icon:v.Z}))},f=C.forwardRef(le),P=o(97462),i=o(952),j=o(10915),Z=o(48171),se=o(53914),E=o(22270),Q=o(60249),ue=o(14726),Ae=o(75842),re=o(21770),ct=o(88306),ot=o(8880),_e=o(72717),W=o(85893),de=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],O=["record","position","creatorButtonText","newRecordType","parentKey","style"],ee=C.createContext(void 0);function ke(M){var Te=M.children,N=M.record,e=M.position,Re=M.newRecordType,$e=M.parentKey,Ie=(0,C.useContext)(ee);return C.cloneElement(Te,(0,A.Z)((0,A.Z)({},Te.props),{},{onClick:function(){var Se=(0,ye.Z)((0,I.Z)().mark(function ge(Fe){var We,Je,Me,xe;return(0,I.Z)().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.next=2,(We=(Je=Te.props).onClick)===null||We===void 0?void 0:We.call(Je,Fe);case 2:if(xe=H.sent,xe!==!1){H.next=5;break}return H.abrupt("return");case 5:Ie==null||(Me=Ie.current)===null||Me===void 0||Me.addEditRecord(N,{position:e,newRecordType:Re,parentKey:$e});case 6:case"end":return H.stop()}},ge)}));function be(ge){return Se.apply(this,arguments)}return be}()}))}function y(M){var Te,N,e=(0,j.YB)(),Re=M.onTableChange,$e=M.maxLength,Ie=M.formItemProps,Se=M.recordCreatorProps,be=M.rowKey,ge=M.controlled,Fe=M.defaultValue,We=M.onChange,Je=M.editableFormRef,Me=(0,Ye.Z)(M,de),xe=(0,C.useRef)(void 0),pe=(0,C.useRef)(),H=(0,C.useRef)();(0,C.useImperativeHandle)(Me.actionRef,function(){return pe.current},[pe.current]);var oe=(0,re.Z)(function(){return M.value||Fe||[]},{value:M.value,onChange:M.onChange}),D=(0,c.Z)(oe,2),X=D[0],St=D[1],L=C.useMemo(function(){return typeof be=="function"?be:function(ce,Ge){return ce[be]||Ge}},[be]),te=(0,Z.J)(function(ce){if(typeof ce=="number"&&!M.name){if(ce>=X.length)return ce;var Ge=X&&X[ce];return L==null?void 0:L(Ge,ce)}if((typeof ce=="string"||ce>=X.length)&&M.name){var me=X.findIndex(function(fe,je){var Ee;return(L==null||(Ee=L(fe,je))===null||Ee===void 0?void 0:Ee.toString())===(ce==null?void 0:ce.toString())});if(me!==-1)return me}return ce});(0,C.useImperativeHandle)(Je,function(){var ce=function(fe){var je,Ee;if(fe==null)throw new Error("rowIndex is required");var Qe=te(fe),ut=[M.name,(je=Qe==null?void 0:Qe.toString())!==null&&je!==void 0?je:""].flat(1).filter(Boolean);return(Ee=H.current)===null||Ee===void 0?void 0:Ee.getFieldValue(ut)},Ge=function(){var fe,je=[M.name].flat(1).filter(Boolean);if(Array.isArray(je)&&je.length===0){var Ee,Qe=(Ee=H.current)===null||Ee===void 0?void 0:Ee.getFieldsValue();return Array.isArray(Qe)?Qe:Object.keys(Qe).map(function(ut){return Qe[ut]})}return(fe=H.current)===null||fe===void 0?void 0:fe.getFieldValue(je)};return(0,A.Z)((0,A.Z)({},H.current),{},{getRowData:ce,getRowsData:Ge,setRowData:function(fe,je){var Ee,Qe;if(fe==null)throw new Error("rowIndex is required");var ut=te(fe),Ke=[M.name,(Ee=ut==null?void 0:ut.toString())!==null&&Ee!==void 0?Ee:""].flat(1).filter(Boolean),Nt=Object.assign({},(0,A.Z)((0,A.Z)({},ce(fe)),je||{})),Tt=(0,ot.Z)({},Ke,Nt);return(Qe=H.current)===null||Qe===void 0||Qe.setFieldsValue(Tt),!0}})},[te,M.name,H.current]),(0,C.useEffect)(function(){M.controlled&&(X||[]).forEach(function(ce,Ge){var me;(me=H.current)===null||me===void 0||me.setFieldsValue((0,He.Z)({},"".concat(L(ce,Ge)),ce))},{})},[(0,se.ZP)(X),M.controlled]),(0,C.useEffect)(function(){if(M.name){var ce;H.current=M==null||(ce=M.editable)===null||ce===void 0?void 0:ce.form}},[(Te=M.editable)===null||Te===void 0?void 0:Te.form,M.name]);var K=Se||{},V=K.record,Y=K.position,ne=K.creatorButtonText,Oe=K.newRecordType,tt=K.parentKey,Pt=K.style,$t=(0,Ye.Z)(K,O),Mt=Y==="top",bt=(0,C.useMemo)(function(){return typeof $e=="number"&&$e<=(X==null?void 0:X.length)?!1:Se!==!1&&(0,W.jsx)(ke,{record:(0,E.h)(V,X==null?void 0:X.length,X)||{},position:Y,parentKey:(0,E.h)(tt,X==null?void 0:X.length,X),newRecordType:Oe,children:(0,W.jsx)(ue.ZP,(0,A.Z)((0,A.Z)({type:"dashed",style:(0,A.Z)({display:"block",margin:"10px 0",width:"100%"},Pt),icon:(0,W.jsx)(f,{})},$t),{},{children:ne||e.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[Se,$e,X==null?void 0:X.length]),Zt=(0,C.useMemo)(function(){return bt?Mt?{components:{header:{wrapper:function(Ge){var me,fe=Ge.className,je=Ge.children;return(0,W.jsxs)("thead",{className:fe,children:[je,(0,W.jsxs)("tr",{style:{position:"relative"},children:[(0,W.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:bt}),(0,W.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(me=Me.columns)===null||me===void 0?void 0:me.length,children:bt})]})]})}}}}:{tableViewRender:function(Ge,me){var fe,je;return(0,W.jsxs)(W.Fragment,{children:[(fe=(je=M.tableViewRender)===null||je===void 0?void 0:je.call(M,Ge,me))!==null&&fe!==void 0?fe:me,bt]})}}:{}},[Mt,bt]),Ct=(0,A.Z)({},M.editable),It=(0,Z.J)(function(ce,Ge){var me,fe,je;if((me=M.editable)===null||me===void 0||(fe=me.onValuesChange)===null||fe===void 0||fe.call(me,ce,Ge),(je=M.onValuesChange)===null||je===void 0||je.call(M,Ge,ce),M.controlled){var Ee;M==null||(Ee=M.onChange)===null||Ee===void 0||Ee.call(M,Ge)}});return(M!=null&&M.onValuesChange||(N=M.editable)!==null&&N!==void 0&&N.onValuesChange||M.controlled&&M!==null&&M!==void 0&&M.onChange)&&(Ct.onValuesChange=It),(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(ee.Provider,{value:pe,children:(0,W.jsx)(_e.Z,(0,A.Z)((0,A.Z)((0,A.Z)({search:!1,options:!1,pagination:!1,rowKey:be,revalidateOnFocus:!1},Me),Zt),{},{tableLayout:"fixed",actionRef:pe,onChange:Re,editable:(0,A.Z)((0,A.Z)({},Ct),{},{formProps:(0,A.Z)({formRef:H},Ct.formProps)}),dataSource:X,onDataSourceChange:function(Ge){if(St(Ge),M.name&&Y==="top"){var me,fe=(0,ot.Z)({},[M.name].flat(1).filter(Boolean),Ge);(me=H.current)===null||me===void 0||me.setFieldsValue(fe)}}}))}),M.name?(0,W.jsx)(P.Z,{name:[M.name],children:function(Ge){var me,fe;if(!xe.current)return xe.current=X,null;var je=(0,ct.Z)(Ge,[M.name].flat(1)),Ee=je==null?void 0:je.find(function(Qe,ut){var Ke;return!(0,Q.A)(Qe,(Ke=xe.current)===null||Ke===void 0?void 0:Ke[ut])});return xe.current=X,Ee&&(M==null||(me=M.editable)===null||me===void 0||(fe=me.onValuesChange)===null||fe===void 0||fe.call(me,Ee,je)),null}}):null]})}function Be(M){var Te=i.ZP.useFormInstance();return M.name?(0,W.jsx)(Ae.Z.Item,(0,A.Z)((0,A.Z)({style:{maxWidth:"100%"}},M==null?void 0:M.formItemProps),{},{name:M.name,shouldUpdate:function(e,Re){var $e=[M.name].flat(1);try{return JSON.stringify((0,ct.Z)(e,$e))!==JSON.stringify((0,ct.Z)(Re,$e))}catch(Ie){return!0}},children:(0,W.jsx)(y,(0,A.Z)((0,A.Z)({},M),{},{editable:(0,A.Z)((0,A.Z)({},M.editable),{},{form:Te})}))})):(0,W.jsx)(y,(0,A.Z)({},M))}Be.RecordCreator=ke;var xt=Be},11312:function(_t,et,o){o.d(et,{nu:function(){return N},rL:function(){return Te},Du:function(){return M}});var He=o(9783),c=o.n(He),Ye=o(97857),I=o.n(Ye),ye=o(19632),A=o.n(ye),he=o(5574),C=o.n(he),v=o(45919),s=o(66419),le=o(78677),f=o(26271),P=o(78957),i=o(66309),j=o(72051),Z=o(71230),se=o(72269),E=o(83863),Q=o(60943),ue=o(67294),Ae=o(70804),re=o(80854),ct=o(62235),ot=o(15009),_e=o.n(ot),W=o(99289),de=o.n(W),O=o(58638),ee=o(14726),ke=o(76841),y=o(85893),Be=function(Re){var $e=Re.course_id,Ie=Re.stat,Se=Ie===void 0?"EscolaLms\\Reports\\Stats\\Course\\FinishedTopics":Ie,be=(0,ue.useState)(!1),ge=C()(be,2),Fe=ge[0],We=ge[1],Je=(0,ue.useCallback)(function(Me){return de()(_e()().mark(function xe(){var pe,H;return _e()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return We(!0),D.prev=1,D.next=4,(0,ke._g)(Me,{stat:Se});case 4:pe=D.sent,pe instanceof Blob&&(H=document.createElement("a"),H.href=window.URL.createObjectURL(pe),H.download="finished_topics_".concat($e,".xlsx"),document.body.appendChild(H),H.click(),document.body.removeChild(H)),D.next=11;break;case 8:D.prev=8,D.t0=D.catch(1),console.error(D.t0);case 11:return D.prev=11,We(!1),D.finish(11);case 14:case"end":return D.stop()}},xe,null,[[1,8,11,14]])}))},[Se]);return(0,y.jsxs)(ee.ZP,{type:"primary",loading:Fe,onClick:Je($e),children:[(0,y.jsx)(O.Z,{})," ",(0,y.jsx)(re.FormattedMessage,{id:"export"})]})},xt=function(Re){return Re.topicable.content.contents?Object.values(Re.topicable.content.contents)[0].library:"H5P"},M=function(Re){var $e=Re.course_id,Ie=Re.topics,Se=Re.stats,be=(0,ue.useState)(!1),ge=C()(be,2),Fe=ge[0],We=ge[1],Je=(0,ue.useMemo)(function(){return[{title:(0,y.jsx)(re.FormattedMessage,{id:"user"}),dataIndex:"id",render:function(pe){return(0,y.jsx)(ct.Z,{type:"App\\Models\\User",type_id:pe})}},{title:(0,y.jsx)(re.FormattedMessage,{id:"email"}),dataIndex:"email"}].concat(A()(Ie.map(function(xe){var pe,H=(pe=xe.topicable_type)===null||pe===void 0?void 0:pe.split("\\").pop();return H==="H5P"&&(H=xt(xe)),{render:function(D){var X=0;switch(D&&(D.started_at&&D.finished_at?X=1:D.started_at&&(X=2)),X){case 1:return(0,y.jsxs)(P.Z,{children:[(0,y.jsx)(i.Z,{color:"success",children:"F"}),Fe&&(D==null?void 0:D.seconds)&&(0,y.jsx)("small",{children:(0,s.Im)(D.seconds)})]});case 2:return(0,y.jsxs)(P.Z,{children:[(0,y.jsx)(i.Z,{color:"blue",children:"S"}),Fe&&(D==null?void 0:D.seconds)&&(0,y.jsx)("small",{children:(0,s.Im)(D.seconds)})]});case 0:default:return(0,y.jsx)(ue.Fragment,{children:(0,y.jsx)(i.Z,{color:"error",children:"N"})})}},title:(0,y.jsxs)("small",{children:[(0,y.jsx)(i.Z,{children:H})," ",xe.title]}),dataIndex:xe.id}})))},[Ie,Fe]),Me=(0,ue.useMemo)(function(){return Se.map(function(xe){return Ie.reduce(function(pe,H){var oe=xe.topics.find(function(D){return D.id===H.id});return I()(I()({},pe),{},c()({},Number(H.id),oe!=null?oe:0))},{email:xe.email,id:xe.id})})},[Se,Ie]);return(0,y.jsx)(j.Z,{title:function(){return(0,y.jsxs)(Z.Z,{justify:"space-between",align:"middle",children:[(0,y.jsxs)(P.Z,{children:[(0,y.jsx)(re.FormattedMessage,{id:"Finished",defaultMessage:"Finished:"})," ",(0,y.jsx)(i.Z,{color:"success",children:"F"}),(0,y.jsx)(re.FormattedMessage,{id:"Started",defaultMessage:"Started:"})," ",(0,y.jsx)(i.Z,{color:"blue",children:"S"}),(0,y.jsx)(re.FormattedMessage,{id:"NotStarted",defaultMessage:"Not Started:"})," ",(0,y.jsx)(i.Z,{color:"error",children:"N"}),(0,y.jsx)(re.FormattedMessage,{id:"ShowMinutes",defaultMessage:"Show minutes spent on topic:"})," ",(0,y.jsx)(se.Z,{checked:Fe,onChange:function(H){return We(H)}})]}),(0,y.jsx)(Be,{course_id:$e})]})},columns:Je,dataSource:Me,size:"small",scroll:{x:1500},components:{table:function(pe){return(0,y.jsx)(Ae.Z,{horizontal:!0,style:{maxWidth:"auto"},hideScrollbars:!1,children:(0,y.jsx)("table",I()({},pe))})}}})},Te=function(Re){var $e=Re.stats,Ie=Re.attempts,Se=(0,ue.useMemo)(function(){return[{title:(0,y.jsx)(re.FormattedMessage,{id:"user"}),dataIndex:"id",render:function(Fe){return(0,y.jsx)(ct.Z,{type:"App\\Models\\User",type_id:Fe})}},{title:(0,y.jsx)(re.FormattedMessage,{id:"email"}),dataIndex:"email"},{title:(0,y.jsx)(re.FormattedMessage,{id:"attempt",defaultMessage:"Attempt"}),dataIndex:"attempt"},{title:(0,y.jsx)(re.FormattedMessage,{id:"finished_at",defaultMessage:"Finished at"}),dataIndex:"finished_at",render:function(Fe){return Fe?(0,Q.WU)(new Date(Fe),v.Cu):""}}]},[]),be=(0,ue.useMemo)(function(){return $e.map(function(ge){var Fe=ge.id,We=ge.email,Je=ge.finished_at,Me=Ie==null?void 0:Ie.find(function(pe){return pe.id===Fe}),xe=Array.isArray(Me==null?void 0:Me.attempts)?Me==null?void 0:Me.attempts.length:0;return{id:Fe,email:We,finished_at:Je,attempt:xe}})},[$e]);return(0,y.jsx)(j.Z,{title:function(){return(0,y.jsx)(P.Z,{children:(0,y.jsx)(re.FormattedMessage,{id:"course.finished",defaultMessage:"Finished"})})},columns:Se,dataSource:be,size:"small",scroll:{x:500}})},N=function(Re){var $e=Re.stats,Ie=(0,ue.useState)(null),Se=C()(Ie,2),be=Se[0],ge=Se[1],Fe=(0,ue.useState)(null),We=C()(Fe,2),Je=We[0],Me=We[1],xe=(0,re.useIntl)(),pe=(0,ue.useMemo)(function(){return $e.flatMap(function(oe){return Object.values(oe.attempts).flatMap(function(D){var X=D.dates,St=D.attempt,L=Object.values(X).flatMap(function(te){var K=te.date,V=te.seconds_total;return{date:K,attempt:St,seconds_total:V,email:oe.email}});return L})})},[$e]),H={xField:"date",yField:"seconds_total",seriesField:"attempt",isStack:!0,xAxis:{label:{autoHide:!0,autoRotate:!1}},slider:{start:0,end:1},label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]}};return(0,y.jsx)(f.ZP,{title:(0,y.jsxs)(P.Z,{children:[(0,y.jsx)(re.FormattedMessage,{id:"course.interactions_time_in_days"}),(0,y.jsx)(E.default,{showSearch:!0,value:be,onChange:function(D){ge(D),Me(null)},placeholder:(0,y.jsx)(re.FormattedMessage,{id:"select_person",defaultMessage:"Select a person"}),children:$e.map(function(oe){var D=oe.id,X=oe.email;return(0,y.jsx)(E.default.Option,{value:X,children:X},D)})}),(0,y.jsx)(E.default,{value:Je,onChange:function(D){return Me(D)},disabled:be===null,placeholder:(0,y.jsx)(re.FormattedMessage,{id:"select_attempt",defaultMessage:"Select attempt"}),children:A()(new Set(pe.filter(function(oe){var D=oe.email;return D===be}).map(function(oe){var D=oe.attempt;return D}))).map(function(oe){return(0,y.jsxs)(E.default.Option,{value:oe,children:[(0,y.jsx)(re.FormattedMessage,{id:"attempt",defaultMessage:"Attempt"})," ",oe]},oe)})})]}),colSpan:12,layout:"center",children:(0,y.jsx)("div",{style:{overflow:"auto",minHeight:"400px",width:"100%"},children:(0,y.jsx)(le.Z,I()(I()({},H),{},{tooltip:{title:"".concat(xe.formatMessage({id:"attempt"})),formatter:function(D){var X=Math.floor(+D.seconds_total/60),St=+D.seconds_total>60?+D.seconds_total-X*60:0;return{name:D.attempt,value:"".concat(X,"m ").concat(St,"s")}}},data:pe.filter(function(oe){var D=oe.email;return D===be}).filter(function(oe){var D=oe.attempt;return Number.isInteger(Je)?D===Je:!0})}))})})}},87366:function(_t,et,o){o.d(et,{Il:function(){return ot},_y:function(){return P},uS:function(){return Z}});var He=o(5574),c=o.n(He),Ye=o(97857),I=o.n(Ye),ye=o(19632),A=o.n(ye),he=o(2453),C=o(67294),v=o(80854),s=o(99100),le=o(31472),f=o(85893),P=C.createContext({}),i=function(){return Math.round(Math.random()*99999)},j=function _e(W){return W.reduce(function(de,O){return[].concat(A()(de),A()(O.lessons?_e(O.lessons):[]),[O])},[])},Z=function _e(W){return W.reduce(function(de,O){var ee;return[].concat(A()(de),A()(O.lessons?_e(O.lessons):[]),A()((ee=O.topics)!==null&&ee!==void 0?ee:[]))},[])},se=function _e(W,de,O){return W.map(function(ee){var ke,y;return I()(I()({},ee),{},{lessons:ee.lessons?_e(ee.lessons,de,O):[],topics:ee.id===de?[].concat(A()((ke=ee.topics)!==null&&ke!==void 0?ke:[]),[O]):(y=ee.topics)!==null&&y!==void 0?y:[]})})},E=function _e(W,de,O){return O?W.map(function(ee){return I()(I()({},ee),{},{lessons:[].concat(A()(ee.lessons?_e(ee.lessons,de,O):[]),A()(ee.id===O?[de]:[]))})}):[].concat(A()(W),[de])},Q=function _e(W,de,O){return W.map(function(ee){return I()(I()({},ee.id===de?O:ee),{},{lessons:ee.lessons?_e(ee.lessons,de,O):[]})})},ue=function _e(W,de){return W.map(function(O){return I()(I()({},O),{},{parent_id:de,lessons:O.lessons?_e(O.lessons,O.id):[]})})},Ae=function _e(W,de){return W.filter(function(O){return O.id!==de}).map(function(O){return I()(I()({},O),{},{lessons:O.lessons?_e(O.lessons,de):[]})})},re=function _e(W,de){return W.map(function(O){return I()(I()({},O),{},{lessons:O.lessons?_e(O.lessons,de):[],topics:O.topics?O.topics.filter(function(ee){return ee.id!==de}):[]})})},ct=function _e(W,de,O,ee){return ee==null?void 0:ee.map(function(ke){if(ke.id===O){var y;return I()(I()({},ke),{},{topics:(y=ke.topics)===null||y===void 0?void 0:y.map(function(Be){return Be.id===W?de.file.response.data:Be})})}else if(ke.lessons)return I()(I()({},ke),{},{lessons:_e(W,de,O,ke.lessons||[])});return ke})},ot=function(W){var de=W.children,O=W.id,ee=(0,C.useState)(),ke=c()(ee,2),y=ke[0],Be=ke[1],xt=(0,v.useIntl)(),M=(0,C.useMemo)(function(){return y&&y.lessons?Z(y.lessons):[]},[y]),Te=(0,C.useMemo)(function(){return y&&y.lessons?j(y.lessons):[]},[y]),N=(0,C.useState)([]),e=c()(N,2),Re=e[0],$e=e[1],Ie=(0,v.useLocation)(),Se=(0,C.useMemo)(function(){var L=new URLSearchParams(Ie.search);return{lesson:L.get("lesson"),topic:L.get("topic")}},[Ie]);(0,C.useEffect)(function(){$e([])},[]);var be=(0,C.useCallback)(function(){(0,s.Nx)(O).then(function(L){return L.success&&Be(I()(I()({},L.data),{},{lessons:ue(L.data.lessons)}))})},[O]);(0,C.useEffect)(function(){be()},[be]);var ge=(0,C.useCallback)(function(L){var te=Te.find(function(K){var V;return K==null||(V=K.topics)===null||V===void 0?void 0:V.find(function(Y){return Y.id===L})});return te?te.id:null},[Te]),Fe=(0,C.useMemo)(function(){return Se.lesson?{mode:"lesson",id:Number(Se.lesson),value:Te.find(function(L){return L.id===Number(Se.lesson)})}:Se.topic?{mode:"topic",id:Number(Se.topic),value:M.find(function(L){return L.id===Number(Se.topic)})}:{mode:"init"}},[Se,y,Te,M]),We=(0,C.useCallback)(function(L){var te={course_id:O,topics:[],isNew:!0,id:y?y.lessons.length+1:i(),order:0,title:xt.formatMessage({id:"add_title_here"}),active:!0,parent_id:L};return Be(function(K){var V;return I()(I()({},K),{},{lessons:E((V=K==null?void 0:K.lessons)!==null&&V!==void 0?V:[],te,L)})}),te},[O,y]),Je=(0,C.useCallback)(function(L,te){var K=Te.find(function(Y){return Y.id===L}),V=K&&K.isNew;return(V?(0,s.aA)(te):(0,s.sI)(L,te)).then(function(Y){return he.ZP.success(Y.message),be(),Y.success&&Be(function(ne){var Oe;return I()(I()({},ne),{},{lessons:Q((Oe=ne==null?void 0:ne.lessons)!==null&&Oe!==void 0?Oe:[],L,I()(I()({},Y.data),{},{isNew:!1}))})})})},[y]),Me=(0,C.useCallback)(function(L){var te=Te.find(function(V){return V.id===L});if(te){var K=te.isNew;K?Be(function(V){var Y;return I()(I()({},V),{},{lessons:Ae((Y=V==null?void 0:V.lessons)!==null&&Y!==void 0?Y:[],L)})}):(0,s.iI)(L).then(function(V){V.success&&(he.ZP.success(V.message),Be(function(Y){var ne;return I()(I()({},Y),{},{lessons:Ae((ne=Y==null?void 0:Y.lessons)!==null&&ne!==void 0?ne:[],L)})}))})}},[y]),xe=(0,C.useCallback)(function(L,te){var K,V=ge(L),Y=Te.find(function(tt){return tt.id===V}),ne=Y&&((K=Y.topics)===null||K===void 0?void 0:K.find(function(tt){return tt.id===L})),Oe=ne==null?void 0:ne.isNew;return(Oe?(0,s.HV)(te):(0,s.Cn)(L,te)).then(function(tt){tt.success&&(he.ZP.success(tt.message),be(),v.history.push("/courses/list/".concat(O,"/program/?topic=").concat(tt.data.id)),(ne==null?void 0:ne.topicable_type)===le.oz.Video&&setTimeout(function(){be()},5e3))})},[ge,y,be]),pe=(0,C.useCallback)(function(L){var te=ge(L),K=Te.find(function(ne){return ne.id===te});if(K){var V=M==null?void 0:M.find(function(ne){return ne.id===L}),Y=V==null?void 0:V.isNew;Y&&!V.topicable?Be(function(ne){var Oe;return I()(I()({},ne),{},{lessons:re((Oe=ne==null?void 0:ne.lessons)!==null&&Oe!==void 0?Oe:[],L)})}):(0,s.vJ)(L).then(function(ne){ne.success&&(he.ZP.success(ne.message),Be(function(Oe){var tt;return I()(I()({},Oe),{},{lessons:re((tt=Oe==null?void 0:Oe.lessons)!==null&&tt!==void 0?tt:[],L)})}))})}},[y,ge]),H=(0,C.useCallback)(function(L,te){var K={lesson_id:L,isNew:!0,id:i(),title:xt.formatMessage({id:"add_title_here"}),active:!0,topicable_type:te};return Be(function(V){var Y;return I()(I()({},V),{},{lessons:se((Y=V==null?void 0:V.lessons)!==null&&Y!==void 0?Y:[],L,K)})}),K},[]),oe=function(te,K){var V=ge(te);Be(function(Y){return I()(I()({},Y),{},{lessons:Y?ct(te,K,V,Y.lessons||[]):[]})}),v.history.push("/courses/list/".concat(O,"/program/?topic=").concat(K.file.response.data.id))},D=(0,C.useCallback)(function(L){return(0,s.Cx)(L).then(function(te){if(te.success){he.ZP.success(te.message);var K=ge(L);Be(function(V){var Y;return I()(I()({},V),{},{lessons:V?(Y=V.lessons)===null||Y===void 0?void 0:Y.map(function(ne){if(ne.id===K){var Oe=ne.topics||[];return I()(I()({},ne),{},{topics:[].concat(A()(Oe),[te.data])})}return ne}):[]})})}})},[y,ge]),X=(0,C.useCallback)(function(L){return(0,s.if)(L).then(function(te){te.success&&(he.ZP.success(te.message),Be(function(K){return I()(I()({},K),{},{lessons:K?[].concat(A()(K.lessons),[te.data]):[]})}))})},[]),St={state:y,h5ps:Re,id:O,addNewLesson:We,updateLesson:Je,updateTopic:xe,deleteLesson:Me,addNewTopic:H,deleteTopic:pe,onTopicUploaded:oe,cloneTopic:D,cloneLesson:X,currentEditMode:Fe,getLessons:be};return(0,f.jsx)(P.Provider,{value:St,children:de})}},88030:function(_t,et,o){o.r(et),o.d(et,{default:function(){return Rr}});var He=o(97857),c=o.n(He),Ye=o(91115),I=o(26114),ye=o(26271),A=o(74453),he=o(75081),C=o(14726),v=o(67294),s=o(80854),le=o(15009),f=o.n(le),P=o(99289),i=o.n(P),j=o(19632),Z=o.n(j),se=o(5574),E=o.n(se),Q=o(16894),ue=o(83062),Ae=o(2453),re=o(25093),ct=o(28248),ot=o(78957),_e=o(2487),W=o(96365),de=o(75842);function O(u,n){return ee.apply(this,arguments)}function ee(){return ee=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/bookmarks",c()({method:"GET",params:n},t||{})));case 1:case"end":return a.stop()}},u)})),ee.apply(this,arguments)}function ke(u,n){return y.apply(this,arguments)}function y(){return y=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/bookmarks",c()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return a.stop()}},u)})),y.apply(this,arguments)}function Be(u,n,t){return xt.apply(this,arguments)}function xt(){return xt=i()(f()().mark(function u(n,t,r){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/bookmarks/".concat(n),c()({method:"PATCH",headers:{"Content-Type":"application/json"},data:t},r||{})));case 1:case"end":return l.stop()}},u)})),xt.apply(this,arguments)}function M(u,n,t){return Te.apply(this,arguments)}function Te(){return Te=i()(f()().mark(function u(n,t,r){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/bookmarks/".concat(n),c()({method:"DELETE",headers:{"Content-Type":"application/json"},data:t},r||{})));case 1:case"end":return l.stop()}},u)})),Te.apply(this,arguments)}var N=o(31472),e=o(85893),Re=function(n){var t=n.visible,r=n.onClose,a=n.user,l=re.Z.Text,d=a.name,m=a.groupId,g=a.userId,x=(0,v.useState)(""),S=E()(x,2),_=S[0],T=S[1],p=(0,v.useState)(!1),h=E()(p,2),b=h[0],F=h[1],k=(0,v.useState)([]),G=E()(k,2),R=G[0],ie=G[1],z=(0,v.useState)(null),q=E()(z,2),U=q[0],w=q[1],$=(0,v.useState)({current_page:1,per_page:5,last_page:1,total:0}),B=E()($,2),ve=B[0],qe=B[1],ze=function(){var Ne=i()(f()().mark(function J(Ce){var ae;return f()().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return we.next=2,O({bookmarkable_id:m,bookmarkable_type:N.h5.Group,user_id:g,page:Ce,per_page:ve.per_page});case 2:ae=we.sent,ae.success&&(ie(ae.data),qe(ae.meta));case 4:case"end":return we.stop()}},J)}));return function(Ce){return Ne.apply(this,arguments)}}(),st=function(){var Ne=i()(f()().mark(function J(){var Ce;return f()().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:return Xe.next=2,ke({value:_,bookmarkable_id:m,bookmarkable_type:N.h5.Group,user_id:g});case 2:Ce=Xe.sent,Ce.success&&(ze(),F(!1),T(""));case 4:case"end":return Xe.stop()}},J)}));return function(){return Ne.apply(this,arguments)}}(),at=function(){var Ne=i()(f()().mark(function J(Ce){var ae;return f()().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return we.next=2,M(Ce);case 2:ae=we.sent,ae.success&&ze();case 4:case"end":return we.stop()}},J)}));return function(Ce){return Ne.apply(this,arguments)}}(),Pe=function(){var Ne=i()(f()().mark(function J(Ce){var ae;return f()().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return we.next=2,Be(Ce,{value:(U==null?void 0:U.currentText)||"",bookmarkable_id:m,bookmarkable_type:N.h5.Group,user_id:g});case 2:ae=we.sent,ae.success&&(ze(),w(null));case 4:case"end":return we.stop()}},J)}));return function(Ce){return Ne.apply(this,arguments)}}();return(0,v.useEffect)(function(){ze()},[]),(0,e.jsxs)(ct.Z,{title:(0,e.jsxs)(ot.Z,{children:[(0,e.jsx)(s.FormattedMessage,{id:"notes"}),(0,e.jsx)(l,{children:"(".concat(d,")")})]}),open:t,onCancel:r,footer:[(0,e.jsx)(C.ZP,{onClick:r,children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})},"cancel")],children:[(0,e.jsx)(_e.Z,{dataSource:R,pagination:{onChange:function(J){return ze(J)},pageSize:ve.per_page,total:ve.total,current:ve.current_page},renderItem:function(J){return(0,e.jsx)(_e.Z.Item,{actions:[(0,e.jsx)(C.ZP,{danger:!0,onClick:function(){return at(J.id)},children:(0,e.jsx)(s.FormattedMessage,{id:"delete"})},J.id),(U==null?void 0:U.currentNoteId)===J.id?(0,e.jsxs)(ot.Z,{children:[(0,e.jsx)(C.ZP,{onClick:function(){return Pe(J.id)},children:(0,e.jsx)(s.FormattedMessage,{id:"save"})}),(0,e.jsx)(C.ZP,{onClick:function(){return w(null)},children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})})]}):(0,e.jsx)(C.ZP,{onClick:function(){return w({currentNoteId:J.id,currentText:J.value||""})},children:(0,e.jsx)(s.FormattedMessage,{id:"edit"})},J.id)],children:(U==null?void 0:U.currentNoteId)===J.id&&(U==null?void 0:U.currentText)!==null?(0,e.jsx)(W.Z.TextArea,{value:U==null?void 0:U.currentText,onChange:function(ae){return w(function(Xe){return c()(c()({},Xe),{},{currentText:ae.target.value})})}}):J.value})}}),b?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(de.Z,{layout:"vertical",children:(0,e.jsx)(de.Z.Item,{label:(0,e.jsx)(s.FormattedMessage,{id:"new_note"}),children:(0,e.jsx)(W.Z.TextArea,{value:_,onChange:function(J){return T(J.target.value)},autoSize:{minRows:3,maxRows:6}})})}),(0,e.jsxs)(ot.Z,{children:[(0,e.jsx)(C.ZP,{type:"primary",onClick:st,children:(0,e.jsx)(s.FormattedMessage,{id:"save"})}),(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return F(!1)},children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})})]})]}):(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return F(!0)},children:(0,e.jsx)(s.FormattedMessage,{id:"add_note"})},"new")]})},$e=Re;function Ie(u,n){return Se.apply(this,arguments)}function Se(){return Se=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/schedules/groups/".concat(n),c()({method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},u)})),Se.apply(this,arguments)}function be(u,n,t,r){return ge.apply(this,arguments)}function ge(){return ge=i()(f()().mark(function u(n,t,r,a){return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,s.request)("/api/admin/schedules/".concat(n,"/attendances"),c()({data:{attendances:[{user_id:t,value:r}]},method:"POST"},a||{})));case 1:case"end":return d.stop()}},u)})),ge.apply(this,arguments)}function Fe(u,n){return We.apply(this,arguments)}function We(){return We=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams",c()({method:"GET",useCache:!1,params:n},t||{})));case 1:case"end":return a.stop()}},u)})),We.apply(this,arguments)}function Je(u,n){return Me.apply(this,arguments)}function Me(){return Me=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams",c()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return a.stop()}},u)})),Me.apply(this,arguments)}function xe(u,n,t){return pe.apply(this,arguments)}function pe(){return pe=i()(f()().mark(function u(n,t,r){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n),c()({method:"PUT",data:t,useCache:!1},r||{})));case 1:case"end":return l.stop()}},u)})),pe.apply(this,arguments)}function H(u,n){return oe.apply(this,arguments)}function oe(){return oe=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n),c()({method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},u)})),oe.apply(this,arguments)}function D(u,n){return X.apply(this,arguments)}function X(){return X=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n),c()({method:"DELETE"},t||{})));case 1:case"end":return a.stop()}},u)})),X.apply(this,arguments)}function St(u,n,t,r){return L.apply(this,arguments)}function L(){return L=i()(f()().mark(function u(n,t,r,a){return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,s.request)("/api/admin/exams/".concat(n,"/users/").concat(t),c()({method:"POST",headers:{"Content-Type":"application/json"},data:r},a||{})));case 1:case"end":return d.stop()}},u)})),L.apply(this,arguments)}function te(u,n,t){return K.apply(this,arguments)}function K(){return K=_asyncToGenerator(_regeneratorRuntime().mark(function u(n,t,r){return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",request("/api/admin/exams/".concat(n,"/users/").concat(t),_objectSpread({method:"DELETE"},r||{})));case 1:case"end":return l.stop()}},u)})),K.apply(this,arguments)}function V(u,n,t){return Y.apply(this,arguments)}function Y(){return Y=i()(f()().mark(function u(n,t,r){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/semester-subjects/".concat(n,"/tutors/").concat(t,"/grades"),c()({method:"GET",useCache:!1},r||{})));case 1:case"end":return l.stop()}},u)})),Y.apply(this,arguments)}function ne(u,n,t,r){return Oe.apply(this,arguments)}function Oe(){return Oe=i()(f()().mark(function u(n,t,r,a){return f()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",(0,s.request)("/api/admin/semester-subjects/".concat(n,"/tutors/").concat(t,"/grades"),c()({method:"POST",data:r},a||{})));case 1:case"end":return d.stop()}},u)})),Oe.apply(this,arguments)}function tt(u,n){return Pt.apply(this,arguments)}function Pt(){return Pt=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/lesson-group-users",c()({method:"GET",params:{groups:n},useCache:!1},t||{})));case 1:case"end":return a.stop()}},u)})),Pt.apply(this,arguments)}function $t(u,n,t){return Mt.apply(this,arguments)}function Mt(){return Mt=i()(f()().mark(function u(n,t,r){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/lesson-group-users/groups/".concat(n,"/users/").concat(t),c()({method:"GET",useCache:!1},r||{})));case 1:case"end":return l.stop()}},u)})),Mt.apply(this,arguments)}function bt(u){return Zt.apply(this,arguments)}function Zt(){return Zt=i()(f()().mark(function u(n){return f()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(0,s.request)("/api/admin/grade-terms",c()({method:"GET",useCache:!1},n||{})));case 1:case"end":return r.stop()}},u)})),Zt.apply(this,arguments)}function Ct(u,n){return It.apply(this,arguments)}function It(){return It=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/grade-scales/".concat(n),c()({method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},u)})),It.apply(this,arguments)}function ce(u,n){return Ge.apply(this,arguments)}function Ge(){return Ge=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/final-grades",c()({method:"POST",data:n},t||{})));case 1:case"end":return a.stop()}},u)})),Ge.apply(this,arguments)}function me(u,n,t){return fe.apply(this,arguments)}function fe(){return fe=i()(f()().mark(function u(n,t,r){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,s.request)("/api/admin/final-grades/".concat(n),c()({method:"PATCH",data:t},r||{})));case 1:case"end":return l.stop()}},u)})),fe.apply(this,arguments)}function je(u,n){return Ee.apply(this,arguments)}function Ee(){return Ee=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/final-grades/".concat(n),c()({method:"DELETE"},t||{})));case 1:case"end":return a.stop()}},u)})),Ee.apply(this,arguments)}var Qe=o(95213),ut=o(47389),Ke=o(7092),Nt=o(13769),Tt=o.n(Nt),da=["results"],Kt=function(n,t){return n.reduce(function(r,a){var l=a.results,d=Tt()(a,da),m=l.find(function(g){return g.user_id===t});return m?[].concat(Z()(r),[c()(c()({},d),{},{result:m})]):r},[])},Vt=function(n,t){var r,a=n.reduce(function(p,h){var b=h.result,F=h.weight;return F&&typeof b.result=="number"?[p[0]+b.result*F,p[1]+F]:p},[0,0]),l=E()(a,2),d=l[0],m=l[1],g=Number.isNaN(d/m)?0:d/m,x=t.sort(function(p,h){return p.grade_value-h.grade_value}).reduce(function(p,h){return[].concat(Z()(p),[c()(c()({},h),{},{isWeightedAverageGreater:g>=h.grade_value})])},[]);if(x.every(function(p){var h=p.isWeightedAverageGreater;return h})){var S,_;return(S=(_=x.at(-1))===null||_===void 0?void 0:_.name)!==null&&S!==void 0?S:""}var T=x.findIndex(function(p){var h=p.isWeightedAverageGreater;return!h});return T<0?"":(r=x[T-1])===null||r===void 0?void 0:r.name},zt=function(n,t){var r;return(r=t.find(function(a){return a.s_subject_scale_form_id===n}))===null||r===void 0?void 0:r.scale},ft=o(73199),ca=o(9783),nt=o.n(ca),Xt=o(84567);function ma(u){var n,t=u===null?N.cX.ABSENT:u,r=nt()(nt()(nt()(nt()({},N.cX.PRESENT,{ch1:!0,ch2:!1}),N.cX.PRESENT_NOT_EXERCISING,{ch1:!0,ch2:!0}),N.cX.ABSENT,{ch1:!1,ch2:!1}),N.cX.EXCUSED_ABSENCE,{ch1:!1,ch2:!0});return(n=r[t])!==null&&n!==void 0?n:{ch1:!1,ch2:!1}}function fa(u){var n,t=u.ch1,r=u.ch2,a="".concat(t,"_").concat(r),l={true_false:N.cX.PRESENT,true_true:N.cX.PRESENT_NOT_EXERCISING,false_false:N.cX.ABSENT,false_true:N.cX.EXCUSED_ABSENCE};return(n=l[a])!==null&&n!==void 0?n:N.cX.ABSENT}var va=function(n){var t=n.groupAttendanceScheduleId,r=n.studentId,a=n.attendance,l=n.onSuccess,d=(0,v.useState)(ma(a)),m=E()(d,2),g=m[0],x=m[1],S=(0,v.useState)(!1),_=E()(S,2),T=_[0],p=_[1],h=(0,v.useRef)(!0),b=(0,v.useCallback)(function(G){p(!0),be(t,r,fa(G)).then(function(R){R.success&&(l==null||l())}).finally(function(){return p(!1)})},[]),F=(0,v.useCallback)(function(G){return x(G.target.checked?{ch1:!0,ch2:!1}:{ch1:!1,ch2:!1})},[]),k=(0,v.useCallback)(function(G){return x(function(R){return c()(c()({},R),{},{ch2:G.target.checked})})},[]);return(0,v.useEffect)(function(){if(h.current){h.current=!1;return}b(g)},[g,b]),(0,e.jsxs)(ot.Z,{children:[(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"present"}),children:(0,e.jsx)(Xt.Z,{disabled:T,checked:g.ch1,onChange:F})}),(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:g.ch1?"not_exercising":"excused_absence"}),children:(0,e.jsx)(Xt.Z,{disabled:T,checked:g.ch2,onChange:k})})]})},Ht=va,jt=o(45919),yt=o(60943),Ft=o(83863),Yt=o(8925),pa=o(96486),ga=function(n){var t=n.exam_id,r=n.result,a=n.student_id,l=n.type,d=n.onSuccess,m=(0,v.useCallback)((0,pa.debounce)(function(x){St(t,a,{result:x}).then(function(S){S.success&&(d==null||d(S.data))})},300),[t,r,a]),g=function(){switch(l){case N.UL.ManualPass:return(0,e.jsx)(Ft.default,{allowClear:!0,style:{width:"100%"},onChange:m,options:ft.FW,defaultValue:r,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_grade"})});case N.UL.ManualGrades:return(0,e.jsx)(Ft.default,{allowClear:!0,style:{width:"100%"},onChange:m,options:ft.BP,defaultValue:r,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_grade"})});default:return(0,e.jsx)(Yt.Z,{type:"number",min:0,max:100,onChange:m,defaultValue:r!=null?r:void 0})}};return g()},ha=function(n,t){var r;return(r=n.find(function(a){return a.name===t}))===null||r===void 0?void 0:r.id},xa=function(n){var t=n.term,r=n.gradeScales,a=n.defaultFinalGrade,l=n.finalGrades,d=(0,v.useState)(a),m=E()(d,2),g=m[0],x=m[1],S=(0,v.useState)(!1),_=E()(S,2),T=_[0],p=_[1],h=(0,v.useState)(!1),b=E()(h,2),F=b[0],k=b[1],G=(0,s.useIntl)(),R=(0,v.useMemo)(function(){return r.map(function(q){var U=q.name,w=q.id;return{value:w,label:U}})},[r]),ie=function(U){k(!0),Ae.ZP.error(G.formatMessage({id:U.data.message}))},z=(0,v.useCallback)(function(q){if(l!=null&&l.id){if(q===void 0){if(!g)return;p(!0),je(g.id).then(function(U){U.success&&x(void 0)}).finally(function(){return p(!1)});return}if(g){p(!0),me(g.id,{grade_scale_id:q}).catch(function(U){var w;U!=null&&(w=U.data)!==null&&w!==void 0&&w.message&&ie(U)}).finally(function(){return p(!1)});return}p(!0),ce({grade_term_id:t.id,grade_scale_id:q,lesson_group_user_id:l.id}).then(function(U){if(U.success){var w=U.data.grades.find(function($){return $.grade_term.id===t.id});x(w),F&&k(!1)}}).catch(function(U){var w;U!=null&&(w=U.data)!==null&&w!==void 0&&w.message&&ie(U)}).finally(function(){return p(!1)})}},[g,t.id,l==null?void 0:l.id]);return l?(0,e.jsx)(Ft.default,{allowClear:!0,status:F?"error":"",loading:T,disabled:T,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_final_grade"}),style:{width:"100%"},onChange:z,options:R,defaultValue:ha(r,a==null?void 0:a.grade_name)}):null},ja=function(n){var t=n.reduce(function(r,a){return[].concat(Z()(r),[{title:(0,yt.WU)(new Date(a.date_from),jt.GC),dataIndex:"attendance-".concat(a.id),hideInSearch:!0,width:100,align:"center",render:function(d,m){return(0,e.jsx)(Ht,{groupAttendanceScheduleId:a.id,attendance:m["attendance-".concat(a==null?void 0:a.id)],studentId:m.id})}}])},[]);return t.length?{title:(0,e.jsx)(s.FormattedMessage,{id:"attendance"}),hideInSearch:!0,children:t}:{title:(0,e.jsx)(s.FormattedMessage,{id:"attendance"}),hideInSearch:!0,hideInTable:!0}},Sa=function(n,t){return n.reduce(function(r,a){var l=a.attendances.find(function(d){return d.user_id===t});return l?c()(c()({},r),{},nt()({},"attendance-".concat(a.id),l.value)):r},{})},ba=function(n){var t=n.reduce(function(r,a){return[].concat(Z()(r),[{dataIndex:"exam-".concat(a.id),title:a.type===N.UL.Manual?(0,e.jsx)(s.FormattedMessage,{id:"examTitleWithWeight",values:a}):(0,e.jsx)(s.FormattedMessage,{id:"examTitleWithoutWeight",values:a}),hideInSearch:!0,width:100,render:function(d,m){var g;return(m==null||(g=m["exam-".concat(a.id)])===null||g===void 0?void 0:g.result)!==void 0?(0,e.jsx)(ga,{type:a.type,result:m==null?void 0:m["exam-".concat(a.id)].result,exam_id:a.id,student_id:m.id}):"-"}}])},[]);return t.length?{title:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),hideInSearch:!0,children:t}:{title:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),hideInSearch:!0,hideInTable:!0}},ya=function(n){return n.reduce(function(t,r){var a=r.result,l=r.id;return c()(c()({},t),{},nt()({},"exam-".concat(l),a))},{})},_a=function(n,t){return{title:(0,e.jsx)(s.FormattedMessage,{id:"final-grades"}),hideInSearch:!0,children:n.map(function(r){return{title:r.name,hideInSearch:!0,width:100,align:"center",render:function(l,d){var m;return(0,e.jsx)(xa,{defaultFinalGrade:d["final-grade-".concat(r.id)],finalGrades:d.final_grades,term:r,gradeScales:t},"".concat(d==null||(m=d.final_grades)===null||m===void 0?void 0:m.group_id,"-").concat(r.id))}}})}},Ma=function(n,t){return n.find(function(r){return r.user.id===t})},Ca=function(n){var t;return((t=n==null?void 0:n.grades)!==null&&t!==void 0?t:[]).reduce(function(r,a){return c()(c()({},r),{},nt()({},"final-grade-".concat(a.grade_term.id),a))},{})},Ta=function(){var n,t=(0,Ke.Z)(),r=t.teacherSubjectData,a=t.semester_subject_id,l=(0,v.useState)([]),d=E()(l,2),m=d[0],g=d[1],x=(0,v.useState)(r==null||(n=r.groups)===null||n===void 0||(n=n[0])===null||n===void 0?void 0:n.name),S=E()(x,2),_=S[0],T=S[1],p=(0,v.useState)(null),h=E()(p,2),b=h[0],F=h[1],k=(0,s.useIntl)(),G=(0,v.useMemo)(function(){var z;return((z=r==null?void 0:r.groups)!==null&&z!==void 0?z:[]).map(function(q){var U=q.id,w=q.name;return{value:U,label:w}})},[r==null?void 0:r.groups]),R=(0,v.useRef)(),ie=(0,v.useMemo)(function(){var z;return[{title:(0,e.jsx)(s.FormattedMessage,{id:"group"}),dataIndex:"group_id",hideInTable:!0,valueType:"select",fieldProps:{options:G,defaultValue:G==null||(z=G[0])===null||z===void 0?void 0:z.value,allowClear:!1}},{title:(0,e.jsx)(s.FormattedMessage,{id:"surnameAndName",defaultMessage:"Name and surname"}),dataIndex:"full_name",fixed:"left"}].concat(Z()(m),[{hideInSearch:!0,title:(0,e.jsx)(s.FormattedMessage,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",fixed:"right",width:60,render:function(U,w){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"notes",defaultMessage:"notes"}),children:(0,e.jsx)(C.ZP,{type:"primary",icon:(0,e.jsx)(ut.Z,{}),onClick:function(){return F({userName:w.full_name,userId:w.id,groupId:w.final_grades.group_id})}})})})}}])},[G,m]);return(0,e.jsxs)(e.Fragment,{children:[(b==null?void 0:b.userId)&&(0,e.jsx)($e,{visible:!!b.userId,onClose:function(){return F(null)},user:{name:b.userName,userId:b.userId,groupId:b.groupId}}),(0,e.jsx)(Q.ZP,{sticky:!0,className:"table-standalone",request:function(){var z=i()(f()().mark(function q(U){var w,$,B,ve,qe,ze,st,at,Pe,Ne,J,Ce,ae,Xe,we,Ze,De,Le,Ve,rt,gt;return f()().wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return ve=U.group_id,qe=ve===void 0?(w=G[0])===null||w===void 0?void 0:w.value:ve,ze=U.full_name,st=ze===void 0?"":ze,Ue.next=3,tt([qe]);case 3:if(at=Ue.sent,Pe=G.find(function(lt){var dt=lt.value;return dt===qe}),!(!at.success||at.data[0]===void 0||a===null)){Ue.next=8;break}return Ae.ZP.error(k.formatMessage({id:"groupDataMissing"},{group_name:Pe==null?void 0:Pe.label})),Ue.abrupt("return",{data:[],total:0,success:!1});case 8:return Ue.next=10,Promise.all([(0,Qe.X)(qe),Ie(qe),Fe({group_id:qe,per_page:-1}),V(a,($=at.data)===null||$===void 0||($=$[0])===null||$===void 0?void 0:$.tutor_id),bt(),Ct((B=at.data)===null||B===void 0||(B=B[0])===null||B===void 0?void 0:B.s_subject_scale_form_id)]);case 10:if(Ne=Ue.sent,J=E()(Ne,6),Ce=J[0],ae=J[1],Xe=J[2],we=J[3],Ze=J[4],De=J[5],!(!Ce.success||!ae.success||!Xe.success||!we.success||!Ze.success||!De.success||!Pe)){Ue.next=21;break}return Ae.ZP.error(k.formatMessage({id:"groupDataMissing"},{group_name:Pe==null?void 0:Pe.label})),Ue.abrupt("return",{data:[],total:0,success:!1});case 21:return T(Pe.label),Le=ja(ae.data),Ve=ba(Xe.data),rt=_a(Ze.data,De.data),g([Le,Ve,rt,{title:(0,e.jsx)(s.FormattedMessage,{id:"proposed_grade"}),hideInSearch:!0,dataIndex:"proposed_grade",align:"center",width:100}]),gt=Ce.data.users.reduce(function(lt,dt){var Rt,it,Gt,Et=dt.id,$r=dt.academic_teacher_id,Nr=dt.first_name,Or=dt.last_name,oa="".concat(Or," ").concat(Nr);if($r!==null||!oa.toLowerCase().includes(st.toLowerCase()))return lt;var Ur=Sa(ae.data,Et),la=Kt(Xe.data,Et),wt=Ma(at.data,Et),kr=(Rt=zt((it=wt==null?void 0:wt.s_subject_scale_form_id)!==null&&it!==void 0?it:0,(Gt=we.data.grade_scale)!==null&&Gt!==void 0?Gt:[]))!==null&&Rt!==void 0?Rt:[],Br=Vt(la,kr),Wr=ya(la),Kr=Ca(wt);return[].concat(Z()(lt),[c()(c()(c()(c()({id:Et,full_name:oa},Ur),Wr),Kr),{},{proposed_grade:Br,final_grades:wt})])},[]).sort(function(lt,dt){return lt.full_name.localeCompare(dt.full_name)}),Ue.abrupt("return",{data:gt,total:gt.length,success:!0});case 28:case"end":return Ue.stop()}},q)}));return function(q){return z.apply(this,arguments)}}(),columns:ie,headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"classRegisterTitleWithGroupName",values:{groupName:_}}),search:{layout:"vertical"},scroll:{x:1500},actionRef:R,pagination:{defaultPageSize:ft.Sl,onChange:function(){var q;return(q=R.current)===null||q===void 0?void 0:q.reload()}},rowKey:"id"})]})},Jt=o(1413),Fa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM305.8 637.7c3.1 3.1 8.1 3.1 11.3 0l138.3-137.6L583 628.5c3.1 3.1 8.2 3.1 11.3 0l275.4-275.3c3.1-3.1 3.1-8.2 0-11.3l-39.6-39.6a8.03 8.03 0 00-11.3 0l-230 229.9L461.4 404a8.03 8.03 0 00-11.3 0L266.3 586.7a8.03 8.03 0 000 11.3l39.5 39.7z"}}]},name:"line-chart",theme:"outlined"},Ea=Fa,Pa=o(84089),Qt=function(n,t){return v.createElement(Pa.Z,(0,Jt.Z)((0,Jt.Z)({},n),{},{ref:t,icon:Ea}))};Qt.displayName="LineChartOutlined";var Za=v.forwardRef(Qt),qt=o(82061),ea=o(86738),Dt=o(62235),mt=o(952),Ia=o(5966),Ga=o(50335),ta=o(71230),vt=o(15746),wa=o(56717),aa=o(95830),Da=o(29477),ra=function(n){return n===N.UL.Manual||n===N.UL.ManualPass||n===N.UL.ManualGrades},La=function(n){var t=n.type,r=n.onDataConverted,a=n.groupSelectDisabled,l=(0,Ke.Z)(),d=l.semester_subject_id,m=l.teacherSubjectData,g=(0,v.useState)(null),x=E()(g,2),S=x[0],_=x[1],T=(0,v.useMemo)(function(){var b;return((b=m==null?void 0:m.groups)!==null&&b!==void 0?b:[]).map(function(F){var k=F.id,G=F.name;return{label:G,value:k}})},[]),p={type:t,group_id:S,semester_subject_id:d},h=(0,v.useCallback)(function(b){if(b.success){var F=b.data.results.filter(function(k){var G=k.user_id;return G!==null});if(!F.length)return;r({exam_results:F,group_id:b.data.group_id})}},[]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(mt.ZP.Item,{label:(0,e.jsx)(s.FormattedMessage,{id:"group"}),children:(0,e.jsx)(Ft.default,{disabled:a,value:S,onChange:function(F){return _(F)},options:T,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_group"}),style:{width:"100%"}})}),(0,e.jsx)(Da.Z,{name:"file",url:"/api/admin/exams/parse",onUpload:h,onChange:function(F){return!F.fileList.length&&r(void 0)},maxFiles:1,data:p,disabled:!S})]})},Aa=function(n){var t=n.onDataConverted,r=(0,Ke.Z)(),a=r.teacherSubjectData,l=r.groupUsers,d=(0,v.useState)(null),m=E()(d,2),g=m[0],x=m[1],S=(0,v.useMemo)(function(){var T;return((T=a==null?void 0:a.groups)!==null&&T!==void 0?T:[]).map(function(p){var h=p.id,b=p.name;return{label:b,value:h}})},[]),_=(0,v.useCallback)(function(T){var p;x(T);var h=(p=l.byId)===null||p===void 0?void 0:p[T];if(h){var b=h.users.reduce(function(F,k){var G=k.id,R=k.email,ie=k.first_name,z=k.last_name,q=k.academic_teacher_id;return q!==null?F:[].concat(Z()(F),[{email:R,first_name:ie,last_name:z,user_id:G,result:null}])},[]);t({group_id:T,exam_results:b})}},[l.byId]);return(0,e.jsx)(Ft.default,{value:g,onChange:_,options:S,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select_group"}),style:{width:"100%"}})},Lt=nt()(nt()(nt()(nt()(nt()(nt()({},N.UL.TestPortal,["/teacher-examples/testPortal.png"]),N.UL.TeamsForms,["/teacher-examples/teamsForms.png"]),N.UL.TeamsLecture,["/teacher-examples/teamsLecture.png","/teacher-examples/teamsLectureWithoutMail.png"]),N.UL.Manual,[]),N.UL.ManualPass,[]),N.UL.ManualGrades,[]),Ra=function(n){var t=n.images,r=(0,v.useState)(!1),a=E()(r,2),l=a[0],d=a[1],m=(0,v.useCallback)(function(){return d(!0)},[]);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"see_file_example_image"}),children:(0,e.jsx)(C.ZP,{onClick:m,icon:(0,e.jsx)(wa.Z,{})})}),(0,e.jsx)(aa.Z.PreviewGroup,{preview:{visible:l,onVisibleChange:d},children:t.map(function(g){return(0,e.jsx)(aa.Z,{style:{display:"none"},src:g},g)})})]})},$a=function(n){var t,r=n.type,a=n.onOk,l=n.onCancel,d=n.okDisabled,m=(t=Lt==null?void 0:Lt[r])!==null&&t!==void 0?t:Lt[N.UL.Manual];return(0,e.jsxs)(ot.Z,{style:{width:"100%",justifyContent:m.length?"space-between":"flex-end"},children:[!!m.length&&(0,e.jsx)(Ra,{images:m}),(0,e.jsxs)(ot.Z,{children:[(0,e.jsx)(C.ZP,{onClick:l,children:(0,e.jsx)(s.FormattedMessage,{id:"cancel"})}),(0,e.jsx)(C.ZP,{type:"primary",disabled:d,onClick:a,children:(0,e.jsx)(s.FormattedMessage,{id:"ok"})})]})]})},Na=[N.UL.TeamsLecture,N.UL.TestPortal,N.UL.TeamsForms],Oa=function(n){var t=n.open,r=n.closeModal,a=n.onSuccess,l=n.type,d=(0,Ke.Z)(),m=d.teacherSubjectData,g=d.fetchGroupUsers,x=(0,v.useState)(),S=E()(x,2),_=S[0],T=S[1];return(0,v.useEffect)(function(){if(ra(l)&&t){var p;m==null||(p=m.groups)===null||p===void 0||p.forEach(function(h){var b=h.id;return g(b)})}},[l,t]),(0,e.jsxs)(ct.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.".concat(l,"Convert")}),width:"40vw",open:t,onCancel:r,footer:(0,e.jsx)($a,{type:l,onOk:function(){_&&a(_)},onCancel:r,okDisabled:!_}),children:[Na.includes(l)&&(0,e.jsx)(La,{type:l,onDataConverted:T,groupSelectDisabled:!!_}),ra(l)&&(0,e.jsx)(Aa,{onDataConverted:T,examType:l})]})},Ua=function(n){var t=n.onSelect;return(0,e.jsxs)(ta.Z,{gutter:[16,16],children:[(0,e.jsx)(vt.Z,{span:12,children:(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return t(N.UL.TeamsForms)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadFile.MsTeamsForms",defaultMessage:"uploadFile.MsTeamsForms"})})}),(0,e.jsx)(vt.Z,{span:12,children:(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return t(N.UL.TestPortal)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadFile.TestPortal",defaultMessage:"uploadFile.TestPortal"})})}),(0,e.jsx)(vt.Z,{span:12,children:(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return t(N.UL.TeamsLecture)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadFile.MsTeams",defaultMessage:"uploadFile.MsTeams"})})}),(0,e.jsx)(vt.Z,{span:12,children:(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return t(N.UL.Manual)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGradesManually",defaultMessage:"uploadGradesManually"})})}),(0,e.jsx)(vt.Z,{span:12,children:(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return t(N.UL.ManualPass)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGradesManuallyPass",defaultMessage:"uploadGradesManuallyPass"})})}),(0,e.jsx)(vt.Z,{span:12,children:(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){return t(N.UL.ManualGrades)},children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGradesManuallyGrades",defaultMessage:"uploadGradesManuallyGrades"})})})]})},ka=[{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name"}),dataIndex:"first_name",editable:!1},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name"}),dataIndex:"last_name",editable:!1}],Ba=function(n){var t,r=n.exam_id,a=mt.ZP.useForm(),l=E()(a,1),d=l[0],m=(0,v.useState)(),g=E()(m,2),x=g[0],S=g[1],_=(0,v.useState)(),T=E()(_,2),p=T[0],h=T[1],b=(0,v.useState)(!1),F=E()(b,2),k=F[0],G=F[1],R=(0,Ke.Z)(),ie=R.semester_subject_id,z=R.getGroupById,q=(0,v.useMemo)(function(){var w;return((w=p==null?void 0:p.exam_results)!==null&&w!==void 0?w:[]).map(function($){var B=$.user_id;return B})},[p==null?void 0:p.exam_results]);(0,v.useEffect)(function(){var w=Number(r);r==="new"&&(S(void 0),h(void 0),d.resetFields()),r!=="new"&&!Number.isNaN(w)&&(G(!0),H(w).then(function($){if($.success){var B=$.data,ve=B.type,qe=B.results,ze=B.title,st=B.weight,at=B.passed_at,Pe=B.group_id;S(ve),h({group_id:Pe,exam_results:qe}),d.setFieldsValue({title:ze,weight:st,passed_at:at})}}).finally(function(){return G(!1)}))},[r]);var U=(0,v.useCallback)(function(){S(void 0),h(void 0)},[]);return k?(0,e.jsx)(he.Z,{}):(0,e.jsxs)(e.Fragment,{children:[x&&(0,e.jsx)(Oa,{open:!!(x&&!p),type:x,closeModal:U,onSuccess:h}),(0,e.jsxs)(mt.ZP,{form:d,submitter:x===void 0||!p?!1:void 0,onFinish:function(){var w=i()(f()().mark(function $(B){var ve,qe,ze,st,at,Pe,Ne,J;return f()().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(!(p&&typeof ie=="number")){ae.next=16;break}if(ve=B.title,qe=B.passed_at,ze=B.weight,st=Number(r),at=p.exam_results,Pe=p.group_id,Ne={type:x,semester_subject_id:ie,title:ve,passed_at:qe,weight:ze,group_id:Pe,results:at},!Number.isNaN(st)){ae.next=11;break}return ae.next=8,Je(Ne);case 8:ae.t0=ae.sent,ae.next=14;break;case 11:return ae.next=13,xe(st,Ne);case 13:ae.t0=ae.sent;case 14:J=ae.t0,J.success&&s.history.push("/teacher/subjects/".concat(ie,"/exams"));case 16:return ae.abrupt("return",!0);case 17:case"end":return ae.stop()}},$)}));return function($){return w.apply(this,arguments)}}(),onReset:U,children:[(0,e.jsxs)(mt.ZP.Group,{children:[(0,e.jsx)(Ia.Z,{label:(0,e.jsx)(s.FormattedMessage,{id:"examTitle",defaultMessage:"examTitle"}),rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],width:"lg",name:"title"}),(0,e.jsx)(Ga.Z,{label:(0,e.jsx)(s.FormattedMessage,{id:"datePassingExam",defaultMessage:"datePassingExam"}),rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],width:"lg",name:"passed_at"}),x!==N.UL.ManualGrades&&x!==N.UL.ManualPass&&(0,e.jsx)(mt.ZP.Item,{name:"weight",label:(0,e.jsx)(s.FormattedMessage,{id:"examImportance",defaultMessage:"examImportance"}),rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})},{type:"number",min:1,max:100,message:(0,e.jsx)(s.FormattedMessage,{id:"number_between",values:{min:1,max:100}})}],children:(0,e.jsx)(Yt.Z,{})})]}),x&&p&&(0,e.jsx)(Q.ZP,{rowKey:"user_id",headerTitle:(t=z(p.group_id))===null||t===void 0?void 0:t.name,editable:{type:"single",editableKeys:q,onValuesChange:function($,B){return h({group_id:p.group_id,exam_results:B})}},cardProps:{bodyStyle:{paddingInline:0}},search:!1,dataSource:p.exam_results.sort(function(w,$){return w.last_name.localeCompare($.last_name)}),pagination:{defaultPageSize:ft.Sl},columns:[].concat(ka,[function(){switch(x){case N.UL.ManualPass:return{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",valueType:"select",fieldProps:{options:ft.FW}};case N.UL.ManualGrades:return{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",valueType:"select",fieldProps:{options:ft.BP}};default:return{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",valueType:"percent",formItemProps:{rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})},{type:"number",min:0,max:100,message:(0,e.jsx)(s.FormattedMessage,{id:"number_between",values:{min:0,max:100}})}]}}}}()])}),!p&&(0,e.jsx)(Ua,{onSelect:S})]})]})},Wa=[{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name"}),dataIndex:"first_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name"}),dataIndex:"last_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"examResult"}),dataIndex:"result",hideInSearch:!0}],Ka=function(n){var t=n.exam_id,r=(0,v.useState)(""),a=E()(r,2),l=a[0],d=a[1];return(0,e.jsx)(Q.ZP,{className:"table-standalone",rowKey:"user_id",search:!1,headerTitle:l,pagination:{defaultPageSize:ft.Sl},request:i()(f()().mark(function m(){var g;return f()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,H(t);case 2:if(g=S.sent,!g.success){S.next=6;break}return d(g.data.title),S.abrupt("return",{total:g.data.results.length,success:!0,data:g.data.results});case 6:return S.abrupt("return",[]);case 7:case"end":return S.stop()}},m)})),columns:Wa})},Va=[{title:(0,e.jsx)(s.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",sorter:!0,width:"80px"},{title:(0,e.jsx)(s.FormattedMessage,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!0,sorter:!0},{title:(0,e.jsx)(s.FormattedMessage,{id:"type",defaultMessage:"type"}),dataIndex:"type",sorter:!0,render:function(n,t){return(0,e.jsx)(s.FormattedMessage,{id:"ExamGradeType.".concat(t.type)})}},{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.exam_date",defaultMessage:"Exam date"}),dataIndex:"passed_at",sorter:!0,render:function(n,t){return t.passed_at&&(0,yt.WU)(new Date(t.passed_at),jt.GC)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",sorter:!0,render:function(n,t){return t.weight?t.weight+"%":""}},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",sorter:!0,render:function(n,t){return t.created_at&&(0,yt.WU)(new Date(t.created_at),jt.GC)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"semester",defaultMessage:"Semester"}),dataIndex:"semester",sorter:!0,render:function(n,t){return(0,e.jsx)(s.FormattedMessage,{id:"SemesterType.".concat(t.semester.type),values:{year:t.semester.year}})}},{title:(0,e.jsx)(s.FormattedMessage,{id:"group",defaultMessage:"Group"}),dataIndex:"group_id",sorter:!0,render:function(n,t){return(0,e.jsx)(Dt.Z,{type:"Students",type_id:t.group_id},t.group_id)}}],za=function(){var n,t=(0,v.useRef)(),r=(0,Ke.Z)(),a=r.semester_subject_id,l=(0,s.useLocation)(),d=new URLSearchParams(l.search),m=(n=d.get("exam_id"))!==null&&n!==void 0?n:null,g=d.get("results");return g!==null&&!Number.isNaN(Number(g))?(0,e.jsx)(Ka,{exam_id:Number(g)}):m!==null?(0,e.jsx)(Ba,{exam_id:m}):(0,e.jsx)(Q.ZP,{className:"table-standalone",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),actionRef:t,search:!1,rowKey:"id",pagination:{defaultPageSize:ft.Sl},request:function(){var x=i()(f()().mark(function S(_,T){var p,h,b,F;return f()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(p=_.current,h=_.pageSize,a!==null){G.next=3;break}return G.abrupt("return",{data:[],total:0,success:!1});case 3:return b=T&&Object.entries(T)[0],G.next=6,Fe({per_page:h,page:p,semester_subject_id:Number.isNaN(a)?void 0:a,order_by:b&&b[0],order:b&&(b[1]==="ascend"?"ASC":"DESC")});case 6:if(F=G.sent,!F.success){G.next=9;break}return G.abrupt("return",{data:F.data,total:F.meta.total,success:!0});case 9:return G.abrupt("return",{data:[],total:0,success:!1});case 10:case"end":return G.stop()}},S)}));return function(S,_){return x.apply(this,arguments)}}(),columns:[].concat(Va,[{title:(0,e.jsx)(s.FormattedMessage,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(S,_){return[(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(_.semester_subject_id,"/exams?exam_id=").concat(_.id),children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,e.jsx)(C.ZP,{type:"primary",icon:(0,e.jsx)(ut.Z,{})})})},"edit"),(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(_.semester_subject_id,"/exams?results=").concat(_.id),children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.results",defaultMessage:"results"}),children:(0,e.jsx)(C.ZP,{icon:(0,e.jsx)(Za,{})})})},"results"),(0,e.jsx)(ea.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:i()(f()().mark(function T(){var p;return f()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,D(_.id);case 2:p=b.sent,p.success&&t.current&&t.current.reload();case 4:case"end":return b.stop()}},T)})),okText:(0,e.jsx)(s.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(s.FormattedMessage,{id:"no"}),children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(C.ZP,{type:"primary",icon:(0,e.jsx)(qt.Z,{}),danger:!0})})},"delete")]}}])})},Xa=o(69753),na=o(44167),Ha=o(84665),Ya=["type","defaultRender"],Ja=["type","defaultRender"],Qa=function(n){var t=n.url;return(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"download"}),children:(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){window.open(t,"_blank","noopener noreferrer")},icon:(0,e.jsx)(Xa.Z,{})})})},qa=[{title:(0,e.jsx)(s.FormattedMessage,{id:"ID"}),dataIndex:"id",hideInSearch:!0},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_at"}),dataIndex:"created_at",hideInSearch:!0,render:function(n,t){return(0,yt.WU)(new Date(t.created_at),jt.Cu)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_by"}),dataIndex:"created_by",renderFormItem:function(n,t,r){var a=t.type,l=t.defaultRender,d=Tt()(t,Ya);if(a==="form")return null;var m=r.getFieldValue("state");return(0,e.jsx)(na.Z,c()(c()({},d),{},{state:{type:m}}))},render:function(n,t){var r,a;return(0,e.jsx)(Dt.Z,{type:"EscolaLms\\Core\\Models\\User",type_id:t.created_by.id,text:t!=null&&(r=t.created_by)!==null&&r!==void 0&&r.first_name&&t!==null&&t!==void 0&&(a=t.created_by)!==null&&a!==void 0&&a.last_name?"".concat(t.created_by.first_name," ").concat(t.created_by.last_name):void 0},t.created_by.id)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"exported_at"}),dataIndex:"exported_at",hideInSearch:!0,render:function(n,t){return(0,yt.WU)(new Date(t.exported_at),jt.Cu)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"exported_by"}),dataIndex:"exported_by",renderFormItem:function(n,t,r){var a=t.type,l=t.defaultRender,d=Tt()(t,Ja);if(a==="form")return null;var m=r.getFieldValue("state");return(0,e.jsx)(na.Z,c()(c()({},d),{},{state:{type:m}}))},render:function(n,t){var r,a;return(0,e.jsx)(Dt.Z,{type:"EscolaLms\\Core\\Models\\User",type_id:t.exported_by.id,text:t!=null&&(r=t.exported_by)!==null&&r!==void 0&&r.first_name&&t!==null&&t!==void 0&&(a=t.exported_by)!==null&&a!==void 0&&a.last_name?"".concat(t.exported_by.first_name," ").concat(t.exported_by.last_name):void 0},t.exported_by.id)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"version"}),dataIndex:"version",hideInSearch:!0},{title:(0,e.jsx)(s.FormattedMessage,{id:"options"}),valueType:"option",render:function(n,t){return[(0,e.jsx)(Qa,{url:t.url},"download")]}}],er=function(){var n,t=(0,Ke.Z)(),r=t.teacherSubjectData,a=(0,v.useMemo)(function(){var d;return((d=r==null?void 0:r.groups)!==null&&d!==void 0?d:[]).map(function(m){var g=m.id,x=m.name;return{value:g,label:x}})},[r==null?void 0:r.groups]),l=(0,v.useMemo)(function(){var d;return[{title:(0,e.jsx)(s.FormattedMessage,{id:"group"}),dataIndex:"group_id",hideInTable:!0,valueType:"select",fieldProps:{options:a,defaultValue:r==null||(d=r.groups)===null||d===void 0||(d=d[0])===null||d===void 0?void 0:d.id,allowClear:!1}}].concat(qa)},[r==null||(n=r.groups)===null||n===void 0||(n=n[0])===null||n===void 0?void 0:n.id,a]);return(0,e.jsx)(Q.ZP,{className:"table-standalone",request:function(){var d=i()(f()().mark(function m(g){var x,S,_,T,p,h;return f()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return S=g.group_id,_=S===void 0?r==null||(x=r.groups)===null||x===void 0||(x=x[0])===null||x===void 0?void 0:x.id:S,T=g.created_by,p=g.exported_by,F.next=3,(0,Ha.v)({group_id:_,created_by:T,exported_by:p});case 3:if(h=F.sent,h.success){F.next=6;break}return F.abrupt("return",{success:!1,data:[],total:0});case 6:return F.abrupt("return",{success:!0,data:h.data,total:h.data.length});case 7:case"end":return F.stop()}},m)}));return function(m){return d.apply(this,arguments)}}(),columns:l,search:{layout:"vertical"},scroll:{x:1500},pagination:{defaultPageSize:ft.Sl}})},sa=o(64317),Ot=o(96074),ia=o(11312),tr=o(87366),Ut=o(99100),ar=["attendances"];function rr(u){return function(t){u(function(r){return c()(c()({},r),{},{loading:t})})}}function ua(u,n){return kt.apply(this,arguments)}function kt(){return kt=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n(!0),a.prev=1,a.abrupt("return",t());case 3:return a.prev=3,n(!1),a.finish(3);case 6:case"end":return a.stop()}},u,null,[[1,,3,6]])})),kt.apply(this,arguments)}function nr(u,n){var t=(0,v.useState)({loading:!1}),r=E()(t,2),a=r[0],l=r[1],d=(0,v.useCallback)(rr(l),[]),m=(0,v.useCallback)(i()(f()().mark(function x(){var S;return f()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,$t(u,n);case 2:if(S=T.sent,S.success){T.next=5;break}return T.abrupt("return",S);case 5:return l(function(p){return c()(c()({},p),{},{data:S.data})}),T.abrupt("return",S);case 7:case"end":return T.stop()}},x)})),[n,u]),g=(0,v.useCallback)(function(x){return ua(d,function(){return je(x).then(m)})},[m]);return(0,v.useEffect)(function(){ua(d,m)},[m]),{finalGrades:a,deleteFinalGrade:g}}function sr(){var u=(0,v.useState)({loading:!1}),n=E()(u,2),t=n[0],r=n[1];return(0,v.useEffect)(function(){r(function(a){return c()(c()({},a),{},{loading:!0})}),bt().then(function(a){a.success&&r(function(l){return c()(c()({},l),{},{data:a.data})})}).finally(function(){r(function(a){return c()(c()({},a),{},{loading:!1})})})},[]),{gradeTerms:t}}function ir(u){var n=(0,v.useState)({loading:!1}),t=E()(n,2),r=t[0],a=t[1];return(0,v.useEffect)(function(){u!==void 0&&(a(function(l){return c()(c()({},l),{},{loading:!0})}),Ct(u).then(function(l){l.success&&a(function(d){return c()(c()({},d),{},{data:l.data})})}).finally(function(){a(function(l){return c()(c()({},l),{},{loading:!1})})}))},[u]),{subjectGradeScales:r}}function ur(u,n,t){var r=(0,v.useState)({loading:!1}),a=E()(r,2),l=a[0],d=a[1];return(0,v.useEffect)(function(){typeof u!="number"||typeof n!="number"||typeof t!="number"||(d(function(m){return c()(c()({},m),{},{loading:!0})}),V(u,n).then(function(m){m.success&&d(function(g){var x,S;return c()(c()({},g),{},{data:(x=zt(t,(S=m.data.grade_scale)!==null&&S!==void 0?S:[]))===null||x===void 0?void 0:x.map(function(_,T){return c()(c()({},_),{},{id:T})})})})}).finally(function(){d(function(m){return c()(c()({},m),{},{loading:!1})})}))},[u,n]),{tutorGradeScales:l}}function or(u,n){var t=(0,v.useState)({loading:!1}),r=E()(t,2),a=r[0],l=r[1],d=(0,v.useCallback)(function(){l(function(m){return c()(c()({},m),{},{loading:!0})}),Ie(u).then(function(m){if(m.success){var g=m.data.reduce(function(x,S){var _=S.attendances,T=Tt()(S,ar),p=_.find(function(h){return h.user_id===n});return p?[].concat(Z()(x),[c()(c()({},T),{},{attendance:p})]):x},[]);l(function(x){return c()(c()({},x),{},{data:g})})}}).finally(function(){l(function(m){return c()(c()({},m),{},{loading:!1})})})},[u,n]);return(0,v.useEffect)(function(){d()},[d]),{userAttendanceSchedules:a,fetchUserAttendanceSchedules:d}}function lr(u,n){var t=(0,v.useState)({loading:!1}),r=E()(t,2),a=r[0],l=r[1];return(0,v.useEffect)(function(){n&&(l(function(d){return c()(c()({},d),{},{loading:!0})}),Fe({student_id:u,semester_subject_id:n}).then(function(d){if(d.success){var m=Kt(d.data,u);l(function(g){return c()(c()({},g),{},{data:m})})}}).finally(function(){l(function(d){return c()(c()({},d),{},{loading:!1})})}))},[u,n]),{studentExams:a}}function dr(u,n){var t=(0,v.useState)({loading:!1}),r=E()(t,2),a=r[0],l=r[1],d=(0,v.useState)({loading:!1}),m=E()(d,2),g=m[0],x=m[1],S=(0,v.useState)({loading:!1}),_=E()(S,2),T=_[0],p=_[1];return(0,v.useEffect)(function(){l(function(h){return c()(c()({},h),{},{loading:!0})}),(0,Ut.N7)({group_id:u}).then(function(h){h.success&&l(function(b){return c()(c()({},b),{},{data:h.data})})}).finally(function(){l(function(h){return c()(c()({},h),{},{loading:!1})})})},[u]),(0,v.useEffect)(function(){a.data&&(p(function(h){return c()(c()({},h),{},{loading:!0})}),Promise.all(a.data.map(function(h){var b=h.id;return(0,Ut.Nx)(Number(b))})).then(function(h){h.forEach(function(b){b.success&&p(function(F){return c()(c()({},F),{},{data:c()(c()({},F.data),{},nt()({},Number(b.data.id),(0,tr.uS)(b.data.lessons)))})})})}).finally(function(){p(function(h){return c()(c()({},h),{},{loading:!1})})}),x(function(h){return c()(c()({},h),{},{loading:!0})}),Promise.all(a.data.map(function(h){var b=h.id;return(0,Ut.ue)(Number(b),["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics","EscolaLms\\Reports\\Stats\\Course\\AttendanceList"]).then(function(F){if(F.success){var k,G,R=((k=F.data["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics"])!==null&&k!==void 0?k:[]).filter(function(z){return z.id===n}),ie=(G=F.data["EscolaLms\\Reports\\Stats\\Course\\AttendanceList"])!==null&&G!==void 0?G:[];x(function(z){return c()(c()({},z),{},{data:c()(c()({},z.data),{},nt()({},Number(b),{finishedTopics:R,attendanceList:ie}))})})}})})).finally(function(){return x(function(h){return c()(c()({},h),{},{loading:!1})})}))},[a.data,n]),{userCourses:a,userCoursesStats:g,userCoursesTopics:T}}var cr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"grade"},{title:(0,e.jsx)(s.FormattedMessage,{id:"degree"}),dataIndex:"name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent"}],mr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"date"}),dataIndex:"date_from",render:function(n,t){return(0,yt.WU)(new Date(t.date_from),jt.GC)}}],fr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"name"}),dataIndex:"title"},{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",valueType:"percent"},{title:(0,e.jsx)(s.FormattedMessage,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",render:function(n,t){return(0,yt.WU)(new Date(t.created_at),jt.GC)}},{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"result",render:function(n,t){return"".concat(t.result.result," ").concat(t.weight?"%":"")}}],vr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"name"}),dataIndex:"name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"issued_at"}),dataIndex:"grade",render:function(n,t){var r,a;return(r=t.grade)!==null&&r!==void 0&&r.grade_date?(0,yt.WU)(new Date((a=t.grade)===null||a===void 0?void 0:a.grade_date),jt.GC):"-"}},{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"grade",render:function(n,t){var r,a;return(r=(a=t.grade)===null||a===void 0?void 0:a.grade_name)!==null&&r!==void 0?r:"-"}}],At=6,pr=function(n){var t,r,a,l,d=n.user_id,m=n.group_id,g=(0,Ke.Z)(),x=g.semester_subject_id,S=lr(d,x),_=S.studentExams,T=nr(m,d),p=T.finalGrades,h=T.deleteFinalGrade,b=sr(),F=b.gradeTerms,k=ir((t=p.data)===null||t===void 0?void 0:t.s_subject_scale_form_id),G=k.subjectGradeScales,R=ur(x,(r=p.data)===null||r===void 0?void 0:r.tutor_id,(a=p.data)===null||a===void 0?void 0:a.s_subject_scale_form_id),ie=R.tutorGradeScales,z=or(m,d),q=z.userAttendanceSchedules,U=z.fetchUserAttendanceSchedules,w=dr(m,d),$=w.userCourses,B=w.userCoursesStats,ve=w.userCoursesTopics,qe=mt.ZP.useForm(),ze=E()(qe,1),st=ze[0],at=(0,v.useMemo)(function(){var Ze;return((Ze=F.data)!==null&&Ze!==void 0?Ze:[]).map(function(De){var Le=De.id,Ve=De.name;return{label:Ve,value:Le}})},[F.data]),Pe=(0,v.useMemo)(function(){var Ze;return((Ze=G.data)!==null&&Ze!==void 0?Ze:[]).map(function(De){var Le=De.name,Ve=De.id;return{label:Le,value:Ve}})},[G.data]),Ne=(0,v.useMemo)(function(){var Ze,De;return Vt((Ze=_.data)!==null&&Ze!==void 0?Ze:[],(De=ie.data)!==null&&De!==void 0?De:[])},[_.data,ie.data]),J=(0,v.useCallback)(function(){var Ze=i()(f()().mark(function De(Le){var Ve,rt,gt,ht,Ue,lt,dt;return f()().wrap(function(it){for(;;)switch(it.prev=it.next){case 0:if(gt=Le.grade_scale_id,ht=Le.grade_term_id,((Ve=p.data)===null||Ve===void 0?void 0:Ve.id)!==void 0){it.next=3;break}return it.abrupt("return");case 3:if(Ue=(rt=p.data)===null||rt===void 0?void 0:rt.grades.find(function(Gt){var Et=Gt.grade_term;return Et.id===ht}),!Ue){it.next=11;break}return it.next=7,me(Ue.id,{grade_scale_id:gt});case 7:return lt=it.sent,Ae.ZP[lt.success?"success":"error"](lt.message),lt.success&&s.history.push("/teacher/subjects/".concat(x,"/final-grades")),it.abrupt("return");case 11:return it.next=13,ce({grade_scale_id:gt,grade_term_id:ht,lesson_group_user_id:p.data.id});case 13:dt=it.sent,Ae.ZP[dt.success?"success":"error"](dt.message),dt.success&&s.history.push("/teacher/subjects/".concat(x,"/final-grades"));case 16:case"end":return it.stop()}},De)}));return function(De){return Ze.apply(this,arguments)}}(),[p.data,x]),Ce=(0,v.useMemo)(function(){return[].concat(vr,[{title:(0,e.jsx)(s.FormattedMessage,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",render:function(De,Le){var Ve;return typeof(Le==null||(Ve=Le.grade)===null||Ve===void 0?void 0:Ve.id)=="number"?[(0,e.jsx)(ea.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:function(){return h(Le.grade.id)},okText:(0,e.jsx)(s.FormattedMessage,{id:"yes",defaultMessage:"Yes"}),cancelText:(0,e.jsx)(s.FormattedMessage,{id:"no",defaultMessage:"No"}),children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(C.ZP,{type:"primary",icon:(0,e.jsx)(qt.Z,{}),danger:!0})})},"delete")]:[]}}])},[]),ae=(0,v.useMemo)(function(){var Ze;return((Ze=F.data)!==null&&Ze!==void 0?Ze:[]).map(function(De){var Le;return c()(c()({},De),{},{grade:(Le=p.data)===null||Le===void 0?void 0:Le.grades.find(function(Ve){var rt=Ve.grade_term;return rt.id===De.id})})})},[p.data,F.data]),Xe=$.loading&&!$.data||B.loading&&!B.data||ve.loading&&!ve.data,we=!!($.data&&B.data&&ve.data);return p.loading?(0,e.jsx)(he.Z,{}):(0,e.jsxs)(e.Fragment,{children:[p.data&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(re.Z.Text,{style:{fontSize:"16px",fontWeight:500},children:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.Student",values:p.data.user})}),(0,e.jsx)(Ot.Z,{})]}),(0,e.jsxs)(ta.Z,{gutter:[48,48],justify:"space-between",children:[(0,e.jsx)(vt.Z,{span:12,children:(0,e.jsx)(Q.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.StudentPartialGrades"}),search:!1,pagination:{pageSize:At},dataSource:_.data,loading:_.loading,columns:fr,options:!1,cardProps:{bodyStyle:{padding:0}}})}),(0,e.jsx)(vt.Z,{span:12,children:(0,e.jsx)(Q.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.FinalGrades"}),search:!1,pagination:{pageSize:At},dataSource:ae,loading:p.loading||F.loading,columns:Ce,options:!1,cardProps:{bodyStyle:{padding:0}}})}),(0,e.jsx)(vt.Z,{span:12,children:(0,e.jsx)(Q.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.Attendances"}),search:!1,options:!1,pagination:{pageSize:At},cardProps:{bodyStyle:{padding:0}},dataSource:q.data,loading:q.loading,columns:[].concat(mr,[{title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.Attendance"}),dataIndex:"attendance",render:function(De,Le){return(0,e.jsx)(Ht,{groupAttendanceScheduleId:Le.id,studentId:d,attendance:Le.attendance.value,onSuccess:U})}}])})}),(0,e.jsx)(vt.Z,{span:12,children:(0,e.jsx)(Q.ZP,{rowKey:"id",headerTitle:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.GradesScale"}),search:!1,options:!1,pagination:{pageSize:At},cardProps:{bodyStyle:{padding:0}},dataSource:ie.data,loading:ie.loading,columns:cr})}),Xe&&(0,e.jsx)(he.Z,{}),we&&((l=$.data)===null||l===void 0?void 0:l.map(function(Ze){var De,Le,Ve,rt,gt,ht,Ue=Ze.id,lt=Ze.title;return(0,e.jsxs)(vt.Z,{span:24,children:[(0,e.jsx)(re.Z.Text,{style:{fontSize:"16px",fontWeight:500},children:lt}),(0,e.jsx)(ia.Du,{course_id:Number(Ue),topics:(De=(Le=ve.data)===null||Le===void 0?void 0:Le[Number(Ue)])!==null&&De!==void 0?De:[],stats:(Ve=(rt=B.data)===null||rt===void 0||(rt=rt[Number(Ue)])===null||rt===void 0?void 0:rt.finishedTopics)!==null&&Ve!==void 0?Ve:[]}),(0,e.jsx)(ia.nu,{stats:(gt=(ht=B.data)===null||ht===void 0||(ht=ht[Number(Ue)])===null||ht===void 0?void 0:ht.attendanceList)!==null&&gt!==void 0?gt:[]})]},Ue)}))]}),(0,e.jsx)(mt.ZP,{form:st,onFinish:J,children:(0,e.jsxs)(mt.ZP.Group,{style:{display:"flex",flexDirection:"column",paddingTop:"48px"},title:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.IssueAssessment"}),titleStyle:{flex:"unset"},align:"center",children:[(0,e.jsx)(sa.Z,{name:"grade_term_id",rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],label:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.GradeTerm"}),options:at,width:"sm",fieldProps:{loading:F.loading}}),(0,e.jsx)(sa.Z,{name:"grade_scale_id",rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})}],label:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.FinalGrade"}),options:Pe,fieldProps:{loading:p.loading||G.loading}}),(0,e.jsx)(mt.ZP.Item,{children:(0,e.jsx)(s.FormattedMessage,{id:"TeacherSubjects.FinalGrades.ProposedGrade",values:{grade:Ne}})})]})})]})},gr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name"}),dataIndex:"first_name",render:function(n,t){return t.user.first_name}},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name"}),dataIndex:"last_name",render:function(n,t){return t.user.last_name}},{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),hideInSearch:!0,dataIndex:"grades",render:function(n,t){return(0,e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:t.grades.length?t.grades.map(function(r){var a=r.grade_name,l=r.grade_term,d=r.id;return(0,e.jsxs)(re.Z.Text,{children:[l.name,": ",a]},d)}):"-"})}}],hr=function(){var n,t,r=(0,s.useLocation)(),a=new URLSearchParams(r.search),l=(n=a.get("user_id"))!==null&&n!==void 0?n:null,d=(t=a.get("group_id"))!==null&&t!==void 0?t:null,m=(0,Ke.Z)(),g=m.teacherSubjectData,x=m.semester_subject_id,S=(0,v.useMemo)(function(){var _;return((_=g==null?void 0:g.groups)!==null&&_!==void 0?_:[]).map(function(T){var p=T.id,h=T.name;return{label:h,value:p}})},[g==null?void 0:g.groups]);return l!==null&&d!==null?(0,e.jsx)(pr,{user_id:Number(l),group_id:Number(d)}):(0,e.jsx)(Q.ZP,{className:"table-standalone",rowKey:"id",search:{layout:"vertical"},pagination:{defaultPageSize:ft.Sl},request:function(){var _=i()(f()().mark(function T(p){var h,b,F,k,G,R,ie,z,q,U;return f()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return b=p.group_id,F=b===void 0?[]:b,k=p.first_name,G=k===void 0?"":k,R=p.last_name,ie=R===void 0?"":R,z=((h=g==null?void 0:g.groups)!==null&&h!==void 0?h:[]).map(function(B){var ve=B.id;return ve}),$.next=4,tt(F.length===0?z:F);case 4:if(q=$.sent,q.success){$.next=7;break}return $.abrupt("return",{success:!1,total:0,data:[]});case 7:return U=q.data.filter(function(B){var ve=B.user;return ve.first_name.toLowerCase().includes(G.toLowerCase())&&ve.last_name.toLowerCase().includes(ie.toLowerCase())}),$.abrupt("return",{success:!0,total:U.length,data:U});case 9:case"end":return $.stop()}},T)}));return function(T){return _.apply(this,arguments)}}(),columns:[{title:(0,e.jsx)(s.FormattedMessage,{id:"group"}),dataIndex:"group_id",valueType:"select",fieldProps:{options:S,mode:"multiple"},render:function(T,p){return(0,e.jsx)(Dt.Z,{type:"Students",type_id:p.group_id},p.group_id)}}].concat(gr,[{title:(0,e.jsx)(s.FormattedMessage,{id:"options"}),hideInSearch:!0,render:function(T,p){return[(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(x,"/final-grades?user_id=").concat(p.user.id,"&group_id=").concat(p.group_id),children:(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"edit"}),children:(0,e.jsx)(C.ZP,{type:"primary",icon:(0,e.jsx)(ut.Z,{})})})},"edit")]}}])})},xr=o(88284),jr=o(88280),Sr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"grade"}),dataIndex:"grade",editable:!1},{title:(0,e.jsx)(s.FormattedMessage,{id:"degree"}),dataIndex:"name",editable:!1},{title:(0,e.jsx)(s.FormattedMessage,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent",formItemProps:{rules:[{required:!0,message:(0,e.jsx)(s.FormattedMessage,{id:"field_required"})},{type:"number",min:0,max:100,message:(0,e.jsx)(s.FormattedMessage,{id:"number_between",values:{min:0,max:100}})}]}}],br=function(n){var t=n.subjectTutorGradeScale,r=n.onFormSubmit,a=(0,v.useState)([]),l=E()(a,2),d=l[0],m=l[1],g=(0,v.useRef)(),x=mt.ZP.useForm(),S=E()(x,1),_=S[0];return(0,v.useEffect)(function(){var T,p=((T=t.scale)!==null&&T!==void 0?T:[]).map(function(h,b){return c()(c()({},h),{},{id:String((b+1)*100)})});_.setFieldValue("table",p)},[]),(0,e.jsx)(mt.ZP,{form:_,onFinish:r,submitter:{render:function(p,h){var b=E()(h,2),F=b[1];return[F]}},children:(0,e.jsx)(jr.Z,{name:"table",rowKey:"id",actionRef:g,formItemProps:{label:(0,e.jsx)(s.FormattedMessage,{id:"grades-scale"})},cardProps:{bodyStyle:{padding:0}},recordCreatorProps:!1,columns:[].concat(Sr,[{title:(0,e.jsx)(s.FormattedMessage,{id:"options"}),valueType:"option",render:function(p,h){return(0,e.jsx)(C.ZP,{type:"primary",onClick:function(){var F;return(F=g.current)===null||F===void 0?void 0:F.startEditable(h.id)},icon:(0,e.jsx)(ut.Z,{})})}}]),editable:{form:_,type:"multiple",editableKeys:d,saveText:(0,e.jsx)(C.ZP,{type:"primary",icon:(0,e.jsx)(xr.Z,{})}),onChange:m,actionRender:function(p,h,b){return[b.save]}}})})},yr=function(){var n,t,r=(0,s.useModel)("@@initialState"),a=r.initialState,l=(0,Ke.Z)(),d=l.semester_subject_id,m=l.tutors,g=(0,v.useState)(),x=E()(g,2),S=x[0],_=x[1],T=(0,v.useState)(!1),p=E()(T,2),h=p[0],b=p[1],F=(0,v.useState)(null),k=E()(F,2),G=k[0],R=k[1],ie=(0,v.useMemo)(function(){return!!m.data.find(function(w){var $,B=w.id;return B===(a==null||($=a.currentUser)===null||$===void 0?void 0:$.id)})},[m.data,a==null||(n=a.currentUser)===null||n===void 0?void 0:n.id]),z=(0,v.useMemo)(function(){return m.data.map(function(w){var $=w.id,B=w.first_name,ve=w.last_name;return{label:"".concat(B," ").concat(ve),value:$}})},[m.data]),q=(0,v.useCallback)(function(){d===null||G===null||(b(!0),_(void 0),V(d,G).then(function(w){w.success&&_(w.data)}).finally(function(){b(!1)}))},[d,G]),U=(0,v.useCallback)(function(w,$){return function(){var B=i()(f()().mark(function ve(qe){var ze,st;return f()().wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:if(!(d===null||G===null)){Pe.next=2;break}return Pe.abrupt("return");case 2:return ze=w.reduce(function(Ne,J){return J.s_subject_scale_form_id===$?[].concat(Z()(Ne),[{s_subject_scale_form_id:$,scale:qe.table.map(function(Ce){var ae=Ce.name,Xe=Ce.grade,we=Ce.grade_value;return{name:ae,grade:Xe,grade_value:we}})}]):[].concat(Z()(Ne),[J])},[]),Pe.next=5,ne(d,G,{grade_scale:ze});case 5:st=Pe.sent,st.success&&q();case 7:case"end":return Pe.stop()}},ve)}));return function(ve){return B.apply(this,arguments)}}()},[G,d]);return(0,v.useEffect)(function(){var w,$;if(!ie||!(a!=null&&(w=a.currentUser)!==null&&w!==void 0&&w.id)){var B;if((B=m.data)!==null&&B!==void 0&&B[0]){var ve;R((ve=m.data)===null||ve===void 0?void 0:ve[0].id)}return}R(a==null||($=a.currentUser)===null||$===void 0?void 0:$.id)},[a==null||(t=a.currentUser)===null||t===void 0?void 0:t.id,ie]),(0,v.useEffect)(function(){q()},[q]),m.loading?(0,e.jsx)(he.Z,{}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(mt.ZP.Item,{label:(0,e.jsx)(s.FormattedMessage,{id:"menu.Teacher"}),children:(0,e.jsx)(Ft.default,{disabled:ie,placeholder:(0,e.jsx)(s.FormattedMessage,{id:"select"}),options:z,value:G,onChange:function($){return R($)}})}),(0,e.jsx)(Ot.Z,{}),h&&!S&&(0,e.jsx)(he.Z,{}),S!=null&&S.grade_scale?S.grade_scale.map(function(w,$){var B;return(0,e.jsxs)(v.Fragment,{children:[$>0&&(0,e.jsx)(Ot.Z,{}),(0,e.jsx)(br,{subjectTutorGradeScale:w,onFormSubmit:U((B=S.grade_scale)!==null&&B!==void 0?B:[],w.s_subject_scale_form_id)})]},w.s_subject_scale_form_id)}):(0,e.jsx)(re.Z.Paragraph,{style:{textAlign:"center"},children:(0,e.jsx)(s.FormattedMessage,{id:"gradesScalesMissing"})})]})},_r=o(30814),Mr=o(40411),Cr=o(31156),Tr=o(27484),pt=o.n(Tr);function Fr(u,n){return Bt.apply(this,arguments)}function Bt(){return Bt=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/schedules",c()({params:n,method:"GET",useCache:!1},t||{})));case 1:case"end":return a.stop()}},u)})),Bt.apply(this,arguments)}var Er=function(){var n=(0,v.useState)(null),t=E()(n,2),r=t[0],a=t[1],l=(0,v.useState)([]),d=E()(l,2),m=d[0],g=d[1],x=(0,Ke.Z)(),S=x.semester_subject_id,_=pt()(),T=(0,v.useMemo)(function(){return m.map(function(R){return{id:R.id,title:"".concat(R.group.name," (").concat(R.term_status.name,")"),start:pt()(R.date_from).toDate(),end:pt()(R.date_to).toDate(),tutor_name:"".concat(R.tutor.first_name," ").concat(R.tutor.last_name),tutor_email:R.tutor.email,semester:R.semester.name,group:R.group.name,subject:R.subject.name,ms_teams_join_url:R.ms_teams_join_url}})},[m]),p=(0,v.useCallback)(function(R,ie){Fr({semester_subject_id:S,date_form:R.toDate(),date_to:ie.toDate()}).then(function(z){z.success&&g(z.data)})},[S]),h=(0,v.useCallback)(function(R){a(R)},[]),b=(0,v.useCallback)(function(){a(null)},[]),F=(0,v.useCallback)(function(R){return R.isSame(_,"day")?"warning":R.isAfter(_,"day")?"success":"error"},[]),k=(0,v.useCallback)(function(R){var ie=T.filter(function(z){return pt()(z.start).isSame(R,"day")});return(0,e.jsx)("ul",{className:"events",children:ie.map(function(z){return(0,e.jsx)("li",{onClick:function(){return h(z)},children:(0,e.jsx)(Mr.Z,{status:F(pt()(z.start)),text:z.title})},z.id)})})},[m]),G=(0,v.useCallback)(function(R,ie){var z=pt()(R).startOf(ie).subtract(1,"month"),q=pt()(R).endOf(ie).add(1,"month");p(z,q)},[]);return(0,v.useEffect)(function(){var R=pt()().startOf("month"),ie=pt()().endOf("month");p(R,ie)},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(re.Z.Title,{level:4,children:(0,e.jsx)(s.FormattedMessage,{id:"schedule",defaultMessage:"Schedule"})}),(0,e.jsx)(Cr.Z,{dateCellRender:k,onPanelChange:G}),(0,e.jsxs)(ct.Z,{open:r!==null,title:"".concat(r==null?void 0:r.subject,": ").concat(r==null?void 0:r.title),onCancel:b,footer:null,children:[(0,e.jsxs)(re.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"tutorName",defaultMessage:"Tutor"}),": ",r==null?void 0:r.tutor_name]}),(0,e.jsxs)(re.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"email",defaultMessage:"Email"}),": ",r==null?void 0:r.tutor_email]}),(0,e.jsxs)(re.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"group",defaultMessage:"Group"}),": ",r==null?void 0:r.group]}),(0,e.jsxs)(re.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"semester",defaultMessage:"Semester"}),": ",r==null?void 0:r.semester]}),(0,e.jsxs)(re.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"started_at",defaultMessage:"Start date"}),":",r&&pt()(r.start).format(jt.E)]}),(0,e.jsxs)(re.Z.Paragraph,{children:[(0,e.jsx)(s.FormattedMessage,{id:"end_at",defaultMessage:"End date"}),":",r&&pt()(r.end).format(jt.E)]}),(r==null?void 0:r.ms_teams_join_url)&&(0,e.jsx)(re.Z.Paragraph,{children:(0,e.jsx)("a",{href:r.ms_teams_join_url,target:"_blank",rel:"noreferrer",children:(0,e.jsx)(C.ZP,{type:"primary",children:(0,e.jsx)(s.FormattedMessage,{id:"msTeams"})})},"teamsLink")})]})]})},Pr=o(58638);function Zr(u,n){return Wt.apply(this,arguments)}function Wt(){return Wt=i()(f()().mark(function u(n,t){return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,s.request)("/api/admin/chats/ms-teams",c()({method:"POST",headers:{"Content-Type":"application/json"},data:n},t||{})));case 1:case"end":return a.stop()}},u)})),Wt.apply(this,arguments)}var Ir=function(n){var t=n.student_id,r=(0,v.useState)(!1),a=E()(r,2),l=a[0],d=a[1],m=(0,v.useCallback)(i()(f()().mark(function g(){var x;return f()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d(!0),_.next=3,Zr({user_id:t});case 3:if(x=_.sent,x.success){_.next=8;break}return Ae.ZP.error(x.message),d(!1),_.abrupt("return");case 8:window.open(x.data.web_url,"_blank","noopener noreferrer"),d(!1);case 10:case"end":return _.stop()}},g)})),[]);return(0,e.jsx)(ue.Z,{title:(0,e.jsx)(s.FormattedMessage,{id:"msTeams",defaultMessage:"teams"}),children:(0,e.jsx)(C.ZP,{loading:l,type:"primary",icon:(0,e.jsx)(Pr.Z,{}),onClick:m})})},Gr=[{title:(0,e.jsx)(s.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"user_id",hideInSearch:!0,width:"80px"},{title:(0,e.jsx)(s.FormattedMessage,{id:"first_name",defaultMessage:"First name"}),dataIndex:"first_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"last_name",defaultMessage:"Last name"}),dataIndex:"last_name"},{title:(0,e.jsx)(s.FormattedMessage,{id:"email",defaultMessage:"email"}),dataIndex:"email"},{title:(0,e.jsx)(s.FormattedMessage,{id:"groupName",defaultMessage:"Group name"}),dataIndex:"group_name",hideInSearch:!0}],wr=function(n){return n.map(function(t){var r=t.id,a=t.name;return{label:a,value:r}})},Dr=function(n){return n.reduce(function(t,r){var a,l=r==null||(a=r.users)===null||a===void 0?void 0:a.reduce(function(d,m){return m.academic_teacher_id!==null?d:[].concat(Z()(d),[{group_id:r.id,group_name:r.name,user_id:m.id,first_name:m.first_name,last_name:m.last_name,email:m.email}])},[]);return[].concat(Z()(t),Z()(l))},[])},Lr=function(){var n=(0,Ke.Z)(),t=n.teacherSubjectData,r=(0,v.useMemo)(function(){var a;return wr((a=t==null?void 0:t.groups)!==null&&a!==void 0?a:[])},[t==null?void 0:t.groups]);return(0,e.jsx)(Q.ZP,{className:"table-standalone",rowKey:function(l){return"".concat(l.group_id,"-").concat(l.user_id)},search:{layout:"vertical"},pagination:{defaultPageSize:ft.Sl},request:function(){var a=i()(f()().mark(function l(d){var m,g,x,S,_,T,p,h,b;return f()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return m=d.groups,g=d.first_name,x=g===void 0?"":g,S=d.last_name,_=S===void 0?"":S,T=d.email,p=T===void 0?"":T,k.next=3,(0,Qe.Z)({parent_id:t==null?void 0:t.group_id,"id[]":m});case 3:if(h=k.sent,h.success){k.next=6;break}return k.abrupt("return",{data:[],total:0,success:!1});case 6:return b=Dr(h.data).filter(function(G){return G.first_name.toLowerCase().includes(x.toLowerCase())&&G.last_name.toLowerCase().includes(_.toLowerCase())&&G.email.toLowerCase().includes(p.toLowerCase())}),k.abrupt("return",{data:b,total:b.length,success:!0});case 8:case"end":return k.stop()}},l)}));return function(l){return a.apply(this,arguments)}}(),columns:[{title:(0,e.jsx)(s.FormattedMessage,{id:"groups",defaultMessage:"Groups"}),dataIndex:"groups",hideInTable:!0,filterMultiple:!0,valueType:"select",fieldProps:{options:r,mode:"multiple"}}].concat(Gr,[{hideInSearch:!0,title:(0,e.jsx)(s.FormattedMessage,{id:"msTeams"}),dataIndex:"teamsLink",valueType:"option",render:function(l,d){return[(0,e.jsx)(Ir,{student_id:d.user_id},"teamsChat")]}}])})},Ar=function(n){var t,r,a=n.tab,l=(0,s.useIntl)(),d=(0,s.useModel)("@@initialState"),m=d.setInitialState,g=d.initialState,x=(0,Ke.Z)(),S=x.teacherSubjectData,_=x.semester_subject_id,T=x.tutors,p=(0,v.useCallback)((0,I.X)(g==null?void 0:g.currentUser),[g==null?void 0:g.currentUser]),h=(0,v.useMemo)(function(){return!!T.data.find(function(b){var F,k=b.id;return k===(g==null||(F=g.currentUser)===null||F===void 0?void 0:F.id)})||p(Ye.Z.TeacherListGradeScale)},[]);return S?(0,e.jsx)(A._z,{title:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(s.FormattedMessage,{id:S==null||(t=S.subject)===null||t===void 0?void 0:t.name}),", ",(0,e.jsx)(s.FormattedMessage,{id:a})]}),tabBarExtraContent:(0,e.jsx)("div",{style:{display:"flex",padding:"12px",gap:"12px"},children:(0,e.jsx)(s.Link,{to:"/teacher/subjects/".concat(_,"/exams?exam_id=new"),children:(0,e.jsx)(C.ZP,{type:"primary",children:(0,e.jsx)(s.FormattedMessage,{id:"uploadGrades",defaultMessage:"uploadGrades"})})})}),header:{breadcrumb:{routes:[{path:"teacher",breadcrumbName:l.formatMessage({id:"menu.Teacher"})},{path:"subjects",breadcrumbName:l.formatMessage({id:"menu.Teacher.Subjects"})},{path:String(_),breadcrumbName:String((r=S.subject)===null||r===void 0?void 0:r.name)},{path:String(a),breadcrumbName:l.formatMessage({id:a,defaultMessage:String(a)})}]}},children:(0,e.jsxs)(ye.ZP,{bodyStyle:{padding:"24px"},tabs:{type:"card",activeKey:a,onChange:function(F){m(c()({},g)),s.history.push("/teacher/subjects/".concat(_,"/").concat(F))}},children:[(0,e.jsx)(ye.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"groups"}),children:(0,e.jsx)(_r.F,{})},"groups"),(0,e.jsx)(ye.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"students"}),children:(0,e.jsx)(Lr,{})},"students"),(0,e.jsx)(ye.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"exams"}),children:(0,e.jsx)(za,{})},"exams"),(0,e.jsx)(ye.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"schedule"}),children:(0,e.jsx)(Er,{})},"schedule"),(0,e.jsx)(ye.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"class-register"}),children:(0,e.jsx)(Ta,{})},"class-register"),h&&(0,e.jsx)(ye.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"grades-scale"}),children:(0,e.jsx)(yr,{})},"grades-scale"),(0,e.jsx)(ye.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"final-grades"}),children:(0,e.jsx)(hr,{})},"final-grades"),(0,e.jsx)(ye.ZP.TabPane,{tab:(0,e.jsx)(s.FormattedMessage,{id:"file-exports-history"}),children:(0,e.jsx)(er,{})},"file-exports-history")]})}):(0,e.jsx)(he.Z,{})},Rr=function(){var u=(0,s.useParams)(),n=u.subjectId,t=u.tab,r=t===void 0?"groups":t;return(0,e.jsx)(Ke.p,{semester_subject_id:Number(n),children:(0,e.jsx)(Ar,{tab:r})})}},76841:function(_t,et,o){o.d(et,{Gm:function(){return C},Sx:function(){return f},_g:function(){return s}});var He=o(15009),c=o.n(He),Ye=o(97857),I=o.n(Ye),ye=o(99289),A=o.n(ye),he=o(80854);function C(i,j){return v.apply(this,arguments)}function v(){return v=A()(c()().mark(function i(j,Z){return c()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",(0,he.request)("/api/admin/reports/report",I()({params:j,method:"GET",useCache:!1},Z||{})));case 1:case"end":return E.stop()}},i)})),v.apply(this,arguments)}function s(i,j,Z){return le.apply(this,arguments)}function le(){return le=A()(c()().mark(function i(j,Z,se){return c()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.abrupt("return",(0,he.request)("/api/admin/stats/course/".concat(j,"/export"),I()({params:Z,method:"GET",useCache:!1,responseType:"blob",headers:{accept:"application/vnd.ms-excel"}},se||{})));case 1:case"end":return Q.stop()}},i)})),le.apply(this,arguments)}function f(i,j,Z){return P.apply(this,arguments)}function P(){return P=A()(c()().mark(function i(j,Z,se){return c()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.abrupt("return",(0,he.request)("/api/admin/stats/topic/".concat(j,"/export"),I()({method:"GET",useCache:!1,params:{stat:Z},responseType:"blob",headers:{accept:"application/vnd.ms-excel"}},se||{})));case 1:case"end":return Q.stop()}},i)})),P.apply(this,arguments)}},70804:function(_t,et,o){var He=o(67294);var c=function(le,f){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,i){P.__proto__=i}||function(P,i){for(var j in i)i.hasOwnProperty(j)&&(P[j]=i[j])})(le,f)},Ye,I,ye=(function(le){(function(){var f={}.hasOwnProperty;function P(){for(var i=[],j=0;j<arguments.length;j++){var Z=arguments[j];if(Z){var se=typeof Z;if(se==="string"||se==="number")i.push(Z);else if(Array.isArray(Z)&&Z.length){var E=P.apply(null,Z);E&&i.push(E)}else if(se==="object")for(var Q in Z)f.call(Z,Q)&&Z[Q]&&i.push(Q)}}return i.join(" ")}le.exports?(P.default=P,le.exports=P):window.classNames=P})()}(I={path:Ye,exports:{},require:function(le,f){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(f==null&&I.path)}},I.exports),I.exports);function A(le,f,P){var i,j,Z,se,E;function Q(){var Ae=Date.now()-se;Ae<f&&Ae>=0?i=setTimeout(Q,f-Ae):(i=null,P||(E=le.apply(Z,j),Z=j=null))}f==null&&(f=100);var ue=function(){Z=this,j=arguments,se=Date.now();var Ae=P&&!i;return i||(i=setTimeout(Q,f)),Ae&&(E=le.apply(Z,j),Z=j=null),E};return ue.clear=function(){i&&(clearTimeout(i),i=null)},ue.flush=function(){i&&(E=le.apply(Z,j),Z=j=null,clearTimeout(i),i=null)},ue}A.debounce=A;var he=A;(function(le,f){f===void 0&&(f={});var P=f.insertAt;if(le&&typeof document!="undefined"){var i=document.head||document.getElementsByTagName("head")[0],j=document.createElement("style");j.type="text/css",P==="top"&&i.firstChild?i.insertBefore(j,i.firstChild):i.appendChild(j),j.styleSheet?j.styleSheet.cssText=le:j.appendChild(document.createTextNode(le))}})(`.indiana-scroll-container {
  overflow: auto; }
  .indiana-scroll-container--dragging {
    scroll-behavior: auto !important; }
    .indiana-scroll-container--dragging > * {
      pointer-events: none;
      cursor: -webkit-grab;
      cursor: grab; }
  .indiana-scroll-container--hide-scrollbars {
    overflow: hidden;
    overflow: -moz-scrollbars-none;
    -ms-overflow-style: none;
    scrollbar-width: none; }
    .indiana-scroll-container--hide-scrollbars::-webkit-scrollbar {
      display: none !important;
      height: 0 !important;
      width: 0 !important;
      background: transparent !important;
      -webkit-appearance: none !important; }
  .indiana-scroll-container--native-scroll {
    overflow: auto; }

.indiana-dragging {
  cursor: -webkit-grab;
  cursor: grab; }
`);var C,v=(C="indiana-scroll-container",function(le,f){if(!le)return C;var P;typeof le=="string"?P=le:f=le;var i=C;return P&&(i+="__"+P),i+(f?Object.keys(f).reduce(function(j,Z){var se=f[Z];return se&&(j+=" "+(typeof se=="boolean"?i+"--"+Z:i+"--"+Z+"_"+se)),j},""):"")}),s=function(le){function f(P){var i=le.call(this,P)||this;return i.onEndScroll=function(){i.scrolling=!1,!i.pressed&&i.started&&i.processEnd()},i.onScroll=function(j){var Z=i.container.current;Z.scrollLeft===i.scrollLeft&&Z.scrollTop===i.scrollTop||(i.scrolling=!0,i.processScroll(j),i.onEndScroll())},i.onTouchStart=function(j){var Z=i.props.nativeMobileScroll;if(i.isDraggable(j.target))if(i.internal=!0,Z&&i.scrolling)i.pressed=!0;else{var se=j.touches[0];i.processClick(j,se.clientX,se.clientY),!Z&&i.props.stopPropagation&&j.stopPropagation()}},i.onTouchEnd=function(j){var Z=i.props.nativeMobileScroll;i.pressed&&(!i.started||i.scrolling&&Z?i.pressed=!1:i.processEnd(),i.forceUpdate())},i.onTouchMove=function(j){var Z=i.props.nativeMobileScroll;if(i.pressed&&(!Z||!i.isMobile)){var se=j.touches[0];se&&i.processMove(j,se.clientX,se.clientY),j.preventDefault(),i.props.stopPropagation&&j.stopPropagation()}},i.onMouseDown=function(j){i.isDraggable(j.target)&&i.isScrollable()&&(i.internal=!0,i.props.buttons.indexOf(j.button)!==-1&&(i.processClick(j,j.clientX,j.clientY),j.preventDefault(),i.props.stopPropagation&&j.stopPropagation()))},i.onMouseMove=function(j){i.pressed&&(i.processMove(j,j.clientX,j.clientY),j.preventDefault(),i.props.stopPropagation&&j.stopPropagation())},i.onMouseUp=function(j){i.pressed&&(i.started?i.processEnd():(i.internal=!1,i.pressed=!1,i.forceUpdate(),i.props.onClick&&i.props.onClick(j)),j.preventDefault(),i.props.stopPropagation&&j.stopPropagation())},i.container=He.createRef(),i.onEndScroll=he(i.onEndScroll,300),i.scrolling=!1,i.started=!1,i.pressed=!1,i.internal=!1,i.getRef=i.getRef.bind(i),i}return function(P,i){function j(){this.constructor=P}c(P,i),P.prototype=i===null?Object.create(i):(j.prototype=i.prototype,new j)}(f,le),f.prototype.componentDidMount=function(){var P=this.props.nativeMobileScroll,i=this.container.current;window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!1}),window.addEventListener("touchend",this.onTouchEnd),i.addEventListener("touchstart",this.onTouchStart,{passive:!1}),i.addEventListener("mousedown",this.onMouseDown,{passive:!1}),P&&(this.isMobile=this.isMobileDevice(),this.isMobile&&this.forceUpdate())},f.prototype.componentWillUnmount=function(){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd)},f.prototype.getElement=function(){return this.container.current},f.prototype.isMobileDevice=function(){return window.orientation!==void 0||navigator.userAgent.indexOf("IEMobile")!==-1},f.prototype.isDraggable=function(P){var i=this.props.ignoreElements;if(i){var j=P.closest(i);return j===null||j.contains(this.getElement())}return!0},f.prototype.isScrollable=function(){var P=this.container.current;return P&&(P.scrollWidth>P.clientWidth||P.scrollHeight>P.clientHeight)},f.prototype.processClick=function(P,i,j){var Z=this.container.current;this.scrollLeft=Z.scrollLeft,this.scrollTop=Z.scrollTop,this.clientX=i,this.clientY=j,this.pressed=!0},f.prototype.processStart=function(P){P===void 0&&(P=!0);var i=this.props.onStartScroll;this.started=!0,P&&document.body.classList.add("indiana-dragging"),i&&i({external:!this.internal}),this.forceUpdate()},f.prototype.processScroll=function(P){if(this.started){var i=this.props.onScroll;i&&i({external:!this.internal})}else this.processStart(!1)},f.prototype.processMove=function(P,i,j){var Z=this.props,se=Z.horizontal,E=Z.vertical,Q=Z.activationDistance,ue=Z.onScroll,Ae=this.container.current;this.started?(se&&(Ae.scrollLeft-=i-this.clientX),E&&(Ae.scrollTop-=j-this.clientY),ue&&ue({external:!this.internal}),this.clientX=i,this.clientY=j,this.scrollLeft=Ae.scrollLeft,this.scrollTop=Ae.scrollTop):(se&&Math.abs(i-this.clientX)>Q||E&&Math.abs(j-this.clientY)>Q)&&(this.clientX=i,this.clientY=j,this.processStart())},f.prototype.processEnd=function(){var P=this.props.onEndScroll;this.container.current&&P&&P({external:!this.internal}),this.pressed=!1,this.started=!1,this.scrolling=!1,this.internal=!1,document.body.classList.remove("indiana-dragging"),this.forceUpdate()},f.prototype.getRef=function(P){[this.container,this.props.innerRef].forEach(function(i){i&&(typeof i=="function"?i(P):i.current=P)})},f.prototype.render=function(){var P=this.props,i=P.children,j=P.draggingClassName,Z=P.className,se=P.style,E=P.hideScrollbars,Q=P.component;return He.createElement(Q,{className:ye(Z,this.pressed&&j,v({dragging:this.pressed,"hide-scrollbars":E,"native-scroll":this.isMobile})),style:se,ref:this.getRef,onScroll:this.onScroll},i)},f.defaultProps={nativeMobileScroll:!0,hideScrollbars:!0,activationDistance:10,vertical:!0,horizontal:!0,stopPropagation:!1,style:{},component:"div",buttons:[0]},f}(He.PureComponent);et.Z=s}}]);
