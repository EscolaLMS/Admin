(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{"/y+f":function(fe,h,t){"use strict";t.d(h,"g",function(){return g}),t.d(h,"e",function(){return R}),t.d(h,"f",function(){return ue}),t.d(h,"d",function(){return de}),t.d(h,"a",function(){return Y}),t.d(h,"c",function(){return je}),t.d(h,"b",function(){return _});var g;(function(a){a.Unselected="",a.RichText="EscolaLms\\TopicTypes\\Models\\TopicContent\\RichText",a.OEmbed="EscolaLms\\TopicTypes\\Models\\TopicContent\\OEmbed",a.Audio="EscolaLms\\TopicTypes\\Models\\TopicContent\\Audio",a.Video="EscolaLms\\TopicTypes\\Models\\TopicContent\\Video",a.H5P="EscolaLms\\TopicTypes\\Models\\TopicContent\\H5P",a.Image="EscolaLms\\TopicTypes\\Models\\TopicContent\\Image",a.PDF="EscolaLms\\TopicTypes\\Models\\TopicContent\\PDF",a.SCORM="EscolaLms\\TopicTypes\\Models\\TopicContent\\ScormSco",a.Project="EscolaLms\\TopicTypeProject\\Models\\Project",a.GiftQuiz="EscolaLms\\TopicTypeGift\\Models\\GiftQuiz"})(g||(g={}));var M;(function(a){a.OrderPaid="EscolaLms\\Cart\\Events\\OrderPaid",a.UserLogged="EscolaLms\\Auth\\Events\\UserLogged"})(M||(M={}));var H;(function(a){a.draft="draft",a.published="published",a.archived="archived"})(H||(H={}));var R;(function(a){a.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",a.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",a.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel"})(R||(R={}));var ue;(function(a){a.ManuallyTriggeredEvent="EscolaLms\\Templates\\Events\\ManuallyTriggeredEvent"})(ue||(ue={}));var q;(function(a){a.cart_fixed="cart_fixed",a.cart_percent="cart_percent",a.product_fixed="product_fixed",a.product_percent="product_percent"})(q||(q={}));var de;(function(a){a.MULTIPLE_CHOICE="multiple_choice",a.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS="multiple_choice_with_multiple_right_answers",a.TRUE_FALSE="true_false",a.SHORT_ANSWERS="short_answers",a.MATCHING="matching",a.NUMERICAL_QUESTION="numerical_question",a.ESSAY="essay",a.DESCRIPTION="description"})(de||(de={}));var Y;(function(a){a.PRESENT="present",a.PRESENT_NOT_EXERCISING="present_not_exercising",a.ABSENT="absent",a.EXCUSED_ABSENCE="excused_absence"})(Y||(Y={}));var je;(function(a){a.Manual="manual",a.TeamsForms="teams_forms",a.TeamsLecture="teams_lecture",a.TestPortal="test_portal"})(je||(je={}));var _;(function(a){a.Simple="simple",a.Complex="complex"})(_||(_={}))},"B0O/":function(fe,h,t){"use strict";var g=t("Mwp2"),M=t("VXEj"),H=t("+L6B"),R=t("2/Rp"),ue=t("tU7J"),q=t("wFql"),de=t("/zsF"),Y=t("PArb"),je=t("T2oS"),_=t("W9HT"),a=t("fOrg"),X=t("+KLJ"),G=t("tJVT"),L=t("q1tI"),O=t("9kvl"),E=t("qLMh"),V=t("k1fw"),se=t("9og8");function xe(Z,U){return ae.apply(this,arguments)}function ae(){return ae=Object(se.a)(Object(E.a)().mark(function Z(U,w){return Object(E.a)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",Object(O.i)("/api/admin/pdfs",Object(V.a)({params:Object(V.a)({},U),method:"GET"},w||{})));case 1:case"end":return C.stop()}},Z)})),ae.apply(this,arguments)}function f(Z,U){return B.apply(this,arguments)}function B(){return B=Object(se.a)(Object(E.a)().mark(function Z(U,w){return Object(E.a)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",Object(O.i)("/api/pdfs/".concat(U),Object(V.a)({method:"GET"},w||{})));case 1:case"end":return C.stop()}},Z)})),B.apply(this,arguments)}function o(Z,U){return j.apply(this,arguments)}function j(){return j=Object(se.a)(Object(E.a)().mark(function Z(U,w){return Object(E.a)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",Object(O.i)("/api/pdfs/generate/".concat(U),Object(V.a)({method:"GET"},w||{})));case 1:case"end":return C.stop()}},Z)})),j.apply(this,arguments)}var x=t("oBTY"),I=t("Iab2"),m=t("xOOu"),y=t.n(m),S=t("nKUr"),Fe=function(U){var w=U.pdfIds,ie=U.onProgress,C=U.onFinished,he=U.filename,me=he===void 0?"package.zip":he,le=Object(L.useState)([]),re=Object(G.a)(le,2),pe=re[0],ge=re[1],Te=Object(L.useCallback)(function(ce){var oe=new y.a;ce.forEach(function(W,ne){return oe.file("".concat(w[ne],".pdf"),W)}),oe.generateAsync({type:"blob"}).then(function(W){Object(I.saveAs)(W,me),C&&C()})},[pe,me]);return Object(L.useEffect)(function(){w.forEach(function(ce){var oe=fetch("".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/pdfs/generate/").concat(ce),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}});oe.then(function(W){return W.blob()}).then(function(W){W&&W instanceof Blob&&ge(function(ne){var Oe=(ne.length+1)/w.length;return ie&&ie(Oe),Oe>=1&&Te([].concat(Object(x.a)(ne),[W])),[].concat(Object(x.a)(ne),[W])})})})},[w]),Object(S.jsxs)("p",{children:["Progress ",pe.length," / ",w.length]})},ye=Fe,Me=t("Vpfc"),be=t("dF/Y"),u=t("39sE"),e=function(U){var w=U.user_id,ie=U.template_id,C=U.title,he=Object(L.useState)({state:"initial"}),me=Object(G.a)(he,2),le=me[0],re=me[1],pe=Object(L.useState)({state:"initial"}),ge=Object(G.a)(pe,2),Te=ge[0],ce=ge[1],oe=Object(L.useState)(!1),W=Object(G.a)(oe,2),ne=W[0],Oe=W[1];Object(L.useEffect)(function(){re({state:"loading"});var ee=new AbortController;return xe({user_id:w,template_id:ie},{signal:ee.signal}).then(function(N){N&&N.success?re({state:"loaded",list:N.data}):N&&!N.success&&re({state:"error",error:N.message})}).catch(function(N){return re({state:"error",error:N.toString()})}),function(){ee.abort()}},[]);var Pe=Object(L.useCallback)(function(ee){ce({state:"loading"}),f(ee).then(function(N){N.success?ce({state:"loaded",data:N.data.content}):ce({state:"initial"})})},[]);return le.state==="error"?Object(S.jsx)(X.a,{message:"Error Text",type:"error"}):le.state==="loading"||le.state==="initial"?Object(S.jsx)(_.a,{}):Object(S.jsxs)(L.Fragment,{children:[Object(S.jsx)(Y.a,{}),ne&&Object(S.jsx)(ye,{pdfIds:le.list.map(function(ee){return ee.id}),onFinished:function(){return Oe(!1)}}),Object(S.jsx)(M.b,{size:"small",itemLayout:"horizontal",dataSource:le.list,header:Object(S.jsxs)("div",{children:[Object(S.jsx)(O.a,{id:"template"})," ",C&&Object(S.jsx)(q.a.Text,{strong:!0,children:C}),". ",Object(S.jsx)(O.a,{id:"generated_pdfs",defaultMessage:"Generated PDFs"})," ",Object(S.jsx)(R.a,{loading:ne,type:"primary",onClick:function(){return Oe(!0)},icon:Object(S.jsx)(be.a,{}),size:"small",children:Object(S.jsx)(O.a,{id:"download_all",defaultMessage:"Download all PDFs"})})]}),renderItem:function(N){return Object(S.jsxs)(M.b.Item,{actions:[Object(S.jsx)(u.a,{url:"/api/pdfs/generate/".concat(N.id),filename:"generated-".concat(N.id,".pdf"),size:"small",icon:Object(S.jsx)(be.a,{}),type:"primary",onClick:function(){return Pe(N.id)},loading:Te.state==="loading",children:Object(S.jsx)(O.a,{id:"download_pdf",defaultMessage:"Download PDFs"})},"download")],children:[N.title," ",Object(S.jsx)(Me.a,{type:"App\\Models\\User",type_id:N.user_id})]})}})]})},Ae=h.a=e},BOG6:function(fe,h,t){"use strict";t.r(h);var g=t("DYRE"),M=t("zeV3"),H=t("tU7J"),R=t("wFql"),ue=t("+BJd"),q=t("mr32"),de=t("/zsF"),Y=t("PArb"),je=t("T2oS"),_=t("W9HT"),a=t("miYZ"),X=t("tsqr"),G=t("qLMh"),L=t("9og8"),O=t("k1fw"),E=t("jrin"),V=t("tJVT"),se=t("oBTY"),xe=t("fu2T"),ae=t("gK9i"),f=t("q1tI"),B=t.n(f),o=t("VMEa"),j=t("Qurx"),x=t("yj/a"),I=t("tneF"),m=t("nhC9"),y=t("rWUb"),S=t("tMyG"),Fe=t("fOrg"),ye=t("+KLJ"),Me=t("+L6B"),be=t("2/Rp"),u=t("9kvl"),e=t("nKUr"),Ae=function(l){var r=l.disabled,n=r===void 0?!1:r,b=l.id,D=l.onPreviewData,P=Object(f.useState)({state:"ready"}),p=Object(V.a)(P,2),d=p[0],i=p[1],c=Object(f.useCallback)(function(){i({state:"loading"}),Object(y.c)(b).then(function(s){s.success?(D&&D(s.data),s.data.sent&&s.data.to?i({state:"loaded",data:s.data,message:"email sent to ".concat(s.data.to)}):s.data.url?i({state:"loaded",data:s.data,message:Object(e.jsxs)(B.a.Fragment,{children:[Object(e.jsx)(u.a,{id:"download"})," ",Object(e.jsx)("a",{target:"_blank",href:s.data.url,rel:"noreferrer",children:s.data.filename})]})}):i({state:"loaded",data:s.data,message:s.message})):i({state:"error",error:s.message})}).catch(function(){i({state:"error",error:"error"})})},[b]);return Object(e.jsxs)(B.a.Fragment,{children:[Object(e.jsx)(be.a,{type:"primary",loading:d.state==="loading",disabled:n,onClick:c,children:Object(e.jsx)(u.a,{id:"preview"})}),d.state==="loaded"&&Object(e.jsx)(ye.a,{message:d.message,type:"success",closable:!0,onClose:function(){return i({state:"ready"})}}),d.state==="error"&&Object(e.jsx)(ye.a,{message:d.error,type:"error",closable:!0,onClose:function(){return i({state:"ready"})}})]})},Z=Ae,U=t("Ty5D"),w=t("BiO0"),ie=t("PGov"),C=t("D6/r"),he=t("wbUo"),me=function(l){return Object(e.jsxs)("div",{className:"".concat(l.entity.required&&"required"),children:["@","".concat(l.entity.name)]})},le=function(l){var r=l.requiredVariables,n=l.variables,b=l.onChange,D=l.value,P=l.error,p=l.styles,d=n.map(function(i){return{name:i.substring(1),required:r.includes(i)}});return Object(e.jsxs)(B.a.Fragment,{children:[Object(e.jsx)(ie.a,{style:p,className:"ant-input pro-field pro-field-lg rta__textarea_wide ".concat(P.length&&"error"),onChange:function(c){return b(c.target.value)},loadingComponent:function(){return Object(e.jsx)(u.a,{id:"loading"})},minChar:0,value:D,itemStyle:{fontSize:"16px"},trigger:{"@":{dataProvider:function(c){return d.filter(function(s){return s.name.startsWith(c)})},component:me,output:function(c,s){return"".concat(s).concat(c.name)}}}}),Object(e.jsx)("div",{role:"alert",className:"ant-form-item-explain-error",children:P})]})},re=le,pe=t("UF3W"),ge=t("bXNp"),Te=t("ctOJ"),ce=function(l){switch(l.toLocaleLowerCase()){case"varusername":return"John Doe";case"varcoursetitle":return"How to be an LMS Expert";case"varappname":return"Wellms Headless LMS";default:return"Lorem Ipsum"}},oe=function(l,r,n){var b=Math.max.apply(null,l.parameters?[l.parameters.map(function(p){return p.id}),l.docElements.map(function(p){return p.id})].flat():[1])+1,D=l.parameters?l.parameters.reduce(function(p,d){return Object(O.a)(Object(O.a)({},p),{},Object(E.a)({},d.name,d))},{}):{},P=r.map(function(p){return p.replace("@","")}).reduce(function(p,d,i){return p[d]?Object(O.a)(Object(O.a)({},p),{},Object(E.a)({},d,Object(O.a)(Object(O.a)({},p[d]),{},{id:b+i}))):Object(O.a)(Object(O.a)({},p),{},Object(E.a)({},d,{id:b+i,name:d,type:"string",arrayItemType:"string",eval:!1,nullable:!n.includes(d),pattern:"",expression:"",showOnlyNameType:!1,testData:ce(d)}))},D);return Object.assign({},l,{parameters:Object.values(P)})},W=function(l){var r=l.onTemplateSaved,n=l.reportBroTemplate,b=n===void 0?null:n,D=l.field,P=l.variables,p=l.onTemplateUpdated,d=Object(f.useRef)(null),i=function(s){var F=s.nativeEvent.target.tagName.toLowerCase();switch(F){case"span":case"button":s.nativeEvent.stopPropagation(),s.nativeEvent.preventDefault();default:return}};return Object(f.useEffect)(function(){if(d.current){var c=new pe.ReportBro(d.current,{enableSpreadsheet:!1,fonts:[{name:"Open Sans",value:"Open Sans"}],defaultFont:"Open Sans",reportServerUrl:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/pdfs/reportbro/report/run"),saveCallback:function(){r(c.getReport())},cmdExecutedCallback:function(){p&&p(c.getReport())}});b&&c.load(oe(b,P,D.required_variables))}},[d]),Object(e.jsx)("div",{ref:d,className:"pdf-editor",onClick:i,children:"pdf editor"})},ne=W,Oe=t("JAl+"),Pe=function(l){var r=l.name,n=l.field,b=l.variables,D=b===void 0?[]:b,P=Object(f.useCallback)(function(i){if(i.length)return Object(e.jsx)(M.b,{children:Object(e.jsxs)(R.a,{children:[Object(e.jsx)(u.a,{id:"templates.required_variables"}),":"," ",i.map(function(c){return Object(e.jsx)(q.a,{color:"red",children:c},c)})]})})},[n,r]),p=Object(f.useCallback)(function(i,c){return i&&c.every(function(s){return i.includes(s)})?Promise.resolve():Promise.reject(new Error("No required variable used"))},[n,r]),d=Object(f.useCallback)(function(){if(!n.readonly)switch(n.type){case"text":case"url":return Object(e.jsxs)(B.a.Fragment,{children:[Object(e.jsx)("label",{children:Object(e.jsx)(u.a,{id:r})}),Object(e.jsx)(o.a.Item,{shouldUpdate:!0,children:function(c){return Object(e.jsx)(re,{requiredVariables:n.required_variables,variables:D,value:c.getFieldValue(r),onChange:function(F){return c.setFieldsValue(Object(E.a)({},r,F))},error:c.getFieldError(r),styles:{width:"100%",height:"100px"}})}}),Object(e.jsx)(j.a,{name:r,shouldUpdate:!0,hidden:!0,rules:n.readonly?void 0:[{required:n.required,message:Object(e.jsx)(u.a,{id:"templates.this_required"})},{validator:function(){var i=Object(L.a)(Object(G.a)().mark(function s(F,T){return Object(G.a)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.abrupt("return",p(T,n.required_variables));case 1:case"end":return z.stop()}},s)}));function c(s,F){return i.apply(this,arguments)}return c}()}]}),P(n.required_variables)]});case"fabric.js":return Object(e.jsxs)(B.a.Fragment,{children:[Object(e.jsx)(o.a.Item,{shouldUpdate:!0,children:function(c){return Object(e.jsx)(ne,{reportBroTemplate:c.getFieldValue(r)&&JSON.parse(c.getFieldValue(r)),variables:D,field:n,onTemplateSaved:function(F){c.setFieldsValue(Object(E.a)({},r,JSON.stringify(F))),c.submit()},onTemplateUpdated:function(F){c.setFieldsValue(Object(E.a)({},r,JSON.stringify(F)))}})}}),Object(e.jsx)(w.a,{name:r,shouldUpdate:!0,width:"lg",hidden:!0})]});case"html":return Object(e.jsxs)(B.a.Fragment,{children:[Object(e.jsx)(w.a,{readonly:n.readonly,shouldUpdate:!0,width:"lg",label:Object(e.jsx)(u.a,{id:r}),name:r,tooltip:Object(e.jsx)(u.a,{id:"templates.html_tooltip"}),rules:n.readonly?void 0:[{required:n.required,message:Object(e.jsx)(u.a,{id:"templates.this_required"})},{validator:function(){var i=Object(L.a)(Object(G.a)().mark(function s(F,T){return Object(G.a)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.abrupt("return",p(T,n.required_variables));case 1:case"end":return z.stop()}},s)}));function c(s,F){return i.apply(this,arguments)}return c}()}]}),P(n.required_variables)]});case"mjml":return Object(e.jsxs)(B.a.Fragment,{children:[Object(e.jsxs)("p",{children:[Object(e.jsx)(u.a,{id:"templates.to_create_template"})," ",Object(e.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://mjml.io/try-it-live",children:"https://mjml.io/try-it-live"})]}),Object(e.jsx)("code",{children:Object(e.jsx)(u.a,{id:"code.snippet"})}),Object(e.jsx)(o.a.Item,{shouldUpdate:!0,children:function(c){return Object(e.jsx)(re,{requiredVariables:n.required_variables,variables:D,value:c.getFieldValue(r),onChange:function(F){return c.setFieldsValue(Object(E.a)({},r,F))},error:c.getFieldError(r),styles:{width:"100%",height:"40vh"}})}}),Object(e.jsx)(w.a,{name:r,shouldUpdate:!0,hidden:!0,rules:n.readonly?void 0:[{required:n.required,message:Object(e.jsx)(u.a,{id:"templates.this_required"})},{validator:function(){var i=Object(L.a)(Object(G.a)().mark(function s(F,T){return Object(G.a)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.abrupt("return",p(T,n.required_variables));case 1:case"end":return z.stop()}},s)}));function c(s,F){return i.apply(this,arguments)}return c}()}]}),P(n.required_variables)]});default:return}},[n,r,D]);return Object(e.jsx)(B.a.Fragment,{children:d()})},ee=Pe,N=t("B0O/"),Ee=t("/y+f"),rt=t("5Dmo"),Le=t("3S7+"),Be=t("0WSk"),$e=function(l){var r=l.templateId,n=Object(f.useState)(!1),b=Object(V.a)(n,2),D=b[0],P=b[1],p=Object(f.useState)([]),d=Object(V.a)(p,2),i=d[0],c=d[1],s=Object(u.l)(),F=Object(f.useCallback)(function(){P(!0),Object(y.f)(Number(r),i).then(function(T){T.success?X.b.success(T.message):X.b.error(T.message)}).catch(function(T){return X.b.error(T.toString())}).finally(function(){return P(!1)})},[i,r]);return Object(e.jsxs)(M.b,{children:[Object(e.jsx)(Be.a,{multiple:!0,value:i,onChange:function($){return c($)}}),Object(e.jsx)(Le.a,{title:s.formatMessage({id:"generate_pdf_users_tooltip"}),children:Object(e.jsx)(be.a,{loading:D,onClick:function(){return F()},disabled:!i.length,children:Object(e.jsx)(u.a,{id:"generate"})})})]})},Ge=$e,we=t("qSko"),ze=function(l){var r=l.templateId,n=Object(f.useState)(!1),b=Object(V.a)(n,2),D=b[0],P=b[1],p=Object(f.useState)(),d=Object(V.a)(p,2),i=d[0],c=d[1],s=Object(u.l)(),F=Object(f.useCallback)(function(){P(!0),typeof i=="number"&&Object(y.g)(Number(r),Number(i)).then(function(T){T.success?X.b.success(T.message):X.b.error(T.message)}).catch(function(T){return X.b.error(T.toString())}).finally(function(){return P(!1)})},[i,r]);return Object(e.jsxs)(M.b,{children:[Object(e.jsx)(we.a,{multiple:!1,value:i,onChange:function($){return c($)}}),Object(e.jsx)(Le.a,{title:s.formatMessage({id:"generate_pdf_products_tooltip"}),children:Object(e.jsx)(be.a,{loading:D,onClick:function(){return F()},disabled:!i,children:Object(e.jsx)(u.a,{id:"generate"})})})]})},Je=ze,We=ae.a.Panel,Ke=function(l){return Object.entries(l).map(function(r){return{key:r[0],content:r[1]}})},Ie=function(l){return Object.assign.apply(Object,[{}].concat(Object(se.a)(l)))},He=function(l){var r=["name","event","default"];return Object.keys(l).filter(function(n){return!r.includes(n)}).reduce(function(n,b){return n[b]=l[b],n},{})},Se=Ee.e,nt=h.default=function(){var K=Object(u.l)(),l=Object(U.l)(),r=l.template,n=l.id,b=n==="new",D=Object(f.useState)(!1),P=Object(V.a)(D,2),p=P[0],d=P[1],i=o.a.useForm(),c=Object(V.a)(i,1),s=c[0],F=Object(f.useState)(),T=Object(V.a)(F,2),$=T[0],z=T[1],Ye=Object(f.useState)(void 0),Ue=Object(V.a)(Ye,2),Q=Ue[0],Xe=Ue[1],Ze=Object(f.useState)(),Ne=Object(V.a)(Ze,2),Qe=Ne[0],ke=Ne[1],qe=Object(f.useState)(!1),De=Object(V.a)(qe,2),Re=De[0],_e=De[1];Object(f.useEffect)(function(){Object(y.i)().then(function(A){z(A.success?A.data:{})})},[]),Object(f.useEffect)(function(){var A=s.getFieldsValue(),v=Q&&Object.keys(Q.sections).map(function(J){return Object(E.a)({},J,Q.sections[J].default_content)});v&&b&&s.setFieldsValue(Object(O.a)(Object(O.a)({},A),Ie(v)))},[Q]);var Ve=Object(f.useCallback)(function(A){if(A&&r){var v=$&&$[A][Se[r]];Xe(v)}_e(A===Ee.f.ManuallyTriggeredEvent)},[$,n]),et=Object(f.useCallback)(Object(L.a)(Object(G.a)().mark(function A(){var v,J,te;return Object(G.a)().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return ve.next=2,Object(y.d)(Number(n));case 2:v=ve.sent,v.success&&(J=v.data.sections&&v.data.sections.map(function(k){return Object(E.a)({},k.key,k.content)}),te=J&&Ie(J),s.setFieldsValue(Object(O.a)(Object(O.a)({},v.data),te)),Ve(String(v.data.event)),d(!0));case 4:case"end":return ve.stop()}},A)})),[n,$]),tt=Object(f.useCallback)(function(){var A=Object(L.a)(Object(G.a)().mark(function v(J){var te,Ce;return Object(G.a)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(Ce=Object(O.a)(Object(O.a)({},J),{},{channel:Se[r],sections:Ke(He(J))}),!b){k.next=8;break}return k.next=4,Object(y.a)(Ce);case 4:te=k.sent,te.success&&u.f.push("/configuration/templates/".concat(r,"/").concat(te.data.id)),k.next=11;break;case 8:return k.next=10,Object(y.h)(Number(n),Ce);case 10:te=k.sent;case 11:d(!0),X.b.success(te.message);case 13:case"end":return k.stop()}},v)}));return function(v){return A.apply(this,arguments)}}(),[$,n]);Object(f.useEffect)(function(){b||et()},[n,$]);var at=Object(f.useCallback)(function(A){return $?Object.keys($).reduce(function(v,J){return $[J][A]?Object(O.a)(Object(O.a)({},v),{},Object(E.a)({},J,K.formatMessage({id:J,defaultMessage:J}))):v},{}):{}},[$]);return Object(e.jsxs)(S.a,{title:b?Object(e.jsxs)("span",{children:[Object(e.jsx)(u.a,{id:"new"})," ",r," ",Object(e.jsx)(u.a,{id:"template"})]}):Object(e.jsxs)("span",{children:[Object(e.jsx)(u.a,{id:"edit"})," ",r," ",Object(e.jsx)(u.a,{id:"template"})]}),children:[Object(e.jsx)(m.a,{size:"small",children:Object(e.jsxs)(o.a,{initialValues:{},onFinish:tt,form:s,onValuesChange:function(){var v=s.getFieldsValue();Ve(v.event),d(!1)},children:[Object(e.jsxs)(o.a.Group,{children:[Object(e.jsx)(j.a,{width:"sm",name:"name",label:Object(e.jsx)(u.a,{id:"name"}),placeholder:K.formatMessage({id:"name"}),rules:[{required:!0,message:Object(e.jsx)(u.a,{id:"select"})}]}),Object(e.jsx)(x.a,{name:"event",width:"lg",label:Object(e.jsx)(u.a,{id:"event"}),valueEnum:$?at(Se[r]):{},placeholder:K.formatMessage({id:"event"}),rules:[{required:!0,message:Object(e.jsx)(u.a,{id:"select"})}]}),Object(e.jsx)(o.a.Item,{label:Object(e.jsx)(u.a,{id:"templates.set_as_default_template"}),children:Object(e.jsx)(I.a,{name:"default"})})]}),!b&&r!=="pdf"&&Object(e.jsxs)(o.a.Group,{children:[Object(e.jsx)(o.a.Item,{label:Object(e.jsx)(u.a,{id:"preview"}),children:Object(e.jsx)(Z,{disabled:!p,id:Number(n),type:r,onPreviewData:function(v){v&&v.data&&v.data.content&&ke(v.data.content)}})}),Re&&Object(e.jsx)(o.a.Item,{label:Object(e.jsx)(u.a,{id:"generate_pdf"}),tooltip:Object(e.jsx)(u.a,{id:"generate_pdf_tooltip"}),children:Object(e.jsx)(Ge,{templateId:Number(n)})}),Re&&Object(e.jsx)(o.a.Item,{label:Object(e.jsx)(u.a,{id:"generate_pdf"}),tooltip:Object(e.jsx)(u.a,{id:"generate_pdf_tooltip"}),children:Object(e.jsx)(Je,{templateId:Number(n)})})]}),Se[r]===Ee.e.pdf&&!b&&Object(e.jsx)(ae.a,{ghost:!0,destroyInactivePanel:!0,defaultActiveKey:[-1],children:Object(e.jsx)(We,{header:Object(e.jsx)(u.a,{id:"generated_pdfs"}),children:Object(e.jsx)(N.a,{template_id:Number(n)})},0)}),!Q&&!b?Object(e.jsx)(_.a,{}):Q&&Q.sections&&Object.keys(Q.sections).map(function(A,v){var J=Q.sections&&Q.sections[A];return Object(e.jsxs)(B.a.Fragment,{children:[v===0&&r!=="pdf"&&Object(e.jsxs)(B.a.Fragment,{children:[Object(e.jsx)(Y.a,{children:Object(e.jsx)(u.a,{id:"templates.tokens"})}),Object(e.jsx)(M.b,{children:Object(e.jsx)(R.a,{children:Q.variables.map(function(te){return Object(e.jsx)(q.a,{color:"orange",children:te},te)})})})]}),Object(e.jsx)(Y.a,{}),Object(e.jsx)(ee,{name:A,field:J,variables:Q.variables})]},A)}),Object(e.jsx)(Y.a,{})]})}),Qe&&Object(e.jsx)("p",{children:"fabric preview"})]})}},"JAl+":function(fe,h,t){},ctOJ:function(fe,h,t){},rWUb:function(fe,h,t){"use strict";t.d(h,"e",function(){return ue}),t.d(h,"d",function(){return de}),t.d(h,"a",function(){return je}),t.d(h,"h",function(){return a}),t.d(h,"b",function(){return G}),t.d(h,"i",function(){return O}),t.d(h,"c",function(){return V}),t.d(h,"f",function(){return xe}),t.d(h,"g",function(){return f});var g=t("qLMh"),M=t("k1fw"),H=t("9og8"),R=t("9kvl");function ue(o,j){return q.apply(this,arguments)}function q(){return q=Object(H.a)(Object(g.a)().mark(function o(j,x){return Object(g.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(R.i)("/api/admin/templates",Object(M.a)({method:"GET",useCache:!1,params:j},x||{})));case 1:case"end":return m.stop()}},o)})),q.apply(this,arguments)}function de(o,j){return Y.apply(this,arguments)}function Y(){return Y=Object(H.a)(Object(g.a)().mark(function o(j,x){return Object(g.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(R.i)("/api/admin/templates/".concat(j),Object(M.a)({method:"GET"},x||{})));case 1:case"end":return m.stop()}},o)})),Y.apply(this,arguments)}function je(o,j){return _.apply(this,arguments)}function _(){return _=Object(H.a)(Object(g.a)().mark(function o(j,x){return Object(g.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(R.i)("/api/admin/templates",Object(M.a)({method:"POST",headers:{"Content-Type":"application/json"},data:j},x||{})));case 1:case"end":return m.stop()}},o)})),_.apply(this,arguments)}function a(o,j,x){return X.apply(this,arguments)}function X(){return X=Object(H.a)(Object(g.a)().mark(function o(j,x,I){return Object(g.a)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",Object(R.i)("/api/admin/templates/".concat(j),Object(M.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:x},I||{})));case 1:case"end":return y.stop()}},o)})),X.apply(this,arguments)}function G(o,j){return L.apply(this,arguments)}function L(){return L=Object(H.a)(Object(g.a)().mark(function o(j,x){return Object(g.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(R.i)("/api/admin/templates/".concat(j),Object(M.a)({method:"DELETE",headers:{"Content-Type":"application/json"}},x||{})));case 1:case"end":return m.stop()}},o)})),L.apply(this,arguments)}function O(o){return E.apply(this,arguments)}function E(){return E=Object(H.a)(Object(g.a)().mark(function o(j){return Object(g.a)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.abrupt("return",Object(R.i)("/api/admin/templates/variables",Object(M.a)({method:"GET"},j||{})));case 1:case"end":return I.stop()}},o)})),E.apply(this,arguments)}function V(o,j){return se.apply(this,arguments)}function se(){return se=Object(H.a)(Object(g.a)().mark(function o(j,x){return Object(g.a)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",Object(R.i)("/api/admin/templates/".concat(j,"/preview"),Object(M.a)({method:"GET"},x||{})));case 1:case"end":return m.stop()}},o)})),se.apply(this,arguments)}function xe(o,j,x){return ae.apply(this,arguments)}function ae(){return ae=Object(H.a)(Object(g.a)().mark(function o(j,x,I){return Object(g.a)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",Object(R.i)("/api/admin/events/trigger-manually/".concat(j),Object(M.a)({method:"POST",headers:{"Content-Type":"application/json"},data:{users:x}},I||{})));case 1:case"end":return y.stop()}},o)})),ae.apply(this,arguments)}function f(o,j,x){return B.apply(this,arguments)}function B(){return B=Object(H.a)(Object(g.a)().mark(function o(j,x,I){return Object(g.a)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",Object(R.i)("/api/admin/products/".concat(x,"/trigger-event-manually/").concat(j),Object(M.a)({method:"POST",headers:{"Content-Type":"application/json"}},I||{})));case 1:case"end":return y.stop()}},o)})),B.apply(this,arguments)}},wbUo:function(fe,h,t){}}]);
