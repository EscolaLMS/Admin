(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{BiO0:function(ne,f,t){"use strict";var u=t("VTBJ"),E=t("Ff2n"),h=t("nKUr"),v=t.n(h),S=t("q1tI"),y=t.n(S),W=t("adzw"),x=["fieldProps","proFieldProps"],O=function(R,K){var J=R.fieldProps,F=R.proFieldProps,P=Object(E.a)(R,x);return Object(h.jsx)(W.a,Object(u.a)({ref:K,valueType:"textarea",fieldProps:J,proFieldProps:F},P))};f.a=y.a.forwardRef(O)},CUYv:function(ne,f,t){"use strict";t.r(f);var u=t("T2oS"),E=t("W9HT"),h=t("miYZ"),v=t("tsqr"),S=t("qLMh"),y=t("k1fw"),W=t("9og8"),x=t("tJVT"),O=t("q1tI"),N=t("VMEa"),R=t("Qurx"),K=t("F/zT"),J=t("BiO0"),F=t("nhC9"),P=t("GuVI"),H=t("0WSk"),q=t("tMyG"),i=t("9kvl"),_=t("Ty5D"),Q=t("nRaC"),ee=t("5RzL"),V=t("oBTY"),X=t("H6aw"),e=t("nKUr"),a=function G(b){return b.reduce(function(l,o){return[].concat(Object(V.a)(l),[{value:"EscolaLms\\Courses\\Lesson:".concat(o.id),title:o.title,label:o.title,children:o.lessons?G(o.lessons):[]}],Object(V.a)(o.topics?o.topics.map(function(m){return{value:"EscolaLms\\Courses\\Topic:".concat(m.id),title:"Unit: ".concat(m.title),label:m.title}}):[]))},[])},r=function(b){var l=b.value,o=b.onChange,m=Object(O.useState)([]),D=Object(x.a)(m,2),s=D[0],U=D[1];return Object(O.useEffect)(function(){Object(W.a)(Object(S.a)().mark(function A(){var p,I,L;return Object(S.a)().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,Object(X.e)({page:-1,pageSize:100});case 2:if(p=g.sent,!p.success){g.next=9;break}return g.next=6,Promise.all(p.data.filter(function(d){return d.id}).map(function(d){return Object(X.m)(d.id)}));case 6:I=g.sent,L=I.filter(function(d){return d.success}).map(function(d){return{value:"EscolaLms\\Courses\\Course:".concat(d.success&&d.data.id),title:d.success?d.data.title:"",label:d.success?d.data.title:"",children:d.success?a(d.data.lessons):void 0}}),U(L);case 9:case"end":return g.stop()}},A)}))()},[]),Object(e.jsx)(ee.a,{loading:s.length===0,treeLine:!0,showSearch:!0,style:{width:"100%"},value:l,dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"Please select",allowClear:!0,treeDefaultExpandAll:!0,onChange:function(p){return o&&o(p)},treeData:s})},j=t("Mwp2"),c=t("VXEj"),n=t("5NDa"),z=t("5rEg"),ce=t("+L6B"),te=t("2/Rp"),re=function(b){var l,o,m=b.note,D=b.onRemoved,s=b.onEdited,U=b.taskId,A=Object(O.useState)(m.note),p=Object(x.a)(A,2),I=p[0],L=p[1];return Object(e.jsx)(c.b.Item,{actions:[Object(e.jsx)(te.a,{size:"small",type:"primary",onClick:function(){return Object(P.j)(m.id,{task_id:U,note:I}).then(function(){s&&s()})},children:Object(e.jsx)(i.a,{id:"Notes.edit_note",defaultMessage:"Edit Note"})},"update"),Object(e.jsx)(te.a,{size:"small",danger:!0,onClick:function(){return Object(P.e)(m.id).then(function(){D&&D()})},children:Object(e.jsx)(i.a,{id:"Notes.delete_note",defaultMessage:"Delete Note"})},"delete")],children:Object(e.jsx)(c.b.Item.Meta,{avatar:Object(e.jsxs)(O.Fragment,{children:[Object(e.jsx)(i.a,{id:"Notes.created_by",defaultMessage:"Created by"}),Object(e.jsx)("br",{}),(l=m.user)===null||l===void 0?void 0:l.first_name," ",(o=m.user)===null||o===void 0?void 0:o.last_name]}),description:Object(e.jsx)(z.a.TextArea,{value:I,onChange:function(g){return L(g.target.value)}})})})},se=function(b){var l=b.notes,o=b.onAdded,m=b.onRemoved,D=b.onEdited,s=b.taskId,U=Object(O.useState)(""),A=Object(x.a)(U,2),p=A[0],I=A[1],L=Object(O.useState)(!1),$=Object(x.a)(L,2),g=$[0],d=$[1],w=Object(O.useCallback)(function(){d(!0),Object(P.c)({task_id:s,note:p}).catch(function(Z){return console.log("err",Z)}).then(function(){I(""),o&&o()}).finally(function(){d(!1)})},[p,s]);return Object(e.jsx)("div",{children:Object(e.jsx)(c.b,{loading:g,itemLayout:"horizontal",dataSource:[].concat(Object(V.a)(l),[0]),renderItem:function(M){return Number.isInteger(M)?Object(e.jsx)(c.b.Item,{actions:[Object(e.jsx)(te.a,{size:"small",type:"primary",onClick:function(){w()},children:Object(e.jsx)(i.a,{id:"Notes.create_note",defaultMessage:"Create Note"})},"new")],children:Object(e.jsx)(c.b.Item.Meta,{avatar:Object(e.jsx)(O.Fragment,{children:Object(e.jsx)(i.a,{id:"Notes.new_note",defaultMessage:"New note"})}),description:Object(e.jsx)(z.a.TextArea,{value:p,onChange:function(B){return I(B.target.value)}})})}):typeof M=="object"&&Object(e.jsx)(re,{taskId:s,note:M,onRemoved:function(){return m&&m()},onEdited:function(){return D&&D()}})}})})},ie=f.default=function(){var G=Object(i.l)(),b=Object(_.l)(),l=b.task,o=l==="new",m=Object(O.useState)(),D=Object(x.a)(m,2),s=D[0],U=D[1],A=Object(O.useState)(!1),p=Object(x.a)(A,2),I=p[0],L=p[1],$=N.a.useForm(),g=Object(x.a)($,1),d=g[0],w=Object(O.useCallback)(Object(W.a)(Object(S.a)().mark(function M(){var T;return Object(S.a)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return L(!0),C.next=3,Object(P.f)(Number(l));case 3:T=C.sent,T.success&&U(Object(y.a)({},T.data)),L(!1);case 6:case"end":return C.stop()}},M)})),[l]);Object(O.useEffect)(function(){if(l==="new"){U({});return}w()},[l,w]);var Z=Object(O.useMemo)(function(){return{onFinish:function(){var M=Object(W.a)(Object(S.a)().mark(function B(C){var Y,ae;return Object(S.a)().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(ae=Object(y.a)(Object(y.a)({},C),{},{related_id:C.related?C.related.split(":")[1]:void 0,related_type:C.related?C.related.split(":")[0]:void 0}),l!=="new"){k.next=8;break}return k.next=4,Object(P.b)(ae);case 4:Y=k.sent,Y.success&&i.f.push("/other/tasks/".concat(Y.data.id)),k.next=11;break;case 8:return k.next=10,Object(P.i)(Number(l),ae);case 10:Y=k.sent;case 11:v.b.success(Y.message);case 12:case"end":return k.stop()}},B)}));function T(B){return M.apply(this,arguments)}return T}(),initialValues:Object(y.a)(Object(y.a)({},s),{},{user_id:s&&s.user&&s.user.id?s.user.id:void 0,created_by_id:s&&s.created_by&&s.created_by.id?s.created_by.id:void 0,related:s!=null&&s.related_id&&s.related_type?"".concat(s.related_type,":").concat(s.related_id):void 0})}},[s,l]);return s?Object(e.jsx)(q.a,{title:o?Object(e.jsx)(i.a,{id:"new_task"}):Object(e.jsx)(i.a,{id:"edit_task"}),children:Object(e.jsx)(F.a,{children:Object(e.jsxs)(N.a,Object(y.a)(Object(y.a)({},Z),{},{form:d,children:[Object(e.jsxs)(N.a.Group,{children:[Object(e.jsx)(R.a,{width:"md",name:"title",label:Object(e.jsx)(i.a,{id:"title"}),tooltip:Object(e.jsx)(i.a,{id:"title"}),placeholder:G.formatMessage({id:"title"}),required:!0}),Object(e.jsx)(N.a.Item,{name:"user_id",label:Object(e.jsx)(i.a,{id:"assignee"}),tooltip:Object(e.jsx)(i.a,{id:"assignee"}),valuePropName:"value",required:!0,children:Object(e.jsx)(H.a,{})}),!o&&Object(e.jsx)(N.a.Item,{name:"created_by_id",label:Object(e.jsx)(i.a,{id:"created_by"}),tooltip:Object(e.jsx)(i.a,{id:"created_by"}),valuePropName:"value",children:Object(e.jsx)(H.a,{disabled:!0})}),!o&&Object(e.jsx)(K.a,{name:"completed_at",label:Object(e.jsx)(i.a,{id:"completed_at",defaultMessage:"Completed"}),tooltip:Object(e.jsx)(i.a,{id:"completed_at_tooltip",defaultMessage:"Completed"}),fieldProps:{onChange:function(T){(T?Object(P.a)(Number(l)):Object(P.g)(Number(l))).then(function(B){v.b.success(B.message)})}}})]}),Object(e.jsx)(R.a,{name:"related",shouldUpdate:!0,hidden:!0}),Object(e.jsx)(N.a.Item,{label:Object(e.jsx)(i.a,{id:"relates_to",defaultMessage:"Relates to"}),tooltip:Object(e.jsx)(i.a,{id:"relates_to_tooltip",defaultMessage:"Relates to"}),shouldUpdate:!0,children:function(T){return Object(e.jsx)(r,{value:T.getFieldValue("related"),onChange:function(C){T.setFieldValue("related",C)}})}}),Object(e.jsx)(J.a,{width:"md",name:"description",label:Object(e.jsx)(i.a,{id:"description"}),tooltip:Object(e.jsx)(i.a,{id:"description"}),placeholder:G.formatMessage({id:"description"})}),!o&&Object(e.jsx)(F.a,{title:"notes",bordered:!0,children:s.notes&&Object(e.jsx)(se,{notes:s.notes,taskId:Number(l),onAdded:function(){return w()},onEdited:function(){return w()},onRemoved:function(){return w()}})}),I&&Object(e.jsx)(E.a,{})]}))})}):Object(e.jsx)(E.a,{})}},GuVI:function(ne,f,t){"use strict";t.d(f,"h",function(){return S}),t.d(f,"d",function(){return W}),t.d(f,"f",function(){return O}),t.d(f,"b",function(){return R}),t.d(f,"i",function(){return J}),t.d(f,"a",function(){return P}),t.d(f,"g",function(){return q}),t.d(f,"c",function(){return _}),t.d(f,"j",function(){return ee}),t.d(f,"e",function(){return X});var u=t("qLMh"),E=t("k1fw"),h=t("9og8"),v=t("9kvl");function S(a,r){return y.apply(this,arguments)}function y(){return y=Object(h.a)(Object(u.a)().mark(function a(r,j){return Object(u.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(v.i)("/api/admin/tasks",Object(E.a)({method:"GET",params:Object(E.a)(Object(E.a)({},r),{},{per_page:r.pageSize,page:r.current})},j||{})));case 1:case"end":return n.stop()}},a)})),y.apply(this,arguments)}function W(a,r){return x.apply(this,arguments)}function x(){return x=Object(h.a)(Object(u.a)().mark(function a(r,j){return Object(u.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(v.i)("/api/admin/tasks/".concat(r),Object(E.a)({method:"DELETE"},j||{})));case 1:case"end":return n.stop()}},a)})),x.apply(this,arguments)}function O(a,r){return N.apply(this,arguments)}function N(){return N=Object(h.a)(Object(u.a)().mark(function a(r,j){return Object(u.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(v.i)("/api/admin/tasks/".concat(r),Object(E.a)({method:"GET"},j||{})));case 1:case"end":return n.stop()}},a)})),N.apply(this,arguments)}function R(a){return K.apply(this,arguments)}function K(){return K=Object(h.a)(Object(u.a)().mark(function a(r){return Object(u.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(v.i)("/api/admin/tasks",{method:"POST",data:r}));case 1:case"end":return c.stop()}},a)})),K.apply(this,arguments)}function J(a,r,j){return F.apply(this,arguments)}function F(){return F=Object(h.a)(Object(u.a)().mark(function a(r,j,c){return Object(u.a)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.abrupt("return",Object(v.i)("/api/admin/tasks/".concat(r),Object(E.a)({method:"PATCH",data:j},c||{})));case 1:case"end":return z.stop()}},a)})),F.apply(this,arguments)}function P(a,r){return H.apply(this,arguments)}function H(){return H=Object(h.a)(Object(u.a)().mark(function a(r,j){return Object(u.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(v.i)("/api/admin/tasks/complete/".concat(r),Object(E.a)({method:"POST"},j||{})));case 1:case"end":return n.stop()}},a)})),H.apply(this,arguments)}function q(a,r){return i.apply(this,arguments)}function i(){return i=Object(h.a)(Object(u.a)().mark(function a(r,j){return Object(u.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(v.i)("/api/admin/tasks/incomplete/".concat(r),Object(E.a)({method:"POST"},j||{})));case 1:case"end":return n.stop()}},a)})),i.apply(this,arguments)}function _(a){return Q.apply(this,arguments)}function Q(){return Q=Object(h.a)(Object(u.a)().mark(function a(r){return Object(u.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(v.i)("/api/admin/tasks/notes",{method:"POST",data:r}));case 1:case"end":return c.stop()}},a)})),Q.apply(this,arguments)}function ee(a,r){return V.apply(this,arguments)}function V(){return V=Object(h.a)(Object(u.a)().mark(function a(r,j){return Object(u.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(v.i)("/api/admin/tasks/notes/".concat(r),{method:"PATCH",data:j}));case 1:case"end":return n.stop()}},a)})),V.apply(this,arguments)}function X(a){return e.apply(this,arguments)}function e(){return e=Object(h.a)(Object(u.a)().mark(function a(r){return Object(u.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(v.i)("/api/admin/tasks/notes/".concat(r),{method:"DELETE"}));case 1:case"end":return c.stop()}},a)})),e.apply(this,arguments)}}}]);
