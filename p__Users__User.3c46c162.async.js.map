{"version":3,"sources":["webpack:///./src/services/escola-lms/tracker.ts","webpack:///./src/components/LogsWidget/index.tsx","webpack:///./src/services/escola-lms/roles.ts","webpack:///./src/components/ResponsiveImage/index.tsx","webpack:///./src/components/CategoryCheckboxTree/index.tsx","webpack:///./src/components/JsonEditor/index.tsx","webpack:///./src/pages/Users/User/components/AdditionalField.tsx","webpack:///./node_modules/@ant-design/pro-form/es/components/Checkbox/index.js","webpack:///./src/pages/Users/User/form.tsx","webpack:///./src/pages/Users/User/components/Categories.tsx","webpack:///./src/pages/Users/User/index.tsx"],"names":["params","options","request","method","useCache","per_page","pageSize","page","current","TableColumns","title","dataIndex","hideInSearch","sorter","width","hideInForm","hideInTable","valueType","fieldProps","allowEmpty","valueEnum","GET","POST","PUT","DELETE","PATCH","LogsWidget","useAsWidget","userID","actionRef","useRef","useState","loading","setLoading","intl","useIntl","formatMessage","id","defaultMessage","layout","sort","user_id","dateRange","path","sortArr","Object","entries","date_from","format","Date","DATETIME_FORMAT","undefined","date_to","track","order_by","order","then","response","success","data","total","meta","key","renderFormItem","item","form","type","defaultRender","rest","stateType","getFieldValue","render","_","record","user","body","headers","name","ResponsiveImage","size","srcSizes","alt","props","src","window","REACT_APP_API_URL","srcSet","map","srcSize","join","treeConvert","category","subcategories","length","children","cat","CategoryCheckboxTree","value","onChange","multiple","categories","setCategories","useEffect","categoryTree","treeData","useMemo","keys","Array","isArray","checked","checkedKeys","JsonEditor","isModalVisible","setIsModalVisible","hideModal","useCallback","mode","setMode","e","target","AdditionalField","field","getProperField","f","locale","getLocale","translatedLabel","extra","find","i","FieldType","Number","step","Boolean","Varchar","Json","Text","_excluded","CheckboxGroup","React","forwardRef","_ref","ref","proFieldProps","_objectWithoutProperties","_jsx","ProFormField","_objectSpread","runFunction","lightProps","labelFormatter","filedConfig","customLightMode","ProFormCheckboxComponents","_ref2","_Checkbox","ProFormCheckbox","createField","valuePropName","WrappedProFormCheckbox","Group","userGroups","setUserGroups","userGroupsLoading","setUserGroupsLoading","fetchUserGroups","userGroupsTree","handleAddToGroup","group_id","addUserToGroup","handleRemoveFromGroup","removeUserFromGroup","handleClearAllGroups","Promise","all","isNew","setData","useParams","additionalFields","useModelFields","useModel","initialState","baseUrl","config","filter","useUserGroups","roles","setRoles","ProForm","useForm","fetchRoles","getRoles","onDeleteAvatar","deleteUserAvatar","message","prevState","avatar","path_avatar","catch","error","formProps","onFinish","values","postData","password","createUser","history","push","updateUser","initialValues","required","validator","test","reject","Error","resolve","state","list","includes","is_active","resendEmail","role","guard_name","info","file","status","UserCategories","updateUserInterests","tab","fetchData","fetchUser","interests","categoriesArrToIds","breadcrumb","routes","breadcrumbName","String","activeKey"],"mappings":"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","file":"p__Users__User.3c46c162.async.js","sourcesContent":["import { request } from 'umi';\nimport type { RequestOptionsInit } from 'umi-request';\n\n/**  GET /api/admin/track/routes */\nexport async function track(\n  params: API.PaginationParams & {\n    current?: number;\n    pageSize?: number;\n    date_from?: string;\n    date_to?: string;\n    user_id?: number;\n    path?: string;\n    method: 'string';\n  },\n  options?: RequestOptionsInit,\n) {\n  return request<API.DefaultMetaResponse<EscolaLms.Tracker.Models.TrackRoute>>(\n    `/api/admin/tracks/routes`,\n    {\n      method: 'GET',\n      /* useCache: true */ useCache: false,\n      params: {\n        ...params,\n        per_page: params.pageSize,\n        page: params.current,\n      },\n      ...(options || {}),\n    },\n  );\n}\n","import React, { useRef, useState } from 'react';\nimport { useIntl, FormattedMessage } from 'umi';\nimport type { ProColumns, ActionType } from '@ant-design/pro-table';\nimport ProTable from '@ant-design/pro-table';\nimport { format } from 'date-fns/esm';\nimport { DATETIME_FORMAT } from '@/consts/dates';\nimport { track } from '@/services/escola-lms/tracker';\nimport TypeButtonDrawer from '@/components/TypeButtonDrawer';\nimport UserSelect from '@/components/UserSelect';\n\nexport const TableColumns: ProColumns<EscolaLms.Tracker.Models.TrackRoute>[] = [\n  {\n    title: <FormattedMessage id=\"ID\" defaultMessage=\"ID\" />,\n    dataIndex: 'id',\n    hideInSearch: true,\n    sorter: true,\n    width: '80px',\n  },\n  {\n    title: <FormattedMessage id=\"dateRange\" defaultMessage=\"Date Range\" />,\n    dataIndex: 'dateRange',\n    hideInSearch: false,\n    hideInForm: true,\n    hideInTable: true,\n    valueType: 'dateRange',\n    fieldProps: {\n      allowEmpty: [true, true],\n    },\n  },\n  {\n    title: <FormattedMessage id=\"http_method\" defaultMessage=\"http_method\" />,\n    dataIndex: 'method',\n    hideInSearch: false,\n    sorter: true,\n    valueEnum: {\n      GET: 'GET',\n      POST: 'POST',\n      PUT: 'PUT',\n      DELETE: 'DELETE',\n      PATCH: 'PATCH',\n    },\n  },\n  {\n    title: <FormattedMessage id=\"path\" defaultMessage=\"path\" />,\n    dataIndex: 'path',\n    sorter: true,\n    hideInSearch: false,\n  },\n];\n\nconst LogsWidget: React.FC<{ useAsWidget?: boolean; userID?: number }> = ({\n  useAsWidget,\n  userID,\n}) => {\n  const actionRef = useRef<ActionType>();\n  const [loading, setLoading] = useState(false);\n  const intl = useIntl();\n  return (\n    <ProTable<\n      EscolaLms.Tracker.Models.TrackRoute,\n      API.PageParams & {\n        user_id?: number;\n        method: 'string';\n        dateRange: [string, string];\n        path: string;\n      }\n    >\n      headerTitle={intl.formatMessage({\n        id: 'menu.Analytics.Logs',\n        defaultMessage: 'menu.Analytics.Logs',\n      })}\n      loading={loading}\n      actionRef={actionRef}\n      rowKey=\"id\"\n      search={{\n        layout: 'vertical',\n      }}\n      request={({ user_id, method, dateRange, path, pageSize, current }, sort) => {\n        const sortArr = sort && Object.entries(sort)[0];\n        setLoading(true);\n        const date_from =\n          dateRange && dateRange[0] ? format(new Date(dateRange[0]), DATETIME_FORMAT) : undefined;\n        const date_to =\n          dateRange && dateRange[1] ? format(new Date(dateRange[1]), DATETIME_FORMAT) : undefined;\n\n        return track({\n          user_id: useAsWidget ? userID : user_id,\n          method,\n          pageSize,\n          current,\n          path,\n          date_from,\n          date_to,\n          order_by: sortArr && sortArr[0],\n          order: sortArr ? (sortArr[1] === 'ascend' ? 'ASC' : 'DESC') : undefined,\n        }).then((response) => {\n          setLoading(false);\n          if (response.success) {\n            return {\n              data: response.data,\n              total: response.meta.total,\n              success: true,\n            };\n          }\n          return [];\n        });\n      }}\n      columns={[\n        ...TableColumns,\n        {\n          title: <FormattedMessage id=\"user\" defaultMessage=\"user\" />,\n          dataIndex: 'user_id',\n          key: 'user_id',\n          hideInSearch: useAsWidget,\n          sorter: true,\n          renderFormItem: (item, { type, defaultRender, ...rest }, form) => {\n            if (type === 'form') {\n              return null;\n            }\n            const stateType = form.getFieldValue('state');\n            return (\n              <UserSelect\n                {...rest}\n                state={{\n                  type: stateType,\n                }}\n              />\n            );\n          },\n          render: (_, record) =>\n            record.user && <TypeButtonDrawer type={'App\\\\Models\\\\User'} type_id={record.user.id} />,\n        },\n      ]}\n    />\n  );\n};\n\nexport default LogsWidget;\n","import { request } from 'umi';\nimport type { RequestOptionsInit } from 'umi-request';\n\n/**  GET /api/admin/roles */\nexport async function roles(\n  params?: API.CourseParams & {\n    // query\n    current?: number;\n    pageSize?: number;\n    name?: string;\n    search?: string;\n  },\n  options?: RequestOptionsInit,\n) {\n  return request<API.RolesList>(`/api/admin/roles`, {\n    method: 'GET',\n    /* useCache: true */ useCache: false,\n    params,\n    ...(options || {}),\n  });\n}\n\n/**  POST /api/admin/roles */\nexport async function createRole(body?: Partial<API.Role>, options?: RequestOptionsInit) {\n  return request<API.DefaultResponse<API.Role>>(`/api/admin/roles`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    data: body,\n    ...(options || {}),\n  });\n}\n\n/**  DELETE /api/admin/roles/:id */\nexport async function deleteRole(id: string, options?: RequestOptionsInit) {\n  return request<API.DefaultResponse<API.Role>>(`/api/admin/roles/${id}`, {\n    method: 'DELETE',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    ...(options || {}),\n  });\n}\n\n/**  GET /api/admin/roles/:name */\nexport async function permisions(name: string, options?: RequestOptionsInit) {\n  return request<API.RolesList>(`/api/admin/roles/${name}`, {\n    method: 'GET',\n    /* useCache: true */ useCache: false,\n\n    ...(options || {}),\n  });\n}\n\n/**  PATCH /api/admin/roles/:name */\nexport async function setRolePermisions(name: string, body?: any, options?: RequestOptionsInit) {\n  return request<API.DefaultResponse<API.Role>>(`/api/admin/roles/${name}`, {\n    method: 'PATCH',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    data: body,\n    ...(options || {}),\n  });\n}\n","import React from 'react';\nimport { Image } from 'antd';\nimport type { ImageProps } from 'antd';\ndeclare const REACT_APP_API_URL: string;\n\ninterface ResponsiveImageProps extends ImageProps {\n  path: string;\n  size?: number;\n  srcSizes?: number[];\n  alt?: string;\n}\n\nconst ResponsiveImage: React.FC<ResponsiveImageProps> = ({\n  path,\n  size,\n  srcSizes,\n  alt = 'LMS Image',\n  ...props\n}) => {\n  const src = `${window.REACT_APP_API_URL || REACT_APP_API_URL}/api/images/img?path=${path}&w=${\n    srcSizes ? srcSizes[0] : size\n  }`;\n  const srcSet =\n    srcSizes &&\n    srcSizes.map(\n      (srcSize) =>\n        `${\n          window.REACT_APP_API_URL || REACT_APP_API_URL\n        }/api/images/img?path=${path}&w=${srcSize} ${srcSize}w`,\n    );\n\n  return (\n    <div className=\"escolalms-image\">\n      <Image src={src} srcSet={srcSet && srcSet.join(',')} alt={alt} {...props} />\n    </div>\n  );\n};\n\nexport default ResponsiveImage;\n","import React, { useState, useEffect, useMemo } from 'react';\nimport { Tree, Spin } from 'antd';\n\nimport { categoryTree } from '@/services/escola-lms/category';\n\ntype TreeNodeType = {\n  title: string;\n  key: React.Key;\n  children?: TreeNodeType[];\n};\n\nconst treeConvert = (category: API.Category): TreeNodeType => {\n  return category.subcategories && category.subcategories.length\n    ? {\n        title: category.name,\n        key: category.id,\n        children: category.subcategories.map((cat) => treeConvert(cat)),\n      }\n    : {\n        title: category.name,\n        key: category.id,\n      };\n};\n\nexport const CategoryCheckboxTree: React.FC<{\n  state?: {\n    type: number;\n  };\n  multiple?: boolean;\n  value?: React.Key[];\n  onChange?: (value: React.Key[]) => void;\n}> = ({ value, onChange, multiple = true }) => {\n  const [categories, setCategories] = useState<API.Category[]>([]);\n\n  useEffect(() => {\n    categoryTree().then((response) => {\n      if (response.success) {\n        setCategories(response.data);\n      }\n    });\n  }, []);\n\n  const treeData = useMemo(() => {\n    return categories.map((cat) => treeConvert(cat));\n  }, [categories]);\n\n  if (categories.length === 0) {\n    return <Spin />;\n  }\n\n  return (\n    <Tree\n      multiple={multiple}\n      checkable\n      checkStrictly={true}\n      defaultExpandAll\n      style={{ width: '100%' }}\n      checkedKeys={value}\n      onCheck={(keys) => {\n        if (typeof keys === 'object' && !Array.isArray(keys) && keys.checked) {\n          const checkedKeys = keys.checked;\n          return onChange && Array.isArray(checkedKeys) && onChange(checkedKeys);\n        }\n      }}\n      treeData={treeData}\n      disabled={categories.length === 0}\n    />\n  );\n};\n\nexport default CategoryCheckboxTree;\n","import React, { useState, useCallback } from 'react';\nimport { Modal, Button, Radio } from 'antd';\nimport { JsonEditor as Editor } from 'jsoneditor-react';\nimport { FormattedMessage } from 'umi';\nimport 'jsoneditor-react/es/editor.min.css';\n\ntype EditorMode = 'tree' | 'view' | 'form' | 'code' | 'text';\n\nexport const JsonEditor: React.FC<{\n  value?: string;\n  onChange?: (value: string) => void;\n}> = ({ value, onChange }) => {\n  const [isModalVisible, setIsModalVisible] = useState(false);\n\n  const hideModal = useCallback(() => {\n    setIsModalVisible(false);\n  }, []);\n\n  const [mode, setMode] = useState<EditorMode>('code');\n\n  return (\n    <div>\n      <Button type=\"primary\" onClick={() => setIsModalVisible(true)} size=\"small\">\n        <FormattedMessage id=\"json_editor\" />\n      </Button>\n      <Modal\n        title=\"JSON\"\n        open={isModalVisible}\n        onOk={hideModal}\n        onCancel={hideModal}\n        destroyOnClose\n      >\n        <Radio.Group onChange={(e) => setMode(e.target.value)} value={mode}>\n          <Radio value=\"tree\">tree</Radio>\n          <Radio value=\"view\">view</Radio>\n          <Radio value=\"form\">form</Radio>\n          <Radio value=\"code\">code</Radio>\n          <Radio value=\"text\">text</Radio>\n        </Radio.Group>\n        <Editor key={mode} mode={mode} value={value} onChange={onChange} />\n      </Modal>\n    </div>\n  );\n};\n\nexport default JsonEditor;\n","import JsonEditor from '@/components/JsonEditor';\nimport { FieldType } from '@/services/escola-lms/enums';\nimport ProForm, {\n  ProFormCheckbox,\n  ProFormDigit,\n  ProFormText,\n  ProFormTextArea,\n} from '@ant-design/pro-form';\nimport React from 'react';\nimport { FormattedMessage, getLocale, useIntl } from 'umi';\n\nconst AdditionalField: React.FC<{\n  field: API.ModelField;\n}> = ({ field }) => {\n  const intl = useIntl();\n  const getProperField = (f: API.ModelField) => {\n    const locale = getLocale();\n    const translatedLabel = f?.extra?.find((i: Record<string, string>) => i?.[locale])?.[locale];\n\n    switch (f.type) {\n      case FieldType.Number:\n        return (\n          <ProFormDigit\n            width=\"md\"\n            name={f.name}\n            label={translatedLabel ?? <FormattedMessage id={f.name} />}\n            tooltip={<FormattedMessage id={f.name} />}\n            placeholder={intl.formatMessage({\n              id: f.name,\n              defaultMessage: f.name,\n            })}\n            min={1}\n            max={1024}\n            fieldProps={{ step: 1 }}\n          />\n        );\n      case FieldType.Boolean:\n        return (\n          <ProFormCheckbox name={f.name}>\n            {translatedLabel ?? <FormattedMessage id={f.name} />}\n          </ProFormCheckbox>\n        );\n\n      case FieldType.Varchar:\n        return (\n          <ProFormText\n            width=\"md\"\n            name={f.name}\n            label={translatedLabel ?? <FormattedMessage id={f.name} />}\n            tooltip={<FormattedMessage id={f.name} />}\n            placeholder={intl.formatMessage({\n              id: f.name,\n            })}\n          />\n        );\n\n      case FieldType.Json:\n        return (\n          <ProForm.Item\n            name={f.name}\n            label={translatedLabel ?? <FormattedMessage id={f.name} />}\n            tooltip={<FormattedMessage id={f.name} />}\n            valuePropName=\"value\"\n          >\n            <JsonEditor />\n          </ProForm.Item>\n        );\n\n      case FieldType.Text:\n      default:\n        return (\n          <ProFormTextArea\n            width=\"md\"\n            name={f.name}\n            label={translatedLabel ?? <FormattedMessage id={f.name} />}\n            tooltip={<FormattedMessage id={f.name} />}\n            placeholder={intl.formatMessage({\n              id: f.name,\n            })}\n          />\n        );\n    }\n  };\n  return <>{getProperField(field)}</>;\n};\n\nexport default AdditionalField;\n","import \"antd/es/checkbox/style\";\nimport _Checkbox from \"antd/es/checkbox\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"options\", \"fieldProps\", \"proFieldProps\", \"valueEnum\"];\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { runFunction } from '@ant-design/pro-utils';\nimport React from 'react';\nimport { createField } from '../../BaseForm/createField';\nimport ProFormField from '../Field';\nvar CheckboxGroup = /*#__PURE__*/React.forwardRef(function (_ref, ref) {\n  var options = _ref.options,\n      fieldProps = _ref.fieldProps,\n      proFieldProps = _ref.proFieldProps,\n      valueEnum = _ref.valueEnum,\n      rest = _objectWithoutProperties(_ref, _excluded);\n\n  return _jsx(ProFormField, _objectSpread({\n    ref: ref,\n    valueType: \"checkbox\",\n    valueEnum: runFunction(valueEnum, undefined),\n    fieldProps: _objectSpread({\n      options: options\n    }, fieldProps),\n    lightProps: _objectSpread({\n      labelFormatter: function labelFormatter() {\n        return _jsx(ProFormField, _objectSpread({\n          ref: ref,\n          valueType: \"checkbox\",\n          mode: \"read\",\n          valueEnum: runFunction(valueEnum, undefined),\n          filedConfig: {\n            customLightMode: true\n          },\n          fieldProps: _objectSpread({\n            options: options\n          }, fieldProps),\n          proFieldProps: proFieldProps\n        }, rest));\n      }\n    }, rest.lightProps),\n    proFieldProps: proFieldProps\n  }, rest));\n});\n/**\n * 多选框的\n *\n * @param\n */\n\nvar ProFormCheckboxComponents = /*#__PURE__*/React.forwardRef(function (_ref2, ref) {\n  var fieldProps = _ref2.fieldProps,\n      children = _ref2.children;\n  return _jsx(_Checkbox, _objectSpread(_objectSpread({\n    ref: ref\n  }, fieldProps), {}, {\n    children: children\n  }));\n});\nvar ProFormCheckbox = createField(ProFormCheckboxComponents, {\n  valuePropName: 'checked'\n});\nvar WrappedProFormCheckbox = ProFormCheckbox;\nWrappedProFormCheckbox.Group = CheckboxGroup;\nexport default WrappedProFormCheckbox;","import React, { useMemo, useState, useEffect } from 'react';\nimport { message, Spin, Form, Button, Space, Typography, Divider, Row } from 'antd';\nimport ProForm, { ProFormText, ProFormSwitch, ProFormCheckbox } from '@ant-design/pro-form';\nimport { updateUser, createUser, resendEmail } from '@/services/escola-lms/user';\nimport SecureUploadBrowser from '@/components/SecureUpload/browser';\nimport ResponsiveImage from '@/components/ResponsiveImage';\nimport UserGroupSelect from '@/components/UserGroupSelect';\nimport { useParams, history, useModel, Link } from 'umi';\nimport { useCallback } from 'react';\nimport { useIntl, FormattedMessage } from 'umi';\nimport { roles as getRoles } from '@/services/escola-lms/roles';\nimport { deleteUserAvatar } from '@/services/escola-lms/user';\nimport {\n  userGroupsTree,\n  addUserToGroup,\n  removeUserFromGroup,\n} from '@/services/escola-lms/user_groups';\nimport useModelFields from '@/hooks/useModelFields';\nimport AdditionalField from './components/AdditionalField';\n\nfunction useUserGroups(user_id: number) {\n  const [userGroups, setUserGroups] = useState<number[]>([]);\n  const [userGroupsLoading, setUserGroupsLoading] = useState(false);\n\n  const fetchUserGroups = useCallback(async () => {\n    try {\n      setUserGroupsLoading(true);\n      const response = await userGroupsTree({ user_id });\n\n      if (response.success) {\n        setUserGroups(response.data.map(({ id }) => id));\n      }\n    } finally {\n      setUserGroupsLoading(false);\n    }\n  }, [user_id]);\n\n  const handleAddToGroup = useCallback(\n    async (group_id: string | number) => {\n      if (typeof group_id === 'string') return;\n      setUserGroupsLoading(true);\n\n      await addUserToGroup(group_id, user_id);\n      await fetchUserGroups();\n\n      setUserGroupsLoading(false);\n    },\n    [user_id],\n  );\n\n  const handleRemoveFromGroup = useCallback(\n    async (group_id: string | number) => {\n      if (typeof group_id === 'string') return;\n      setUserGroupsLoading(true);\n\n      await removeUserFromGroup(group_id, user_id);\n      await fetchUserGroups();\n\n      setUserGroupsLoading(false);\n    },\n    [user_id],\n  );\n\n  const handleClearAllGroups = useCallback(async () => {\n    setUserGroupsLoading(true);\n\n    await Promise.all(userGroups.map((group_id) => removeUserFromGroup(group_id, user_id)));\n    await fetchUserGroups();\n\n    setUserGroupsLoading(false);\n  }, [userGroups]);\n\n  useEffect(() => {\n    fetchUserGroups();\n  }, [fetchUserGroups]);\n\n  return {\n    userGroups,\n    userGroupsLoading,\n    handleAddToGroup,\n    handleRemoveFromGroup,\n    handleClearAllGroups,\n  };\n}\n\nexport default ({\n  isNew,\n  data,\n  setData,\n}: {\n  isNew: boolean;\n  data: Partial<API.UserItem> | undefined;\n  setData: (data: Partial<API.UserItem>) => void;\n}) => {\n  const intl = useIntl();\n  const params = useParams<{ user?: string }>();\n  const { user } = params;\n  const additionalFields = useModelFields('EscolaLms\\\\Auth\\\\Models\\\\User');\n  const { initialState } = useModel('@@initialState');\n  const baseUrl = initialState?.config?.filter((item) => item.key === 'frontURL')[0]?.data;\n\n  const {\n    userGroups,\n    userGroupsLoading,\n    handleAddToGroup,\n    handleRemoveFromGroup,\n    handleClearAllGroups,\n  } = useUserGroups(data?.id ?? 0);\n\n  const [roles, setRoles] = useState<API.Role[]>();\n  const [form] = ProForm.useForm();\n\n  const fetchRoles = useCallback(async () => {\n    const request = await getRoles();\n    const response = await request;\n\n    if (response.success) {\n      setRoles(response.data);\n    }\n  }, [user]);\n\n  const onDeleteAvatar = () => {\n    deleteUserAvatar(Number(user))\n      .then((response) => {\n        if (response.success) {\n          message.success(response.message);\n          // @ts-ignore\n          setData((prevState) => ({\n            ...prevState,\n            avatar: '',\n            path_avatar: '',\n          }));\n        }\n      })\n      .catch((error: any) => {\n        message.error(error.data.message);\n      });\n  };\n\n  useEffect(() => {\n    fetchRoles();\n  }, [user]);\n\n  const formProps = useMemo(\n    () => ({\n      form,\n      onFinish: async (values: Partial<API.UserItem>) => {\n        let response: API.DefaultResponse<API.UserItem>;\n\n        const postData: Partial<API.UserItem> = {\n          ...values,\n        };\n\n        if (!postData.password || postData.password === '') {\n          delete postData.password;\n        }\n\n        if (isNew) {\n          response = await createUser(postData);\n          if (response.success) {\n            history.push(`/users/${response.data.id}/user_info`);\n          }\n        } else {\n          response = await updateUser(Number(user), postData);\n        }\n\n        message.success(response.message);\n      },\n      initialValues: data,\n    }),\n    [data, user],\n  );\n\n  if (!data) {\n    return <Spin />;\n  }\n\n  return (\n    <ProForm {...formProps}>\n      <ProForm.Group>\n        <ProFormText\n          width=\"md\"\n          name=\"first_name\"\n          label={<FormattedMessage id=\"first_name\" />}\n          tooltip={<FormattedMessage id=\"first_name\" />}\n          placeholder={intl.formatMessage({\n            id: 'first_name',\n          })}\n          required\n          rules={[{ required: true, message: intl.formatMessage({ id: 'field_required' }) }]}\n        />\n        <ProFormText\n          width=\"md\"\n          name=\"last_name\"\n          label={<FormattedMessage id=\"last_name\" />}\n          tooltip={<FormattedMessage id=\"last_name\" />}\n          placeholder={intl.formatMessage({\n            id: 'last_name',\n          })}\n          required\n          rules={[{ required: true, message: intl.formatMessage({ id: 'field_required' }) }]}\n        />\n        <ProFormText\n          width=\"md\"\n          name=\"email\"\n          label={<FormattedMessage id=\"email\" />}\n          tooltip={<FormattedMessage id=\"email\" />}\n          placeholder={intl.formatMessage({\n            id: 'email',\n          })}\n          required\n          rules={[{ required: true, message: intl.formatMessage({ id: 'field_required' }) }]}\n        />\n        <ProFormText.Password\n          shouldUpdate\n          width=\"md\"\n          name=\"password\"\n          label={<FormattedMessage id=\"password\" />}\n          tooltip={<FormattedMessage id=\"password\" />}\n          placeholder={intl.formatMessage({\n            id: 'password',\n          })}\n          required={isNew}\n          rules={[\n            {\n              validator(_, value) {\n                if (value && !/(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{8,}$/i.test(value)) {\n                  return Promise.reject(new Error(intl.formatMessage({ id: 'badPassword' })));\n                }\n                return Promise.resolve();\n              },\n            },\n            {\n              required: isNew,\n              message: <FormattedMessage id=\"field_required\" />,\n            },\n          ]}\n        />\n        {additionalFields.state === 'loaded' &&\n          additionalFields.list.map((field: API.ModelField) => (\n            <AdditionalField key={field.id} field={field} />\n          ))}\n      </ProForm.Group>\n      <ProForm.Group>\n        {!isNew && (\n          <Space direction=\"vertical\">\n            {/* if he is an admin, do not display the switch */}\n            {!data.roles?.includes('admin') && (\n              <ProFormSwitch\n                initialValue={data.is_active}\n                name=\"email_verified\"\n                label={<FormattedMessage id=\"is_email_verified\" />}\n              />\n            )}\n\n            <Form.Item noStyle shouldUpdate>\n              {() => {\n                return form.getFieldValue('email_verified') ? (\n                  <React.Fragment />\n                ) : (\n                  <>\n                    {!baseUrl && (\n                      <p>\n                        <FormattedMessage id=\"no_base_url\" />\n                        <Link to=\"/configuration/settings/escola_auth\">Settings</Link>\n                      </p>\n                    )}\n                    <Button\n                      disabled={!baseUrl}\n                      size=\"small\"\n                      onClick={() => {\n                        resendEmail(form.getFieldValue('email'), `${baseUrl}email-verify`).then(\n                          () => {\n                            message.success(\n                              intl.formatMessage({\n                                id: 'email_resend',\n                              }),\n                            );\n                          },\n                        );\n                      }}\n                    >\n                      <FormattedMessage id=\"resend\" />\n                    </Button>\n                  </>\n                );\n              }}\n            </Form.Item>\n          </Space>\n        )}\n\n        <ProFormSwitch name=\"is_active\" label={<FormattedMessage id=\"is_active\" />} />\n\n        {roles && (\n          <ProFormCheckbox.Group\n            name=\"roles\"\n            layout=\"horizontal\"\n            label={<FormattedMessage id=\"roles\" />}\n            options={roles\n              .filter((role: API.Role) => role.guard_name !== 'web')\n              .map((role: API.Role) => role.name)}\n          />\n        )}\n      </ProForm.Group>\n      {!isNew && (\n        <>\n          <ProForm.Group>\n            <ProForm.Item name=\"avatar\" label={<FormattedMessage id=\"avatar\" />}>\n              {data.path_avatar ? (\n                <ResponsiveImage path={data.path_avatar} size={600} width={200} />\n              ) : (\n                <Typography>\n                  <FormattedMessage id=\"avatar_placeholder\" />\n                </Typography>\n              )}\n            </ProForm.Item>\n            <Form.Item noStyle shouldUpdate>\n              {() => (\n                <>\n                  <SecureUploadBrowser\n                    folder={`avatars/${user}`}\n                    wrapInForm={false}\n                    url={`/api/admin/users/${user}/avatar`}\n                    name=\"avatar\"\n                    accept=\"image/*\"\n                    onChange={(info) => {\n                      if (info.file.status === 'done') {\n                        if (info.file.response && info.file.response.success) {\n                          setData(info.file.response.data);\n                        }\n                      }\n                    }}\n                  />\n                  <Button danger onClick={onDeleteAvatar}>\n                    <FormattedMessage id=\"delete\" />\n                  </Button>\n                </>\n              )}\n            </Form.Item>\n          </ProForm.Group>\n          <Row>\n            <Divider />\n            <ProForm.Item\n              style={{ width: '100%' }}\n              label={<FormattedMessage id=\"groups\" defaultMessage=\"Groups\" />}\n            >\n              <UserGroupSelect\n                multiple\n                loading={userGroupsLoading}\n                disabled={userGroupsLoading}\n                value={userGroups}\n                onSelect={handleAddToGroup}\n                onDeselect={handleRemoveFromGroup}\n                onClear={handleClearAllGroups}\n              />\n            </ProForm.Item>\n          </Row>\n        </>\n      )}\n    </ProForm>\n  );\n};\n","import CategoryCheckboxTree from '@/components/CategoryCheckboxTree';\nimport { updateUserInterests } from '@/services/escola-lms/user';\nimport ProForm from '@ant-design/pro-form';\nimport { message } from 'antd';\nimport { useMemo } from 'react';\nimport { FormattedMessage } from 'umi';\n\nconst UserCategories: React.FC<{ data: Partial<API.UserItem> | undefined }> = ({ data }) => {\n  const formProps = useMemo(\n    () => ({\n      onFinish: async (values: Partial<API.UserItem>) => {\n        const postData: Partial<API.UserItem> = {\n          ...values,\n        };\n\n        const response: API.DefaultResponse<Partial<API.UserItem>> = await updateUserInterests(\n          Number(data?.id),\n          postData,\n        );\n\n        message.success(response.message);\n      },\n      initialValues: data,\n    }),\n    [data],\n  );\n\n  return (\n    <ProForm {...formProps}>\n      <ProForm.Item\n        label={<FormattedMessage id=\"categories\" />}\n        name=\"interests\"\n        valuePropName=\"value\"\n      >\n        <CategoryCheckboxTree />\n      </ProForm.Item>\n    </ProForm>\n  );\n};\n\nexport default UserCategories;\n","import ProCard from '@ant-design/pro-card';\nimport { useParams, history } from 'umi';\nimport { PageContainer } from '@ant-design/pro-layout';\nimport { useIntl, FormattedMessage } from 'umi';\nimport UserForm from './form';\n\nimport UserCategories from './components/Categories';\nimport { useCallback, useEffect, useState } from 'react';\nimport { user as fetchUser } from '@/services/escola-lms/user';\nimport { categoriesArrToIds } from '@/utils/utils';\nimport LogsWidget from '@/components/LogsWidget';\n\nexport default () => {\n  const params = useParams<{ user?: string; tab?: string }>();\n  const [data, setData] = useState<Partial<API.UserItem>>();\n  const intl = useIntl();\n  const { tab = 'user_info', user } = params;\n  const isNew = typeof user === 'undefined';\n\n  const fetchData = useCallback(async () => {\n    const response = await fetchUser(Number(user));\n    if (response.success) {\n      setData({\n        ...response.data,\n        interests: response.data.interests.map(categoriesArrToIds),\n      });\n    }\n  }, [user]);\n\n  useEffect(() => {\n    if (isNew) {\n      setData({});\n      return;\n    }\n\n    fetchData();\n  }, [user, fetchData]);\n\n  return (\n    <PageContainer\n      title={<FormattedMessage id=\"menu.Settings\" />}\n      header={{\n        breadcrumb: {\n          routes: [\n            {\n              path: `/users/${user}/user_info`,\n              breadcrumbName: intl.formatMessage({\n                id: 'menu.Settings',\n              }),\n            },\n\n            {\n              path: String(tab),\n              breadcrumbName: intl.formatMessage({\n                id: String(tab),\n              }),\n            },\n          ],\n        },\n      }}\n    >\n      <ProCard\n        tabs={{\n          type: 'card',\n          activeKey: tab,\n          onChange: (key) => history.push(`/users/${user}/${key}`),\n        }}\n      >\n        <ProCard.TabPane\n          key=\"user_info\"\n          tab={isNew ? <FormattedMessage id=\"new_user\" /> : <FormattedMessage id=\"edit_user\" />}\n        >\n          <UserForm isNew={isNew} data={data} setData={setData} />\n        </ProCard.TabPane>\n        {!isNew && (\n          <ProCard.TabPane\n            key={'categories'}\n            tab={\n              <span>\n                <FormattedMessage id=\"categories\" />\n              </span>\n            }\n          >\n            {data?.id && <UserCategories data={data} />}\n          </ProCard.TabPane>\n        )}\n        {/* {!isNew && (\n          <ProCard.TabPane\n            key={'settings'}\n            tab={\n              <span>\n                <FormattedMessage id=\"user.settings\" />\n              </span>\n            }\n          >\n            {user && <Settings user={user} isProfile={false} />}\n          </ProCard.TabPane>\n        )} */}\n        {!isNew && (\n          <ProCard.TabPane\n            key={'logs'}\n            tab={\n              <span>\n                <FormattedMessage id=\"user_logs\" />\n              </span>\n            }\n          >\n            {user && <LogsWidget useAsWidget userID={Number(user)} />}\n          </ProCard.TabPane>\n        )}\n      </ProCard>\n    </PageContainer>\n  );\n};\n"],"sourceRoot":""}