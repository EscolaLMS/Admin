"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[2489,2803,8047],{76578:function(Zt,ve,t){t.r(ve),t.d(ve,{default:function(){return yt}});var Te=t(15009),I=t.n(Te),De=t(97857),d=t.n(De),Ne=t(99289),K=t.n(Ne),Ie=t(5574),b=t.n(Ie),$=t(78715),j=t(952),ee=t(5966),we=t(31199),Ae=t(64317),he=t(50335),pe=t(90672),Oe=t(2453),Re=t(74330),xe=t(71230),je=t(15746),u=t(67294),Me=t(19411),Fe=t(74453),Pe=t(44167),a=t(80854),de=t(28694),Ee=t(23535),Ue=t(19632),U=t.n(Ue),Ve=t(49677),Be=t.n(Ve),$e=t(62235),Je=t(53682),Ge=t(51042),We=t(47389),He=t(82061),L=t(1413),Le=t(39055),Ke=t(84089),ze=function(c,n){return u.createElement(Ke.Z,(0,L.Z)((0,L.Z)({},c),{},{ref:n,icon:Le.Z}))},Qe=u.forwardRef(ze),Ye=Qe,Xe=t(16894),ke=t(78957),oe=t(14726),qe=t(86738),_e=t(83062),et=t(62748),le=t(43443),tt=t(37476),ye=t(45987),at=t(86190),Se=t(66758),Ze=t(11547),e=t(85893),rt=["fieldProps","proFieldProps"],st=["fieldProps","proFieldProps"],be="time",nt=u.forwardRef(function(y,c){var n=y.fieldProps,w=y.proFieldProps,i=(0,ye.Z)(y,rt),A=(0,u.useContext)(Se.Z);return(0,e.jsx)(Ze.Z,(0,L.Z)({ref:c,fieldProps:(0,L.Z)({getPopupContainer:A.getPopupContainer},n),valueType:"timeRange",proFieldProps:w,filedConfig:{valueType:"timeRange",customLightMode:!0,lightFilterLabelFormatter:function(M){return(0,at.c)(M,"HH:mm:ss")}}},i))}),it=function(c){var n=c.fieldProps,w=c.proFieldProps,i=(0,ye.Z)(c,st),A=(0,u.useContext)(Se.Z);return(0,e.jsx)(Ze.Z,(0,L.Z)({fieldProps:(0,L.Z)({getPopupContainer:A.getPopupContainer},n),valueType:be,proFieldProps:w,filedConfig:{customLightMode:!0,valueType:be}},i))},Ce=it;Ce.RangePicker=nt;var dt=Ce,ot=t(75842),lt=function(c){var n=(0,a.useIntl)(),w=c.visible,i=c.fields,A=c.onVisibleChange,p=c.onFinish,M=c.id,Q=ot.Z.useForm(),J=b()(Q,1),f=J[0];return(0,u.useEffect)(function(){if(i){f.setFieldsValue(i);return}f.resetFields()},[i]),(0,e.jsx)(tt.Y,{form:f,title:n.formatMessage({id:M?"editSetting":"newSetting",defaultMessage:M?"editSetting":"newSetting"}),width:"40vw",visible:w,onVisibleChange:function(V){A(V),f.resetFields()},onFinish:function(V){return f.resetFields(),p(d()(d()({},V),{},{id:(i==null?void 0:i.id)||null}))},children:(0,e.jsxs)(j.ZP.Group,{children:[(0,e.jsx)(ee.Z,{label:(0,e.jsx)(a.FormattedMessage,{id:"title",defaultMessage:"title"}),rules:[{required:!0}],width:"lg",name:"title"}),(0,e.jsx)(ee.Z,{label:(0,e.jsx)(a.FormattedMessage,{id:"subtitle",defaultMessage:"subtitle"}),rules:[{required:!0}],width:"lg",name:"subtitle"}),(0,e.jsx)(dt,{name:"hour",label:(0,e.jsx)(a.FormattedMessage,{id:"hour",defaultMessage:"hour"}),rules:[{required:!0}],width:"xs"}),(0,e.jsx)(j.ZP.Item,{name:"tutors",label:(0,e.jsx)(a.FormattedMessage,{id:"tutors"}),rules:[{required:!0}],convertValue:function(V){return V},valuePropName:"value",children:(0,e.jsx)(Pe.Z,{multiple:!0})}),(0,e.jsx)(pe.Z,{label:(0,e.jsx)(a.FormattedMessage,{id:"description",defaultMessage:"description"}),rules:[{required:!1}],width:"lg",name:"description"}),(0,e.jsx)(j.ZP.Item,{name:"asCandidate",hidden:!0})]})})},ut=lt,ct=(0,le.W8)(function(y){return(0,e.jsx)("tr",d()({},y))}),mt=(0,le.JN)(function(y){return(0,e.jsx)("tbody",d()({},y))}),gt=(0,le.W6)(function(){return(0,e.jsx)(Je.Z,{style:{cursor:"grab",color:"#999"}})}),ft=function(c){var n=c.data,w=c.onCreate,i=c.lastDataUpdateDate,A=(0,u.useRef)(),p=(0,u.useRef)(null),M=(0,a.useIntl)(),Q=(0,u.useState)([]),J=b()(Q,2),f=J[0],G=J[1],V=(0,u.useState)(null),Y=b()(V,2),ue=Y[0],O=Y[1],ce=(0,u.useState)(!1),X=b()(ce,2),S=X[0],R=X[1],me=(0,u.useState)(n),te=b()(me,2),k=te[0],ae=te[1],re=(0,u.useState)([]),se=b()(re,2),E=se[0],W=se[1],ge=(0,u.useState)(!1),H=b()(ge,2),C=H[0],g=H[1],F=[{title:"Sort",dataIndex:"sort",width:"5%",className:"drag-visible",render:function(){return(0,e.jsx)(gt,{})}},{width:"20%",title:(0,e.jsx)(a.FormattedMessage,{id:"title",defaultMessage:"Title"}),dataIndex:"title",hideInSearch:!0,renderText:function(s){return s.length>80?"".concat(s.slice(0,77),"..."):s}},{width:"20%",title:(0,e.jsx)(a.FormattedMessage,{id:"subtitle",defaultMessage:"subtitle"}),dataIndex:"subtitle",hideInSearch:!0,renderText:function(s){return s.length>80?"".concat(s.slice(0,77),"..."):s}},{width:"10%",title:(0,e.jsx)(a.FormattedMessage,{id:"hour",defaultMessage:"hour"}),dataIndex:"hour",hideInSearch:!0},{width:"15%",title:(0,e.jsx)(a.FormattedMessage,{id:"tutors",defaultMessage:"tutors"}),dataIndex:"tutors",hideInSearch:!0,render:function(s,r){var o=r.tutors;return o&&(0,e.jsx)(ke.Z,{children:o.map(function(m){return(0,e.jsx)($e.Z,{type:"App\\Models\\User",type_id:m},m)})})}},{width:"18%",title:(0,e.jsx)(a.FormattedMessage,{id:"description",defaultMessage:"description"}),dataIndex:"description",hideInSearch:!0,renderText:function(s){return s?s.length>80?"".concat(s.trim().slice(0,77),"..."):s.trim():"-"}}],B=function(s){var r=s.oldIndex,o=s.newIndex;if(r!==o){var m=(0,et.q)(f.slice(),r,o).filter(Boolean);G(m)}},T=function(s){return(0,e.jsx)(mt,d()({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:B},s))},D=function(s){var r,o=Object.assign({},(Be()(s),s)),m=f.findIndex(function(P){var h=P.id;return h===o["data-row-key"]}),v=d()(d()({},o),{},{className:"".concat(o.className," ").concat((r=f[m])!==null&&r!==void 0&&r.asCandidate?"agenda-row-candidate":"")});return(0,e.jsx)(ct,d()({index:m},v))};return(0,u.useEffect)(function(){W([]),ae(n),O(null),g(!1),p.current=null},[i]),(0,u.useEffect)(function(){K()(I()().mark(function l(){var s,r,o,m,v;return I()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!(!k||!E)){h.next=2;break}return h.abrupt("return");case 2:s=[].concat(U()(k),U()(E)),r=s.reduce(function(x,Z,N,q){var ne=q.filter(function(_){var fe=_.id;return fe===Z.id});if(ne.length>1){var ie=ne.find(function(_){return"asCandidate"in _});if(!ie)return[].concat(U()(x),[ne[-1]]);var St=ie&&x.find(function(_){var fe=_.id;return fe===ie.id});return St?x:[].concat(U()(x),[ie])}return[].concat(U()(x),[ne[0]])},[]),o=f.length?r.filter(function(x){var Z=x.id;return f.findIndex(function(N){return N.id===Z})===-1}):[],m=f.length?f.map(function(x){var Z=r.findIndex(function(N){var q=N.id;return q===x.id});return r[Z]}):r,v=[].concat(U()(m),U()(o)),G(v.filter(Boolean));case 8:case"end":return h.stop()}},l)}))()},[k,E]),(0,u.useEffect)(function(){var l=f.map(function(o){var m=o.id,v=o.title,P=o.subtitle,h=o.hour,x=o.description,Z=o.tutors;return{id:m,title:v,subtitle:P,hour:h,description:x,tutors:Z}});w(JSON.stringify(l));var s=f.map(function(o){var m=o.id;return m});if(p.current===null){if(!s.length)return;p.current=s}if(s.length>p.current.length){var r=JSON.stringify(s.slice(0,p.current.length))!==JSON.stringify(p.current);if(g(r),!r){p.current=s;return}}g(JSON.stringify(s)!==JSON.stringify(p.current))},[f]),(0,e.jsxs)(Fe._z,{header:{breadcrumb:{}},className:"agenda-container",children:[(0,e.jsx)(Xe.ZP,{className:"agenda-table",headerTitle:M.formatMessage({id:"agenda",defaultMessage:"Agenda"}),actionRef:A,rowKey:function(s){return s.id},search:!1,toolBarRender:function(){return[(0,e.jsxs)(oe.ZP,{type:"primary",onClick:function(){return R(!0)},children:[(0,e.jsx)(Ge.Z,{})," ",(0,e.jsx)(a.FormattedMessage,{id:"new",defaultMessage:"new"})]},"primary")]},pagination:!1,dataSource:f,columns:[].concat(F,[{width:"12%",hideInSearch:!0,title:(0,e.jsx)(a.FormattedMessage,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(s,r){return[(0,e.jsx)(oe.ZP,{type:"primary",icon:(0,e.jsx)(We.Z,{}),onClick:function(){if("asCandidate"in r){var m;O((m=E.find(function(P){var h=P.id;return h===r.id}))!==null&&m!==void 0?m:null)}else{var v;O((v=n.find(function(P){var h=P.id;return h===r.id}))!==null&&v!==void 0?v:null)}R(!0)}},"edit"),(0,e.jsx)(qe.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:K()(I()().mark(function o(){return I()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!("asCandidate"in r)){v.next=3;break}return W(function(P){return P.filter(function(h){var x=h.id;return x!==r.id})}),v.abrupt("return");case 3:ae(function(P){return P.filter(function(h){var x=h.id;return x!==r.id})});case 4:case"end":return v.stop()}},o)})),okText:(0,e.jsx)(a.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(a.FormattedMessage,{id:"no"}),children:(0,e.jsx)(_e.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(oe.ZP,{type:"primary",icon:(0,e.jsx)(He.Z,{}),danger:!0})})},"delete")]}}]),components:{body:{wrapper:T,row:D}}}),!!E.length&&(0,e.jsxs)("div",{className:"legend",children:[(0,e.jsx)("div",{className:"legend__dot"}),(0,e.jsx)("p",{className:"legend__label",children:(0,e.jsx)(a.FormattedMessage,{id:"changesToBeApproved",defaultMessage:"Changes to be approved"})})]}),C&&(0,e.jsxs)("div",{className:"legend",children:[(0,e.jsx)(Ye,{className:"legend__icon"}),(0,e.jsx)("p",{className:"legend__label",children:(0,e.jsx)(a.FormattedMessage,{id:"orderHasBeenChanged",defaultMessage:"Order has been changed"})})]}),(0,e.jsx)(ut,{name:S,visible:S,fields:ue,onVisibleChange:function(s){s===!1&&(R(!1),O(null))},onFinish:function(){var l=K()(I()().mark(function s(r){var o,m,v,P,h;return I()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(!r.id){Z.next=9;break}return o="asCandidate"in r,m=o?E:n,v=m.find(function(N){var q=N.id;return q===r.id}),P=v?JSON.stringify(v)!==JSON.stringify(r):!1,P&&(h=o?E.map(function(N){return N.id===r.id?r:N}):[].concat(U()(E),[d()(d()({},r),{},{asCandidate:!0})]),W(h)),O(null),R(!1),Z.abrupt("return");case 9:W(function(N){return[].concat(U()(N),[d()(d()({},r),{},{asCandidate:!0,id:Date.now()})])}),O(null),R(!1);case 12:case"end":return Z.stop()}},s)}));return function(s){return l.apply(this,arguments)}}()})]})},vt=ft,ht=t(7418),pt=t(53957),xt=function(c){var n=c.show;return n?(0,e.jsx)("p",{children:(0,e.jsx)(a.FormattedMessage,{id:"unsaved_changes"})}):(0,e.jsx)(e.Fragment,{})},jt=xt,Mt=t(54434),z=t(66419),Ft=t(29614),Pt=function(){var c,n=(0,a.useIntl)(),w=(0,a.useParams)(),i=w.id,A=w.tab,p=A===void 0?"attributes":A,M=i==="new",Q=(0,u.useState)(null),J=b()(Q,2),f=J[0],G=J[1],V=(0,u.useState)(!1),Y=b()(V,2),ue=Y[0],O=Y[1],ce=(0,u.useState)(),X=b()(ce,2),S=X[0],R=X[1],me=j.ZP.useForm(),te=b()(me,1),k=te[0],ae=(0,u.useState)(new Date),re=b()(ae,2),se=re[0],E=re[1],W=(0,Ft.f)(n),ge=(0,u.useCallback)(K()(I()().mark(function C(){var g,F;return I()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,de.lF)(Number(i));case 2:g=T.sent,g.success&&R(d()(d()({},g.data),{},{categories:g==null||(F=g.data)===null||F===void 0||(F=F.categories)===null||F===void 0?void 0:F.map(z.P1)}));case 4:case"end":return T.stop()}},C)})),[i]);(0,u.useEffect)(function(){if(M){R({name:"..."});return}ge()},[i]);var H=(0,u.useMemo)(function(){return{onFinish:function(){var C=K()(I()().mark(function F(B){var T,D,l;return I()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(T=d()(d()({},B),{},{agenda:f,authors:B.authors&&B.authors.map(z.i4),categories:B.categories&&B.categories.map(z.i4),image_url:S&&S.image_url,image_path:S&&S.image_path&&(0,z.Ox)(S.image_path)}),!M){r.next=8;break}return r.next=4,(0,de.Vf)(T);case 4:D=r.sent,D.success&&(O(!1),a.history.push("/other/stationary-events/".concat(D.data.id))),r.next=12;break;case 8:return r.next=10,(0,de.is)(Number(i),T);case 10:D=r.sent,D.success&&(O(!1),R(d()(d()({},D.data),{},{categories:(l=D)===null||l===void 0||(l=l.data)===null||l===void 0||(l=l.categories)===null||l===void 0?void 0:l.map(z.P1)})),E(new Date),a.history.push("/other/stationary-events/".concat(D.data.id,"/").concat(p)));case 12:Oe.ZP.success(D.message);case 13:case"end":return r.stop()}},F)}));function g(F){return C.apply(this,arguments)}return g}(),initialValues:S}},[S,i,p,f]);return S?(0,e.jsx)(Fe._z,{title:M?(0,e.jsx)(a.FormattedMessage,{id:"stationary_event"}):(0,e.jsx)(a.FormattedMessage,{id:"stationary_event.edit"}),header:{breadcrumb:{routes:[{path:"other/stationary-events",breadcrumbName:n.formatMessage({id:"menu.Other activities.StationaryEvents"})},{path:String(i),breadcrumbName:n.formatMessage({id:"form"})},{path:"/",breadcrumbName:n.formatMessage({id:i==="new"?"new":"edit"})},{path:String(p),breadcrumbName:n.formatMessage({id:String(p)})}]}},children:(0,e.jsxs)($.ZP,{tabs:{type:"card",activeKey:p,onChange:function(g){return a.history.push("/other/stationary-events/".concat(i,"/").concat(g))}},children:[(0,e.jsxs)($.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"attributes"}),children:[(0,e.jsx)(jt,{show:ue})," ",(0,e.jsxs)(j.ZP,d()(d()({},H),{},{form:k,onValuesChange:function(){O(!0)},children:[(0,e.jsxs)(j.ZP.Group,{children:[(0,e.jsx)(ee.Z,{width:"md",name:"name",label:(0,e.jsx)(a.FormattedMessage,{id:"name"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"name_tooltip"}),placeholder:n.formatMessage({id:"name",defaultMessage:"name"}),required:!0,rules:[{validator:W}]}),(0,e.jsx)(ee.Z,{width:"md",name:"place",label:(0,e.jsx)(a.FormattedMessage,{id:"place"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"place_tooltip"}),placeholder:n.formatMessage({id:"place",defaultMessage:"place"}),required:!0,rules:[{validator:W}]}),(0,e.jsx)(j.ZP.Item,{name:"authors",label:(0,e.jsx)(a.FormattedMessage,{id:"tutor"}),valuePropName:"value",children:(0,e.jsx)(Pe.Z,{multiple:!0})}),(0,e.jsx)(we.Z,{width:"xs",name:"max_participants",label:(0,e.jsx)(a.FormattedMessage,{id:"max_participants"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"max_participants_tooltip"}),placeholder:n.formatMessage({id:"max_participants",defaultMessage:"max_participants"}),min:0,max:9999,fieldProps:{step:1}}),(0,e.jsx)(Ae.Z,{name:"status",width:"md",label:(0,e.jsx)(a.FormattedMessage,{id:"status"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"status_consultation_tooltip"}),valueEnum:{draft:n.formatMessage({id:"draft",defaultMessage:"draft"}),published:n.formatMessage({id:"published",defaultMessage:"published"}),archived:n.formatMessage({id:"archived",defaultMessage:"archived"})},placeholder:n.formatMessage({id:"status"}),rules:[{required:!0,message:(0,e.jsx)(a.FormattedMessage,{id:"select"}),validator:function(g,F){return F?Promise.resolve():Promise.reject(new Error(n.formatMessage({id:"select"})))}}]})]}),(0,e.jsxs)(j.ZP.Group,{children:[(0,e.jsx)(he.Z,{width:"sm",name:"started_at",label:(0,e.jsx)(a.FormattedMessage,{id:"started_at"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"started_at_tooltip"}),placeholder:n.formatMessage({id:"started_at",defaultMessage:"started_at"})}),(0,e.jsx)(he.Z,{width:"sm",name:"finished_at",label:(0,e.jsx)(a.FormattedMessage,{id:"finished_at"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"finished_at_tooltip"}),placeholder:n.formatMessage({id:"finished_at",defaultMessage:"finished_at"})})]}),(0,e.jsx)(j.ZP.Group,{children:(0,e.jsx)(pe.Z,{width:"lg",name:"short_desc",label:(0,e.jsx)(a.FormattedMessage,{id:"short_description"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"short_description"})})}),(0,e.jsx)(j.ZP.Item,{name:"program",label:(0,e.jsx)(a.FormattedMessage,{id:"program"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"program_tooltip"}),valuePropName:"value",children:(0,e.jsx)(Me.ZP,{directory:"stationary_events/".concat(i,"/wysiwyg")})}),(0,e.jsx)(j.ZP.Item,{name:"description",label:(0,e.jsx)(a.FormattedMessage,{id:"description"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"description_tooltip"}),valuePropName:"value",children:(0,e.jsx)(Me.ZP,{directory:"stationary_events/".concat(i,"/wysiwyg")})})]}))]},"attributes")," ",!M&&(0,e.jsx)($.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"agenda"}),children:(0,e.jsx)(j.ZP,d()(d()({},H),{},{children:(0,e.jsx)(vt,{data:(c=S.agenda)!==null&&c!==void 0?c:[],onCreate:function(g){return G(g)},lastDataUpdateDate:se})}))},"agenda"),!M&&(0,e.jsx)($.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"product"}),children:i&&(0,e.jsx)(pt.C,{productable:{class_type:"App\\Models\\StationaryEvent",class_id:i,name:String(S.name),quantity:1}})},"product"),!M&&(0,e.jsx)($.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"media"}),children:(0,e.jsx)(j.ZP,d()(d()({},H),{},{children:(0,e.jsx)(Ee.Z,{folder:"stationary-events/".concat(i),title:"image",action:"/api/admin/stationary-events/".concat(i,"/?_method=PUT"),src_name:"image_url",form_name:"image",getUploadedSrcField:function(g){return g.file.response.data.image_url},setPath:function(g){return R(function(F){return d()(d()({},F),g)})}})}))},"media"),!M&&(0,e.jsx)($.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"categories"}),children:(0,e.jsx)(xe.Z,{children:(0,e.jsx)(je.Z,{span:12,children:(0,e.jsx)(j.ZP,d()(d()({},H),{},{children:(0,e.jsx)(j.ZP.Item,{label:(0,e.jsx)(a.FormattedMessage,{id:"categories"}),name:"categories",valuePropName:"value",children:(0,e.jsx)(ht.Z,{multiple:!1})})}))})})},"categories"),!M&&(0,e.jsx)($.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"user_submission"}),children:(0,e.jsx)(xe.Z,{children:(0,e.jsx)(je.Z,{span:12,children:i&&(0,e.jsx)(Mt.ZP,{id:Number(i),type:"App\\Models\\StationaryEvent"})})})},"user_submission")]})}):(0,e.jsx)(Re.Z,{})},yt=Pt}}]);

//# sourceMappingURL=p__StationaryEvents__form.4fc925a3.async.js.map