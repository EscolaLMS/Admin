(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{BiO0:function(_,m,e){"use strict";var i=e("VTBJ"),v=e("Ff2n"),b=e("nKUr"),E=e.n(b),D=e("q1tI"),g=e.n(D),R=e("adzw"),T=["fieldProps","proFieldProps"],d=function(N,k){var z=N.fieldProps,L=N.proFieldProps,C=Object(v.a)(N,T);return Object(b.jsx)(R.a,Object(i.a)({ref:k,valueType:"textarea",fieldProps:z,proFieldProps:L},C))};m.a=g.a.forwardRef(d)},CUYv:function(_,m,e){"use strict";e.r(m);var i=e("T2oS"),v=e("W9HT"),b=e("miYZ"),E=e("tsqr"),D=e("qLMh"),g=e("k1fw"),R=e("9og8"),T=e("tJVT"),d=e("q1tI"),f=e("VMEa"),N=e("Qurx"),k=e("F/zT"),z=e("BiO0"),L=e("nhC9"),C=e("GuVI"),W=e("0WSk"),q=e("tMyG"),u=e("9kvl"),ee=e("Ty5D"),Q=e("nRaC"),te=e("5RzL"),G=e("oBTY"),X=e("H6aw"),t=e("nKUr"),a=function H(h){return h.reduce(function(o,l){return[].concat(Object(G.a)(o),[{value:"EscolaLms\\Courses\\Lesson:".concat(l.id),title:l.title,label:l.title,children:l.lessons?H(l.lessons):[]}],Object(G.a)(l.topics?l.topics.map(function(p){return{value:"EscolaLms\\Courses\\Topic:".concat(p.id),title:"Unit: ".concat(p.title),label:p.title}}):[]))},[])},r=function(h){var o=h.value,l=h.onChange,p=Object(d.useState)([]),A=Object(T.a)(p,2),s=A[0],K=A[1];return Object(d.useEffect)(function(){Object(R.a)(Object(D.a)().mark(function F(){var P,S,U;return Object(D.a)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,Object(X.e)({page:-1,pageSize:100});case 2:if(P=y.sent,!P.success){y.next=9;break}return y.next=6,Promise.all(P.data.filter(function(j){return j.id}).map(function(j){return Object(X.m)(j.id)}));case 6:S=y.sent,U=S.filter(function(j){return j.success}).map(function(j){return{value:"EscolaLms\\Courses\\Course:".concat(j.success&&j.data.id),title:j.success?j.data.title:"",label:j.success?j.data.title:"",children:j.success?a(j.data.lessons):void 0}}),K(U);case 9:case"end":return y.stop()}},F)}))()},[]),Object(t.jsx)(te.a,{loading:s.length===0,treeLine:!0,showSearch:!0,style:{width:"100%"},value:o,dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"Please select",allowClear:!0,treeDefaultExpandAll:!0,onChange:function(P){return l&&l(P)},treeData:s})},O=e("Mwp2"),c=e("VXEj"),n=e("5NDa"),w=e("5rEg"),ce=e("+L6B"),ae=e("2/Rp"),re=function(h){var o,l,p=h.note,A=h.onRemoved,s=h.onEdited,K=h.taskId,F=Object(d.useState)(p.note),P=Object(T.a)(F,2),S=P[0],U=P[1];return Object(t.jsx)(c.b.Item,{actions:[Object(t.jsx)(ae.a,{size:"small",type:"primary",onClick:function(){return Object(C.j)(p.id,{task_id:K,note:S}).then(function(){s&&s()})},children:Object(t.jsx)(u.a,{id:"Notes.edit_note",defaultMessage:"Edit Note"})},"update"),Object(t.jsx)(ae.a,{size:"small",danger:!0,onClick:function(){return Object(C.e)(p.id).then(function(){A&&A()})},children:Object(t.jsx)(u.a,{id:"Notes.delete_note",defaultMessage:"Delete Note"})},"delete")],children:Object(t.jsx)(c.b.Item.Meta,{avatar:Object(t.jsxs)(d.Fragment,{children:[Object(t.jsx)(u.a,{id:"Notes.created_by",defaultMessage:"Created by"}),Object(t.jsx)("br",{}),(o=p.user)===null||o===void 0?void 0:o.first_name," ",(l=p.user)===null||l===void 0?void 0:l.last_name]}),description:Object(t.jsx)(w.a.TextArea,{value:S,onChange:function(y){return U(y.target.value)}})})})},se=function(h){var o=h.notes,l=h.onAdded,p=h.onRemoved,A=h.onEdited,s=h.taskId,K=Object(d.useState)(""),F=Object(T.a)(K,2),P=F[0],S=F[1],U=Object(d.useState)(!1),$=Object(T.a)(U,2),y=$[0],j=$[1],J=Object(d.useCallback)(function(){j(!0),Object(C.c)({task_id:s,note:P}).catch(function(Z){return console.log("err",Z)}).then(function(){S(""),l&&l()}).finally(function(){j(!1)})},[P,s]);return Object(t.jsx)("div",{children:Object(t.jsx)(c.b,{loading:y,itemLayout:"horizontal",dataSource:[].concat(Object(G.a)(o),[0]),renderItem:function(I){return Number.isInteger(I)?Object(t.jsx)(c.b.Item,{actions:[Object(t.jsx)(ae.a,{size:"small",type:"primary",onClick:function(){J()},children:Object(t.jsx)(u.a,{id:"Notes.create_note",defaultMessage:"Create Note"})},"new")],children:Object(t.jsx)(c.b.Item.Meta,{avatar:Object(t.jsx)(d.Fragment,{children:Object(t.jsx)(u.a,{id:"Notes.new_note",defaultMessage:"New note"})}),description:Object(t.jsx)(w.a.TextArea,{value:P,onChange:function(V){return S(V.target.value)}})})}):typeof I=="object"&&Object(t.jsx)(re,{taskId:s,note:I,onRemoved:function(){return p&&p()},onEdited:function(){return A&&A()}})}})})},ie=m.default=function(){var H=Object(u.l)(),h=Object(ee.l)(),o=h.task,l=o==="new",p=Object(d.useState)(),A=Object(T.a)(p,2),s=A[0],K=A[1],F=Object(d.useState)(!1),P=Object(T.a)(F,2),S=P[0],U=P[1],$=f.a.useForm(),y=Object(T.a)($,1),j=y[0],J=Object(d.useCallback)(Object(R.a)(Object(D.a)().mark(function I(){var M;return Object(D.a)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return U(!0),x.next=3,Object(C.f)(Number(o));case 3:M=x.sent,M.success&&K(Object(g.a)({},M.data)),U(!1);case 6:case"end":return x.stop()}},I)})),[o]);Object(d.useEffect)(function(){if(o==="new"){K({});return}J()},[o,J]);var Z=Object(d.useMemo)(function(){return{onFinish:function(){var I=Object(R.a)(Object(D.a)().mark(function V(x){var Y,ne;return Object(D.a)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(ne=Object(g.a)(Object(g.a)({},x),{},{related_id:x.related?x.related.split(":")[1]:void 0,related_type:x.related?x.related.split(":")[0]:void 0}),o!=="new"){B.next=8;break}return B.next=4,Object(C.b)(ne);case 4:Y=B.sent,Y.success&&u.f.push("/other/tasks/".concat(Y.data.id)),B.next=11;break;case 8:return B.next=10,Object(C.i)(Number(o),ne);case 10:Y=B.sent;case 11:E.b.success(Y.message);case 12:case"end":return B.stop()}},V)}));function M(V){return I.apply(this,arguments)}return M}(),initialValues:Object(g.a)(Object(g.a)({},s),{},{user_id:s&&s.user&&s.user.id?s.user.id:void 0,created_by_id:s&&s.created_by&&s.created_by.id?s.created_by.id:void 0,related:s!=null&&s.related_id&&s.related_type?"".concat(s.related_type,":").concat(s.related_id):void 0})}},[s,o]);return s?Object(t.jsx)(q.a,{title:l?Object(t.jsx)(u.a,{id:"new_task"}):Object(t.jsx)(u.a,{id:"edit_task"}),children:Object(t.jsx)(L.a,{children:Object(t.jsxs)(f.a,Object(g.a)(Object(g.a)({},Z),{},{form:j,children:[Object(t.jsxs)(f.a.Group,{children:[Object(t.jsx)(N.a,{width:"md",name:"title",label:Object(t.jsx)(u.a,{id:"title"}),tooltip:Object(t.jsx)(u.a,{id:"title"}),placeholder:H.formatMessage({id:"title"}),required:!0}),Object(t.jsx)(f.a.Item,{name:"user_id",label:Object(t.jsx)(u.a,{id:"assignee"}),tooltip:Object(t.jsx)(u.a,{id:"assignee"}),valuePropName:"value",required:!0,children:Object(t.jsx)(W.a,{})}),!l&&Object(t.jsx)(f.a.Item,{name:"created_by_id",label:Object(t.jsx)(u.a,{id:"created_by"}),tooltip:Object(t.jsx)(u.a,{id:"created_by"}),valuePropName:"value",children:Object(t.jsx)(W.a,{disabled:!0})}),!l&&Object(t.jsx)(k.a,{name:"completed_at",label:Object(t.jsx)(u.a,{id:"completed_at",defaultMessage:"Completed"}),tooltip:Object(t.jsx)(u.a,{id:"completed_at_tooltip",defaultMessage:"Completed"}),fieldProps:{onChange:function(M){(M?Object(C.a)(Number(o)):Object(C.g)(Number(o))).then(function(V){E.b.success(V.message)})}}})]}),Object(t.jsx)(N.a,{name:"related",shouldUpdate:!0,hidden:!0}),Object(t.jsx)(f.a.Item,{label:Object(t.jsx)(u.a,{id:"relates_to",defaultMessage:"Relates to"}),tooltip:Object(t.jsx)(u.a,{id:"relates_to_tooltip",defaultMessage:"Relates to"}),shouldUpdate:!0,children:function(M){return Object(t.jsx)(r,{value:M.getFieldValue("related"),onChange:function(x){M.setFieldValue("related",x)}})}}),Object(t.jsx)(z.a,{width:"md",name:"description",label:Object(t.jsx)(u.a,{id:"description"}),tooltip:Object(t.jsx)(u.a,{id:"description"}),placeholder:H.formatMessage({id:"description"})}),!l&&Object(t.jsx)(L.a,{title:"notes",bordered:!0,children:s.notes&&Object(t.jsx)(se,{notes:s.notes,taskId:Number(o),onAdded:function(){return J()},onEdited:function(){return J()},onRemoved:function(){return J()}})}),S&&Object(t.jsx)(v.a,{})]}))})}):Object(t.jsx)(v.a,{})}},"F/zT":function(_,m,e){"use strict";var i=e("VTBJ"),v=e("Ff2n"),b=e("nKUr"),E=e.n(b),D=e("q1tI"),g=e.n(D),R=e("adzw"),T=["fieldProps","unCheckedChildren","checkedChildren","proFieldProps"],d=g.a.forwardRef(function(f,N){var k=f.fieldProps,z=f.unCheckedChildren,L=f.checkedChildren,C=f.proFieldProps,W=Object(v.a)(f,T);return Object(b.jsx)(R.a,Object(i.a)({valueType:"switch",fieldProps:Object(i.a)({unCheckedChildren:z,checkedChildren:L},k),ref:N,valuePropName:"checked",proFieldProps:C,filedConfig:{valuePropName:"checked",ignoreWidth:!0}},W))});m.a=d},GuVI:function(_,m,e){"use strict";e.d(m,"h",function(){return D}),e.d(m,"d",function(){return R}),e.d(m,"f",function(){return d}),e.d(m,"b",function(){return N}),e.d(m,"i",function(){return z}),e.d(m,"a",function(){return C}),e.d(m,"g",function(){return q}),e.d(m,"c",function(){return ee}),e.d(m,"j",function(){return te}),e.d(m,"e",function(){return X});var i=e("qLMh"),v=e("k1fw"),b=e("9og8"),E=e("9kvl");function D(a,r){return g.apply(this,arguments)}function g(){return g=Object(b.a)(Object(i.a)().mark(function a(r,O){return Object(i.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(E.i)("/api/admin/tasks",Object(v.a)({method:"GET",params:Object(v.a)(Object(v.a)({},r),{},{per_page:r.pageSize,page:r.current})},O||{})));case 1:case"end":return n.stop()}},a)})),g.apply(this,arguments)}function R(a,r){return T.apply(this,arguments)}function T(){return T=Object(b.a)(Object(i.a)().mark(function a(r,O){return Object(i.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(E.i)("/api/admin/tasks/".concat(r),Object(v.a)({method:"DELETE"},O||{})));case 1:case"end":return n.stop()}},a)})),T.apply(this,arguments)}function d(a,r){return f.apply(this,arguments)}function f(){return f=Object(b.a)(Object(i.a)().mark(function a(r,O){return Object(i.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(E.i)("/api/admin/tasks/".concat(r),Object(v.a)({method:"GET"},O||{})));case 1:case"end":return n.stop()}},a)})),f.apply(this,arguments)}function N(a){return k.apply(this,arguments)}function k(){return k=Object(b.a)(Object(i.a)().mark(function a(r){return Object(i.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(E.i)("/api/admin/tasks",{method:"POST",data:r}));case 1:case"end":return c.stop()}},a)})),k.apply(this,arguments)}function z(a,r,O){return L.apply(this,arguments)}function L(){return L=Object(b.a)(Object(i.a)().mark(function a(r,O,c){return Object(i.a)().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",Object(E.i)("/api/admin/tasks/".concat(r),Object(v.a)({method:"PATCH",data:O},c||{})));case 1:case"end":return w.stop()}},a)})),L.apply(this,arguments)}function C(a,r){return W.apply(this,arguments)}function W(){return W=Object(b.a)(Object(i.a)().mark(function a(r,O){return Object(i.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(E.i)("/api/admin/tasks/complete/".concat(r),Object(v.a)({method:"POST"},O||{})));case 1:case"end":return n.stop()}},a)})),W.apply(this,arguments)}function q(a,r){return u.apply(this,arguments)}function u(){return u=Object(b.a)(Object(i.a)().mark(function a(r,O){return Object(i.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(E.i)("/api/admin/tasks/incomplete/".concat(r),Object(v.a)({method:"POST"},O||{})));case 1:case"end":return n.stop()}},a)})),u.apply(this,arguments)}function ee(a){return Q.apply(this,arguments)}function Q(){return Q=Object(b.a)(Object(i.a)().mark(function a(r){return Object(i.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(E.i)("/api/admin/tasks/notes",{method:"POST",data:r}));case 1:case"end":return c.stop()}},a)})),Q.apply(this,arguments)}function te(a,r){return G.apply(this,arguments)}function G(){return G=Object(b.a)(Object(i.a)().mark(function a(r,O){return Object(i.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(E.i)("/api/admin/tasks/notes/".concat(r),{method:"PATCH",data:O}));case 1:case"end":return n.stop()}},a)})),G.apply(this,arguments)}function X(a){return t.apply(this,arguments)}function t(){return t=Object(b.a)(Object(i.a)().mark(function a(r){return Object(i.a)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Object(E.i)("/api/admin/tasks/notes/".concat(r),{method:"DELETE"}));case 1:case"end":return c.stop()}},a)})),t.apply(this,arguments)}}}]);
