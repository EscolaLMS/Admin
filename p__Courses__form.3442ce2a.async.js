(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4981,2803,8047,2238],{11312:function(mt,Be,t){"use strict";t.d(Be,{nu:function(){return B},rL:function(){return H},Du:function(){return me}});var ze=t(9783),I=t.n(ze),$e=t(97857),W=t.n($e),Ae=t(19632),y=t.n(Ae),fe=t(5574),d=t.n(fe),_e=t(45919),N=t(66419),ae=t(78677),j=t(26271),be=t(78957),O=t(66309),ie=t(72051),V=t(71230),z=t(72269),Z=t(83863),l=t(60943),n=t(67294),K=t(70804),e=t(80854),oe=t(62235),re=t(15009),ve=t.n(re),b=t(99289),Fe=t.n(b),ke=t(58638),Re=t(14726),G=t(76841),g=t(85893),m=function(ee){var P=ee.course_id,T=ee.stat,te=T===void 0?"EscolaLms\\Reports\\Stats\\Course\\FinishedTopics":T,Ee=(0,n.useState)(!1),J=d()(Ee,2),E=J[0],F=J[1],X=(0,n.useCallback)(function(k){return Fe()(ve()().mark(function de(){var ue,he;return ve()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return F(!0),S.prev=1,S.next=4,(0,G._g)(k,{stat:te});case 4:ue=S.sent,ue instanceof Blob&&(he=document.createElement("a"),he.href=window.URL.createObjectURL(ue),he.download="finished_topics_".concat(P,".xlsx"),document.body.appendChild(he),he.click(),document.body.removeChild(he)),S.next=11;break;case 8:S.prev=8,S.t0=S.catch(1),console.error(S.t0);case 11:return S.prev=11,F(!1),S.finish(11);case 14:case"end":return S.stop()}},de,null,[[1,8,11,14]])}))},[te]);return(0,g.jsxs)(Re.ZP,{type:"primary",loading:E,onClick:X(P),children:[(0,g.jsx)(ke.Z,{})," ",(0,g.jsx)(e.FormattedMessage,{id:"export"})]})},U=function(ee){return ee.topicable.content.contents?Object.values(ee.topicable.content.contents)[0].library:"H5P"},me=function(ee){var P=ee.course_id,T=ee.topics,te=ee.stats,Ee=(0,n.useState)(!1),J=d()(Ee,2),E=J[0],F=J[1],X=(0,n.useMemo)(function(){return[{title:(0,g.jsx)(e.FormattedMessage,{id:"user"}),dataIndex:"id",render:function(ue){return(0,g.jsx)(oe.Z,{type:"App\\Models\\User",type_id:ue})}},{title:(0,g.jsx)(e.FormattedMessage,{id:"email"}),dataIndex:"email"}].concat(y()(T.map(function(de){var ue,he=(ue=de.topicable_type)===null||ue===void 0?void 0:ue.split("\\").pop();return he==="H5P"&&(he=U(de)),{render:function(S){var De=0;switch(S&&(S.started_at&&S.finished_at?De=1:S.started_at&&(De=2)),De){case 1:return(0,g.jsxs)(be.Z,{children:[(0,g.jsx)(O.Z,{color:"success",children:"F"}),E&&(S==null?void 0:S.seconds)&&(0,g.jsx)("small",{children:(0,N.Im)(S.seconds)})]});case 2:return(0,g.jsxs)(be.Z,{children:[(0,g.jsx)(O.Z,{color:"blue",children:"S"}),E&&(S==null?void 0:S.seconds)&&(0,g.jsx)("small",{children:(0,N.Im)(S.seconds)})]});case 0:default:return(0,g.jsx)(n.Fragment,{children:(0,g.jsx)(O.Z,{color:"error",children:"N"})})}},title:(0,g.jsxs)("small",{children:[(0,g.jsx)(O.Z,{children:he})," ",de.title]}),dataIndex:de.id}})))},[T,E]),k=(0,n.useMemo)(function(){return te.map(function(de){return T.reduce(function(ue,he){var Me=de.topics.find(function(S){return S.id===he.id});return W()(W()({},ue),{},I()({},Number(he.id),Me!=null?Me:0))},{email:de.email,id:de.id})})},[te,T]);return(0,g.jsx)(ie.Z,{title:function(){return(0,g.jsxs)(V.Z,{justify:"space-between",align:"middle",children:[(0,g.jsxs)(be.Z,{children:[(0,g.jsx)(e.FormattedMessage,{id:"Finished",defaultMessage:"Finished:"})," ",(0,g.jsx)(O.Z,{color:"success",children:"F"}),(0,g.jsx)(e.FormattedMessage,{id:"Started",defaultMessage:"Started:"})," ",(0,g.jsx)(O.Z,{color:"blue",children:"S"}),(0,g.jsx)(e.FormattedMessage,{id:"NotStarted",defaultMessage:"Not Started:"})," ",(0,g.jsx)(O.Z,{color:"error",children:"N"}),(0,g.jsx)(e.FormattedMessage,{id:"ShowMinutes",defaultMessage:"Show minutes spent on topic:"})," ",(0,g.jsx)(z.Z,{checked:E,onChange:function(he){return F(he)}})]}),(0,g.jsx)(m,{course_id:P})]})},columns:X,dataSource:k,size:"small",scroll:{x:1500},components:{table:function(ue){return(0,g.jsx)(K.Z,{horizontal:!0,style:{maxWidth:"auto"},hideScrollbars:!1,children:(0,g.jsx)("table",W()({},ue))})}}})},H=function(ee){var P=ee.stats,T=ee.attempts,te=(0,n.useMemo)(function(){return[{title:(0,g.jsx)(e.FormattedMessage,{id:"user"}),dataIndex:"id",render:function(E){return(0,g.jsx)(oe.Z,{type:"App\\Models\\User",type_id:E})}},{title:(0,g.jsx)(e.FormattedMessage,{id:"email"}),dataIndex:"email"},{title:(0,g.jsx)(e.FormattedMessage,{id:"attempt",defaultMessage:"Attempt"}),dataIndex:"attempt"},{title:(0,g.jsx)(e.FormattedMessage,{id:"finished_at",defaultMessage:"Finished at"}),dataIndex:"finished_at",render:function(E){return E?(0,l.WU)(new Date(E),_e.Cu):""}}]},[]),Ee=(0,n.useMemo)(function(){return P.map(function(J){var E=J.id,F=J.email,X=J.finished_at,k=T==null?void 0:T.find(function(ue){return ue.id===E}),de=Array.isArray(k==null?void 0:k.attempts)?k==null?void 0:k.attempts.length:0;return{id:E,email:F,finished_at:X,attempt:de}})},[P]);return(0,g.jsx)(ie.Z,{title:function(){return(0,g.jsx)(be.Z,{children:(0,g.jsx)(e.FormattedMessage,{id:"course.finished",defaultMessage:"Finished"})})},columns:te,dataSource:Ee,size:"small",scroll:{x:500}})},B=function(ee){var P=ee.stats,T=(0,n.useState)(null),te=d()(T,2),Ee=te[0],J=te[1],E=(0,n.useState)(null),F=d()(E,2),X=F[0],k=F[1],de=(0,e.useIntl)(),ue=(0,n.useMemo)(function(){return P.flatMap(function(Me){return Object.values(Me.attempts).flatMap(function(S){var De=S.dates,Qe=S.attempt,Oe=Object.values(De).flatMap(function(He){var Ke=He.date,Ge=He.seconds_total;return{date:Ke,attempt:Qe,seconds_total:Ge,email:Me.email}});return Oe})})},[P]),he={xField:"date",yField:"seconds_total",seriesField:"attempt",isStack:!0,xAxis:{label:{autoHide:!0,autoRotate:!1}},slider:{start:0,end:1},label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]}};return(0,g.jsx)(j.ZP,{title:(0,g.jsxs)(be.Z,{children:[(0,g.jsx)(e.FormattedMessage,{id:"course.interactions_time_in_days"}),(0,g.jsx)(Z.default,{showSearch:!0,value:Ee,onChange:function(S){J(S),k(null)},placeholder:(0,g.jsx)(e.FormattedMessage,{id:"select_person",defaultMessage:"Select a person"}),children:P.map(function(Me){var S=Me.id,De=Me.email;return(0,g.jsx)(Z.default.Option,{value:De,children:De},S)})}),(0,g.jsx)(Z.default,{value:X,onChange:function(S){return k(S)},disabled:Ee===null,placeholder:(0,g.jsx)(e.FormattedMessage,{id:"select_attempt",defaultMessage:"Select attempt"}),children:y()(new Set(ue.filter(function(Me){var S=Me.email;return S===Ee}).map(function(Me){var S=Me.attempt;return S}))).map(function(Me){return(0,g.jsxs)(Z.default.Option,{value:Me,children:[(0,g.jsx)(e.FormattedMessage,{id:"attempt",defaultMessage:"Attempt"})," ",Me]},Me)})})]}),colSpan:12,layout:"center",children:(0,g.jsx)("div",{style:{overflow:"auto",minHeight:"400px",width:"100%"},children:(0,g.jsx)(ae.Z,W()(W()({},he),{},{tooltip:{title:"".concat(de.formatMessage({id:"attempt"})),formatter:function(S){var De=Math.floor(+S.seconds_total/60),Qe=+S.seconds_total>60?+S.seconds_total-De*60:0;return{name:S.attempt,value:"".concat(De,"m ").concat(Qe,"s")}}},data:ue.filter(function(Me){var S=Me.email;return S===Ee}).filter(function(Me){var S=Me.attempt;return Number.isInteger(X)?S===X:!0})}))})})}},20568:function(mt,Be,t){"use strict";t.d(Be,{Z:function(){return oe}});var ze=t(19632),I=t.n(ze),$e=t(97857),W=t.n($e),Ae=t(5574),y=t.n(Ae),fe=t(67294),d=t(17578),_e=t(78957),N=t(25093),ae=t(96365),j=t(14726),be=t(2487),O=t(72252),ie=t(82061),V=t(55725),z=t(69753),Z=t(80854),l=t(29477),n=t(85893),K=function(ve){var b=ve.directory,Fe=ve.onUploaded;return(0,n.jsxs)(_e.Z,{align:"start",children:[(0,n.jsxs)(N.Z.Text,{children:[(0,n.jsx)(Z.FormattedMessage,{id:"pages.files.filesBrowser"}),(0,n.jsx)(N.Z.Text,{code:!0,children:b})]}),(0,n.jsx)(l.Z,{url:"/api/admin/file/upload",name:"file[]",data:{target:b},onUpload:function(Re){Re.success&&Fe(b,Re.data)}})]})},e=function(ve){var b=ve.defaultDirectory,Fe=b===void 0?"/":b,ke=ve.onFile,Re=ve.hideDeleteBtn,G=Re===void 0?!1:Re,g=ve.forceLoading,m=g===void 0?!1:g,U=(0,Z.useIntl)(),me=(0,fe.useState)({loading:!1,name:"",directory:Fe,current_page:1,data:void 0,per_page:1,last_page:1,total:0}),H=y()(me,2),B=H[0],L=H[1],ee=(0,fe.useRef)(),P=(0,fe.useCallback)(function(E){L(function(F){return W()(W()({},F),{},{loading:E})})},[]),T=(0,fe.useCallback)(function(E,F){E.success&&L(function(X){return W()(W()(W()({},X),E.data),{},{data:[{url:F.split("/").slice(0,-1).join("/"),name:"..",created_at:"",mime:"directory"}].concat(I()(E.data.data.map(function(k){return W()(W()({},k),{},{url:k.mime==="directory"?"".concat(F,"/").concat(k.name):k.url})}))).filter(function(k){return F==="/"||F===Fe?k.name!=="..":!0}),directory:F,loading:!1})})},[P]),te=(0,fe.useCallback)(function(E){var F,X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,k=function(){return ee.current&&ee.current.abort()};return k(),ee.current=new AbortController,P(!0),(0,d.QZ)({directory:E,page:X},{signal:(F=ee.current)===null||F===void 0?void 0:F.signal}).then(function(de){de.success&&T(de,E)}).catch(function(){return P(!1)}),function(){k()}},[P]);(0,fe.useEffect)(function(){return te(Fe)},[Fe,te]);var Ee=(0,fe.useCallback)(function(E){P(!0),(0,d.Od)(E).then(function(){te(B.directory)}).catch(function(){P(!1)})},[te,P,B.directory]),J=(0,fe.useCallback)(function(E,F){var X,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,de=function(){return ee.current&&ee.current.abort()};return de(),ee.current=new AbortController,P(!0),(0,d.ht)({directory:E,name:F,page:k},{signal:(X=ee.current)===null||X===void 0?void 0:X.signal}).then(function(ue){ue.success&&T(ue,E)}).catch(function(){return P(!1)}),function(){de()}},[P]);return(0,n.jsxs)("div",{className:"file-browser",children:[(0,n.jsxs)("div",{className:"file-browser__header",children:[(0,n.jsx)(ae.Z,{placeholder:U.formatMessage({id:"search_file"}),className:"file-browser__input",onChange:function(F){return L(function(X){return W()(W()({},X),{},{name:F.target.value})})},value:B.name}),(0,n.jsxs)("div",{children:[(0,n.jsx)(j.ZP,{className:"file-browser__button",onClick:function(){return te(B.directory)},children:(0,n.jsx)(Z.FormattedMessage,{id:"reset"})}),(0,n.jsx)(j.ZP,{className:"file-browser__button",type:"primary",onClick:function(){return J(B.directory,B.name)},children:(0,n.jsx)(Z.FormattedMessage,{id:"query"})})]})]}),(0,n.jsx)(be.Z,{loading:B.loading||m,size:"small",itemLayout:"horizontal",dataSource:B.data,header:(0,n.jsx)(K,{directory:B.directory,onUploaded:function(F,X){X&&(te(F),ke&&ke(X,F))}}),footer:(0,n.jsx)(K,{directory:B.directory,onUploaded:function(F,X){te(F),X&&ke&&ke(X,F)}}),renderItem:function(F){return(0,n.jsx)(be.Z.Item,{actions:F.mime!=="directory"&&!G?[(0,n.jsx)(j.ZP,{type:"default",danger:!0,icon:(0,n.jsx)(ie.Z,{}),size:"small",onClick:function(){return Ee(F.url)}},"dir")]:[],children:(0,n.jsx)(be.Z.Item.Meta,{avatar:F.mime==="directory"?(0,n.jsx)(j.ZP,{type:"primary",icon:(0,n.jsx)(V.Z,{}),size:"small",onClick:function(){return te(F.url)}}):(0,n.jsx)("a",{href:F.url,target:"_blank",rel:"noreferrer",children:(0,n.jsx)(j.ZP,{type:"default",icon:(0,n.jsx)(z.Z,{}),size:"small"})}),description:(0,n.jsx)(fe.Fragment,{children:(0,n.jsx)(j.ZP,{type:"text",size:"small",onClick:function(){return F.mime==="directory"?te(F.url):ke&&ke(F,B.directory)},children:F.name})})})})}}),(0,n.jsx)(O.Z,{pageSizeOptions:[],current:B.current_page,total:B.total,pageSize:B.per_page,onChange:function(F){return te(B.directory,F)}})]})},oe=e},89825:function(mt,Be,t){"use strict";t.d(Be,{Z:function(){return e}});var ze=t(26271),I=t(80854),$e=t(5574),W=t.n($e),Ae=t(50227),y=t(2453),fe=t(15746),d=t(71230),_e=t(38925),N=t(75081),ae=t(67294);function j(oe){var re=(0,ae.useRef)(oe);(0,ae.useEffect)(function(){var ve=function(){var Fe=localStorage.getItem("TOKEN");re.current(Fe)};return window.addEventListener("token_change",ve),function(){window.removeEventListener("token_change",ve)}},[])}var be=t(97704),O=t(85893),ie="h5p-editor",V=function(oe){return oe.TokenChanged="TOKEN_CHANGED",oe}(V||{}),z=function(re){var ve,b=document.getElementById(ie);if(!b){console.error("There is no iframe with id '".concat(ie,"'"));return}(ve=b.contentWindow)===null||ve===void 0||ve.postMessage({type:V.TokenChanged,token:re},"*")},Z=function(re){var ve=re.id,b=re.onSubmitted,Fe=re.onLoaded,ke=(0,ae.useState)(),Re=W()(ke,2),G=Re[0],g=Re[1],m=(0,ae.useState)(!1),U=W()(m,2),me=U[0],H=U[1],B=(0,ae.useState)(),L=W()(B,2),ee=L[0],P=L[1],T=(0,I.useIntl)(),te=T.locale.split("-")[0];j(z),(0,ae.useEffect)(function(){ve&&(H(!0),(0,be.RN)(ve==="new"?void 0:ve,te).then(function(J){J.success?(Fe&&Fe(J.data),g(J.data)):P(J.message)}).catch(function(J){return J&&P(J.toString())}).finally(function(){return H(!1)}))},[ve]);var Ee=(0,ae.useCallback)(function(J){H(!0),(0,be.x0)(J,ve==="new"?void 0:ve).then(function(E){E.success?(b(E.data.id),y.ZP.success((0,O.jsx)(I.FormattedMessage,{id:"h5p_edited",defaultMessage:"H5P Element edited and saved successfully"}))):P(E.message)}).catch(function(E){return E&&P(E.toString())}).finally(function(){return H(!1)})},[]);return G?(0,O.jsxs)(ae.Fragment,{children:[ee&&(0,O.jsx)(_e.Z,{message:ee,type:"error"}),G&&(0,O.jsx)(Ae.ContextlessEditor,{onError:function(E){return console.error(E)},state:G,allowSameOrigin:!0,onSubmit:Ee,loading:me,lang:te,iframeId:ie})]}):(0,O.jsx)(fe.Z,{children:(0,O.jsxs)(d.Z,{justify:"center",align:"middle",children:[ee&&(0,O.jsx)(_e.Z,{message:ee,type:"error"}),(0,O.jsx)(N.Z,{})]})})},l=Z,n=t(66340),K=function(re){var ve=re.defaultCard,b=ve===void 0?"edit":ve,Fe=re.id,ke=re.onSubmit,Re=re.onLoaded;return(0,O.jsxs)(ze.ZP,{tabs:{type:"card",defaultActiveKey:b},children:[(0,O.jsx)(ze.ZP.TabPane,{disabled:!Fe,tab:(0,O.jsx)(I.FormattedMessage,{id:"edit"}),children:(0,O.jsx)(l,{id:Fe,onSubmitted:ke,onLoaded:Re},Fe)},"edit"),Fe!=="new"&&(0,O.jsx)(ze.ZP.TabPane,{disabled:!Fe,tab:(0,O.jsx)(I.FormattedMessage,{id:"preview"}),children:(0,O.jsx)(n.Z,{id:Fe,onLoaded:Re})},"preview")]})},e=K},66340:function(mt,Be,t){"use strict";var ze=t(19632),I=t.n(ze),$e=t(5574),W=t.n($e),Ae=t(97704),y=t(50227),fe=t.n(y),d=t(25093),_e=t(15746),N=t(71230),ae=t(38925),j=t(75081),be=t(96074),O=t(67294),ie=t(55171),V=t.n(ie),z=t(80854),Z=t(85893),l=d.Z.Title,n=function(e){var oe=e.id,re=e.onXAPI,ve=e.onLoaded,b=(0,O.useState)(),Fe=W()(b,2),ke=Fe[0],Re=Fe[1],G=(0,O.useState)(!1),g=W()(G,2),m=g[0],U=g[1],me=(0,O.useState)([]),H=W()(me,2),B=H[0],L=H[1],ee=(0,O.useState)(),P=W()(ee,2),T=P[0],te=P[1],Ee=(0,z.useIntl)(),J=Ee.locale.split("-")[0];return(0,O.useEffect)(function(){oe&&(U(!0),(0,Ae.LK)(oe,J).then(function(E){E.success?(ve&&ve(E.data),Re(E.data)):te(E.message)}).catch(function(E){return E&&te(E.toString())}).finally(function(){return U(!1)}))},[oe]),ke?(0,Z.jsxs)(O.Fragment,{children:[T&&(0,Z.jsx)(ae.Z,{message:T,type:"error"}),(0,Z.jsx)(y.ContextlessPlayer,{contentId:oe,onError:function(F){return console.error(F)},state:ke,allowSameOrigin:!0,loading:m,onXAPI:function(F){re?re(F):L(function(X){return[].concat(I()(X),[F])})}}),!re&&(0,Z.jsxs)(O.Fragment,{children:[(0,Z.jsx)(be.Z,{}),(0,Z.jsxs)("div",{style:{overflow:"auto",maxHeight:"400px"},children:[(0,Z.jsx)(l,{level:5,children:"XAPI Events"}),(0,Z.jsx)(V(),{src:B})]})]})]}):(0,Z.jsx)(_e.Z,{children:(0,Z.jsxs)(N.Z,{justify:"center",align:"middle",children:[T&&(0,Z.jsx)(ae.Z,{message:T,type:"error"}),(0,Z.jsx)(j.Z,{})]})})};Be.Z=n},9412:function(mt,Be,t){"use strict";var ze=t(29477),I=t(67294),$e=t(85893),W=function(y){var fe=y.onSuccess,d=y.onError,_e=y.hideLabel;return(0,$e.jsx)(ze.Z,{url:"/api/admin/hh5p/content/upload",name:"h5p_file",accept:".h5p",hideLabel:_e,onChange:function(ae){ae.file.status==="done"&&ae.file.response&&fe(ae.file.response),ae.file.status==="error"&&d()}})};Be.C=W},34201:function(mt,Be,t){"use strict";t.d(Be,{Z:function(){return H}});var ze=t(5574),I=t.n(ze),$e=t(38925),W=t(75081),Ae=t(96074),y=t(2487),fe=t(25093),d=t(14726),_e=t(67294),N=t(80854),ae=t(19632),j=t.n(ae),be=t(93162),O=t(55733),ie=t.n(O),V=t(85893),z=function(L){var ee=L.pdfIds,P=L.onProgress,T=L.onFinished,te=L.filename,Ee=te===void 0?"package.zip":te,J=(0,_e.useState)([]),E=I()(J,2),F=E[0],X=E[1],k=(0,_e.useCallback)(function(de){var ue=new(ie());de.forEach(function(he,Me){return ue.file("".concat(ee[Me],".pdf"),he)}),ue.generateAsync({type:"blob"}).then(function(he){(0,be.saveAs)(he,Ee),T&&T()})},[F,Ee]);return(0,_e.useEffect)(function(){ee.forEach(function(de){var ue=fetch("".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/pdfs/generate/").concat(de),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}});ue.then(function(he){return he.blob()}).then(function(he){he&&he instanceof Blob&&X(function(Me){var S=(Me.length+1)/ee.length;return P&&P(S),S>=1&&k([].concat(j()(Me),[he])),[].concat(j()(Me),[he])})})})},[ee]),(0,V.jsxs)("p",{children:["Progress ",F.length," / ",ee.length]})},Z=z,l=t(15009),n=t.n(l),K=t(97857),e=t.n(K),oe=t(99289),re=t.n(oe);function ve(B,L){return b.apply(this,arguments)}function b(){return b=re()(n()().mark(function B(L,ee){return n()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",(0,N.request)("/api/admin/pdfs",e()({params:e()({},L),method:"GET"},ee||{})));case 1:case"end":return T.stop()}},B)})),b.apply(this,arguments)}function Fe(B,L){return ke.apply(this,arguments)}function ke(){return ke=re()(n()().mark(function B(L,ee){return n()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",(0,N.request)("/api/pdfs/".concat(L),e()({method:"GET"},ee||{})));case 1:case"end":return T.stop()}},B)})),ke.apply(this,arguments)}function Re(B,L){return G.apply(this,arguments)}function G(){return G=_asyncToGenerator(_regeneratorRuntime().mark(function B(L,ee){return _regeneratorRuntime().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",request("/api/pdfs/generate/".concat(L),_objectSpread({method:"GET"},ee||{})));case 1:case"end":return T.stop()}},B)})),G.apply(this,arguments)}var g=t(62235),m=t(69753),U=t(19326),me=function(L){var ee=L.user_id,P=L.template_id,T=L.title,te=(0,_e.useState)({state:"initial"}),Ee=I()(te,2),J=Ee[0],E=Ee[1],F=(0,_e.useState)({state:"initial"}),X=I()(F,2),k=X[0],de=X[1],ue=(0,_e.useState)(!1),he=I()(ue,2),Me=he[0],S=he[1];(0,_e.useEffect)(function(){E({state:"loading"});var Qe=new AbortController;return ve({user_id:ee,template_id:P},{signal:Qe.signal}).then(function(Oe){Oe&&Oe.success?E({state:"loaded",list:Oe.data}):Oe&&!Oe.success&&E({state:"error",error:Oe.message})}).catch(function(Oe){return E({state:"error",error:Oe.toString()})}),function(){Qe.abort()}},[]);var De=(0,_e.useCallback)(function(Qe){de({state:"loading"}),Fe(Qe).then(function(Oe){Oe.success?de({state:"loaded",data:Oe.data.content}):de({state:"initial"})})},[]);return J.state==="error"?(0,V.jsx)($e.Z,{message:"Error Text",type:"error"}):J.state==="loading"||J.state==="initial"?(0,V.jsx)(W.Z,{}):(0,V.jsxs)(_e.Fragment,{children:[(0,V.jsx)(Ae.Z,{}),Me&&(0,V.jsx)(Z,{pdfIds:J.list.map(function(Qe){return Qe.id}),onFinished:function(){return S(!1)}}),(0,V.jsx)(y.Z,{size:"small",itemLayout:"horizontal",dataSource:J.list,header:(0,V.jsxs)("div",{children:[(0,V.jsx)(N.FormattedMessage,{id:"template"})," ",T&&(0,V.jsx)(fe.Z.Text,{strong:!0,children:T}),". ",(0,V.jsx)(N.FormattedMessage,{id:"generated_pdfs",defaultMessage:"Generated PDFs"})," ",(0,V.jsx)(d.ZP,{loading:Me,type:"primary",onClick:function(){return S(!0)},icon:(0,V.jsx)(m.Z,{}),size:"small",children:(0,V.jsx)(N.FormattedMessage,{id:"download_all",defaultMessage:"Download all PDFs"})})]}),renderItem:function(Oe){return(0,V.jsxs)(y.Z.Item,{actions:[(0,V.jsx)(U.Z,{url:"/api/pdfs/generate/".concat(Oe.id),filename:"generated-".concat(Oe.id,".pdf"),size:"small",icon:(0,V.jsx)(m.Z,{}),type:"primary",onClick:function(){return De(Oe.id)},loading:k.state==="loading",children:(0,V.jsx)(N.FormattedMessage,{id:"download_pdf",defaultMessage:"Download PDFs"})},"download")],children:[Oe.title," ",(0,V.jsx)(g.Z,{type:"App\\Models\\User",type_id:Oe.user_id})]})}})]})},H=me},87366:function(mt,Be,t){"use strict";t.d(Be,{Il:function(){return Re},_y:function(){return Z},uS:function(){return K}});var ze=t(15009),I=t.n(ze),$e=t(99289),W=t.n($e),Ae=t(5574),y=t.n(Ae),fe=t(97857),d=t.n(fe),_e=t(19632),N=t.n(_e),ae=t(2453),j=t(67294),be=t(80854),O=t(99100),ie=t(31472),V=t(36309),z=t(85893),Z=j.createContext({}),l=function(){return Math.round(Math.random()*99999)},n=function G(g){return g.reduce(function(m,U){return[].concat(N()(m),N()(U.lessons?G(U.lessons):[]),[U])},[])},K=function G(g){return g.reduce(function(m,U){var me;return[].concat(N()(m),N()(U.lessons?G(U.lessons):[]),N()((me=U.topics)!==null&&me!==void 0?me:[]))},[])},e=function G(g,m,U){return g.map(function(me){var H,B;return d()(d()({},me),{},{lessons:me.lessons?G(me.lessons,m,U):[],topics:me.id===m?[].concat(N()((H=me.topics)!==null&&H!==void 0?H:[]),[U]):(B=me.topics)!==null&&B!==void 0?B:[]})})},oe=function G(g,m,U){return U?g.map(function(me){return d()(d()({},me),{},{lessons:[].concat(N()(me.lessons?G(me.lessons,m,U):[]),N()(me.id===U?[m]:[]))})}):[].concat(N()(g),[m])},re=function G(g,m,U){return g.map(function(me){return d()(d()({},me.id===m?U:me),{},{lessons:me.lessons?G(me.lessons,m,U):[]})})},ve=function G(g,m){return g.map(function(U){return d()(d()({},U),{},{parent_id:m,lessons:U.lessons?G(U.lessons,U.id):[]})})},b=function G(g,m){return g.filter(function(U){return U.id!==m}).map(function(U){return d()(d()({},U),{},{lessons:U.lessons?G(U.lessons,m):[]})})},Fe=function G(g,m){return g.map(function(U){return d()(d()({},U),{},{lessons:U.lessons?G(U.lessons,m):[],topics:U.topics?U.topics.filter(function(me){return me.id!==m}):[]})})},ke=function G(g,m,U,me){return me==null?void 0:me.map(function(H){if(H.id===U){var B;return d()(d()({},H),{},{topics:(B=H.topics)===null||B===void 0?void 0:B.map(function(L){return L.id===g?m.file.response.data:L})})}else if(H.lessons)return d()(d()({},H),{},{lessons:G(g,m,U,H.lessons||[])});return H})},Re=function(g){var m=g.children,U=g.id,me=(0,j.useState)(),H=y()(me,2),B=H[0],L=H[1],ee=(0,be.useIntl)(),P=(0,j.useMemo)(function(){return B&&B.lessons?K(B.lessons):[]},[B]),T=(0,j.useMemo)(function(){return B&&B.lessons?n(B.lessons):[]},[B]),te=(0,j.useState)([]),Ee=y()(te,2),J=Ee[0],E=Ee[1],F=(0,j.useState)(!1),X=y()(F,2),k=X[0],de=X[1],ue=(0,be.useLocation)(),he=(0,j.useMemo)(function(){var xe=new URLSearchParams(ue.search);return{lesson:xe.get("lesson"),topic:xe.get("topic")}},[ue]),Me=(0,j.useCallback)(W()(I()().mark(function xe(){var Ne,le;return I()().wrap(function(Se){for(;;)switch(Se.prev=Se.next){case 0:return Se.next=2,(0,V.XU)({class_type:"EscolaLms\\Courses\\Models\\Lesson"});case 2:Ne=Se.sent,Ne.success&&(le=Ne.data.find(function(Ue){var st=Ue.name;return st==="assistant_id"}),de(!!(le!=null&&le.id)));case 4:case"end":return Se.stop()}},xe)})),[]);(0,j.useEffect)(function(){Me(),E([])},[]);var S=(0,j.useCallback)(function(){(0,O.Nx)(U).then(function(xe){return xe.success&&L(d()(d()({},xe.data),{},{lessons:ve(xe.data.lessons)}))})},[U]);(0,j.useEffect)(function(){S()},[S]);var De=(0,j.useCallback)(function(xe){var Ne=T.find(function(le){var Y;return le==null||(Y=le.topics)===null||Y===void 0?void 0:Y.find(function(Se){return Se.id===xe})});return Ne?Ne.id:null},[T]),Qe=(0,j.useMemo)(function(){return he.lesson?{mode:"lesson",id:Number(he.lesson),value:T.find(function(xe){return xe.id===Number(he.lesson)})}:he.topic?{mode:"topic",id:Number(he.topic),value:P.find(function(xe){return xe.id===Number(he.topic)})}:{mode:"init"}},[he,B,T,P]),Oe=(0,j.useCallback)(function(xe){var Ne={course_id:U,topics:[],isNew:!0,id:B?B.lessons.length+1:l(),order:0,title:ee.formatMessage({id:"add_title_here"}),active:!0,parent_id:xe};return L(function(le){var Y;return d()(d()({},le),{},{lessons:oe((Y=le==null?void 0:le.lessons)!==null&&Y!==void 0?Y:[],Ne,xe)})}),Ne},[U,B]),He=(0,j.useCallback)(function(xe,Ne){var le=T.find(function(Se){return Se.id===xe}),Y=le&&le.isNew;return(Y?(0,O.aA)(Ne):(0,O.sI)(xe,Ne)).then(function(Se){return ae.ZP.success(Se.message),S(),Se.success&&L(function(Ue){var st;return d()(d()({},Ue),{},{lessons:re((st=Ue==null?void 0:Ue.lessons)!==null&&st!==void 0?st:[],xe,d()(d()({},Se.data),{},{isNew:!1}))})})})},[B]),Ke=(0,j.useCallback)(function(xe){var Ne=T.find(function(Y){return Y.id===xe});if(Ne){var le=Ne.isNew;le?L(function(Y){var Se;return d()(d()({},Y),{},{lessons:b((Se=Y==null?void 0:Y.lessons)!==null&&Se!==void 0?Se:[],xe)})}):(0,O.iI)(xe).then(function(Y){Y.success&&(ae.ZP.success(Y.message),L(function(Se){var Ue;return d()(d()({},Se),{},{lessons:b((Ue=Se==null?void 0:Se.lessons)!==null&&Ue!==void 0?Ue:[],xe)})}))})}},[B]),Ge=(0,j.useCallback)(function(xe,Ne){var le,Y=De(xe),Se=T.find(function(dt){return dt.id===Y}),Ue=Se&&((le=Se.topics)===null||le===void 0?void 0:le.find(function(dt){return dt.id===xe})),st=Ue==null?void 0:Ue.isNew;return(st?(0,O.HV)(Ne):(0,O.Cn)(xe,Ne)).then(function(dt){dt.success&&(ae.ZP.success(dt.message),S(),be.history.push("/courses/list/".concat(U,"/program/?topic=").concat(dt.data.id)),(Ue==null?void 0:Ue.topicable_type)===ie.oz.Video&&setTimeout(function(){S()},5e3))})},[De,B,S]),lt=(0,j.useCallback)(function(xe){var Ne=De(xe),le=T.find(function(Ue){return Ue.id===Ne});if(le){var Y=P==null?void 0:P.find(function(Ue){return Ue.id===xe}),Se=Y==null?void 0:Y.isNew;Se&&!Y.topicable?L(function(Ue){var st;return d()(d()({},Ue),{},{lessons:Fe((st=Ue==null?void 0:Ue.lessons)!==null&&st!==void 0?st:[],xe)})}):(0,O.vJ)(xe).then(function(Ue){Ue.success&&(ae.ZP.success(Ue.message),L(function(st){var dt;return d()(d()({},st),{},{lessons:Fe((dt=st==null?void 0:st.lessons)!==null&&dt!==void 0?dt:[],xe)})}))})}},[B,De]),Pe=(0,j.useCallback)(function(xe,Ne){var le={lesson_id:xe,isNew:!0,id:l(),title:ee.formatMessage({id:"add_title_here"}),active:!0,topicable_type:Ne};return L(function(Y){var Se;return d()(d()({},Y),{},{lessons:e((Se=Y==null?void 0:Y.lessons)!==null&&Se!==void 0?Se:[],xe,le)})}),le},[]),rt=function(Ne,le){var Y=De(Ne);L(function(Se){return d()(d()({},Se),{},{lessons:Se?ke(Ne,le,Y,Se.lessons||[]):[]})}),be.history.push("/courses/list/".concat(U,"/program/?topic=").concat(le.file.response.data.id))},At=(0,j.useCallback)(function(xe){return(0,O.Cx)(xe).then(function(Ne){if(Ne.success){ae.ZP.success(Ne.message);var le=De(xe);L(function(Y){var Se;return d()(d()({},Y),{},{lessons:Y?(Se=Y.lessons)===null||Se===void 0?void 0:Se.map(function(Ue){if(Ue.id===le){var st=Ue.topics||[];return d()(d()({},Ue),{},{topics:[].concat(N()(st),[Ne.data])})}return Ue}):[]})})}})},[B,De]),bt=(0,j.useCallback)(function(xe){return(0,O.if)(xe).then(function(Ne){Ne.success&&(ae.ZP.success(Ne.message),L(function(le){return d()(d()({},le),{},{lessons:le?[].concat(N()(le.lessons),[Ne.data]):[]})}))})},[]),Jt={state:B,h5ps:J,id:U,addNewLesson:Oe,updateLesson:He,updateTopic:Ge,deleteLesson:Ke,addNewTopic:Pe,deleteTopic:lt,onTopicUploaded:rt,cloneTopic:At,cloneLesson:bt,currentEditMode:Qe,getLessons:S,isAssistant:k};return(0,z.jsx)(Z.Provider,{value:Jt,children:m})}},75175:function(mt,Be,t){"use strict";var ze=t(67294),I=t(85893),$e=function(Ae){var y=Ae.uuid;return(0,I.jsx)("iframe",{style:{border:"none",background:"none",width:"100%",height:"100%"},className:"scorm-preview-player",src:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/scorm/play/").concat(y)})};Be.Z=$e},82238:function(mt,Be,t){"use strict";var ze=t(9783),I=t.n(ze),$e=t(5574),W=t.n($e),Ae=t(13769),y=t.n(Ae),fe=t(15009),d=t.n(fe),_e=t(97857),N=t.n(_e),ae=t(99289),j=t.n(ae),be=t(20568),O=t(29477),ie=t(54734),V=t(14726),z=t(28248),Z=t(2453),l=t(67294),n=t(80854),K=t(85893),e=["folder","onResponse"],oe=function(){var Re=j()(d()().mark(function G(g,m,U){return d()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.abrupt("return",(0,n.request)(g,N()({method:"POST",data:m},U||{})));case 1:case"end":return H.stop()}},G)}));return function(g,m,U){return Re.apply(this,arguments)}}(),re=function(G){var g=G.split("//").join("/");return g=g[g.length-1]==="/"?g:"".concat(g,"/"),g=g[0]==="/"?g.slice(1):g,g},ve=function(G){return Array.isArray(G)&&G[0]?G[0].name:G.name},b=function(G,g){var m=re(G),U=ve(g);return U.includes(m)?U:"".concat(m).concat(U)},Fe=function(G){return{file:{status:"done",uid:"fileFromBrowser",name:"fileFromBrowser",response:G},fileList:[]}};function ke(Re){var G=Re.folder,g=Re.onResponse,m=y()(Re,e),U=(0,l.useState)(!1),me=W()(U,2),H=me[0],B=me[1],L=(0,l.useState)(!1),ee=W()(L,2),P=ee[0],T=ee[1],te=m.url,Ee=m.name,J=m.onChange,E=m.data,F=(0,l.useCallback)(function(){B(!1)},[]);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)(V.ZP,{onClick:function(){return B(!0)},icon:(0,K.jsx)(ie.Z,{}),children:[" ",(0,K.jsx)(n.FormattedMessage,{id:"browse"})]}),H&&(0,K.jsx)(z.Z,{open:H,onCancel:F,onOk:F,width:"60vw",closeIcon:!1,children:(0,K.jsx)(be.Z,{forceLoading:P,hideDeleteBtn:!0,defaultDirectory:G,onFile:function(k,de){de&&(T(!0),oe(te,N()(N()({},E),{},I()({},Ee,b(de,k)))).then(function(ue){T(!1),g&&g(ue),ue.success?(F(),J&&J(Fe(ue))):Z.ZP.error(ue.message)}).catch(function(ue){T(!1),"data"in ue?Z.ZP.error(ue.data.message):Z.ZP.error("Unknown Error")}))}})}),(0,K.jsx)("div",{style:{marginTop:"10px"},children:(0,K.jsx)(O.Z,N()({},m))})]})}Be.Z=ke},29477:function(mt,Be,t){"use strict";var ze=t(97857),I=t.n(ze),$e=t(5574),W=t.n($e),Ae=t(55523),y=t(75842),fe=t(21974),d=t(67294),_e=t(80854),N=t(85893);function ae(j){var be=j.onChange,O=j.onUpload,ie=j.url,V=j.name,z=j.extra,Z=j.accept,l=j.data,n=j.wrapInForm,K=n===void 0?!0:n,e=j.title,oe=j.formProps,re=j.maxFiles,ve=j.clearListAfterUpload,b=j.hideLabel,Fe=j.disabled,ke=j.showUploadList,Re=(0,d.useState)(),G=W()(Re,2),g=G[0],m=G[1],U=(0,_e.useIntl)();return l&&l[V]&&delete l[V],(0,N.jsx)(fe.Z,{condition:K,wrap:function(H){return(0,N.jsx)(y.Z,I()(I()({},oe),{},{children:H}))},children:(0,N.jsx)(Ae.Z,{title:e||" ".concat(U.formatMessage({id:"upload_click_here"})),placeholder:U.formatMessage({id:"upload_click_here"}),label:!b&&(0,N.jsx)(_e.FormattedMessage,{id:"upload"}),max:re!=null?re:2,fieldProps:{data:l,accept:Z,name:V,showUploadList:ke,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))},onChange:function(H){m(H),be&&be(H),H.file.status==="done"&&(O&&O(H.file.response),ve&&m(void 0))}},action:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com").concat(ie),extra:z,fileList:g==null?void 0:g.fileList,disabled:Fe})})}Be.Z=ae},12648:function(mt,Be,t){"use strict";t.r(Be),t.d(Be,{default:function(){return Qa}});var ze=t(9783),I=t.n(ze),$e=t(52677),W=t.n($e),Ae=t(15009),y=t.n(Ae),fe=t(97857),d=t.n(fe),_e=t(99289),N=t.n(_e),ae=t(5574),j=t.n(ae),be=t(49677),O=t.n(be),ie=t(95020),V=t(16894),z=t(2453),Z=t(72269),l=t(67294),n=t(80854),K=t(62235),e=t(85893),oe={1:"course"},re=function(f){return f[f.COURSE=1]="COURSE",f}({}),ve=[{title:(0,e.jsx)(n.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,e.jsx)(n.FormattedMessage,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!0,sorter:!0,width:"80%",render:function(r,a){return(0,e.jsx)(K.Z,{type:"Questionnaire",type_id:Number(a.id),text:a.title})}}],b=function(r){var a=r.modelType,o=r.id,s=(0,l.useRef)(),i=(0,n.useIntl)(),c=(0,l.useCallback)(function(){var _=N()(y()().mark(function x(p,h){var A,u,v;return y()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(A=z.ZP.loading(i.formatMessage({id:"loading"})),D.prev=1,!h){D.next=8;break}return D.next=5,(0,ie.cc)(oe[a],o,p);case 5:D.t0=D.sent,D.next=11;break;case 8:return D.next=10,(0,ie.nX)(oe[a],o,p);case 10:D.t0=D.sent;case 11:return u=D.t0,u.success&&(A(),z.ZP.success(u.message),(v=s.current)===null||v===void 0||v.reload()),D.abrupt("return");case 16:return D.prev=16,D.t1=D.catch(1),A(),z.ZP.error((0,e.jsx)(n.FormattedMessage,{id:"error",defaultMessage:"error"})),D.abrupt("return",!1);case 21:case"end":return D.stop()}},x,null,[[1,16]])}));return function(x,p){return _.apply(this,arguments)}}(),[a,o]);return(0,e.jsx)(V.ZP,{headerTitle:i.formatMessage({id:"questionnaires",defaultMessage:"questionnaires"}),actionRef:s,rowKey:"id",search:!1,request:function(x,p){O()(x);var h=p&&Object.entries(p)[0];return(0,ie.SC)({order_by:h&&h[0],order:h?h[1]==="ascend"?"ASC":"DESC":void 0}).then(function(A){return A.success?{data:A.data,success:!0}:[]})},columns:[].concat(ve,[{title:(0,e.jsx)(n.FormattedMessage,{id:"assign",defaultMessage:"assign"}),dataIndex:"option",valueType:"option",render:function(x,p){var h;return[(0,e.jsx)(Z.Z,{defaultChecked:p.models&&((h=p.models)===null||h===void 0?void 0:h.filter(function(A){return A.model_id===o}).length)>0,onChange:function(u){return c(Number(p.id),u)}},"assign")]}}])})},Fe=b,ke=t(7418),Re=t(48959),G=t(19632),g=t.n(G),m=t(31472),U=t(61227),me=t.n(U),H=t(60943),B=t(45919),L=t(99100),ee=t(58638),P=t(14726),T=t(76841),te=function(r){var a=r.topic_id,o=r.stat,s=(0,l.useState)(!1),i=j()(s,2),c=i[0],_=i[1],x=(0,l.useCallback)(function(p){return N()(y()().mark(function h(){var A,u;return y()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(p){M.next=2;break}return M.abrupt("return");case 2:return _(!0),M.prev=3,M.next=6,(0,T.Sx)(p,o);case 6:A=M.sent,A instanceof Blob&&(u=document.createElement("a"),u.href=window.URL.createObjectURL(A),u.download="".concat(o,"_").concat(p,".xlsx"),document.body.appendChild(u),u.click(),document.body.removeChild(u)),M.next=13;break;case 10:M.prev=10,M.t0=M.catch(3),console.error(M.t0);case 13:return M.prev=13,_(!1),M.finish(13);case 16:case"end":return M.stop()}},h,null,[[3,10,13,16]])}))},[o]);return(0,e.jsxs)(P.ZP,{type:"primary",loading:c,disabled:a===void 0,onClick:x(a),children:[(0,e.jsx)(ee.Z,{})," ",(0,e.jsx)(n.FormattedMessage,{id:"export"})]})},Ee=[{dataIndex:"attempt",title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.attempt"}),hideInSearch:!0,fixed:"left",width:100},{dataIndex:"email",title:(0,e.jsx)(n.FormattedMessage,{id:"email"}),hideInSearch:!0,fixed:"left"},{dataIndex:"user_id",title:(0,e.jsx)(n.FormattedMessage,{id:"user"}),hideInSearch:!0,render:function(r,a){return(0,e.jsx)(K.Z,{type:"App\\Models\\User",type_id:a.user_id})}},{dataIndex:"attempt_date",title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.attemptDate"}),hideInSearch:!0,render:function(r,a){return a.attempt_date?(0,H.WU)(new Date(a.attempt_date),B.Cu):"-"}},{dataIndex:"attempt_time",title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.attemptDuration"}),hideInSearch:!0,render:function(r,a){return a.attempt_time?"".concat(a.attempt_time,"s"):"-"}},{dataIndex:"summary",title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.result"}),hideInSearch:!0,render:function(r,a){return typeof a.summary=="number"?"".concat((a.summary*100).toFixed(2),"%"):"-"}}],J=function(r){return r!==void 0?Object.keys(r).filter(function(a){return a.includes("question")}).map(function(a,o){return{title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.question",values:{i:o+1}}),dataIndex:a,hideInSearch:!0}}):[]},E=function(r){var a,o=r.quizTopics,s=(0,l.useState)(o==null||(a=o[0])===null||a===void 0?void 0:a.id),i=j()(s,2),c=i[0],_=i[1],x=(0,l.useState)([]),p=j()(x,2),h=p[0],A=p[1],u=(0,l.useMemo)(function(){return o.reduce(function(D,C){var R=C.id,Q=C.title;return Q!==void 0&&R!==void 0?[].concat(g()(D),[{value:R,label:Q}]):D},[])},[o]),v=(0,l.useMemo)(function(){var D;return[{dataIndex:"topic_id",title:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.topic"}),hideInTable:!0,valueType:"select",fieldProps:{options:u,defaultValue:u==null||(D=u[0])===null||D===void 0?void 0:D.value,allowClear:!1}}].concat(Ee,g()(h))},[u,h]),M=(0,l.useCallback)(function(){var D=N()(y()().mark(function C(R){var Q,$,Ze,ce,je,we,Le,at;return y()().wrap(function(et){for(;;)switch(et.prev=et.next){case 0:if($=R.topic_id,Ze=$===void 0?c:$,Ze){et.next=3;break}return et.abrupt("return",{success:!1,data:[],total:0});case 3:return et.next=5,(0,L.ps)(Ze,m.rX.QuizSummary);case 5:if(ce=et.sent,!(!ce.success||!((Q=ce.data)!==null&&Q!==void 0&&Q[m.rX.QuizSummary]))){et.next=8;break}return et.abrupt("return",{success:!1,data:[],total:0});case 8:return je=ce.data[m.rX.QuizSummary],we=me()(je),Le=we[0],at=we.slice(1),A(J(Le)),et.abrupt("return",{success:!0,data:at,total:at.length});case 11:case"end":return et.stop()}},C)}));return function(C){return D.apply(this,arguments)}}(),[]);return(0,e.jsx)(V.ZP,{headerTitle:(0,e.jsx)(n.FormattedMessage,{id:"TopicStatistics.giftQuiz.title"}),onSubmit:function(C){var R=C.topic_id;return _(R)},onReset:function(){var C;return _(o==null||(C=o[0])===null||C===void 0?void 0:C.id)},toolBarRender:function(){return[(0,e.jsx)(te,{stat:m.rX.QuizSummary,topic_id:c},"export")]},className:"table-standalone",request:M,columns:v,search:{layout:"vertical"},scroll:{x:1500}})},F=function(r){var a=r.flatTopics,o=(0,l.useMemo)(function(){var s;return a.reduce(function(i,c){return d()(d()({},i),{},I()({},c.topicable_type,[].concat(g()(i[c.topicable_type]),[c])))},(s={},I()(I()(I()(I()(I()(I()(I()(I()(I()(I()(s,m.oz.RichText,[]),m.oz.OEmbed,[]),m.oz.Audio,[]),m.oz.Video,[]),m.oz.H5P,[]),m.oz.Image,[]),m.oz.PDF,[]),m.oz.SCORM,[]),m.oz.Project,[]),m.oz.GiftQuiz,[]),I()(s,m.oz.Unselected,[])))},[a]);return(0,e.jsx)(e.Fragment,{children:o[m.oz.GiftQuiz].length>0&&(0,e.jsx)(E,{quizTopics:o[m.oz.GiftQuiz]})})},X=t(87366),k=t(26271),de=t(25093),ue=t(75081),he=t(38925),Me=t(78677),S=function(r){var a=r.config,o=r.value,s=r.title,i=r.children,c=r.valueLabel,_=(0,l.useCallback)(function(p,h){var A,u=(A=o.find(function(v){return v.type===h.type}))===null||A===void 0?void 0:A.topic;return u?"".concat(u.topicable_type.split("\\").pop(),":").concat(u.title):p},[o]),x=(0,l.useCallback)(function(p){return{name:c||p.type,value:p.value}},[c]);return(0,e.jsx)(k.ZP,{title:s,headerBordered:!0,children:(0,e.jsxs)("div",{style:{overflow:"auto",minHeight:"400px"},children:[(0,e.jsx)(Me.Z,d()(d()({},a),{},{tooltip:{formatter:x,title:_},data:o})),i&&i]})})},De=S,Qe=t(11312),Oe={xField:"type",yField:"value",seriesField:"type",isRange:!1,title:null,xAxis:{label:{autoHide:!0,autoRotate:!1}},interactions:[{type:"active-region",enable:!1}],columnBackground:{style:{fill:"rgba(0,0,0,0.1)"}}},He=function(r){var a,o,s,i,c=r.courseId,_=(0,l.useState)({mode:"init"}),x=j()(_,2),p=x[0],h=x[1],A=(0,l.useState)([]),u=j()(A,2),v=u[0],M=u[1],D=de.Z.Text,C=(0,n.useIntl)();return(0,l.useEffect)(function(){h({mode:"loading"}),Promise.all([(0,L.Nx)(Number(c)),(0,L.ue)(Number(c))]).then(function(R){var Q=j()(R,2),$=Q[0],Ze=Q[1];$.success&&Ze.success&&(M((0,X.uS)($.data.lessons)),h({mode:"loaded",value:Object.entries(Ze.data).map(function(ce){var je=j()(ce,2),we=je[0],Le=je[1],at=C.formatMessage({id:we.split("\\").pop()});return{type:at,value:Le}})}))})},[]),(0,e.jsxs)(k.ZP,{split:"vertical",children:[p.mode==="loading"&&(0,e.jsx)(ue.Z,{}),p.mode==="loaded"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Qe.Du,{course_id:Number(c),topics:v,stats:(a=p.value.find(function(R){return R.type.includes("FinishedTopics")}))===null||a===void 0?void 0:a.value}),(0,e.jsx)(Qe.rL,{stats:(o=p.value.find(function(R){return R.type.includes("FinishedCourse")}))===null||o===void 0?void 0:o.value,attempts:(s=p.value.find(function(R){return R.type.includes("AttendanceList")}))===null||s===void 0?void 0:s.value}),(0,e.jsx)(Qe.nu,{stats:(i=p.value.find(function(R){return R.type.includes("AttendanceList")}))===null||i===void 0?void 0:i.value}),(0,e.jsxs)(D,{children:[(0,e.jsx)(n.FormattedMessage,{id:"MoneyEarned"}),": ".concat(p.value.find(function(R){return R.type.split("\\").pop()===C.formatMessage({id:"MoneyEarned"})}).value)]}),(0,e.jsx)(k.ZP,{colSpan:12,layout:"center",children:(0,e.jsx)(De,{config:Oe,title:(0,e.jsx)(n.FormattedMessage,{id:"People"}),value:p.value.filter(function(R){var Q=R.type.split("\\").pop();return Q===C.formatMessage({id:"PeopleBought"})||Q===C.formatMessage({id:"PeopleFinished"})||Q===C.formatMessage({id:"PeopleStarted"})})})}),(0,e.jsx)(k.ZP,{colSpan:12,layout:"center",children:(0,e.jsx)(De,{config:Oe,title:(0,e.jsx)(n.FormattedMessage,{id:"AverageTimePerTopic"}),valueLabel:C.formatMessage({id:"seconds",defaultMessage:"seconds"}),value:Object.entries(p.value.find(function(R){return R.type.split("\\").pop()===C.formatMessage({id:"AverageTimePerTopic"})}).value).map(function(R){var Q;return{type:R[0],value:(Q=R[1])===null||Q===void 0?void 0:Q.average_time,topic:v.find(function($){return $.id===Number(R[0])})}}),children:(0,e.jsxs)(D,{children:[(0,e.jsx)(n.FormattedMessage,{id:"AverageTime"}),`:
                    `.concat(p.value.find(function(R){return R.type.split("\\").pop()===C.formatMessage({id:"AverageTime"})}).value,`
                  `)]})})}),(0,e.jsx)(k.ZP,{children:(0,e.jsx)(F,{flatTopics:v})})]}),p.mode==="error"&&(0,e.jsx)(he.Z,{message:p.error,type:"error"})]})},Ke=He,Ge=t(28225),lt=t(23535),Pe=t(952),rt=t(22004),At=t.n(rt),bt=t(82238),Jt=function(r){var a=r.action,o=r.form_name,s=r.src_name,i=r.getUploadedSrcField,c=r.setPath,_=r.folder,x=r.hideLabel;return(0,e.jsxs)(Pe.ZP.Group,{title:(0,e.jsx)(n.FormattedMessage,{id:"video"}),children:[(0,e.jsx)(Pe.ZP.Item,{shouldUpdate:!0,children:function(h){return(0,e.jsxs)(l.Fragment,{children:[(0,e.jsx)(bt.Z,{folder:_,accept:"video/*",name:o,url:a,onChange:function(u){if(u.file.status==="done"){var v;h.setFieldsValue(I()({},s,i(u))),(v=u.file.response)!==null&&v!==void 0&&v.success&&c(I()(I()({},"".concat(o,"_url"),u.file.response.data["".concat(o,"_url")]),"".concat(o,"_path"),u.file.response.data["".concat(o,"_path")]))}},hideLabel:x}),(0,e.jsx)(P.ZP,{danger:!0,onClick:function(){return[c(I()(I()({},"".concat(o,"_url"),""),"".concat(o,"_path"),"")),h.setFieldsValue(I()({},s,""))]},children:(0,e.jsx)(n.FormattedMessage,{id:"delete"})})]})}}),(0,e.jsx)(Pe.ZP.Item,{shouldUpdate:!0,children:function(h){var A=h.getFieldValue(s);return A?(0,e.jsx)(At(),{width:"auto",height:200,url:A,controls:!0}):(0,e.jsx)(e.Fragment,{})}})]})},xe=Jt,Ne=t(53957),le=t(71230),Y=t(15746),Se=t(8266),Ue=t(64599),st=t.n(Ue),dt=function(r){var a=new FormData;for(var o in r)if(r[o]!=null||r[o]!=null){if(Array.isArray(r[o])){r[o].length||a.append("".concat(o,"[]"),"[]");var s=st()(r[o]),i;try{for(s.s();!(i=s.n()).done;){var c=i.value;a.append("".concat(o,"[]"),c)}}catch(_){s.e(_)}finally{s.f()}continue}a.set(o,r[o])}return a},Ct=t(5966),Rt=t(52688),Wt=t(50335),Sn=t(64218),Ut=t(78957),Tn=t(86738),$t=t(96074),In=t(35614),An=t(2291),Et=t(19411),wr=t(19054),Br=function f(r,a,o){return r.reduce(function(s,i){var c,_=a===i.id;return[].concat(g()(s),[{value:i.id,title:i.title,label:i.title,disabled:o||_,children:f((c=i==null?void 0:i.lessons)!==null&&c!==void 0?c:[],a,_||o)}])},[])},Zn=function(r){var a=r.name,o=r.currentLessonId,s=(0,n.useIntl)(),i=(0,l.useContext)(X._y),c=i.state,_=(0,l.useMemo)(function(){var x;return[{value:"",title:s.formatMessage({id:"root",defaultMessage:"Root"}),label:s.formatMessage({id:"root",defaultMessage:"Root"}),children:Br((x=c==null?void 0:c.lessons)!==null&&x!==void 0?x:[],o)}]},[c,o]);return(0,e.jsx)("div",{className:"tree-select",children:(0,e.jsx)(wr.Z,{name:a,label:(0,e.jsx)(n.FormattedMessage,{id:"parent_lesson"}),fieldProps:{treeData:_,treeDefaultExpandAll:!0,treeLine:!0}})})},Nr=function(r){var a=r.onFinish,o=r.onValuesChange,s=r.onDelete,i=r.onClone,c=r.initialValues,_=r.lesson,x=r.loading,p=x===void 0?!1:x,h=(0,l.useContext)(X._y),A=h.isAssistant,u=Pe.ZP.useForm(),v=j()(u,1),M=v[0],D=Pe.ZP.useWatch("active_from",M),C=Pe.ZP.useWatch("active_to",M),R=(0,n.useIntl)();return(0,e.jsx)(Pe.ZP,{form:M,submitter:{render:function($){return(0,e.jsx)(le.Z,{gutter:16,children:(0,e.jsx)(Y.Z,{span:24-8,children:(0,e.jsx)(le.Z,{justify:"center",className:"program__cta-footer",children:(0,e.jsx)(Sn.Z,{offsetBottom:4,children:(0,e.jsxs)(Ut.Z,{size:"large",children:[(0,e.jsx)(P.ZP,d()(d()({loading:p,type:"primary",onClick:function(){var ce;return(ce=$.form)===null||ce===void 0?void 0:ce.submit()}},$.submitButtonProps),{},{children:_.isNew?(0,e.jsx)(n.FormattedMessage,{id:"create"}):(0,e.jsx)(n.FormattedMessage,{id:"save"})}),"submit"),!_.isNew&&(0,e.jsx)(P.ZP,{onClick:i,loading:p,children:(0,e.jsx)(n.FormattedMessage,{id:"clone"})}),(0,e.jsx)(Tn.Z,{onConfirm:s,title:(0,e.jsx)(n.FormattedMessage,{id:"deleteQuestion"}),okText:(0,e.jsx)(n.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(n.FormattedMessage,{id:"no"}),children:(0,e.jsx)(P.ZP,d()(d()({type:"primary",danger:!0},$.submitButtonProps),{},{loading:p,children:(0,e.jsx)(n.FormattedMessage,{id:"delete"})}))},"delete")]})})})})})}},layout:"vertical",onFinish:a,onValuesChange:o,initialValues:d()(d()({},c),{},{summary:c.summary||""}),style:{height:"100%"},children:(0,e.jsxs)(le.Z,{gutter:16,style:{height:"100%"},children:[(0,e.jsxs)(Y.Z,{span:24-8,children:[(0,e.jsx)($t.Z,{children:(0,e.jsx)(n.FormattedMessage,{id:"lesson"})}),(0,e.jsxs)(k.ZP,{children:[(0,e.jsx)(Ct.Z,{name:"title",label:(0,e.jsx)(n.FormattedMessage,{id:"title"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"title"}),placeholder:R.formatMessage({id:"title"}),required:!0,labelCol:{span:5}}),(0,e.jsx)(Pe.ZP.Item,{name:"summary",label:(0,e.jsx)(n.FormattedMessage,{id:"summary"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"summary_tooltip"}),valuePropName:"value",labelCol:{span:5},children:(0,e.jsx)(Et.ZP,{directory:"course/".concat(_.course_id,"/lesson/").concat(_.id,"/wysiwyg")})})]})]}),(0,e.jsx)(Y.Z,{span:8,children:(0,e.jsxs)("aside",{className:"program-sidebar program-sidebar--right",children:[(0,e.jsx)(Ct.Z,{name:"duration",label:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),placeholder:R.formatMessage({id:"duration"})}),(0,e.jsx)(Rt.Z,{name:"active",label:(0,e.jsx)(n.FormattedMessage,{id:"is_active"})}),(0,e.jsx)(Wt.Z,{allowClear:!1,width:"lg",name:"active_from",label:(0,e.jsx)(n.FormattedMessage,{id:"active_from"}),placeholder:R.formatMessage({id:"active_from",defaultMessage:"active_from"}),rules:[{validator:function($,Ze){return Ze&&C&&(0,In.A)(new Date(Ze),new Date(C))?Promise.reject(new Error(R.formatMessage({id:"invalidDate"}))):Promise.resolve()}}]}),(0,e.jsx)(Wt.Z,{allowClear:!1,width:"lg",name:"active_to",label:(0,e.jsx)(n.FormattedMessage,{id:"active_to"}),placeholder:R.formatMessage({id:"active_to",defaultMessage:"active_to"}),disabled:!D&&!C,rules:[{validator:function($,Ze){return Ze&&D&&(0,An.R)(new Date(Ze),new Date(D))?Promise.reject(new Error(R.formatMessage({id:"invalidDate"}))):Promise.resolve()}}]}),(0,e.jsx)(Zn,{name:"parent_id",currentLessonId:_==null?void 0:_.id}),A&&(0,e.jsx)(Ct.Z,{name:"assistant_id",label:(0,e.jsx)(n.FormattedMessage,{id:"assistant_id",defaultMessage:"Assistant ID"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"assistant_id_tooltip"}),placeholder:R.formatMessage({id:"Assistant ID"})})]})})]})})},zr=Nr,Fn=function(r){var a;return d()(d()({},r),{},{parent_id:(a=r.parent_id)!==null&&a!==void 0?a:""})},Wr=function(){var r=(0,l.useContext)(X._y),a=r.updateLesson,o=r.deleteLesson,s=r.cloneLesson,i=r.currentEditMode,c=i&&i.mode==="lesson"&&i.value?i.value:{},_=(0,l.useState)(Fn(c)),x=j()(_,2),p=x[0],h=x[1],A=(0,l.useState)([]),u=j()(A,2),v=u[1],M=(0,l.useState)(!1),D=j()(M,2),C=D[0],R=D[1],Q=(0,n.useParams)();(0,l.useEffect)(function(){return h(Fn(c)),(c==null?void 0:c.topics)&&v(c.topics)},[c]);var $=(0,l.useCallback)(function(){R(!0);var je=dt(d()(d()({course_id:(c==null?void 0:c.course_id)||Q.course},p),{},{active:p.active?1:0,parent_lesson_id:p.parent_id}));return a&&p.id?a(p.id,je).then(function(){return R(!1)}).catch(function(we){console.error(we),R(!1)}):Promise.resolve()},[p,c==null?void 0:c.course_id,a]),Ze=(0,l.useCallback)(function(){return p.id&&o&&o(p.id),Promise.resolve()},[o,p.id]),ce=(0,l.useCallback)(function(){return p.id&&(s==null?void 0:s(p.id))},[s,p.id]);return(0,e.jsx)(zr,{loading:C,lesson:p,initialValues:p,onDelete:Ze,onFinish:$,onClone:ce,onValuesChange:function(we){h(function(Le){return d()(d()({},Le),we)})}})},$r=Wr,Kr=t(54734),On=t(55725),Xt=t(51042),Dn=t(75625),kr=t(62848),ct=t(83062),Vr=t(65400),Kt=t.n(Vr),Ln=t(74253),Gr=t(95486),Mt=t(43669),Yt=t(28248),Hr=function(r){var a=r.handleOk,o=r.isModalVisible,s=r.initialValues,i=r.courseId;return(0,e.jsxs)(Yt.Z,{title:(0,e.jsx)(Mt._H,{id:"description"}),visible:o,onOk:a,onCancel:a,width:1e3,footer:[(0,e.jsx)(P.ZP,{type:"primary",onClick:a,children:"Ok"},"back")],children:[(0,e.jsx)(Pe.ZP.Item,{name:"introduction",label:(0,e.jsx)(Mt._H,{id:"introduction"}),labelCol:{span:5},wrapperCol:{span:19},tooltip:(0,e.jsx)(Mt._H,{id:"introduction_tooltip"}),valuePropName:"value",children:(0,e.jsx)(Et.ZP,{directory:"course/".concat(i,"/lesson/").concat(s.lesson_id,"/topic/").concat(s.id,"/wysiwyg")})}),(0,e.jsx)(Pe.ZP.Item,{name:"description",label:(0,e.jsx)(Mt._H,{id:"description"}),labelCol:{span:5},wrapperCol:{span:19},tooltip:(0,e.jsx)(Mt._H,{id:"description_tooltip"}),valuePropName:"value",children:(0,e.jsx)(Et.ZP,{directory:"course/".concat(i,"/lesson/").concat(s.lesson_id,"/topic/").concat(s.id,"/wysiwyg")})}),(0,e.jsx)(Pe.ZP.Item,{name:"summary",label:(0,e.jsx)(Mt._H,{id:"summary"}),labelCol:{span:5},wrapperCol:{span:19},tooltip:(0,e.jsx)(Mt._H,{id:"summary_tooltip"}),valuePropName:"value",children:(0,e.jsx)(Et.ZP,{directory:"course/".concat(i,"/lesson/").concat(s.lesson_id,"/topic/").concat(s.id,"/wysiwyg")})})]})},Qr=function(r){var a=r.onValuesChange,o=r.initialValues,s=r.courseId,i=(0,n.useIntl)(),c=l.useState(!1),_=j()(c,2),x=_[0],p=_[1];return(0,e.jsxs)(Pe.ZP,{submitter:!1,onValuesChange:a,initialValues:d()({},o),layout:"horizontal",children:[(0,e.jsx)(Ct.Z,{name:"title",label:(0,e.jsx)(n.FormattedMessage,{id:"title"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"title"}),placeholder:i.formatMessage({id:"title",defaultMessage:"title"}),required:!0}),(0,e.jsx)(Ct.Z,{name:"duration",label:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),placeholder:i.formatMessage({id:"duration"})}),(0,e.jsx)(Zn,{name:"lesson_id"}),(0,e.jsx)(Pe.ZP.Item,{label:(0,e.jsx)(n.FormattedMessage,{id:"description"}),children:(0,e.jsx)(P.ZP,{type:"primary",onClick:function(){return p(!0)},children:(0,e.jsx)(n.FormattedMessage,{id:"open_editor"})})}),(0,e.jsx)(Rt.Z,{name:"active",label:(0,e.jsx)(n.FormattedMessage,{id:"is_active"})}),(0,e.jsx)(Rt.Z,{name:"preview",label:(0,e.jsx)(n.FormattedMessage,{id:"able_to_preview"})}),(0,e.jsx)(Rt.Z,{name:"can_skip",label:(0,e.jsx)(n.FormattedMessage,{id:"can_skip"})}),(0,e.jsx)(Pe.ZP.Item,{name:"json",label:(0,e.jsx)(n.FormattedMessage,{id:"json"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"json_tooltip"}),valuePropName:"value",children:(0,e.jsx)(Gr.Z,{})}),(0,e.jsx)(Hr,{isModalVisible:x,handleOk:function(){return p(!1)},initialValues:o,courseId:s})]})},Jr=Qr,qt=function(r){if(typeof(r==null?void 0:r.topicable_type)!="string"||!r.topicable_type)return"Unknown";var a=((r==null?void 0:r.topicable_type)||"").split("\\");return a.pop()||"Unknown"},Rn=t(97704),Zt=t(66419),St=t(83863),Xr=function(r){var a=r.value,o=r.onChange,s=r.multiple,i=s===void 0?!1:s,c=(0,l.useState)([]),_=j()(c,2),x=_[0],p=_[1];return(0,l.useEffect)(function(){(0,Rn.gq)().then(function(h){return h.success&&p(h.data)})},[]),(0,l.useEffect)(function(){x.length&&(x.find(function(h){return Number(h.id)===Number(a)})||(0,Rn.gq)().then(function(h){return h.success&&p(h.data)}))},[a]),(0,e.jsx)(St.default,{loading:x.length===0,style:{width:"100%"},value:a,onChange:o,mode:i?"multiple":void 0,showSearch:!0,placeholder:(0,e.jsx)(n.FormattedMessage,{id:"H5P_select_content"}),optionFilterProp:"children",filterOption:function(A,u){var v,M=u==null||(v=u.children)===null||v===void 0?void 0:v.slice(1,u==null?void 0:u.children.length).join("");return(0,Zt.ri)(M,A)},children:x.map(function(h){return(0,e.jsxs)(St.default.Option,{value:h.id.toString(),children:[(0,e.jsx)("small",{children:h.id})," ",h.title," (",h.library.title,")"]},h.id.toString())})})},Yr=Xr,qr=t(9412),es=t(89825),ts=function(r){var a=r.id,o=r.onChange,s=(0,n.useIntl)(),i=(0,l.useState)(a==="new"||a===void 0?"new":Number(a)),c=j()(i,2),_=c[0],x=c[1];return(0,e.jsxs)(l.Fragment,{children:[(0,e.jsxs)(le.Z,{gutter:16,align:"middle",className:"create-new",children:[(0,e.jsx)(Y.Z,{children:(0,e.jsxs)(P.ZP,{type:"primary",onClick:function(){return x("new")},children:[" ",(0,e.jsx)(n.FormattedMessage,{id:"create_new"})]})}),(0,e.jsx)(Y.Z,{span:4,children:(0,e.jsxs)(de.Z,{children:[(0,e.jsx)("small",{children:(0,e.jsx)(n.FormattedMessage,{id:"or"})})," ",(0,e.jsx)(n.FormattedMessage,{id:"reuse_existing"})]})}),(0,e.jsx)(Y.Z,{span:12,children:(0,e.jsx)(Yr,{value:a,onChange:function(h){o(h),x(a==="new"?"new":Number(a))}})})]}),(0,e.jsx)(le.Z,{style:{marginTop:"30px"},children:(0,e.jsx)(Y.Z,{span:24,children:(0,e.jsx)(es.Z,{id:_,onSubmit:function(h){return o(String(h))}},_)})}),(0,e.jsx)($t.Z,{}),(0,e.jsx)(le.Z,{gutter:16,children:(0,e.jsx)(Y.Z,{span:24,children:(0,e.jsx)(le.Z,{children:(0,e.jsx)(qr.C,{onSuccess:function(h){h.data.id&&o(String(h.data.id))},onError:function(){return console.log(s.formatMessage({id:"error"}))}})})})})]})},ns=ts,Un=t(96365),rs=t(98980),ss=t.n(rs),as=[{provider_name:"YouTube",provider_url:"https://www.youtube.com/",endpoints:[{schemes:["https://*.youtube.com/watch*","https://*.youtube.com/v/*","https://youtu.be/*","https://*.youtube.com/shorts/*","https://youtube.com/shorts/*"],url:"https://www.youtube.com/oembed",discovery:!0}]},{provider_name:"Reddit",provider_url:"https://reddit.com/",endpoints:[{schemes:["https://reddit.com/r/*/comments/*/*","https://www.reddit.com/r/*/comments/*/*"],url:"https://www.reddit.com/oembed"}]},{provider_name:"Flickr",provider_url:"https://www.flickr.com/",endpoints:[{schemes:["http://*.flickr.com/photos/*","http://flic.kr/p/*","https://*.flickr.com/photos/*","https://flic.kr/p/*"],url:"https://www.flickr.com/services/oembed/",discovery:!0}]},{provider_name:"Vimeo",provider_url:"https://vimeo.com/",endpoints:[{schemes:["https://vimeo.com/*","https://vimeo.com/album/*/video/*","https://vimeo.com/channels/*/*","https://vimeo.com/groups/*/videos/*","https://vimeo.com/ondemand/*/*","https://player.vimeo.com/video/*"],url:"https://vimeo.com/api/oembed.{format}",discovery:!0}]},{provider_name:"SoundCloud",provider_url:"http://soundcloud.com/",endpoints:[{schemes:["http://soundcloud.com/*","https://soundcloud.com/*","https://soundcloud.app.goog.gl/*"],url:"https://soundcloud.com/oembed"}]},{provider_name:"Twitter",provider_url:"http://www.twitter.com/",endpoints:[{schemes:["https://twitter.com/*/status/*","https://*.twitter.com/*/status/*","https://twitter.com/*/moments/*","https://*.twitter.com/*/moments/*"],url:"https://publish.twitter.com/oembed"}]},{provider_name:"GIPHY",provider_url:"https://giphy.com",endpoints:[{schemes:["https://giphy.com/gifs/*","http://gph.is/*","https://media.giphy.com/media/*/giphy.gif"],url:"https://giphy.com/services/oembed",discovery:!0}]}],is=function(r){return(0,e.jsx)(ss(),d()(d()({},r),{},{providers:as}))},os=function(r){var a=r.text,o=r.onChange,s=(0,l.useState)(a),i=j()(s,2),c=i[0],_=i[1],x=(0,l.useState)(a),p=j()(x,2),h=p[0],A=p[1];return(0,e.jsxs)(l.Fragment,{children:[(0,e.jsxs)(le.Z,{children:[(0,e.jsx)(Un.Z,{value:a,onChange:function(v){_(v.target.value),o(v.target.value)}}),(0,e.jsx)(P.ZP,{onClick:function(){return A(c)},children:(0,e.jsx)(n.FormattedMessage,{id:"preview"})})]}),(0,e.jsx)(le.Z,{children:h&&(0,e.jsx)(is,{url:h},h)})]})},ls=os,ds=function(r){var a=r.text,o=r.onChange,s=r.directory,i=s===void 0?"topics/new":s;return(0,e.jsx)("div",{children:(0,e.jsx)(Et.ZP,{directory:i,value:a,onChange:function(_){o(_)}})})},us=ds,cs=t(26859),ms=t(72252),ps=t(38703),wn=t(97042),vs=t(56117),fs=t(59037);wn.default.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(wn.default.version,"/pdf.worker.min.js");var gs={acceptedTypes:I()(I()(I()({audio:".mp3,audio/*",video:".mp3,video/*",document:".doc,.docx,.pdf,.zip"},m.oz.Audio,".mp3,audio/*"),m.oz.Video,".mp3,video/*"),m.oz.PDF,".pdf,application/pdf")},_s=function(r){var a={},o;for(o in r)switch(W()(r[o])){case"boolean":a[o]=r[o]?1:0;break;case"object":a[o]=JSON.stringify(r[o]);break;case"string":case"number":a[o]=r[o];break;default:break}return a},hs=function(r){var a=r.file,o=(0,l.useState)(0),s=j()(o,2),i=s[0],c=s[1],_=(0,l.useState)(1),x=j()(_,2),p=x[0],h=x[1];return(0,e.jsxs)("div",{children:[i===0?(0,e.jsx)(ue.Z,{}):(0,e.jsxs)("div",{style:{margin:"0.5em 0"},children:[(0,e.jsxs)(de.Z,{children:[(0,e.jsx)(n.FormattedMessage,{id:"page"}),":"]}),(0,e.jsx)(ms.Z,{defaultPageSize:1,size:"small",total:i,onChange:function(u){return h(u)},simple:!0})]}),(0,e.jsx)(vs.Z,{file:a,onLoadSuccess:function(u){var v=u.numPages;return c(v)},children:(0,e.jsx)(fs.Z,{pageNumber:p,className:"pdf-preview"})})]})},js=function(r){var a,o=r.topic,s=(0,l.useContext)(X._y),i=s.getLessons;if((0,l.useEffect)(function(){var _;if(((_=o.json)===null||_===void 0?void 0:_.ffmpeg.state)==="coding"){var x=setTimeout(function(){i&&i()},1e3);return function(){return clearTimeout(x)}}},[]),((a=o.json)===null||a===void 0?void 0:a.ffmpeg.state)==="coding"){var c;return(0,e.jsxs)(de.Z,{children:[(0,e.jsx)(n.FormattedMessage,{id:"encoding_progress",defaultMessage:"Encoding progress:"}),(0,e.jsx)(ps.Z,{percent:(c=o.json)===null||c===void 0||(c=c.ffmpeg)===null||c===void 0?void 0:c.percentage})]})}return(0,e.jsx)(l.Fragment,{})},xs=function(r){var a,o,s,i,c=r.type,_=r.topic;if(_&&_.topicable&&"url"in _.topicable)switch(c){case m.oz.Audio:return _.topicable_type===m.oz.Audio&&(a=_.topicable)!==null&&a!==void 0&&a.url?(0,e.jsx)("audio",{preload:"none",controls:!0,src:_.topicable.url}):(0,e.jsx)(l.Fragment,{});case m.oz.Video:return _.topicable_type===m.oz.Video&&(o=_.topicable)!==null&&o!==void 0&&o.url?(0,e.jsx)("video",{controls:!0,src:_.topicable.url,width:"100%"}):(0,e.jsx)(l.Fragment,{});case m.oz.Image:return _.topicable_type===m.oz.Image&&(s=_.topicable)!==null&&s!==void 0&&s.url?(0,e.jsx)("img",{title:"Topic image",src:_.topicable.url,width:"100%"}):(0,e.jsx)(l.Fragment,{});case m.oz.PDF:return _.topicable_type===m.oz.PDF&&(i=_.topicable)!==null&&i!==void 0&&i.url?(0,e.jsx)(hs,{file:_.topicable.url}):(0,e.jsx)(l.Fragment,{});default:return(0,e.jsx)(l.Fragment,{})}return(0,e.jsx)(l.Fragment,{})},bs=function(r){var a=r.topic,o=r.type,s=r.onUpdate,i=r.disabled,c=i===void 0?!1:i,_=r.currentState,x=r.onChange,p=r.folder,h=r.maxFiles,A=r.clearListAfterUpload,u=(0,l.useCallback)(function(M){return M.file.status==="done"?s&&s(M):x&&x(M)},[s,x]),v=d()(d()({},_),{},{topicable_type:o,active:_.active?1:0,preview:_.preview?1:0,can_skip:_.can_skip?1:0});return v.introduction||v==null||delete v.introduction,v.description||v==null||delete v.description,v.summary||v==null||delete v.summary,v.json||v==null||delete v.json,(0,e.jsxs)(l.Fragment,{children:[(0,e.jsx)(le.Z,{children:(0,e.jsx)(bt.Z,{folder:p,onChange:u,name:"value",url:a.isNew?"/api/admin/topics":"/api/admin/topics/".concat(a.id,"?_method=PUT"),accept:gs.acceptedTypes[o],data:_s(v),maxFiles:h,clearListAfterUpload:A,children:(0,e.jsxs)(P.ZP,{disabled:c,icon:(0,e.jsx)(cs.Z,{}),children:["Click to upload ",o]})})}),(0,e.jsx)(le.Z,{children:(0,e.jsxs)("div",{style:{padding:"0 12px"},children:[a.topicable_type===m.oz.Video&&(0,e.jsx)(js,{topic:a}),(0,e.jsx)(xs,{type:o,topic:_})]})})]})},Ms=bs,Bn=t(82061),Ps=t(69753),en=t(2487),Cs=function(r){var a=r.topicId,o=r.folder,s=(0,l.useState)(),i=j()(s,2),c=i[0],_=i[1],x=(0,l.useRef)(),p=(0,l.useCallback)(function(){x.current&&x.current.abort(),x.current=new AbortController,(0,L.Jb)(a,{signal:x.current.signal}).then(function(u){u&&u.success&&_(u.data)})},[a]),h=(0,l.useCallback)(function(u){u&&u.success&&(0,L.Jb)(a).then(function(v){v&&v.success&&_(v.data)})},[]),A=(0,l.useCallback)(function(u){(0,L.fg)(a,u).then(function(v){v.success&&p()})},[a]);return(0,l.useEffect)(function(){p()},[a]),(0,e.jsx)(en.Z,{size:"small",itemLayout:"horizontal",dataSource:c,header:(0,e.jsx)(bt.Z,{folder:o,url:"/api/admin/topics/".concat(a,"/resources"),name:"resource",onChange:function(v){if(v.file.status==="done"){var M;(M=v.file.response)!==null&&M!==void 0&&M.success&&h(v.file.response)}}}),renderItem:function(v){return(0,e.jsx)(en.Z.Item,{actions:[(0,e.jsx)(P.ZP,{type:"default",danger:!0,icon:(0,e.jsx)(Bn.Z,{}),size:"small",onClick:function(){return A(v.id)}},"delete")],children:(0,e.jsx)(en.Z.Item.Meta,{avatar:(0,e.jsx)("a",{href:v.url,target:"_blank",rel:"noreferrer",children:(0,e.jsx)(P.ZP,{type:"default",icon:(0,e.jsx)(Ps.Z,{}),size:"small"})}),description:(0,e.jsx)(l.Fragment,{children:(0,e.jsx)(P.ZP,{type:"text",size:"small",children:v.name})})})})}})},ys=Cs,Es=t(75175),Ss=t(9649),Ts=function(r){var a=r.value,o=r.onChange,s=(0,l.useState)([]),i=j()(s,2),c=i[0],_=i[1],x=(0,l.useState)(!1),p=j()(x,2),h=p[0],A=p[1],u=(0,l.useState)(),v=j()(u,2),M=v[0],D=v[1],C=(0,l.useState)(),R=j()(C,2),Q=R[0],$=R[1],Ze=(0,l.useRef)(),ce=(0,l.useCallback)(function(we){A(!0),Ze.current&&Ze.current.abort(),Ze.current=new AbortController,(0,Ss.JZ)({search:we,pageSize:0},{signal:Ze.current.signal}).then(function(Le){if(Le.success)return Array.isArray(Le.data.data)&&_(Le.data.data);A(!1)}).catch(function(){return A(!1)})},[]),je=(0,l.useCallback)(function(we){ce(we)},[ce]);return(0,l.useEffect)(function(){ce()},[a]),(0,l.useEffect)(function(){D(c.map(function(we){return we.scos.filter(function(Le){return Le.id===a})}).flat()[0])},[c]),(0,e.jsxs)(l.Fragment,{children:[Q&&(0,e.jsx)(Yt.Z,{width:"80vw",bodyStyle:{height:"70vh"},visible:!0,onOk:function(){return $(void 0)},onCancel:function(){return $(void 0)},children:(0,e.jsx)(Es.Z,{uuid:Q})}),(0,e.jsxs)(Ut.Z,{children:[(0,e.jsx)(St.default,{allowClear:!0,style:{width:"100%",minWidth:"300px"},value:M?"".concat(M==null?void 0:M.id,": ").concat(M==null?void 0:M.title):void 0,onChange:function(Le){return o&&o(Le&&Le.split(":")[0])},showSearch:!0,onSearch:je,placeholder:(0,e.jsx)(n.FormattedMessage,{id:"select_scorm_package"}),optionFilterProp:"children",filterOption:function(Le,at){if(at&&at.children){var vt;return(at==null||(vt=at.children)===null||vt===void 0?void 0:vt.toString().toLowerCase().indexOf(Le.toLowerCase()))>=0}return!0},notFoundContent:h?(0,e.jsx)(ue.Z,{size:"small"}):null,children:c.map(function(we){return(0,e.jsx)(St.default.OptGroup,{label:"".concat(we.id,": ").concat(we.version),children:(0,e.jsx)(l.Fragment,{children:we.scos.map(function(Le){return(0,e.jsx)(St.default.Option,{value:"".concat(Le.id,": ").concat(Le.title),children:Le.title},Le.id)})})},we.id)})}),M&&(0,e.jsx)(P.ZP,{onClick:function(){$(M==null?void 0:M.uuid)},children:(0,e.jsx)(n.FormattedMessage,{id:"preview"})},a)]})]})},Is=Ts,As=function(r){var a=r.value,o=r.onChange;return(0,e.jsxs)(Ut.Z,{size:"large",align:"start",children:[(0,e.jsx)(Is,{value:a,onChange:function(i){return o&&o(Number(i))}}),(0,e.jsx)(P.ZP,{onClick:function(){return o&&o(void 0)},children:(0,e.jsx)(n.FormattedMessage,{id:"clear_selection"})})]})},Nn=As,tn=t(4828),nn=t(49354),rn=t(35102),sn=t(45699),an=t(35326),on=t(67337),ln=t(68432),dn=t(15360),un=t(43973),cn=t(57619),Zs=t(11475),Fs=t(38751),Os=t(24739),kt=t(31199),Ds=t(89652),Ls=function(r){var a=r.topicable,o=r.onAdded,s=r.onRemoved,i=r.onEdited,c=r.onChange,_=(0,n.useIntl)();return(0,e.jsxs)(l.Fragment,{children:[(0,e.jsx)(Pe.ZP,{initialValues:{max_attempts:a?a.max_attempts:void 0,max_execution_time:a?a.max_execution_time:void 0,min_pass_score:a?a.min_pass_score:void 0},onValuesChange:function(p){var h=Object.keys(p)[0];h&&c(h,p[h])},submitter:!1,children:(0,e.jsxs)(Os.UW,{children:[(0,e.jsx)(kt.Z,{name:"max_attempts",label:(0,e.jsx)(n.FormattedMessage,{id:"max_attempts"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"max_attempts"}),placeholder:_.formatMessage({id:"max_attempts",defaultMessage:"max_attempts"})}),(0,e.jsx)(kt.Z,{name:"max_execution_time",label:(0,e.jsx)(n.FormattedMessage,{id:"max_execution_time"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"max_execution_time_tooltip"}),placeholder:_.formatMessage({id:"max_execution_time",defaultMessage:"max_execution_time"})}),(0,e.jsx)(kt.Z,{name:"min_pass_score",max:100,label:(0,e.jsx)(n.FormattedMessage,{id:"min_pass_score"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"min_pass_score_tooltip"}),placeholder:_.formatMessage({id:"min_pass_score",defaultMessage:"min_pass_score"})})]})}),(0,e.jsx)($t.Z,{}),a?(0,e.jsx)(Fs.i,{questions:a.questions,quizId:a.id,onAdded:o,onEdited:i,onRemoved:s}):(0,e.jsx)(Ds.default,{children:(0,e.jsx)(n.FormattedMessage,{id:"pressSaveToCreateQuestions",defaultMessage:"Create this Topic before adding questions"})})]})},Rs=Ls,Vt=t(44167),Us=function(r){var a,o=r.onChange,s=r.topicable,i=(0,l.useCallback)(function(c){var _=Object.keys(c)[0];_&&o(c[_])},[]);return(0,e.jsx)(l.Fragment,{children:(0,e.jsx)(Pe.ZP,{initialValues:{notify_users:(a=s==null?void 0:s.notify_users)!==null&&a!==void 0?a:[]},onValuesChange:i,submitter:!1,children:(0,e.jsx)(Pe.ZP.Item,{name:"notify_users",label:(0,e.jsx)(n.FormattedMessage,{id:"notify_users",defaultMessage:"Users to notify"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"notify_users_tooltip",defaultMessage:"Indicate which users should be notified about project upload"}),children:(0,e.jsx)(Vt.Z,{multiple:!0})})})})},ws=Us,zn=function(r){if(r)switch(r){case"ScormSco":return(0,e.jsx)(tn.Z,{});case"PDF":return(0,e.jsx)(nn.Z,{});case"Audio":return(0,e.jsx)(rn.Z,{});case"Image":return(0,e.jsx)(sn.Z,{});case"OEmbed":return(0,e.jsx)(an.Z,{});case"H5P":return(0,e.jsx)(on.Z,{});case"Video":return(0,e.jsx)(ln.Z,{});case"RichText":return(0,e.jsx)(dn.Z,{});case"Project":return(0,e.jsx)(un.Z,{});case"GiftQuiz":return(0,e.jsx)(cn.Z,{})}return(0,e.jsx)(Zs.Z,{})},Wn=function(r){return[m.oz.GiftQuiz,m.oz.Project,m.oz.GiftQuiz].includes(r)},Bs=function(){var r,a,o,s=(0,l.useContext)(X._y),i=s.state,c=s.currentEditMode,_=s.updateTopic,x=s.deleteTopic,p=s.onTopicUploaded,h=s.cloneTopic,A=s.getLessons,u=c&&c.mode==="topic"&&c.value?c.value:{},v=(0,l.useState)(!1),M=j()(v,2),D=M[0],C=M[1],R=(0,l.useState)(d()(d()({},u),{},{value:u==null||(r=u.topicable)===null||r===void 0?void 0:r.value})),Q=j()(R,2),$=Q[0],Ze=Q[1],ce=$.topicable_type,je=(0,l.useState)($.order),we=j()(je,1),Le=we[0],at=(0,l.useState)(!1),vt=j()(at,2),et=vt[0],Ce=vt[1],q=(0,l.useState)(u),pe=j()(q,2),w=pe[0],Ve=pe[1];(0,l.useEffect)(function(){Ve(u)},[u]),(0,l.useEffect)(function(){Ze(function(Te){var ne;return d()(d()(d()({},Te),u),{},{value:ce===(u==null?void 0:u.topicable_type)?u==null||(ne=u.topicable)===null||ne===void 0?void 0:ne.value:""})}),u!=null&&u.isNew&&C(!Wn(u.topicable_type))},[ce,u]),(0,l.useEffect)(function(){var Te,ne;if(!((w==null?void 0:w.topicable_type)!==m.oz.Video||!((Te=w.json)!==null&&Te!==void 0&&Te.ffmpeg.state)||((ne=w.json)===null||ne===void 0?void 0:ne.ffmpeg.state)==="finished")){var qe=function(){var Je=N()(y()().mark(function it(){var We;return y()().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(!u.id){ge.next=5;break}return ge.next=3,(0,L.BN)(u.id);case 3:We=ge.sent,We.success&&Ve(We.data);case 5:case"end":return ge.stop()}},it)}));return function(){return Je.apply(this,arguments)}}(),ut=window.setInterval(qe,5e3);return function(){window.clearInterval(ut)}}},[w==null?void 0:w.topicable_type,(a=w.json)===null||a===void 0||(a=a.ffmpeg)===null||a===void 0?void 0:a.state]);var ye=(0,l.useCallback)(function(Te,ne){Ze(function(qe){return d()(d()({},qe),{},I()({},Te,ne))}),C(!1)},[u]),Xe=(0,l.useCallback)(function(Te){Ze(function(ne){return d()(d()({},ne),Te)})},[u]),Pt=(0,l.useCallback)(function(Te){_&&$.id&&(Ce(!0),_($.id,Te).then(function(){return Ce(!1)}).catch(function(){Ce(!1)}))},[$,_,u]),nt=(0,l.useCallback)(function(){var Te=d()(d()({},$),{},{active:$.active?1:0,preview:$.preview?1:0,can_skip:$.can_skip?1:0,order:Le,json:$.json?JSON.stringify($.json):null});Wn(u.topicable_type)&&!Te.value&&(Te.value="theProject");var ne=dt(Te);Pt(ne)},[$,Pt,Le]),gt=(0,l.useCallback)(function(){return u!=null&&u.isNew||Ce(!0),x&&$.id&&x($.id)},[$,x,u]),_t=(0,l.useCallback)(function(){return u.id&&h&&h(u.id)},[u,h]);return(0,e.jsx)(l.Fragment,{children:(0,e.jsxs)(le.Z,{gutter:16,style:{height:"100%"},children:[(0,e.jsxs)(Y.Z,{span:24-8,style:{marginBottom:"46px"},children:[(0,e.jsxs)(Ln.Z,{children:[u&&zn(qt(u))," ",(u==null?void 0:u.topicable_type)&&(u==null?void 0:u.topicable_type.split("\\").pop())," ",(0,e.jsx)(n.FormattedMessage,{id:"type"})]}),!ce&&(0,e.jsx)(he.Z,{message:(0,e.jsx)(n.FormattedMessage,{id:"select_type_topic"}),type:"info"}),ce&&ce===(m.oz===null||m.oz===void 0?void 0:m.oz.RichText)&&(0,e.jsx)(us,{directory:"course/".concat(i==null?void 0:i.id,"/lesson/").concat(u==null?void 0:u.lesson_id,"/topic/").concat(u==null?void 0:u.id,"/wysiwyg"),text:(u==null?void 0:u.topicable_type)===(m.oz===null||m.oz===void 0?void 0:m.oz.RichText)&&(u==null||(o=u.topicable)===null||o===void 0?void 0:o.value)||"",onChange:function(ne){return ye("value",ne)}}),u&&ce&&(ce===m.oz.Video||ce===m.oz.Audio||ce===m.oz.Image||ce===m.oz.PDF)&&(0,e.jsx)(Ms,{folder:"course/".concat(i==null?void 0:i.id),type:ce,topic:w,currentState:$,onChange:function(ne){Ce(!0),ne.file.status==="removed"&&Ce(!1)},onUpdate:function(ne){var qe,ut,Je,it;u.id&&p&&p(u.id,ne),u.topicable_type===m.oz.Video&&setTimeout(function(){A&&A()},5e3),Ze(d()(d()({},$),{},{id:ne==null||(qe=ne.file)===null||qe===void 0||(qe=qe.response)===null||qe===void 0||(qe=qe.data)===null||qe===void 0?void 0:qe.id,order:(ut=ne.file.response.data)===null||ut===void 0?void 0:ut.order,value:ne==null||(Je=ne.file)===null||Je===void 0||(Je=Je.response.data)===null||Je===void 0||(Je=Je.topicable)===null||Je===void 0?void 0:Je.value,topicable:ne==null||(it=ne.file)===null||it===void 0||(it=it.response.data)===null||it===void 0?void 0:it.topicable})),C(!1),Ce(!1)},disabled:!1,maxFiles:1,clearListAfterUpload:!0}),ce&&ce===m.oz.OEmbed&&(0,e.jsx)(ls,{text:$.value,onChange:function(ne){return ye("value",ne)}}),ce&&ce===m.oz.Project&&(0,e.jsx)(ws,{onChange:function(ne){return ye("notify_users",ne)},topicable:u.topicable}),ce&&ce===m.oz.GiftQuiz&&(0,e.jsx)(Rs,{onChange:function(ne,qe){ye(ne,qe)},topicable:$.topicable,onAdded:A,onRemoved:A,onEdited:A}),ce&&ce===m.oz.H5P&&(0,e.jsx)(ns,{id:$.value,onChange:function(ne){return ye("value",ne)}}),ce&&ce===m.oz.SCORM&&(0,e.jsx)(Nn,{value:Number($.value),onChange:function(ne){return ye("value",ne)}}),(0,e.jsx)(le.Z,{justify:"center",className:"program__cta-footer",children:(0,e.jsx)(Sn.Z,{offsetBottom:4,children:(0,e.jsxs)(Ut.Z,{size:"large",children:[(0,e.jsx)(Kt(),{loading:et,children:(0,e.jsx)(n.FormattedMessage,{id:"cancel"})}),!u.isNew&&(0,e.jsx)(Kt(),{onClick:_t,loading:et,children:(0,e.jsx)(n.FormattedMessage,{id:"clone"})}),(0,e.jsx)(Kt(),{type:"primary",onClick:nt,disabled:D,loading:et,children:(0,e.jsx)(n.FormattedMessage,{id:"save"})}),(0,e.jsx)(Kt(),{danger:!0,onClick:gt,loading:et,children:(0,e.jsx)(n.FormattedMessage,{id:"delete"})})]})})})]}),(0,e.jsx)(Y.Z,{span:8,children:(0,e.jsxs)("aside",{className:"program-sidebar program-sidebar--right",children:[(i==null?void 0:i.lessons)&&(0,e.jsx)(Jr,{courseId:Number(i==null?void 0:i.id),courseLessons:i==null?void 0:i.lessons,initialValues:$,onValuesChange:function(ne){return Xe(ne)}}),!$.isNew&&(0,e.jsxs)(l.Fragment,{children:[(0,e.jsx)(Ln.Z,{children:(0,e.jsx)(n.FormattedMessage,{id:"file_resources"})}),(0,e.jsx)(ys,{topicId:Number(u==null?void 0:u.id),folder:"course/".concat(i==null?void 0:i.id)})]})]})})]})})},Ns=Bs,yt=t(57818),$n=t(43458),zs=t(13769),Kn=t.n(zs),Ws=["initialValue","onCreate"],$s=l.forwardRef(function(f,r){var a=f.initialValue,o=f.onCreate,s=Kn()(f,Ws),i=(0,l.useState)(""),c=j()(i,2),_=c[0],x=c[1];return(0,e.jsxs)("div",d()(d()({className:"program-sidebar__list-item program-sidebar__list-item--lesson-new",ref:r},s),{},{children:[(0,e.jsx)(On.Z,{}),(0,e.jsx)(Un.Z,{value:_,onChange:function(h){return x(h.target.value)},placeholder:a.title}),(0,e.jsx)("div",{children:(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"create"}),children:(0,e.jsx)(P.ZP,{disabled:!_,size:"small",className:"btn-create-lesson",type:"primary",icon:(0,e.jsx)(ee.Z,{}),onClick:function(){return o(_)}})})})]}))}),Ks=t(16165),ks=function(){return(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23.01",height:"18.077",viewBox:"0 0 23.01 18.077",children:(0,e.jsxs)("g",{id:"Group_5","data-name":"Group 5",transform:"translate(-97.496 -306.965)",children:[(0,e.jsx)("path",{id:"Path_2","data-name":"Path 2",d:"M138.934,401.557s8.685.579,12.972-6.836-11.893-6.747-7.254-1.854,16.02-8.07,16.02-8.07",transform:"translate(-40.906 -77.037)",fill:"none",stroke:"#58c35d",strokeLinecap:"round",strokeWidth:"1"}),(0,e.jsx)("path",{id:"Path_3","data-name":"Path 3",d:"M115.761,306.465h5.332V311.8",transform:"translate(-1.087 1)",fill:"none",stroke:"#58c35d",strokeLinecap:"round",strokeWidth:"1"})]})})},kn=function(r){return(0,e.jsx)(Ks.Z,d()({component:ks},r))},mn=t(21987);function Vs(f,r){return pn.apply(this,arguments)}function pn(){return pn=N()(y()().mark(function f(r,a){return y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.request)("/api/admin/recommender/course/".concat(r," "),d()({method:"GET",useCache:!1},a||{})));case 1:case"end":return s.stop()}},f)})),pn.apply(this,arguments)}function Gs(f,r){return vn.apply(this,arguments)}function vn(){return vn=N()(y()().mark(function f(r,a){return y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.request)("/api/admin/recommender/lesson/".concat(r,"/topic "),d()({method:"GET",useCache:!1},a||{})));case 1:case"end":return s.stop()}},f)})),vn.apply(this,arguments)}var Hs=function(r){var a=(0,l.useState)(),o=j()(a,2),s=o[0],i=o[1];return(0,l.useEffect)(function(){Vs(r).then(function(c){return c.success&&i(c.data)})},[r]),s},Qs=function(r){var a=(0,l.useState)(),o=j()(a,2),s=o[0],i=o[1];return(0,l.useEffect)(function(){Gs(r).then(function(c){return c.success&&i(c.data)})},[r]),s},Js=function(r){return r.includes("H5P")?"H5P":r},Xs=function(r){return(r==null?void 0:r.includes("."))&&(r==null?void 0:r.split(".").join(" "))},Vn=function(r){return Math.min(Math.ceil(Math.abs(r)*100),100)},Ys=function(r){var a=r.recommendedData,o=r.createTopic;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(mn.Z,{className:"recommender__paragraph",children:[(0,e.jsx)(n.FormattedMessage,{id:"recommender.add_exercise"}),(0,e.jsx)("span",{className:"recommender__paragraph--span",children:"".concat(Xs(a==null?void 0:a.topic_type),",")}),(0,e.jsx)("br",{}),(0,e.jsx)(n.FormattedMessage,{id:"recommender.increase"}),(0,e.jsx)("span",{className:"recommender__paragraph--span",children:"".concat(Vn(a.probability),"%.")})]}),(0,e.jsx)(P.ZP,{className:"recommender__button",type:"default",onClick:o,children:(0,e.jsx)(n.FormattedMessage,{id:"recommender.add_button"})})]})},qs=function(){return(0,e.jsx)(mn.Z,{className:"recommender__paragraph",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender.save_exercise"})})},ea=t(56717),ta=t(55241),na=function(){return(0,e.jsxs)("div",{className:"recommender__popover-wrapper",children:[(0,e.jsx)("h3",{className:"recommender__popover-title",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender_info.title"})}),(0,e.jsx)("strong",{className:"recommender__popover-text",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender_info.first_title"})}),(0,e.jsx)("p",{className:"recommender__popover-text",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender_info.first_text"})}),(0,e.jsx)("strong",{className:"recommender__popover-text",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender_info.second_title"})}),(0,e.jsx)("p",{className:"recommender__popover-text",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender_info.second_text"})})]})},Gn=function(){return(0,e.jsx)(ta.Z,{placement:"bottomLeft",content:(0,e.jsx)(na,{}),trigger:"click",showArrow:!1,className:"recommender__popover",children:(0,e.jsx)(ea.Z,{style:{color:"#2DAC34"}})})},ra=function(r){var a=r.courseId,o=r.lessonId,s=r.recommenderType,i=s===void 0?m.Zg.Exercise:s,c=(0,l.useContext)(X._y),_=c.addNewTopic,x=Qs(o),p=(0,l.useCallback)(function(u,v){if(_){var M=_(u,v);n.history.push("/courses/list/".concat(a,"/program/?topic=").concat(M.id))}},[_]),h=function(v){switch(v){case m.Zg.Info:return(0,e.jsx)(qs,{});case m.Zg.Exercise:return x&&(0,e.jsx)(Ys,{createTopic:function(){return p(o,m.oz[Js(x==null?void 0:x.topic_type)])},recommendedData:x});default:return(0,e.jsx)(n.FormattedMessage,{id:"recommender.no_recommendation"})}},A=i===m.Zg.Exercise&&!x;return(0,e.jsxs)("div",{className:"recommender",children:[(0,e.jsx)(kn,{style:{marginTop:"4px"}}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"recommender__title",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender.title"})}),A&&(0,e.jsx)(ue.Z,{}),h(i)]}),(0,e.jsx)(Gn,{})]})},sa=function(r){var a=r.courseId,o=Hs(a);return o&&o.probability&&o.probability>-.016?null:o?(0,e.jsxs)("div",{className:"recommender",children:[(0,e.jsx)(kn,{style:{marginTop:"4px"}}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"recommender__title",children:(0,e.jsx)(n.FormattedMessage,{id:"recommender.title"})}),(0,e.jsxs)(mn.Z,{className:"recommender__paragraph",children:[(0,e.jsx)(n.FormattedMessage,{id:"recommender.finish"}),(0,e.jsx)("strong",{children:"".concat(Vn(o.probability),"%. ")}),(0,e.jsx)("br",{}),(0,e.jsx)(n.FormattedMessage,{id:"recommender.too_long"})]})]}),(0,e.jsx)(Gn,{})]}):(0,e.jsx)(e.Fragment,{})},aa=t(52745),Hn=t(59234),ia=[{type:m.oz.RichText,icon:(0,e.jsx)(dn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"RichText"})},{type:m.oz.OEmbed,icon:(0,e.jsx)(an.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"OEmbed"})},{type:m.oz.Audio,icon:(0,e.jsx)(rn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"Audio"})},{type:m.oz.Video,icon:(0,e.jsx)(ln.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"Video"})},{type:m.oz.H5P,icon:(0,e.jsx)(on.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"H5P"})},{type:m.oz.Image,icon:(0,e.jsx)(sn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"Image"})},{type:m.oz.PDF,icon:(0,e.jsx)(nn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"PDF"})},{type:m.oz.SCORM,icon:(0,e.jsx)(tn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"SCORM"})},{type:m.oz.Project,icon:(0,e.jsx)(un.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"Project"})},{type:m.oz.GiftQuiz,icon:(0,e.jsx)(cn.Z,{}),title:(0,e.jsx)(n.FormattedMessage,{id:"Quiz"})}],oa=function(r){var a=r.onSelected,o=r.positionsToHide,s=(0,l.useState)(!1),i=j()(s,2),c=i[0],_=i[1],x=(0,n.useModel)("@@initialState"),p=x.initialState,h=(0,l.useCallback)(function(v){_(!1),a(v)},[]),A=(0,l.useCallback)((0,$n.a)(p==null?void 0:p.packages),[p==null?void 0:p.packages]),u=(0,l.useCallback)(function(v){var M,D=Object.keys(m.oz).filter(function(R){return m.oz[R]==v}).pop(),C=D&&(p==null||(M=p.config)===null||M===void 0||(M=M.filter(function(R){return R.key===(0,Hn.Wg)(D)})[0])===null||M===void 0?void 0:M.data);if(C)return!0;switch(v){case m.oz.GiftQuiz:return!A(yt.Z.TopicTypeGift);case m.oz.SCORM:return!A(yt.Z.Scorm);case m.oz.Project:return!A(yt.Z.TopicTypeProject);default:return!A(yt.Z.TopicTypes)}},[p]);return(0,e.jsxs)("div",{className:`topic-types-selector topic-types-selector__recommender-wrapper
       `.concat(c?"topic-types-selector--visible":""),children:[(0,e.jsx)(P.ZP,{type:"text",size:"small",onClick:function(){return _(function(M){return!M})},className:"topic-types-selector__recommender--add-btn",icon:c?(0,e.jsx)(aa.Z,{}):(0,e.jsx)(Xt.Z,{}),children:(0,e.jsx)(n.FormattedMessage,{id:"recommender.add_new_exercise"})}),(0,e.jsx)("div",{className:"topic-types-selector__recommender".concat(`
          `,c?"topic-types-selector__recommender--active":""),children:ia.map(function(v){return!(o!=null&&o.includes(v.type))&&!u(v.type)&&(0,e.jsx)(ct.Z,{title:v.title,children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return h(v.type)},icon:v.icon})},v.type)})})]})},la=t(86864),da=function(r){var a=r.onSelected,o=r.onNewLesson,s=r.positionsToHide,i=r.depth,c=i===void 0?0:i,_=(0,l.useState)(!1),x=j()(_,2),p=x[0],h=x[1],A=(0,n.useModel)("@@initialState"),u=A.initialState,v=(0,n.useIntl)(),M=(0,l.useCallback)(function(C){h(!1),a(C)},[]),D=(0,l.useCallback)(function(C){var R,Q,$,Ze,ce,je=Object.keys(m.oz).filter(function(Le){return m.oz[Le]==C}).pop(),we=je&&(u==null||(R=u.config)===null||R===void 0||(R=R.filter(function(Le){return Le.key===(0,Hn.Wg)(je)})[0])===null||R===void 0?void 0:R.data);if(we)return!0;switch(C){case m.oz.GiftQuiz:return!(u!=null&&u.packages&&u!==null&&u!==void 0&&(Q=u.packages)!==null&&Q!==void 0&&Q[yt.Z.TopicTypeGift]);case m.oz.SCORM:return!(u!=null&&u.packages&&u!==null&&u!==void 0&&($=u.packages)!==null&&$!==void 0&&$[yt.Z.Scorm]);case m.oz.Project:return!(u!=null&&u.packages&&u!==null&&u!==void 0&&(Ze=u.packages)!==null&&Ze!==void 0&&Ze[yt.Z.TopicTypeProject]);default:return!(u!=null&&u.packages&&u!==null&&u!==void 0&&(ce=u.packages)!==null&&ce!==void 0&&ce[yt.Z.TopicTypes])}},[u]);return(0,e.jsxs)("div",{className:"topic-types-selector ".concat(p?"topic-types-selector--visible":""),children:[(0,e.jsx)(Ut.Z,{children:(0,e.jsx)(ct.Z,{placement:"top",title:(0,e.jsx)(n.FormattedMessage,{id:"add_new_topic"}),children:(0,e.jsx)(P.ZP,{type:"primary",size:"small",onClick:function(){return h(function(R){return!R})},icon:(0,e.jsx)(Xt.Z,{})})})}),(0,e.jsxs)("div",{className:"topic-types-selector__list ".concat(p?"topic-types-selector__list--visible":""),children:[!(s!=null&&s.includes("lesson"))&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ct.Z,{placement:"right",title:v.messages["Lesson_level-".concat(c)]?(0,e.jsx)(n.FormattedMessage,{id:"Lesson_level-".concat(c)}):(0,e.jsx)(n.FormattedMessage,{id:"Lesson",defaultMessage:"Lesson"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){h(!1),o()},icon:(0,e.jsx)(la.Z,{})})}),(0,e.jsx)($t.Z,{})]}),!(s!=null&&s.includes(m.oz.RichText))&&!D(m.oz.RichText)&&(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"RichText"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return M(m.oz.RichText)},icon:(0,e.jsx)(dn.Z,{})})}),!(s!=null&&s.includes(m.oz.OEmbed))&&!D(m.oz.OEmbed)&&(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"OEmbed"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return M(m.oz.OEmbed)},icon:(0,e.jsx)(an.Z,{})})}),!(s!=null&&s.includes(m.oz.Audio))&&!D(m.oz.Audio)&&(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"Audio"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return M(m.oz.Audio)},icon:(0,e.jsx)(rn.Z,{})})}),!(s!=null&&s.includes(m.oz.Video))&&!D(m.oz.Video)&&(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"Video"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return M(m.oz.Video)},icon:(0,e.jsx)(ln.Z,{})})}),!(s!=null&&s.includes(m.oz.H5P))&&!D(m.oz.H5P)&&(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"H5P"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return M(m.oz.H5P)},icon:(0,e.jsx)(on.Z,{})})}),!(s!=null&&s.includes(m.oz.Image))&&!D(m.oz.Image)&&(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"Image"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return M(m.oz.Image)},icon:(0,e.jsx)(sn.Z,{})})}),!(s!=null&&s.includes(m.oz.PDF))&&!D(m.oz.PDF)&&(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"PDF"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return M(m.oz.PDF)},icon:(0,e.jsx)(nn.Z,{})})}),!(s!=null&&s.includes(m.oz.SCORM))&&!D(m.oz.SCORM)&&(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"SCORM"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return M(m.oz.SCORM)},icon:(0,e.jsx)(tn.Z,{})})}),!(s!=null&&s.includes(m.oz.Project))&&!D(m.oz.Project)&&(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"Project"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return M(m.oz.Project)},icon:(0,e.jsx)(un.Z,{})})}),!(s!=null&&s.includes(m.oz.GiftQuiz))&&!D(m.oz.GiftQuiz)&&(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:"Quiz"}),children:(0,e.jsx)(P.ZP,{block:!0,onClick:function(){return M(m.oz.GiftQuiz)},icon:(0,e.jsx)(cn.Z,{})})})]})]})},ua=t(70227),ft=function(f){return f.New="new",f.Lesson="lesson",f.Topic="topic",f}({}),Qn=function(r,a){return r.map(function(o){return d()(d()({},o),{},{id:"topic-".concat(o.id,"-").concat(a)})})},ca=function(r,a){return r.map(function(o){return d()(d()({},o),{},{id:o.isNew?"new-".concat(o.id,"-").concat(a):"lesson-".concat(o.id,"-").concat(a)})})},Jn=function(r,a){var o,s;return d()(d()({},r),{},{id:r.isNew?"new-".concat(r.id,"-").concat(a):"lesson-".concat(r.id,"-").concat(a),lessons:ca((o=r==null?void 0:r.lessons)!==null&&o!==void 0?o:[],a+1),topics:Qn((s=r==null?void 0:r.topics)!==null&&s!==void 0?s:[],a+1)})},ma=function f(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return r.reduce(function(o,s){var i;return[].concat(g()(o),g()(f((i=s==null?void 0:s.lessons)!==null&&i!==void 0?i:[],a+1)),[Jn(s,a)])},[])},pa=function f(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return r.reduce(function(o,s){var i,c;return[].concat(g()(o),g()(f((i=s==null?void 0:s.lessons)!==null&&i!==void 0?i:[],a+1)),g()(Qn((c=s==null?void 0:s.topics)!==null&&c!==void 0?c:[],a)))},[])},va=function(r){return r.map(function(a){var o,s,i=Jn(a,0),c=[].concat(g()((o=i.lessons)!==null&&o!==void 0?o:[]),g()((s=i.topics)!==null&&s!==void 0?s:[])).map(function(_){var x=_.id;return x});return{id:i.id,children:c,hasChildren:c.length>0,isExpanded:!0,data:i}})},fa=function(r,a){return r.reduce(function(o,s){var i,c,_=[];if("lessons"in s||"topics"in s){var x,p;_=[].concat(g()((x=s.lessons)!==null&&x!==void 0?x:[]),g()((p=s.topics)!==null&&p!==void 0?p:[])).map(function(A){var u=A.id;return u})}var h=(i=a==null||(c=a["".concat(s.id)])===null||c===void 0?void 0:c.isExpanded)!==null&&i!==void 0?i:!0;return d()(d()({},o),{},I()({},"".concat(s.id),{id:s.id,children:_,hasChildren:_.length>0,isExpanded:h,data:s}))},{})},fn=function(r,a,o){var s=g()(r),i=a%s.length,c=o%s.length,_=s.splice(i,1),x=j()(_,1),p=x[0];return s.splice(c,0,p),s},Gt=function(r,a,o){var s=g()(r),i=s.length===1||a===s.length?a:a%s.length;return s.splice(i,0,o),s},Tt=function(r){return r.map(function(a,o){var s=a.toString().split("-"),i=j()(s,2),c=i[1];return[+c,o]})},It=function(){var f=N()(y()().mark(function r(a,o,s){var i,c;return y()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return i=void 0,a(function(p){return i=p,ua.d.apply(void 0,[p].concat(g()(o)))}),x.prev=2,x.next=5,s();case 5:c=x.sent,W()(c)==="object"&&c!==null&&"success"in c&&typeof c.success=="boolean"&&!c.success&&i&&a(i),x.next=12;break;case 9:x.prev=9,x.t0=x.catch(2),i&&a(i);case 12:case"end":return x.stop()}},r,null,[[2,9]])}));return function(a,o,s){return f.apply(this,arguments)}}(),ga=function(r,a){return Object.values(r.items).find(function(o){var s=o.children;return s.includes(a)})},Xn=function(r,a,o){var s,i;return(s=(i=r.items)===null||i===void 0||(i=i[a])===null||i===void 0||(i=i.children)===null||i===void 0?void 0:i.indexOf(o))!==null&&s!==void 0?s:-1},_a=function(r){var a=r.onNewLesson,o=(0,l.useContext)(X._y),s=o.state,i=o.currentEditMode,c=o.updateLesson,_=o.addNewTopic,x=o.addNewLesson,p=o.getLessons,h=s==null?void 0:s.id,A=(0,l.useMemo)(function(){var Ce;return va((Ce=s==null?void 0:s.lessons)!==null&&Ce!==void 0?Ce:[])},[s==null?void 0:s.lessons]),u=(0,l.useMemo)(function(){var Ce,q;return[].concat(g()(ma((Ce=s==null?void 0:s.lessons)!==null&&Ce!==void 0?Ce:[])),g()(pa((q=s==null?void 0:s.lessons)!==null&&q!==void 0?q:[])))},[s==null?void 0:s.lessons]),v=(0,l.useState)({rootId:0,items:{}}),M=j()(v,2),D=M[0],C=M[1],R=(0,n.useModel)("@@initialState"),Q=R.initialState,$=(0,n.useIntl)(),Ze=(0,l.useCallback)((0,$n.a)(Q==null?void 0:Q.packages),[Q==null?void 0:Q.packages]);(0,l.useEffect)(function(){C(function(Ce){var q={children:A.map(function(w){var Ve=w.id;return Ve}),id:"root",data:A,isExpanded:!0,hasChildren:A.length>0},pe=fa(u,Ce.items);return{rootId:q.id,items:d()(d()({},pe),{},I()({},q.id,q))}})},[u]);var ce=(0,l.useCallback)(function(Ce,q){if(_){var pe=_(Ce,q);n.history.push("/courses/list/".concat(h,"/program/?topic=").concat(pe.id))}},[_]),je=(0,l.useMemo)(function(){var Ce;return((Ce=Q==null?void 0:Q.config)!==null&&Ce!==void 0?Ce:[]).reduce(function(q,pe){return pe.key==="maxLessonsNestingInProgram"?d()(d()({},q),{},{lesson:pe.data}):pe.key==="minTopicNestingInProgram"?d()(d()({},q),{},{topic:pe.data}):q},{})},[Q==null?void 0:Q.config]),we=(0,l.useCallback)(function(Ce){var q,pe,w=[],Ve=(q=je==null?void 0:je.lesson)!==null&&q!==void 0?q:.5,ye=(pe=je==null?void 0:je.topic)!==null&&pe!==void 0?pe:.5;return Number.isInteger(Ve)&&Ce>Ve&&w.push("lesson"),Number.isInteger(ye)&&Ce<ye&&Object.values(m.oz).forEach(function(Xe){return w.push(Xe)}),w},[je]),Le=(0,l.useCallback)(function(Ce){var q,pe,w=Ce.item,Ve=Ce.depth,ye=Ce.provided,Xe=Ce.onExpand,Pt=Ce.onCollapse,nt=w.id.toString().split("-"),gt=j()(nt,2),_t=gt[0],Te=gt[1],ne=Number(Te),qe=function(Je,it){var We,Ie=u.find(function(Ye){return Ye.id.includes(String(Je))}),ge=Ie==null||(We=Ie.topics)===null||We===void 0?void 0:We[Ie.topics.length-1];return(ge==null?void 0:ge.id)===it};return _t==="new"&&w.data.isNew?(0,e.jsx)($s,d()(d()(d()({},ye.draggableProps),ye.dragHandleProps),{},{ref:ye.innerRef,initialValue:w.data,onCreate:function(Je){var it=dt(d()(d()({},w.data),{},{parent_lesson_id:w.data.parent_id,title:Je,active:w.data.active?1:0}));c&&c(ne,it)}})):_t==="lesson"?(0,e.jsxs)("div",d()(d()(d()({},ye.draggableProps),ye.dragHandleProps),{},{ref:ye.innerRef,className:"program-sidebar__list-item program-sidebar__list-item--lesson ".concat((i==null?void 0:i.mode)==="lesson"&&i.id===ne?"program-sidebar__list-item--active":""),children:[(0,e.jsxs)("div",{className:"program-sidebar__text-wrap",children:[(0,e.jsx)("button",{className:"program-sidebar__collapse",onClick:function(){return w.isExpanded?Pt(w.id):Xe(w.id)},children:w.isExpanded?(0,e.jsx)(Kr.Z,{}):(0,e.jsx)(On.Z,{})}),(0,e.jsx)(ct.Z,{placement:"top",title:w.data.title,children:(0,e.jsx)(n.NavLink,{to:"/courses/list/".concat(h,"/program/?").concat(_t,"=").concat(ne),className:"program-sidebar__link",children:(0,e.jsx)("span",{className:"program-sidebar__title",children:w.data.title})})})]}),(0,e.jsx)(da,{onNewLesson:function(){x&&x(ne)},onSelected:function(Je){return ce(ne,Je)},positionsToHide:we(Ve+1),depth:Ve})]})):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.NavLink,d()(d()(d()({className:"program-sidebar__link program-sidebar__list-item program-sidebar__list-item--topic ".concat((i==null?void 0:i.mode)==="topic"&&i.id===ne?"program-sidebar__list-item--active":""),to:"/courses/list/".concat(h,"/program/?").concat(_t,"=").concat(ne)},ye.draggableProps),ye.dragHandleProps),{},{ref:ye.innerRef,children:[(0,e.jsx)(ct.Z,{placement:"right",title:(0,e.jsx)(n.FormattedMessage,{id:qt(w.data)}),children:zn(qt(w.data))}),(0,e.jsx)("span",{className:"title",children:w.data.title})]})),Ze(yt.Z.Recommender)&&h&&(i==null?void 0:i.mode)==="topic"&&(i==null||(q=i.value)===null||q===void 0?void 0:q.lesson_id)&&(i==null||(pe=i.value)===null||pe===void 0?void 0:pe.lesson_id)===w.data.lesson_id&&qe(i.value.lesson_id,w.data.id)&&(0,e.jsxs)(e.Fragment,{children:[u.length>5&&(0,e.jsx)(sa,{courseId:h}),(0,e.jsx)(ra,{courseId:h,lessonId:i.value.lesson_id,recommenderType:i.value.isNew?m.Zg.Info:m.Zg.Exercise}),(0,e.jsx)(oa,{onSelected:function(Je){return ce(w.data.lesson_id,Je)},positionsToHide:we(Ve+1)})]})]})},[h,i]),at=(0,l.useCallback)(function(Ce){return C(function(q){return(0,Dn.U)(q,Ce,{isExpanded:!0})})},[]),vt=(0,l.useCallback)(function(Ce){return C(function(q){return(0,Dn.U)(q,Ce,{isExpanded:!1})})},[]),et=(0,l.useCallback)(function(){var Ce=N()(y()().mark(function q(pe,w){var Ve,ye,Xe,Pt,nt,gt,_t,Te,ne,qe,ut,Je,it,We,Ie,ge,Ye,tt,xt,ht,Ft,ot,Ot,qn,er,tr,nr,rr,sr,wt,ar,ir,or,lr,dr,ur,cr,Ht,mr,pr,vr,fr,gr,_r,hr,jr,xr,Mn,Pn,Bt,br,Cn,yn,Mr,Nt,Dt,Pr,Cr,yr,Er,Sr,Tr,Ir,Ar,En,Qt,zt,Lt,Zr,Fr,Or,Dr,Lr,Rr,Ur;return y()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:if(!(!w||!h)){se.next=2;break}return se.abrupt("return");case 2:if(Ve=D.items[pe.parentId].children,ye=Ve[pe.index].toString(),Xe=ye.split("-"),Pt=j()(Xe,2),nt=Pt[0],gt=Pt[1],_t=D.items[w.parentId].children,Te=je==null?void 0:je.lesson,ne=je==null?void 0:je.topic,nt!==ft.New){se.next=11;break}return z.ZP.warning($.formatMessage({id:"new_lessons_cant_be_moved"})),se.abrupt("return");case 11:if(!w.parentId.toString().includes("topic")){se.next=63;break}if(it=Ve.filter(function(jt){return jt.toString().includes("topic")}),We=ga(D,w.parentId),Ie=Number((qe=(ut=((Je=We==null?void 0:We.id)!==null&&Je!==void 0?Je:"").toString().split("-"))===null||ut===void 0?void 0:ut[2])!==null&&qe!==void 0?qe:-2)+1,!(nt===ft.Lesson&&Te!==void 0&&Ie>Te)){se.next=18;break}return z.ZP.warning($.formatMessage({id:"max_lesson_nesting"},{max:Te})),se.abrupt("return");case 18:if(!(nt===ft.Topic&&ne!==void 0&&Ie<ne)){se.next=21;break}return z.ZP.warning($.formatMessage({id:"min_topic_nesting"},{min:ne})),se.abrupt("return");case 21:if(!((We==null?void 0:We.id)!==void 0&&pe.parentId===We.id)){se.next=35;break}if(nt!==ft.Lesson){se.next=25;break}return z.ZP.warning($.formatMessage({id:"lessons_and_topics_cant_be_mixed"})),se.abrupt("return");case 25:if(nt!==ft.Topic){se.next=35;break}if(ge=Xn(D,We.id,w.parentId),!(ge<0)){se.next=29;break}return se.abrupt("return");case 29:return Ye=fn(it,pe.index,ge),tt=Tt(Ye),se.next=33,It(C,[pe,{parentId:We.id,index:ge}],function(){return(0,L.DY)({class:"Topic",orders:tt,course_id:h})});case 33:return p==null||p(),se.abrupt("return");case 35:if(!((We==null?void 0:We.id)!==void 0&&pe.parentId!==We.id)){se.next=62;break}if(xt=We.children.filter(function(jt){return jt.toString().includes("lesson")}),ht=We.children.filter(function(jt){return jt.toString().includes("topic")}),nt!==ft.Lesson){se.next=50;break}return Ft=xt.length,ot=We.id.toString().split("-"),Ot=j()(ot,2),qn=Ot[1],er=D.items[ye].data,tr={parent_lesson_id:We.id==="root"?"":+qn,course_id:h,title:er.title,order:Ft},nr=dt(tr),rr=Gt(xt,Ft,ye),sr=Tt(rr),se.next=48,It(C,[pe,d()(d()({},w),{},{index:Ft})],function(){return(0,L.sI)(+gt,nr).then(function(){return(0,L.DY)({class:"Lesson",orders:sr,course_id:h})})});case 48:return p==null||p(),se.abrupt("return");case 50:if(nt!==ft.Topic){se.next=62;break}if(wt=Xn(D,We.id,w.parentId)+1,!(wt<1)){se.next=54;break}return se.abrupt("return");case 54:return ar=We.id.toString().split("-"),ir=j()(ar,2),or=ir[1],lr={lesson_id:+or,order:wt},dr=Gt(ht,wt-xt.length,ye),ur=Tt(dr),cr=dt(lr),se.next=61,It(C,[pe,{parentId:We.id,index:wt}],function(){return(0,L.Cn)(+gt,cr).then(function(){return(0,L.DY)({class:"Topic",orders:ur,course_id:h})})});case 61:p==null||p();case 62:return se.abrupt("return");case 63:if(!(w.parentId==="root"&&nt===ft.Topic)){se.next=66;break}return z.ZP.warning($.formatMessage({id:"topic_cant_be_in_root"})),se.abrupt("return");case 66:if(!(pe.parentId===w.parentId&&w.index!==void 0)){se.next=93;break}if(Ht=Ve.filter(function(jt){return jt.toString().includes("lesson")}),mr=Ve.filter(function(jt){return jt.toString().includes("topic")}),nt!==ft.Lesson){se.next=81;break}if(pr=0,vr=Ht.length-1,!(w.index<pr||w.index>vr)){se.next=75;break}return z.ZP.warning($.formatMessage({id:"lessons_and_topics_cant_be_mixed"})),se.abrupt("return");case 75:return fr=fn(Ht,pe.index,w.index),gr=Tt(fr),se.next=79,It(C,[pe,w],function(){return(0,L.DY)({class:"Lesson",orders:gr,course_id:h})});case 79:return p==null||p(),se.abrupt("return");case 81:if(nt!==ft.Topic){se.next=93;break}if(_r=Ht.length,hr=Ve.length-1,!(w.index<_r||w.index>hr)){se.next=87;break}return z.ZP.warning($.formatMessage({id:"lessons_and_topics_cant_be_mixed"})),se.abrupt("return");case 87:return jr=fn(mr,pe.index,w.index),xr=Tt(jr),se.next=91,It(C,[pe,w],function(){return(0,L.DY)({class:"Topic",orders:xr,course_id:h})});case 91:return p==null||p(),se.abrupt("return");case 93:if(pe.parentId===w.parentId){se.next=135;break}if(Bt=_t.filter(function(jt){return jt.toString().includes("lesson")}),br=_t.filter(function(jt){return jt.toString().includes("topic")}),Cn=Number((Mn=(Pn=w.parentId.toString().split("-"))===null||Pn===void 0?void 0:Pn[2])!==null&&Mn!==void 0?Mn:-2)+1,!(nt===ft.Lesson&&Te!==void 0&&Cn>Te)){se.next=100;break}return z.ZP.warning($.formatMessage({id:"max_lesson_nesting"},{max:Te})),se.abrupt("return");case 100:if(!(nt===ft.Topic&&ne!==void 0&&Cn<ne)){se.next=103;break}return z.ZP.warning($.formatMessage({id:"min_topic_nesting"},{min:ne})),se.abrupt("return");case 103:if(nt!==ft.Lesson){se.next=120;break}if(Mr=0,Nt=Bt.length,Dt=(yn=w.index)!==null&&yn!==void 0?yn:Nt,!(Nt!==0&&Dt<Mr||Nt!==0&&Dt>Nt)){se.next=110;break}return z.ZP.warning($.formatMessage({id:"lessons_and_topics_cant_be_mixed"})),se.abrupt("return");case 110:return Pr=w.parentId.toString().split("-"),Cr=j()(Pr,2),yr=Cr[1],Er=D.items[ye].data,Sr={parent_lesson_id:w.parentId==="root"?"":+yr,course_id:h,title:Er.title,order:Dt},Tr=dt(Sr),Ir=Gt(Bt,Dt,ye),Ar=Tt(Ir),se.next=118,It(C,[pe,d()(d()({},w),{},{index:Dt})],function(){return(0,L.sI)(+gt,Tr).then(function(){return(0,L.DY)({class:"Lesson",orders:Ar,course_id:h})})});case 118:return p==null||p(),se.abrupt("return");case 120:if(nt!==ft.Topic){se.next=135;break}if(Qt=Bt.length,zt=_t.length,Lt=(En=w.index)!==null&&En!==void 0?En:zt,!(Qt!==0&&zt!==0&&Lt<Qt||Qt!==0&&zt!==0&&Lt>zt)){se.next=127;break}return z.ZP.warning($.formatMessage({id:"lessons_and_topics_cant_be_mixed"})),se.abrupt("return");case 127:return Zr=w.parentId.toString().split("-"),Fr=j()(Zr,2),Or=Fr[1],Dr={lesson_id:+Or,order:Lt},Lr=Gt(br,Lt-Bt.length,ye),Rr=Tt(Lr),Ur=dt(Dr),se.next=134,It(C,[pe,d()(d()({},w),{},{index:Lt})],function(){return(0,L.Cn)(+gt,Ur).then(function(){return(0,L.DY)({class:"Topic",orders:Rr,course_id:h})})});case 134:p==null||p();case 135:case"end":return se.stop()}},q)}));return function(q,pe){return Ce.apply(this,arguments)}}(),[$,D,h,je]);return(0,e.jsxs)("div",{style:{height:"100%"},children:[(0,e.jsx)(kr.Z,{offsetPerLevel:9,tree:D,onExpand:at,onCollapse:vt,onDragEnd:et,renderItem:Le,isDragEnabled:!0,isNestingEnabled:!0}),(0,e.jsx)(P.ZP,{onClick:a,type:"primary",className:"program-sidebar__add-btn",icon:(0,e.jsx)(Xt.Z,{}),children:(0,e.jsx)("span",{children:(0,e.jsx)(n.FormattedMessage,{id:"add_lesson"})})})]})},ha=function(){var r=(0,l.useContext)(X._y),a=r.state,o=r.addNewLesson,s=(0,l.useCallback)(function(){if(o&&a){var i=o();n.history.push("/courses/list/".concat(a.id,"/program/?lesson=").concat(i.id))}},[o,a]);return a&&a.lessons?(0,e.jsx)("aside",{className:"program-sidebar program-sidebar--left ".concat(a.lessons.length>0?"":"program-sidebar--empty"),children:(0,e.jsx)(_a,{onNewLesson:s})}):(0,e.jsx)("div",{children:(0,e.jsx)(ue.Z,{})})},ja=ha,xa=function(){var r=(0,l.useContext)(X._y),a=r.state,o=r.currentEditMode,s=de.Z.Title;return a&&a.lessons?(0,e.jsxs)("div",{className:"course-block",children:[(0,e.jsxs)(le.Z,{gutter:16,children:[(0,e.jsx)(Y.Z,{span:4,children:(0,e.jsx)(ja,{})}),(0,e.jsxs)(Y.Z,{span:24-4,children:[o&&o.mode==="lesson"&&o.value&&(0,e.jsx)($r,{},o.id),o&&o.mode==="topic"&&o.value&&(0,e.jsx)(Ns,{},o.id),o&&o.mode==="init"&&(0,e.jsxs)(le.Z,{style:{height:"100%"},children:[(0,e.jsx)(Y.Z,{span:16,children:(0,e.jsx)("div",{className:"program__empty-message",children:a.lessons.length>0?(0,e.jsx)(s,{level:4,children:(0,e.jsx)(Se.Z,{id:"program_form_not_selected_list_message"})}):(0,e.jsx)(s,{level:4,children:(0,e.jsx)(Se.Z,{id:"program_form_empty_list_message"})})})}),(0,e.jsx)(Y.Z,{span:8,children:(0,e.jsx)("aside",{className:"program-sidebar program-sidebar--right"})})]})]})]}),(0,e.jsx)("div",{className:"curriculum-lessons-wrapper"})]}):(0,e.jsx)("div",{children:(0,e.jsx)(ue.Z,{})})},ba=xa,Ma=function(r){var a=r.id;return(0,e.jsxs)(X.Il,{id:Number(a),children:[(0,e.jsx)(ba,{})," "]})},Pa=Ma;function Ca(f,r){return gn.apply(this,arguments)}function gn(){return gn=N()(y()().mark(function f(r,a){return y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.request)("/api/admin/topic-project-solutions",d()({params:d()(d()({},r),{},{per_page:r.pageSize,page:r.current}),method:"GET",useCache:!1},a||{})));case 1:case"end":return s.stop()}},f)})),gn.apply(this,arguments)}function ya(f,r){return _n.apply(this,arguments)}function _n(){return _n=N()(y()().mark(function f(r,a){return y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.request)("/api/admin/topic-project-solutions/".concat(r),d()({method:"DELETE"},a||{})));case 1:case"end":return s.stop()}},f)})),_n.apply(this,arguments)}var Ea=["type","defaultRender"],Sa=function(){var f=N()(y()().mark(function r(a){var o;return y()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,ya(a);case 2:return o=i.sent,o.success&&z.ZP.success(o.message),i.abrupt("return",!0);case 5:case"end":return i.stop()}},r)}));return function(a){return f.apply(this,arguments)}}(),Ta=function f(r){return r.reduce(function(a,o){var s;return[].concat(g()(a),g()(o.lessons?f(o.lessons):[]),g()((s=o.topics)!==null&&s!==void 0?s:[]))},[])},Ia=function(r){var a=r.courseId,o=(0,n.useIntl)(),s=(0,l.useState)([]),i=j()(s,2),c=i[0],_=i[1],x=(0,l.useMemo)(function(){return c.reduce(function(h,A){var u,v,M;return d()(d()({},h),{},I()({},(u=A.id)!==null&&u!==void 0?u:-1,{text:(v=A.title)!==null&&v!==void 0?v:"",status:(M=A.id)!==null&&M!==void 0?M:-1}))},{})},[c]),p=(0,l.useMemo)(function(){return[{title:(0,e.jsx)(n.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,e.jsx)(n.FormattedMessage,{id:"topic",defaultMessage:"topic"}),dataIndex:"topic_id",hideInSearch:!1,sorter:!0,valueEnum:x,render:function(A,u){var v,M;return(0,e.jsx)(n.Link,{to:"/courses/list/".concat(a,"/program/?topic=").concat(u.topic_id),children:(v=x==null||(M=x[u.topic_id])===null||M===void 0?void 0:M.text)!==null&&v!==void 0?v:u.topic_id})}},{sorter:!0,title:(0,e.jsx)(n.FormattedMessage,{id:"user",defaultMessage:"user"}),dataIndex:"user_id",renderFormItem:function(A,u,v){var M=u.type,D=u.defaultRender,C=Kn()(u,Ea);if(M==="form")return null;var R=v.getFieldValue("state");return(0,e.jsx)(Vt.Z,d()(d()({},C),{},{state:{type:R}}))},render:function(A,u){return u.user_id&&(0,e.jsx)(K.Z,{type:"EscolaLms\\Core\\Models\\User",type_id:u.user_id},"user")}},{sorter:!0,title:(0,e.jsx)(n.FormattedMessage,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",hideInSearch:!0,render:function(A,u){return u.created_at&&(0,H.WU)(new Date(u.created_at),B.Cu)}},{title:(0,e.jsx)(n.FormattedMessage,{id:"download",defaultMessage:"Download"}),dataIndex:"file_url",hideInSearch:!0,render:function(A,u){return(0,e.jsx)(P.ZP,{type:"primary",target:"_blank",size:"small",href:u.file_url,children:(0,e.jsx)(n.FormattedMessage,{id:"download",defaultMessage:"Download"})})}},{hideInSearch:!0,title:(0,e.jsx)(n.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"option"}),dataIndex:"option",valueType:"option",render:function(A,u,v,M){return[(0,e.jsx)(Tn.Z,{title:(0,e.jsx)(n.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:N()(y()().mark(function D(){var C;return y()().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.next=2,Sa(u.id);case 2:if(C=Q.sent,C){Q.next=5;break}return Q.abrupt("return");case 5:M==null||M.reload();case 6:case"end":return Q.stop()}},D)})),okText:(0,e.jsx)(n.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(n.FormattedMessage,{id:"no"}),children:(0,e.jsx)(ct.Z,{title:(0,e.jsx)(n.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(P.ZP,{type:"primary",icon:(0,e.jsx)(Bn.Z,{}),danger:!0})})},"delete")]}}]},[x]);return(0,l.useEffect)(function(){a&&(0,L.Nx)(a).then(function(h){if(h.success){var A=Ta(h.data.lessons).filter(function(u){return u.topicable_type===m.oz.Project});_(A)}})},[a]),(0,e.jsx)(V.ZP,{headerTitle:o.formatMessage({id:"project_solutions",defaultMessage:"Project Uploaded Solutions"}),search:{layout:"vertical"},rowKey:"id",request:function(){var h=N()(y()().mark(function A(u,v){var M,D,C,R,Q,$,Ze;return y()().wrap(function(je){for(;;)switch(je.prev=je.next){case 0:return M=u.pageSize,D=u.current,C=u.user_id,R=u.topic_id,Q=v&&Object.entries(v)[0],$=Q&&Q[0],je.next=5,Ca({pageSize:M,current:D,course_id:a,user_id:C,topic_id:R,order_by:$,order:Q?Q[1]==="ascend"?"ASC":"DESC":void 0});case 5:if(Ze=je.sent,Ze.success){je.next=8;break}return je.abrupt("return",{data:[],total:0,success:!1});case 8:return je.abrupt("return",{data:Ze.data,total:Ze.meta.total,success:!0});case 9:case"end":return je.stop()}},A)}));return function(A,u){return h.apply(this,arguments)}}(),columns:p})},Ja=null,Aa=t(39470),Za=t(54434),Fa=t(14408),Oa=function(r){var a=r.visible,o=a===void 0?!1:a,s=r.handleOk,i=r.handleCancel;return(0,e.jsx)(Yt.Z,{title:(0,e.jsx)(Mt._H,{id:"course_success_modal_title",defaultMessage:"course_success_modal_title"}),visible:o,onOk:s,onCancel:i,footer:[(0,e.jsx)(P.ZP,{onClick:i,children:(0,e.jsx)(Mt._H,{id:"course_success_modal_button_cancel",defaultMessage:"course_success_modal_button_cancel"})},"link"),(0,e.jsx)(P.ZP,{type:"primary",onClick:s,children:(0,e.jsx)(Mt._H,{id:"course_success_modal_button_ok",defaultMessage:"course_success_modal_button_ok"})},"link")],children:(0,e.jsx)("p",{children:(0,e.jsx)(Mt._H,{id:"course_success_modal_content",defaultMessage:"course_success_modal_content"})})})},Yn=t(64317),Da=t(74453),La=t(76560),Ra=function(r){var a=r.id;return(0,e.jsxs)(Pe.ZP,{onFinish:function(){var o=N()(y()().mark(function s(i){return y()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:(0,L.O1)(Number(a),i).then(function(x){x.success&&z.ZP.success(x.message)});case 1:case"end":return _.stop()}},s)}));return function(s){return o.apply(this,arguments)}}(),request:function(){return(0,L.Pd)(Number(a)).then(function(s){return s.success?{users:s.data.users.map(function(i){return W()(i)==="object"?i.id:i}),groups:s.data.groups.map(function(i){return W()(i)==="object"?i.id:i})}:{users:[],groups:[]}})},children:[(0,e.jsx)(Pe.ZP.Item,{valuePropName:"value",name:"users",label:(0,e.jsx)(n.FormattedMessage,{id:"users",defaultMessage:"Users"}),children:(0,e.jsx)(Vt.Z,{multiple:!0})}),(0,e.jsx)(Pe.ZP.Item,{valuePropName:"value",name:"groups",label:(0,e.jsx)(n.FormattedMessage,{id:"groups",defaultMessage:"Groups"}),children:(0,e.jsx)(La.Z,{multiple:!0})})]})},Ua=Ra;function wa(f,r){return hn.apply(this,arguments)}function hn(){return hn=N()(y()().mark(function f(r,a){return y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.request)("/api/admin/templates/assignable",d()({method:"GET",useCache:!1,params:r},a||{})));case 1:case"end":return s.stop()}},f)})),hn.apply(this,arguments)}function Ba(f,r,a){return jn.apply(this,arguments)}function jn(){return jn=N()(y()().mark(function f(r,a,o){return y()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,n.request)("/api/admin/templates/".concat(r,"/assign"),d()({method:"POST",headers:{"Content-Type":"application/json"},data:a},o||{})));case 1:case"end":return i.stop()}},f)})),jn.apply(this,arguments)}function Na(f,r,a){return xn.apply(this,arguments)}function xn(){return xn=N()(y()().mark(function f(r,a,o){return y()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,n.request)("/api/admin/templates/".concat(r,"/unassign"),d()({method:"POST",headers:{"Content-Type":"application/json"},data:a},o||{})));case 1:case"end":return i.stop()}},f)})),xn.apply(this,arguments)}function za(f,r){return bn.apply(this,arguments)}function bn(){return bn=N()(y()().mark(function f(r,a){return y()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,n.request)("/api/admin/templates/assigned",d()({params:r,method:"GET",useCache:!1},a||{})));case 1:case"end":return s.stop()}},f)})),bn.apply(this,arguments)}var Wa=function(r){var a=r.onChange,o=r.multiple,s=o===void 0?!1:o,i=r.assignable_class,c=r.assignable_id,_=r.onAssign,x=r.onUnassign,p=r.onTemplates,h=(0,l.useState)([]),A=j()(h,2),u=A[0],v=A[1],M=(0,l.useState)([]),D=j()(M,2),C=D[0],R=D[1],Q=(0,l.useState)(!1),$=j()(Q,2),Ze=$[0],ce=$[1],je=(0,l.useRef)(),we=(0,l.useCallback)(function(q){v(q),p&&p(q)},[p]),Le=(0,l.useCallback)(function(){za({assignable_class:i,assignable_id:Number(c)}).then(function(q){q.success&&R(q.data.map(function(pe){return pe.id}))})},[i,c]),at=(0,l.useCallback)(function(){return ce(!0),je.current&&je.current.abort(),je.current=new AbortController,wa({assignable_class:i},{signal:je.current.signal}).then(function(q){q&&q.success&&we(q.data),ce(!1)}).catch(function(){return ce(!1)}),function(){je.current&&je.current.abort()}},[i,c]),vt=(0,l.useCallback)(function(q){R(function(pe){return pe.filter(function(w){return w!=q})})},[]),et=(0,l.useCallback)(function(q){R(function(pe){return pe.includes(q)?pe:[].concat(g()(pe),[q])})},[]),Ce=(0,l.useCallback)(function(q){var pe=Array.isArray(q)?q:[q],w=pe.filter(function(ye){return!C.includes(ye)}),Ve=C.filter(function(ye){return!pe.includes(ye)});w.forEach(function(ye){Ba(ye,{assignable_id:Number(c)}).then(function(Xe){Xe.success&&z.ZP.success(Xe.message),Xe.success||(z.ZP.error(Xe.message),vt(ye))}).catch(function(Xe){z.ZP.error(Xe.toString()),vt(ye)})}),Ve.forEach(function(ye){Na(ye,{assignable_id:Number(c)}).then(function(Xe){Xe.success&&z.ZP.success(Xe.message),Xe.success||(z.ZP.error(Xe.message),et(ye))}).catch(function(Xe){z.ZP.error(Xe.toString()),et(ye)})}),w.length!=0&&_&&_(w),Ve.length!=0&&x&&x(Ve),R(pe)},[C,c,_,x]);return(0,l.useEffect)(function(){at(),Le()},[i,c]),(0,l.useEffect)(function(){a&&a(C)},[C,a]),(0,e.jsx)(St.default,{style:{width:"100%"},value:C,onChange:Ce,mode:s?"multiple":void 0,showSearch:!0,placeholder:(0,e.jsx)(n.FormattedMessage,{id:"select_templates",defaultMessage:"Select a templates"}),optionFilterProp:"children",filterOption:function(pe,w){if(w&&w.children){var Ve;return(w==null||(Ve=w.children)===null||Ve===void 0?void 0:Ve.toString().toLowerCase().indexOf(pe.toLowerCase()))>=0}return!0},notFoundContent:Ze?(0,e.jsx)(ue.Z,{size:"small"}):null,children:u.map(function(q){return(0,e.jsxs)(St.default.Option,{value:q.id,children:[q.name," ",(0,e.jsxs)("small",{children:[(0,e.jsx)(n.FormattedMessage,{id:q.channel.split("\\").pop()}),":",(0,e.jsx)(n.FormattedMessage,{id:q.event.split("\\").pop()})]})," "]},q.id)})})},$a=Wa,Ka=t(34201),ka=function(r){var a=r.id,o=de.Z.Text,s=(0,l.useState)([]),i=j()(s,2),c=i[0],_=i[1],x=(0,l.useState)([]),p=j()(x,2),h=p[0],A=p[1],u=(0,l.useMemo)(function(){return h.map(function(v){return c.find(function(M){return M.id===v})}).filter(function(v){return v!==void 0}).filter(function(v){return v&&v.channel==="EscolaLms\\TemplatesPdf\\Core\\PdfChannel"})},[c,h]);return(0,e.jsxs)("div",{children:[(0,e.jsxs)(le.Z,{align:"middle",children:[(0,e.jsx)(Y.Z,{span:3,children:(0,e.jsx)(o,{children:(0,e.jsx)(n.FormattedMessage,{id:"CertificateTemplates",defaultMessage:"Users"})})}),(0,e.jsx)(Y.Z,{span:12,children:(0,e.jsx)($a,{onTemplates:function(M){return _(M)},assignable_class:"EscolaLms\\Courses\\Models\\Course",assignable_id:Number(a),multiple:!0,onChange:function(M){return A(M)}})})]}),u.map(function(v){return v&&(0,e.jsx)(Ka.Z,{template_id:v.id,title:v.name},v.id)})]})},Va=ka,Ga=t(18025),Ha=t(28808),pt=function(f){return f.ATTRIBUTES="attributes",f.PRODUCT="product",f.MEDIA="media",f.USER_SUBMISSION="user_submission",f.CATEGORIES="categories",f.PROGRAM="program",f.SCORM="scorm",f.ACCESS="access",f.CERTIFICATES="certificates",f.QUESTIONNAIRES="questionnaires",f.STATISTICS="statistics",f.USER_PROJECTS="user_projects",f}(pt||{}),Qa=function(){var f,r,a,o,s=(0,n.useParams)(),i=(0,n.useIntl)(),c=s.course,_=s.tab,x=_===void 0?pt.ATTRIBUTES:_,p=c==="new",h=(0,n.useAccess)(),A=(0,l.useState)(),u=j()(A,2),v=u[0],M=u[1],D=(0,Fa.Z)(),C=D.manageCourseEdit,R=D.setManageCourseEdit,Q=D.validateCourseEdit,$=(0,l.useState)(null),Ze=j()($,2),ce=Ze[0],je=Ze[1],we=(0,l.useState)(null),Le=j()(we,2),at=Le[0],vt=Le[1],et=(0,l.useState)({showModal:!1,courseId:0}),Ce=j()(et,2),q=Ce[0],pe=Ce[1],w=(0,l.useState)(!0),Ve=j()(w,2),ye=Ve[0],Xe=Ve[1],Pt=(0,Ha.Z)("EscolaLms\\Courses\\Models\\Course"),nt=(0,n.getAllLocales)()||[],gt=(0,n.useModel)("@@initialState"),_t=gt.setInitialState,Te=gt.initialState,ne=Pe.ZP.useForm(),qe=j()(ne,1),ut=qe[0],Je=(f=Te==null||(r=Te.config)===null||r===void 0||(r=r.find(function(Ie){return Ie.key==="showInCourseAdditionalSettings-public"}))===null||r===void 0?void 0:r.data)!==null&&f!==void 0?f:!1,it=(a=Te==null||(o=Te.config)===null||o===void 0||(o=o.filter(function(Ie){return Ie.key.includes("hideInCourseTabs")}))===null||o===void 0?void 0:o.reduce(function(Ie,ge){var Ye=ge.key,tt=ge.data;return Ie[Ye.split("-")[1]]=tt,Ie},{}))!==null&&a!==void 0?a:{};(0,l.useEffect)(function(){x===pt.ATTRIBUTES&&v&&ye&&(Q(v),Xe(!1))},[v,x,ye]),(0,l.useEffect)(function(){if(c==="new"){M({title:"new"});return}var Ie=function(){var ge=N()(y()().mark(function Ye(){var tt,xt,ht;return y()().wrap(function(ot){for(;;)switch(ot.prev=ot.next){case 0:return ot.next=2,(0,L.XR)(Number(c));case 2:tt=ot.sent,tt.success&&(M(d()(d()({},tt.data),{},{categories:(xt=tt.data.categories)===null||xt===void 0?void 0:xt.map(Zt.i4),tags:(ht=tt.data.tags)===null||ht===void 0?void 0:ht.map(Zt.ZR),summary:tt.data.summary||""})),je(tt.data.active_from),vt(tt.data.active_to));case 4:case"end":return ot.stop()}},Ye)}));return function(){return ge.apply(this,arguments)}}();Ie()},[c]);var We=(0,l.useMemo)(function(){return{onValuesChange:function(ge){return R(d()(d()({},C),{},{valuesChanged:!0})),ge.active_from&&je(ge.active_from),ge.active_to&&vt(ge.active_to),ge.title&&M({title:ge.title})},onFinish:function(){var Ie=N()(y()().mark(function Ye(tt){var xt,ht;return y()().wrap(function(ot){for(;;)switch(ot.prev=ot.next){case 0:if(!C.disableEdit){ot.next=3;break}return R({showModal:!0,disableEdit:!0,clicked:!1}),ot.abrupt("return");case 3:if(xt=d()(d()({},tt),{},{active_from:tt.active_from||(v==null?void 0:v.active_from)||null,active_to:tt.active_to||(v==null?void 0:v.active_to)||null,authors:tt.authors&&tt.authors.map(function(Ot){return W()(Ot)==="object"?Ot.id:Ot}),scorm_sco_id:tt.scorm_sco_id?tt.scorm_sco_id:null,image_url:v&&v.image_url,image_path:v&&v.image_url&&(0,Zt.Ox)(v.image_url),video_url:v&&v.video_url,video_path:v&&v.video_url&&(0,Zt.Ox)(v.video_url),poster_url:v&&v.poster_url,poster_path:v&&v.poster_url&&(0,Zt.Ox)(v.poster_url),hours_to_complete:tt.hours_to_complete||null}),c!=="new"){ot.next=11;break}return ot.next=7,(0,L.P6)(xt);case 7:ht=ot.sent,ht.success&&ht.data.id&&pe({showModal:!0,courseId:ht.data.id}),ot.next=14;break;case 11:return ot.next=13,(0,L.Hf)(Number(c),xt);case 13:ht=ot.sent;case 14:z.ZP.success(i.formatMessage({id:ht.message})),R(d()(d()({},C),{},{showConfirmModal:!1,loading:!1,valuesChanged:!1}));case 16:case"end":return ot.stop()}},Ye)}));function ge(Ye){return Ie.apply(this,arguments)}return ge}(),initialValues:v,form:ut}},[c,v,C,ut]);return v?(0,e.jsxs)(Da._z,{title:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.FormattedMessage,{id:v.title?"course":"new_course"}),", ",(0,e.jsx)(n.FormattedMessage,{id:x})]}),header:{breadcrumb:{routes:[{path:"courses/list",breadcrumbName:i.formatMessage({id:"menu.Courses"})},{path:String(c),breadcrumbName:i.formatMessage({id:"form"})},{path:"/",breadcrumbName:String(v.title)},{path:String(x),breadcrumbName:i.formatMessage({id:x,defaultMessage:String(x)})}]}},children:[(0,e.jsxs)(k.ZP,{bodyStyle:{padding:"24px"},tabs:{type:"card",activeKey:x,onChange:function(ge){_t(d()(d()({},Te),{},{collapsed:ge==="program"})),ge!==pt.ATTRIBUTES&&C.valuesChanged?R(d()(d()({},C),{},{showConfirmModal:!0})):n.history.push("/courses/list/".concat(c,"/").concat(ge))}},children:[(0,e.jsxs)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"attributes"}),children:[C.disableEdit&&(0,e.jsx)(he.Z,{closable:!0,style:{marginBottom:"20px"},type:"warning",message:(0,e.jsx)(n.FormattedMessage,{id:"course_edit_warning_message",defaultMessage:"course_edit_warning_message"}),action:(0,e.jsx)(P.ZP,{onClick:function(){return R({showModal:!0,disableEdit:!0,clicked:!0})},type:"primary",children:(0,e.jsx)(n.FormattedMessage,{id:"questionnaire.submit",defaultMessage:"questionnaire.submit"})})}),(0,e.jsx)(Ge.Z,{visible:C.showModal,setManage:R}),(0,e.jsx)(Oa,{visible:q.showModal,handleOk:function(){n.history.push("/courses/list/".concat(q.courseId,"/program"))},handleCancel:function(){return n.history.push("/courses/list/".concat(q.courseId,"/attributes"))}}),(0,e.jsxs)(Pe.ZP,d()(d()({},We),{},{children:[(0,e.jsxs)(Pe.ZP.Group,{label:(0,e.jsx)(n.FormattedMessage,{id:"description"}),children:[(0,e.jsx)(Ct.Z,{width:"xl",name:"title",label:(0,e.jsx)(n.FormattedMessage,{id:"title"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.title"}),placeholder:i.formatMessage({id:"title",defaultMessage:"title"}),required:!0,disabled:C.disableEdit}),(0,e.jsx)(Ct.Z,{width:"xl",name:"subtitle",label:(0,e.jsx)(n.FormattedMessage,{id:"subtitle"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.subtitle"}),placeholder:i.formatMessage({id:"subtitle",defaultMessage:"subtitle"}),disabled:C.disableEdit}),(0,e.jsx)(Pe.ZP.Item,{name:"summary",label:(0,e.jsx)(n.FormattedMessage,{id:"summary"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.summary"}),valuePropName:"value",style:{width:697},children:(0,e.jsx)(Et.ZP,{directory:"course/".concat(c,"/wysiwyg")})}),(0,e.jsx)(Pe.ZP.Item,{name:"description",label:(0,e.jsx)(n.FormattedMessage,{id:"description"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.description"}),valuePropName:"value",style:{width:697},children:(0,e.jsx)(Et.ZP,{directory:"course/".concat(c,"/wysiwyg")})})]}),(0,e.jsxs)(Pe.ZP.Group,{label:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),children:[(0,e.jsx)(Wt.Z,{width:"md",name:"active_from",label:(0,e.jsx)(n.FormattedMessage,{id:"active_from"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.active_from"}),placeholder:i.formatMessage({id:"active_from",defaultMessage:"active_from"}),rules:[{validator:function(ge,Ye){return Ye&&at&&(0,In.A)(new Date(Ye),new Date(at))?Promise.reject(new Error(i.formatMessage({id:"invalidDate"}))):Promise.resolve()}}],disabled:C.disableEdit}),(0,e.jsx)(Wt.Z,{width:"md",name:"active_to",label:(0,e.jsx)(n.FormattedMessage,{id:"active_to"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.active_to"}),placeholder:i.formatMessage({id:"active_to",defaultMessage:"active_to"}),disabled:C.disableEdit||!ce,rules:[{validator:function(ge,Ye){return Ye&&ce&&(0,An.R)(new Date(Ye),new Date(ce))?Promise.reject(new Error(i.formatMessage({id:"invalidDate"}))):Promise.resolve()}}]}),(0,e.jsx)(Ct.Z,{width:"md",name:"duration",label:(0,e.jsx)(n.FormattedMessage,{id:"duration"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.duration"}),placeholder:i.formatMessage({id:"duration",defaultMessage:"duration"}),disabled:C.disableEdit}),(0,e.jsx)(kt.Z,{width:"md",name:"hours_to_complete",label:(0,e.jsx)(n.FormattedMessage,{id:"hours_to_complete"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"hours_to_complete"}),placeholder:i.formatMessage({id:"hours_to_complete",defaultMessage:"hours_to_complete"}),disabled:C.disableEdit})]}),(0,e.jsxs)(Pe.ZP.Group,{label:(0,e.jsx)(n.FormattedMessage,{id:"additional"}),children:[Je&&(0,e.jsx)(Rt.Z,{width:"xs",name:"public",label:(0,e.jsx)(n.FormattedMessage,{id:"public_label"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"public_tooltip"}),placeholder:i.formatMessage({id:"public",defaultMessage:"public"})}),(0,e.jsx)(Ct.Z,{width:"xs",name:"level",label:(0,e.jsx)(n.FormattedMessage,{id:"level"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.level"}),placeholder:i.formatMessage({id:"level",defaultMessage:"level"})}),(0,e.jsx)(Yn.Z,{name:"language",width:"xs",label:(0,e.jsx)(n.FormattedMessage,{id:"language"}),placeholder:i.formatMessage({id:"language",defaultMessage:"language"}),valueEnum:nt.map(function(Ie){return Ie.split("-")[0]}).reduce(function(Ie,ge){return d()(d()({},Ie),{},I()({},ge,ge))},{}),initialValue:(0,n.getLocale)().split("-")[0],disabled:C.disableEdit}),(0,e.jsx)(Yn.Z,{name:"status",width:"md",label:(0,e.jsx)(n.FormattedMessage,{id:"status"}),valueEnum:{draft:i.formatMessage({id:"draft",defaultMessage:"draft"}),published:i.formatMessage({id:"published",defaultMessage:"published"}),archived:i.formatMessage({id:"archived",defaultMessage:"archived"}),published_unactivated:i.formatMessage({id:"published_unactivated",defaultMessage:"published_unactivated"})},initialValue:{draft:i.formatMessage({id:"draft",defaultMessage:"draft"})},placeholder:i.formatMessage({id:"status"}),disabled:C.disableEdit,rules:[{required:!0,message:(0,e.jsx)(n.FormattedMessage,{id:"select"})}]}),(0,e.jsx)(Ct.Z,{width:"sm",name:"target_group",label:(0,e.jsx)(n.FormattedMessage,{id:"target_group"}),tooltip:(0,e.jsx)(n.FormattedMessage,{id:"courses.tooltips.target_group"}),placeholder:i.formatMessage({id:"target_group",defaultMessage:"target_group"}),disabled:C.disableEdit}),(0,e.jsx)(Pe.ZP.Item,{name:"authors",label:(0,e.jsx)(n.FormattedMessage,{id:"author_tutor"}),valuePropName:"value",children:(0,e.jsx)(Vt.Z,{multiple:!0})})]}),(0,e.jsx)(Pe.ZP.Group,{label:(0,e.jsx)(n.FormattedMessage,{id:"model_fields"}),children:Pt.state==="loaded"&&Pt.list.map(function(Ie){return(0,e.jsx)(Ga.Z,{field:Ie},Ie.id)})})]}))]},pt.ATTRIBUTES),!p&&h.salesPermission&&(0,e.jsx)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"product"}),disabled:C.disableEdit,children:c&&(0,e.jsx)(Ne.C,{productable:{class_type:"App\\Models\\Course",class_id:c,name:String(v.title),quantity:1}})},pt.PRODUCT),!p&&(0,e.jsx)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"media"}),disabled:C.disableEdit,children:(0,e.jsx)(Pe.ZP,d()(d()({},We),{},{layout:"horizontal",children:(0,e.jsxs)(le.Z,{children:[(0,e.jsx)(Y.Z,{span:24,children:(0,e.jsx)(lt.Z,{folder:"course/".concat(c),title:"image",action:"/api/admin/courses/".concat(c),src_name:"image_url",form_name:"image",getUploadedSrcField:function(ge){return ge.file.response.data.image_url},setPath:function(ge){return M(function(Ye){return d()(d()({},Ye),ge)})},hideLabel:!0})}),(0,e.jsx)(Y.Z,{span:24,children:(0,e.jsx)(xe,{folder:"course/".concat(c),action:"/api/admin/courses/".concat(c),src_name:"video_url",form_name:"video",getUploadedSrcField:function(ge){return ge.file.response.data.video_url},setPath:function(ge){return M(function(Ye){return d()(d()({},Ye),ge)})},hideLabel:!0})}),(0,e.jsx)(Y.Z,{span:24,children:(0,e.jsx)(lt.Z,{folder:"course/".concat(c),title:"poster",action:"/api/admin/courses/".concat(c),src_name:"poster_url",form_name:"poster",getUploadedSrcField:function(ge){return ge.file.response.data.poster_url},setPath:function(ge){return M(function(Ye){return d()(d()({},Ye),ge)})},hideLabel:!0})})]})}))},pt.MEDIA),!p&&(0,e.jsx)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"categories_tags"}),disabled:C.disableEdit,children:(0,e.jsx)(Pe.ZP,d()(d()({},We),{},{children:(0,e.jsxs)(le.Z,{children:[(0,e.jsx)(Y.Z,{span:12,children:(0,e.jsx)(Pe.ZP.Item,{label:(0,e.jsx)(n.FormattedMessage,{id:"categories"}),name:"categories",valuePropName:"value",children:(0,e.jsx)(ke.Z,{})})}),(0,e.jsx)(Y.Z,{span:12,children:(0,e.jsx)(Pe.ZP.Item,{label:(0,e.jsx)(n.FormattedMessage,{id:"tags"}),name:"tags",valuePropName:"value",children:(0,e.jsx)(Aa.Z,{})})})]})}))},pt.CATEGORIES),!p&&(0,e.jsx)(k.ZP.TabPane,{className:"program",tab:(0,e.jsx)(n.FormattedMessage,{id:"program"}),disabled:C.disableEdit,cardProps:{bodyStyle:{padding:0}},children:c&&(0,e.jsx)(Pa,{id:c})},pt.PROGRAM),!p&&h.scormListPermission&&(0,e.jsx)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"scorm"}),disabled:C.disableEdit,children:(0,e.jsx)(Pe.ZP,d()(d()({},We),{},{children:(0,e.jsx)(Pe.ZP.Item,{label:"Scorm",name:"scorm_sco_id",valuePropName:"value",children:(0,e.jsx)(Nn,{})})}))},pt.SCORM),!p&&(0,e.jsx)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"access"}),disabled:C.disableEdit,children:c&&(0,e.jsx)(Ua,{id:c})},pt.ACCESS),!p&&h.certificatesPermission&&(0,e.jsx)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"certificates"}),disabled:C.disableEdit,children:c&&(0,e.jsx)(Va,{id:c})},pt.CERTIFICATES),!p&&h.questionnaireListPermission&&(0,e.jsx)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"questionnaires"}),disabled:C.disableEdit,children:c&&(0,e.jsx)(Fe,{modelType:re.COURSE,id:Number(c)})},pt.QUESTIONNAIRES),!p&&!it.statistics&&(0,e.jsx)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"statistics"}),disabled:C.disableEdit,children:c&&(0,e.jsx)(Ke,{courseId:c})},pt.STATISTICS),!p&&!it.user_submission&&(0,e.jsx)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"user_submission"}),disabled:C.disableEdit,children:c&&(0,e.jsx)(Za.ZP,{id:Number(c),type:"App\\Models\\Course"})},pt.USER_SUBMISSION),!p&&!it.user_projects&&(0,e.jsx)(k.ZP.TabPane,{tab:(0,e.jsx)(n.FormattedMessage,{id:"user_projects"}),children:(0,e.jsx)(Ia,{courseId:Number(c)})},pt.USER_PROJECTS)]}),(0,e.jsx)(Re.Z,{open:!!C.showConfirmModal,onOk:function(){R(d()(d()({},C),{},{loading:!0})),ut.submit()},onCancel:function(){R(d()(d()({},C),{},{showConfirmModal:!1}))},loading:!!C.loading})]}):(0,e.jsx)(ue.Z,{})}},62343:function(mt,Be,t){"use strict";var ze=t(52677),I=t.n(ze),$e=t(5574),W=t.n($e),Ae=t(952),y=t(37476),fe=t(5966),d=t(52688),_e=t(86615),N=t(90672),ae=t(63434),j=t(31199),be=t(96365),O=t(14726),ie=t(75842),V=t(49288),z=t(67294),Z=t(43564),l=t(80854),n=t(20568),K=t(19411),e=t(88284),oe=t(28508),re=t(55171),ve=t.n(re),b=t(85893),Fe=function(G){var g=G.value,m=G.onChange,U=G.type,me=U===void 0?"file":U,H=(0,z.useState)(!1),B=W()(H,2),L=B[0],ee=B[1];return(0,b.jsxs)(z.Fragment,{children:[(0,b.jsxs)(Ae.ZP.Group,{children:[(0,b.jsx)(be.Z,{value:g,readOnly:!0}),(0,b.jsxs)(O.ZP,{size:"small",type:"primary",onClick:function(){return ee(!L)},children:["toggle ",me," browser"]})]}),L&&(0,b.jsx)(n.Z,{onFile:function(T,te){return m&&m("".concat(te,"/").concat(T.name))}})]})},ke=function(G){var g=(0,l.useIntl)(),m=G.visible,U=G.onVisibleChange,me=G.onFinish,H=G.id,B=G.initialData,L=G.groups,ee=ie.Z.useForm(),P=W()(ee,1),T=P[0],te=!H||H===-1,Ee=(0,z.useState)("text"),J=W()(Ee,2),E=J[0],F=J[1],X=(0,z.useCallback)(function(){return!!(T.getFieldValue("group")==="global"||B)},[T,B]),k=(0,z.useState)(""),de=W()(k,2),ue=de[0],he=de[1];(0,z.useEffect)(function(){if(I()(H)==="object"){var S;T.setFieldsValue(H),F((S=H.type)!==null&&S!==void 0?S:"text")}else H&&H!==-1?(0,Z.GF)(Number(H)).then(function(De){De.success&&(T.setFieldsValue(De.data),F(De.data.type),he(De.data.group))}):(T.resetFields(),F("text"))},[H,T,B]);var Me=(0,z.useCallback)(function(S){S.type&&S.type!==E&&F(S.type)},[E]);return(0,b.jsxs)(y.Y,{form:T,title:g.formatMessage({id:H?"editSetting":"newSetting",defaultMessage:H?"editSetting":"newSetting"}),width:"60vw",visible:!!m,onVisibleChange:U,onFinish:me,onValuesChange:Me,children:[(0,b.jsxs)(Ae.ZP.Group,{children:[B?(0,b.jsx)(fe.Z,{label:(0,b.jsx)(l.FormattedMessage,{id:"group",defaultMessage:"group"}),rules:[{required:!0}],width:"md",name:"group",disabled:X()}):(0,b.jsx)(Ae.ZP.Item,{label:(0,b.jsx)(l.FormattedMessage,{id:"group",defaultMessage:"group"}),name:"group",children:(0,b.jsx)(V.Z,{style:{width:"300px"},autoFocus:!0,value:ue,onChange:function(De){return he(De)},filterOption:function(De,Qe){var Oe;return(Qe==null||(Oe=Qe.children)===null||Oe===void 0?void 0:Oe.toString().toLowerCase().indexOf(De.toLowerCase()))!==-1},children:L.map(function(S){return(0,b.jsx)(V.Z.Option,{value:S,children:S},S)})})}),(0,b.jsx)(fe.Z,{label:(0,b.jsx)(l.FormattedMessage,{id:"key",defaultMessage:"key"}),rules:[{required:!0}],width:"md",name:"key",disabled:X()})]}),(0,b.jsxs)(Ae.ZP.Group,{children:[(0,b.jsx)(d.Z,{name:"enumerable",disabled:X(),label:(0,b.jsx)(l.FormattedMessage,{id:"enumerable",defaultMessage:"enumerable"})}),(0,b.jsx)(d.Z,{name:"public",disabled:X(),label:(0,b.jsx)(l.FormattedMessage,{id:"public",defaultMessage:"public"})})]}),(0,b.jsx)(Ae.ZP.Group,{children:(0,b.jsx)(_e.Z.Group,{disabled:!!(!te||B),name:"type",label:(0,b.jsx)(l.FormattedMessage,{id:"type"}),options:[{label:"text",value:"text"},{label:"markdown",value:"markdown"},{label:"json",value:"json"},{label:"file",value:"file"},{label:"image",value:"image"},{label:"boolean",value:"boolean"},{label:"number",value:"number"},{label:"array",value:"array"}]})}),(0,b.jsxs)("div",{children:[E==="text"&&(0,b.jsx)(fe.Z,{width:"lg",name:"value",label:(0,b.jsx)(l.FormattedMessage,{id:"value"})}),E==="json"&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(N.Z,{width:"lg",name:"value",label:(0,b.jsx)(l.FormattedMessage,{id:"value"}),tooltip:"".concat(g.formatMessage({id:"example_json"}),': {"name":"John", "age":30, "city":["New York","Warsaw"]}')}),(0,b.jsx)(Ae.ZP.Item,{noStyle:!0,shouldUpdate:!0,children:function(){try{return(0,b.jsx)(ve(),{src:JSON.parse(T.getFieldValue("value"))})}catch(De){return(0,b.jsx)(ve(),{src:JSON.parse('{ "error": "cannot parse this json" }')})}}})]}),(E==="file"||E==="image")&&(0,b.jsx)(Ae.ZP.Item,{name:"value",label:"value",tooltip:"select file from current repository or upload new one",valuePropName:"value",children:(0,b.jsx)(Fe,{type:E})}),E==="markdown"&&(0,b.jsx)(Ae.ZP.Item,{name:"value",label:"value",tooltip:"The editor is WYSIWYG and includes formatting tools whilst retaining the ability to write markdown shortcuts inline and output plain Markdown.",valuePropName:"value",children:(0,b.jsx)(K.ZP,{directory:"settings/wysiwyg"})}),E==="boolean"?(0,b.jsx)(d.Z,{name:"value",label:(0,b.jsx)(l.FormattedMessage,{id:"value"}),checkedChildren:(0,b.jsx)(e.Z,{}),unCheckedChildren:(0,b.jsx)(oe.Z,{})}):(0,b.jsx)(Ae.ZP.Item,{noStyle:!0,hidden:!0,children:(0,b.jsx)(ae.Z,{name:"data",valuePropName:"data"})}),E==="number"&&(0,b.jsx)(j.Z,{name:"data",label:(0,b.jsx)(l.FormattedMessage,{id:"value"})}),E==="array"&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(N.Z,{width:"lg",name:"value",label:(0,b.jsx)(l.FormattedMessage,{id:"value"}),tooltip:"".concat(g.formatMessage({id:"example_json"}),": ['tutor', 'student']")}),(0,b.jsx)(Ae.ZP.Item,{noStyle:!0,shouldUpdate:!0,children:function(){try{return(0,b.jsx)(ve(),{src:JSON.parse(T.getFieldValue("value"))})}catch(De){return(0,b.jsx)(ve(),{src:JSON.parse('{ "error": "cannot parse this json" }')})}}})]})]})]})};Be.ZP=ke},59234:function(mt,Be,t){"use strict";t.d(Be,{Wg:function(){return me}});var ze=t(5574),I=t.n(ze),$e=t(19632),W=t.n($e),Ae=t(15009),y=t.n(Ae),fe=t(97857),d=t.n(fe),_e=t(99289),N=t.n(_e),ae=t(31472),j=t(51042),be=t(16894),O=t(2453),ie=t(83062),V=t(14726),z=t(86738),Z=t(67294),l=t(80854),n=t(43564),K=t(56717),e=t(47389),oe=t(82061),re=t(62343),ve=t(20188),b=t(85893),Fe=function(){var P=N()(y()().mark(function T(te,Ee,J){var E,F;return y()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return E=O.ZP.loading(te.formatMessage({id:"loading"})),k.prev=1,k.next=4,J&&J!==-1?(0,n.VP)(J,d()({},Ee)):(0,n.oh)(d()({},Ee));case 4:return F=k.sent,E(),O.ZP.success(te.formatMessage({id:"success"})),k.abrupt("return",{success:!0,updatedSettings:F});case 10:return k.prev=10,k.t0=k.catch(1),E(),O.ZP.error(te.formatMessage({id:"error"})),k.abrupt("return",{success:!1,updateSettings:null});case 15:case"end":return k.stop()}},T,null,[[1,10]])}));return function(te,Ee,J){return P.apply(this,arguments)}}(),ke=function(){var P=N()(y()().mark(function T(te,Ee){var J;return y()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return J=O.ZP.loading(te.formatMessage({id:"loading"})),F.prev=1,F.next=4,(0,n.Rb)(Ee);case 4:return J(),O.ZP.success(te.formatMessage({id:"success"})),F.abrupt("return",!0);case 9:return F.prev=9,F.t0=F.catch(1),J(),O.ZP.error(te.formatMessage({id:"error"})),F.abrupt("return",!1);case 14:case"end":return F.stop()}},T,null,[[1,9]])}));return function(te,Ee){return P.apply(this,arguments)}}(),Re=function(T){return T.toLowerCase().replace(/(_\w)/g,function(te){return te.toUpperCase().substr(1)})},G=["statistics","user_submission","user_projects"],g=["public"],m=["email","sms"],U=function(T){return"hideInMenu-".concat(Re(T.split("/").join("_")))},me=function(T){return"disableTopicType-".concat(T)},H=[].concat(W()(Object.keys(ae.oz).map(function(P){return{key:me(P),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}})),W()(["ECommerce","Certificates"].map(function(P){return{key:"disable-".concat(P),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}})),W()(g.map(function(P){return{key:"showInCourseAdditionalSettings-".concat(P),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}})),W()(G.map(function(P){return{key:"hideInCourseTabs-".concat(P),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}})),W()(m.map(function(P){return{key:"hideTemplateTab-".concat(P),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}}))).reduce(function(P,T,te){return P[T.key]=d()(d()({},T),{},{id:-100*te}),P},{}),B=d()({logo:{id:-1,key:"logo",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"image",data:"EscolaLMS"},frontURL:{id:-2,key:"frontURL",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},maxLessonsNestingInProgram:{id:-4,key:"maxLessonsNestingInProgram",group:"global",value:"0",public:!0,enumerable:!0,sort:1,type:"number",data:0},minTopicNestingInProgram:{id:-5,key:"minTopicNestingInProgram",group:"global",value:"0",public:!0,enumerable:!0,sort:1,type:"number",data:0},companyName:{id:-6,key:"companyName",group:"global",value:"Wellms",public:!0,enumerable:!0,sort:0,type:"text",data:"Wellms"},companyURL:{id:-7,key:"companyURL",group:"global",value:"https://www.wellms.io/",public:!0,enumerable:!0,sort:0,type:"text",data:"https://www.wellms.io/"},logoLogin:{id:-8,key:"logoLogin",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"image",data:"EscolaLMS"},logoFooter:{id:-9,key:"logoFooter",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"image",data:"EscolaLMS"},footerFontColor:{id:-10,key:"footerFontColor",group:"global",value:"#00000072",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},showLoginBackgroundImage:{id:-11,key:"showLoginBackgroundImage",group:"global",value:"true",public:!0,enumerable:!0,sort:0,type:"boolean",data:"EscolaLMS"},loginHeaderBackgroundColor:{id:-12,key:"loginHeaderBackgroundColor",group:"global",value:"#f0f2f5",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},loginHeaderFontColor:{id:-13,key:"loginHeaderFontColor",group:"global",value:"#000000D8",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},loginFormBackgroundColor:{id:-14,key:"loginFormBackgroundColor",group:"global",value:"#f0f2f5",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},contentBackgroundColor:{id:-15,key:"contentBackgroundColor",group:"global",value:"#f0f2f5",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"},technicalMaintenance:{id:-16,key:"technicalMaintenance",group:"global",value:"false",public:!0,enumerable:!0,sort:0,type:"boolean",data:"EscolaLMS"},technicalMaintenanceText:{id:-17,key:"technicalMaintenanceText",group:"global",value:"",public:!0,enumerable:!0,sort:0,type:"text",data:"EscolaLMS"}},H),L=function(T){return typeof T.path=="string"},ee=function(){var T=(0,Z.useState)(!1),te=I()(T,2),Ee=te[0],J=te[1],E=(0,Z.useRef)(),F=(0,l.useIntl)(),X=(0,Z.useState)(B),k=I()(X,2),de=k[0],ue=k[1],he=(0,l.useModel)("@@initialState"),Me=he.setInitialState,S=he.initialState;(0,Z.useEffect)(function(){(0,ve.s)().then(function(Oe){var He=Object.values(Oe.routes).filter(L).filter(function(Ke){return Ke.path&&Ke.path!=="/"&&Ke.layout!==!1}).map(function(Ke){return{path:Ke.path,key:U(Ke.path),group:"global",value:"false",public:!0,enumerable:!0,sort:1,type:"boolean",data:!1}});ue(function(Ke){return d()(d()({},Ke),He)})})},[]),(0,Z.useEffect)(function(){E.current&&E.current.reload()},[de]);var De=[{title:(0,b.jsx)(l.FormattedMessage,{id:"key",defaultMessage:"key"}),dataIndex:"key",hideInSearch:!0,render:function(He,Ke){return(0,b.jsx)(Z.Fragment,{children:(0,b.jsxs)(ie.Z,{title:(0,b.jsx)(l.FormattedMessage,{id:"Settings.tooltip.".concat(Ke.key)}),children:[Ke.key," ",(0,b.jsx)(K.Z,{})]})})}},{title:(0,b.jsx)(l.FormattedMessage,{id:"type",defaultMessage:"type"}),dataIndex:"type",hideInSearch:!0},{title:(0,b.jsx)(l.FormattedMessage,{id:"value",defaultMessage:"value"}),dataIndex:"value",hideInForm:!0,hideInSearch:!0,render:function(He,Ke){return Ke.value}},{hideInSearch:!0,title:(0,b.jsx)(l.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",valueType:"option",render:function(He,Ke){return[Ke.id>0?(0,b.jsx)(ie.Z,{title:(0,b.jsx)(l.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,b.jsx)(V.ZP,{type:"primary",icon:(0,b.jsx)(e.Z,{}),onClick:function(){return J(Ke.id)}})},"edit"):(0,b.jsx)(ie.Z,{title:(0,b.jsx)(l.FormattedMessage,{id:"create",defaultMessage:"create"}),children:(0,b.jsx)(V.ZP,{type:"primary",icon:(0,b.jsx)(j.Z,{}),onClick:function(){J(de[Ke.key]||-1)}})},"create"),(0,b.jsx)(z.Z,{title:(0,b.jsx)(l.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:N()(y()().mark(function Ge(){var lt;return y()().wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:return rt.next=2,ke(F,Ke.id);case 2:lt=rt.sent,lt&&(J(!1),E.current&&E.current.reload());case 4:case"end":return rt.stop()}},Ge)})),okText:(0,b.jsx)(l.FormattedMessage,{id:"yes",defaultMessage:"Yes"}),cancelText:(0,b.jsx)(l.FormattedMessage,{id:"no",defaultMessage:"No"}),children:Ke.id>0?(0,b.jsx)(ie.Z,{title:(0,b.jsx)(l.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,b.jsx)(V.ZP,{type:"primary",icon:(0,b.jsx)(oe.Z,{}),danger:!0})}):null},"delete")]}}],Qe=function(He){var Ke;if(He&&(!(S!=null&&(Ke=S.config)!==null&&Ke!==void 0&&Ke.length)&&He&&Me(d()(d()({},S),{},{config:[He]})),!!(S!=null&&S.config))){var Ge=S==null?void 0:S.config.map(function(lt){return lt.key===He.key?d()(d()({},lt),He):lt});Me(d()(d()({},S),{},{config:Ge}))}};return(0,b.jsxs)(Z.Fragment,{children:[(0,b.jsx)(be.ZP,{headerTitle:F.formatMessage({id:"menu.settings"}),search:!1,toolBarRender:!1,actionRef:E,rowKey:"id",request:function(He){var Ke=He.pageSize,Ge=He.current;return(0,n.Xd)({per_page:Ke,current:Ge,group:"global"}).then(function(lt){if(lt.success){var Pe=[].concat(W()(Object.keys(de).map(function(rt){return lt.data.find(function(At){return At.key===rt})||de[rt]})),W()(lt.data.filter(function(rt){return!Object.keys(de).includes(rt.key)})));return{data:Pe,total:Pe.length,success:!0}}return[]})},columns:De}),(0,b.jsx)(re.ZP,{groups:[],id:Ee,visible:Ee,initialData:de,onVisibleChange:function(He){return!He&&J(!1)},onFinish:function(){var Oe=N()(y()().mark(function He(Ke){var Ge,lt,Pe,rt;return y()().wrap(function(bt){for(;;)switch(bt.prev=bt.next){case 0:return Ge=Ke,Ge.type==="number"&&(Ge=d()(d()({},Ge),{},{value:String(Ge.data)})),Ge.type==="boolean"&&(Ge=d()(d()({},Ge),{},{value:Ge.data})),Ge.type==="array"&&(Ge=d()(d()({},Ge),{},{value:JSON.parse(Ge.value)})),bt.next=6,Fe(F,Ge,Number(Ee));case 6:lt=bt.sent,Pe=lt.success,rt=lt.updatedSettings,Pe&&(rt!=null&&rt.success&&Qe(rt.data),J(!1),E.current&&E.current.reload());case 10:case"end":return bt.stop()}},He)}));return function(He){return Oe.apply(this,arguments)}}()})]})};Be.ZP=ee},17578:function(mt,Be,t){"use strict";t.d(Be,{Od:function(){return ie},QZ:function(){return d},ht:function(){return N},pV:function(){return O},ws:function(){return j}});var ze=t(15009),I=t.n(ze),$e=t(97857),W=t.n($e),Ae=t(99289),y=t.n(Ae),fe=t(80854);function d(z,Z){return _e.apply(this,arguments)}function _e(){return _e=y()(I()().mark(function z(Z,l){return I()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",(0,fe.request)("/api/admin/file/list",W()({method:"GET",params:Z},l||{})));case 1:case"end":return K.stop()}},z)})),_e.apply(this,arguments)}function N(z,Z){return ae.apply(this,arguments)}function ae(){return ae=y()(I()().mark(function z(Z,l){return I()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",(0,fe.request)("/api/admin/file/find",W()({method:"GET",params:Z},l||{})));case 1:case"end":return K.stop()}},z)})),ae.apply(this,arguments)}function j(z,Z,l){return be.apply(this,arguments)}function be(){return be=y()(I()().mark(function z(Z,l,n){var K;return I()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return K=new FormData,K.append("file[]",Z),K.append("target",l),oe.abrupt("return",(0,fe.request)("/api/admin/file/upload",W()({method:"POST",data:K},n||{})));case 4:case"end":return oe.stop()}},z)})),be.apply(this,arguments)}var O=function(Z){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;return"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/images/img?path=").concat(Z,"&w=").concat(l)};function ie(z,Z){return V.apply(this,arguments)}function V(){return V=y()(I()().mark(function z(Z,l){return I()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",(0,fe.request)("/api/admin/file/delete",W()({method:"DELETE",data:{url:Z}},l||{})));case 1:case"end":return K.stop()}},z)})),V.apply(this,arguments)}},97704:function(mt,Be,t){"use strict";t.d(Be,{Kn:function(){return d},LK:function(){return be},RN:function(){return j},gq:function(){return Z},jc:function(){return V},x0:function(){return O}});var ze=t(15009),I=t.n(ze),$e=t(97857),W=t.n($e),Ae=t(99289),y=t.n(Ae),fe=t(80854);function d(n,K){return _e.apply(this,arguments)}function _e(){return _e=y()(I()().mark(function n(K,e){return I()().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.abrupt("return",(0,fe.request)("/api/admin/hh5p/content",W()({method:"GET",params:K},e||{})));case 1:case"end":return re.stop()}},n)})),_e.apply(this,arguments)}function N(n,K){return ae.apply(this,arguments)}function ae(){return ae=_asyncToGenerator(_regeneratorRuntime().mark(function n(K,e){return _regeneratorRuntime().wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.abrupt("return",request("/api/admin/hh5p/content/".concat(K),_objectSpread({method:"GET"},e||{})));case 1:case"end":return re.stop()}},n)})),ae.apply(this,arguments)}var j=function(K){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"en",oe=arguments.length>2?arguments[2]:void 0,re=K?"/api/admin/hh5p/editor/".concat(K):"/api/admin/hh5p/editor";return re=e?"".concat(re,"?lang=").concat(e):re,(0,fe.request)(re,W()({method:"GET"},oe||{}))},be=function(K){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"en",oe=arguments.length>2?arguments[2]:void 0,re="/api/admin/hh5p/content/".concat(K);return re=e?"".concat(re,"?lang=").concat(e):re,(0,fe.request)(re,W()({method:"GET"},oe||{}))};function O(n,K,e){return ie.apply(this,arguments)}function ie(){return ie=y()(I()().mark(function n(K,e,oe){return I()().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return ve.abrupt("return",(0,fe.request)(e?"/api/admin/hh5p/content/".concat(e):"/api/admin/hh5p/content",W()({method:"POST",headers:{"Content-Type":"application/json"},data:K},oe||{})));case 1:case"end":return ve.stop()}},n)})),ie.apply(this,arguments)}function V(n){return z.apply(this,arguments)}function z(){return z=y()(I()().mark(function n(K){return I()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.abrupt("return",(0,fe.request)("/api/admin/hh5p/content/".concat(K),{method:"DELETE"}));case 1:case"end":return oe.stop()}},n)})),z.apply(this,arguments)}function Z(n){return l.apply(this,arguments)}function l(){return l=y()(I()().mark(function n(K){return I()().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.abrupt("return",(0,fe.request)("/api/admin/hh5p/content?per_page=0",W()({method:"GET"},K||{})));case 1:case"end":return oe.stop()}},n)})),l.apply(this,arguments)}},76841:function(mt,Be,t){"use strict";t.d(Be,{Gm:function(){return d},Sx:function(){return j},_g:function(){return N}});var ze=t(15009),I=t.n(ze),$e=t(97857),W=t.n($e),Ae=t(99289),y=t.n(Ae),fe=t(80854);function d(O,ie){return _e.apply(this,arguments)}function _e(){return _e=y()(I()().mark(function O(ie,V){return I()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,fe.request)("/api/admin/reports/report",W()({params:ie,method:"GET",useCache:!1},V||{})));case 1:case"end":return Z.stop()}},O)})),_e.apply(this,arguments)}function N(O,ie,V){return ae.apply(this,arguments)}function ae(){return ae=y()(I()().mark(function O(ie,V,z){return I()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,fe.request)("/api/admin/stats/course/".concat(ie,"/export"),W()({params:V,method:"GET",useCache:!1,responseType:"blob",headers:{accept:"application/vnd.ms-excel"}},z||{})));case 1:case"end":return l.stop()}},O)})),ae.apply(this,arguments)}function j(O,ie,V){return be.apply(this,arguments)}function be(){return be=y()(I()().mark(function O(ie,V,z){return I()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,fe.request)("/api/admin/stats/topic/".concat(ie,"/export"),W()({method:"GET",useCache:!1,params:{stat:V},responseType:"blob",headers:{accept:"application/vnd.ms-excel"}},z||{})));case 1:case"end":return l.stop()}},O)})),be.apply(this,arguments)}},9649:function(mt,Be,t){"use strict";t.d(Be,{JZ:function(){return d},NK:function(){return j}});var ze=t(15009),I=t.n(ze),$e=t(97857),W=t.n($e),Ae=t(99289),y=t.n(Ae),fe=t(80854);function d(O,ie){return _e.apply(this,arguments)}function _e(){return _e=y()(I()().mark(function O(ie,V){return I()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,fe.request)("/api/admin/scorm",W()({params:ie,method:"GET",useCache:!1},V||{})));case 1:case"end":return Z.stop()}},O)})),_e.apply(this,arguments)}function N(O,ie){return ae.apply(this,arguments)}function ae(){return ae=_asyncToGenerator(_regeneratorRuntime().mark(function O(ie,V){return _regeneratorRuntime().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",request("/api/admin/scorm/scos",_objectSpread({params:_objectSpread(_objectSpread({},ie),{},{per_page:ie.pageSize,page:ie.current}),method:"GET",useCache:!1},V||{})));case 1:case"end":return Z.stop()}},O)})),ae.apply(this,arguments)}function j(O,ie){return be.apply(this,arguments)}function be(){return be=y()(I()().mark(function O(ie,V){return I()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,fe.request)("/api/admin/scorm/".concat(ie),W()({method:"DELETE"},V||{})));case 1:case"end":return Z.stop()}},O)})),be.apply(this,arguments)}},93414:function(){},70172:function(){},2001:function(){},33779:function(){},66558:function(){},82258:function(){}}]);
