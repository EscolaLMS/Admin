"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[3015,2803,8047],{58664:function(ne,W,e){e.d(W,{T:function(){return H}});var V=e(19632),h=e.n(V),G=e(5574),I=e.n(G),Z=e(74656),X=e(74330),j=e(67294),B=e(51490),S=e(99100),m=e(32283),Q=e(80854),x=e(85893),N=function(E){return E.map(function(g){return"name"in g?{id:Number(g.id),name:g.name}:{id:Number(g.id),name:g.title?g.title:""}})},H=function(E){var g=E.value,Y=E.onChange,P=E.multiple,w=P===void 0?!1:P,k=E.defaultValue,D=E.modelType,A=D===void 0?"COURSE":D,q=(0,j.useState)([]),$=I()(q,2),R=$[0],u=$[1],ee=(0,j.useState)(!1),b=I()(ee,2),_=b[0],F=b[1],s=(0,j.useRef)(),L=(0,j.useCallback)(function(a){var d,f,p,y;switch(A){case"COURSE":return(0,S.N7)(a,{signal:s==null||(d=s.current)===null||d===void 0?void 0:d.signal});case"WEBINAR":return(0,m.i5)(a,{signal:s==null||(f=s.current)===null||f===void 0?void 0:f.signal});case"CONSULTATIONS":return(0,B.sL)(a,{signal:s==null||(p=s.current)===null||p===void 0?void 0:p.signal});default:return(0,S.N7)(a,{signal:s==null||(y=s.current)===null||y===void 0?void 0:y.signal})}},[A,s]),te=(0,j.useCallback)(function(a){var d,f,p,y;switch(A){case"COURSE":return(0,S.XR)(Number(a),{signal:(d=s.current)===null||d===void 0?void 0:d.signal});case"WEBINAR":return(0,m.tz)(Number(a),{signal:(f=s.current)===null||f===void 0?void 0:f.signal});case"CONSULTATIONS":return(0,B.hW)(Number(a),{signal:(p=s.current)===null||p===void 0?void 0:p.signal});default:return(0,S.XR)(Number(a),{signal:(y=s.current)===null||y===void 0?void 0:y.signal})}},[A,s]),O=(0,j.useCallback)(function(a){F(!0),s.current&&s.current.abort(),s.current=new AbortController,L(a?{name:a}:{}).then(function(d){d.success&&u(N(d.data))}).catch(function(d){return console.error(d)}).finally(function(){F(!1)})},[A]),t=(0,j.useCallback)(function(a){O(a)},[O]);return(0,j.useEffect)(function(){return s.current=new AbortController,g&&te(Number(g)).then(function(a){a&&a.success&&u(function(d){return[].concat(h()(d),h()(N([a.data])))})}),function(){s.current&&s.current.abort()}},[g,A]),(0,x.jsx)(Z.default,{defaultValue:k,onFocus:function(){return O()},allowClear:!0,style:{width:"100%"},value:g,onChange:Y,mode:w?"multiple":void 0,showSearch:!0,onSearch:t,placeholder:(0,x.jsx)(Q.FormattedMessage,{id:"select_content",defaultMessage:"select_content"}),optionFilterProp:"children",filterOption:function(d,f){if(f&&f.children){var p;return(f==null||(p=f.children)===null||p===void 0?void 0:p.toString().toLowerCase().indexOf(d.toLowerCase()))>=0}return!0},loading:_,notFoundContent:_?(0,x.jsx)(X.Z,{size:"small"}):null,optionLabelProp:"label",children:R.map(function(a){return(0,x.jsx)(Z.default.Option,{value:a.id,label:a.name,children:a.name},a.id)})})}},26781:function(ne,W,e){e.r(W),e.d(W,{default:function(){return ae}});var V=e(97857),h=e.n(V),G=e(13769),I=e.n(G),Z=e(52677),X=e.n(Z),j=e(5574),B=e.n(j),S=e(15009),m=e.n(S),Q=e(99289),x=e.n(Q),N=e(44167),H=e(45919),J=e(82061),E=e(74453),g=e(16894),Y=e(2453),P=e(14726),w=e(85265),k=e(71471),D=e(66309),A=e(86738),q=e(83062),$=e(60943),R=e(67294),u=e(80854),ee=e(58664),b=e(62235);function _(C,l){return F.apply(this,arguments)}function F(){return F=x()(m()().mark(function C(l,c){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,u.request)("/api/admin/course-access-enquiries",h()({method:"GET",params:h()(h()({},l),{},{per_page:l.pageSize,page:l.current})},c||{})));case 1:case"end":return n.stop()}},C)})),F.apply(this,arguments)}function s(C,l){return L.apply(this,arguments)}function L(){return L=x()(m()().mark(function C(l,c){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,u.request)("/api/admin/course-access-enquiries/".concat(l),h()({method:"DELETE"},c||{})));case 1:case"end":return n.stop()}},C)})),L.apply(this,arguments)}function te(C,l){return O.apply(this,arguments)}function O(){return O=x()(m()().mark(function C(l,c){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,u.request)("/api/admin/course-access-enquiries/approve/".concat(l),h()({method:"POST"},c||{})));case 1:case"end":return n.stop()}},C)})),O.apply(this,arguments)}var t=e(85893),a=["type","defaultRender"],d=["type","defaultRender"],f=function(){var C=x()(m()().mark(function l(c){return m()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",s(c).then(function(i){return i.success&&Y.ZP.success(i.message),!0}));case 1:case"end":return n.stop()}},l)}));return function(c){return C.apply(this,arguments)}}(),p=function(l){var c=l.data,T=(0,R.useState)(!1),n=B()(T,2),i=n[0],r=n[1];return c&&X()(c)==="object"&&Object.keys(c).length>0?(0,t.jsxs)(R.Fragment,{children:[(0,t.jsx)(P.ZP,{size:"small",onClick:function(){return r(!0)},children:(0,t.jsx)(u.FormattedMessage,{id:"show",defaultMessage:"show"})}),(0,t.jsx)(w.Z,{width:700,open:i,onClose:function(){return r(!1)},children:(0,t.jsx)(k.Z.Paragraph,{children:Object.keys(c).map(function(o){return(0,t.jsxs)("p",{children:[(0,t.jsx)(u.FormattedMessage,{id:o,defaultMessage:o}),":",(0,t.jsxs)("span",{children:[" ",c[o]]})]},o)})})})]}):(0,t.jsx)(R.Fragment,{})},y=function(){var l=(0,R.useRef)(),c=(0,u.useIntl)(),T=[{title:(0,t.jsx)(u.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,t.jsx)(u.FormattedMessage,{id:"course",defaultMessage:"course"}),dataIndex:"course_id",renderFormItem:function(i,r,o){var v=r.type,K=r.defaultRender,M=I()(r,a);if(v==="form")return null;var U=o.getFieldValue("state");return(0,t.jsx)(ee.T,h()(h()({},M),{},{state:{type:U}}))},render:function(i,r){return r.course&&r.course.id&&(0,t.jsx)(b.Z,{type:"App\\Models\\Course",type_id:r.course.id},"course_id")}},{title:(0,t.jsx)(u.FormattedMessage,{id:"user",defaultMessage:"user"}),dataIndex:"user_id",renderFormItem:function(i,r,o){var v=r.type,K=r.defaultRender,M=I()(r,d);if(v==="form")return null;var U=o.getFieldValue("state");return(0,t.jsx)(N.Z,h()(h()({},M),{},{state:{type:U}}))},render:function(i,r){var o,v;return((o=r.user)===null||o===void 0?void 0:o.id)&&(0,t.jsx)(b.Z,{type:"EscolaLms\\Core\\Models\\User",type_id:(v=r.user)===null||v===void 0?void 0:v.id},"user")}},{title:(0,t.jsx)(u.FormattedMessage,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",hideInSearch:!0,sorter:!0,render:function(i,r){return r.created_at&&(0,$.WU)(new Date(r.created_at),H.Cu)}},{title:(0,t.jsx)(u.FormattedMessage,{id:"status",defaultMessage:"Status"}),dataIndex:"status",sorter:!0,valueType:"select",valueEnum:{pending:{text:(0,t.jsx)(D.Z,{color:"processing",children:(0,t.jsx)(u.FormattedMessage,{id:"pending",defaultMessage:"pending"})}),status:"pending"},approved:{text:(0,t.jsx)(D.Z,{color:"success",children:(0,t.jsx)(u.FormattedMessage,{id:"approved",defaultMessage:"approved"})}),status:"approved"}},render:function(i,r){return r.status==="pending"?(0,t.jsx)(P.ZP,{size:"small",type:"primary",onClick:function(){te(r.id).then(function(v){v.success&&l.current&&l.current.reload()})},children:(0,t.jsx)(u.FormattedMessage,{id:"approve",defaultMessage:"Approve"})}):(0,t.jsx)(D.Z,{color:r.status==="approved"?"success":"processing",children:(0,t.jsx)(u.FormattedMessage,{id:r.status,defaultMessage:r.status})})}},{title:(0,t.jsx)(u.FormattedMessage,{id:"extra_data",defaultMessage:"Extra data"}),dataIndex:"data",hideInSearch:!0,render:function(i,r){return(0,t.jsx)(p,{data:r.data})}},{hideInSearch:!0,title:(0,t.jsx)(u.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"option"}),dataIndex:"option",valueType:"option",render:function(i,r){return[(0,t.jsx)(A.Z,{title:(0,t.jsx)(u.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:x()(m()().mark(function o(){var v;return m()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.next=2,f(r.id);case 2:v=M.sent,v&&l.current&&l.current.reload();case 4:case"end":return M.stop()}},o)})),okText:(0,t.jsx)(u.FormattedMessage,{id:"yes"}),cancelText:(0,t.jsx)(u.FormattedMessage,{id:"no"}),children:(0,t.jsx)(q.Z,{title:(0,t.jsx)(u.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,t.jsx)(P.ZP,{type:"primary",icon:(0,t.jsx)(J.Z,{}),danger:!0})})},"delete")]}}];return(0,t.jsx)(E._z,{children:(0,t.jsx)(g.ZP,{headerTitle:c.formatMessage({id:"courseAccessEnquiries",defaultMessage:"Course Access Enquiries"}),search:{layout:"vertical"},actionRef:l,rowKey:"id",request:function(i,r){var o=i.pageSize,v=i.current,K=i.course_id,M=i.status,U=i.user_id,z=r&&Object.entries(r)[0];return _({pageSize:o,current:v,course_id:K,user_id:U,status:M,order_by:z&&z[0],order:z?z[1]==="ascend"?"ASC":"DESC":void 0}).then(function(re){return re.success?{data:re.data,total:re.meta.total,success:!0}:[]})},columns:T})})},ae=y}}]);

//# sourceMappingURL=p__CourseAccess__index.96aa3ced.async.js.map