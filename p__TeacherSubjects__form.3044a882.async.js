(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"/y+f":function(Fe,oe,t){"use strict";t.d(oe,"f",function(){return c}),t.d(oe,"d",function(){return f}),t.d(oe,"e",function(){return P}),t.d(oe,"c",function(){return je}),t.d(oe,"a",function(){return a}),t.d(oe,"b",function(){return Ae});var c;(function(l){l.Unselected="",l.RichText="EscolaLms\\TopicTypes\\Models\\TopicContent\\RichText",l.OEmbed="EscolaLms\\TopicTypes\\Models\\TopicContent\\OEmbed",l.Audio="EscolaLms\\TopicTypes\\Models\\TopicContent\\Audio",l.Video="EscolaLms\\TopicTypes\\Models\\TopicContent\\Video",l.H5P="EscolaLms\\TopicTypes\\Models\\TopicContent\\H5P",l.Image="EscolaLms\\TopicTypes\\Models\\TopicContent\\Image",l.PDF="EscolaLms\\TopicTypes\\Models\\TopicContent\\PDF",l.SCORM="EscolaLms\\TopicTypes\\Models\\TopicContent\\ScormSco",l.Project="EscolaLms\\TopicTypeProject\\Models\\Project",l.GiftQuiz="EscolaLms\\TopicTypeGift\\Models\\GiftQuiz"})(c||(c={}));var B;(function(l){l.OrderPaid="EscolaLms\\Cart\\Events\\OrderPaid",l.UserLogged="EscolaLms\\Auth\\Events\\UserLogged"})(B||(B={}));var $;(function(l){l.draft="draft",l.published="published",l.archived="archived"})($||($={}));var f;(function(l){l.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",l.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",l.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel"})(f||(f={}));var P;(function(l){l.ManuallyTriggeredEvent="EscolaLms\\Templates\\Events\\ManuallyTriggeredEvent"})(P||(P={}));var u;(function(l){l.cart_fixed="cart_fixed",l.cart_percent="cart_percent",l.product_fixed="product_fixed",l.product_percent="product_percent"})(u||(u={}));var je;(function(l){l.MULTIPLE_CHOICE="multiple_choice",l.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS="multiple_choice_with_multiple_right_answers",l.TRUE_FALSE="true_false",l.SHORT_ANSWERS="short_answers",l.MATCHING="matching",l.NUMERICAL_QUESTION="numerical_question",l.ESSAY="essay",l.DESCRIPTION="description"})(je||(je={}));var a;(function(l){l.PRESENT="present",l.ABSENT="absent"})(a||(a={}));var Ae;(function(l){l.Manual="manual",l.TeamsForms="teams_forms",l.TeamsLecture="teams_lecture",l.TestPortal="test_portal"})(Ae||(Ae={}))},"0JQy":function(Fe,oe){var t="\\ud800-\\udfff",c="\\u0300-\\u036f",B="\\ufe20-\\ufe2f",$="\\u20d0-\\u20ff",f=c+B+$,P="\\ufe0e\\ufe0f",u="["+t+"]",je="["+f+"]",a="\\ud83c[\\udffb-\\udfff]",Ae="(?:"+je+"|"+a+")",l="[^"+t+"]",re="(?:\\ud83c[\\udde6-\\uddff]){2}",he="[\\ud800-\\udbff][\\udc00-\\udfff]",_e="\\u200d",q=Ae+"?",Ee="["+P+"]?",ke="(?:"+_e+"(?:"+[l,re,he].join("|")+")"+Ee+q+")*",pe=Ee+q+ke,Ne="(?:"+[l+je+"?",je,re,he,u].join("|")+")",$e=RegExp(a+"(?="+a+")|"+Ne+pe,"g");function v(O){return O.match($e)||[]}Fe.exports=v},"5R/X":function(Fe,oe,t){},"5Syx":function(Fe,oe,t){"use strict";t.d(oe,"c",function(){return He}),t.d(oe,"b",function(){return xe}),t.d(oe,"a",function(){return te});var c=t("OaEy"),B=t("2fM7"),$=t("g9YV"),f=t("wCAj"),P=t("BoS7"),u=t("Sdc0"),je=t("jrin"),a=t("k1fw"),Ae=t("DYRE"),l=t("zeV3"),re=t("+BJd"),he=t("mr32"),_e=t("oBTY"),q=t("tJVT"),Ee=t("q1tI"),ke=t.n(Ee),pe=t("9kvl"),Ne=t("Vpfc"),$e=t("jsgi"),v=t("nhC9"),O=t("nKUr"),Ve=t.n(O),qe=function(h){return h.topicable.content.contents?Object.values(h.topicable.content.contents)[0].library:"H5P"},He=function(h){var V=h.topics,Be=h.stats,F=Object(Ee.useState)(!1),se=Object(q.a)(F,2),b=se[0],Se=se[1],ve=Object(Ee.useMemo)(function(){return[{title:Object(O.jsx)(pe.a,{id:"user"}),dataIndex:"id",render:function(Le){return Object(O.jsx)(Ne.a,{type:"App\\Models\\User",type_id:Le})}},{title:Object(O.jsx)(pe.a,{id:"email"}),dataIndex:"email"}].concat(Object(_e.a)(V.map(function(Te){var Le,Ie=(Le=Te.topicable_type)===null||Le===void 0?void 0:Le.split("\\").pop();return Ie==="H5P"&&(Ie=qe(Te)),{render:function(K){var Re=0,Xe=0;switch(K&&(K.started_at&&K.finished_at?Re=1:K.started_at&&(Re=2),Xe=K.seconds/60),Re){case 1:return Object(O.jsxs)(l.b,{children:[Object(O.jsx)(he.a,{color:"success",children:"F"}),b&&Object(O.jsxs)("small",{children:[Xe.toFixed(2),"m"]})]});case 2:return Object(O.jsxs)(l.b,{children:[Object(O.jsx)(he.a,{color:"blue",children:"S"}),b&&Object(O.jsxs)("small",{children:[Xe.toFixed(2),"m"]})]});case 0:default:return Object(O.jsx)(ke.a.Fragment,{children:Object(O.jsx)(he.a,{color:"error",children:"N"})})}},title:Object(O.jsxs)("small",{children:[Object(O.jsx)(he.a,{children:Ie})," ",Te.title]}),dataIndex:Te.id}})))},[V,b]),Qe=Object(Ee.useMemo)(function(){return Be.map(function(Te){return V.reduce(function(Le,Ie){var Z=Te.topics.find(function(K){return K.id===Ie.id});return Object(a.a)(Object(a.a)({},Le),{},Object(je.a)({},Number(Ie.id),Z!=null?Z:0))},{email:Te.email,id:Te.id})})},[Be,V]);return Object(O.jsx)(f.a,{title:function(){return Object(O.jsxs)(l.b,{children:[Object(O.jsx)(pe.a,{id:"Finished",defaultMessage:"Finished:"})," ",Object(O.jsx)(he.a,{color:"success",children:"F"}),Object(O.jsx)(pe.a,{id:"Started",defaultMessage:"Started:"})," ",Object(O.jsx)(he.a,{color:"blue",children:"S"}),Object(O.jsx)(pe.a,{id:"NotStarted",defaultMessage:"Not Started:"})," ",Object(O.jsx)(he.a,{color:"error",children:"N"}),Object(O.jsx)(pe.a,{id:"ShowMinutes",defaultMessage:"Show minutes spent on topic:"})," ",Object(O.jsx)(u.a,{checked:b,onChange:function(Ie){return Se(Ie)}})]})},columns:ve,dataSource:Qe,size:"small",scroll:{x:1500}})},xe=function(h){var V=h.stats,Be=Object(Ee.useMemo)(function(){return[{title:"user",dataIndex:"id",render:function(b){return Object(O.jsx)(Ne.a,{type:"App\\Models\\User",type_id:b})}},{title:"email",dataIndex:"email"},{title:Object(O.jsx)(pe.a,{id:"finished_at",defaultMessage:"Finished at"}),dataIndex:"finished_at"}]},[]),F=Object(Ee.useMemo)(function(){return V.map(function(se){var b=se.id,Se=se.email,ve=se.finished_at;return{id:b,email:Se,finished_at:ve}})},[V]);return Object(O.jsx)(f.a,{title:function(){return Object(O.jsx)(l.b,{children:Object(O.jsx)(pe.a,{id:"course.finished",defaultMessage:"Finished"})})},columns:Be,dataSource:F,size:"small",scroll:{x:500}})},te=function(h){var V=h.stats,Be=Object(Ee.useState)(null),F=Object(q.a)(Be,2),se=F[0],b=F[1],Se=Object(Ee.useState)(null),ve=Object(q.a)(Se,2),Qe=ve[0],Te=ve[1],Le=Object(Ee.useMemo)(function(){return V.map(function(Z){return Object.values(Z.attempts).flatMap(function(K){var Re=K.dates,Xe=K.attempt,W=Object.values(Re)[0],ot=W.date,Ze=W.times;return{date:ot,attempt:Xe,times:Ze.length,email:Z.email}})})},[V]),Ie={xField:"date",yField:"times",seriesField:"attempt",isStack:!0,xAxis:{label:{autoHide:!0,autoRotate:!1}},slider:{start:0,end:1},label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]}};return Object(O.jsx)(v.a,{colSpan:12,layout:"center",children:Object(O.jsx)($e.a,{config:Ie,title:Object(O.jsxs)(l.b,{children:[Object(O.jsx)(pe.a,{id:"course.interactions_in_days"}),Object(O.jsx)(B.a,{showSearch:!0,value:se,onChange:function(K){b(K),Te(null)},placeholder:Object(O.jsx)(pe.a,{id:"select_person",defaultMessage:"Select a person"}),children:V.map(function(Z){var K=Z.id,Re=Z.email;return Object(O.jsx)(B.a.Option,{value:Re,children:Re},K)})}),Object(O.jsx)(B.a,{value:Qe,onChange:function(K){return Te(K)},disabled:se===null,placeholder:Object(O.jsx)(pe.a,{id:"select_attempt",defaultMessage:"Select attempt"}),children:Le.flatMap(function(Z){return Z}).filter(function(Z){var K=Z.email;return K===se}).map(function(Z){var K=Z.attempt;return Object(O.jsxs)(B.a.Option,{value:K,children:[Object(O.jsx)(pe.a,{id:"attempt",defaultMessage:"Attempt"})," ",K]},K)})})]}),value:Le.flatMap(function(Z){return Z}).filter(function(Z){var K=Z.email;return K===se}).filter(function(Z){var K=Z.attempt;return Number.isInteger(Qe)?K===Qe:!0})})})}},Em2t:function(Fe,oe,t){var c=t("bahg"),B=t("quyA"),$=t("0JQy");function f(P){return B(P)?$(P):c(P)}Fe.exports=f},Hn4i:function(Fe,oe,t){"use strict";var c=t("y8nQ"),B=t("Vl3Y"),$=t("+L6B"),f=t("2/Rp"),P=t("rePB"),u=t("ODXe"),je=t("Ff2n"),a=t("x+uP"),Ae=t("HaE+"),l=t("VTBJ"),re=t("nKUr"),he=t.n(re),_e=t("xvlK"),q=t("WuYN"),Ee=t("VMEa"),ke=t("LQCs"),pe=t("ft2k"),Ne=t("uX+g"),$e=t("+i8S"),v=t("ipCM"),O=t("6cGi"),Ve=t("ub+h"),qe=t("bG1m"),He=t("q1tI"),xe=t.n(He),te=t("mWMg"),k=["onTableChange","maxLength","formItemProps","recordCreatorProps","rowKey","controlled","defaultValue","onChange","editableFormRef"],h=["record","position","creatorButtonText","newRecordType","parentKey","style"],V=xe.a.createContext(void 0);function Be(b){var Se=b.children,ve=b.record,Qe=b.position,Te=b.newRecordType,Le=b.parentKey,Ie=Object(He.useContext)(V);return xe.a.cloneElement(Se,Object(l.a)(Object(l.a)({},Se.props),{},{onClick:function(){var Z=Object(Ae.a)(Object(a.a)().mark(function Re(Xe){var W,ot,Ze,lt;return Object(a.a)().wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.next=2,(W=(ot=Se.props).onClick)===null||W===void 0?void 0:W.call(ot,Xe);case 2:if(lt=ce.sent,lt!==!1){ce.next=5;break}return ce.abrupt("return");case 5:Ie==null||(Ze=Ie.current)===null||Ze===void 0||Ze.addEditRecord(ve,{position:Qe,newRecordType:Te,parentKey:Le});case 6:case"end":return ce.stop()}},Re)}));function K(Re){return Z.apply(this,arguments)}return K}()}))}function F(b){var Se,ve,Qe=Object(ke.d)(),Te=b.onTableChange,Le=b.maxLength,Ie=b.formItemProps,Z=b.recordCreatorProps,K=b.rowKey,Re=b.controlled,Xe=b.defaultValue,W=b.onChange,ot=b.editableFormRef,Ze=Object(je.a)(b,k),lt=Object(pe.a)(b.value),Je=Object(He.useRef)(),ce=Object(He.useRef)();Object(He.useImperativeHandle)(Ze.actionRef,function(){return Je.current});var Ot=Object(O.a)(function(){return b.value||Xe||[]},{value:b.value,onChange:b.onChange}),ft=Object(u.a)(Ot,2),z=ft[0],_t=ft[1],et=xe.a.useMemo(function(){return typeof K=="function"?K:function(ye,ae){return ye[K]||ae}},[K]),mt=function(ae){if(typeof ae=="number"&&!b.name){if(ae>=z.length)return ae;var ue=z&&z[ae];return et==null?void 0:et(ue,ae)}if((typeof ae=="string"||ae>=z.length)&&b.name){var fe=z.findIndex(function(Q,Me){var Pe;return(et==null||(Pe=et(Q,Me))===null||Pe===void 0?void 0:Pe.toString())===(ae==null?void 0:ae.toString())});return fe}return ae};Object(He.useImperativeHandle)(ot,function(){var ye=function(fe){var Q,Me;if(fe==null)throw new Error("rowIndex is required");var Pe=mt(fe),ct=[b.name,(Q=Pe==null?void 0:Pe.toString())!==null&&Q!==void 0?Q:""].flat(1).filter(Boolean);return(Me=ce.current)===null||Me===void 0?void 0:Me.getFieldValue(ct)},ae=function(){var fe,Q=[b.name].flat(1).filter(Boolean);if(Array.isArray(Q)&&Q.length===0){var Me,Pe=(Me=ce.current)===null||Me===void 0?void 0:Me.getFieldsValue();return Array.isArray(Pe)?Pe:Object.keys(Pe).map(function(ct){return Pe[ct]})}return(fe=ce.current)===null||fe===void 0?void 0:fe.getFieldValue(Q)};return Object(l.a)(Object(l.a)({},ce.current),{},{getRowData:ye,getRowsData:ae,setRowData:function(fe,Q){var Me,Pe,ct,vt;if(fe==null)throw new Error("rowIndex is required");var ht=mt(fe),gt=[b.name,(Me=ht==null?void 0:ht.toString())!==null&&Me!==void 0?Me:""].flat(1).filter(Boolean),pt=((Pe=ce.current)===null||Pe===void 0||(ct=Pe.getFieldsValue)===null||ct===void 0?void 0:ct.call(Pe))||{},xt=Object(qe.a)(pt,gt,Object(l.a)(Object(l.a)({},ye(fe)),Q||{}));return(vt=ce.current)===null||vt===void 0?void 0:vt.setFieldsValue(xt)}})}),Object(He.useEffect)(function(){!b.controlled||z.forEach(function(ye,ae){var ue;(ue=ce.current)===null||ue===void 0||ue.setFieldsValue(Object(P.a)({},et(ye,ae),ye))},{})},[z,b.controlled]),Object(He.useEffect)(function(){if(b.name){var ye;ce.current=b==null||(ye=b.editable)===null||ye===void 0?void 0:ye.form}},[(Se=b.editable)===null||Se===void 0?void 0:Se.form,b.name]);var We=Z||{},Ye=We.record,E=We.position,e=We.creatorButtonText,S=We.newRecordType,g=We.parentKey,p=We.style,R=Object(je.a)(We,h),L=E==="top",be=Object(He.useMemo)(function(){return Le&&Le<=(z==null?void 0:z.length)?!1:Z!==!1&&Object(re.jsx)(Be,{record:Object(Ne.a)(Ye,z==null?void 0:z.length,z)||{},position:E,parentKey:Object(Ne.a)(g,z==null?void 0:z.length,z),newRecordType:S,children:Object(re.jsx)(f.a,Object(l.a)(Object(l.a)({type:"dashed",style:Object(l.a)({display:"block",margin:"10px 0",width:"100%"},p),icon:Object(re.jsx)(_e.a,{})},R),{},{children:e||Qe.getMessage("editableTable.action.add","\u6DFB\u52A0\u4E00\u884C\u6570\u636E")}))})},[Z,Le,z==null?void 0:z.length]),rt=Object(He.useMemo)(function(){return be?L?{components:{header:{wrapper:function(ae){var ue,fe=ae.className,Q=ae.children;return Object(re.jsxs)("thead",{className:fe,children:[Q,Object(re.jsxs)("tr",{style:{position:"relative"},children:[Object(re.jsx)("td",{colSpan:0,style:{visibility:"hidden"},children:be}),Object(re.jsx)("td",{style:{position:"absolute",left:0,width:"100%"},colSpan:(ue=Ze.columns)===null||ue===void 0?void 0:ue.length,children:be})]})]})}}}}:{tableViewRender:function(ae,ue){var fe,Q;return Object(re.jsxs)(re.Fragment,{children:[(fe=(Q=b.tableViewRender)===null||Q===void 0?void 0:Q.call(b,ae,ue))!==null&&fe!==void 0?fe:ue,be]})}}:{}},[L,be]),we=Object(l.a)({},b.editable),st=Object($e.a)(function(ye,ae){var ue,fe,Q;if((ue=b.editable)===null||ue===void 0||(fe=ue.onValuesChange)===null||fe===void 0||fe.call(ue,ye,ae),(Q=b.onValuesChange)===null||Q===void 0||Q.call(b,ae,ye),b.controlled){var Me;b==null||(Me=b.onChange)===null||Me===void 0||Me.call(b,ae)}});return((b==null?void 0:b.onValuesChange)||((ve=b.editable)===null||ve===void 0?void 0:ve.onValuesChange)||b.controlled&&(b==null?void 0:b.onChange))&&(we.onValuesChange=st),Object(re.jsxs)(re.Fragment,{children:[Object(re.jsx)(V.Provider,{value:Je,children:Object(re.jsx)(te.a,Object(l.a)(Object(l.a)(Object(l.a)({search:!1,options:!1,pagination:!1,rowKey:K,revalidateOnFocus:!1},Ze),rt),{},{tableLayout:"fixed",actionRef:Je,onChange:Te,editable:Object(l.a)(Object(l.a)({},we),{},{formProps:Object(l.a)({formRef:ce},we.formProps)}),dataSource:z,onDataSourceChange:function(ae){if(_t(ae),b.name&&E==="top"){var ue,fe=Object(qe.a)({},[b.name].flat(1).filter(Boolean),ae);(ue=ce.current)===null||ue===void 0||ue.setFieldsValue(fe)}}}))}),b.name?Object(re.jsx)(q.a,{name:[b.name],children:function(ae){var ue,fe,Q=Object(Ve.a)(ae,[b.name].flat(1)),Me=Q==null?void 0:Q.find(function(Pe,ct){return!Object(v.a)(Pe,lt==null?void 0:lt[ct])});return Me&&lt&&(b==null||(ue=b.editable)===null||ue===void 0||(fe=ue.onValuesChange)===null||fe===void 0||fe.call(ue,Me,Q)),null}}):null]})}function se(b){var Se=Ee.a.useFormInstance();return b.name?Object(re.jsx)(B.a.Item,Object(l.a)(Object(l.a)({style:{maxWidth:"100%"}},b==null?void 0:b.formItemProps),{},{name:b.name,children:Object(re.jsx)(F,Object(l.a)(Object(l.a)({},b),{},{editable:Object(l.a)(Object(l.a)({},b.editable),{},{form:Se})}))})):Object(re.jsx)(F,Object(l.a)({},b))}se.RecordCreator=Be,oe.a=se},KxBF:function(Fe,oe){function t(c,B,$){var f=-1,P=c.length;B<0&&(B=-B>P?0:P+B),$=$>P?P:$,$<0&&($+=P),P=B>$?0:$-B>>>0,B>>>=0;for(var u=Array(P);++f<P;)u[f]=c[f+B];return u}Fe.exports=t},LDJE:function(Fe,oe,t){"use strict";var c=t("q1tI"),B=t.n(c),$=t("ma/q"),f=t("ZIEt"),P=t("QpZ9"),u=t("GzfL"),je=t("Scwr"),a=function(l,re){var he={};for(var _e in l)Object.prototype.hasOwnProperty.call(l,_e)&&re.indexOf(_e)<0&&(he[_e]=l[_e]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var q=0,_e=Object.getOwnPropertySymbols(l);q<_e.length;q++)re.indexOf(_e[q])<0&&Object.prototype.propertyIsEnumerable.call(l,_e[q])&&(he[_e[q]]=l[_e[q]]);return he},Ae=Object(c.forwardRef)(function(l,re){var he=l.chartRef,_e=l.style,q=_e===void 0?{height:"inherit"}:_e,Ee=l.className,ke=l.loading,pe=l.loadingTemplate,Ne=l.errorTemplate,$e=a(l,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),v=Object(f.a)($.a,$e),O=v.chart,Ve=v.container;return Object(c.useEffect)(function(){Object(P.a)(he,O.current)},[O.current]),Object(c.useImperativeHandle)(re,function(){return{getChart:function(){return O.current}}}),B.a.createElement(u.a,{errorTemplate:Ne},ke&&B.a.createElement(je.a,{loadingTemplate:pe,theme:l.theme}),B.a.createElement("div",{className:Ee,style:q,ref:Ve}))});oe.a=Ae},bahg:function(Fe,oe){function t(c){return c.split("")}Fe.exports=t},jsgi:function(Fe,oe,t){"use strict";var c=t("k1fw"),B=t("q1tI"),$=t.n(B),f=t("nhC9"),P=t("LDJE"),u=t("nKUr"),je=t.n(u),a=function(l){var re=l.config,he=l.value,_e=l.title,q=l.children,Ee=l.valueLabel,ke=Object(B.useCallback)(function(Ne,$e){var v,O=(v=he.find(function(Ve){return Ve.type===$e.type}))===null||v===void 0?void 0:v.topic;return O?"".concat(O.topicable_type.split("\\").pop(),":").concat(O.title):Ne},[he]),pe=Object(B.useCallback)(function(Ne){return{name:Ee||Ne.type,value:Ne.value}},[Ee]);return Object(u.jsx)(f.a,{title:_e,headerBordered:!0,children:Object(u.jsxs)("div",{style:{overflow:"auto",minHeight:"400px"},children:[Object(u.jsx)(P.a,Object(c.a)(Object(c.a)({},re),{},{tooltip:{formatter:pe,title:ke},data:he})),q&&q]})})};oe.a=a},olry:function(Fe,oe,t){"use strict";t.r(oe);var c=t("k1fw"),B=t("+L6B"),$=t("2/Rp"),f=t("T2oS"),P=t("W9HT"),u=t("q1tI"),je=t("nhC9"),a=t("9kvl"),Ae=t("55Ip"),l=t("Ty5D"),re=t("tMyG"),he=t("my69"),_e=t("huej"),q=t("mJ0o"),Ee=t("EhlZ"),ke=t("P2fV"),pe=t("NJEC"),Ne=t("5Dmo"),$e=t("3S7+"),v=t("qLMh"),O=t("9og8"),Ve=t("sWYD"),qe=t("G3dp"),He=t("lbgm"),xe=t("/MfK"),te=t("Qiat"),k=t("mGZj");function h(o,i){return V.apply(this,arguments)}function V(){return V=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams",Object(c.a)({method:"GET",useCache:!1,params:i},r||{})));case 1:case"end":return n.stop()}},o)})),V.apply(this,arguments)}function Be(o,i){return F.apply(this,arguments)}function F(){return F=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams",Object(c.a)({method:"POST",headers:{"Content-Type":"application/json"},data:i},r||{})));case 1:case"end":return n.stop()}},o)})),F.apply(this,arguments)}function se(o,i,r){return b.apply(this,arguments)}function b(){return b=Object(O.a)(Object(v.a)().mark(function o(i,r,s){return Object(v.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i),Object(c.a)({method:"PUT",data:r,useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),b.apply(this,arguments)}function Se(o,i){return ve.apply(this,arguments)}function ve(){return ve=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i),Object(c.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),ve.apply(this,arguments)}function Qe(o,i){return Te.apply(this,arguments)}function Te(){return Te=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i),Object(c.a)({method:"DELETE"},r||{})));case 1:case"end":return n.stop()}},o)})),Te.apply(this,arguments)}function Le(o,i,r,s){return Ie.apply(this,arguments)}function Ie(){return Ie=Object(O.a)(Object(v.a)().mark(function o(i,r,s,n){return Object(v.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i,"/users/").concat(r),Object(c.a)({method:"POST",headers:{"Content-Type":"application/json"},data:s},n||{})));case 1:case"end":return j.stop()}},o)})),Ie.apply(this,arguments)}function Z(o,i,r){return K.apply(this,arguments)}function K(){return K=Object(O.a)(Object(v.a)().mark(function o(i,r,s){return Object(v.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/exams/".concat(i,"/users/").concat(r),Object(c.a)({method:"DELETE"},s||{})));case 1:case"end":return d.stop()}},o)})),K.apply(this,arguments)}var Re=t("giR+"),Xe=t("fyUT"),W=t("tJVT"),ot=t("14J3"),Ze=t("BMrR"),lt=t("jCWc"),Je=t("kPKH"),ce=t("VMEa"),Ot=t("Qurx"),ft=t("lR9U"),z=t("/y+f"),_t=t("2qtc"),et=t("kLXV"),mt=t("OaEy"),We=t("2fM7"),Ye=t("oBTY"),E=t("DBJ/"),e=t("nKUr"),S=[z.b.TeamsLecture,z.b.TestPortal,z.b.TeamsForms];function g(o){var i=o.showSelectAll,r=i===void 0?!0:i,s=o.options,n=s===void 0?[]:s,d=o.value,j=o.onChange,m=Object(u.useCallback)(function(){j==null||j(n.map(function(C){return C.value}),n)},[j,n]),T=Object(u.useCallback)(function(){j==null||j([],[])},[j]),y=Object(u.useMemo)(function(){return r?[{label:d!=null&&d.length?Object(e.jsx)($.a,{type:"link",onClick:T,children:Object(e.jsx)(a.a,{id:"deselect_all"})}):Object(e.jsx)($.a,{type:"link",onClick:m,children:Object(e.jsx)(a.a,{id:"select_all"})}),options:n}]:n},[m,T,n,r,d==null?void 0:d.length]);return{options:y,value:d,onChange:j}}var p=function(i){var r=i.open,s=i.closeModal,n=i.onSuccess,d=i.type,j=Object(q.b)(),m=j.teacherSubjectData,T=j.semester_subject_id,y=j.groupUsers,C=j.getGroupUsers,D=Object(u.useState)(),A=Object(W.a)(D,2),G=A[0],M=A[1],Y=Object(u.useState)([]),_=Object(W.a)(Y,2),H=_[0],ge=_[1],x={type:d,semester_subject_id:T},J=Object(u.useCallback)(function(N){N.success&&M(N.data.results)},[]),U=Object(u.useMemo)(function(){var N;return((N=m==null?void 0:m.groups)!==null&&N!==void 0?N:[]).map(function(Ce){var De=Ce.id,ie=Ce.name;return{label:ie,value:De}})},[]),w=Object(u.useCallback)(function(N){ge(N);var Ce=N.reduce(function(De,ie){var ne,Oe=(ne=y.byId)===null||ne===void 0?void 0:ne[ie];if(!Oe)return De;var X=Oe.users.map(function(ee){var Ke=ee.id,I=ee.email,me=ee.first_name,de=ee.last_name;return{email:I,first_name:me,last_name:de,user_id:Ke,result:0}});return[].concat(Object(Ye.a)(De),Object(Ye.a)(X))},[]);M(Ce!=null&&Ce.length?Ce:void 0)},[y.byId]),le=g({options:U,onChange:w,value:H});return Object(u.useEffect)(function(){if(d===z.b.Manual&&r){var N;m==null||(N=m.groups)===null||N===void 0||N.forEach(function(Ce){var De=Ce.id;return C(De)})}},[d,r]),Object(e.jsxs)(et.a,{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.".concat(d,"Convert")}),width:"40vw",open:r,onCancel:s,onOk:function(){G&&n(G)},okButtonProps:{disabled:!G},children:[S.includes(d)&&Object(e.jsx)(E.a,{name:"file",url:"/api/admin/exams/parse",onUpload:J,onChange:function(Ce){return!Ce.fileList.length&&M(void 0)},maxFiles:1,data:x,hideLabel:!0}),d===z.b.Manual&&Object(e.jsx)(We.a,Object(c.a)(Object(c.a)({},le),{},{placeholder:Object(e.jsx)(a.a,{id:"select_groups"}),mode:"multiple",style:{width:"100%"}}))]})},R=function(i){var r=i.onSelect;return Object(e.jsxs)(Ze.a,{gutter:[16,16],children:[Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(z.b.TeamsForms)},children:Object(e.jsx)(a.a,{id:"uploadFile.MsTeamsForms",defaultMessage:"uploadFile.MsTeamsForms"})})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(z.b.TestPortal)},children:Object(e.jsx)(a.a,{id:"uploadFile.TestPortal",defaultMessage:"uploadFile.TestPortal"})})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(z.b.TeamsLecture)},children:Object(e.jsx)(a.a,{id:"uploadFile.MsTeams",defaultMessage:"uploadFile.MsTeams"})})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)($.a,{type:"primary",onClick:function(){return r(z.b.Manual)},children:Object(e.jsx)(a.a,{id:"uploadGradesManually",defaultMessage:"uploadGradesManually"})})})]})},L=[{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"first_name",editable:!1},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"last_name",editable:!1},{title:Object(e.jsx)(a.a,{id:"examResult"}),dataIndex:"result",valueType:"percent",formItemProps:{rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:0,max:100}})}]}}],be=function(i){var r=i.exam_id,s=ce.a.useForm(),n=Object(W.a)(s,1),d=n[0],j=Object(u.useState)(),m=Object(W.a)(j,2),T=m[0],y=m[1],C=Object(u.useState)(),D=Object(W.a)(C,2),A=D[0],G=D[1],M=Object(u.useState)(!1),Y=Object(W.a)(M,2),_=Y[0],H=Y[1],ge=Object(q.b)(),x=ge.semester_subject_id,J=Object(u.useMemo)(function(){return(A!=null?A:[]).map(function(w){var le=w.user_id;return le})},[A]);Object(u.useEffect)(function(){var w=Number(r);r==="new"&&(y(void 0),G(void 0),d.resetFields()),r!=="new"&&!Number.isNaN(w)&&(H(!0),Se(w).then(function(le){if(le.success){var N=le.data,Ce=N.type,De=N.results,ie=N.title,ne=N.weight,Oe=N.passed_at;y(Ce),G(De),d.setFieldsValue({title:ie,weight:ne,passed_at:Oe})}}).finally(function(){return H(!1)}))},[r]);var U=Object(u.useCallback)(function(){y(void 0),G(void 0)},[]);return _?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[T&&Object(e.jsx)(p,{open:Boolean(T&&!A),type:T,closeModal:U,onSuccess:G}),Object(e.jsxs)(ce.a,{form:d,submitter:T===void 0||!A?!1:void 0,onFinish:function(){var w=Object(O.a)(Object(v.a)().mark(function le(N){var Ce,De,ie,ne,Oe,X,ee;return Object(v.a)().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(Ce=A==null?void 0:A.every(function(me){var de=me.result;return typeof de=="number"&&de>=0&&de<=100}),!(Ce&&typeof x=="number")){I.next=16;break}if(De=N.title,ie=N.passed_at,ne=N.weight,Oe=Number(r),X={type:T,semester_subject_id:x,title:De,passed_at:ie,weight:ne,results:A},!Number.isNaN(Oe)){I.next=11;break}return I.next=8,Be(X);case 8:I.t0=I.sent,I.next=14;break;case 11:return I.next=13,se(Oe,X);case 13:I.t0=I.sent;case 14:ee=I.t0,ee.success&&a.f.push("/teacher/subjects/".concat(x,"/exams"));case 16:return I.abrupt("return",!0);case 17:case"end":return I.stop()}},le)}));return function(le){return w.apply(this,arguments)}}(),onReset:U,children:[Object(e.jsxs)(ce.a.Group,{children:[Object(e.jsx)(Ot.a,{label:Object(e.jsx)(a.a,{id:"examTitle",defaultMessage:"examTitle"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],width:"lg",name:"title"}),Object(e.jsx)(ft.a,{label:Object(e.jsx)(a.a,{id:"datePassingExam",defaultMessage:"datePassingExam"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],width:"lg",name:"passed_at"}),Object(e.jsx)(ce.a.Item,{name:"weight",label:Object(e.jsx)(a.a,{id:"examImportance",defaultMessage:"examImportance"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:1,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:1,max:100}})}],children:Object(e.jsx)(Xe.a,{})})]}),T&&A&&Object(e.jsx)(te.a,{rowKey:"user_id",editable:{type:"single",editableKeys:J,onValuesChange:function(le,N){return G(N)}},cardProps:{bodyStyle:{paddingInline:0}},search:!1,dataSource:A,columns:L}),!A&&Object(e.jsx)(R,{onSelect:y})]})]})},rt=[{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"first_name"},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"last_name"},{title:Object(e.jsx)(a.a,{id:"examResult"}),dataIndex:"result",hideInSearch:!0}],we=function(i){var r=i.exam_id;return Object(e.jsx)(te.a,{rowKey:"user_id",search:!1,headerTitle:Object(e.jsx)(a.a,{id:"examResults"}),request:Object(O.a)(Object(v.a)().mark(function s(){var n;return Object(v.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,Se(r);case 2:if(n=j.sent,!n.success){j.next=5;break}return j.abrupt("return",{total:n.data.results.length,success:!0,data:n.data.results});case 5:return j.abrupt("return",[]);case 6:case"end":return j.stop()}},s)})),columns:rt})},st=[{title:Object(e.jsx)(a.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",sorter:!0},{title:Object(e.jsx)(a.a,{id:"title",defaultMessage:"title"}),dataIndex:"title",hideInSearch:!0,sorter:!0},{title:Object(e.jsx)(a.a,{id:"type",defaultMessage:"type"}),dataIndex:"type",sorter:!0,render:function(i,r){return Object(e.jsx)(a.a,{id:"ExamGradeType.".concat(r.type)})}},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.exam_date",defaultMessage:"Exam date"}),dataIndex:"passed_at",sorter:!0,render:function(i,r){return r.passed_at&&Object(Ve.a)(new Date(r.passed_at),k.c)}},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",sorter:!0,render:function(i,r){return r.weight+"%"}},{title:Object(e.jsx)(a.a,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",sorter:!0,render:function(i,r){return r.created_at&&Object(Ve.a)(new Date(r.created_at),k.c)}},{title:Object(e.jsx)(a.a,{id:"semester",defaultMessage:"Semester"}),dataIndex:"semester",sorter:!0,render:function(i,r){return Object(e.jsx)(a.a,{id:"SemesterType.".concat(r.semester.type),values:{year:r.semester.year}})}}],ye=function(){var i,r,s=Object(u.useRef)(),n=Object(q.b)(),d=n.semester_subject_id,j=Object(l.k)(),m=Object(u.useMemo)(function(){var C,D,A;return{exam_id:(C=(D=j.query)===null||D===void 0?void 0:D.exam_id)!==null&&C!==void 0?C:null,results:(A=j.query)===null||A===void 0?void 0:A.results}},[(i=j.query)===null||i===void 0?void 0:i.exam_id,(r=j.query)===null||r===void 0?void 0:r.results]),T=m.exam_id,y=m.results;return y!==null&&!Number.isNaN(Number(y))?Object(e.jsx)(we,{exam_id:Number(y)}):T!==null?Object(e.jsx)(be,{exam_id:T}):Object(e.jsx)(te.a,{headerTitle:Object(e.jsx)(a.a,{id:"exams"}),actionRef:s,search:!1,rowKey:"id",request:function(){var C=Object(O.a)(Object(v.a)().mark(function D(A,G){var M,Y,_,H;return Object(v.a)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(M=A.current,Y=A.pageSize,d!==null){x.next=3;break}return x.abrupt("return",{data:[],total:0,success:!1});case 3:return _=G&&Object.entries(G)[0],x.next=6,h({per_page:Y,page:M,semester_subject_id:Number.isNaN(d)?void 0:d,order_by:_&&_[0],order:_&&(_[1]==="ascend"?"ASC":"DESC")});case 6:if(H=x.sent,!H.success){x.next=9;break}return x.abrupt("return",{data:H.data,total:H.meta.total,success:!0});case 9:return x.abrupt("return",{data:[],total:0,success:!1});case 10:case"end":return x.stop()}},D)}));return function(D,A){return C.apply(this,arguments)}}(),columns:[].concat(st,[{title:Object(e.jsx)(a.a,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(D,A){return[Object(e.jsx)(Ae.a,{to:"/teacher/subjects/".concat(A.semester_subject_id,"/exams?exam_id=").concat(A.id),children:Object(e.jsx)($e.a,{title:Object(e.jsx)(a.a,{id:"edit",defaultMessage:"edit"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(qe.a,{})})})},"edit"),Object(e.jsx)(Ae.a,{to:"/teacher/subjects/".concat(A.semester_subject_id,"/exams?results=").concat(A.id),children:Object(e.jsx)($e.a,{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.results",defaultMessage:"results"}),children:Object(e.jsx)($.a,{icon:Object(e.jsx)(He.a,{})})})},"results"),Object(e.jsx)(pe.a,{title:Object(e.jsx)(a.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(O.a)(Object(v.a)().mark(function G(){var M;return Object(v.a)().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,Qe(A.id);case 2:M=_.sent,M.success&&s.current&&s.current.reload();case 4:case"end":return _.stop()}},G)})),okText:Object(e.jsx)(a.a,{id:"yes"}),cancelText:Object(e.jsx)(a.a,{id:"no"}),children:Object(e.jsx)($e.a,{title:Object(e.jsx)(a.a,{id:"delete",defaultMessage:"delete"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(xe.a,{}),danger:!0})})},"delete")]}}])})},ae=t("DYRE"),ue=t("zeV3"),fe=t("tU7J"),Q=t("wFql"),Me=t("4KAj"),Pe=t("o0Ox"),ct=[{title:Object(e.jsx)(a.a,{id:"ID",defaultMessage:"ID"}),dataIndex:"user_id",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"first_name",defaultMessage:"First name"}),dataIndex:"first_name",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"last_name",defaultMessage:"Last name"}),dataIndex:"last_name",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"email",defaultMessage:"email"}),dataIndex:"email",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"groupName",defaultMessage:"Group name"}),dataIndex:"group_name",hideInSearch:!0}],vt=function(){var i,r=Object(u.useState)(!1),s=Object(W.a)(r,2),n=s[0],d=s[1],j=Object(q.b)(),m=j.teacherSubjectData,T=Object(u.useState)([]),y=Object(W.a)(T,2),C=y[0],D=y[1],A=Object(u.useRef)(),G=Object(u.useMemo)(function(){return C.reduce(function(_,H){var ge,x=[];return H==null||(ge=H.users)===null||ge===void 0||ge.reduce(function(J,U){var w={group_id:H.id,group_name:H.name,user_id:U.id,first_name:U.first_name,last_name:U.last_name,email:U.email};return x.push(w),Object(c.a)(Object(c.a)({},J),w)},{}),d(!1),[].concat(Object(Ye.a)(_),x)},[])},[C]),M=function(H){Object(Pe.a)({parent_id:m==null?void 0:m.group_id,"id[]":H}).then(function(ge){ge.success&&D(ge.data)})},Y=function(H){d(!0),M(H)};return Object(u.useEffect)(function(){M()},[]),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(je.a,{children:Object(e.jsxs)(ue.b,{children:[Object(e.jsx)(Q.a.Title,{level:5,children:Object(e.jsx)(a.a,{id:"select_user_group",defaultMessage:"Select group"})}),Object(e.jsx)(We.a,{allowClear:!0,mode:"multiple",style:{minWidth:"400px"},onChange:Y,onClear:M,children:m==null||(i=m.groups)===null||i===void 0?void 0:i.map(function(_){return Object(e.jsx)(We.a.Option,{value:_.id,children:_.name},_.id)})})]})}),Object(e.jsx)(te.a,{actionRef:A,rowKey:"user_id",search:!1,loading:n,dataSource:G!=null?G:[],columns:[].concat(ct,[{hideInSearch:!0,title:Object(e.jsx)(a.a,{id:"msTeams"}),dataIndex:"teamsLink",valueType:"option",render:function(){return[Object(e.jsx)(Ae.a,{to:"#",children:Object(e.jsx)($e.a,{title:Object(e.jsx)(a.a,{id:"msTeams",defaultMessage:"teams"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(Me.a,{})})})},"teamsLink")]}}])})]})},ht=vt,gt=t("jrin");function pt(o,i){return xt.apply(this,arguments)}function xt(){return xt=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/schedules/groups/".concat(i),Object(c.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),xt.apply(this,arguments)}function Kt(o,i,r,s){return Tt.apply(this,arguments)}function Tt(){return Tt=Object(O.a)(Object(v.a)().mark(function o(i,r,s,n){return Object(v.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(a.i)("/api/admin/schedules/".concat(i,"/attendances"),Object(c.a)({data:{attendances:[{user_id:r,value:s}]},method:"POST"},n||{})));case 1:case"end":return j.stop()}},o)})),Tt.apply(this,arguments)}var Ia=t("sRBo"),Bt=t("kaz8"),Vt=function(i){var r=i.currentData,s=i.recordData,n=i.groupId,d=i.onSuccess,j=Object(u.useState)(!1),m=Object(W.a)(j,2),T=m[0],y=m[1],C=function(){y(!0),Kt(r.id,s.id,(s==null?void 0:s[String(r.date_from)])===z.a.PRESENT?z.a.ABSENT:z.a.PRESENT).then(function(A){A.success&&pt(Number(n)).then(function(G){G.success&&(d(G.data),y(!1))})})};return T?Object(e.jsx)(P.a,{size:"small"}):Object(e.jsx)(Bt.a,{checked:(s==null?void 0:s[String(r.date_from)])===z.a.PRESENT,onChange:function(){return C()}})},Ht=Vt,Jt=function(){var i,r,s,n,d,j=Object(q.b)(),m=j.teacherSubjectData,T=Object(u.useRef)(),y=Object(a.l)(),C=Object(u.useState)(!1),D=Object(W.a)(C,2),A=D[0],G=D[1],M=Object(u.useState)(),Y=Object(W.a)(M,2),_=Y[0],H=Y[1],ge=Object(u.useState)(),x=Object(W.a)(ge,2),J=x[0],U=x[1],w=Object(u.useState)({id:(i=m==null||(r=m.groups)===null||r===void 0?void 0:r[0].id)!==null&&i!==void 0?i:null,name:m==null||(s=m.groups)===null||s===void 0?void 0:s[0].name}),le=Object(W.a)(w,2),N=le[0],Ce=le[1],De=Object(u.useMemo)(function(){var X;return((X=J==null?void 0:J.users)!==null&&X!==void 0?X:[]).reduce(function(ee,Ke){var I={id:Ke.id,first_name:Ke.first_name,last_name:Ke.last_name,academic_teacher_id:Ke.academic_teacher_id},me=(_!=null?_:[]).reduce(function(de,Ge){var Ue=Ge.attendances.find(function(tt){return tt.user_id===Ke.id});return Object(c.a)(Object(c.a)({},de),{},Object(gt.a)({},String(Ge.date_from),Ue==null?void 0:Ue.value))},{});return I.academic_teacher_id?Object(Ye.a)(ee):[].concat(Object(Ye.a)(ee),[Object(c.a)(Object(c.a)({},I),me)])},[])},[J,_]),ie=Object(u.useMemo)(function(){var X=(_!=null?_:[]).reduce(function(ee,Ke){return[].concat(Object(Ye.a)(ee),[{title:String(Object(Ve.a)(new Date(Ke.date_from),k.c)),dataIndex:String(Ke.date_from),hideInSearch:!0,width:100,align:"center",render:function(me,de){return Object(e.jsx)(Ht,{currentData:Ke,recordData:de,onSuccess:function(Ue){return H(Ue)},groupId:N.id})}}])},[]);return console.log({columns:ie}),G(!1),[{title:Object(e.jsx)(a.a,{id:"nameAndSurname",defaultMessage:"Name and surname"}),hideInSearch:!0,fixed:"left",render:function(Ke,I){return"".concat(I.first_name," ").concat(I.last_name)}}].concat(Object(Ye.a)(X))},[_]),ne=function(ee){var Ke,I=m==null||(Ke=m.groups)===null||Ke===void 0?void 0:Ke.find(function(me){return me.id===ee});return I?I==null?void 0:I.name:""},Oe=function(ee){G(!0),Ce({id:ee,name:ne(ee)})};return Object(u.useEffect)(function(){N.id&&(pt(N.id).then(function(X){X.success&&H(X.data)}),Object(Pe.b)(N.id).then(function(X){X.success&&U(X.data)}))},[N]),console.log({studentAttendanceList:De}),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(je.a,{children:Object(e.jsxs)(ue.b,{children:[Object(e.jsx)(Q.a.Title,{level:5,children:Object(e.jsx)(a.a,{id:"select_user_group",defaultMessage:"Select group"})}),Object(e.jsx)(We.a,{style:{minWidth:"400px"},onChange:Oe,defaultValue:m==null||(n=m.groups)===null||n===void 0?void 0:n[0].id,children:m==null||(d=m.groups)===null||d===void 0?void 0:d.map(function(X){return Object(e.jsx)(We.a.Option,{value:X.id,children:X.name},X.id)})})]})}),ie.length===1?Object(e.jsx)(a.a,{id:"noAttendanceSchedule",defaultMessage:"No attendance schedule for this group..."}):Object(e.jsx)(te.a,{headerTitle:"".concat(y.formatMessage({id:"attendances",defaultMessage:"Attendances"})," (").concat(N.name,")"),actionRef:T,rowKey:"group_id",search:!1,loading:A,dataSource:De!=null?De:[],scroll:{x:1500},columns:Object(Ye.a)(ie)})]})},zt=Jt,Ra=t("/zsF"),yt=t("PArb"),Yt=t("Hn4i"),Zt=t("bRQS");function Nt(o,i,r){return Ct.apply(this,arguments)}function Ct(){return Ct=Object(O.a)(Object(v.a)().mark(function o(i,r,s){return Object(v.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/semester-subjects/".concat(i,"/tutors/").concat(r,"/grades"),Object(c.a)({method:"GET",useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),Ct.apply(this,arguments)}function Qt(o,i,r,s){return Mt.apply(this,arguments)}function Mt(){return Mt=Object(O.a)(Object(v.a)().mark(function o(i,r,s,n){return Object(v.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",Object(a.i)("/api/admin/semester-subjects/".concat(i,"/tutors/").concat(r,"/grades"),Object(c.a)({method:"POST",data:s},n||{})));case 1:case"end":return j.stop()}},o)})),Mt.apply(this,arguments)}function Xt(o,i){return Pt.apply(this,arguments)}function Pt(){return Pt=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/lesson-group-users",Object(c.a)({method:"GET",params:{"groups[]":i},useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),Pt.apply(this,arguments)}function kt(o,i,r){return Dt.apply(this,arguments)}function Dt(){return Dt=Object(O.a)(Object(v.a)().mark(function o(i,r,s){return Object(v.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/lesson-group-users/groups/".concat(i,"/users/").concat(r),Object(c.a)({method:"GET",useCache:!1},s||{})));case 1:case"end":return d.stop()}},o)})),Dt.apply(this,arguments)}function qt(o){return At.apply(this,arguments)}function At(){return At=Object(O.a)(Object(v.a)().mark(function o(i){return Object(v.a)().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",Object(a.i)("/api/admin/grade-terms",Object(c.a)({method:"GET",useCache:!1},i||{})));case 1:case"end":return s.stop()}},o)})),At.apply(this,arguments)}function ea(o,i){return It.apply(this,arguments)}function It(){return It=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/grade-scales/".concat(i),Object(c.a)({method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),It.apply(this,arguments)}function ta(o,i){return Rt.apply(this,arguments)}function Rt(){return Rt=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/final-grades",Object(c.a)({method:"POST",data:i},r||{})));case 1:case"end":return n.stop()}},o)})),Rt.apply(this,arguments)}function aa(o,i,r){return Lt.apply(this,arguments)}function Lt(){return Lt=Object(O.a)(Object(v.a)().mark(function o(i,r,s){return Object(v.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(a.i)("/api/admin/final-grades/".concat(i),Object(c.a)({method:"PATCH",data:r},s||{})));case 1:case"end":return d.stop()}},o)})),Lt.apply(this,arguments)}var na=[{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade",editable:!1},{title:Object(e.jsx)(a.a,{id:"degree"}),dataIndex:"name",editable:!1},{title:Object(e.jsx)(a.a,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent",formItemProps:{rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(e.jsx)(a.a,{id:"number_between",values:{min:0,max:100}})}]}}],ra=function(){var i,r,s=Object(a.m)("@@initialState"),n=s.initialState,d=Object(q.b)(),j=d.semester_subject_id,m=d.tutors,T=ce.a.useForm(),y=Object(W.a)(T,1),C=y[0],D=Object(u.useState)([]),A=Object(W.a)(D,2),G=A[0],M=A[1],Y=Object(u.useRef)(),_=Object(u.useState)(!1),H=Object(W.a)(_,2),ge=H[0],x=H[1],J=Object(u.useState)(null),U=Object(W.a)(J,2),w=U[0],le=U[1],N=Object(u.useMemo)(function(){return!!m.data.find(function(ie){var ne,Oe=ie.id;return Oe===(n==null||(ne=n.currentUser)===null||ne===void 0?void 0:ne.id)})},[m.data,n==null||(i=n.currentUser)===null||i===void 0?void 0:i.id]),Ce=Object(u.useMemo)(function(){return m.data.map(function(ie){var ne=ie.id,Oe=ie.first_name,X=ie.last_name;return{label:"".concat(Oe," ").concat(X),value:ne}})},[m.data]);Object(u.useEffect)(function(){var ie,ne;if(!N||!(n!=null&&(ie=n.currentUser)!==null&&ie!==void 0&&ie.id)){var Oe;if((Oe=m.data)!==null&&Oe!==void 0&&Oe[0]){var X;le((X=m.data)===null||X===void 0?void 0:X[0].id)}return}le(n==null||(ne=n.currentUser)===null||ne===void 0?void 0:ne.id)},[n==null||(r=n.currentUser)===null||r===void 0?void 0:r.id,N]),Object(u.useEffect)(function(){j===null||w===null||(x(!0),Nt(j,w).then(function(ie){if(ie.success){var ne,Oe=((ne=ie.data.grade_scale)!==null&&ne!==void 0?ne:[]).map(function(X,ee){return Object(c.a)(Object(c.a)({},X),{},{id:String((ee+1)*100)})});C.setFieldValue("table",Oe)}}).finally(function(){x(!1)}))},[j,w]);var De=Object(u.useCallback)(function(){var ie=Object(O.a)(Object(v.a)().mark(function ne(Oe){return Object(v.a)().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(!(j===null||w===null)){ee.next=2;break}return ee.abrupt("return");case 2:return ee.next=4,Qt(j,w,{grade_scale:Oe.table});case 4:case"end":return ee.stop()}},ne)}));return function(ne){return ie.apply(this,arguments)}}(),[w,j]);return m.loading?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(ce.a.Item,{label:Object(e.jsx)(a.a,{id:"menu.Teacher"}),children:Object(e.jsx)(We.a,{disabled:N,placeholder:Object(e.jsx)(a.a,{id:"select"}),options:Ce,value:w,onChange:function(ne){return le(ne)}})}),Object(e.jsx)(yt.a,{}),Object(e.jsx)(ce.a,{form:C,onFinish:De,submitter:{render:function(ne,Oe){var X=Object(W.a)(Oe,2),ee=X[1];return[ee]}},children:Object(e.jsx)(Yt.a,{name:"table",rowKey:"id",actionRef:Y,formItemProps:{label:Object(e.jsx)(a.a,{id:"grades-scale"})},cardProps:{bodyStyle:{padding:0}},recordCreatorProps:!1,loading:ge,columns:[].concat(na,[{title:Object(e.jsx)(a.a,{id:"options"}),valueType:"option",render:function(ne,Oe){return Object(e.jsx)($.a,{type:"primary",onClick:function(){var ee;return(ee=Y.current)===null||ee===void 0?void 0:ee.startEditable(Oe.id)},icon:Object(e.jsx)(qe.a,{})})}}]),editable:{form:C,type:"multiple",editableKeys:G,saveText:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(Zt.a,{})}),onChange:M,actionRender:function(ne,Oe,X){return[X.save]}}})})]})},La=t("qbNl"),sa=t("JBPa"),Ga=t("Awhp"),ca=t("KrTs"),ia=t("wd/R"),it=t.n(ia),Ua=t("5R/X");function ua(o,i){return Gt.apply(this,arguments)}function Gt(){return Gt=Object(O.a)(Object(v.a)().mark(function o(i,r){return Object(v.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Object(a.i)("/api/admin/schedules",Object(c.a)({params:i,method:"GET",useCache:!1},r||{})));case 1:case"end":return n.stop()}},o)})),Gt.apply(this,arguments)}var la=function(){var i=Object(u.useState)(null),r=Object(W.a)(i,2),s=r[0],n=r[1],d=Object(u.useState)([]),j=Object(W.a)(d,2),m=j[0],T=j[1],y=Object(q.b)(),C=y.semester_subject_id,D=it()(),A=Object(u.useMemo)(function(){return m.map(function(x){return{id:x.id,title:"".concat(x.group.name," (").concat(x.term_status.name,")"),start:it()(x.date_from).toDate(),end:it()(x.date_to).toDate(),tutor_name:"".concat(x.tutor.first_name," ").concat(x.tutor.last_name),tutor_email:x.tutor.email,semester:x.semester.name,group:x.group.name,subject:x.subject.name}})},[m]),G=Object(u.useCallback)(function(x,J){ua({semester_subject_id:C,date_form:x.toDate(),date_to:J.toDate()}).then(function(U){U.success&&T(U.data)})},[C]),M=Object(u.useCallback)(function(x){n(x)},[]),Y=Object(u.useCallback)(function(){n(null)},[]),_=Object(u.useCallback)(function(x){return x.isSame(D,"day")?"warning":x.isAfter(D,"day")?"success":"error"},[]),H=Object(u.useCallback)(function(x){var J=A.filter(function(U){return it()(U.start).isSame(x,"day")});return Object(e.jsx)("ul",{className:"events",children:J.map(function(U){return Object(e.jsx)("li",{onClick:function(){return M(U)},children:Object(e.jsx)(ca.a,{status:_(it()(U.start)),text:U.title})},U.id)})})},[m]),ge=Object(u.useCallback)(function(x,J){var U=it()(x).startOf(J).subtract(1,"month"),w=it()(x).endOf(J).add(1,"month");G(U,w)},[]);return Object(u.useEffect)(function(){var x=it()().startOf("month"),J=it()().endOf("month");G(x,J)},[]),Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Q.a.Title,{level:4,children:Object(e.jsx)(a.a,{id:"schedule",defaultMessage:"Schedule"})}),Object(e.jsx)(sa.a,{dateCellRender:H,onPanelChange:ge}),Object(e.jsxs)(et.a,{open:s!==null,title:"".concat(s==null?void 0:s.subject,": ").concat(s==null?void 0:s.title),onCancel:Y,footer:null,children:[Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"tutorName",defaultMessage:"Tutor"}),": ",s==null?void 0:s.tutor_name]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"email",defaultMessage:"Email"}),": ",s==null?void 0:s.tutor_email]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"group",defaultMessage:"Group"}),": ",s==null?void 0:s.group]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"semester",defaultMessage:"Semester"}),": ",s==null?void 0:s.semester]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"started_at",defaultMessage:"Start date"}),":",s&&it()(s.start).format(k.b)]}),Object(e.jsxs)(Q.a.Paragraph,{children:[Object(e.jsx)(a.a,{id:"end_at",defaultMessage:"End date"}),":",s&&it()(s.end).format(k.b)]})]})]})},da=la,Ut=t("PpiC"),oa=t("Vpfc"),Fa=t("miYZ"),Et=t("tsqr"),$t=t("yj/a"),Wt=t("5Syx"),Ft=t("H6aw"),ja=t("p3I6"),ba=["attendances"],fa=["results"];function Oa(o,i){var r=Object(u.useState)({loading:!1}),s=Object(W.a)(r,2),n=s[0],d=s[1];return Object(u.useEffect)(function(){d(function(j){return Object(c.a)(Object(c.a)({},j),{},{loading:!0})}),kt(o,i).then(function(j){j.success&&d(function(m){return Object(c.a)(Object(c.a)({},m),{},{data:j.data})})}).finally(function(){d(function(j){return Object(c.a)(Object(c.a)({},j),{},{loading:!1})})})},[i,o]),{finalGrades:n}}function ma(){var o=Object(u.useState)({loading:!1}),i=Object(W.a)(o,2),r=i[0],s=i[1];return Object(u.useEffect)(function(){s(function(n){return Object(c.a)(Object(c.a)({},n),{},{loading:!0})}),qt().then(function(n){n.success&&s(function(d){return Object(c.a)(Object(c.a)({},d),{},{data:n.data})})}).finally(function(){s(function(n){return Object(c.a)(Object(c.a)({},n),{},{loading:!1})})})},[]),{gradeTerms:r}}function va(o){var i=Object(u.useState)({loading:!1}),r=Object(W.a)(i,2),s=r[0],n=r[1];return Object(u.useEffect)(function(){o!==void 0&&(n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!0})}),ea(o).then(function(d){d.success&&n(function(j){return Object(c.a)(Object(c.a)({},j),{},{data:d.data})})}).finally(function(){n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!1})})}))},[o]),{subjectGradeScales:s}}function ha(o,i){var r=Object(u.useState)({loading:!1}),s=Object(W.a)(r,2),n=s[0],d=s[1];return Object(u.useEffect)(function(){typeof o!="number"||typeof i!="number"||(d(function(j){return Object(c.a)(Object(c.a)({},j),{},{loading:!0})}),Nt(o,i).then(function(j){j.success&&d(function(m){return Object(c.a)(Object(c.a)({},m),{},{data:j.data.grade_scale})})}).finally(function(){d(function(j){return Object(c.a)(Object(c.a)({},j),{},{loading:!1})})}))},[o,i]),{tutorGradeScales:n}}function ga(o,i){var r=Object(u.useState)({loading:!1}),s=Object(W.a)(r,2),n=s[0],d=s[1],j=Object(u.useCallback)(function(){d(function(T){return Object(c.a)(Object(c.a)({},T),{},{loading:!0})}),pt(o).then(function(T){if(T.success){var y=T.data.reduce(function(C,D){var A=D.attendances,G=Object(Ut.a)(D,ba),M=A.find(function(Y){return Boolean(Y.user_id)});return M?[].concat(Object(Ye.a)(C),[Object(c.a)(Object(c.a)({},G),{},{attendance:M})]):C},[]);d(function(C){return Object(c.a)(Object(c.a)({},C),{},{data:y})})}}).finally(function(){d(function(T){return Object(c.a)(Object(c.a)({},T),{},{loading:!1})})})},[o,i]),m=Object(u.useCallback)(function(T,y){d(function(C){return Object(c.a)(Object(c.a)({},C),{},{loading:!0})}),Kt(T,i,y).then(function(C){C.success?Et.b.success(C.message):Et.b.error(C.message)}).finally(function(){j(),d(function(C){return Object(c.a)(Object(c.a)({},C),{},{loading:!1})})})},[j,i]);return Object(u.useEffect)(function(){j()},[j]),{userAttendanceSchedules:n,fetchUserAttendanceSchedules:j,updateUserAttendanceSchedules:m}}function pa(o){var i=Object(u.useState)({loading:!1}),r=Object(W.a)(i,2),s=r[0],n=r[1];return Object(u.useEffect)(function(){n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!0})}),h({student_id:o}).then(function(d){if(d.success){var j=d.data.reduce(function(m,T){var y=Object(W.a)(T.results,1),C=y[0],D=Object(Ut.a)(T,fa);return C?[].concat(Object(Ye.a)(m),[Object(c.a)(Object(c.a)({},D),{},{result:C})]):m},[]);n(function(m){return Object(c.a)(Object(c.a)({},m),{},{data:j})})}}).finally(function(){n(function(d){return Object(c.a)(Object(c.a)({},d),{},{loading:!1})})})},[o]),{studentExams:s}}function xa(o,i){var r=Object(u.useState)({loading:!1}),s=Object(W.a)(r,2),n=s[0],d=s[1],j=Object(u.useState)({loading:!1}),m=Object(W.a)(j,2),T=m[0],y=m[1],C=Object(u.useState)({loading:!1}),D=Object(W.a)(C,2),A=D[0],G=D[1];return Object(u.useEffect)(function(){d(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!0})}),Object(Ft.e)({group_id:o}).then(function(M){M.success&&d(function(Y){return Object(c.a)(Object(c.a)({},Y),{},{data:M.data})})}).finally(function(){d(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!1})})})},[o]),Object(u.useEffect)(function(){!n.data||(G(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!0})}),Promise.all(n.data.map(function(M){var Y=M.id;return Object(Ft.m)(Number(Y))})).then(function(M){M.forEach(function(Y){Y.success&&G(function(_){return Object(c.a)(Object(c.a)({},_),{},{data:Object(c.a)(Object(c.a)({},_.data),{},Object(gt.a)({},Number(Y.data.id),Object(ja.c)(Y.data.lessons)))})})})}).finally(function(){G(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!1})})}),y(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!0})}),Promise.all(n.data.map(function(M){var Y=M.id;return Object(Ft.l)(Number(Y),["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics","EscolaLms\\Reports\\Stats\\Course\\AttendanceList"]).then(function(_){if(_.success){var H,ge,x=((H=_.data["EscolaLms\\Reports\\Stats\\Course\\FinishedTopics"])!==null&&H!==void 0?H:[]).filter(function(U){return U.id===i}),J=(ge=_.data["EscolaLms\\Reports\\Stats\\Course\\AttendanceList"])!==null&&ge!==void 0?ge:[];y(function(U){return Object(c.a)(Object(c.a)({},U),{},{data:Object(c.a)(Object(c.a)({},U.data),{},Object(gt.a)({},Number(Y),{finishedTopics:x,attendanceList:J}))})})}})})).finally(function(){return y(function(M){return Object(c.a)(Object(c.a)({},M),{},{loading:!1})})}))},[n.data,i]),{userCourses:n,userCoursesStats:T,userCoursesTopics:A}}var _a=[{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade"},{title:Object(e.jsx)(a.a,{id:"degree"}),dataIndex:"name"},{title:Object(e.jsx)(a.a,{id:"min_percent"}),dataIndex:"grade_value",valueType:"percent"}],Ea=[{title:Object(e.jsx)(a.a,{id:"date"}),dataIndex:"date_from",render:function(i,r){return Object(Ve.a)(new Date(r.date_from),k.c)}}],Sa=[{title:Object(e.jsx)(a.a,{id:"name"}),dataIndex:"title"},{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.Exams.grade_weight",defaultMessage:"Weight"}),dataIndex:"weight",valueType:"percent"},{title:Object(e.jsx)(a.a,{id:"created_at",defaultMessage:"Created at"}),dataIndex:"created_at",render:function(i,r){return Object(Ve.a)(new Date(r.created_at),k.c)}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"result",render:function(i,r){return"".concat(r.result.result,"%")}}],Ta=[{title:Object(e.jsx)(a.a,{id:"name"}),dataIndex:"name"},{title:Object(e.jsx)(a.a,{id:"issued_at"}),dataIndex:"grade",render:function(i,r){var s,n;return(s=r.grade)!==null&&s!==void 0&&s.grade_date?Object(Ve.a)(new Date((n=r.grade)===null||n===void 0?void 0:n.grade_date),k.c):"-"}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grade",render:function(i,r){var s,n;return(s=(n=r.grade)===null||n===void 0?void 0:n.grade_name)!==null&&s!==void 0?s:"-"}}],St=6,ya=function(i){var r,s,n=i.user_id,d=i.group_id,j=Object(q.b)(),m=j.semester_subject_id,T=pa(n),y=T.studentExams,C=Oa(d,n),D=C.finalGrades,A=ma(),G=A.gradeTerms,M=va((r=D.data)===null||r===void 0?void 0:r.s_subject_scale_form_id),Y=M.subjectGradeScales,_=ha(m,(s=D.data)===null||s===void 0?void 0:s.tutor_id),H=_.tutorGradeScales,ge=ga(d,n),x=ge.userAttendanceSchedules,J=ge.updateUserAttendanceSchedules,U=xa(d,n),w=U.userCourses,le=U.userCoursesStats,N=U.userCoursesTopics,Ce=ce.a.useForm(),De=Object(W.a)(Ce,1),ie=De[0],ne=Object(u.useMemo)(function(){var I;return((I=G.data)!==null&&I!==void 0?I:[]).map(function(me){var de=me.id,Ge=me.name;return{label:Ge,value:de}})},[G.data]),Oe=Object(u.useMemo)(function(){var I;return((I=Y.data)!==null&&I!==void 0?I:[]).map(function(me){var de=me.name,Ge=me.id;return{label:de,value:Ge}})},[Y.data]),X=Object(u.useMemo)(function(){var I,me,de,Ge=((I=y.data)!==null&&I!==void 0?I:[]).reduce(function(nt,ut){var Aa=ut.result,wt=ut.weight;return[nt[0]+Aa.result*wt,nt[1]+wt]},[0,0]),Ue=Object(W.a)(Ge,2),tt=Ue[0],dt=Ue[1],jt=Number.isNaN(tt/dt)?0:tt/dt,bt=((me=H.data)!==null&&me!==void 0?me:[]).sort(function(nt,ut){return nt.grade_value-ut.grade_value}).reduce(function(nt,ut){return[].concat(Object(Ye.a)(nt),[Object(c.a)(Object(c.a)({},ut),{},{isWeightedAverageGreater:jt>=ut.grade_value})])},[]);if(bt.every(function(nt){var ut=nt.isWeightedAverageGreater;return ut})){var ze;return(ze=bt.at(-1))===null||ze===void 0?void 0:ze.name}var at=bt.findIndex(function(nt){var ut=nt.isWeightedAverageGreater;return!ut});return at<0?"":(de=bt[at-1])===null||de===void 0?void 0:de.name},[y.data,H.data]),ee=Object(u.useCallback)(function(){var I=Object(O.a)(Object(v.a)().mark(function me(de){var Ge,Ue,tt,dt,jt;return Object(v.a)().wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:if(tt=de.grade_scale_id,dt=de.grade_term_id,((Ge=D.data)===null||Ge===void 0?void 0:Ge.id)!==void 0){ze.next=3;break}return ze.abrupt("return");case 3:if(jt=(Ue=D.data)===null||Ue===void 0?void 0:Ue.grades.find(function(at){var nt=at.grade_term;return nt.id===dt}),!jt){ze.next=7;break}return aa(jt.id,{grade_scale_id:tt}).then(function(at){Et.b[at.success?"success":"error"](at.message),a.f.push("/teacher/subjects/".concat(m,"/final-grades"))}),ze.abrupt("return");case 7:ta({grade_scale_id:tt,grade_term_id:dt,lesson_group_user_id:D.data.id}).then(function(at){Et.b[at.success?"success":"error"](at.message),a.f.push("/teacher/subjects/".concat(m,"/final-grades"))});case 8:case"end":return ze.stop()}},me)}));return function(me){return I.apply(this,arguments)}}(),[D.data,m]),Ke=Object(u.useMemo)(function(){var I;return((I=G.data)!==null&&I!==void 0?I:[]).map(function(me){var de;return Object(c.a)(Object(c.a)({},me),{},{grade:(de=D.data)===null||de===void 0?void 0:de.grades.find(function(Ge){var Ue=Ge.grade_term;return Ue.id===me.id})})})},[D.data,G.data]);return D.loading?Object(e.jsx)(P.a,{}):Object(e.jsxs)(e.Fragment,{children:[D.data&&Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(Q.a.Text,{style:{fontSize:"16px",fontWeight:500},children:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Student",values:D.data.user})}),Object(e.jsx)(yt.a,{})]}),Object(e.jsxs)(Ze.a,{gutter:[48,48],justify:"space-between",children:[Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)(te.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.StudentPartialGrades"}),search:!1,pagination:{pageSize:St},dataSource:y.data,loading:y.loading,columns:Sa,options:!1,cardProps:{bodyStyle:{padding:0}}})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)(te.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.FinalGrades"}),search:!1,pagination:{pageSize:St},dataSource:Ke,loading:D.loading||G.loading,columns:Ta,options:!1,cardProps:{bodyStyle:{padding:0}}})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)(te.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Attendances"}),search:!1,options:!1,pagination:{pageSize:St},cardProps:{bodyStyle:{padding:0}},dataSource:x.data,loading:x.loading,columns:[].concat(Ea,[{title:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.Attendance"}),dataIndex:"attendance",render:function(me,de){return Object(e.jsx)(Bt.a,{onChange:function(Ue){return J(de.id,Ue.target.checked?z.a.PRESENT:z.a.ABSENT)},checked:de.attendance.value===z.a.PRESENT})}}])})}),Object(e.jsx)(Je.a,{span:12,children:Object(e.jsx)(te.a,{rowKey:"id",headerTitle:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.GradesScale"}),search:!1,options:!1,pagination:{pageSize:St},cardProps:{bodyStyle:{padding:0}},dataSource:H.data,loading:H.loading,columns:_a})}),w.loading&&!w.data||le.loading&&!le.data||N.loading&&!N.data&&Object(e.jsx)(P.a,{}),w.data&&le.data&&N.data&&w.data.map(function(I){var me,de,Ge,Ue,tt,dt,jt,bt,ze=I.id,at=I.title;return Object(e.jsxs)(Je.a,{span:24,children:[Object(e.jsx)(Q.a.Text,{style:{fontSize:"16px",fontWeight:500},children:at}),Object(e.jsx)(Wt.c,{topics:(me=(de=N.data)===null||de===void 0?void 0:de[Number(ze)])!==null&&me!==void 0?me:[],stats:(Ge=(Ue=le.data)===null||Ue===void 0||(tt=Ue[Number(ze)])===null||tt===void 0?void 0:tt.finishedTopics)!==null&&Ge!==void 0?Ge:[]}),Object(e.jsx)(Wt.a,{stats:(dt=(jt=le.data)===null||jt===void 0||(bt=jt[Number(ze)])===null||bt===void 0?void 0:bt.attendanceList)!==null&&dt!==void 0?dt:[]})]},ze)})]}),Object(e.jsx)(ce.a,{form:ie,onFinish:ee,children:Object(e.jsxs)(ce.a.Group,{style:{display:"flex",flexDirection:"column",paddingTop:"48px"},title:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.IssueAssessment"}),titleStyle:{flex:"unset"},align:"center",children:[Object(e.jsx)($t.a,{name:"grade_term_id",rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],label:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.GradeTerm"}),options:ne,width:"sm",fieldProps:{loading:G.loading}}),Object(e.jsx)($t.a,{name:"grade_scale_id",rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"field_required"})}],label:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.FinalGrade"}),options:Oe,fieldProps:{loading:D.loading||Y.loading}}),Object(e.jsx)(ce.a.Item,{children:Object(e.jsx)(a.a,{id:"TeacherSubjects.FinalGrades.ProposedGrade",values:{grade:X}})})]})})]})},Ca=["grades"],Ma=[{title:Object(e.jsx)(a.a,{id:"group"}),dataIndex:"group_id",render:function(i,r){return Object(e.jsx)(oa.a,{type:"Students",type_id:r.group_id},r.group_id)}},{title:Object(e.jsx)(a.a,{id:"first_name"}),dataIndex:"user",render:function(i,r){return r.user.first_name}},{title:Object(e.jsx)(a.a,{id:"last_name"}),dataIndex:"user",render:function(i,r){return r.user.last_name}},{title:Object(e.jsx)(a.a,{id:"grade"}),dataIndex:"grades",render:function(i,r){return Object(e.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:r.grades.length?r.grades.map(function(s){var n=s.grade_name,d=s.grade_term,j=s.id;return Object(e.jsxs)(Q.a.Text,{children:[d.name,": ",n]},j)}):"-"})}}],Pa=function(){var i,r,s,n=Object(l.k)(),d=Object(u.useMemo)(function(){var J,U,w,le;return{user_id:Number.isNaN(Number((J=n.query)===null||J===void 0?void 0:J.user_id))?null:Number((U=n.query)===null||U===void 0?void 0:U.user_id),group_id:Number.isNaN(Number((w=n.query)===null||w===void 0?void 0:w.group_id))?null:Number((le=n.query)===null||le===void 0?void 0:le.group_id)}},[(i=n.query)===null||i===void 0?void 0:i.user_id,(r=n.query)===null||r===void 0?void 0:r.group_id]),j=d.user_id,m=d.group_id,T=Object(q.b)(),y=T.teacherSubjectData,C=T.semester_subject_id,D=Object(u.useState)({loading:!1}),A=Object(W.a)(D,2),G=A[0],M=A[1],Y=Object(u.useState)([Number(y==null||(s=y.groups)===null||s===void 0?void 0:s[0].id)]),_=Object(W.a)(Y,2),H=_[0],ge=_[1],x=Object(u.useMemo)(function(){var J;return((J=y==null?void 0:y.groups)!==null&&J!==void 0?J:[]).map(function(U){var w=U.id,le=U.name;return{label:le,value:w}})},[y==null?void 0:y.groups]);return Object(u.useEffect)(function(){if(typeof j!="number"){if(!H.length){M({loading:!1});return}M(function(J){return Object(c.a)(Object(c.a)({},J),{},{loading:!0})}),Xt(H).then(function(J){if(J.success){var U=J.data.map(function(w){var le=w.grades,N=Object(Ut.a)(w,Ca);return Object(c.a)(Object(c.a)({},N),{},{grades:le.sort(function(Ce,De){return new Date(De.grade_date).getTime()-new Date(Ce.grade_date).getTime()})})});M(function(w){return Object(c.a)(Object(c.a)({},w),{},{dataSource:U})})}}).finally(function(){M(function(J){return Object(c.a)(Object(c.a)({},J),{},{loading:!1})})})}},[H,j]),j!==null&&m!==null?Object(e.jsx)(ya,{user_id:j,group_id:m}):Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(ce.a.Item,{label:Object(e.jsx)(a.a,{id:"group"}),children:Object(e.jsx)(We.a,{allowClear:!0,mode:"multiple",options:x,value:H,onChange:function(U){return ge(U)}})}),Object(e.jsx)(yt.a,{}),Object(e.jsx)(te.a,{rowKey:"id",search:!1,loading:G.loading,dataSource:G.dataSource,columns:[].concat(Ma,[{title:Object(e.jsx)(a.a,{id:"options"}),render:function(U,w){return[Object(e.jsx)(Ae.a,{to:"/teacher/subjects/".concat(C,"/final-grades?user_id=").concat(w.user.id,"&group_id=").concat(w.group_id),children:Object(e.jsx)($e.a,{title:Object(e.jsx)(a.a,{id:"edit"}),children:Object(e.jsx)($.a,{type:"primary",icon:Object(e.jsx)(qe.a,{})})})},"edit")]}}])})]})},Da=function(i){var r,s,n=i.tab,d=Object(a.l)(),j=Object(a.m)("@@initialState"),m=j.setInitialState,T=j.initialState,y=Object(q.b)(),C=y.teacherSubjectData,D=y.semester_subject_id,A=y.tutors,G=Object(u.useCallback)(Object(_e.a)(T==null?void 0:T.currentUser),[T==null?void 0:T.currentUser]),M=Object(u.useMemo)(function(){return!!A.data.find(function(Y){var _,H=Y.id;return H===(T==null||(_=T.currentUser)===null||_===void 0?void 0:_.id)})||G(he.a.TeacherListGradeScale)},[]);return C?Object(e.jsx)(re.a,{title:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(a.a,{id:C==null||(r=C.subject)===null||r===void 0?void 0:r.name}),", ",Object(e.jsx)(a.a,{id:n})]}),tabBarExtraContent:Object(e.jsxs)("div",{style:{display:"flex",padding:"12px",gap:"12px"},children:[Object(e.jsx)($.a,{type:"primary",onClick:function(){return console.log("MSTeams")},children:Object(e.jsx)(a.a,{id:"msTeams",defaultMessage:"msTeams"})}),Object(e.jsx)(Ae.a,{to:"/teacher/subjects/".concat(D,"/exams?exam_id=new"),children:Object(e.jsx)($.a,{type:"primary",children:Object(e.jsx)(a.a,{id:"uploadGrades",defaultMessage:"uploadGrades"})})})]}),header:{breadcrumb:{routes:[{path:"teacher",breadcrumbName:d.formatMessage({id:"Teacher"})},{path:"subjects",breadcrumbName:d.formatMessage({id:"Subjects"})},{path:String(D),breadcrumbName:String((s=C.subject)===null||s===void 0?void 0:s.name)},{path:String(n),breadcrumbName:d.formatMessage({id:n,defaultMessage:String(n)})}]}},children:Object(e.jsxs)(je.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",activeKey:n,onChange:function(_){m(Object(c.a)({},T)),a.f.push("/teacher/subjects/".concat(D,"/").concat(_))}},children:[Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"groups"}),children:Object(e.jsx)(Ee.b,{})},"groups"),Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"students"}),children:Object(e.jsx)(ht,{})},"students"),Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"exams"}),children:Object(e.jsx)(ye,{})},"exams"),Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"schedule"}),children:Object(e.jsx)(da,{})},"schedule"),Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"attendance"}),children:Object(e.jsx)(zt,{})},"attendance"),M&&Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"grades-scale"}),children:Object(e.jsx)(ra,{})},"grades-scale"),Object(e.jsx)(je.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"final-grades"}),children:Object(e.jsx)(Pa,{})},"final-grades")]})}):Object(e.jsx)(P.a,{})},Ka=oe.default=function(){var o=Object(l.l)(),i=o.subjectId,r=o.tab,s=r===void 0?"groups":r;return Object(e.jsx)(q.a,{semester_subject_id:Number(i),children:Object(e.jsx)(Da,{tab:s})})}},p3I6:function(Fe,oe,t){"use strict";t.d(oe,"b",function(){return q}),t.d(oe,"c",function(){return pe}),t.d(oe,"a",function(){return He});var c=t("miYZ"),B=t("tsqr"),$=t("tJVT"),f=t("k1fw"),P=t("oBTY"),u=t("q1tI"),je=t.n(u),a=t("9kvl"),Ae=t("Ty5D"),l=t("H6aw"),re=t("/y+f"),he=t("nKUr"),_e=t.n(he),q=je.a.createContext({}),Ee=function(){return Math.round(Math.random()*99999)},ke=function xe(te){return te.reduce(function(k,h){return[].concat(Object(P.a)(k),Object(P.a)(h.lessons?xe(h.lessons):[]),[h])},[])},pe=function xe(te){return te.reduce(function(k,h){var V;return[].concat(Object(P.a)(k),Object(P.a)(h.lessons?xe(h.lessons):[]),Object(P.a)((V=h.topics)!==null&&V!==void 0?V:[]))},[])},Ne=function xe(te,k,h){return te.map(function(V){var Be,F;return Object(f.a)(Object(f.a)({},V),{},{lessons:V.lessons?xe(V.lessons,k,h):[],topics:V.id===k?[].concat(Object(P.a)((Be=V.topics)!==null&&Be!==void 0?Be:[]),[h]):(F=V.topics)!==null&&F!==void 0?F:[]})})},$e=function xe(te,k,h){return h?te.map(function(V){return Object(f.a)(Object(f.a)({},V),{},{lessons:[].concat(Object(P.a)(V.lessons?xe(V.lessons,k,h):[]),Object(P.a)(V.id===h?[k]:[]))})}):[].concat(Object(P.a)(te),[k])},v=function xe(te,k,h){return te.map(function(V){return Object(f.a)(Object(f.a)({},V.id===k?h:V),{},{lessons:V.lessons?xe(V.lessons,k,h):[]})})},O=function xe(te,k){return te.map(function(h){return Object(f.a)(Object(f.a)({},h),{},{parent_id:k,lessons:h.lessons?xe(h.lessons,h.id):[]})})},Ve=function xe(te,k){return te.filter(function(h){return h.id!==k}).map(function(h){return Object(f.a)(Object(f.a)({},h),{},{lessons:h.lessons?xe(h.lessons,k):[]})})},qe=function xe(te,k){return te.map(function(h){return Object(f.a)(Object(f.a)({},h),{},{lessons:h.lessons?xe(h.lessons,k):[],topics:h.topics?h.topics.filter(function(V){return V.id!==k}):[]})})},He=function(te){var k=te.children,h=te.id,V=Object(u.useState)(),Be=Object($.a)(V,2),F=Be[0],se=Be[1],b=Object(a.l)(),Se=Object(u.useMemo)(function(){return F&&F.lessons?pe(F.lessons):[]},[F]),ve=Object(u.useMemo)(function(){return F&&F.lessons?ke(F.lessons):[]},[F]),Qe=Object(u.useState)([]),Te=Object($.a)(Qe,2),Le=Te[0],Ie=Te[1],Z=Object(Ae.k)();Object(u.useEffect)(function(){Ie([])},[]);var K=Object(u.useCallback)(function(){Object(l.m)(h).then(function(E){return E.success&&se(Object(f.a)(Object(f.a)({},E.data),{},{lessons:O(E.data.lessons)}))})},[h]);Object(u.useEffect)(function(){K()},[K]);var Re=Object(u.useCallback)(function(E){var e=ve.find(function(S){var g;return S==null||(g=S.topics)===null||g===void 0?void 0:g.find(function(p){return p.id===E})});return e?e.id:null},[ve]),Xe=Object(u.useMemo)(function(){var E,e;return(E=Z.query)!==null&&E!==void 0&&E.lesson?{mode:"lesson",id:Number(Z.query.lesson),value:ve.find(function(S){return S.id===Number(Z.query.lesson)})}:(e=Z.query)!==null&&e!==void 0&&e.topic?{mode:"topic",id:Number(Z.query.topic),value:Se.find(function(S){return S.id===Number(Z.query.topic)})}:{mode:"init"}},[Z.query,F,ve,Se]),W=Object(u.useCallback)(function(E){var e={course_id:h,topics:[],isNew:!0,id:F?F.lessons.length+1:Ee(),order:0,title:b.formatMessage({id:"add_title_here"}),active:!0,parent_id:E};return se(function(S){var g;return Object(f.a)(Object(f.a)({},S),{},{lessons:$e((g=S==null?void 0:S.lessons)!==null&&g!==void 0?g:[],e,E)})}),e},[h,F]),ot=Object(u.useCallback)(function(E,e){var S=ve.find(function(p){return p.id===E}),g=S&&S.isNew;return(g?Object(l.g)(e):Object(l.u)(E,e)).then(function(p){return B.b.success(p.message),K(),p.success&&se(function(R){var L;return Object(f.a)(Object(f.a)({},R),{},{lessons:v((L=R==null?void 0:R.lessons)!==null&&L!==void 0?L:[],E,Object(f.a)(Object(f.a)({},p.data),{},{isNew:!1}))})})})},[F]),Ze=Object(u.useCallback)(function(E){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,S=(F==null?void 0:F.lessons.findIndex(function(L){return L.id===E}))||0,g=e?S-1:S+1,p=F==null?void 0:F.lessons.map(function(L,be,rt){var we=be==S?rt[g]:be==g?rt[S]:L;return Object(f.a)(Object(f.a)({},we),{},{order:be})});se(function(L){return Object(f.a)(Object(f.a)({},L),{},{lessons:p||[]})});var R=p==null?void 0:p.filter(function(L){return!L.isNew}).map(function(L){return[L.id,L.order]});Object(l.s)({class:"Lesson",orders:R,course_id:h}).then(function(L){L.success&&B.b.success(L.message)})},[F,h]),lt=Object(u.useCallback)(function(E,e){var S,g,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,R=ve.find(function(we){return we.id===E}),L=R==null||(S=R.topics)===null||S===void 0?void 0:S.findIndex(function(we){return we.id===e});if(!(L===void 0||L===-1)){var be=p?L-1:L+1,rt=(R==null||(g=R.topics)===null||g===void 0?void 0:g.map(function(we,st,ye){var ae=st==L?ye[be]:st==be?ye[L]:we;return Object(f.a)(Object(f.a)({},ae),{},{order:st})}))||[];se(function(we){return Object(f.a)(Object(f.a)({},we),{},{lessons:we?we.lessons.map(function(st){return st.id===E?Object(f.a)(Object(f.a)({},st),{},{topics:rt}):st}):[]})})}},[F]),Je=Object(u.useCallback)(function(E){var e,S=ve.find(function(p){return p.id===E}),g=S==null||(e=S.topics)===null||e===void 0?void 0:e.filter(function(p){return!p.isNew}).map(function(p){return[p.id,p.order]});Object(l.s)({class:"Topic",orders:g,course_id:h}).then(function(p){p.success&&B.b.success(p.message)})},[F,h]),ce=Object(u.useCallback)(function(E,e){se(function(g){return Object(f.a)(Object(f.a)({},g),{},{lessons:g?g.lessons.map(function(p){return p.id===E?Object(f.a)(Object(f.a)({},p),{},{topics:e}):p}):[]})});var S=e.map(function(g){return[g.id,g.order]});Object(l.s)({class:"Topic",orders:S,course_id:h}).then(function(g){g.success&&B.b.success(g.message)})},[F]),Ot=Object(u.useCallback)(function(E){var e=ve.find(function(g){return g.id===E});if(!!e){var S=e.isNew;S?se(function(g){var p;return Object(f.a)(Object(f.a)({},g),{},{lessons:Ve((p=g==null?void 0:g.lessons)!==null&&p!==void 0?p:[],E)})}):Object(l.o)(E).then(function(g){g.success&&(B.b.success(g.message),se(function(p){var R;return Object(f.a)(Object(f.a)({},p),{},{lessons:Ve((R=p==null?void 0:p.lessons)!==null&&R!==void 0?R:[],E)})}))})}},[F]),ft=Object(u.useCallback)(function(E,e){var S,g=Re(E),p=ve.find(function(be){return be.id===g}),R=p&&((S=p.topics)===null||S===void 0?void 0:S.find(function(be){return be.id===E})),L=R==null?void 0:R.isNew;return(L?Object(l.h)(e):Object(l.v)(E,e)).then(function(be){be.success&&(B.b.success(be.message),K(),a.f.push("/courses/list/".concat(h,"/program/?topic=").concat(be.data.id)),(R==null?void 0:R.topicable_type)===re.f.Video&&setTimeout(function(){K()},5e3))})},[Re,F,K]),z=Object(u.useCallback)(function(E){var e=Re(E),S=ve.find(function(R){return R.id===e});if(!!S){var g=Se==null?void 0:Se.find(function(R){return R.id===E}),p=g==null?void 0:g.isNew;p&&!g.topicable?se(function(R){var L;return Object(f.a)(Object(f.a)({},R),{},{lessons:qe((L=R==null?void 0:R.lessons)!==null&&L!==void 0?L:[],E)})}):Object(l.p)(E).then(function(R){R.success&&(B.b.success(R.message),se(function(L){var be;return Object(f.a)(Object(f.a)({},L),{},{lessons:qe((be=L==null?void 0:L.lessons)!==null&&be!==void 0?be:[],E)})}))})}},[F,Re]),_t=Object(u.useCallback)(function(E,e){var S={lesson_id:E,isNew:!0,id:Ee(),title:b.formatMessage({id:"add_title_here"}),active:!0,topicable_type:e};return se(function(g){var p;return Object(f.a)(Object(f.a)({},g),{},{lessons:Ne((p=g==null?void 0:g.lessons)!==null&&p!==void 0?p:[],E,S)})}),S},[]),et=function(e,S){var g=Re(e);se(function(p){var R;return Object(f.a)(Object(f.a)({},p),{},{lessons:p?(R=p.lessons)===null||R===void 0?void 0:R.map(function(L){if(L.id===g){var be;return Object(f.a)(Object(f.a)({},L),{},{topics:(be=L.topics)===null||be===void 0?void 0:be.map(function(rt){return rt.id===e?S.file.response.data:rt})})}return L}):[]})}),a.f.push("/courses/list/".concat(h,"/program/?topic=").concat(S.file.response.data.id))},mt=Object(u.useCallback)(function(E){return Object(l.d)(E).then(function(e){if(e.success){B.b.success(e.message);var S=Re(E);se(function(g){var p;return Object(f.a)(Object(f.a)({},g),{},{lessons:g?(p=g.lessons)===null||p===void 0?void 0:p.map(function(R){if(R.id===S){var L=R.topics||[];return Object(f.a)(Object(f.a)({},R),{},{topics:[].concat(Object(P.a)(L),[e.data])})}return R}):[]})})}})},[F,Re]),We=Object(u.useCallback)(function(E){return Object(l.c)(E).then(function(e){e.success&&(B.b.success(e.message),se(function(S){return Object(f.a)(Object(f.a)({},S),{},{lessons:S?[].concat(Object(P.a)(S.lessons),[e.data]):[]})}))})},[]),Ye={state:F,h5ps:Le,id:h,addNewLesson:W,updateLesson:ot,updateTopic:ft,deleteLesson:Ot,sortLesson:Ze,addNewTopic:_t,deleteTopic:z,sortTopic:lt,sortTopics:ce,updateTopicsOrder:Je,onTopicUploaded:et,cloneTopic:mt,cloneLesson:We,currentEditMode:Xe,getLessons:K};return Object(he.jsx)(q.Provider,{value:Ye,children:k})}},quyA:function(Fe,oe){var t="\\ud800-\\udfff",c="\\u0300-\\u036f",B="\\ufe20-\\ufe2f",$="\\u20d0-\\u20ff",f=c+B+$,P="\\ufe0e\\ufe0f",u="\\u200d",je=RegExp("["+u+t+f+P+"]");function a(Ae){return je.test(Ae)}Fe.exports=a},wy8a:function(Fe,oe,t){var c=t("KxBF");function B($,f,P){var u=$.length;return P=P===void 0?u:P,!f&&P>=u?$:c($,f,P)}Fe.exports=B}}]);
