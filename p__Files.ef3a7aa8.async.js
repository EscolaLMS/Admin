(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"3fxf":function(z,u,e){"use strict";var M=e("DjyN"),v=e("NUBc"),K=e("Mwp2"),c=e("VXEj"),j=e("+L6B"),O=e("2/Rp"),m=e("5NDa"),y=e("5rEg"),h=e("oBTY"),n=e("k1fw"),b=e("tJVT"),x=e("DYRE"),W=e("zeV3"),p=e("tU7J"),l=e("wFql"),r=e("q1tI"),i=e.n(r),E=e("BAh9"),_=e("/MfK"),F=e("mAF4"),g=e("dF/Y"),C=e("9kvl"),N=e("DBJ/"),U=e("lLVY"),ne=e.n(U),a=e("nKUr"),ae=e.n(a),J=function(B){var T=B.directory,R=B.onUploaded;return Object(a.jsxs)(W.b,{align:"start",children:[Object(a.jsxs)(l.a.Text,{children:[Object(a.jsx)(C.a,{id:"pages.files.filesBrowser"}),Object(a.jsx)(l.a.Text,{code:!0,children:T})]}),Object(a.jsx)(N.a,{url:"/api/admin/file/upload",name:"file[]",data:{target:T},onUpload:function(S){S.success&&R(T,S.data)}})]})},Q=function(B){var T=B.defaultDirectory,R=T===void 0?"/":T,I=B.onFile,S=B.hideDeleteBtn,H=S===void 0?!1:S,Y=B.forceLoading,Z=Y===void 0?!1:Y,k=Object(C.i)(),q=Object(r.useState)({loading:!1,name:"",directory:R,current_page:1,data:void 0,per_page:1,last_page:1,total:0}),G=Object(b.a)(q,2),d=G[0],$=G[1],A=Object(r.useRef)(),D=Object(r.useCallback)(function(o){$(function(t){return Object(n.a)(Object(n.a)({},t),{},{loading:o})})},[]),w=Object(r.useCallback)(function(o,t){$(function(s){return Object(n.a)(Object(n.a)(Object(n.a)({},s),o.data),{},{data:[{url:t.split("/").slice(0,-1).join("/"),name:"..",created_at:"",mime:"directory"}].concat(Object(h.a)(o.data.data.map(function(f){return Object(n.a)(Object(n.a)({},f),{},{url:f.mime==="directory"?"".concat(t,"/").concat(f.name):f.url})}))).filter(function(f){return t==="/"||t===R?f.name!=="..":!0}),directory:t,loading:!1})})},[D]),P=Object(r.useCallback)(function(o){var t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,f=function(){return A.current&&A.current.abort()};return f(),A.current=new AbortController,D(!0),Object(E.a)({directory:o,page:s},{signal:(t=A.current)===null||t===void 0?void 0:t.signal}).then(function(L){L.success&&w(L,o)}).catch(function(){return D(!1)}),function(){f()}},[D]);Object(r.useEffect)(function(){return P(R)},[R,P]);var ee=Object(r.useCallback)(function(o){D(!0),Object(E.c)(o).then(function(){P(d.directory)}).catch(function(){D(!1)})},[P,D,d.directory]),te=Object(r.useCallback)(function(o,t){var s,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,L=function(){return A.current&&A.current.abort()};return L(),A.current=new AbortController,D(!0),Object(E.b)({directory:o,name:t,page:f},{signal:(s=A.current)===null||s===void 0?void 0:s.signal}).then(function(V){V.success&&w(V,o)}).catch(function(){return D(!1)}),function(){L()}},[D]);return Object(a.jsxs)("div",{className:"file-browser",children:[Object(a.jsxs)("div",{className:"file-browser__header",children:[Object(a.jsx)(y.a,{placeholder:k.formatMessage({id:"search_file"}),className:"file-browser__input",onChange:function(t){return $(function(s){return Object(n.a)(Object(n.a)({},s),{},{name:t.target.value})})},value:d.name}),Object(a.jsxs)("div",{children:[Object(a.jsx)(O.a,{className:"file-browser__button",onClick:function(){return P(d.directory)},children:Object(a.jsx)(C.a,{id:"reset"})}),Object(a.jsx)(O.a,{className:"file-browser__button",type:"primary",onClick:function(){return te(d.directory,d.name)},children:Object(a.jsx)(C.a,{id:"query"})})]})]}),Object(a.jsx)(c.b,{loading:d.loading||Z,size:"small",itemLayout:"horizontal",dataSource:d.data,header:Object(a.jsx)(J,{directory:d.directory,onUploaded:function(t,s){s&&(P(t),I&&I(s,t))}}),footer:Object(a.jsx)(J,{directory:d.directory,onUploaded:function(t,s){P(t),s&&I&&I(s,t)}}),renderItem:function(t){return Object(a.jsx)(c.b.Item,{actions:t.mime!=="directory"&&!H?[Object(a.jsx)(O.a,{type:"default",danger:!0,icon:Object(a.jsx)(_.a,{}),size:"small",onClick:function(){return ee(t.url)}},"dir")]:[],children:Object(a.jsx)(c.b.Item.Meta,{avatar:t.mime==="directory"?Object(a.jsx)(O.a,{type:"primary",icon:Object(a.jsx)(F.a,{}),size:"small",onClick:function(){return P(t.url)}}):Object(a.jsx)("a",{href:t.url,target:"_blank",rel:"noreferrer",children:Object(a.jsx)(O.a,{type:"default",icon:Object(a.jsx)(g.a,{}),size:"small"})}),description:Object(a.jsx)(i.a.Fragment,{children:Object(a.jsx)(O.a,{type:"text",size:"small",onClick:function(){return t.mime==="directory"?P(t.url):I&&I(t,d.directory)},children:t.name})})})})}}),Object(a.jsx)(v.a,{pageSizeOptions:[],current:d.current_page,total:d.total,pageSize:d.per_page,onChange:function(t){return P(d.directory,t)}})]})};u.a=Q},BAh9:function(z,u,e){"use strict";e.d(u,"a",function(){return O}),e.d(u,"b",function(){return y}),e.d(u,"e",function(){return n}),e.d(u,"d",function(){return x}),e.d(u,"c",function(){return W});var M=e("k1fw"),v=e("9og8"),K=e("WmNS"),c=e.n(K),j=e("9kvl");function O(l,r){return m.apply(this,arguments)}function m(){return m=Object(v.a)(c.a.mark(function l(r,i){return c.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",Object(j.f)("/api/admin/file/list",Object(M.a)({method:"GET",params:r},i||{})));case 1:case"end":return _.stop()}},l)})),m.apply(this,arguments)}function y(l,r){return h.apply(this,arguments)}function h(){return h=Object(v.a)(c.a.mark(function l(r,i){return c.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",Object(j.f)("/api/admin/file/find",Object(M.a)({method:"GET",params:r},i||{})));case 1:case"end":return _.stop()}},l)})),h.apply(this,arguments)}function n(l,r,i){return b.apply(this,arguments)}function b(){return b=Object(v.a)(c.a.mark(function l(r,i,E){var _;return c.a.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return _=new FormData,_.append("file[]",r),_.append("target",i),g.abrupt("return",Object(j.f)("/api/admin/file/upload",Object(M.a)({method:"POST",data:_},E||{})));case 4:case"end":return g.stop()}},l)})),b.apply(this,arguments)}var x=function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;return"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com","/api/images/img?path=").concat(r,"&w=").concat(i)};function W(l,r){return p.apply(this,arguments)}function p(){return p=Object(v.a)(c.a.mark(function l(r,i){return c.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",Object(j.f)("/api/admin/file/delete",Object(M.a)({method:"DELETE",data:{url:r}},i||{})));case 1:case"end":return _.stop()}},l)})),p.apply(this,arguments)}},"DBJ/":function(z,u,e){"use strict";var M=e("k1fw"),v=e("y8nQ"),K=e("Vl3Y"),c=e("etVw"),j=e("9kvl"),O=e("qFDU"),m=e("nKUr"),y=e.n(m);function h(n){var b=n.onChange,x=n.onUpload,W=n.url,p=n.name,l=n.extra,r=n.accept,i=n.data,E=n.wrapInForm,_=E===void 0?!0:E,F=n.title,g=n.formProps,C=Object(j.i)();return i&&i[p]&&delete i[p],Object(m.jsx)(O.a,{condition:_,wrap:function(U){return Object(m.jsx)(K.a,Object(M.a)(Object(M.a)({},g),{},{children:U}))},children:Object(m.jsx)(c.a,{title:F||" ".concat(C.formatMessage({id:"upload_click_here"})),placeholder:C.formatMessage({id:"upload_click_here"}),onChange:function(U){b&&b(U),U.file.status==="done"&&x&&x(U.file.response)},label:Object(m.jsx)(j.a,{id:"upload"}),max:2,fieldProps:{data:i,accept:r,name:p,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}},action:"".concat(window.REACT_APP_API_URL||"https://api-stage.escolalms.com").concat(W),extra:l})})}u.a=h},lLVY:function(z,u,e){},u4ym:function(z,u,e){"use strict";e.r(u);var M=e("IzEo"),v=e("bx4M"),K=e("tU7J"),c=e("wFql"),j=e("q1tI"),O=e.n(j),m=e("tMyG"),y=e("9kvl"),h=e("3fxf"),n=e("nKUr"),b=e.n(n);u.default=function(){return Object(n.jsx)(m.a,{children:Object(n.jsxs)(v.a,{children:[Object(n.jsx)(c.a.Text,{strong:!0,children:Object(n.jsx)(y.a,{id:"pages.files.content"})}),Object(n.jsx)(h.a,{})]})})}}}]);
