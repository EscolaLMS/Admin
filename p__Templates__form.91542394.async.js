(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{10:function(z,k){},"1f8b":function(z,k,i){},8:function(z,k){},9:function(z,k){},BOG6:function(z,k,i){"use strict";i.r(k);var G=i("DYRE"),U=i("zeV3"),Te=i("tU7J"),A=i("wFql"),Q=i("+BJd"),oe=i("mr32"),se=i("/zsF"),te=i("PArb"),ce=i("T2oS"),ve=i("W9HT"),le=i("miYZ"),he=i("tsqr"),J=i("9og8"),N=i("tJVT"),H=i("oBTY"),Y=i("jrin"),C=i("k1fw"),me=i("WmNS"),P=i.n(me),s=i("q1tI"),m=i.n(s),E=i("VMEa"),I=i("Qurx"),p=i("yj/a"),_=i("tneF"),$e=i("nhC9"),ae=i("rWUb"),Ge=i("tMyG"),Vt=i("fOrg"),ke=i("+KLJ"),Mt=i("+L6B"),R=i("2/Rp"),y=i("9kvl"),e=i("nKUr"),Ue=function(n){var t=n.disabled,a=t===void 0?!1:t,r=n.id,l=n.onPreviewData,u=Object(s.useState)({state:"ready"}),d=Object(N.a)(u,2),j=d[0],v=d[1],h=Object(s.useCallback)(function(){v({state:"loading"}),Object(ae.c)(r).then(function(o){o.success?(l&&l(o.data),o.data.sent&&o.data.to?v({state:"loaded",data:o.data,message:"email sent to ".concat(o.data.to)}):o.data.url?v({state:"loaded",data:o.data,message:Object(e.jsxs)(m.a.Fragment,{children:["Download"," ",Object(e.jsx)("a",{target:"_blank",href:o.data.url,children:o.data.filename})]})}):v({state:"loaded",data:o.data,message:o.message})):v({state:"error",error:o.message})}).catch(function(){v({state:"error",error:"error"})})},[r]);return Object(e.jsxs)(m.a.Fragment,{children:[Object(e.jsx)(R.a,{type:"primary",loading:j.state==="loading",disabled:a,onClick:h,children:Object(e.jsx)(y.a,{id:"preview"})}),j.state==="loaded"&&Object(e.jsx)(ke.a,{message:j.message,type:"success",closable:!0,onClose:function(){return v({state:"ready"})}}),j.state==="error"&&Object(e.jsx)(ke.a,{message:j.error,type:"error",closable:!0,onClose:function(){return v({state:"ready"})}})]})},He=Ue,Je=i("Ty5D"),fe=i("BiO0"),$t=i("JAl+"),Gt=i("14J3"),W=i("BMrR"),Ut=i("jCWc"),x=i("kPKH"),ue=i("QDO1"),S=i("LvDl"),Ae=i("i680"),Ht=i("ZEwP"),Ke=function(n){var t=n.svgDef,a=n.width,r=n.height;return Object(s.useEffect)(function(){var l=new Ae.e("l","px",[a,r]),u=new DOMParser,d=u.parseFromString(t,"image/svg+xml"),j=d.documentElement.querySelector("rect");j&&(j.setAttribute("width",a+"px"),j.setAttribute("height",r+"px")),l.svg(d.documentElement).then(function(){l.save("myPDF.pdf")})},[t]),Object(e.jsx)("div",{})},ze=function(n){var t=n.initialValue,a=n.width,r=a===void 0?842:a,l=n.height,u=l===void 0?592:l,d=n.onRendered,j=Object(ue.b)(),v=j.onReady,h=function(g){if(t)try{var f=JSON.parse(t);g.loadFromJSON(f,function(){var O=g.toSVG(),b=new Ae.e("l","px",[r,u]),ie=new DOMParser,B=ie.parseFromString(O,"image/svg+xml");b.svg(B.documentElement).then(function(){b.save("myPDF.pdf"),d()})})}catch(O){}v(g)};return Object(e.jsx)("div",{className:"fakeA4",style:{width:r,height:u},children:Object(e.jsx)(ue.a,{className:"fakeA4-canvas",onReady:h})})},Qe=Ke,Ye=i("fWQN"),Ze=i("mtLc"),ge=i("epSk"),Xe=/^rgb\((((((((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5]),\s?)){2}|((((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5])\s)){2})((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5]))|((((([1-9]?\d(\.\d+)?)|100|(\.\d+))%,\s?){2}|((([1-9]?\d(\.\d+)?)|100|(\.\d+))%\s){2})(([1-9]?\d(\.\d+)?)|100|(\.\d+))%))\)$/i,qe=/^rgba\((((((((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5]),\s?)){3})|(((([1-9]?\d(\.\d+)?)|100|(\.\d+))%,\s?){3}))|(((((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5])\s){3})|(((([1-9]?\d(\.\d+)?)|100|(\.\d+))%\s){3}))\/\s)((0?\.\d+)|[01]|(([1-9]?\d(\.\d+)?)|100|(\.\d+))%)\)$/i,Pe=function(n){return Object(S.isString)(n)&&Xe.test(n)},Ie=function(n){return Object(S.isString)(n)&&qe.test(n)};function _e(c){if(!Pe(c))return c;var n=function(r){var l=r.indexOf(",")>-1?",":" ";return r.substr(4).split(")")[0].split(l)},t=function(r){var l=r.indexOf("%")>-1?Math.round(+r.substr(0,r.length-1)/100*255).toString(16):(+r).toString(16);return l.length===1?"0"+l:l};return"#"+n(c).map(t).join("")}function et(c){if(!Ie(c))return c;var n=function(r){var l=r.indexOf(",")>-1?",":" ",u=r.substr(5).split(")")[0].split(l);return u.indexOf("/")>-1&&u.splice(3,1),u},t=function(r,l){var u=r.substr(0,r.length-1)/100,d=r.indexOf("%")>-1||l===3?Math.round(u*255).toString(16):(+r).toString(16);return d.length===1?"0"+d:d};return"#"+n(c).map(t).join("")}function Be(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Object(S.isString)(c)?Pe(c)?_e(c):Ie(c)?et(c):c:c}var Oe=function(n){return!!n.getSelectionStyles&&!!n.isEditing},de=function(n){if(Object(S.isString)(n)){if(n==="false")return!1;if(n==="true")return!0;if(!Object(S.isNaN)(n))return!!+n}return!!n},pe=function(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#ffffff00",a=Be(n);return Object(S.isString)(a)?a===""?t:a:t},tt=function(n){return n==="text"||n==="i-text"||n==="textbox"},at=["fontFamily","fontSize","lineHeight","textAlign","bold","italic","underline","linethrough","overline","fill","textBackgroundColor","backgroundColor","opacity","stroke","strokeWidth","text"],we=["fontFamily","fontSize","bold","fontWeight","italic","fontStyle","underline","linethrough","overline","fill","textBackgroundColor","stroke","strokeWidth"],nt=["Arial","Times New Roman","Helvetica","Myriad Pro","Delicious","Verdana","Georgia","Courier","Comic Sans MS","Impact","Monaco","Optima","Hoefler Text","Plaster","Engagement"],rt=["Left","Center","Right","Justify"],it=Object(H.a)(Array(120)).map(function(c,n){return n+1}),ot=Object(H.a)(Array(6)).map(function(c,n){return n}),st=Object(H.a)(Array(15)).map(function(c,n){return n}),ct=Object(H.a)(Array(15)).map(function(c,n){return n}),lt=Object(H.a)(Array(6)).map(function(c,n){return n}),ut=function(){function c(n){Object(Ye.a)(this,c),this.editor=void 0,this.editor=n}return Object(Ze.a)(c,[{key:"canvas",get:function(){return this.editor.canvas}},{key:"activeObject",get:function(){return this.editor.canvas.getActiveObject()}},{key:"addIText",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"sample itext",a=new ge.fabric.IText(t);this.canvas.add(a)}},{key:"addTextbox",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"sample itextbox",a=new ge.fabric.Textbox(t);this.canvas.add(a)}},{key:"addVariable",value:function(t){if(this.activeObject&&tt(this.activeObject.type)&&Oe(this.activeObject)){var a=this.getForActive("text"),r=this.activeObject.selectionEnd||a.length-1;this.setForActive("text","".concat(a.substring(0,r)," ").concat(t," ").concat(a.substring(r)));return}this.addTextbox(t)}},{key:"addCircle",value:function(){this.editor.addCircle()}},{key:"addRectangle",value:function(){this.editor.addRectangle()}},{key:"addLine",value:function(){this.editor.addLine()}},{key:"addFile",value:function(t){var a=this;ge.fabric.Image.fromURL(t,function(r){r.set({left:0,top:0});var l=(a.canvas.width||1)/(r.width||1),u=(a.canvas.height||1)/(r.height||1),d=Math.min(l,u);d<1&&r.scale(d),a.canvas.add(r)})}},{key:"getEditorBackgroundColor",value:function(){return pe(this.canvas.backgroundColor)}},{key:"setEditorBackgroundColor",value:function(t){var a=this;return this.canvas.setBackgroundColor(pe(t,""),function(){a.canvas.requestRenderAll()})}},{key:"deleteAll",value:function(){var t=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.canvas.getObjects().forEach(function(r){return t.canvas.remove(r)}),this.canvas.discardActiveObject(),a&&this.setEditorBackgroundColor("#ffffff00"),this.canvas.requestRenderAll()}},{key:"deleteSelected",value:function(){var t=this;this.canvas.getActiveObjects().forEach(function(a){return t.canvas.remove(a)}),this.canvas.discardActiveObject(),this.canvas.requestRenderAll()}},{key:"getForActive",value:function(t){switch(t){case"opacity":return this.getOpacity();case"textAlign":return this.getTextAlign();case"fontFamily":return this.getFontFamily();case"fill":case"stroke":case"backgroundColor":case"textBackgroundColor":return this.getColorProp(t);case"bold":return this.getBold();case"italic":return this.getItalic();case"underline":case"linethrough":case"overline":return this.getBoolean(t);case"strokeWidth":case"fontSize":case"lineHeight":return this.getProp(t);default:return this.getProp(t)}}},{key:"setForActive",value:function(t,a){switch(t){case"opacity":return this.setOpacity(a);case"textAlign":case"fontFamily":return this.setLowerCaseProp(t,a);case"strokeWidth":case"fontSize":return this.setIntProp(t,a);case"lineHeight":return this.setFloatProp(t,a);case"fill":case"stroke":case"backgroundColor":case"textBackgroundColor":return this.setColorProp(t,a);case"bold":return this.setBold(a);case"italic":return this.setItalic(a);case"underline":case"linethrough":case"overline":return this.setBoolean(t,a);default:return this.setProp(t,a)}}},{key:"getProp",value:function(t){var a,r,l,u,d,j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.activeObject;return j?!we.includes(t)||!Oe(j)||!j.getSelectionStyles().length?(a=j[t])!==null&&a!==void 0?a:"":(r=(l=(u=j.getSelectionStyles())===null||u===void 0||(d=u[0])===null||d===void 0?void 0:d[t])!==null&&l!==void 0?l:j[t])!==null&&r!==void 0?r:"":""}},{key:"setProp",value:function(t,a){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.activeObject;!r||(!we.includes(t)||!Oe(r)||!r.getSelectionStyles().length?r.set(t,a):r.setSelectionStyles(Object(Y.a)({},t,a)),this.canvas.requestRenderAll())}},{key:"setIntProp",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(Object(S.isString)(a)&&!Object(S.isNaN)(a)||Object(S.isNumber)(a))return this.setProp(t,parseInt(a+"",10));console.error("".concat(a," is not ").concat(t," value"))}},{key:"setFloatProp",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(Object(S.isString)(a)&&!Object(S.isNaN)(a)||Object(S.isNumber)(a))return this.setProp(t,parseFloat(a+""));console.error("".concat(a," is not ").concat(t," value"))}},{key:"getBoolean",value:function(t){return de(this.getProp(t))}},{key:"setBoolean",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.setProp(t,de(a))}},{key:"setLowerCaseProp",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(Object(S.isString)(a))return this.setProp(t,a.toLowerCase());console.error("".concat(a," is not ").concat(t," value"))}},{key:"getColorProp",value:function(t,a){return pe(this.getProp(t),a)}},{key:"setColorProp",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.setProp(t,Be(a))}},{key:"getOpacity",value:function(){return+this.getProp("opacity")*100}},{key:"setOpacity",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"100";if(Object(S.isString)(t)&&!Object(S.isNaN)(t)||Object(S.isNumber)(t))return this.setProp("opacity",+t/100);console.error("".concat(t," is not opacity value"))}},{key:"getTextAlign",value:function(){var t=this.getProp("textAlign").toLowerCase();return t===""?"left":t}},{key:"getFontFamily",value:function(){return this.getProp("fontFamily").toLowerCase()}},{key:"getBold",value:function(){return this.getProp("fontWeight")==="bold"}},{key:"setBold",value:function(t){this.setProp("fontWeight",de(t)?"bold":"")}},{key:"getItalic",value:function(){return this.getProp("fontStyle")==="italic"}},{key:"setItalic",value:function(t){this.setProp("fontStyle",de(t)?"italic":"")}}]),c}(),Jt=i("P2fV"),Re=i("NJEC"),Ne=i("Lyp1"),Kt=i("5NDa"),D=i("5rEg"),zt=i("y8nQ"),xe=i("Vl3Y"),Qt=i("1f8b"),De=function(n){return Object(S.toNumber)(n)===1?"":("0"+ +n*100).slice(-2)},dt=function(n){var t=n.className,a=t===void 0?"":t,r=n.name,l=n.value,u=n.onChange,d=n.label,j=n.style,v=Object(s.useMemo)(function(){return l&&l.length===9?[l.substring(0,7),+l.substring(7,9)/100]:[l,1]},[l]),h=Object(N.a)(v,2),o=h[0],g=h[1],f=Object(s.useCallback)(function(b){u(b.currentTarget.value+De(g))},[u,g]),O=Object(s.useCallback)(function(b){u(o+De(b.currentTarget.value))},[u,o]);return Object(e.jsx)("div",{className:"input-color ".concat(a),style:j,children:Object(e.jsx)(xe.a.Item,{label:d,children:Object(e.jsxs)(D.a.Group,{className:"input-color__container",size:"small",children:[Object(e.jsx)(D.a,{className:"input-color__color",name:r,value:o,onChange:f,type:"color"}),Object(e.jsx)(D.a,{className:"input-color__opacity",name:r+"Alpha",value:g,onChange:O,type:"range",min:"0",max:"1",step:"0.1"})]})})})},K=dt,ye=i("PpiC"),bt=function(n){var t=n.value,a=n.onChange,r=n.label,l=n.name,u=n.type,d=u===void 0?"text":u,j=n.style,v=Object(ye.a)(n,["value","onChange","label","name","type","style"]),h=Object(s.useCallback)(function(o){a(o.currentTarget.value)},[a]);return Object(e.jsx)(xe.a.Item,{label:r,children:Object(e.jsx)(D.a,Object(C.a)({name:l,value:t,onChange:h,type:d,style:j},v))})},ne=bt,Yt=i("OaEy"),Le=i("2fM7"),jt=Le.a.Option,vt=function(n){var t=n.value,a=n.onChange,r=n.label,l=n.name,u=n.options,d=u===void 0?[]:u,j=n.style,v=Object(ye.a)(n,["value","onChange","label","name","options","style"]);return Object(e.jsx)(xe.a.Item,{label:r,children:Object(e.jsx)(Le.a,Object(C.a)(Object(C.a)({value:t,onChange:a,style:j},v),{},{children:d.map(function(h){return Object(e.jsx)(jt,{value:h.value,children:h.label},h.value)})}))})},q=vt,Zt=i("sRBo"),ht=i("kaz8"),mt=function(n){var t=n.value,a=n.onChange,r=n.label,l=n.name,u=Object(ye.a)(n,["value","onChange","label","name"]),d=Object(s.useCallback)(function(j){a(j.target.checked)},[a]);return Object(e.jsx)(ht.a,Object(C.a)(Object(C.a)({name:l,value:t,checked:t,onChange:d},u),{},{children:r}))},re=mt,ft=function(n){var t=n.values,a=n.onChange;return Object(e.jsxs)("div",{className:"fabric-editor__form fabric-editor__form--active-element",children:[Object(e.jsx)("h3",{className:"fabric-editor__form-title",children:"Text options"}),Object(e.jsxs)(W.a,{gutter:5,children:[Object(e.jsxs)(x.a,{children:[Object(e.jsxs)(W.a,{gutter:5,children:[Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(q,{value:t.fontFamily,onChange:a("fontFamily"),label:"Font Family",name:"fontFamily",options:nt.map(function(r){return{value:r.toLowerCase(),label:r}}),style:{minWidth:"180px"}}),Object(e.jsx)(q,{value:t.fontSize,onChange:a("fontSize"),label:"Font Size",name:"fontSize",options:it.map(function(r){return{value:r,label:""+r}}),style:{minWidth:"75px"}})]})}),Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(q,{value:t.textAlign,onChange:a("textAlign"),label:"Text align",name:"textAlign",options:rt.map(function(r){return{value:r.toLowerCase(),label:r}}),style:{minWidth:"180px"}}),Object(e.jsx)(ne,{value:t.lineHeight,onChange:a("lineHeight"),label:"Line height",name:"lineHeight",type:"number",min:"0",max:"10",step:"0.1",style:{minWidth:"75px"}})]})})]}),Object(e.jsx)(D.a.Group,{style:{marginBottom:"15px"},children:Object(e.jsxs)(W.a,{gutter:5,children:[Object(e.jsx)(x.a,{children:Object(e.jsx)(re,{value:t.bold,onChange:a("bold"),label:"Bold",name:"bold"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(re,{value:t.italic,onChange:a("italic"),label:"Italic",name:"italic"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(re,{value:t.underline,onChange:a("underline"),label:"Underline",name:"underline"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(re,{value:t.linethrough,onChange:a("linethrough"),label:"Linethrough",name:"linethrough"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(re,{value:t.overline,onChange:a("overline"),label:"Overline",name:"overline"})})]})})]}),Object(e.jsxs)(x.a,{children:[Object(e.jsx)(D.a.Group,{children:Object(e.jsxs)(W.a,{gutter:10,children:[Object(e.jsx)(x.a,{children:Object(e.jsx)(K,{value:t.fill,onChange:a("fill"),label:"Text Color",name:"fill"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(K,{value:t.textBackgroundColor,onChange:a("textBackgroundColor"),label:"Background text color",name:"textBackgroundColor"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(K,{value:t.backgroundColor,onChange:a("backgroundColor"),label:"Background color",name:"backgroundColor"})})]})}),Object(e.jsxs)(W.a,{gutter:10,children:[Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(K,{value:t.stroke,onChange:a("stroke"),label:"Stroke color",name:"stroke"}),Object(e.jsx)(q,{value:t.strokeWidth,onChange:a("strokeWidth"),label:"Stroke width",name:"strokeWidth",options:ot.map(function(r){return{value:r,label:""+r}}),style:{minWidth:"65px"}})]})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(ne,{value:t.opacity,onChange:a("opacity"),label:"Opacity",name:"opacity",type:"range"})})]})]})]})]})},gt=ft,Ot=function(n){var t=n.values,a=n.onChange;return Object(e.jsxs)("div",{className:"fabric-editor__form fabric-editor__form--active-element",children:[Object(e.jsx)("h3",{className:"fabric-editor__form-title",children:"Object options"}),Object(e.jsxs)(W.a,{gutter:20,children:[Object(e.jsx)(x.a,{children:Object(e.jsx)(K,{value:t.fill,onChange:a("fill"),label:"Object Background Color",name:"fill"})}),Object(e.jsx)(x.a,{children:Object(e.jsxs)(W.a,{gutter:10,children:[Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(K,{value:t.stroke,onChange:a("stroke"),label:"Stroke color",name:"stroke"}),Object(e.jsx)(q,{value:t.strokeWidth,onChange:a("strokeWidth"),label:"Stroke width",name:"strokeWidth",options:lt.map(function(r){return{value:r,label:""+r}}),style:{minWidth:"65px"}})]})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(ne,{value:t.opacity,onChange:a("opacity"),label:"Opacity",name:"opacity",type:"range"})})]})})]})]})},pt=Ot,xt=function(n){var t=n.values,a=n.onChange;return Object(e.jsxs)("div",{className:"fabric-editor__form fabric-editor__form--active-element",children:[Object(e.jsx)("h3",{className:"fabric-editor__form-title",children:"Image options"}),Object(e.jsxs)(W.a,{gutter:10,children:[Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(K,{value:t.stroke,onChange:a("stroke"),label:"Stroke color",name:"stroke"}),Object(e.jsx)(q,{value:t.strokeWidth,onChange:a("strokeWidth"),label:"Stroke width",name:"strokeWidth",options:st.map(function(r){return{value:r,label:""+r}}),style:{minWidth:"65px"}})]})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(ne,{value:t.opacity,onChange:a("opacity"),label:"Opacity",name:"opacity",type:"range"})})]})]})},yt=xt,Ct=function(n){var t=n.values,a=n.onChange;return Object(e.jsxs)("div",{className:"fabric-editor__form fabric-editor__form--active-element",children:[Object(e.jsx)("h3",{className:"fabric-editor__form-title",children:"Line options"}),Object(e.jsxs)(W.a,{gutter:10,children:[Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(K,{value:t.stroke,onChange:a("stroke"),label:"Line color",name:"stroke"}),Object(e.jsx)(q,{value:t.strokeWidth,onChange:a("strokeWidth"),label:"Line width",name:"strokeWidth",options:ct.map(function(r){return{value:r,label:""+r}}),style:{minWidth:"65px"}})]})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(ne,{value:t.opacity,onChange:a("opacity"),label:"Opacity",name:"opacity",type:"range"})})]})]})},Ft=Ct,Et=function(n){var t=n.editorController,a=n.activeObject,r=Object(s.useCallback)(function(){return Object.fromEntries(at.map(function(o){return[o,t.getForActive(o)]}))},[t]),l=Object(s.useState)(r()),u=Object(N.a)(l,2),d=u[0],j=u[1];Object(s.useEffect)(function(){j(r());var o=function(){j(r())};return a&&a.on&&(a.on("selection:changed",o),a.on("editing:exited",o)),function(){a&&a.off&&(a.off("selection:changed",o),a.off("editing:exited",o))}},[r,a]);var v=Object(s.useCallback)(function(o){return function(g){j(Object(C.a)(Object(C.a)({},d),{},Object(Y.a)({},o,g))),t==null||t.setForActive(o,g)}},[d,t]),h=function(g){switch(g){case"text":case"i-text":case"textbox":return Object(e.jsx)(gt,{values:d,onChange:v});case"image":return Object(e.jsx)(yt,{values:d,onChange:v});case"line":return Object(e.jsx)(Ft,{values:d,onChange:v});default:return Object(e.jsx)(pt,{values:d,onChange:v})}};return Object(e.jsx)(e.Fragment,{children:a&&Object(e.jsxs)(e.Fragment,{children:[h(a.type),Object(e.jsx)("hr",{}),Object(e.jsx)(Re.a,{title:"Are you sure you want to delete object?",icon:Object(e.jsx)(Ne.a,{style:{color:"red"}}),onConfirm:function(){return t==null?void 0:t.deleteSelected()},children:Object(e.jsx)(R.a,{type:"primary",danger:!0,htmlType:"button",children:"Remove object"})})]})})},St=Et,Xt=i("qVdP"),We=i("jsC+"),qt=i("DZo9"),Tt=i("8z0m"),_t=i("lUTK"),V=i("BvKs"),Ve=i("8Skl"),ea=i("Ssu6"),kt=function(n){var t=n.editorController,a=n.variables,r=a===void 0?[]:a,l=Object(s.useState)({backgroundColor:t.getEditorBackgroundColor()}),u=Object(N.a)(l,2),d=u[0],j=u[1];Object(s.useEffect)(function(){var f=function O(){j({backgroundColor:t.getEditorBackgroundColor()}),t.canvas.off("after:render",O)};return t.canvas.on("after:render",f),function(){t.canvas.off("after:render",f)}},[]),Object(s.useEffect)(function(){j(Object(C.a)(Object(C.a)({},d),{},{backgroundColor:t.getEditorBackgroundColor()}))},[t]);var v=Object(s.useCallback)(function(f){j(Object(C.a)(Object(C.a)({},d),{},{backgroundColor:f})),t.setEditorBackgroundColor(f)},[t]),h=Object(s.useCallback)(function(f){if(f){var O=new FileReader;O.readAsDataURL(f),O.onload=function(){if(O.result){var b;t==null||t.addFile((b=O.result)===null||b===void 0?void 0:b.toString())}},O.onerror=function(b){console.log("Error: ",b)}}},[]),o=Object(e.jsxs)(V.a,{children:[Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addCircle()},htmlType:"button",children:"Add Circle"})},"1"),Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addRectangle()},htmlType:"button",children:"Add Rectangle"})},"2"),Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addLine()},htmlType:"button",children:"Add Line"})},"3"),Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(Tt.a,{beforeUpload:h,showUploadList:!1,accept:"image/*",className:"input-upload",children:Object(e.jsx)(R.a,{type:"primary",block:!0,children:"Add Image"})})},"4")]}),g=Object(e.jsxs)(V.a,{children:[Object(e.jsxs)(V.a.ItemGroup,{title:"Text",children:[Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addTextbox()},htmlType:"button",children:"Add Textbox"})},"1"),Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addIText()},htmlType:"button",children:"Add Text"})},"2")]}),Object(e.jsx)(V.a.ItemGroup,{title:"Variables",children:r.map(function(f){return Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addVariable(f)},htmlType:"button",children:"Add ".concat(f)})},f)})})]});return Object(e.jsxs)("div",{className:"fabric-editor__form fabric-editor__form--basic",children:[Object(e.jsx)("h3",{className:"fabric-editor__form-title",children:"Editor options"}),Object(e.jsxs)(W.a,{align:"middle",children:[Object(e.jsx)(x.a,{children:Object(e.jsx)(K,{value:d.backgroundColor,onChange:v,label:"Editor Background Color",name:"backgroundColor",style:{marginTop:"13px"}})}),Object(e.jsxs)(x.a,{children:[Object(e.jsx)(We.a,{overlay:o,children:Object(e.jsxs)(R.a,{children:["Add Object ",Object(e.jsx)(Ve.a,{})]})}),Object(e.jsx)(We.a,{overlay:g,children:Object(e.jsxs)(R.a,{children:["Add Text ",Object(e.jsx)(Ve.a,{})]})}),Object(e.jsx)(Re.a,{title:"Are you sure you want to delete everything?",icon:Object(e.jsx)(Ne.a,{style:{color:"red"}}),onConfirm:function(){return t==null?void 0:t.deleteAll()},children:Object(e.jsx)(R.a,{type:"primary",danger:!0,htmlType:"button",children:"Clear editor"})})]})]})]})},At=kt,ta=i("K4qu"),Pt=function(n){var t=n.onUpdate,a=n.initialValue,r=n.width,l=r===void 0?842:r,u=n.height,d=u===void 0?592:u,j=n.variables,v=j===void 0?[]:j,h=Object(s.useState)(),o=Object(N.a)(h,2),g=o[0],f=o[1],O=Object(ue.b)(),b=O.editor,ie=O.onReady,B=Object(s.useMemo)(function(){return b?new ut(b):void 0},[b]),w=function(){var X=b==null?void 0:b.canvas.toJSON();return X&&t&&t(X)};Object(s.useEffect)(function(){var Z=Object(S.debounce)(w,500);return b&&b.canvas&&b.canvas.on("after:render",Z),function(){b&&b.canvas&&b.canvas.off("after:render",Z)}},[b]);var Fe=function(X){if(a)try{var be=JSON.parse(a);X.loadFromJSON(be,function(){})}catch(Se){}ie(X)},Ee=function(){return b&&f(b.canvas.toSVG())};return Object(e.jsxs)("div",{className:"fabric-editor",children:[Object(e.jsxs)(W.a,{className:"fabric-editor__top",gutter:50,justify:"space-between",children:[Object(e.jsx)(x.a,{children:(B==null?void 0:B.canvas)&&Object(e.jsx)(At,{editorController:B,variables:v})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(R.a,{onClick:Ee,htmlType:"button",children:"Preview PDF without mock value"})})]}),Object(e.jsx)("div",{className:"fabric-editor__canvas fakeA4",style:{width:l,height:d},children:Object(e.jsx)(ue.a,{className:"fakeA4-canvas",onReady:Fe})}),Object(e.jsx)("div",{className:"fabric-editor__bottom",children:(B==null?void 0:B.canvas)&&Object(e.jsx)(St,{editorController:B,activeObject:B.activeObject})}),g&&Object(e.jsx)(Qe,{svgDef:g,width:l,height:d})]})},It=Pt,Bt=function(n){var t=n.name,a=n.field,r=n.variables,l=r===void 0?[]:r,u=Object(s.useCallback)(function(v){if(v.length)return Object(e.jsx)(U.b,{children:Object(e.jsxs)(A.a,{children:[Object(e.jsx)(y.a,{id:"templates.required_variables"}),":"," ",v.map(function(h){return Object(e.jsx)(oe.a,{color:"red",children:h},h)})]})})},[a,t]),d=Object(s.useCallback)(function(v,h){return v&&h.every(function(o){return v.includes(o)})?Promise.resolve():Promise.reject(new Error("No required variable  used"))},[a,t]),j=Object(s.useCallback)(function(){if(!a.readonly)switch(a.type){case"text":case"url":return Object(e.jsxs)(m.a.Fragment,{children:[Object(e.jsx)(I.a,{readonly:a.readonly,shouldUpdate:!0,width:"lg",name:t,label:Object(e.jsx)(y.a,{id:t}),rules:a.readonly?void 0:[{required:a.required,message:Object(e.jsx)(y.a,{id:"templates.this_required"})},{validator:function(){var v=Object(J.a)(P.a.mark(function o(g,f){return P.a.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",d(f,a.required_variables));case 1:case"end":return b.stop()}},o)}));function h(o,g){return v.apply(this,arguments)}return h}()}]}),u(a.required_variables)]});case"fabric.js":return Object(e.jsxs)(m.a.Fragment,{children:[Object(e.jsx)(E.b.Item,{shouldUpdate:!0,children:function(h){return Object(e.jsx)(It,{initialValue:h.getFieldValue(t),variables:l,onUpdate:function(g){return h.setFieldsValue(Object(Y.a)({},t,JSON.stringify(g)))}})}}),Object(e.jsx)(fe.a,{name:t,shouldUpdate:!0,width:"lg",hidden:!0})]});case"html":return Object(e.jsxs)(m.a.Fragment,{children:[Object(e.jsx)(fe.a,{readonly:a.readonly,shouldUpdate:!0,width:"lg",label:Object(e.jsx)(y.a,{id:t}),name:t,tooltip:Object(e.jsx)(y.a,{id:"templates.html_tooltip"}),rules:a.readonly?void 0:[{required:a.required,message:Object(e.jsx)(y.a,{id:"templates.this_required"})},{validator:function(){var v=Object(J.a)(P.a.mark(function o(g,f){return P.a.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",d(f,a.required_variables));case 1:case"end":return b.stop()}},o)}));function h(o,g){return v.apply(this,arguments)}return h}()}]}),u(a.required_variables)]});case"mjml":return Object(e.jsxs)(m.a.Fragment,{children:[Object(e.jsxs)("p",{children:[Object(e.jsx)(y.a,{id:"templates.to_create_template"})," ",Object(e.jsx)("a",{target:"_blank",href:"https://mjml.io/try-it-live",children:"https://mjml.io/try-it-live"})]}),Object(e.jsx)(fe.a,{readonly:a.readonly,shouldUpdate:!0,width:"lg",label:Object(e.jsx)(y.a,{id:t}),name:t,tooltip:Object(e.jsx)(y.a,{id:"templates.mjml_tooltip"}),rules:a.readonly?void 0:[{required:a.required,message:Object(e.jsx)(y.a,{id:"templates.this_required"})},{validator:function(){var v=Object(J.a)(P.a.mark(function o(g,f){return P.a.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",d(f,a.required_variables));case 1:case"end":return b.stop()}},o)}));function h(o,g){return v.apply(this,arguments)}return h}()}]}),u(a.required_variables)]});default:return}},[a,t]);return Object(e.jsx)(m.a.Fragment,{children:j()})},wt=Bt,Rt=function(n,t){return n?Object.keys(n).reduce(function(a,r){return n[r][t]?Object(C.a)(Object(C.a)({},a),{},Object(Y.a)({},r,r)):a},{}):{}},Nt=function(n){return Object.entries(n).map(function(t){return{key:t[0],content:t[1]}})},Me=function(n){return Object.assign.apply(Object,[{}].concat(Object(H.a)(n)))},Dt=function(n){var t=["name","event","default"];return Object.keys(n).filter(function(a){return!t.includes(a)}).reduce(function(a,r){return a[r]=n[r],a},{})},Ce={email:"EscolaLms\\TemplatesEmail\\Core\\EmailChannel",pdf:"EscolaLms\\TemplatesPdf\\Core\\PdfChannel"},aa=k.default=function(){var c=Object(y.i)(),n=Object(Je.g)(),t=n.template,a=n.id,r=a==="new",l=Object(s.useState)(!1),u=Object(N.a)(l,2),d=u[0],j=u[1],v=E.b.useForm(),h=Object(N.a)(v,1),o=h[0],g=Object(s.useState)(),f=Object(N.a)(g,2),O=f[0],b=f[1],ie=Object(s.useState)(void 0),B=Object(N.a)(ie,2),w=B[0],Fe=B[1],Ee=Object(s.useState)(),Z=Object(N.a)(Ee,2),X=Z[0],be=Z[1];Object(s.useEffect)(function(){Object(ae.g)().then(function(T){b(T.success?T.data:{})})},[]),Object(s.useEffect)(function(){var T=o.getFieldsValue(),F=w&&Object.keys(w.sections).map(function(M){return Object(Y.a)({},M,w.sections[M].default_content)});F&&r&&o.setFieldsValue(Object(C.a)(Object(C.a)({},T),Me(F)))},[w]);var Se=Object(s.useCallback)(function(T){if(T&&t){var F=O&&O[T][Ce[t]];Fe(F)}},[O,a]),Lt=Object(s.useCallback)(Object(J.a)(P.a.mark(function T(){var F,M,$;return P.a.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,Object(ae.d)(Number(a));case 2:F=ee.sent,F.success&&(M=F.data.sections&&F.data.sections.map(function(L){return Object(Y.a)({},L.key,L.content)}),$=M&&Me(M),o.setFieldsValue(Object(C.a)(Object(C.a)({},F.data),$)),Se(String(F.data.event)),j(!0));case 4:case"end":return ee.stop()}},T)})),[a,O]),Wt=Object(s.useCallback)(function(){var T=Object(J.a)(P.a.mark(function F(M){var $,je;return P.a.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(je=Object(C.a)(Object(C.a)({},M),{},{channel:Ce[t],sections:Nt(Dt(M))}),!r){L.next=8;break}return L.next=4,Object(ae.a)(je);case 4:$=L.sent,$.success&&y.d.push("/templates/".concat(t,"/").concat($.data.id)),L.next=11;break;case 8:return L.next=10,Object(ae.f)(Number(a),je);case 10:$=L.sent;case 11:j(!0),he.default.success($.message);case 13:case"end":return L.stop()}},F)}));return function(F){return T.apply(this,arguments)}}(),[O,a]);return Object(s.useEffect)(function(){r||Lt()},[a,O]),Object(e.jsxs)(Ge.a,{title:r?Object(e.jsxs)("span",{children:[Object(e.jsx)(y.a,{id:"new"})," ",t," ",Object(e.jsx)(y.a,{id:"template"})]}):Object(e.jsxs)("span",{children:[Object(e.jsx)(y.a,{id:"edit"})," ",t," ",Object(e.jsx)(y.a,{id:"template"})]}),children:[Object(e.jsx)($e.a,{size:"small",children:Object(e.jsxs)(E.b,{initialValues:{},onFinish:Wt,form:o,onValuesChange:function(){var F=o.getFieldsValue();Se(F.event),j(!1)},children:[Object(e.jsxs)(E.b.Group,{children:[Object(e.jsx)(I.a,{width:"sm",name:"name",label:Object(e.jsx)(y.a,{id:"name"}),placeholder:c.formatMessage({id:"name"}),rules:[{required:!0,message:Object(e.jsx)(y.a,{id:"select"})}]}),Object(e.jsx)(p.a,{name:"event",width:"lg",label:Object(e.jsx)(y.a,{id:"event"}),valueEnum:O?Rt(O,Ce[t]):{},placeholder:c.formatMessage({id:"event"}),rules:[{required:!0,message:Object(e.jsx)(y.a,{id:"select"})}]}),Object(e.jsx)(E.b.Item,{label:Object(e.jsx)(y.a,{id:"templates.set_as_default_template"}),children:Object(e.jsx)(_.a,{name:"default"})}),!r&&Object(e.jsx)(E.b.Item,{label:Object(e.jsx)(y.a,{id:"preview"}),children:Object(e.jsx)(He,{disabled:!d,id:Number(a),type:t,onPreviewData:function(F){F&&F.data&&F.data.content&&be(F.data.content)}})})]}),!w&&!r?Object(e.jsx)(ve.a,{}):w&&w.sections&&Object.keys(w.sections).map(function(T,F){var M=w.sections&&w.sections[T];return Object(e.jsxs)(m.a.Fragment,{children:[F===0&&Object(e.jsxs)(m.a.Fragment,{children:[Object(e.jsx)(te.a,{children:Object(e.jsx)(y.a,{id:"templates.tokens"})}),Object(e.jsx)(U.b,{children:Object(e.jsx)(A.a,{children:w.variables.map(function($){return Object(e.jsx)(oe.a,{color:"orange",children:$},$)})})})]}),Object(e.jsx)(te.a,{}),Object(e.jsx)(wt,{name:T,field:M,variables:w.variables})]},T)}),Object(e.jsx)(te.a,{})]})}),X&&Object(e.jsx)(ze,{initialValue:X,onRendered:function(){return be(void 0)}})]})}},"JAl+":function(z,k,i){},K4qu:function(z,k,i){},Ssu6:function(z,k,i){},rWUb:function(z,k,i){"use strict";i.d(k,"e",function(){return oe}),i.d(k,"d",function(){return te}),i.d(k,"a",function(){return ve}),i.d(k,"f",function(){return he}),i.d(k,"b",function(){return N}),i.d(k,"g",function(){return Y}),i.d(k,"c",function(){return me});var G=i("k1fw"),U=i("9og8"),Te=i("WmNS"),A=i.n(Te),Q=i("9kvl");function oe(s,m){return se.apply(this,arguments)}function se(){return se=Object(U.a)(A.a.mark(function s(m,E){return A.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",Object(Q.f)("/api/admin/templates",Object(G.a)({method:"GET",useCache:!1,params:Object(G.a)(Object(G.a)({},m),{},{per_page:m.pageSize&&m.pageSize,page:m.current&&m.current})},E||{})));case 1:case"end":return p.stop()}},s)})),se.apply(this,arguments)}function te(s,m){return ce.apply(this,arguments)}function ce(){return ce=Object(U.a)(A.a.mark(function s(m,E){return A.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",Object(Q.f)("/api/admin/templates/".concat(m),Object(G.a)({method:"GET"},E||{})));case 1:case"end":return p.stop()}},s)})),ce.apply(this,arguments)}function ve(s,m){return le.apply(this,arguments)}function le(){return le=Object(U.a)(A.a.mark(function s(m,E){return A.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",Object(Q.f)("/api/admin/templates",Object(G.a)({method:"POST",headers:{"Content-Type":"application/json"},data:m},E||{})));case 1:case"end":return p.stop()}},s)})),le.apply(this,arguments)}function he(s,m,E){return J.apply(this,arguments)}function J(){return J=Object(U.a)(A.a.mark(function s(m,E,I){return A.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",Object(Q.f)("/api/admin/templates/".concat(m),Object(G.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:E},I||{})));case 1:case"end":return _.stop()}},s)})),J.apply(this,arguments)}function N(s,m){return H.apply(this,arguments)}function H(){return H=Object(U.a)(A.a.mark(function s(m,E){return A.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",Object(Q.f)("/api/admin/templates/".concat(m),Object(G.a)({method:"DELETE",headers:{"Content-Type":"application/json"}},E||{})));case 1:case"end":return p.stop()}},s)})),H.apply(this,arguments)}function Y(s){return C.apply(this,arguments)}function C(){return C=Object(U.a)(A.a.mark(function s(m){return A.a.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.abrupt("return",Object(Q.f)("/api/admin/templates/variables",Object(G.a)({method:"GET"},m||{})));case 1:case"end":return I.stop()}},s)})),C.apply(this,arguments)}function me(s,m){return P.apply(this,arguments)}function P(){return P=Object(U.a)(A.a.mark(function s(m,E){return A.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",Object(Q.f)("/api/admin/templates/".concat(m,"/preview"),Object(G.a)({method:"GET"},E||{})));case 1:case"end":return p.stop()}},s)})),P.apply(this,arguments)}}}]);
