"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[2489,2803,8047],{76578:function(St,ve,t){t.r(ve),t.d(ve,{default:function(){return Pt}});var Te=t(15009),w=t.n(Te),De=t(97857),d=t.n(De),Ne=t(99289),z=t.n(Ne),Ie=t(5574),b=t.n(Ie),J=t(26271),j=t(952),te=t(5966),we=t(31199),Ae=t(64317),he=t(50335),pe=t(90672),Oe=t(2453),Re=t(75081),xe=t(71230),je=t(15746),l=t(67294),Me=t(19411),Fe=t(74453),Pe=t(44167),a=t(80854),oe=t(28694),Ee=t(23535),Ue=t(19632),V=t.n(Ue),Ve=t(49677),Be=t.n(Ve),$e=t(62235),Je=t(53682),Ge=t(51042),We=t(47389),He=t(82061),H=t(1413),Le=t(39055),Ke=t(84089),ze=function(u,i){return l.createElement(Ke.Z,(0,H.Z)((0,H.Z)({},u),{},{ref:i,icon:Le.Z}))},Qe=l.forwardRef(ze),Ye=Qe,Xe=t(16894),ke=t(78957),le=t(14726),qe=t(86738),_e=t(83062),et=t(62748),ue=t(43443),tt=t(37476),ye=t(45987),at=t(86190),Se=t(66758),Ze=t(57021),e=t(85893),rt=["fieldProps","proFieldProps"],st=["fieldProps","proFieldProps"],be="time",nt=l.forwardRef(function(y,u){var i=y.fieldProps,A=y.proFieldProps,n=(0,ye.Z)(y,rt),O=(0,l.useContext)(Se.Z);return(0,e.jsx)(Ze.Z,(0,H.Z)({ref:u,fieldProps:(0,H.Z)({getPopupContainer:O.getPopupContainer},i),valueType:"timeRange",proFieldProps:A,filedConfig:{valueType:"timeRange",customLightMode:!0,lightFilterLabelFormatter:function(M){return(0,at.c)(M,"HH:mm:ss")}}},n))}),it=function(u){var i=u.fieldProps,A=u.proFieldProps,n=(0,ye.Z)(u,st),O=(0,l.useContext)(Se.Z);return(0,e.jsx)(Ze.Z,(0,H.Z)({fieldProps:(0,H.Z)({getPopupContainer:O.getPopupContainer},i),valueType:be,proFieldProps:A,filedConfig:{customLightMode:!0,valueType:be}},n))},Ce=it;Ce.RangePicker=nt;var dt=Ce,ot=t(75842),lt=function(u){var i=(0,a.useIntl)(),A=u.visible,n=u.fields,O=u.onVisibleChange,p=u.onFinish,M=u.id,Y=ot.Z.useForm(),G=b()(Y,1),m=G[0];return(0,l.useEffect)(function(){if(n){m.setFieldsValue(n);return}m.resetFields()},[n]),(0,e.jsx)(tt.Y,{form:m,title:i.formatMessage({id:M?"editSetting":"newSetting",defaultMessage:M?"editSetting":"newSetting"}),width:"40vw",visible:A,onVisibleChange:function(B){O(B),m.resetFields()},onFinish:function(B){return m.resetFields(),p(d()(d()({},B),{},{id:(n==null?void 0:n.id)||null}))},children:(0,e.jsxs)(j.ZP.Group,{children:[(0,e.jsx)(te.Z,{label:(0,e.jsx)(a.FormattedMessage,{id:"title",defaultMessage:"title"}),rules:[{required:!0}],width:"lg",name:"title"}),(0,e.jsx)(te.Z,{label:(0,e.jsx)(a.FormattedMessage,{id:"subtitle",defaultMessage:"subtitle"}),rules:[{required:!0}],width:"lg",name:"subtitle"}),(0,e.jsx)(dt,{name:"hour",label:(0,e.jsx)(a.FormattedMessage,{id:"hour",defaultMessage:"hour"}),rules:[{required:!0}],width:"xs"}),(0,e.jsx)(j.ZP.Item,{name:"tutors",label:(0,e.jsx)(a.FormattedMessage,{id:"tutors"}),rules:[{required:!0}],convertValue:function(B){return B},valuePropName:"value",children:(0,e.jsx)(Pe.Z,{multiple:!0})}),(0,e.jsx)(pe.Z,{label:(0,e.jsx)(a.FormattedMessage,{id:"description",defaultMessage:"description"}),rules:[{required:!1}],width:"lg",name:"description"}),(0,e.jsx)(j.ZP.Item,{name:"asCandidate",hidden:!0})]})})},ut=lt,ct=(0,ue.W8)(function(y){return(0,e.jsx)("tr",d()({},y))}),mt=(0,ue.JN)(function(y){return(0,e.jsx)("tbody",d()({},y))}),gt=(0,ue.W6)(function(){return(0,e.jsx)(Je.Z,{style:{cursor:"grab",color:"#999"}})}),ft=function(u){var i=u.data,A=u.onCreate,n=u.lastDataUpdateDate,O=(0,l.useRef)(),p=(0,l.useRef)(null),M=(0,a.useIntl)(),Y=(0,l.useState)([]),G=b()(Y,2),m=G[0],W=G[1],B=(0,l.useState)(null),X=b()(B,2),ce=X[0],R=X[1],me=(0,l.useState)(!1),k=b()(me,2),S=k[0],E=k[1],ge=(0,l.useState)(i),ae=b()(ge,2),q=ae[0],re=ae[1],se=(0,l.useState)([]),ne=b()(se,2),U=ne[0],L=ne[1],K=(0,l.useState)(!1),C=b()(K,2),v=C[0],F=C[1],$=[{title:"Sort",dataIndex:"sort",width:"5%",className:"drag-visible",render:function(){return(0,e.jsx)(gt,{})}},{width:"20%",title:(0,e.jsx)(a.FormattedMessage,{id:"title",defaultMessage:"Title"}),dataIndex:"title",hideInSearch:!0,renderText:function(r){return r.length>80?"".concat(r.slice(0,77),"..."):r}},{width:"20%",title:(0,e.jsx)(a.FormattedMessage,{id:"subtitle",defaultMessage:"subtitle"}),dataIndex:"subtitle",hideInSearch:!0,renderText:function(r){return r.length>80?"".concat(r.slice(0,77),"..."):r}},{width:"10%",title:(0,e.jsx)(a.FormattedMessage,{id:"hour",defaultMessage:"hour"}),dataIndex:"hour",hideInSearch:!0},{width:"15%",title:(0,e.jsx)(a.FormattedMessage,{id:"tutors",defaultMessage:"tutors"}),dataIndex:"tutors",hideInSearch:!0,render:function(r,s){var o=s.tutors;return o&&(0,e.jsx)(ke.Z,{children:o.map(function(c){return(0,e.jsx)($e.Z,{type:"App\\Models\\User",type_id:c},c)})})}},{width:"18%",title:(0,e.jsx)(a.FormattedMessage,{id:"description",defaultMessage:"description"}),dataIndex:"description",hideInSearch:!0,renderText:function(r){return r?r.length>80?"".concat(r.trim().slice(0,77),"..."):r.trim():"-"}}],T=function(r){var s=r.oldIndex,o=r.newIndex;if(s!==o){var c=(0,et.q)(m.slice(),s,o).filter(Boolean);W(c)}},D=function(r){return(0,e.jsx)(mt,d()({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:T},r))},N=function(r){var s,o=Object.assign({},(Be()(r),r)),c=m.findIndex(function(P){var f=P.id;return f===o["data-row-key"]}),g=d()(d()({},o),{},{className:"".concat(o.className," ").concat((s=m[c])!==null&&s!==void 0&&s.asCandidate?"agenda-row-candidate":"")});return(0,e.jsx)(ct,d()({index:c},g))};return(0,l.useEffect)(function(){L([]),re(i),R(null),F(!1),p.current=null},[n]),(0,l.useEffect)(function(){z()(w()().mark(function h(){var r,s,o,c,g;return w()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(!q||!U)){f.next=2;break}return f.abrupt("return");case 2:r=[].concat(V()(q),V()(U)),s=r.reduce(function(x,Z,I,_){var ie=_.filter(function(ee){var fe=ee.id;return fe===Z.id});if(ie.length>1){var de=ie.find(function(ee){return"asCandidate"in ee});if(!de)return[].concat(V()(x),[ie[-1]]);var yt=de&&x.find(function(ee){var fe=ee.id;return fe===de.id});return yt?x:[].concat(V()(x),[de])}return[].concat(V()(x),[ie[0]])},[]),o=m.length?s.filter(function(x){var Z=x.id;return m.findIndex(function(I){return I.id===Z})===-1}):[],c=m.length?m.map(function(x){var Z=s.findIndex(function(I){var _=I.id;return _===x.id});return s[Z]}):s,g=[].concat(V()(c),V()(o)),W(g.filter(Boolean));case 8:case"end":return f.stop()}},h)}))()},[q,U]),(0,l.useEffect)(function(){var h=m.map(function(o){var c=o.id,g=o.title,P=o.subtitle,f=o.hour,x=o.description,Z=o.tutors;return{id:c,title:g,subtitle:P,hour:f,description:x,tutors:Z}});A(JSON.stringify(h));var r=m.map(function(o){var c=o.id;return c});if(p.current===null){if(!r.length)return;p.current=r}if(r.length>p.current.length){var s=JSON.stringify(r.slice(0,p.current.length))!==JSON.stringify(p.current);if(F(s),!s){p.current=r;return}}F(JSON.stringify(r)!==JSON.stringify(p.current))},[m]),(0,e.jsxs)(Fe._z,{header:{breadcrumb:{}},className:"agenda-container",children:[(0,e.jsx)(Xe.ZP,{className:"agenda-table",headerTitle:M.formatMessage({id:"agenda",defaultMessage:"Agenda"}),actionRef:O,rowKey:function(r){return r.id},search:!1,toolBarRender:function(){return[(0,e.jsxs)(le.ZP,{type:"primary",onClick:function(){return E(!0)},children:[(0,e.jsx)(Ge.Z,{})," ",(0,e.jsx)(a.FormattedMessage,{id:"new",defaultMessage:"new"})]},"primary")]},pagination:!1,dataSource:m,columns:[].concat($,[{width:"12%",hideInSearch:!0,title:(0,e.jsx)(a.FormattedMessage,{id:"pages.searchTable.titleOption"}),dataIndex:"option",valueType:"option",render:function(r,s){return[(0,e.jsx)(le.ZP,{type:"primary",icon:(0,e.jsx)(We.Z,{}),onClick:function(){if("asCandidate"in s){var c;R((c=U.find(function(P){var f=P.id;return f===s.id}))!==null&&c!==void 0?c:null)}else{var g;R((g=i.find(function(P){var f=P.id;return f===s.id}))!==null&&g!==void 0?g:null)}E(!0)}},"edit"),(0,e.jsx)(qe.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:z()(w()().mark(function o(){return w()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!("asCandidate"in s)){g.next=3;break}return L(function(P){return P.filter(function(f){var x=f.id;return x!==s.id})}),g.abrupt("return");case 3:re(function(P){return P.filter(function(f){var x=f.id;return x!==s.id})});case 4:case"end":return g.stop()}},o)})),okText:(0,e.jsx)(a.FormattedMessage,{id:"yes"}),cancelText:(0,e.jsx)(a.FormattedMessage,{id:"no"}),children:(0,e.jsx)(_e.Z,{title:(0,e.jsx)(a.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,e.jsx)(le.ZP,{type:"primary",icon:(0,e.jsx)(He.Z,{}),danger:!0})})},"delete")]}}]),components:{body:{wrapper:D,row:N}}}),!!U.length&&(0,e.jsxs)("div",{className:"legend",children:[(0,e.jsx)("div",{className:"legend__dot"}),(0,e.jsx)("p",{className:"legend__label",children:(0,e.jsx)(a.FormattedMessage,{id:"changesToBeApproved",defaultMessage:"Changes to be approved"})})]}),v&&(0,e.jsxs)("div",{className:"legend",children:[(0,e.jsx)(Ye,{className:"legend__icon"}),(0,e.jsx)("p",{className:"legend__label",children:(0,e.jsx)(a.FormattedMessage,{id:"orderHasBeenChanged",defaultMessage:"Order has been changed"})})]}),(0,e.jsx)(ut,{name:S,visible:S,fields:ce,onVisibleChange:function(r){r===!1&&(E(!1),R(null))},onFinish:function(){var h=z()(w()().mark(function r(s){var o,c,g,P,f;return w()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(!s.id){Z.next=9;break}return o="asCandidate"in s,c=o?U:i,g=c.find(function(I){var _=I.id;return _===s.id}),P=g?JSON.stringify(g)!==JSON.stringify(s):!1,P&&(f=o?U.map(function(I){return I.id===s.id?s:I}):[].concat(V()(U),[d()(d()({},s),{},{asCandidate:!0})]),L(f)),R(null),E(!1),Z.abrupt("return");case 9:L(function(I){return[].concat(V()(I),[d()(d()({},s),{},{asCandidate:!0,id:Date.now()})])}),R(null),E(!1);case 12:case"end":return Z.stop()}},r)}));return function(r){return h.apply(this,arguments)}}()})]})},vt=ft,ht=t(7418),pt=t(53957),xt=function(u){var i=u.show;return i?(0,e.jsx)("p",{children:(0,e.jsx)(a.FormattedMessage,{id:"unsaved_changes"})}):(0,e.jsx)(e.Fragment,{})},jt=xt,Mt=t(54434),Q=t(66419),Ft=function(){var u,i=(0,a.useIntl)(),A=(0,a.useParams)(),n=A.id,O=A.tab,p=O===void 0?"attributes":O,M=n==="new",Y=(0,l.useState)(null),G=b()(Y,2),m=G[0],W=G[1],B=(0,l.useState)(!1),X=b()(B,2),ce=X[0],R=X[1],me=(0,l.useState)(),k=b()(me,2),S=k[0],E=k[1],ge=j.ZP.useForm(),ae=b()(ge,1),q=ae[0],re=(0,l.useState)(new Date),se=b()(re,2),ne=se[0],U=se[1],L=(0,l.useCallback)(z()(w()().mark(function C(){var v,F;return w()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,(0,oe.lF)(Number(n));case 2:v=T.sent,v.success&&E(d()(d()({},v.data),{},{categories:v==null||(F=v.data)===null||F===void 0||(F=F.categories)===null||F===void 0?void 0:F.map(Q.P1)}));case 4:case"end":return T.stop()}},C)})),[n]);(0,l.useEffect)(function(){if(M){E({name:"..."});return}L()},[n]);var K=(0,l.useMemo)(function(){return{onFinish:function(){var C=z()(w()().mark(function F($){var T,D,N;return w()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(T=d()(d()({},$),{},{agenda:m,authors:$.authors&&$.authors.map(Q.i4),categories:$.categories&&$.categories.map(Q.i4),image_url:S&&S.image_url,image_path:S&&S.image_path&&(0,Q.Ox)(S.image_path)}),!M){r.next=8;break}return r.next=4,(0,oe.Vf)(T);case 4:D=r.sent,D.success&&(R(!1),a.history.push("/other/stationary-events/".concat(D.data.id))),r.next=12;break;case 8:return r.next=10,(0,oe.is)(Number(n),T);case 10:D=r.sent,D.success&&(R(!1),E(d()(d()({},D.data),{},{categories:(N=D)===null||N===void 0||(N=N.data)===null||N===void 0||(N=N.categories)===null||N===void 0?void 0:N.map(Q.P1)})),U(new Date),a.history.push("/other/stationary-events/".concat(D.data.id,"/").concat(p)));case 12:Oe.ZP.success(D.message);case 13:case"end":return r.stop()}},F)}));function v(F){return C.apply(this,arguments)}return v}(),initialValues:S}},[S,n,p,m]);return S?(0,e.jsx)(Fe._z,{title:M?(0,e.jsx)(a.FormattedMessage,{id:"stationary_event"}):(0,e.jsx)(a.FormattedMessage,{id:"stationary_event.edit"}),header:{breadcrumb:{routes:[{path:"other/stationary-events",breadcrumbName:i.formatMessage({id:"menu.Other activities.StationaryEvents"})},{path:String(n),breadcrumbName:i.formatMessage({id:"form"})},{path:"/",breadcrumbName:i.formatMessage({id:n==="new"?"new":"edit"})},{path:String(p),breadcrumbName:i.formatMessage({id:String(p)})}]}},children:(0,e.jsxs)(J.ZP,{tabs:{type:"card",activeKey:p,onChange:function(v){return a.history.push("/other/stationary-events/".concat(n,"/").concat(v))}},children:[(0,e.jsxs)(J.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"attributes"}),children:[(0,e.jsx)(jt,{show:ce})," ",(0,e.jsxs)(j.ZP,d()(d()({},K),{},{form:q,onValuesChange:function(){R(!0)},children:[(0,e.jsxs)(j.ZP.Group,{children:[(0,e.jsx)(te.Z,{width:"md",name:"name",label:(0,e.jsx)(a.FormattedMessage,{id:"name"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"name_tooltip"}),placeholder:i.formatMessage({id:"name",defaultMessage:"name"}),required:!0}),(0,e.jsx)(te.Z,{width:"md",name:"place",label:(0,e.jsx)(a.FormattedMessage,{id:"place"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"place_tooltip"}),placeholder:i.formatMessage({id:"place",defaultMessage:"place"}),required:!0}),(0,e.jsx)(j.ZP.Item,{name:"authors",label:(0,e.jsx)(a.FormattedMessage,{id:"tutor"}),valuePropName:"value",children:(0,e.jsx)(Pe.Z,{multiple:!0})}),(0,e.jsx)(we.Z,{width:"xs",name:"max_participants",label:(0,e.jsx)(a.FormattedMessage,{id:"max_participants"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"max_participants_tooltip"}),placeholder:i.formatMessage({id:"max_participants",defaultMessage:"max_participants"}),min:0,max:9999,fieldProps:{step:1}}),(0,e.jsx)(Ae.Z,{name:"status",width:"md",label:(0,e.jsx)(a.FormattedMessage,{id:"status"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"status_consultation_tooltip"}),valueEnum:{draft:i.formatMessage({id:"draft",defaultMessage:"draft"}),published:i.formatMessage({id:"published",defaultMessage:"published"}),archived:i.formatMessage({id:"archived",defaultMessage:"archived"})},initialValue:{draft:i.formatMessage({id:"draft",defaultMessage:"draft"})},placeholder:i.formatMessage({id:"status"}),rules:[{required:!0,message:(0,e.jsx)(a.FormattedMessage,{id:"select"})}]})]}),(0,e.jsxs)(j.ZP.Group,{children:[(0,e.jsx)(he.Z,{width:"sm",name:"started_at",label:(0,e.jsx)(a.FormattedMessage,{id:"started_at"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"started_at_tooltip"}),placeholder:i.formatMessage({id:"started_at",defaultMessage:"started_at"})}),(0,e.jsx)(he.Z,{width:"sm",name:"finished_at",label:(0,e.jsx)(a.FormattedMessage,{id:"finished_at"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"finished_at_tooltip"}),placeholder:i.formatMessage({id:"finished_at",defaultMessage:"finished_at"})})]}),(0,e.jsx)(j.ZP.Group,{children:(0,e.jsx)(pe.Z,{width:"lg",name:"short_desc",label:(0,e.jsx)(a.FormattedMessage,{id:"short_description"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"short_description"})})}),(0,e.jsx)(j.ZP.Item,{name:"program",label:(0,e.jsx)(a.FormattedMessage,{id:"program"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"program_tooltip"}),valuePropName:"value",children:(0,e.jsx)(Me.ZP,{directory:"stationary_events/".concat(n,"/wysiwyg")})}),(0,e.jsx)(j.ZP.Item,{name:"description",label:(0,e.jsx)(a.FormattedMessage,{id:"description"}),tooltip:(0,e.jsx)(a.FormattedMessage,{id:"description_tooltip"}),valuePropName:"value",children:(0,e.jsx)(Me.ZP,{directory:"stationary_events/".concat(n,"/wysiwyg")})})]}))]},"attributes")," ",!M&&(0,e.jsx)(J.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"agenda"}),children:(0,e.jsx)(j.ZP,d()(d()({},K),{},{children:(0,e.jsx)(vt,{data:(u=S.agenda)!==null&&u!==void 0?u:[],onCreate:function(v){return W(v)},lastDataUpdateDate:ne})}))},"agenda"),!M&&(0,e.jsx)(J.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"product"}),children:n&&(0,e.jsx)(pt.C,{productable:{class_type:"App\\Models\\StationaryEvent",class_id:n,name:String(S.name),quantity:1}})},"product"),!M&&(0,e.jsx)(J.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"media"}),children:(0,e.jsx)(j.ZP,d()(d()({},K),{},{children:(0,e.jsx)(Ee.Z,{folder:"stationary-events/".concat(n),title:"image",action:"/api/admin/stationary-events/".concat(n,"/?_method=PUT"),src_name:"image_url",form_name:"image",getUploadedSrcField:function(v){return v.file.response.data.image_url},setPath:function(v){return E(function(F){return d()(d()({},F),v)})}})}))},"media"),!M&&(0,e.jsx)(J.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"categories"}),children:(0,e.jsx)(xe.Z,{children:(0,e.jsx)(je.Z,{span:12,children:(0,e.jsx)(j.ZP,d()(d()({},K),{},{children:(0,e.jsx)(j.ZP.Item,{label:(0,e.jsx)(a.FormattedMessage,{id:"categories"}),name:"categories",valuePropName:"value",children:(0,e.jsx)(ht.Z,{multiple:!1})})}))})})},"categories"),!M&&(0,e.jsx)(J.ZP.TabPane,{tab:(0,e.jsx)(a.FormattedMessage,{id:"user_submission"}),children:(0,e.jsx)(xe.Z,{children:(0,e.jsx)(je.Z,{span:12,children:n&&(0,e.jsx)(Mt.ZP,{id:Number(n),type:"App\\Models\\StationaryEvent"})})})},"user_submission")]})}):(0,e.jsx)(Re.Z,{})},Pt=Ft}}]);
