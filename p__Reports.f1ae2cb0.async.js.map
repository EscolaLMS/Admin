{"version":3,"sources":["webpack:///./node_modules/export-to-csv/build/index.js","webpack:///./src/components/PieChart/PieChart.tsx","webpack:///./node_modules/@ant-design/plots/es/components/pie/index.js","webpack:///./node_modules/@ant-design/icons-svg/es/asn/FileExcelOutlined.js","webpack:///./node_modules/@ant-design/icons/es/icons/FileExcelOutlined.js","webpack:///./node_modules/export-to-csv/build/export-to-csv.js","webpack:///./src/pages/Reports/index.tsx","webpack:///./src/services/escola-lms/reports.ts"],"names":["m","p","exports","hasOwnProperty","Object","defineProperty","value","__export","require","columns","title","dataIndex","key","PieChart","metric","header","asDonut","customLabelTitle","customLabelContent","useState","mode","state","setState","intl","useIntl","config","appendPadding","angleField","colorField","radius","label","type","offset","content","_ref","percent","concat","toFixed","style","fontSize","textAlign","interactions","legend","itemValue","alignRight","formatter","text","item","find","name","donutConfig","innerRadius","itemWidth","undefined","itemName","offsetX","_","completeConfig","useEffect","reports","then","response","success","data","error","message","catch","err","toString","onDownload","useCallback","options","filename","split","join","fieldSeparator","quoteStrings","decimalSeparator","showLabels","showTitle","formatMessage","id","pop","useTextFile","useBom","useKeysAsHeaders","csvExporter","ExportToCsv","generateCsv","__rest","s","e","t","prototype","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","forwardRef","props","ref","chartRef","_a","height","className","loading","loadingTemplate","errorTemplate","rest","_b","useChart","G2plotPie","chart","container","getChart","current","useImperativeHandle","React","createElement","ErrorBoundary","ChartLoading","theme","CsvConfigConsts","EOL","BOM","DEFAULT_FIELD_SEPARATOR","DEFAULT_DECIMAL_SEPARATOR","DEFAULT_QUOTE","DEFAULT_SHOW_TITLE","DEFAULT_TITLE","DEFAULT_FILENAME","DEFAULT_SHOW_LABELS","DEFAULT_USE_TEXT_FILE","DEFAULT_USE_BOM","DEFAULT_HEADER","DEFAULT_KEYS_AS_HEADERS","ConfigDefaults","headers","_csv","_options","objectAssign","console","warn","get","set","enumerable","configurable","jsonData","shouldReturnCsv","_parseData","_getHeaders","_getBody","log","FileType","fileExtension","blob","Blob","navigator","msSaveBlob","replace","attachmentType","uri","encodeURI","link","document","href","URL","createObjectURL","setAttribute","download","body","appendChild","click","removeChild","keys","_data","row","keyPos","slice","_formatData","_isFloat","toLocaleString","input","isFinite","Boolean","JSON","parse","propIsEnumerable","val","TypeError","target","source","_i","arguments","from","to","toObject","symbols","params","request","method","useCache","course_id","responseType","accept"],"mappings":"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","file":"p__Reports.f1ae2cb0.async.js","sourcesContent":["\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__export(require(\"./export-to-csv\"));\n//# sourceMappingURL=index.js.map","import React, { useState, useEffect, useCallback } from 'react';\nimport type { PieConfig } from '@ant-design/plots';\nimport { Pie } from '@ant-design/plots';\nimport { reports } from '@/services/escola-lms/reports';\nimport { Spin, Alert, Button, Table } from 'antd';\nimport { FormattedMessage, useIntl } from 'umi';\nimport ProCard from '@ant-design/pro-card';\nimport { FileExcelOutlined } from '@ant-design/icons';\nimport { ExportToCsv } from 'export-to-csv';\n\nconst columns = [\n  {\n    title: <FormattedMessage id=\"label\" defaultMessage=\"label\" />,\n    dataIndex: 'label',\n    key: 'label',\n  },\n  {\n    title: <FormattedMessage id=\"value\" defaultMessage=\"value\" />,\n    dataIndex: 'value',\n    key: 'value',\n  },\n];\n\ntype State =\n  | {\n      mode: 'init';\n    }\n  | {\n      mode: 'loading';\n    }\n  | {\n      mode: 'error';\n      error: string;\n    }\n  | {\n      mode: 'loaded';\n      value: API.Report;\n    };\n\nconst PieChart: React.FC<{\n  metric: API.ReportType;\n  header?: boolean;\n  asDonut?: boolean;\n  customLabelTitle?: (text: string) => string;\n  customLabelContent?: (value: API.ReportItem) => string;\n}> = ({ metric, header = true, asDonut = false, customLabelTitle, customLabelContent }) => {\n  const [state, setState] = useState<State>({ mode: 'init' });\n  const intl = useIntl();\n\n  const config: Omit<PieConfig, 'data'> = {\n    appendPadding: 10,\n    angleField: 'value',\n    colorField: 'label',\n    radius: 0.9,\n    label: {\n      type: 'inner',\n      offset: '-30%',\n\n      content: function content(_ref: Record<string, any>) {\n        const percent = _ref.percent as number;\n        return percent >= 0.01 ? ''.concat((percent * 100).toFixed(0), '%') : '';\n      },\n      style: {\n        fontSize: 14,\n        textAlign: 'center',\n      },\n    },\n    interactions: [{ type: 'element-active' }],\n    legend: {\n      itemValue: {\n        alignRight: true,\n        formatter: (text, item) => {\n          if (customLabelContent && 'value' in state) {\n            const value = state.value.find(({ label }) => label === item.name);\n            return value ? customLabelContent(value) : text;\n          }\n          return text;\n        },\n      },\n    },\n  };\n\n  const donutConfig: Pick<PieConfig, 'innerRadius' | 'label' | 'appendPadding' | 'legend'> = {\n    appendPadding: 20,\n    innerRadius: 0.6,\n    label: {\n      ...config.label,\n      offset: '-50%',\n    },\n    legend: {\n      itemWidth: undefined,\n      itemName: {\n        formatter: (text) => (customLabelTitle ? customLabelTitle(text) : text),\n      },\n      offsetX: -24,\n      itemValue: {\n        formatter: (_, item) => {\n          if (customLabelContent && 'value' in state) {\n            const value = state.value.find(({ label }) => label === item.value);\n            return value ? customLabelContent(value) : undefined;\n          }\n          return undefined;\n        },\n      },\n    },\n  };\n\n  const completeConfig: Omit<PieConfig, 'data'> = {\n    ...config,\n    ...(asDonut ? donutConfig : {}),\n  };\n\n  useEffect(() => {\n    setState({ mode: 'loading' });\n\n    reports({ metric })\n      .then((response) => {\n        if (response.success) {\n          setState({ mode: 'loaded', value: response.data });\n        } else {\n          setState({ mode: 'error', error: response.message });\n        }\n      })\n      .catch((err) => setState({ mode: 'error', error: err.toString() }));\n  }, [metric]);\n\n  const onDownload = useCallback(() => {\n    if (state.mode === 'loaded') {\n      const options = {\n        filename: metric.split('\\\\').join('-'),\n        fieldSeparator: ',',\n        quoteStrings: '\"',\n        decimalSeparator: '.',\n        showLabels: true,\n        showTitle: true,\n        title: intl.formatMessage({ id: metric.split('\\\\').pop() }),\n        useTextFile: false,\n        useBom: true,\n        useKeysAsHeaders: true,\n        // headers: ['Column 1', 'Column 2', etc...] <-- Won't work with useKeysAsHeaders present!\n      };\n\n      const csvExporter = new ExportToCsv(options);\n\n      csvExporter.generateCsv(state.value);\n    }\n  }, [state]);\n\n  return (\n    <ProCard\n      title={\n        header && (\n          <FormattedMessage\n            id={metric.split('\\\\').pop()}\n            defaultMessage={metric.split('\\\\').pop()}\n          />\n        )\n      }\n      extra={\n        header && (\n          <Button icon={<FileExcelOutlined />} size=\"small\" onClick={() => onDownload()}>\n            {' '}\n            <FormattedMessage id={'download'} />\n            {'\\u00A0'}CSV\n          </Button>\n        )\n      }\n      headerBordered\n    >\n      {state.mode === 'loading' && <Spin />}\n      {state.mode === 'loaded' && (\n        <div>\n          <Pie {...completeConfig} data={state.value} />\n          {header && (\n            <Table pagination={false} size=\"small\" dataSource={state.value} columns={columns} />\n          )}\n        </div>\n      )}\n      {state.mode === 'error' && <Alert message={state.error} type=\"error\" />}\n    </ProCard>\n  );\n};\n\nexport default PieChart;\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React, { useEffect, useImperativeHandle, forwardRef } from 'react';\nimport { Pie as G2plotPie } from '@antv/g2plot';\nimport useChart from '../../hooks/useChart';\nimport { getChart } from '../../utils';\nimport ErrorBoundary from '../../errorBoundary';\nimport ChartLoading from '../../utils/createLoading';\nvar PieChart = forwardRef(function (props, ref) {\n    var chartRef = props.chartRef, _a = props.style, style = _a === void 0 ? {\n        height: 'inherit',\n    } : _a, className = props.className, loading = props.loading, loadingTemplate = props.loadingTemplate, errorTemplate = props.errorTemplate, rest = __rest(props, [\"chartRef\", \"style\", \"className\", \"loading\", \"loadingTemplate\", \"errorTemplate\"]);\n    var _b = useChart(G2plotPie, rest), chart = _b.chart, container = _b.container;\n    useEffect(function () {\n        getChart(chartRef, chart.current);\n    }, [chart.current]);\n    useImperativeHandle(ref, function () { return ({\n        getChart: function () { return chart.current; },\n    }); });\n    return (React.createElement(ErrorBoundary, { errorTemplate: errorTemplate },\n        loading && React.createElement(ChartLoading, { loadingTemplate: loadingTemplate, theme: props.theme }),\n        React.createElement(\"div\", { className: className, style: style, ref: container })));\n});\nexport default PieChart;\n","// This icon file is generated automatically.\nvar FileExcelOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z\" } }] }, \"name\": \"file-excel\", \"theme\": \"outlined\" };\nexport default FileExcelOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport FileExcelOutlinedSvg from \"@ant-design/icons-svg/es/asn/FileExcelOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar FileExcelOutlined = function FileExcelOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: FileExcelOutlinedSvg\n  }));\n};\nFileExcelOutlined.displayName = 'FileExcelOutlined';\nexport default /*#__PURE__*/React.forwardRef(FileExcelOutlined);","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CsvConfigConsts = (function () {\n    function CsvConfigConsts() {\n    }\n    CsvConfigConsts.EOL = \"\\r\\n\";\n    CsvConfigConsts.BOM = \"\\ufeff\";\n    CsvConfigConsts.DEFAULT_FIELD_SEPARATOR = ',';\n    CsvConfigConsts.DEFAULT_DECIMAL_SEPARATOR = '.';\n    CsvConfigConsts.DEFAULT_QUOTE = '\"';\n    CsvConfigConsts.DEFAULT_SHOW_TITLE = false;\n    CsvConfigConsts.DEFAULT_TITLE = 'My Generated Report';\n    CsvConfigConsts.DEFAULT_FILENAME = 'generated';\n    CsvConfigConsts.DEFAULT_SHOW_LABELS = false;\n    CsvConfigConsts.DEFAULT_USE_TEXT_FILE = false;\n    CsvConfigConsts.DEFAULT_USE_BOM = true;\n    CsvConfigConsts.DEFAULT_HEADER = [];\n    CsvConfigConsts.DEFAULT_KEYS_AS_HEADERS = false;\n    return CsvConfigConsts;\n}());\nexports.CsvConfigConsts = CsvConfigConsts;\nexports.ConfigDefaults = {\n    filename: CsvConfigConsts.DEFAULT_FILENAME,\n    fieldSeparator: CsvConfigConsts.DEFAULT_FIELD_SEPARATOR,\n    quoteStrings: CsvConfigConsts.DEFAULT_QUOTE,\n    decimalSeparator: CsvConfigConsts.DEFAULT_DECIMAL_SEPARATOR,\n    showLabels: CsvConfigConsts.DEFAULT_SHOW_LABELS,\n    showTitle: CsvConfigConsts.DEFAULT_SHOW_TITLE,\n    title: CsvConfigConsts.DEFAULT_TITLE,\n    useTextFile: CsvConfigConsts.DEFAULT_USE_TEXT_FILE,\n    useBom: CsvConfigConsts.DEFAULT_USE_BOM,\n    headers: CsvConfigConsts.DEFAULT_HEADER,\n    useKeysAsHeaders: CsvConfigConsts.DEFAULT_KEYS_AS_HEADERS,\n};\nvar ExportToCsv = (function () {\n    function ExportToCsv(options) {\n        this._csv = \"\";\n        var config = options || {};\n        this._options = objectAssign({}, exports.ConfigDefaults, config);\n        if (this._options.useKeysAsHeaders\n            && this._options.headers\n            && this._options.headers.length > 0) {\n            console.warn('Option to use object keys as headers was set, but headers were still passed!');\n        }\n    }\n    Object.defineProperty(ExportToCsv.prototype, \"options\", {\n        get: function () {\n            return this._options;\n        },\n        set: function (options) {\n            this._options = objectAssign({}, exports.ConfigDefaults, options);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Generate and Download Csv\n     */\n    ExportToCsv.prototype.generateCsv = function (jsonData, shouldReturnCsv) {\n        if (shouldReturnCsv === void 0) { shouldReturnCsv = false; }\n        // Make sure to reset csv data on each run\n        this._csv = '';\n        this._parseData(jsonData);\n        if (this._options.useBom) {\n            this._csv += CsvConfigConsts.BOM;\n        }\n        if (this._options.showTitle) {\n            this._csv += this._options.title + '\\r\\n\\n';\n        }\n        this._getHeaders();\n        this._getBody();\n        if (this._csv == '') {\n            console.log(\"Invalid data\");\n            return;\n        }\n        // When the consumer asks for the data, exit the function\n        // by returning the CSV data built at this point\n        if (shouldReturnCsv) {\n            return this._csv;\n        }\n        // Create CSV blob to download if requesting in the browser and the\n        // consumer doesn't set the shouldReturnCsv param\n        var FileType = this._options.useTextFile ? 'plain' : 'csv';\n        var fileExtension = this._options.useTextFile ? '.txt' : '.csv';\n        var blob = new Blob([this._csv], { \"type\": \"text/\" + FileType + \";charset=utf8;\" });\n        if (navigator.msSaveBlob) {\n            var filename = this._options.filename.replace(/ /g, \"_\") + fileExtension;\n            navigator.msSaveBlob(blob, filename);\n        }\n        else {\n            var attachmentType = this._options.useTextFile ? 'text' : 'csv';\n            var uri = 'data:attachment/' + attachmentType + ';charset=utf-8,' + encodeURI(this._csv);\n            var link = document.createElement(\"a\");\n            link.href = URL.createObjectURL(blob);\n            link.setAttribute('visibility', 'hidden');\n            link.download = this._options.filename.replace(/ /g, \"_\") + fileExtension;\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n        }\n    };\n    /**\n     * Create Headers\n     */\n    ExportToCsv.prototype._getHeaders = function () {\n        if (!this._options.showLabels && !this._options.useKeysAsHeaders) {\n            return;\n        }\n        var useKeysAsHeaders = this._options.useKeysAsHeaders;\n        var headers = useKeysAsHeaders ? Object.keys(this._data[0]) : this._options.headers;\n        if (headers.length > 0) {\n            var row = \"\";\n            for (var keyPos = 0; keyPos < headers.length; keyPos++) {\n                row += headers[keyPos] + this._options.fieldSeparator;\n            }\n            row = row.slice(0, -1);\n            this._csv += row + CsvConfigConsts.EOL;\n        }\n    };\n    /**\n     * Create Body\n     */\n    ExportToCsv.prototype._getBody = function () {\n        var keys = Object.keys(this._data[0]);\n        for (var i = 0; i < this._data.length; i++) {\n            var row = \"\";\n            for (var keyPos = 0; keyPos < keys.length; keyPos++) {\n                var key = keys[keyPos];\n                row += this._formatData(this._data[i][key]) + this._options.fieldSeparator;\n            }\n            row = row.slice(0, -1);\n            this._csv += row + CsvConfigConsts.EOL;\n        }\n    };\n    /**\n     * Format Data\n     * @param {any} data\n     */\n    ExportToCsv.prototype._formatData = function (data) {\n        if (this._options.decimalSeparator === 'locale' && this._isFloat(data)) {\n            return data.toLocaleString();\n        }\n        if (this._options.decimalSeparator !== '.' && this._isFloat(data)) {\n            return data.toString().replace('.', this._options.decimalSeparator);\n        }\n        if (typeof data === 'string') {\n            data = data.replace(/\"/g, '\"\"');\n            if (this._options.quoteStrings || data.indexOf(',') > -1 || data.indexOf('\\n') > -1 || data.indexOf('\\r') > -1) {\n                data = this._options.quoteStrings + data + this._options.quoteStrings;\n            }\n            return data;\n        }\n        if (typeof data === 'boolean') {\n            return data ? 'TRUE' : 'FALSE';\n        }\n        return data;\n    };\n    /**\n     * Check if is Float\n     * @param {any} input\n     */\n    ExportToCsv.prototype._isFloat = function (input) {\n        return +input === input && (!isFinite(input) || Boolean(input % 1));\n    };\n    /**\n     * Parse the collection given to it\n     *\n     * @private\n     * @param {*} jsonData\n     * @returns {any[]}\n     * @memberof ExportToCsv\n     */\n    ExportToCsv.prototype._parseData = function (jsonData) {\n        this._data = typeof jsonData != 'object' ? JSON.parse(jsonData) : jsonData;\n        return this._data;\n    };\n    return ExportToCsv;\n}());\nexports.ExportToCsv = ExportToCsv;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n/**\n * Convet to Object\n * @param {any} val\n */\nfunction toObject(val) {\n    if (val === null || val === undefined) {\n        throw new TypeError('Object.assign cannot be called with null or undefined');\n    }\n    return Object(val);\n}\n/**\n * Assign data  to new Object\n * @param {any}   target\n * @param {any[]} ...source\n */\nfunction objectAssign(target) {\n    var source = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        source[_i - 1] = arguments[_i];\n    }\n    var from;\n    var to = toObject(target);\n    var symbols;\n    for (var s = 1; s < arguments.length; s++) {\n        from = Object(arguments[s]);\n        for (var key in from) {\n            if (hasOwnProperty.call(from, key)) {\n                to[key] = from[key];\n            }\n        }\n        if (Object.getOwnPropertySymbols) {\n            symbols = Object.getOwnPropertySymbols(from);\n            for (var i = 0; i < symbols.length; i++) {\n                if (propIsEnumerable.call(from, symbols[i])) {\n                    to[symbols[i]] = from[symbols[i]];\n                }\n            }\n        }\n    }\n    return to;\n}\n//# sourceMappingURL=export-to-csv.js.map","import React from 'react';\nimport { PageContainer } from '@ant-design/pro-layout';\nimport PieChart from '@/components/PieChart/PieChart';\nimport ProCard from '@ant-design/pro-card';\n\nexport default (): React.ReactNode => {\n  return (\n    <PageContainer>\n      <ProCard split=\"vertical\">\n        <ProCard colSpan={12} layout=\"center\">\n          <PieChart metric={'EscolaLms\\\\Reports\\\\Metrics\\\\CoursesMoneySpentMetric'} />\n        </ProCard>\n        <ProCard colSpan={12} layout=\"center\">\n          <PieChart metric={'EscolaLms\\\\Reports\\\\Metrics\\\\CoursesPopularityMetric'} />\n        </ProCard>\n      </ProCard>\n      <ProCard split=\"vertical\">\n        <ProCard colSpan={12} layout=\"center\">\n          <PieChart metric={'EscolaLms\\\\Reports\\\\Metrics\\\\CoursesSecondsSpentMetric'} />\n        </ProCard>\n        <ProCard colSpan={12} layout=\"center\">\n          <PieChart metric={'EscolaLms\\\\Reports\\\\Metrics\\\\TutorsPopularityMetric'} />\n        </ProCard>\n      </ProCard>\n    </PageContainer>\n  );\n};\n","import { request } from 'umi';\nimport type { RequestOptionsInit } from 'umi-request';\n\nexport async function reports(\n  params: {\n    // query\n    metric: API.ReportType;\n    date?: string;\n    limit?: number;\n  },\n  options?: RequestOptionsInit,\n) {\n  return request<API.ReportList>('/api/admin/reports/report', {\n    params,\n    method: 'GET',\n    /* useCache: true */ useCache: false,\n    ...(options || {}),\n  });\n}\n\n/* GET /api/admin/stats/course/:course_id/export */\nexport async function exportStatForCourse(\n  course_id: number,\n  params: API.ExportStatForCourseParams,\n  options?: RequestOptionsInit,\n) {\n  return request<Blob | API.DefaultResponseError>(`/api/admin/stats/course/${course_id}/export`, {\n    params,\n    method: 'GET',\n    /* useCache: true */ useCache: false,\n    responseType: 'blob',\n    headers: {\n      accept: 'application/vnd.ms-excel',\n    },\n    ...(options || {}),\n  });\n}\n"],"sourceRoot":""}