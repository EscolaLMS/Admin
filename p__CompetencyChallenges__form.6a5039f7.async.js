(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"60mZ":function(He,V,t){},EKp7:function(He,V,t){"use strict";t.r(V);var M=t("T2oS"),J=t("W9HT"),f=t("q1tI"),o=t("9kvl"),X=t("Ty5D"),De=t("tMyG"),je=t("nhC9"),N=t("tKSU"),w=t("qLMh"),Te=t("miYZ"),L=t("tsqr"),I=t("9og8"),T=t("k1fw"),s=t("PpiC"),F=t("tJVT"),y=t("VMEa"),W=t("Qurx"),K=t("yj/a"),ue=t("F/zT"),Z=t("BiO0"),x=t("CEpB"),O=t("0WSk"),P=t("Gn8c"),Q=t("hd5d"),d=t("YRX9"),ne=t("/y+f"),r=t("nKUr"),e=["authors","category"],Qe=Object.values(ne.b).map(function(ye){return{value:ye,label:Object(r.jsx)(o.a,{id:"CompetencyChallenges.types.".concat(ye)})}}),Ue=function(){var z=Object(N.b)(),b=z.competencyChallenge,ee=z.categoryDepths,R=z.refreshData,te=Object(X.l)(),_=Number(te.id),se=Object(o.l)(),be=y.a.useForm(),Pe=Object(F.a)(be,1),ae=Pe[0],Oe=y.a.useWatch("type",ae),Ce=Number.isNaN(_),fe=Object(f.useMemo)(function(){if(!(b!=null&&b.data))return{};var A=b==null?void 0:b.data,U=A.authors,ve=A.category,Y=Object(s.a)(A,e);return Object(T.a)(Object(T.a)({},Y),{},{authors:U.map(function(G){var q=G.id;return q}),category_id:ve==null?void 0:ve.id})},[b==null?void 0:b.data]),me=Object(f.useCallback)(function(){var A=Object(I.a)(Object(w.a)().mark(function U(ve){var Y,G,q,re,B,S,Se,u;return Object(w.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Y=ve.name,G=ve.type,q=ve.is_active,re=q===void 0?!1:q,B=ve.is_highlighted,S=B===void 0?!1:B,Se=ve.category_id,n.prev=1,n.next=4,Object(d.a)({name:Y,is_active:re,is_highlighted:S,type:G,category_id:Se});case 4:if(u=n.sent,u.success){n.next=8;break}return L.b.error(u.message),n.abrupt("return");case 8:return L.b.success(se.formatMessage({id:u.message})),o.f.push("/competency-challenges/".concat(u.data.id,"/main")),n.next=12,R();case 12:n.next=17;break;case 14:n.prev=14,n.t0=n.catch(1),L.b.error(se.formatMessage({id:"error"}));case 17:case"end":return n.stop()}},U,null,[[1,14]])}));return function(U){return A.apply(this,arguments)}}(),[]),Be=Object(f.useCallback)(function(){var A=Object(I.a)(Object(w.a)().mark(function U(ve){var Y,G,q,re;return Object(w.a)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.prev=0,Y=ae.getFieldsValue(["image_url","image_path"]),G=Y.image_url,q=Y.image_path,S.next=4,Object(d.g)(_,Object(T.a)(Object(T.a)({},ve),{},{image_url:G,image_path:q}));case 4:if(re=S.sent,re.success){S.next=8;break}return L.b.error(re.message),S.abrupt("return");case 8:return L.b.success(se.formatMessage({id:re.message})),S.next=11,R();case 11:S.next=16;break;case 13:S.prev=13,S.t0=S.catch(0),L.b.error(se.formatMessage({id:"error"}));case 16:case"end":return S.stop()}},U,null,[[0,13]])}));return function(U){return A.apply(this,arguments)}}(),[_]);return Object(r.jsxs)(y.a,{form:ae,initialValues:fe,onFinish:Ce?me:Be,onValuesChange:function(U){(U==null?void 0:U.type)==="complex"&&ae.setFieldValue("category",null)},children:[Object(r.jsxs)(y.a.Group,{title:Object(r.jsx)(o.a,{id:"CompetencyChallenges.base"}),children:[Object(r.jsx)(W.a,{width:"md",name:"name",label:Object(r.jsx)(o.a,{id:"name"}),placeholder:se.formatMessage({id:"name"}),required:!0,rules:[{required:!0,message:se.formatMessage({id:"field_required"})}]}),Object(r.jsx)(K.a,{width:"md",name:"type",label:Object(r.jsx)(o.a,{id:"type"}),options:Qe,required:!0,rules:[{required:!0,message:se.formatMessage({id:"field_required"})}]}),Oe==="simple"&&Object(r.jsx)(y.a.Item,{name:"category_id",required:!0,label:Object(r.jsx)(o.a,{id:"category"}),rules:[{required:!0,message:se.formatMessage({id:"field_required"})}],children:Object(r.jsx)(x.a,{enabledDepth:ee.role})}),Object(r.jsx)(ue.a,{name:"is_active",label:Object(r.jsx)(o.a,{id:"is_active"})}),Object(r.jsx)(ue.a,{name:"is_highlighted",label:Object(r.jsx)(o.a,{id:"is_highlighted"}),tooltip:Object(r.jsx)(o.a,{id:"CompetencyChallenges.highlighted"})})]}),!Ce&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(y.a.Group,{title:Object(r.jsx)(o.a,{id:"CompetencyChallenges.additional"}),children:[Object(r.jsx)(y.a.Item,{name:"description",label:Object(r.jsx)(o.a,{id:"description"}),valuePropName:"value",style:{width:440},children:Object(r.jsx)(Q.a,{directory:"competency-challenges/".concat(_)})}),Object(r.jsx)(Z.a,{width:"lg",name:"summary",label:Object(r.jsx)(o.a,{id:"summary"})}),Object(r.jsx)(y.a.Item,{name:"authors",label:Object(r.jsx)(o.a,{id:"author"}),style:{width:"100%",maxWidth:440},children:Object(r.jsx)(O.a,{multiple:!0})})]}),Object(r.jsx)(P.a,{wrapInForm:!1,folder:"/competency-challenges/".concat(_),title:"image",action:"/api/admin/competency-challenges/".concat(_,"?_method=PATCH"),src_name:"image_url",form_name:"image",getUploadedSrcField:function(U){return U.file.response.data.image_url},setPath:function(U){return ae.setFieldsValue(U)}})]})]})},Ve=t("P2fV"),Ae=t("NJEC"),pe=t("5Dmo"),ge=t("3S7+"),j=t("+L6B"),k=t("2/Rp"),Re=t("G3dp"),Ie=t("/MfK"),Ke=t("Hn4i"),de=t("enqX"),Ne=["scale_min","category_id"],_e=[{title:Object(r.jsx)(o.a,{id:"ID"}),dataIndex:"id",editable:!1,render:function(z,b){if(typeof b.id!="string")return"-";var ee=b.id.split("-"),R=Object(F.a)(ee,2),te=R[0],_=R[1];return te==="new"?"-":_}},{title:Object(r.jsx)(o.a,{id:"min_points"}),dataIndex:"scale_min",valueType:"digit",formItemProps:{rules:[{required:!0,message:Object(r.jsx)(o.a,{id:"field_required"})},{type:"number",min:0,max:100,message:Object(r.jsx)(o.a,{id:"number_between",values:{min:0}})}]},fieldProps:{min:0}},{title:Object(r.jsx)(o.a,{id:"category"}),dataIndex:"category_id",render:function(z,b){return b.category_name},formItemProps:{rules:[{required:!0,message:Object(r.jsx)(o.a,{id:"field_required"})}]},renderFormItem:function(z,b,ee){var R,te=((R=ee.getFieldValue("table"))!==null&&R!==void 0?R:[]).map(function(_){return _.category_id});return Object(r.jsx)(de.a,{disabledNodes:te})}}],Ge=function(z){return z.map(function(b){var ee=b.id,R=b.scale_min,te=b.category;return{id:"old-".concat(ee),scale_min:R,category_id:te.id,category_name:te.name_with_breadcrumbs}})},Le=function(){var z,b,ee=Object(N.b)(),R=ee.competencyChallenge,te=ee.refreshData,_=Object(X.l)(),se=Number(_.id),be=(z=R==null||(b=R.data)===null||b===void 0?void 0:b.scales)!==null&&z!==void 0?z:[],Pe=Object(f.useState)([]),ae=Object(F.a)(Pe,2),Oe=ae[0],Ce=ae[1],fe=Object(o.l)(),me=Object(f.useRef)(),Be=Object(f.useRef)(),A=Object(f.useRef)(),U=Object(f.useMemo)(function(){return Ge(be)},[be]),ve=Object(f.useMemo)(function(){return[].concat(_e,[{valueType:"option",title:Object(r.jsx)(o.a,{id:"options"}),render:function(G,q,re,B){return[Object(r.jsx)(ge.a,{title:Object(r.jsx)(o.a,{id:"edit",defaultMessage:"edit"}),children:Object(r.jsx)(k.a,{type:"primary",icon:Object(r.jsx)(Re.a,{}),onClick:function(){return B==null?void 0:B.startEditable(q.id)}})},"edit"),Object(r.jsx)(Ae.a,{title:Object(r.jsx)(o.a,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:Object(I.a)(Object(w.a)().mark(function S(){var Se,u,a,n,i,c,v,m;return Object(w.a)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(typeof q.id=="string"){l.next=2;break}return l.abrupt("return");case 2:if(Se=q.id.split("-"),u=Object(F.a)(Se,2),a=u[0],n=u[1],a!=="new"){l.next=7;break}return v=(i=me.current)===null||i===void 0?void 0:i.getFieldValue("table"),(c=me.current)===null||c===void 0||c.setFieldValue("table",v.filter(function(D){var g=D.id;return g!==q.id})),l.abrupt("return");case 7:return l.next=9,Object(d.d)(+n);case 9:if(m=l.sent,!m.success){l.next=13;break}return l.next=13,te();case 13:case"end":return l.stop()}},S)})),okText:Object(r.jsx)(o.a,{id:"ok"}),cancelText:Object(r.jsx)(o.a,{id:"cancel"}),children:Object(r.jsx)(ge.a,{title:Object(r.jsx)(o.a,{id:"delete",defaultMessage:"delete"}),children:Object(r.jsx)(k.a,{type:"primary",icon:Object(r.jsx)(Ie.a,{}),danger:!0})})},"delete")]}}])},[]);return Object(r.jsx)(y.a,{formRef:me,initialValues:{table:U},submitter:!1,children:Object(r.jsx)(Ke.a,{rowKey:function(G){return G.id},editableFormRef:Be,controlled:!0,actionRef:A,name:"table",columns:ve,recordCreatorProps:{creatorButtonText:Object(r.jsx)(o.a,{id:"CompetencyChallenges.addNewRow"}),disabled:Oe.length>0,record:function(G){return{id:"new-".concat(G)}}},editable:{onlyOneLineEditorAlertMessage:fe.formatMessage({id:"CompetencyChallenges.onlyOneRowIsEditable"}),onSave:function(){var Y=Object(I.a)(Object(w.a)().mark(function q(re,B){var S,Se,u,a,n,i,c,v,m;return Object(w.a)().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(S=B.scale_min,Se=B.category_id,u=Object(s.a)(B,Ne),typeof u.id=="string"){l.next=3;break}return l.abrupt("return");case 3:if(a=u.id.split("-"),n=Object(F.a)(a,2),i=n[0],c=n[1],i!=="new"){l.next=12;break}return l.next=7,Object(d.b)({scale_min:S,category_id:Se,competency_challenge_id:se});case 7:if(v=l.sent,!v.success){l.next=11;break}return l.next=11,te();case 11:return l.abrupt("return");case 12:return l.next=14,Object(d.h)(+c,{scale_min:S,category_id:Se,competency_challenge_id:se});case 14:if(m=l.sent,!m.success){l.next=18;break}return l.next=18,te();case 18:return l.abrupt("return");case 19:case"end":return l.stop()}},q)}));function G(q,re){return Y.apply(this,arguments)}return G}(),deletePopconfirmMessage:Object(r.jsx)(o.a,{id:"deleteQuestion"}),actionRender:function(G,q,re){if(typeof G.id!="string")return[];var B=G.id.split("-"),S=Object(F.a)(B,1),Se=S[0];return Se==="new"?[re.save,re.delete]:[re.save,re.cancel]},type:"single",editableKeys:Oe,onChange:Ce}})})},ke=t("/zsF"),Ye=t("PArb"),et=t("DYRE"),ze=t("zeV3"),Je=t("uD7z"),qe=t("FJDo"),Xe=t("4KAj"),st=t("yioT"),oe=t("qRSf"),it=t("rmhi"),ct=function(z){var b=z.quiz_id,ee=z.visible,R=z.onVisibleChange,te=y.a.useForm(),_=Object(F.a)(te,1),se=_[0],be=Object(f.useCallback)(function(){var Pe=Object(I.a)(Object(w.a)().mark(function ae(Oe){var Ce,fe,me;return Object(w.a)().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return Ce=Oe.category_ids,A.prev=1,A.next=4,Object(oe.c)({quiz_id:b,category_ids:Ce});case 4:fe=A.sent,fe instanceof Blob&&(me=document.createElement("a"),me.href=window.URL.createObjectURL(fe),me.download="quiz_".concat(b,"_questions_by_category_id.xlsx"),document.body.appendChild(me),me.click(),document.body.removeChild(me)),A.next=11;break;case 8:A.prev=8,A.t0=A.catch(1),console.error(A.t0);case 11:return A.prev=11,R(!1),A.finish(11);case 14:case"end":return A.stop()}},ae,null,[[1,8,11,14]])}));return function(ae){return Pe.apply(this,arguments)}}(),[b]);return Object(r.jsx)(it.a,{title:Object(r.jsx)(o.a,{id:"exportQuestions"}),form:se,visible:ee,onVisibleChange:R,onFinish:be,children:Object(r.jsx)(y.a.Item,{name:"category_ids",label:Object(r.jsx)(o.a,{id:"categories"}),required:!0,rules:[{required:!0,message:Object(r.jsx)(o.a,{id:"field_required"})}],children:Object(r.jsx)(de.a,{multiple:!0,type:"question"})})})},tt=function(){var z=Object(N.b)(),b=z.competencyChallenge.data,ee=Object(f.useState)(!1),R=Object(F.a)(ee,2),te=R[0],_=R[1],se=Object(f.useState)(!1),be=Object(F.a)(se,2),Pe=be[0],ae=be[1],Oe=Object(f.useState)(),Ce=Object(F.a)(Oe,2),fe=Ce[0],me=Ce[1],Be=Object(o.l)(),A=Object(f.useCallback)(function(){return _(!0)},[]),U=Object(f.useCallback)(function(){(b==null?void 0:b.quiz_id)!==void 0&&(ae(!0),Object(oe.d)(b==null?void 0:b.quiz_id).then(function(Y){Y.success&&me(Y.data)}).finally(function(){return ae(!1)}))},[b==null?void 0:b.quiz_id]),ve=Object(f.useCallback)(function(){var Y=Object(I.a)(Object(w.a)().mark(function G(q){return Object(w.a)().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if((b==null?void 0:b.quiz_id)!==void 0){B.next=2;break}return B.abrupt("return");case 2:ae(!0),Object(oe.g)(b==null?void 0:b.quiz_id,Object(T.a)(Object(T.a)({},q),{},{value:"diagnostic-test"})).then(function(S){S.success&&me(S.data)}).finally(function(){return ae(!1)});case 4:case"end":return B.stop()}},G)}));return function(G){return Y.apply(this,arguments)}}(),[]);return Object(f.useEffect)(function(){U()},[U]),fe?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ct,{visible:te,onVisibleChange:_,quiz_id:fe.id}),Object(r.jsxs)("div",{style:{position:"relative",paddingBottom:"64px"},children:[Object(r.jsx)(y.a,{submitter:{render:function(G,q){var re=Object(F.a)(q,2),B=re[0],S=re[1];return Object(r.jsxs)(ze.b,{style:{position:"absolute",bottom:0,left:0},children:[B,S]})}},initialValues:fe,onFinish:ve,children:Object(r.jsxs)(Je.a,{children:[Object(r.jsx)(qe.a,{name:"max_attempts",label:Object(r.jsx)(o.a,{id:"max_attempts"}),tooltip:Object(r.jsx)(o.a,{id:"max_attempts"}),placeholder:Be.formatMessage({id:"max_attempts",defaultMessage:"max_attempts"})}),Object(r.jsx)(qe.a,{name:"max_execution_time",label:Object(r.jsx)(o.a,{id:"max_execution_time"}),tooltip:Object(r.jsx)(o.a,{id:"max_execution_time"}),placeholder:Be.formatMessage({id:"max_execution_time",defaultMessage:"max_execution_time"})})]})}),Object(r.jsx)(Ye.a,{}),Object(r.jsx)(st.a,{questions:fe.questions,quizId:fe.id,onAdded:U,onEdited:U,onRemoved:U,tableHeader:Object(r.jsx)(o.a,{id:"questions"}),tableLoading:Pe,questionsCategory:{type:"question"},customToolbarElements:[Object(r.jsxs)(k.a,{type:"primary",icon:Object(r.jsx)(Xe.a,{}),onClick:A,children:[" ",Object(r.jsx)(o.a,{id:"exportQuestionsByCategory"})]},"export_by_category")]})]})]}):Object(r.jsx)(J.a,{})},ot=function(){var z,b=Object(N.b)(),ee=b.competencyChallenge,R=Object(o.l)(),te=Object(X.l)(),_=te.id,se=te.tab,be=se===void 0?"main":se,Pe=_==="new",ae=Object(f.useMemo)(function(){var Oe;return Pe?R.formatMessage({id:"CompetencyChallenges.new_challenge"}):(Oe=ee.data)!==null&&Oe!==void 0&&Oe.name?ee.data.name:R.formatMessage({id:"menu.Competency challenges"})},[R,(z=ee.data)===null||z===void 0?void 0:z.name]);return Object(r.jsx)(De.a,{title:ae,header:{breadcrumb:{routes:[{path:"competency-challenges",breadcrumbName:R.formatMessage({id:"menu.Competency challenges"})},{path:String(_),breadcrumbName:ae},{path:be,breadcrumbName:R.formatMessage({id:"CompetencyChallenges.".concat(be)})}]}},children:Object(r.jsxs)(je.a,{bodyStyle:{padding:"24px"},tabs:{type:"card",cardProps:{loading:ee.loading&&Object(r.jsx)(J.a,{})},activeKey:be,onChange:function(Ce){o.f.push("/competency-challenges/".concat(_,"/").concat(Ce))}},children:[Object(r.jsx)(je.a.TabPane,{tab:Object(r.jsx)(o.a,{id:"CompetencyChallenges.main"}),children:Object(r.jsx)(Ue,{})},"main"),Object(r.jsx)(je.a.TabPane,{tab:Object(r.jsx)(o.a,{id:"CompetencyChallenges.scales"}),disabled:Pe,children:Object(r.jsx)(Le,{})},"scales"),Object(r.jsx)(je.a.TabPane,{tab:Object(r.jsx)(o.a,{id:"CompetencyChallenges.diagnostic-test"}),disabled:Pe,children:Object(r.jsx)(tt,{})},"diagnostic-test")]})})},$e=function(){return Object(r.jsx)(N.a,{children:Object(r.jsx)(ot,{})})},ut=V.default=$e},YRX9:function(He,V,t){"use strict";t.d(V,"f",function(){return X}),t.d(V,"e",function(){return je}),t.d(V,"a",function(){return w}),t.d(V,"g",function(){return L}),t.d(V,"c",function(){return T}),t.d(V,"b",function(){return F}),t.d(V,"h",function(){return W}),t.d(V,"d",function(){return ue});var M=t("qLMh"),J=t("k1fw"),f=t("9og8"),o=t("9kvl");function X(x,O){return De.apply(this,arguments)}function De(){return De=Object(f.a)(Object(M.a)().mark(function x(O,P){return Object(M.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(o.i)("/api/admin/competency-challenges",Object(J.a)({method:"GET",useCache:!1,params:O},P||{})));case 1:case"end":return d.stop()}},x)})),De.apply(this,arguments)}function je(x,O){return N.apply(this,arguments)}function N(){return N=Object(f.a)(Object(M.a)().mark(function x(O,P){return Object(M.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(o.i)("/api/admin/competency-challenges/".concat(O),Object(J.a)({method:"GET",useCache:!1},P||{})));case 1:case"end":return d.stop()}},x)})),N.apply(this,arguments)}function w(x,O){return Te.apply(this,arguments)}function Te(){return Te=Object(f.a)(Object(M.a)().mark(function x(O,P){return Object(M.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(o.i)("/api/admin/competency-challenges",Object(J.a)({method:"POST",headers:{"Content-Type":"application/json"},data:O},P||{})));case 1:case"end":return d.stop()}},x)})),Te.apply(this,arguments)}function L(x,O,P){return I.apply(this,arguments)}function I(){return I=Object(f.a)(Object(M.a)().mark(function x(O,P,Q){return Object(M.a)().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.abrupt("return",Object(o.i)("/api/admin/competency-challenges/".concat(O),Object(J.a)({method:"PUT",headers:{"Content-Type":"application/json"},data:P},Q||{})));case 1:case"end":return ne.stop()}},x)})),I.apply(this,arguments)}function T(x,O){return s.apply(this,arguments)}function s(){return s=Object(f.a)(Object(M.a)().mark(function x(O,P){return Object(M.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(o.i)("/api/admin/competency-challenges/".concat(O),Object(J.a)({method:"DELETE"},P||{})));case 1:case"end":return d.stop()}},x)})),s.apply(this,arguments)}function F(x,O){return y.apply(this,arguments)}function y(){return y=Object(f.a)(Object(M.a)().mark(function x(O,P){return Object(M.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(o.i)("/api/admin/competency-challenges/scales",Object(J.a)({method:"POST",headers:{"Content-Type":"application/json"},data:O},P||{})));case 1:case"end":return d.stop()}},x)})),y.apply(this,arguments)}function W(x,O,P){return K.apply(this,arguments)}function K(){return K=Object(f.a)(Object(M.a)().mark(function x(O,P,Q){return Object(M.a)().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return ne.abrupt("return",Object(o.i)("/api/admin/competency-challenges/scales/".concat(O),Object(J.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:P},Q||{})));case 1:case"end":return ne.stop()}},x)})),K.apply(this,arguments)}function ue(x,O){return Z.apply(this,arguments)}function Z(){return Z=Object(f.a)(Object(M.a)().mark(function x(O,P){return Object(M.a)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",Object(o.i)("/api/admin/competency-challenges/scales/".concat(O),Object(J.a)({method:"DELETE"},P||{})));case 1:case"end":return d.stop()}},x)})),Z.apply(this,arguments)}},enqX:function(He,V,t){"use strict";t.d(V,"a",function(){return I});var M=t("nRaC"),J=t("5RzL"),f=t("tJVT"),o=t("q1tI"),X=t.n(o),De=t("9kvl"),je=t("JifO"),N=t("tKSU"),w=t("nKUr"),Te=t.n(w),L=function T(s,F,y){var W,K=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return(W=s.subcategories)!==null&&W!==void 0&&W.length?{title:s.name,value:s.id,disabled:K!==y||F.includes(s.id),children:s.subcategories.map(function(ue){return T(ue,F,y,K+1)})}:{title:s.name,value:s.id,disabled:K!==y||F.includes(s.id)}},I=function(s){var F,y,W,K=s.value,ue=s.onChange,Z=s.type,x=Z===void 0?"scale":Z,O=s.disabledNodes,P=O===void 0?[]:O,Q=s.multiple,d=Q===void 0?!1:Q,ne=Object(o.useState)([]),r=Object(f.a)(ne,2),e=r[0],Qe=r[1],Ue=Object(N.b)(),Ve=Ue.categoryDepths,Ae=Ue.competencyChallenge,pe=Object(o.useMemo)(function(){var j;return((j=Ae.data)===null||j===void 0?void 0:j.type)==="simple"?e.filter(function(k){var Re,Ie;return k.id===((Re=Ae.data)===null||Re===void 0||(Ie=Re.category)===null||Ie===void 0?void 0:Ie.id)}):e},[e,(F=Ae.data)===null||F===void 0?void 0:F.type,(y=Ae.data)===null||y===void 0||(W=y.category)===null||W===void 0?void 0:W.id]),ge=Object(o.useMemo)(function(){return pe.map(function(j){return L(j,P,Ve[x])})},[pe,P,x]);return Object(o.useEffect)(function(){Object(je.c)().then(function(j){j.success&&Qe(j.data)})},[]),Object(w.jsx)(J.a,{loading:e.length===0,showSearch:!0,multiple:d,value:K,dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:Object(w.jsx)(De.a,{id:"select",defaultMessage:"Please select"}),allowClear:!0,treeDefaultExpandAll:!0,onChange:ue,treeData:ge,disabled:e.length===0})}},hd5d:function(He,V,t){"use strict";var M=t("qLMh"),J=t("9og8"),f=t("q1tI"),o=t.n(f),X=t("acco"),De=t.n(X),je=t("BAh9"),N=t("vtG9"),w=t.n(N),Te=t("9kvl"),L=t("nKUr"),I=t.n(L),T=function(y){var W=y.attrs,K=W.href,ue=K.split("/").pop();return Object(L.jsx)("p",{children:Object(L.jsx)("a",{rel:"noreferrer",href:K,target:"_blank",children:ue})})},s=function(y){var W=y.value,K=y.onChange,ue=y.directory,Z=ue===void 0?"/wysiwyg":ue,x=Object(Te.l)();return Object(L.jsx)("div",{className:"form-wysiwyg-markdown",children:Object(L.jsx)(De.a,{excludeBlockMenuItems:["Sketch"],embeds:[{matcher:function(P){return!0},component:T}],uploadImage:function(){var O=Object(J.a)(Object(M.a)().mark(function P(Q){var d,ne;return Object(M.a)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(je.e)(Q,Z);case 2:if(d=e.sent,!d.success){e.next=8;break}if(!Q.type.includes("image/")){e.next=7;break}return ne=d.data[0].name.includes("/")?d.data[0].name:"".concat(Z).concat(d.data[0].name),e.abrupt("return",Object(je.d)(ne,1e3));case 7:return e.abrupt("return",d.data[0].url);case 8:throw new Error("Error while uploading");case 9:case"end":return e.stop()}},P)}));return function(P){return O.apply(this,arguments)}}(),defaultValue:W||"",onChange:function(P){return K&&K(P())},placeholder:x.formatMessage({id:"wysiwyg_placeholder"})})})};V.a=s},tKSU:function(He,V,t){"use strict";t.d(V,"b",function(){return s}),t.d(V,"a",function(){return F});var M=t("k1fw"),J=t("tJVT"),f=t("qLMh"),o=t("9og8"),X=t("q1tI"),De=t.n(X),je=t("Ty5D"),N=t("YRX9"),w=t("+up7"),Te=t("nKUr"),L=t.n(Te),I={categoryDepths:{scale:2,question:1,role:0},competencyChallenge:{data:null,loading:!1},refreshData:function(){var y=Object(o.a)(Object(f.a)().mark(function K(){return Object(f.a)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",console.warn("CONTEXT INIT"));case 1:case"end":return Z.stop()}},K)}));function W(){return y.apply(this,arguments)}return W}()},T=De.a.createContext(I),s=function(){return Object(X.useContext)(T)},F=function(W){var K=W.children,ue=Object(X.useState)(I.competencyChallenge),Z=Object(J.a)(ue,2),x=Z[0],O=Z[1],P=Object(X.useState)(I.categoryDepths),Q=Object(J.a)(P,2),d=Q[0],ne=Q[1],r=Object(je.l)(),e=r.id,Qe=Number(e),Ue=Object(X.useCallback)(Object(o.a)(Object(f.a)().mark(function Ae(){var pe;return Object(f.a)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!Number.isNaN(Qe)){j.next=2;break}return j.abrupt("return");case 2:return j.prev=2,O(function(k){return Object(M.a)(Object(M.a)({},k),{},{loading:!0})}),j.next=6,Object(N.e)(Qe);case 6:if(pe=j.sent,pe.success){j.next=10;break}return O(function(k){return Object(M.a)(Object(M.a)({},k),{},{error:pe.errors})}),j.abrupt("return");case 10:O(function(k){return Object(M.a)(Object(M.a)({},k),{},{data:pe.data})}),j.next=16;break;case 13:j.prev=13,j.t0=j.catch(2),O(function(k){return Object(M.a)(Object(M.a)({},k),{},{error:j.t0})});case 16:return j.prev=16,O(function(k){return Object(M.a)(Object(M.a)({},k),{},{loading:!1})}),j.finish(16);case 19:case"end":return j.stop()}},Ae,null,[[2,13,16,19]])})),[Qe]),Ve=Object(X.useCallback)(Object(o.a)(Object(f.a)().mark(function Ae(){var pe,ge,j,k,Re,Ie,Ke,de,Ne,_e,Ge,Le,ke,Ye,et,ze,Je,qe,Xe;return Object(f.a)().wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.prev=0,oe.next=3,Object(w.a)();case 3:if(ze=oe.sent,ze.success){oe.next=6;break}return oe.abrupt("return");case 6:Je=Number((pe=ze.data)===null||pe===void 0||(ge=pe.escolalms_competency_challenge)===null||ge===void 0||(j=ge.category)===null||j===void 0||(k=j.scale)===null||k===void 0||(Re=k.depth)===null||Re===void 0?void 0:Re.value),qe=Number((Ie=ze.data)===null||Ie===void 0||(Ke=Ie.escolalms_competency_challenge)===null||Ke===void 0||(de=Ke.category)===null||de===void 0||(Ne=de.question)===null||Ne===void 0||(_e=Ne.depth)===null||_e===void 0?void 0:_e.value),Xe=Number((Ge=ze.data)===null||Ge===void 0||(Le=Ge.escolalms_competency_challenge)===null||Le===void 0||(ke=Le.category)===null||ke===void 0||(Ye=ke.role)===null||Ye===void 0||(et=Ye.depth)===null||et===void 0?void 0:et.value),ne({scale:Number.isNaN(Je)?2:Je,question:Number.isNaN(qe)?1:qe,role:Number.isNaN(Xe)?0:Xe}),oe.next=15;break;case 12:oe.prev=12,oe.t0=oe.catch(0),console.error(oe.t0);case 15:case"end":return oe.stop()}},Ae,null,[[0,12]])})),[]);return Object(X.useEffect)(function(){Ue(),Ve()},[Ue,Ve]),Object(Te.jsx)(T.Provider,{value:{categoryDepths:d,competencyChallenge:x,refreshData:Ue},children:K})}},vtG9:function(He,V,t){},yioT:function(He,V,t){"use strict";t.d(V,"a",function(){return Se});var M=t("miYZ"),J=t("tsqr"),f=t("+L6B"),o=t("2/Rp"),X=t("oBTY"),De=t("bbsP"),je=t("/wGt"),N=t("qLMh"),w=t("9og8"),Te=t("PpiC"),L=t("tJVT"),I=t("k1fw"),T=t("q1tI"),s=t("9kvl"),F=t("YJCA"),y=t("wYyv"),W=t("smpX"),K=t("eyie"),ue=t("w5pM"),Z=t("4KAj"),x=t("mWMg"),O=t("DBJ/"),P=t("Vpfc"),Q=t("qRSf"),d=t("VMEa"),ne=t("rmhi"),r=t("yj/a"),e=t("nKUr"),Qe=function(a){var n=a.quiz_id,i=a.quizQuestions,c=a.visible,v=a.onVisibleChange,m=d.a.useForm(),C=Object(L.a)(m,1),l=C[0],D=Object(s.l)(),g=Object(T.useCallback)(function(){var H=Object(w.a)(Object(N.a)().mark(function h(xe){var $,Ee,Me;return Object(N.a)().wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:return $=xe.ids,ie.prev=1,ie.next=4,Object(Q.c)({quiz_id:n,ids:$});case 4:Ee=ie.sent,Ee instanceof Blob&&(Me=document.createElement("a"),Me.href=window.URL.createObjectURL(Ee),Me.download="quiz_questions_".concat(n,".xlsx"),document.body.appendChild(Me),Me.click(),document.body.removeChild(Me)),ie.next=11;break;case 8:ie.prev=8,ie.t0=ie.catch(1),console.error(ie.t0);case 11:return ie.prev=11,v(!1),ie.finish(11);case 14:case"end":return ie.stop()}},h,null,[[1,8,11,14]])}));return function(h){return H.apply(this,arguments)}}(),[n]),E=Object(T.useMemo)(function(){return i.map(function(H){var h=H.id,xe=H.value;try{var $=Object(W.parse)(xe);if(!($!=null&&$[0])||!("stem"in $[0]))return{value:h,label:D.formatMessage({id:"ExportQuestions.questionTitle"},{id:h})};var Ee=$[0].stem.text;return{value:h,label:Ee}}catch(Me){return console.error(Me),{value:h,label:D.formatMessage({id:"ExportQuestions.questionTitle"},{id:h})}}})},[i]);return Object(e.jsx)(ne.a,{title:Object(e.jsx)(s.a,{id:"exportQuestions"}),form:l,visible:c,onVisibleChange:v,onFinish:g,children:Object(e.jsx)(r.a,{mode:"multiple",options:E,name:"ids",label:Object(e.jsx)(s.a,{id:"questions"}),required:!0,rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}]})})},Ue=t("DYRE"),Ve=t("zeV3"),Ae=t("/zsF"),pe=t("PArb"),ge=t("FJDo"),j=t("/y+f"),k=t("enqX"),Re=t("5Dmo"),Ie=t("3S7+"),Ke=t("jrin"),de=t("Qurx"),Ne=t("x1Ii"),_e=t("tneF"),Ge=t("/MfK"),Le,ke=(Le={},Object(Ke.a)(Le,j.e.MULTIPLE_CHOICE,[{isCorrect:!1,value:"",feedback:""},{isCorrect:!1,value:"",feedback:""}]),Object(Ke.a)(Le,j.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS,[{value:"",weight:""},{value:"",weight:""}]),Le),Ye=function(a){var n,i=a.type,c=Object(s.l)();return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(de.a,{name:"question",label:Object(e.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(e.jsx)(Ne.b,{name:"answers",creatorButtonProps:{creatorButtonText:c.formatMessage({id:"Questions.addAnswer"})},actionRender:function(){return[]},initialValue:(n=ke[i])!==null&&n!==void 0?n:[],children:function(m,C,l,D){return Object(e.jsxs)(d.a.Group,{title:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(s.a,{id:"Questions.answer",values:{ordinalNumber:C+1}}),D>2&&Object(e.jsx)(Ie.a,{title:c.formatMessage({id:"Questions.deleteAnswer"}),children:Object(e.jsx)(o.a,{type:"text",icon:Object(e.jsx)(Ge.a,{}),onClick:function(){return l.remove(m.name)}})})]}),titleStyle:{width:"100%",display:"flex",justifyContent:"space-between"},children:[i===j.e.MULTIPLE_CHOICE&&Object(e.jsx)(_e.a,{name:"isCorrect",label:Object(e.jsx)(s.a,{id:"Questions.correctAnswer",defaultMessage:"Is Correct Answer?"}),rules:[function(g){var E=g.getFieldValue;return{validator:function(){var h,xe=(h=E("answers"))!==null&&h!==void 0?h:[];return xe.filter(function($){return $==null?void 0:$.isCorrect}).length>1?Promise.reject("Only one answer can be correct"):Promise.resolve()},message:Object(e.jsx)(s.a,{id:"Questions.onlyOneAnswerIsCorrect"})}}]}),Object(e.jsx)(de.a,{name:"value",rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],label:Object(e.jsx)(s.a,{id:"content",defaultMessage:"Content"})}),i===j.e.MULTIPLE_CHOICE&&Object(e.jsx)(de.a,{name:"feedback",label:Object(e.jsx)(s.a,{id:"Questions.answerFeedback",defaultMessage:"Answer feedback"})}),i===j.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS&&Object(e.jsx)(ge.a,{name:"weight",rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],fieldProps:{min:-Number.MAX_SAFE_INTEGER,addonAfter:"%"},label:Object(e.jsx)(s.a,{id:"weight",defaultMessage:"Weight"})})]})}})]})},et=function(){return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(de.a,{name:"question",label:Object(e.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(e.jsx)(_e.a,{name:"isCorrect",label:Object(e.jsx)(s.a,{id:"Questions.correctAnswer"})})]})},ze=[{value:"",feedback:""}],Je=function(){var a=Object(s.l)();return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(de.a,{name:"question",label:Object(e.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(e.jsx)(Ne.b,{name:"answers",creatorButtonProps:{creatorButtonText:a.formatMessage({id:"Questions.addAnswer"})},actionRender:function(){return[]},initialValue:ze,children:function(i,c,v,m){return Object(e.jsxs)(d.a.Group,{title:Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(s.a,{id:"Questions.answer",values:{ordinalNumber:c+1}}),m>1&&Object(e.jsx)(Ie.a,{title:a.formatMessage({id:"Questions.deleteAnswer"}),children:Object(e.jsx)(o.a,{type:"text",icon:Object(e.jsx)(Ge.a,{}),onClick:function(){return v.remove(i.name)}})})]}),titleStyle:{width:"100%",display:"flex",justifyContent:"space-between"},children:[Object(e.jsx)(de.a,{name:"value",rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],label:Object(e.jsx)(s.a,{id:"content",defaultMessage:"Content"})}),Object(e.jsx)(de.a,{name:"feedback",label:Object(e.jsx)(s.a,{id:"Questions.answerFeedback",defaultMessage:"Answer feedback"})})]})}})]})},qe=[{firstOfPair:"",secondOfPair:""}],Xe=function(){var a=Object(s.l)();return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(de.a,{name:"question",label:Object(e.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(e.jsx)(Ne.b,{name:"answers",creatorButtonProps:{creatorButtonText:a.formatMessage({id:"Questions.addMatchingPair",defaultMessage:"Add Matching Pair"})},deleteIconProps:{tooltipText:a.formatMessage({id:"Questions.deletePair"})},actionRender:function(i,c,v){var m=Object(L.a)(v,2),C=m[1];return[C]},min:1,initialValue:qe,children:function(i,c){return Object(e.jsxs)(d.a.Group,{direction:"horizontal",align:"baseline",size:"small",spaceProps:{style:{flexWrap:"nowrap"}},title:Object(e.jsx)(s.a,{id:"Questions.pair",values:{ordinalNumber:c+1},defaultMessage:"Pair ".concat(c+1)}),children:[Object(e.jsx)(de.a,{name:"firstOfPair",rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}]}),Object(e.jsx)(de.a,{name:"secondOfPair",rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}]})]})}})]})},st=function(){return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(de.a,{name:"question",label:Object(e.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(e.jsx)(ge.a,{name:"answer",label:Object(e.jsx)(s.a,{id:"answer"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(e.jsx)(ge.a,{name:"errorMargin",fieldProps:{addonAfter:"+/-"},label:Object(e.jsx)(s.a,{id:"Questions.errorMargin"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],required:!0})]})},oe=t("BiO0"),it=function(){return Object(e.jsx)(oe.a,{name:"question",label:Object(e.jsx)(s.a,{id:"question"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],required:!0})},ct=function(a){var n=a.type;if(!n)return null;switch(n){case j.e.MULTIPLE_CHOICE:case j.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return Object(e.jsx)(Ye,{type:n});case j.e.TRUE_FALSE:return Object(e.jsx)(et,{});case j.e.SHORT_ANSWERS:return Object(e.jsx)(Je,{});case j.e.MATCHING:return Object(e.jsx)(Xe,{});case j.e.NUMERICAL_QUESTION:return Object(e.jsx)(st,{});case j.e.ESSAY:case j.e.DESCRIPTION:return Object(e.jsx)(it,{});default:return Object(e.jsxs)("pre",{children:["Unsupported type ",n]})}},tt=t("rAM+"),ot=["question"],$e=function(a){for(var n=["~","=","#","{","}",":"],i="",c=0;c<a.length;c++){var v=a[c];n.includes(v)?i+="\\".concat(v):i+=v}return i},ut=function(a){var n=a.question,i=a.answers;if(i.length===0)return"".concat(n,"{}");var c=i.map(function(h){var xe=h.isCorrect,$=h.value,Ee=h.feedback;return{isCorrect:xe,feedback:$e(Ee!=null?Ee:""),value:$e($)}}),v="".concat(n,"{"),m=Object(tt.a)(c),C;try{for(m.s();!(C=m.n()).done;){var l=C.value,D=l.isCorrect,g=l.value,E=l.feedback,H=D?"=":"~";v+=E?"".concat(H).concat(g,"#").concat(E):"".concat(H).concat(g)}}catch(h){m.e(h)}finally{m.f()}return v+="}",v.trim()},ye=function(a){var n=a.question,i=a.answers;if(i.length==0)return"".concat(n,"{}");var c="".concat(n,"{"),v=i.map(function(E){var H=E.weight,h=E.value;return{weight:H,value:$e(h)}}),m=Object(tt.a)(v),C;try{for(m.s();!(C=m.n()).done;){var l=C.value,D=l.value,g=l.weight;c+="~%".concat(g,"%").concat(D)}}catch(E){m.e(E)}finally{m.f()}return c+="}",c.trim()},z=function(a){var n=a.question,i=a.isCorrect;return"".concat(n,"{").concat(i?"T":"F","}")},b=function(a){var n=a.question,i=a.answers;if(i.length===0)return"".concat(n,"{}");var c="".concat(n,"{"),v=i.map(function(E){var H=E.value,h=E.feedback;return{value:$e(H),feedback:$e(h!=null?h:"")}}),m=Object(tt.a)(v),C;try{for(m.s();!(C=m.n()).done;){var l=C.value,D=l.value,g=l.feedback;c+=g?"=".concat(D,"#").concat(g):"=".concat(D)}}catch(E){m.e(E)}finally{m.f()}return c+="}",c.trim()},ee=function(a){var n=a.question,i=a.answers;if(i.length===0)return"".concat(n,"{}");var c="".concat(n,"{"),v=i.map(function(E){var H=E.firstOfPair,h=E.secondOfPair;return{firstOfPair:$e(H),secondOfPair:$e(h)}}),m=Object(tt.a)(v),C;try{for(m.s();!(C=m.n()).done;){var l=C.value,D=l.firstOfPair,g=l.secondOfPair;c+="=".concat(D,"->").concat(g)}}catch(E){m.e(E)}finally{m.f()}return c+="}",c.trim()},R=function(a){var n=a.question,i=a.answer,c=a.errorMargin;return"".concat(n,"{#").concat(i,":").concat(c,"}")},te=function(a){var n=a.question;return"".concat(n,"{}")},_=function(a){var n=a.question;return n},se=function(a){var n=a.question,i=Object(Te.a)(a,ot),c=Object(I.a)({question:$e(n)},i);switch(c.type){case j.e.MULTIPLE_CHOICE:return ut(c);case j.e.MULTIPLE_CHOICE_WITH_MULTIPLE_RIGHT_ANSWERS:return ye(c);case j.e.TRUE_FALSE:return z(c);case j.e.SHORT_ANSWERS:return b(c);case j.e.MATCHING:return ee(c);case j.e.NUMERICAL_QUESTION:return R(c);case j.e.ESSAY:return te(c);case j.e.DESCRIPTION:return _(c);default:throw new Error("Unsupported type: ".concat(c==null?void 0:c.type))}},be=function(a,n){var i=n.type,c=n.score,v=n.category_id,m=a==null?void 0:a.stem.text,C=a.choices.every(function(g){var E=g.weight;return E===null});if(C){var l=a.choices.map(function(g){var E=g.isCorrect,H=g.text,h=g.feedback;return{isCorrect:E,value:H.text,feedback:h==null?void 0:h.text}});return{type:i,score:c,category_id:v,question:m,answers:l}}var D=a.choices.reduce(function(g,E){var H=E.weight,h=E.text;return H!==null?[].concat(Object(X.a)(g),[{weight:H,value:h.text}]):g},[]);return{type:i,score:c,category_id:v,question:m,answers:D}},Pe=function(a,n){var i=n.type,c=n.score,v=n.category_id,m=a==null?void 0:a.stem.text,C=a.isTrue;return{type:i,score:c,category_id:v,question:m,isCorrect:C}},ae=function(a,n){var i=n.type,c=n.score,v=n.category_id,m=a==null?void 0:a.stem.text,C=a.choices.map(function(l){var D=l.text,g=l.feedback;return{value:D.text,feedback:g==null?void 0:g.text}});return{type:i,score:c,category_id:v,question:m,answers:C}},Oe=function(a,n){var i=n.type,c=n.score,v=n.category_id,m=a==null?void 0:a.stem.text,C=a.matchPairs.map(function(l){var D=l.subquestion,g=l.subanswer;return{firstOfPair:D.text,secondOfPair:g}});return{type:i,score:c,category_id:v,question:m,answers:C}},Ce=function(a,n){var i=n.type,c=n.score,v=n.category_id,m=a==null?void 0:a.stem.text;if(Array.isArray(a==null?void 0:a.choices))throw new Error("Unsupported choices type: array");var C=a==null?void 0:a.choices.number,l=a==null?void 0:a.choices.range;if(C===void 0||l===void 0)throw new Error("Value undefined - answer: ".concat(C," errorMargin: ").concat(l));return{type:i,score:c,category_id:v,question:m,answer:C,errorMargin:l}},fe=function(a,n){var i=n.type,c=n.score,v=n.category_id,m=a==null?void 0:a.stem.text;return{type:i,score:c,category_id:v,question:m}};function me(u){if(!!u)try{var a=Object(W.parse)(u.value),n=Object(L.a)(a,1),i=n[0];switch(i.type){case"MC":return be(i,u);case"TF":return Pe(i,u);case"Short":return ae(i,u);case"Matching":return Oe(i,u);case"Numerical":return Ce(i,u);case"Description":case"Essay":return fe(i,u);default:throw new Error("Unsupported type: ".concat(i==null?void 0:i.type))}}catch(c){console.error(c);return}}var Be=["type","score","category"],A=Object.values(j.e).reduce(function(u,a){return a?[].concat(Object(X.a)(u),[{value:a,label:Object(e.jsx)(s.a,{id:"gift_type.".concat(a)})}]):u},[]),U=function(a){var n=a.onSubmit,i=a.values,c=a.competencyChallengeCategoryTreeProps,v=c===void 0?!1:c,m=Object(s.l)(),C=d.a.useForm(),l=Object(L.a)(C,1),D=l[0],g=d.a.useWatch("type",D),E=Object(T.useMemo)(function(){return me(i)},[i]),H=Object(T.useCallback)(function(){var h=Object(w.a)(Object(N.a)().mark(function xe($){var Ee,Me,rt,ie;return Object(N.a)().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return Ee=se($),Me=$.score,rt=$.category_id,we.next=4,n({value:Ee,score:Me,category_id:rt});case 4:if(ie=we.sent,ie){we.next=7;break}return we.abrupt("return");case 7:D.resetFields();case 8:case"end":return we.stop()}},xe)}));return function(xe){return h.apply(this,arguments)}}(),[]);return Object(T.useEffect)(function(){D.resetFields()},[E]),Object(T.useEffect)(function(){if(g){var h=D.getFieldsValue(),xe=Object.keys(h).filter(function($){return!Be.includes($)});D.resetFields(xe)}},[g]),Object(e.jsxs)(Ve.b,{direction:"vertical",style:{display:"flex"},children:[Object(e.jsx)(pe.a,{children:Object(e.jsx)(s.a,{id:E?"Questions.edit":"addNewQuestion"})}),Object(e.jsxs)(d.a,{layout:"horizontal",form:D,onFinish:H,initialValues:E,children:[Object(e.jsx)(r.a,{name:"type",placeholder:m.formatMessage({id:"selectNewQuestionType",defaultMessage:"Select new question type"}),label:Object(e.jsx)(s.a,{id:"type",defaultMessage:"Type:"}),options:A,rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],required:!0}),Object(e.jsx)(ct,{type:g}),Object(e.jsx)(ge.a,{name:"score",label:Object(e.jsx)(s.a,{id:"Questions.score",defaultMessage:"Score"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}]}),v&&Object(e.jsx)(d.a.Item,{name:"category_id",label:Object(e.jsx)(s.a,{id:"category",defaultMessage:"Category"}),rules:[{required:!0,message:Object(e.jsx)(s.a,{id:"field_required"})}],required:!0,children:Object(e.jsx)(k.a,Object(I.a)({},typeof v=="object"?v:{}))})]})]})},ve=t("60mZ"),Y=["className","style"],G=Object(F.c)(function(){return Object(e.jsx)(K.a,{style:{cursor:"grab",color:"#999"}})}),q=Object(F.b)(function(u){return Object(e.jsx)("tr",Object(I.a)({},u))}),re=Object(F.a)(function(u){return Object(e.jsx)("tbody",Object(I.a)({},u))}),B=[{title:Object(e.jsx)(s.a,{id:"sort",defaultMessage:"sort"}),dataIndex:"id",width:60,className:"drag-visible",render:function(){return Object(e.jsx)(G,{})}},{title:Object(e.jsx)(s.a,{id:"type",defaultMessage:"Type"}),dataIndex:"type",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,n){return Object(e.jsx)(s.a,{id:"gift_type.".concat(n.type)})}},{title:Object(e.jsx)(s.a,{id:"question",defaultMessage:"Question"}),dataIndex:"question",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,n){try{var i=Object(W.parse)(n.value);return i!=null&&i[0]&&"stem"in i[0]?i[0].stem.text:"question"}catch(c){return console.error(c),"question"}}}],S={title:Object(e.jsx)(s.a,{id:"category",defaultMessage:"Category"}),dataIndex:"category_id",hideInForm:!0,hideInSearch:!0,hideInSetting:!0,render:function(a,n){return typeof n.category_id=="number"?Object(e.jsx)(P.a,{type:"Category",type_id:n.category_id}):"-"}},Se=function(a){var n=a.questions,i=a.onAdded,c=a.onRemoved,v=a.onEdited,m=a.quizId,C=a.tableLoading,l=a.tableHeader,D=a.questionsCategory,g=a.customToolbarElements,E=g===void 0?[]:g,H=Object(T.useState)(!1),h=Object(L.a)(H,2),xe=h[0],$=h[1],Ee=Object(T.useState)(!1),Me=Object(L.a)(Ee,2),rt=Me[0],ie=Me[1],dt=Object(T.useState)(),we=Object(L.a)(dt,2),We=we[0],lt=we[1],Ot=Object(T.useState)(!1),mt=Object(L.a)(Ot,2),ft=mt[0],jt=mt[1],ht=Object(T.useState)(n),vt=Object(L.a)(ht,2),nt=vt[0],bt=vt[1],pt=Object(s.l)(),gt=Object(T.useRef)();Object(T.useEffect)(function(){var he;(he=gt.current)===null||he===void 0||he.reload(),bt(n)},[n]);var yt=function(ce){var le=ce.oldIndex,Fe=ce.newIndex;if(le!==Fe){var Ze=Object(y.a)(nt.slice(),le,Fe).filter(Boolean).map(function(p,at){return Object(I.a)(Object(I.a)({},p),{},{order:at})});Ze.forEach(function(p,at){p.id!==nt[at].id&&Object(Q.h)(p.id,Object(I.a)(Object(I.a)({},p),{},{order:at+1,topic_gift_quiz_id:m}))}),bt(Ze)}},Ct=function(ce){return Object(e.jsx)(re,Object(I.a)({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:yt},ce))},xt=function(ce){var le=ce.className,Fe=ce.style,Ze=Object(Te.a)(ce,Y),p=nt.findIndex(function(at){return at.id===Ze["data-row-key"]});return Object(e.jsx)(q,Object(I.a)({index:p},Ze))},Et=Object(T.useCallback)(function(){var he=Object(w.a)(Object(N.a)().mark(function ce(le){var Fe;return Object(N.a)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,$(!0),p.next=4,Object(Q.a)(Object(I.a)({topic_gift_quiz_id:m},le));case 4:return Fe=p.sent,ie(!1),i==null||i(),p.abrupt("return",Fe.success);case 10:return p.prev=10,p.t0=p.catch(0),console.log(p.t0),p.abrupt("return",!1);case 14:return p.prev=14,$(!1),p.finish(14);case 17:case"end":return p.stop()}},ce,null,[[0,10,14,17]])}));return function(ce){return he.apply(this,arguments)}}(),[m]),Mt=Object(T.useCallback)(function(){var he=Object(w.a)(Object(N.a)().mark(function ce(le){var Fe;return Object(N.a)().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if((We==null?void 0:We.id)!==void 0){p.next=2;break}return p.abrupt("return",!1);case 2:return p.prev=2,$(!0),p.next=6,Object(Q.h)(We.id,Object(I.a)({topic_gift_quiz_id:m},le));case 6:return Fe=p.sent,lt(void 0),v==null||v(),p.abrupt("return",Fe.success);case 12:return p.prev=12,p.t0=p.catch(2),console.log(p.t0),p.abrupt("return",!1);case 16:return p.prev=16,$(!1),p.finish(16);case 19:case"end":return p.stop()}},ce,null,[[2,12,16,19]])}));return function(ce){return he.apply(this,arguments)}}(),[We==null?void 0:We.id,m]);return Object(e.jsxs)(e.Fragment,{children:[Object(e.jsx)(je.a,{open:rt,onClose:function(){return ie(!1)},children:Object(e.jsx)(U,{onSubmit:Et,competencyChallengeCategoryTreeProps:D})}),Object(e.jsx)(je.a,{open:!!We,onClose:function(){return lt(void 0)},destroyOnClose:!0,children:Object(e.jsx)(U,{onSubmit:Mt,competencyChallengeCategoryTreeProps:D,values:We})}),Object(e.jsx)(Qe,{quiz_id:m,quizQuestions:nt,visible:ft,onVisibleChange:jt}),Object(e.jsx)(x.a,{search:!1,cardProps:{bodyStyle:{padding:0}},loading:C,headerTitle:l,toolbar:{settings:[]},toolBarRender:function(){return[Object(e.jsxs)(o.a,{icon:Object(e.jsx)(ue.a,{}),type:"primary",onClick:function(){return ie(!0)},children:[" ",Object(e.jsx)(s.a,{id:"addNewQuestion",defaultMessage:"Add new question"})]},"add"),Object(e.jsx)(O.a,{title:pt.formatMessage({id:"importQuestions"}),hideLabel:!0,showUploadList:!1,url:"/api/admin/gift-questions/import",name:"file",accept:".xlsx",data:{topic_gift_quiz_id:m},onChange:function(le){le.file.status==="done"&&le.file.response&&le.file.response.success&&(J.b.success(le.file.response.message),i==null||i()),le.file.response&&le.file.status==="error"&&(J.b.error(le.file.response.message),console.error(le.file.response))}},"import"),Object(e.jsxs)(o.a,{icon:Object(e.jsx)(Z.a,{}),type:"primary",onClick:function(){return jt(!0)},children:[" ",Object(e.jsx)(s.a,{id:"exportQuestions"})]},"export")].concat(Object(X.a)(E))},columns:[].concat(B,Object(X.a)(D?[S]:[]),[{title:Object(e.jsx)(s.a,{id:"actions",defaultMessage:"Actions"}),dataIndex:"address",valueType:"option",render:function(ce,le){return[Object(e.jsx)(o.a,{size:"small",type:"primary",onClick:function(){lt(le)},children:Object(e.jsx)(s.a,{id:"Questions.edit",defaultMessage:"Edit Question"})},"edit"),Object(e.jsx)(o.a,{loading:xe,size:"small",danger:!0,onClick:function(){$(!0),Object(Q.b)(le.id).then(function(){c&&c()}).finally(function(){$(!1)})},children:Object(e.jsx)(s.a,{id:"Questions.delete",defaultMessage:"Delete Question"})},"delete")]}}]),rowKey:function(ce){return ce.id},pagination:!1,dataSource:nt,components:{body:{wrapper:Ct,row:xt}}})]})}}}]);

//# sourceMappingURL=p__CompetencyChallenges__form.6a5039f7.async.js.map