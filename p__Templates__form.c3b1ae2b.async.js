(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{10:function(J,S){},"1f8b":function(J,S,i){},8:function(J,S){},9:function(J,S){},BOG6:function(J,S,i){"use strict";i.r(S);var $=i("DYRE"),G=i("zeV3"),Ae=i("tU7J"),k=i("wFql"),Y=i("+BJd"),oe=i("mr32"),ce=i("/zsF"),te=i("PArb"),se=i("T2oS"),ve=i("W9HT"),le=i("miYZ"),me=i("tsqr"),K=i("9og8"),N=i("tJVT"),H=i("oBTY"),z=i("jrin"),C=i("k1fw"),he=i("WmNS"),P=i.n(he),c=i("q1tI"),h=i.n(c),E=i("VMEa"),I=i("Qurx"),p=i("yj/a"),_=i("tneF"),Ue=i("nhC9"),ae=i("rWUb"),$e=i("tMyG"),Gt=i("fOrg"),Te=i("+KLJ"),Ht=i("+L6B"),R=i("2/Rp"),y=i("9kvl"),e=i("nKUr"),Ge=function(r){var t=r.disabled,a=t===void 0?!1:t,n=r.id,l=r.onPreviewData,u=Object(c.useState)({state:"ready"}),b=Object(N.a)(u,2),d=b[0],j=b[1],m=Object(c.useCallback)(function(){j({state:"loading"}),Object(ae.c)(n).then(function(o){o.success?(l&&l(o.data),o.data.sent&&o.data.to?j({state:"loaded",data:o.data,message:"email sent to ".concat(o.data.to)}):o.data.url?j({state:"loaded",data:o.data,message:Object(e.jsxs)(h.a.Fragment,{children:["Download"," ",Object(e.jsx)("a",{target:"_blank",href:o.data.url,children:o.data.filename})]})}):j({state:"loaded",data:o.data,message:o.message})):j({state:"error",error:o.message})}).catch(function(){j({state:"error",error:"error"})})},[n]);return Object(e.jsxs)(h.a.Fragment,{children:[Object(e.jsx)(R.a,{type:"primary",loading:d.state==="loading",disabled:a,onClick:m,children:Object(e.jsx)(y.a,{id:"preview"})}),d.state==="loaded"&&Object(e.jsx)(Te.a,{message:d.message,type:"success",closable:!0,onClose:function(){return j({state:"ready"})}}),d.state==="error"&&Object(e.jsx)(Te.a,{message:d.error,type:"error",closable:!0,onClose:function(){return j({state:"ready"})}})]})},He=Ge,Je=i("Ty5D"),fe=i("BiO0"),Jt=i("14J3"),W=i("BMrR"),Kt=i("jCWc"),x=i("kPKH"),ue=i("QDO1"),A=i("LvDl"),ke=i("i680"),zt=i("ZEwP"),Ke=function(r){var t=r.svgDef,a=r.width,n=r.height;return Object(c.useEffect)(function(){var l=new ke.e("l","px",[a,n]),u=new DOMParser,b=u.parseFromString(t,"image/svg+xml"),d=b.documentElement.querySelector("rect");d&&(d.setAttribute("width",a+"px"),d.setAttribute("height",n+"px")),l.svg(b.documentElement).then(function(){l.save("myPDF.pdf")})},[t]),Object(e.jsx)("div",{})},ze=function(r){var t=r.initialValue,a=r.width,n=a===void 0?842:a,l=r.height,u=l===void 0?592:l,b=r.onRendered,d=Object(ue.b)(),j=d.onReady,m=function(g){if(t)try{var f=JSON.parse(t);g.loadFromJSON(f,function(){var O=g.toSVG(),v=new ke.e("l","px",[n,u]),ie=new DOMParser,B=ie.parseFromString(O,"image/svg+xml");v.svg(B.documentElement).then(function(){v.save("myPDF.pdf"),b()})})}catch(O){}j(g)};return Object(e.jsx)("div",{className:"fakeA4",style:{width:n,height:u},children:Object(e.jsx)(ue.a,{className:"fakeA4-canvas",onReady:m})})},Qe=Ke,Ye=i("fWQN"),Ze=i("mtLc"),ge=i("epSk"),Xe=/^rgb\((((((((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5]),\s?)){2}|((((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5])\s)){2})((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5]))|((((([1-9]?\d(\.\d+)?)|100|(\.\d+))%,\s?){2}|((([1-9]?\d(\.\d+)?)|100|(\.\d+))%\s){2})(([1-9]?\d(\.\d+)?)|100|(\.\d+))%))\)$/i,qe=/^rgba\((((((((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5]),\s?)){3})|(((([1-9]?\d(\.\d+)?)|100|(\.\d+))%,\s?){3}))|(((((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5])\s){3})|(((([1-9]?\d(\.\d+)?)|100|(\.\d+))%\s){3}))\/\s)((0?\.\d+)|[01]|(([1-9]?\d(\.\d+)?)|100|(\.\d+))%)\)$/i,Pe=function(r){return Object(A.isString)(r)&&Xe.test(r)},Ie=function(r){return Object(A.isString)(r)&&qe.test(r)};function _e(s){if(!Pe(s))return s;var r=function(n){var l=n.indexOf(",")>-1?",":" ";return n.substr(4).split(")")[0].split(l)},t=function(n){var l=n.indexOf("%")>-1?Math.round(+n.substr(0,n.length-1)/100*255).toString(16):(+n).toString(16);return l.length===1?"0"+l:l};return"#"+r(s).map(t).join("")}function et(s){if(!Ie(s))return s;var r=function(n){var l=n.indexOf(",")>-1?",":" ",u=n.substr(5).split(")")[0].split(l);return u.indexOf("/")>-1&&u.splice(3,1),u},t=function(n,l){var u=n.substr(0,n.length-1)/100,b=n.indexOf("%")>-1||l===3?Math.round(u*255).toString(16):(+n).toString(16);return b.length===1?"0"+b:b};return"#"+r(s).map(t).join("")}function Be(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Object(A.isString)(s)?Pe(s)?_e(s):Ie(s)?et(s):s:s}var Oe=function(r){return!!r.getSelectionStyles&&!!r.isEditing},de=function(r){if(Object(A.isString)(r)){if(r==="false")return!1;if(r==="true")return!0;if(!Object(A.isNaN)(r))return!!+r}return!!r},pe=function(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"#ffffff00",a=Be(r);return Object(A.isString)(a)?a===""?t:a:t},tt=function(r){return r==="text"||r==="i-text"||r==="textbox"},at=["fontFamily","fontSize","lineHeight","textAlign","bold","italic","underline","linethrough","overline","fill","textBackgroundColor","backgroundColor","opacity","stroke","strokeWidth","text"],we=["fontFamily","fontSize","bold","fontWeight","italic","fontStyle","underline","linethrough","overline","fill","textBackgroundColor","stroke","strokeWidth"],rt=["Arial","Times New Roman","Helvetica","Myriad Pro","Delicious","Verdana","Georgia","Courier","Comic Sans MS","Impact","Monaco","Optima","Hoefler Text","Plaster","Engagement"],nt=["Left","Center","Right","Justify"],it=Object(H.a)(Array(120)).map(function(s,r){return r+1}),ot=Object(H.a)(Array(6)).map(function(s,r){return r}),ct=Object(H.a)(Array(15)).map(function(s,r){return r}),st=Object(H.a)(Array(15)).map(function(s,r){return r}),lt=Object(H.a)(Array(6)).map(function(s,r){return r}),ut=function(){function s(r){Object(Ye.a)(this,s),this.editor=void 0,this.editor=r}return Object(Ze.a)(s,[{key:"canvas",get:function(){return this.editor.canvas}},{key:"activeObject",get:function(){return this.editor.canvas.getActiveObject()}},{key:"addIText",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"sample itext",a=new ge.fabric.IText(t);this.canvas.add(a)}},{key:"addTextbox",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"sample itextbox",a=new ge.fabric.Textbox(t);this.canvas.add(a)}},{key:"addVariable",value:function(t){if(this.activeObject&&tt(this.activeObject.type)&&Oe(this.activeObject)){var a=this.getForActive("text"),n=this.activeObject.selectionEnd||a.length-1;this.setForActive("text","".concat(a.substring(0,n)," ").concat(t," ").concat(a.substring(n)));return}this.addTextbox(t)}},{key:"addCircle",value:function(){this.editor.addCircle()}},{key:"addRectangle",value:function(){this.editor.addRectangle()}},{key:"addLine",value:function(){this.editor.addLine()}},{key:"addFile",value:function(t){var a=this;ge.fabric.Image.fromURL(t,function(n){n.set({left:0,top:0});var l=(a.canvas.width||1)/(n.width||1),u=(a.canvas.height||1)/(n.height||1),b=Math.min(l,u);b<1&&n.scale(b),a.canvas.add(n)})}},{key:"getEditorBackgroundColor",value:function(){return pe(this.canvas.backgroundColor)}},{key:"setEditorBackgroundColor",value:function(t){var a=this;return this.canvas.setBackgroundColor(pe(t,""),function(){a.canvas.requestRenderAll()})}},{key:"deleteAll",value:function(){var t=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.canvas.getObjects().forEach(function(n){return t.canvas.remove(n)}),this.canvas.discardActiveObject(),a&&this.setEditorBackgroundColor("#ffffff00"),this.canvas.requestRenderAll()}},{key:"deleteSelected",value:function(){var t=this;this.canvas.getActiveObjects().forEach(function(a){return t.canvas.remove(a)}),this.canvas.discardActiveObject(),this.canvas.requestRenderAll()}},{key:"getForActive",value:function(t){switch(t){case"opacity":return this.getOpacity();case"textAlign":return this.getTextAlign();case"fontFamily":return this.getFontFamily();case"fill":case"stroke":case"backgroundColor":case"textBackgroundColor":return this.getColorProp(t);case"bold":return this.getBold();case"italic":return this.getItalic();case"underline":case"linethrough":case"overline":return this.getBoolean(t);case"strokeWidth":case"fontSize":case"lineHeight":return this.getProp(t);default:return this.getProp(t)}}},{key:"setForActive",value:function(t,a){switch(t){case"opacity":return this.setOpacity(a);case"textAlign":case"fontFamily":return this.setLowerCaseProp(t,a);case"strokeWidth":case"fontSize":return this.setIntProp(t,a);case"lineHeight":return this.setFloatProp(t,a);case"fill":case"stroke":case"backgroundColor":case"textBackgroundColor":return this.setColorProp(t,a);case"bold":return this.setBold(a);case"italic":return this.setItalic(a);case"underline":case"linethrough":case"overline":return this.setBoolean(t,a);default:return this.setProp(t,a)}}},{key:"getProp",value:function(t){var a,n,l,u,b,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.activeObject;return d?!we.includes(t)||!Oe(d)||!d.getSelectionStyles().length?(a=d[t])!==null&&a!==void 0?a:"":(n=(l=(u=d.getSelectionStyles())===null||u===void 0||(b=u[0])===null||b===void 0?void 0:b[t])!==null&&l!==void 0?l:d[t])!==null&&n!==void 0?n:"":""}},{key:"setProp",value:function(t,a){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.activeObject;!n||(!we.includes(t)||!Oe(n)||!n.getSelectionStyles().length?n.set(t,a):n.setSelectionStyles(Object(z.a)({},t,a)),this.canvas.requestRenderAll())}},{key:"setIntProp",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(Object(A.isString)(a)&&!Object(A.isNaN)(a)||Object(A.isNumber)(a))return this.setProp(t,parseInt(a+"",10));console.error("".concat(a," is not ").concat(t," value"))}},{key:"setFloatProp",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(Object(A.isString)(a)&&!Object(A.isNaN)(a)||Object(A.isNumber)(a))return this.setProp(t,parseFloat(a+""));console.error("".concat(a," is not ").concat(t," value"))}},{key:"getBoolean",value:function(t){return de(this.getProp(t))}},{key:"setBoolean",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.setProp(t,de(a))}},{key:"setLowerCaseProp",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(Object(A.isString)(a))return this.setProp(t,a.toLowerCase());console.error("".concat(a," is not ").concat(t," value"))}},{key:"getColorProp",value:function(t,a){return pe(this.getProp(t),a)}},{key:"setColorProp",value:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.setProp(t,Be(a))}},{key:"getOpacity",value:function(){return+this.getProp("opacity")*100}},{key:"setOpacity",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"100";if(Object(A.isString)(t)&&!Object(A.isNaN)(t)||Object(A.isNumber)(t))return this.setProp("opacity",+t/100);console.error("".concat(t," is not opacity value"))}},{key:"getTextAlign",value:function(){var t=this.getProp("textAlign").toLowerCase();return t===""?"left":t}},{key:"getFontFamily",value:function(){return this.getProp("fontFamily").toLowerCase()}},{key:"getBold",value:function(){return this.getProp("fontWeight")==="bold"}},{key:"setBold",value:function(t){this.setProp("fontWeight",de(t)?"bold":"")}},{key:"getItalic",value:function(){return this.getProp("fontStyle")==="italic"}},{key:"setItalic",value:function(t){this.setProp("fontStyle",de(t)?"italic":"")}}]),s}(),Qt=i("P2fV"),Re=i("NJEC"),Ne=i("Lyp1"),Yt=i("5NDa"),D=i("5rEg"),Zt=i("y8nQ"),xe=i("Vl3Y"),Xt=i("1f8b"),De=function(r){return Object(A.toNumber)(r)===1?"":("0"+ +r*100).slice(-2)},dt=function(r){var t=r.className,a=t===void 0?"":t,n=r.name,l=r.value,u=r.onChange,b=r.label,d=r.style,j=Object(c.useMemo)(function(){return l&&l.length===9?[l.substring(0,7),+l.substring(7,9)/100]:[l,1]},[l]),m=Object(N.a)(j,2),o=m[0],g=m[1],f=Object(c.useCallback)(function(v){u(v.currentTarget.value+De(g))},[u,g]),O=Object(c.useCallback)(function(v){u(o+De(v.currentTarget.value))},[u,o]);return Object(e.jsx)("div",{className:"input-color ".concat(a),style:d,children:Object(e.jsx)(xe.a.Item,{label:b,children:Object(e.jsxs)(D.a.Group,{className:"input-color__container",size:"small",children:[Object(e.jsx)(D.a,{className:"input-color__color",name:n,value:o,onChange:f,type:"color"}),Object(e.jsx)(D.a,{className:"input-color__opacity",name:n+"Alpha",value:g,onChange:O,type:"range",min:"0",max:"1",step:"0.1"})]})})})},Q=dt,ye=i("PpiC"),bt=function(r){var t=r.value,a=r.onChange,n=r.label,l=r.name,u=r.type,b=u===void 0?"text":u,d=r.style,j=Object(ye.a)(r,["value","onChange","label","name","type","style"]),m=Object(c.useCallback)(function(o){a(o.currentTarget.value)},[a]);return Object(e.jsx)(xe.a.Item,{label:n,children:Object(e.jsx)(D.a,Object(C.a)({name:l,value:t,onChange:m,type:b,style:d},j))})},re=bt,qt=i("OaEy"),Le=i("2fM7"),jt=Le.a.Option,vt=function(r){var t=r.value,a=r.onChange,n=r.label,l=r.name,u=r.options,b=u===void 0?[]:u,d=r.style,j=Object(ye.a)(r,["value","onChange","label","name","options","style"]);return Object(e.jsx)(xe.a.Item,{label:n,children:Object(e.jsx)(Le.a,Object(C.a)(Object(C.a)({value:t,onChange:a,style:d},j),{},{children:b.map(function(m){return Object(e.jsx)(jt,{value:m.value,children:m.label},m.value)})}))})},q=vt,_t=i("sRBo"),mt=i("kaz8"),ht=function(r){var t=r.value,a=r.onChange,n=r.label,l=r.name,u=Object(ye.a)(r,["value","onChange","label","name"]),b=Object(c.useCallback)(function(d){a(d.target.checked)},[a]);return Object(e.jsx)(mt.a,Object(C.a)(Object(C.a)({name:l,value:t,checked:t,onChange:b},u),{},{children:n}))},ne=ht,ft=function(r){var t=r.values,a=r.onChange;return Object(e.jsxs)("div",{className:"fabric-editor__form fabric-editor__form--active-element",children:[Object(e.jsx)("h3",{className:"fabric-editor__form-title",children:"Text options"}),Object(e.jsxs)(W.a,{gutter:5,children:[Object(e.jsxs)(x.a,{children:[Object(e.jsxs)(W.a,{gutter:5,children:[Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(q,{value:t.fontFamily,onChange:a("fontFamily"),label:"Font Family",name:"fontFamily",options:rt.map(function(n){return{value:n.toLowerCase(),label:n}}),style:{minWidth:"180px"}}),Object(e.jsx)(q,{value:t.fontSize,onChange:a("fontSize"),label:"Font Size",name:"fontSize",options:it.map(function(n){return{value:n,label:""+n}}),style:{minWidth:"75px"}})]})}),Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(q,{value:t.textAlign,onChange:a("textAlign"),label:"Text align",name:"textAlign",options:nt.map(function(n){return{value:n.toLowerCase(),label:n}}),style:{minWidth:"180px"}}),Object(e.jsx)(re,{value:t.lineHeight,onChange:a("lineHeight"),label:"Line height",name:"lineHeight",type:"number",min:"0",max:"10",step:"0.1",style:{minWidth:"75px"}})]})})]}),Object(e.jsx)(D.a.Group,{style:{marginBottom:"15px"},children:Object(e.jsxs)(W.a,{gutter:5,children:[Object(e.jsx)(x.a,{children:Object(e.jsx)(ne,{value:t.bold,onChange:a("bold"),label:"Bold",name:"bold"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(ne,{value:t.italic,onChange:a("italic"),label:"Italic",name:"italic"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(ne,{value:t.underline,onChange:a("underline"),label:"Underline",name:"underline"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(ne,{value:t.linethrough,onChange:a("linethrough"),label:"Linethrough",name:"linethrough"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(ne,{value:t.overline,onChange:a("overline"),label:"Overline",name:"overline"})})]})})]}),Object(e.jsxs)(x.a,{children:[Object(e.jsx)(D.a.Group,{children:Object(e.jsxs)(W.a,{gutter:10,children:[Object(e.jsx)(x.a,{children:Object(e.jsx)(Q,{value:t.fill,onChange:a("fill"),label:"Text Color",name:"fill"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(Q,{value:t.textBackgroundColor,onChange:a("textBackgroundColor"),label:"Background text color",name:"textBackgroundColor"})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(Q,{value:t.backgroundColor,onChange:a("backgroundColor"),label:"Background color",name:"backgroundColor"})})]})}),Object(e.jsxs)(W.a,{gutter:10,children:[Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(Q,{value:t.stroke,onChange:a("stroke"),label:"Stroke color",name:"stroke"}),Object(e.jsx)(q,{value:t.strokeWidth,onChange:a("strokeWidth"),label:"Stroke width",name:"strokeWidth",options:ot.map(function(n){return{value:n,label:""+n}}),style:{minWidth:"65px"}})]})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(re,{value:t.opacity,onChange:a("opacity"),label:"Opacity",name:"opacity",type:"range"})})]})]})]})]})},gt=ft,Ot=function(r){var t=r.values,a=r.onChange;return Object(e.jsxs)("div",{className:"fabric-editor__form fabric-editor__form--active-element",children:[Object(e.jsx)("h3",{className:"fabric-editor__form-title",children:"Object options"}),Object(e.jsxs)(W.a,{gutter:20,children:[Object(e.jsx)(x.a,{children:Object(e.jsx)(Q,{value:t.fill,onChange:a("fill"),label:"Object Background Color",name:"fill"})}),Object(e.jsx)(x.a,{children:Object(e.jsxs)(W.a,{gutter:10,children:[Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(Q,{value:t.stroke,onChange:a("stroke"),label:"Stroke color",name:"stroke"}),Object(e.jsx)(q,{value:t.strokeWidth,onChange:a("strokeWidth"),label:"Stroke width",name:"strokeWidth",options:lt.map(function(n){return{value:n,label:""+n}}),style:{minWidth:"65px"}})]})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(re,{value:t.opacity,onChange:a("opacity"),label:"Opacity",name:"opacity",type:"range"})})]})})]})]})},pt=Ot,xt=function(r){var t=r.values,a=r.onChange;return Object(e.jsxs)("div",{className:"fabric-editor__form fabric-editor__form--active-element",children:[Object(e.jsx)("h3",{className:"fabric-editor__form-title",children:"Image options"}),Object(e.jsxs)(W.a,{gutter:10,children:[Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(Q,{value:t.stroke,onChange:a("stroke"),label:"Stroke color",name:"stroke"}),Object(e.jsx)(q,{value:t.strokeWidth,onChange:a("strokeWidth"),label:"Stroke width",name:"strokeWidth",options:ct.map(function(n){return{value:n,label:""+n}}),style:{minWidth:"65px"}})]})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(re,{value:t.opacity,onChange:a("opacity"),label:"Opacity",name:"opacity",type:"range"})})]})]})},yt=xt,Ct=function(r){var t=r.values,a=r.onChange;return Object(e.jsxs)("div",{className:"fabric-editor__form fabric-editor__form--active-element",children:[Object(e.jsx)("h3",{className:"fabric-editor__form-title",children:"Line options"}),Object(e.jsxs)(W.a,{gutter:10,children:[Object(e.jsx)(x.a,{children:Object(e.jsxs)(D.a.Group,{compact:!0,children:[Object(e.jsx)(Q,{value:t.stroke,onChange:a("stroke"),label:"Line color",name:"stroke"}),Object(e.jsx)(q,{value:t.strokeWidth,onChange:a("strokeWidth"),label:"Line width",name:"strokeWidth",options:st.map(function(n){return{value:n,label:""+n}}),style:{minWidth:"65px"}})]})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(re,{value:t.opacity,onChange:a("opacity"),label:"Opacity",name:"opacity",type:"range"})})]})]})},Ft=Ct,Et=function(r){var t=r.editorController,a=r.activeObject,n=Object(c.useCallback)(function(){return Object.fromEntries(at.map(function(o){return[o,t.getForActive(o)]}))},[t]),l=Object(c.useState)(n()),u=Object(N.a)(l,2),b=u[0],d=u[1];Object(c.useEffect)(function(){d(n());var o=function(){d(n())};return a&&a.on&&(a.on("selection:changed",o),a.on("editing:exited",o)),function(){a&&a.off&&(a.off("selection:changed",o),a.off("editing:exited",o))}},[n,a]);var j=Object(c.useCallback)(function(o){return function(g){d(Object(C.a)(Object(C.a)({},b),{},Object(z.a)({},o,g))),t==null||t.setForActive(o,g)}},[b,t]),m=function(g){switch(g){case"text":case"i-text":case"textbox":return Object(e.jsx)(gt,{values:b,onChange:j});case"image":return Object(e.jsx)(yt,{values:b,onChange:j});case"line":return Object(e.jsx)(Ft,{values:b,onChange:j});default:return Object(e.jsx)(pt,{values:b,onChange:j})}};return Object(e.jsx)(e.Fragment,{children:a&&Object(e.jsxs)(e.Fragment,{children:[m(a.type),Object(e.jsx)("hr",{}),Object(e.jsx)(Re.a,{title:"Are you sure you want to delete object?",icon:Object(e.jsx)(Ne.a,{style:{color:"red"}}),onConfirm:function(){return t==null?void 0:t.deleteSelected()},children:Object(e.jsx)(R.a,{type:"primary",danger:!0,htmlType:"button",children:"Remove object"})})]})})},St=Et,ea=i("qVdP"),We=i("jsC+"),ta=i("DZo9"),At=i("8z0m"),aa=i("lUTK"),V=i("BvKs"),Ve=i("8Skl"),ra=i("Ssu6"),Tt=function(r){var t=r.editorController,a=r.variables,n=a===void 0?[]:a,l=Object(c.useState)({backgroundColor:t.getEditorBackgroundColor()}),u=Object(N.a)(l,2),b=u[0],d=u[1];Object(c.useEffect)(function(){var f=function O(){d({backgroundColor:t.getEditorBackgroundColor()}),t.canvas.off("after:render",O)};return t.canvas.on("after:render",f),function(){t.canvas.off("after:render",f)}},[]),Object(c.useEffect)(function(){d(Object(C.a)(Object(C.a)({},b),{},{backgroundColor:t.getEditorBackgroundColor()}))},[t]);var j=Object(c.useCallback)(function(f){d(Object(C.a)(Object(C.a)({},b),{},{backgroundColor:f})),t.setEditorBackgroundColor(f)},[t]),m=Object(c.useCallback)(function(f){if(f){var O=new FileReader;O.readAsDataURL(f),O.onload=function(){if(O.result){var v;t==null||t.addFile((v=O.result)===null||v===void 0?void 0:v.toString())}},O.onerror=function(v){console.log("Error: ",v)}}},[]),o=Object(e.jsxs)(V.a,{children:[Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addCircle()},htmlType:"button",children:"Add Circle"})},"1"),Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addRectangle()},htmlType:"button",children:"Add Rectangle"})},"2"),Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addLine()},htmlType:"button",children:"Add Line"})},"3"),Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(At.a,{beforeUpload:m,showUploadList:!1,accept:"image/*",className:"input-upload",children:Object(e.jsx)(R.a,{type:"primary",block:!0,children:"Add Image"})})},"4")]}),g=Object(e.jsxs)(V.a,{children:[Object(e.jsxs)(V.a.ItemGroup,{title:"Text",children:[Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addTextbox()},htmlType:"button",children:"Add Textbox"})},"1"),Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addIText()},htmlType:"button",children:"Add Text"})},"2")]}),Object(e.jsx)(V.a.ItemGroup,{title:"Variables",children:n.map(function(f){return Object(e.jsx)(V.a.Item,{children:Object(e.jsx)(R.a,{type:"primary",block:!0,onClick:function(){return t==null?void 0:t.addVariable(f)},htmlType:"button",children:"Add ".concat(f)})},f)})})]});return Object(e.jsxs)("div",{className:"fabric-editor__form fabric-editor__form--basic",children:[Object(e.jsx)("h3",{className:"fabric-editor__form-title",children:"Editor options"}),Object(e.jsxs)(W.a,{align:"middle",children:[Object(e.jsx)(x.a,{children:Object(e.jsx)(Q,{value:b.backgroundColor,onChange:j,label:"Editor Background Color",name:"backgroundColor",style:{marginTop:"13px"}})}),Object(e.jsxs)(x.a,{children:[Object(e.jsx)(We.a,{overlay:o,children:Object(e.jsxs)(R.a,{children:["Add Object ",Object(e.jsx)(Ve.a,{})]})}),Object(e.jsx)(We.a,{overlay:g,children:Object(e.jsxs)(R.a,{children:["Add Text ",Object(e.jsx)(Ve.a,{})]})}),Object(e.jsx)(Re.a,{title:"Are you sure you want to delete everything?",icon:Object(e.jsx)(Ne.a,{style:{color:"red"}}),onConfirm:function(){return t==null?void 0:t.deleteAll()},children:Object(e.jsx)(R.a,{type:"primary",danger:!0,htmlType:"button",children:"Clear editor"})})]})]})]})},kt=Tt,na=i("K4qu"),Pt=function(r){var t=r.onUpdate,a=r.initialValue,n=r.width,l=n===void 0?842:n,u=r.height,b=u===void 0?592:u,d=r.variables,j=d===void 0?[]:d,m=Object(c.useState)(),o=Object(N.a)(m,2),g=o[0],f=o[1],O=Object(ue.b)(),v=O.editor,ie=O.onReady,B=Object(c.useMemo)(function(){return v?new ut(v):void 0},[v]),w=function(){var X=v==null?void 0:v.canvas.toJSON();return X&&t&&t(X)};Object(c.useEffect)(function(){var Z=Object(A.debounce)(w,500);return v&&v.canvas&&v.canvas.on("after:render",Z),function(){v&&v.canvas&&v.canvas.off("after:render",Z)}},[v]);var Fe=function(X){if(a)try{var be=JSON.parse(a);X.loadFromJSON(be,function(){})}catch(Se){}ie(X)},Ee=function(){return v&&f(v.canvas.toSVG())};return Object(e.jsxs)("div",{className:"fabric-editor",children:[Object(e.jsxs)(W.a,{className:"fabric-editor__top",gutter:50,justify:"space-between",children:[Object(e.jsx)(x.a,{children:(B==null?void 0:B.canvas)&&Object(e.jsx)(kt,{editorController:B,variables:j})}),Object(e.jsx)(x.a,{children:Object(e.jsx)(R.a,{onClick:Ee,htmlType:"button",children:"Preview PDF without mock value"})})]}),Object(e.jsx)("div",{className:"fabric-editor__canvas fakeA4",style:{width:l,height:b},children:Object(e.jsx)(ue.a,{className:"fakeA4-canvas",onReady:Fe})}),Object(e.jsx)("div",{className:"fabric-editor__bottom",children:(B==null?void 0:B.canvas)&&Object(e.jsx)(St,{editorController:B,activeObject:B.activeObject})}),g&&Object(e.jsx)(Qe,{svgDef:g,width:l,height:b})]})},It=Pt,Bt=i("PGov"),ia=i("D6/r"),oa=i("wbUo"),wt=function(r){return Object(e.jsxs)("div",{className:"".concat(r.entity.required&&"required"),children:["@","".concat(r.entity.name)]})},Rt=function(r){var t=r.requiredVariables,a=r.variables,n=r.onChange,l=r.value,u=r.error,b=a.map(function(d){return{name:d.substring(1),required:t.includes(d)}});return Object(e.jsxs)(h.a.Fragment,{children:[Object(e.jsx)(Bt.a,{className:"ant-input pro-field pro-field-lg rta__textarea_wide ".concat(u.length&&"error"),onChange:function(j){return n(j.target.value)},loadingComponent:function(){return Object(e.jsx)(y.a,{id:"loading"})},minChar:0,value:l,itemStyle:{fontSize:"16px"},trigger:{"@":{dataProvider:function(j){return b.filter(function(m){return m.name.startsWith(j)})},component:wt,output:function(j,m){return"".concat(m).concat(j.name)}}}}),Object(e.jsx)("div",{role:"alert",className:"ant-form-item-explain-error",children:u})]})},Nt=Rt,ca=i("JAl+"),Dt=function(r){var t=r.name,a=r.field,n=r.variables,l=n===void 0?[]:n,u=Object(c.useCallback)(function(j){if(j.length)return Object(e.jsx)(G.b,{children:Object(e.jsxs)(k.a,{children:[Object(e.jsx)(y.a,{id:"templates.required_variables"}),":"," ",j.map(function(m){return Object(e.jsx)(oe.a,{color:"red",children:m},m)})]})})},[a,t]),b=Object(c.useCallback)(function(j,m){return j&&m.every(function(o){return j.includes(o)})?Promise.resolve():Promise.reject(new Error("No required variable used"))},[a,t]),d=Object(c.useCallback)(function(){if(!a.readonly)switch(a.type){case"text":case"url":return Object(e.jsxs)(h.a.Fragment,{children:[Object(e.jsx)(I.a,{readonly:a.readonly,shouldUpdate:!0,width:"lg",name:t,label:Object(e.jsx)(y.a,{id:t}),rules:a.readonly?void 0:[{required:a.required,message:Object(e.jsx)(y.a,{id:"templates.this_required"})},{validator:function(){var j=Object(K.a)(P.a.mark(function o(g,f){return P.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",b(f,a.required_variables));case 1:case"end":return v.stop()}},o)}));function m(o,g){return j.apply(this,arguments)}return m}()}]}),u(a.required_variables)]});case"fabric.js":return Object(e.jsxs)(h.a.Fragment,{children:[Object(e.jsx)(E.a.Item,{shouldUpdate:!0,children:function(m){return Object(e.jsx)(It,{initialValue:m.getFieldValue(t),variables:l,onUpdate:function(g){return m.setFieldsValue(Object(z.a)({},t,JSON.stringify(g)))}})}}),Object(e.jsx)(fe.a,{name:t,shouldUpdate:!0,width:"lg",hidden:!0})]});case"html":return Object(e.jsxs)(h.a.Fragment,{children:[Object(e.jsx)(fe.a,{readonly:a.readonly,shouldUpdate:!0,width:"lg",label:Object(e.jsx)(y.a,{id:t}),name:t,tooltip:Object(e.jsx)(y.a,{id:"templates.html_tooltip"}),rules:a.readonly?void 0:[{required:a.required,message:Object(e.jsx)(y.a,{id:"templates.this_required"})},{validator:function(){var j=Object(K.a)(P.a.mark(function o(g,f){return P.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",b(f,a.required_variables));case 1:case"end":return v.stop()}},o)}));function m(o,g){return j.apply(this,arguments)}return m}()}]}),u(a.required_variables)]});case"mjml":return Object(e.jsxs)(h.a.Fragment,{children:[Object(e.jsxs)("p",{children:[Object(e.jsx)(y.a,{id:"templates.to_create_template"})," ",Object(e.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://mjml.io/try-it-live",children:"https://mjml.io/try-it-live"})]}),Object(e.jsx)("code",{children:Object(e.jsx)(y.a,{id:"code.snippet"})}),Object(e.jsx)(E.a.Item,{shouldUpdate:!0,children:function(m){return Object(e.jsx)(Nt,{requiredVariables:a.required_variables,variables:l,value:m.getFieldValue(t),onChange:function(g){return m.setFieldsValue(Object(z.a)({},t,g))},error:m.getFieldError(t)})}}),Object(e.jsx)(fe.a,{name:t,shouldUpdate:!0,hidden:!0,rules:a.readonly?void 0:[{required:a.required,message:Object(e.jsx)(y.a,{id:"templates.this_required"})},{validator:function(){var j=Object(K.a)(P.a.mark(function o(g,f){return P.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",b(f,a.required_variables));case 1:case"end":return v.stop()}},o)}));function m(o,g){return j.apply(this,arguments)}return m}()}]}),u(a.required_variables)]});default:return}},[a,t,l]);return Object(e.jsx)(h.a.Fragment,{children:d()})},Lt=Dt,Wt=function(r,t){return r?Object.keys(r).reduce(function(a,n){return r[n][t]?Object(C.a)(Object(C.a)({},a),{},Object(z.a)({},n,n)):a},{}):{}},Vt=function(r){return Object.entries(r).map(function(t){return{key:t[0],content:t[1]}})},Me=function(r){return Object.assign.apply(Object,[{}].concat(Object(H.a)(r)))},Mt=function(r){var t=["name","event","default"];return Object.keys(r).filter(function(a){return!t.includes(a)}).reduce(function(a,n){return a[n]=r[n],a},{})},Ce={email:"EscolaLms\\TemplatesEmail\\Core\\EmailChannel",pdf:"EscolaLms\\TemplatesPdf\\Core\\PdfChannel"},sa=S.default=function(){var s=Object(y.i)(),r=Object(Je.h)(),t=r.template,a=r.id,n=a==="new",l=Object(c.useState)(!1),u=Object(N.a)(l,2),b=u[0],d=u[1],j=E.a.useForm(),m=Object(N.a)(j,1),o=m[0],g=Object(c.useState)(),f=Object(N.a)(g,2),O=f[0],v=f[1],ie=Object(c.useState)(void 0),B=Object(N.a)(ie,2),w=B[0],Fe=B[1],Ee=Object(c.useState)(),Z=Object(N.a)(Ee,2),X=Z[0],be=Z[1];Object(c.useEffect)(function(){Object(ae.g)().then(function(T){v(T.success?T.data:{})})},[]),Object(c.useEffect)(function(){var T=o.getFieldsValue(),F=w&&Object.keys(w.sections).map(function(M){return Object(z.a)({},M,w.sections[M].default_content)});F&&n&&o.setFieldsValue(Object(C.a)(Object(C.a)({},T),Me(F)))},[w]);var Se=Object(c.useCallback)(function(T){if(T&&t){var F=O&&O[T][Ce[t]];Fe(F)}},[O,a]),Ut=Object(c.useCallback)(Object(K.a)(P.a.mark(function T(){var F,M,U;return P.a.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,Object(ae.d)(Number(a));case 2:F=ee.sent,F.success&&(M=F.data.sections&&F.data.sections.map(function(L){return Object(z.a)({},L.key,L.content)}),U=M&&Me(M),o.setFieldsValue(Object(C.a)(Object(C.a)({},F.data),U)),Se(String(F.data.event)),d(!0));case 4:case"end":return ee.stop()}},T)})),[a,O]),$t=Object(c.useCallback)(function(){var T=Object(K.a)(P.a.mark(function F(M){var U,je;return P.a.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(je=Object(C.a)(Object(C.a)({},M),{},{channel:Ce[t],sections:Vt(Mt(M))}),!n){L.next=8;break}return L.next=4,Object(ae.a)(je);case 4:U=L.sent,U.success&&y.d.push("/templates/".concat(t,"/").concat(U.data.id)),L.next=11;break;case 8:return L.next=10,Object(ae.f)(Number(a),je);case 10:U=L.sent;case 11:d(!0),me.default.success(U.message);case 13:case"end":return L.stop()}},F)}));return function(F){return T.apply(this,arguments)}}(),[O,a]);return Object(c.useEffect)(function(){n||Ut()},[a,O]),Object(e.jsxs)($e.a,{title:n?Object(e.jsxs)("span",{children:[Object(e.jsx)(y.a,{id:"new"})," ",t," ",Object(e.jsx)(y.a,{id:"template"})]}):Object(e.jsxs)("span",{children:[Object(e.jsx)(y.a,{id:"edit"})," ",t," ",Object(e.jsx)(y.a,{id:"template"})]}),children:[Object(e.jsx)(Ue.a,{size:"small",children:Object(e.jsxs)(E.a,{initialValues:{},onFinish:$t,form:o,onValuesChange:function(){var F=o.getFieldsValue();Se(F.event),d(!1)},children:[Object(e.jsxs)(E.a.Group,{children:[Object(e.jsx)(I.a,{width:"sm",name:"name",label:Object(e.jsx)(y.a,{id:"name"}),placeholder:s.formatMessage({id:"name"}),rules:[{required:!0,message:Object(e.jsx)(y.a,{id:"select"})}]}),Object(e.jsx)(p.a,{name:"event",width:"lg",label:Object(e.jsx)(y.a,{id:"event"}),valueEnum:O?Wt(O,Ce[t]):{},placeholder:s.formatMessage({id:"event"}),rules:[{required:!0,message:Object(e.jsx)(y.a,{id:"select"})}]}),Object(e.jsx)(E.a.Item,{label:Object(e.jsx)(y.a,{id:"templates.set_as_default_template"}),children:Object(e.jsx)(_.a,{name:"default"})}),!n&&Object(e.jsx)(E.a.Item,{label:Object(e.jsx)(y.a,{id:"preview"}),children:Object(e.jsx)(He,{disabled:!b,id:Number(a),type:t,onPreviewData:function(F){F&&F.data&&F.data.content&&be(F.data.content)}})})]}),!w&&!n?Object(e.jsx)(ve.a,{}):w&&w.sections&&Object.keys(w.sections).map(function(T,F){var M=w.sections&&w.sections[T];return Object(e.jsxs)(h.a.Fragment,{children:[F===0&&Object(e.jsxs)(h.a.Fragment,{children:[Object(e.jsx)(te.a,{children:Object(e.jsx)(y.a,{id:"templates.tokens"})}),Object(e.jsx)(G.b,{children:Object(e.jsx)(k.a,{children:w.variables.map(function(U){return Object(e.jsx)(oe.a,{color:"orange",children:U},U)})})})]}),Object(e.jsx)(te.a,{}),Object(e.jsx)(Lt,{name:T,field:M,variables:w.variables})]},T)}),Object(e.jsx)(te.a,{})]})}),X&&Object(e.jsx)(ze,{initialValue:X,onRendered:function(){return be(void 0)}})]})}},"JAl+":function(J,S,i){},K4qu:function(J,S,i){},Ssu6:function(J,S,i){},rWUb:function(J,S,i){"use strict";i.d(S,"e",function(){return oe}),i.d(S,"d",function(){return te}),i.d(S,"a",function(){return ve}),i.d(S,"f",function(){return me}),i.d(S,"b",function(){return N}),i.d(S,"g",function(){return z}),i.d(S,"c",function(){return he});var $=i("k1fw"),G=i("9og8"),Ae=i("WmNS"),k=i.n(Ae),Y=i("9kvl");function oe(c,h){return ce.apply(this,arguments)}function ce(){return ce=Object(G.a)(k.a.mark(function c(h,E){return k.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",Object(Y.f)("/api/admin/templates",Object($.a)({method:"GET",useCache:!1,params:Object($.a)(Object($.a)({},h),{},{per_page:h.pageSize&&h.pageSize,page:h.current&&h.current})},E||{})));case 1:case"end":return p.stop()}},c)})),ce.apply(this,arguments)}function te(c,h){return se.apply(this,arguments)}function se(){return se=Object(G.a)(k.a.mark(function c(h,E){return k.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",Object(Y.f)("/api/admin/templates/".concat(h),Object($.a)({method:"GET"},E||{})));case 1:case"end":return p.stop()}},c)})),se.apply(this,arguments)}function ve(c,h){return le.apply(this,arguments)}function le(){return le=Object(G.a)(k.a.mark(function c(h,E){return k.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",Object(Y.f)("/api/admin/templates",Object($.a)({method:"POST",headers:{"Content-Type":"application/json"},data:h},E||{})));case 1:case"end":return p.stop()}},c)})),le.apply(this,arguments)}function me(c,h,E){return K.apply(this,arguments)}function K(){return K=Object(G.a)(k.a.mark(function c(h,E,I){return k.a.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",Object(Y.f)("/api/admin/templates/".concat(h),Object($.a)({method:"PATCH",headers:{"Content-Type":"application/json"},data:E},I||{})));case 1:case"end":return _.stop()}},c)})),K.apply(this,arguments)}function N(c,h){return H.apply(this,arguments)}function H(){return H=Object(G.a)(k.a.mark(function c(h,E){return k.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",Object(Y.f)("/api/admin/templates/".concat(h),Object($.a)({method:"DELETE",headers:{"Content-Type":"application/json"}},E||{})));case 1:case"end":return p.stop()}},c)})),H.apply(this,arguments)}function z(c){return C.apply(this,arguments)}function C(){return C=Object(G.a)(k.a.mark(function c(h){return k.a.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.abrupt("return",Object(Y.f)("/api/admin/templates/variables",Object($.a)({method:"GET"},h||{})));case 1:case"end":return I.stop()}},c)})),C.apply(this,arguments)}function he(c,h){return P.apply(this,arguments)}function P(){return P=Object(G.a)(k.a.mark(function c(h,E){return k.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",Object(Y.f)("/api/admin/templates/".concat(h,"/preview"),Object($.a)({method:"GET"},E||{})));case 1:case"end":return p.stop()}},c)})),P.apply(this,arguments)}},wbUo:function(J,S,i){}}]);
