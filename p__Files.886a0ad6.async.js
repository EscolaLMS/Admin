(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"3fxf":function(N,m,t){"use strict";var A=t("DjyN"),D=t("NUBc"),F=t("Mwp2"),d=t("VXEj"),P=t("+L6B"),O=t("2/Rp"),j=t("5NDa"),f=t("5rEg"),M=t("oBTY"),r=t("k1fw"),v=t("tJVT"),n=t("DYRE"),h=t("zeV3"),c=t("tU7J"),s=t("wFql"),o=t("q1tI"),_=t.n(o),u=t("BAh9"),a=t("/MfK"),T=t("mAF4"),p=t("dF/Y"),y=t("9kvl"),S=t("DBJ/"),L=t("lLVY"),Z=t.n(L),e=t("nKUr"),H=t.n(e),z=function(R){var x=R.directory,B=R.onUploaded;return Object(e.jsxs)(h.b,{align:"start",children:[Object(e.jsxs)(s.a.Text,{children:[Object(e.jsx)(y.a,{id:"pages.files.filesBrowser"}),Object(e.jsx)(s.a.Text,{code:!0,children:x})]}),Object(e.jsx)(S.a,{url:"/api/admin/file/upload",name:"file[]",data:{target:x},onChange:function(Q){return Q.file.status==="done"&&B(x)}})]})},J=function(R){var x=R.defaultDirectory,B=x===void 0?"/":x,K=R.onFile,Q=Object(y.i)(),k=Object(o.useState)({loading:!1,name:"",directory:B,current_page:1,data:void 0,per_page:1,last_page:1,total:0}),w=Object(v.a)(k,2),E=w[0],Y=w[1],U=Object(o.useRef)(),C=Object(o.useCallback)(function(i){Y(function(l){return Object(r.a)(Object(r.a)({},l),{},{loading:i})})},[]),b=Object(o.useCallback)(function(i){var l,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,G=function(){return U.current&&U.current.abort()};return G(),U.current=new AbortController,C(!0),Object(u.a)({directory:i,page:g},{signal:(l=U.current)===null||l===void 0?void 0:l.signal}).then(function(W){W.success&&Y(function(V){return Object(r.a)(Object(r.a)(Object(r.a)({},V),W.data),{},{data:[{url:i.split("/").slice(0,-1).join("/"),name:"..",created_at:"",mime:"directory"}].concat(Object(M.a)(W.data.data.map(function(I){return Object(r.a)(Object(r.a)({},I),{},{url:I.mime==="directory"?"".concat(i,"/").concat(I.name):I.url})}))).filter(function(I){return i==="/"?I.name!=="..":!0}),directory:i,loading:!1})})}).catch(function(){return C(!1)}),function(){G()}},[C]);Object(o.useEffect)(function(){return b(B)},[B,b]);var q=Object(o.useCallback)(function(i){C(!0),Object(u.c)(i).then(function(){b(E.directory)}).catch(function(){C(!1)})},[b,C,E.directory]),tt=Object(o.useCallback)(function(i,l){var g,G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,W=function(){return U.current&&U.current.abort()};return W(),U.current=new AbortController,C(!0),Object(u.b)({directory:i,name:l,page:G},{signal:(g=U.current)===null||g===void 0?void 0:g.signal}).then(function(V){V.success&&Y(function(I){return Object(r.a)(Object(r.a)(Object(r.a)({},I),V.data),{},{data:[{url:i.split("/").slice(0,-1).join("/"),name:"..",created_at:"",mime:"directory"}].concat(Object(M.a)(V.data.data.map(function($){return Object(r.a)(Object(r.a)({},$),{},{url:$.mime==="directory"?"".concat(i,"/").concat($.name):$.url})}))).filter(function($){return i==="/"?$.name!=="..":!0}),directory:i,loading:!1})})}).catch(function(){return C(!1)}),function(){W()}},[C]);return Object(e.jsxs)("div",{className:"file-browser",children:[Object(e.jsxs)("div",{className:"file-browser__header",children:[Object(e.jsx)(f.a,{placeholder:Q.formatMessage({id:"search_file"}),className:"file-browser__input",onChange:function(l){return Y(function(g){return Object(r.a)(Object(r.a)({},g),{},{name:l.target.value})})},value:E.name}),Object(e.jsxs)("div",{children:[Object(e.jsx)(O.a,{className:"file-browser__button",onClick:function(){return b(E.directory)},children:Object(e.jsx)(y.a,{id:"reset"})}),Object(e.jsx)(O.a,{className:"file-browser__button",type:"primary",onClick:function(){return tt(E.directory,E.name)},children:Object(e.jsx)(y.a,{id:"query"})})]})]}),Object(e.jsx)(d.b,{loading:E.loading,size:"small",itemLayout:"horizontal",dataSource:E.data,header:Object(e.jsx)(z,{directory:E.directory,onUploaded:function(l){return b(l)}}),footer:Object(e.jsx)(z,{directory:E.directory,onUploaded:function(l){return b(l)}}),renderItem:function(l){return Object(e.jsx)(d.b.Item,{actions:l.mime!=="directory"?[Object(e.jsx)(O.a,{type:"default",danger:!0,icon:Object(e.jsx)(a.a,{}),size:"small",onClick:function(){return q(l.url)}})]:[],children:Object(e.jsx)(d.b.Item.Meta,{avatar:l.mime==="directory"?Object(e.jsx)(O.a,{type:"primary",icon:Object(e.jsx)(T.a,{}),size:"small",onClick:function(){return b(l.url)}}):Object(e.jsx)("a",{href:l.url,target:"_blank",children:Object(e.jsx)(O.a,{type:"default",icon:Object(e.jsx)(p.a,{}),size:"small"})}),description:Object(e.jsx)(_.a.Fragment,{children:Object(e.jsx)(O.a,{type:"text",size:"small",onClick:function(){return l.mime==="directory"?b(l.url):K&&K(l,E.directory)},children:l.name})})})})}}),Object(e.jsx)(D.a,{pageSizeOptions:[],current:E.current_page,total:E.total,pageSize:E.per_page,onChange:function(l){return b(E.directory,l)}})]})};m.a=J},BAh9:function(N,m,t){"use strict";t.d(m,"a",function(){return O}),t.d(m,"b",function(){return f}),t.d(m,"e",function(){return r}),t.d(m,"d",function(){return n}),t.d(m,"c",function(){return h});var A=t("k1fw"),D=t("9og8"),F=t("WmNS"),d=t.n(F),P=t("9kvl");function O(s,o){return j.apply(this,arguments)}function j(){return j=Object(D.a)(d.a.mark(function s(o,_){return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(P.f)("/api/admin/file/list",Object(A.a)({method:"GET",params:o},_||{})));case 1:case"end":return a.stop()}},s)})),j.apply(this,arguments)}function f(s,o){return M.apply(this,arguments)}function M(){return M=Object(D.a)(d.a.mark(function s(o,_){return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(P.f)("/api/admin/file/find",Object(A.a)({method:"GET",params:o},_||{})));case 1:case"end":return a.stop()}},s)})),M.apply(this,arguments)}function r(s,o,_){return v.apply(this,arguments)}function v(){return v=Object(D.a)(d.a.mark(function s(o,_,u){var a;return d.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return a=new FormData,a.append("file[]",o),a.append("target",_),p.abrupt("return",Object(P.f)("/api/admin/file/upload",Object(A.a)({method:"POST",data:a},u||{})));case 4:case"end":return p.stop()}},s)})),v.apply(this,arguments)}var n=function(o){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;return"".concat("https://api-stage.escolalms.com","/api/images/img?path=").concat(o,"&w=").concat(_)};function h(s,o){return c.apply(this,arguments)}function c(){return c=Object(D.a)(d.a.mark(function s(o,_){return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",Object(P.f)("/api/admin/file/delete",Object(A.a)({method:"DELETE",data:{url:o}},_||{})));case 1:case"end":return a.stop()}},s)})),c.apply(this,arguments)}},"DBJ/":function(N,m,t){"use strict";var A=t("y8nQ"),D=t("Vl3Y"),F=t("etVw"),d=t("q1tI"),P=t.n(d),O=t("9kvl"),j=function(v){var n=v.condition,h=v.children,c=v.wrap;return n?P.a.cloneElement(c(h)):h},f=t("nKUr"),M=function(n){var h=n.onChange,c=n.url,s=n.name,o=n.extra,_=n.accept,u=n.data,a=n.wrapInForm,T=a===void 0?!0:a,p=Object(O.i)();return u&&u[s]&&delete u[s],Object(f.jsx)(j,{condition:T,wrap:function(S){return Object(f.jsx)(D.a,{children:S})},children:Object(f.jsx)(F.a,{title:Object(f.jsx)(O.a,{id:"upload_click_here"}),placeholder:p.formatMessage({id:"upload_click_here"}),onChange:h,label:Object(f.jsx)(O.a,{id:"upload"}),max:2,fieldProps:{data:u,accept:_,name:s,headers:{Authorization:"Bearer ".concat(localStorage.getItem("TOKEN"))}},action:"".concat("https://api-stage.escolalms.com").concat(c),extra:o})})},r=m.a=M},etVw:function(N,m,t){"use strict";var A=t("DZo9"),D=t("8z0m"),F=t("+L6B"),d=t("2/Rp"),P=t("wx14"),O=t("q1tI"),j=t.n(O),f=t("z7Xi"),M=t("WFLz"),r=function(n,h){var c=n.fieldProps,s=n.name,o=n.action,_=n.accept,u=n.listType,a=n.title,T=a===void 0?"\u5355\u51FB\u4E0A\u4F20":a,p=n.max,y=n.icon,S=y===void 0?j.a.createElement(f.a,null):y,L=n.value,Z=n.buttonProps,e=n.onChange,H=n.disabled,z=n.proFieldProps,J=n.fileList,X=(p===void 0||!L||(L==null?void 0:L.length)<p)&&(z==null?void 0:z.mode)!=="read",R=(u!=null?u:c==null?void 0:c.listType)==="picture-card";return j.a.createElement(D.a,Object(P.a)({action:o,accept:_,ref:h,name:s||"file",listType:u||"picture",fileList:J!=null?J:L},c,{onChange:function(B){var K;e==null||e(B),c==null||(K=c.onChange)===null||K===void 0||K.call(c,B)}}),X&&(R?j.a.createElement("span",null,S," ",T):j.a.createElement(d.a,Object(P.a)({disabled:H||(c==null?void 0:c.disabled)},Z),S,T)))};m.a=Object(M.a)(j.a.forwardRef(r),{getValueFromEvent:function(n){return n.fileList}})},lLVY:function(N,m,t){},u4ym:function(N,m,t){"use strict";t.r(m);var A=t("IzEo"),D=t("bx4M"),F=t("tU7J"),d=t("wFql"),P=t("q1tI"),O=t.n(P),j=t("tMyG"),f=t("9kvl"),M=t("3fxf"),r=t("nKUr"),v=t.n(r);m.default=function(){return Object(r.jsx)(j.a,{children:Object(r.jsxs)(D.a,{children:[Object(r.jsx)(d.a.Text,{strong:!0,children:Object(r.jsx)(f.a,{id:"pages.files.content"})}),Object(r.jsx)(M.a,{})]})})}}}]);
