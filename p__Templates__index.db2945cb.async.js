"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[4519],{82061:function(Q,j,t){var i=t(1413),m=t(67294),M=t(47046),r=t(84089),_=function(v,x){return m.createElement(r.Z,(0,i.Z)((0,i.Z)({},v),{},{ref:x,icon:M.Z}))};_.displayName="DeleteOutlined",j.Z=m.forwardRef(_)},47389:function(Q,j,t){var i=t(1413),m=t(67294),M=t(27363),r=t(84089),_=function(v,x){return m.createElement(r.Z,(0,i.Z)((0,i.Z)({},v),{},{ref:x,icon:M.Z}))};_.displayName="EditOutlined",j.Z=m.forwardRef(_)},51042:function(Q,j,t){var i=t(1413),m=t(67294),M=t(42110),r=t(84089),_=function(v,x){return m.createElement(r.Z,(0,i.Z)((0,i.Z)({},v),{},{ref:x,icon:M.Z}))};_.displayName="PlusOutlined",j.Z=m.forwardRef(_)},27226:function(Q,j,t){t.r(j),t.d(j,{channelType:function(){return u},default:function(){return C}});var i=t(26271),m=t(74453),M=t(67294),r=t(80854),_=function(){var e,o=(0,r.useModel)("@@initialState"),d=o.initialState,a=(d==null||(e=d.currentUser)===null||e===void 0?void 0:e.roles)||[],l=(0,M.useCallback)(function(T){var p,P=d==null||(p=d.config)===null||p===void 0||(p=p.find(function(g){return g.key===T}))===null||p===void 0?void 0:p.data;return Array.isArray(a)&&Array.isArray(P)?a.every(function(g){return P.includes(g)}):typeof P=="boolean"?P:!1},[]);return{checkRoles:l}},E=t(15009),v=t.n(E),x=t(99289),F=t.n(x),J=t(5574),z=t.n(J),Y=t(45919),D=t(40658),k=t(51042),Z=t(47389),N=t(82061),W=t(16894),X=t(66309),K=t(2453),w=t(14726),U=t(83062),q=t(86738),H=t(60943),n=t(85893),$=function(e){var o=e.templateType,d=e.channel,a=(0,M.useRef)(),l=(0,r.useIntl)(),T=(0,M.useState)(!1),p=z()(T,2),P=p[0],g=p[1],G=[{title:(0,n.jsx)(r.FormattedMessage,{id:"ID",defaultMessage:"ID"}),dataIndex:"id",hideInSearch:!0,sorter:!0,width:"80px"},{title:(0,n.jsx)(r.FormattedMessage,{id:"created_at",defaultMessage:"created_at"}),dataIndex:"created_at",hideInSearch:!0,sorter:!0,render:function(b,h){return h.created_at&&(0,H.WU)(new Date(h.created_at),Y.Cu)}},{title:(0,n.jsx)(r.FormattedMessage,{id:"name",defaultMessage:"name"}),dataIndex:"name",hideInSearch:!1,sorter:!0},{title:(0,n.jsx)(r.FormattedMessage,{id:"event",defaultMessage:"event"}),dataIndex:"event",hideInSearch:!0,sorter:!1,render:function(b,h){return(0,n.jsx)(r.FormattedMessage,{id:h.event,defaultMessage:h.event})}},{title:(0,n.jsx)(r.FormattedMessage,{id:"templates.is_default"}),dataIndex:"default",hideInSearch:!0,valueEnum:{true:(0,n.jsx)(X.Z,{color:"success",children:(0,n.jsx)(r.FormattedMessage,{id:"yes"})}),false:(0,n.jsx)(X.Z,{color:"error",children:(0,n.jsx)(r.FormattedMessage,{id:"no"})})}}],S=(0,M.useCallback)(function(){var A=F()(v()().mark(function b(h){var R,B;return v()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return g(!0),R=K.ZP.loading((0,n.jsx)(r.FormattedMessage,{id:"loading",defaultMessage:"loading"})),y.prev=2,y.next=5,(0,D.Xc)(h).then(function(L){g(!1),L.success&&K.ZP.success(L.message)});case 5:return R(),g(!1),(B=a.current)===null||B===void 0||B.reload(),y.abrupt("return",!0);case 11:return y.prev=11,y.t0=y.catch(2),R(),K.ZP.error((0,n.jsx)(r.FormattedMessage,{id:"error",defaultMessage:"error"})),g(!1),y.abrupt("return",!1);case 17:case"end":return y.stop()}},b,null,[[2,11]])}));return function(b){return A.apply(this,arguments)}}(),[a]);return(0,n.jsx)(W.ZP,{headerTitle:l.formatMessage({id:"templates",defaultMessage:"templates"}),loading:P,actionRef:a,rowKey:"id",search:{layout:"vertical"},toolBarRender:function(){return[(0,n.jsx)(r.Link,{to:"/configuration/templates/".concat(o,"/new"),children:(0,n.jsxs)(w.ZP,{type:"primary",children:[(0,n.jsx)(k.Z,{})," ",(0,n.jsx)(r.FormattedMessage,{id:"new",defaultMessage:"new"})]},"primary")},"new")]},request:function(b,h){var R=b.pageSize,B=b.current,O=b.name;g(!0);var y=h&&Object.entries(h)[0];return(0,D.zd)({per_page:R,page:B,channel:d,name:O||void 0,order_by:y&&y[0],order:y?y[1]==="ascend"?"ASC":"DESC":void 0}).then(function(L){return L.success?(g(!1),{data:L.data,total:L.meta.total,success:!0}):[]})},columns:[].concat(G,[{hideInSearch:!0,title:(0,n.jsx)(r.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"option"}),dataIndex:"option",valueType:"option",render:function(b,h){return[(0,n.jsx)(r.Link,{to:"/configuration/templates/".concat(o,"/").concat(h.id),children:(0,n.jsx)(U.Z,{title:(0,n.jsx)(r.FormattedMessage,{id:"edit",defaultMessage:"edit"}),children:(0,n.jsx)(w.ZP,{type:"primary",icon:(0,n.jsx)(Z.Z,{})})})},"edit"),(0,n.jsx)(q.Z,{title:(0,n.jsx)(r.FormattedMessage,{id:"deleteQuestion",defaultMessage:"Are you sure to delete this record?"}),onConfirm:function(){return S(h.id)},okText:(0,n.jsx)(r.FormattedMessage,{id:"yes"}),cancelText:(0,n.jsx)(r.FormattedMessage,{id:"no"}),children:(0,n.jsx)(U.Z,{title:(0,n.jsx)(r.FormattedMessage,{id:"delete",defaultMessage:"delete"}),children:(0,n.jsx)(w.ZP,{type:"primary",icon:(0,n.jsx)(N.Z,{}),danger:!0})})},"delete")]}}])})},c=$,u=function(s){return s.email="EscolaLms\\TemplatesEmail\\Core\\EmailChannel",s.pdf="EscolaLms\\TemplatesPdf\\Core\\PdfChannel",s.sms="EscolaLms\\TemplatesSms\\Core\\SmsChannel",s}({}),f=function(){var e=(0,r.useParams)(),o=e.template,d=(0,r.useAccess)(),a=_(),l=a.checkRoles,T=l("hideTemplateTab-sms"),p=l("hideTemplateTab-email");return(0,n.jsx)(m._z,{children:(0,n.jsxs)(i.ZP,{tabs:{type:"card",activeKey:o,onChange:function(g){return r.history.push("/configuration/templates/".concat(g))}},children:[!p&&(0,n.jsx)(i.ZP.TabPane,{tab:(0,n.jsx)(r.FormattedMessage,{id:"email"}),children:(0,n.jsx)(c,{templateType:"email",channel:u.email})},"email"),d.certificatesPermission&&(0,n.jsx)(i.ZP.TabPane,{tab:(0,n.jsx)(r.FormattedMessage,{id:"PDF"}),children:(0,n.jsx)(c,{templateType:"pdf",channel:u.pdf})},"pdf"),!T&&(0,n.jsx)(i.ZP.TabPane,{tab:(0,n.jsx)("span",{children:(0,n.jsx)(r.FormattedMessage,{id:"SMS"})}),children:(0,n.jsx)(c,{templateType:"sms",channel:u.sms})},"sms")]})})},C=f},40658:function(Q,j,t){t.d(j,{MZ:function(){return q},Mn:function(){return Y},QB:function(){return k},RN:function(){return w},Rl:function(){return X},XK:function(){return J},Xc:function(){return N},zB:function(){return n},zd:function(){return x}});var i=t(15009),m=t.n(i),M=t(97857),r=t.n(M),_=t(99289),E=t.n(_),v=t(80854);function x(c,u){return F.apply(this,arguments)}function F(){return F=E()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,v.request)("/api/admin/templates",r()({method:"GET",useCache:!1,params:u},f||{})));case 1:case"end":return s.stop()}},c)})),F.apply(this,arguments)}function J(c,u){return z.apply(this,arguments)}function z(){return z=E()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,v.request)("/api/admin/templates/".concat(u),r()({method:"GET"},f||{})));case 1:case"end":return s.stop()}},c)})),z.apply(this,arguments)}function Y(c,u){return D.apply(this,arguments)}function D(){return D=E()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,v.request)("/api/admin/templates",r()({method:"POST",headers:{"Content-Type":"application/json"},data:u},f||{})));case 1:case"end":return s.stop()}},c)})),D.apply(this,arguments)}function k(c,u,f){return Z.apply(this,arguments)}function Z(){return Z=E()(m()().mark(function c(u,f,C){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.request)("/api/admin/templates/".concat(u),r()({method:"PATCH",headers:{"Content-Type":"application/json"},data:f},C||{})));case 1:case"end":return e.stop()}},c)})),Z.apply(this,arguments)}function N(c,u){return W.apply(this,arguments)}function W(){return W=E()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,v.request)("/api/admin/templates/".concat(u),r()({method:"DELETE",headers:{"Content-Type":"application/json"}},f||{})));case 1:case"end":return s.stop()}},c)})),W.apply(this,arguments)}function X(c){return K.apply(this,arguments)}function K(){return K=E()(m()().mark(function c(u){return m()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",(0,v.request)("/api/admin/templates/variables",r()({method:"GET"},u||{})));case 1:case"end":return C.stop()}},c)})),K.apply(this,arguments)}function w(c,u){return U.apply(this,arguments)}function U(){return U=E()(m()().mark(function c(u,f){return m()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,v.request)("/api/admin/templates/".concat(u,"/preview"),r()({method:"GET"},f||{})));case 1:case"end":return s.stop()}},c)})),U.apply(this,arguments)}function q(c,u,f){return H.apply(this,arguments)}function H(){return H=E()(m()().mark(function c(u,f,C){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.request)("/api/admin/events/trigger-manually/".concat(u),r()({method:"POST",headers:{"Content-Type":"application/json"},data:{users:f}},C||{})));case 1:case"end":return e.stop()}},c)})),H.apply(this,arguments)}function n(c,u,f){return $.apply(this,arguments)}function $(){return $=E()(m()().mark(function c(u,f,C){return m()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.request)("/api/admin/products/".concat(f,"/trigger-event-manually/").concat(u),r()({method:"POST",headers:{"Content-Type":"application/json"}},C||{})));case 1:case"end":return e.stop()}},c)})),$.apply(this,arguments)}},66309:function(Q,j,t){t.d(j,{Z:function(){return s}});var i=t(67294),m=t(62208),M=t(93967),r=t.n(M),_=t(98787),E=t(69760),v=t(45353),x=t(53124),F=t(6731),J=t(10274),z=t(14747),Y=t(45503),D=t(91945);const k=e=>{const{paddingXXS:o,lineWidth:d,tagPaddingHorizontal:a,componentCls:l,calc:T}=e,p=T(a).sub(d).equal(),P=T(o).sub(d).equal();return{[l]:Object.assign(Object.assign({},(0,z.Wf)(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:p,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${(0,F.unit)(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${l}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${l}-close-icon`]:{marginInlineStart:P,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${l}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},["&-checkable"]:{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${l}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},["&-hidden"]:{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:p}}),[`${l}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},Z=e=>{const{lineWidth:o,fontSizeIcon:d,calc:a}=e,l=e.fontSizeSM;return(0,Y.TS)(e,{tagFontSize:l,tagLineHeight:(0,F.unit)(a(e.lineHeightSM).mul(l).equal()),tagIconSize:a(d).sub(a(o).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},N=e=>({defaultBg:new J.C(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText});var W=(0,D.I$)("Tag",e=>{const o=Z(e);return k(o)},N),X=function(e,o){var d={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&o.indexOf(a)<0&&(d[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,a=Object.getOwnPropertySymbols(e);l<a.length;l++)o.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(d[a[l]]=e[a[l]]);return d},w=i.forwardRef((e,o)=>{const{prefixCls:d,style:a,className:l,checked:T,onChange:p,onClick:P}=e,g=X(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:G,tag:S}=i.useContext(x.E_),A=y=>{p==null||p(!T),P==null||P(y)},b=G("tag",d),[h,R,B]=W(b),O=r()(b,`${b}-checkable`,{[`${b}-checkable-checked`]:T},S==null?void 0:S.className,l,R,B);return h(i.createElement("span",Object.assign({},g,{ref:o,style:Object.assign(Object.assign({},a),S==null?void 0:S.style),className:O,onClick:A})))}),U=t(98719);const q=e=>(0,U.Z)(e,(o,d)=>{let{textColor:a,lightBorderColor:l,lightColor:T,darkColor:p}=d;return{[`${e.componentCls}${e.componentCls}-${o}`]:{color:a,background:T,borderColor:l,"&-inverse":{color:e.colorTextLightSolid,background:p,borderColor:p},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}});var H=(0,D.bk)(["Tag","preset"],e=>{const o=Z(e);return q(o)},N);function n(e){return typeof e!="string"?e:e.charAt(0).toUpperCase()+e.slice(1)}const $=(e,o,d)=>{const a=n(d);return{[`${e.componentCls}${e.componentCls}-${o}`]:{color:e[`color${d}`],background:e[`color${a}Bg`],borderColor:e[`color${a}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}};var c=(0,D.bk)(["Tag","status"],e=>{const o=Z(e);return[$(o,"success","Success"),$(o,"processing","Info"),$(o,"error","Error"),$(o,"warning","Warning")]},N),u=function(e,o){var d={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&o.indexOf(a)<0&&(d[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,a=Object.getOwnPropertySymbols(e);l<a.length;l++)o.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(d[a[l]]=e[a[l]]);return d};const f=(e,o)=>{const{prefixCls:d,className:a,rootClassName:l,style:T,children:p,icon:P,color:g,onClose:G,closeIcon:S,closable:A,bordered:b=!0}=e,h=u(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","closeIcon","closable","bordered"]),{getPrefixCls:R,direction:B,tag:O}=i.useContext(x.E_),[y,L]=i.useState(!0);i.useEffect(()=>{"visible"in h&&L(h.visible)},[h.visible]);const te=(0,_.o2)(g),ne=(0,_.yT)(g),ee=te||ne,le=Object.assign(Object.assign({backgroundColor:g&&!ee?g:void 0},O==null?void 0:O.style),T),I=R("tag",d),[oe,ie,ce]=W(I),ue=r()(I,O==null?void 0:O.className,{[`${I}-${g}`]:ee,[`${I}-has-color`]:g&&!ee,[`${I}-hidden`]:!y,[`${I}-rtl`]:B==="rtl",[`${I}-borderless`]:!b},a,l,ie,ce),re=V=>{V.stopPropagation(),G==null||G(V),!V.defaultPrevented&&L(!1)},[,de]=(0,E.Z)({closable:A,closeIcon:S!=null?S:O==null?void 0:O.closeIcon,customCloseIconRender:V=>V===null?i.createElement(m.Z,{className:`${I}-close-icon`,onClick:re}):i.createElement("span",{className:`${I}-close-icon`,onClick:re},V),defaultCloseIcon:null,defaultClosable:!1}),me=typeof h.onClick=="function"||p&&p.type==="a",ae=P||null,pe=ae?i.createElement(i.Fragment,null,ae,p&&i.createElement("span",null,p)):p,se=i.createElement("span",Object.assign({},h,{ref:o,className:ue,style:le}),pe,de,te&&i.createElement(H,{key:"preset",prefixCls:I}),ne&&i.createElement(c,{key:"status",prefixCls:I}));return oe(me?i.createElement(v.Z,{component:"Tag"},se):se)},C=i.forwardRef(f);C.CheckableTag=w;var s=C}}]);
