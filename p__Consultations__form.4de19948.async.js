(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"4f6N":function(X,M,t){"use strict";var $=t("2qtc"),P=t("kLXV"),I=t("9kvl"),C=t("nKUr"),V=t.n(C),Z=function(U){var y=U.visible,A=U.setManage;return Object(C.jsx)(P.a,{width:"600px",title:Object(C.jsx)(I.a,{id:"course.validate_edit.header",defaultMessage:"course.validate_edit.header"}),visible:y,onOk:function(){return A({showModal:!1,disableEdit:!1,clicked:!0})},onCancel:function(){return A({showModal:!1,disableEdit:!0,clicked:!1})},okText:"OK",cancelText:"Cancel",children:Object(C.jsx)("p",{children:Object(C.jsx)(I.a,{id:"course.validate_edit.content",defaultMessage:"course.validate_edit.content"})})})};M.a=Z},GZq3:function(X,M,t){},"J+hL":function(X,M,t){},VlvL:function(X,M,t){"use strict";var $=t("9kvl"),P=t("Ty5D"),I=t("nKUr"),C=t.n(I),V=function(H){var U=H.show,y=Object($.l)();return Object(I.jsx)(P.b,{when:U,message:y.formatMessage({id:"unsaved_changes"})})};M.a=V},eFHa:function(X,M,t){"use strict";t.d(M,"a",function(){return V});var $=t("tJVT"),P=t("q1tI"),I=t.n(P),C=t("HZtn");function V(){var Z=Object(P.useState)({showModal:!1,disableEdit:!1,clicked:!1}),H=Object($.a)(Z,2),U=H[0],y=H[1],A=function(f){(f==null?void 0:f.status)==="published"&&f!==null&&f!==void 0&&f.active_from&&Object(C.a)(new Date(f==null?void 0:f.active_from))&&!U.clicked?y({showModal:!1,disableEdit:!0,clicked:!1}):y({showModal:!1,disableEdit:!1,clicked:!1})};return{manageCourseEdit:U,setManageCourseEdit:y,validateCourseEdit:A}}},q34N:function(X,M,t){"use strict";var $=t("tJVT"),P=t("0eZe"),I=t("q1tI"),C=t.n(I),V=t("nKUr"),Z=t.n(V),H=function(y){var A=y.productable,w=y.type,f=w===void 0?"card":w,J=Object(I.useState)("attributes"),l=Object($.a)(J,2),k=l[0],R=l[1];return Object(V.jsx)(P.a,{productable:A,tab:k,onTabChange:function(_){return R(_)},type:f})};M.a=H},rh3J:function(X,M,t){"use strict";t.r(M);var $=t("14J3"),P=t("BMrR"),I=t("jCWc"),C=t("kPKH"),V=t("fOrg"),Z=t("+KLJ"),H=t("+L6B"),U=t("2/Rp"),y=t("T2oS"),A=t("W9HT"),w=t("miYZ"),f=t("tsqr"),J=t("qLMh"),l=t("k1fw"),k=t("9og8"),R=t("tJVT"),u=t("q1tI"),_=t.n(u),p=t("VMEa"),ne=t("Qurx"),be=t("yj/a"),re=t("lR9U"),G=t("nhC9"),ve=t("hd5d"),Oe=t("tMyG"),a=t("9kvl"),me=t("Ty5D"),fe=t("0WSk"),he=t("TWax"),q=t("Gb5Y"),Fe=t("OaEy"),ge=t("2fM7"),Ne=t("iQDF"),oe=t("+eQT"),Ve=t("+BJd"),xe=t("mr32"),pe=t("oBTY"),Me=t("wd/R"),Q=t.n(Me),He=t("GZq3"),e=t("nKUr"),ie=function(r){return r.local().valueOf()},Ce=function(r){var d=r.value,s=d===void 0?[]:d,h=r.onChange,j=r.format,g=j===void 0?"DD-MM-YYYY HH:mm":j,B=r.selectProps,F=B===void 0?{}:B,T=Object(u.useState)(!1),E=Object(R.a)(T,2),z=E[0],K=E[1],i=Object(u.useCallback)(function(c){var m=ie(c),v=s.indexOf(m),x=Object(pe.a)(s);v>-1?x.splice(v,1):x.push(m),h(x)},[s]),o=Object(u.useCallback)(function(c){var m=s.indexOf(ie(c))>-1;return Object(e.jsx)("div",{className:"ant-picker-cell-inner",style:m?{position:"relative",zIndex:2,display:"inlineBlock",width:"24px",height:"22px",lineHeight:"22px",backgroundColor:"#1890ff",color:"#fff",margin:"auto",borderRadius:"2px",transition:"background 0.3s, border 0.3s"}:{},children:c.date()})},[s]),b=Object(u.useCallback)(function(c){var m=c.value,v=c.onClose,x=function(){v(),h(s.filter(function(se){return se!==m}))};return Object(e.jsx)(xe.a,{onClose:x,closable:!0,children:Q()(m).format(g)})},[s]),n=function(){return{disabledMinutes:function(){return Array.from({length:59},function(v,x){return x+1})}}};return Object(e.jsx)(ge.a,Object(l.a)(Object(l.a)({},F),{},{allowClear:!0,mode:"multiple",value:s,onClear:function(){return h&&h([])},tagRender:b,open:z,onFocus:function(){return K(!0)},onBlur:function(){return K(!1)},dropdownMatchSelectWidth:!1,dropdownClassName:"multipleDropdownClassName",dropdownStyle:{height:"310px",width:"335px",minWidth:"0"},dropdownRender:function(){return Object(e.jsx)(oe.a,{disabledDate:function(v){var x=new Date;return v&&v.valueOf()<=x.setDate(x.getDate()-1)},showTime:{format:"HH"},disabledTime:n,onChange:function(v){return v&&i(v)},open:!0,dateRender:o,style:{visibility:"hidden"},getPopupContainer:function(v){var x=v.parentNode;return x},defaultValue:Q()("00:00","HH")})}}))},Ee=Ce,te=t("c+yx"),le=t("Gn8c"),Pe=t("VlvL"),ae;(function(D){D.draft="draft",D.published="published",D.archived="archived"})(ae||(ae={}));var ye=t("eFHa"),De=t("4f6N"),Je=t("qbNl"),Te=t("JBPa"),Ge=t("5Dmo"),Se=t("3S7+"),Ye=t("Awhp"),de=t("KrTs"),Ie=t("Qiat"),Ue=function(r){var d=r.data,s=r.onChange,h=Object(u.useState)(!1),j=Object(R.a)(h,2),g=j[0],B=j[1],F=Object(u.useState)(Q()(d.date)),T=Object(R.a)(F,2),E=T[0],z=T[1],K=Object(u.useCallback)(function(i){z(Q()(i)),B(!0),Object(q.a)(d.consultation_term_id,i).then(function(o){o.success?(f.b.success(o.message),s(E)):f.b.error(o.message)}).catch(function(o){return f.b.error(o.toString())}).finally(function(){return B(!1)})},[E]);return Object(e.jsx)(_.a.Fragment,{children:Object(e.jsx)(oe.a,{disabledDate:function(o){var b=new Date;return o&&o.valueOf()<=b.setDate(b.getDate()-1)},disabled:g,value:E,showTime:{format:"HH"},onChange:function(o){o&&K(o.toISOString())}})})},ce={reported:"warning",reject:"error",approved:"success"},Ae=[{title:Object(e.jsx)(a.a,{id:"id",defaultMessage:"id"}),dataIndex:"consultation_term_id",hideInSearch:!0},{title:Object(e.jsx)(a.a,{id:"user",defaultMessage:"user"}),dataIndex:"user",render:function(r,d){var s,h,j;return"".concat((s=d.user)===null||s===void 0?void 0:s.first_name," ").concat((h=d.user)===null||h===void 0?void 0:h.last_name," ").concat((j=d.user)===null||j===void 0?void 0:j.email)}},{title:Object(e.jsx)(a.a,{id:"date",defaultMessage:"date"}),dataIndex:"date",render:function(r,d){return Q()(d.date).format("yyyy-MM-DD HH:mm")}},{title:Object(e.jsx)(a.a,{id:"status",defaultMessage:"status"}),dataIndex:"status",render:function(r,d){return Object(e.jsx)(de.a,{status:ce[d.status],text:Object(e.jsx)(a.a,{id:d.status})})}}],Re=function(r){var d=r.consultation,s=Object(u.useState)(!1),h=Object(R.a)(s,2),j=h[0],g=h[1],B=Object(u.useState)([]),F=Object(R.a)(B,2),T=F[0],E=F[1],z=Object(a.l)(),K=Object(u.useCallback)(function(){g(!0),Object(q.f)(d).then(function(o){o.success&&E(o.data)}).catch(function(){f.b.error(Object(e.jsx)(a.a,{id:"error",defaultMessage:"error"}))}).finally(function(){return g(!1)})},[d]);Object(u.useEffect)(function(){K()},[d]);var i=Object(u.useCallback)(function(o){return Object(e.jsx)("ul",{className:"events",children:T.map(function(b){if(o.format("yyyy-MM-DD")===Q()(b.date).format("yyyy-MM-DD")){var n,c,m,v;return Object(e.jsx)("li",{children:Object(e.jsx)(de.a,{status:ce[b.status],text:Object(e.jsx)(_.a.Fragment,{children:Object(e.jsxs)(Se.a,{title:"".concat((n=b.user)===null||n===void 0?void 0:n.first_name," ").concat((c=b.user)===null||c===void 0?void 0:c.last_name," ").concat((m=b.user)===null||m===void 0?void 0:m.email),children:[Object(e.jsx)("small",{children:Q()(b.date).format("HH:mm")})," ",(v=b.user)===null||v===void 0?void 0:v.email]})})})},b.consultation_term_id)}return null})})},[T]);return Object(e.jsxs)(_.a.Fragment,{children:[j&&Object(e.jsx)(A.a,{}),Object(e.jsx)(Te.a,{dateCellRender:i}),j?Object(e.jsx)(A.a,{}):Object(e.jsx)(Ie.a,{headerTitle:z.formatMessage({id:"Consultations",defaultMessage:"Consultations"}),loading:j,rowKey:"consultation_term_id",search:!1,request:Object(k.a)(Object(J.a)().mark(function o(){return Object(J.a)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",{data:T,total:T.length,success:!0});case 1:case"end":return n.stop()}},o)})),columns:[].concat(Ae,[{title:Object(e.jsx)(a.a,{id:"options",defaultMessage:"options"}),dataIndex:"option",valueType:"option",width:"20%",render:function(b,n){return[Object(e.jsx)(Ue,{data:n,onChange:function(){return K()}},"change_date")]}}])})]})},Ke=Re,$e=t("J+hL"),Le=t("q34N"),We=t("5RzD"),Be=function(){var r=Object(a.l)(),d=Object(me.l)(),s=d.consultation,h=d.tab,j=h===void 0?"attributes":h,g=s==="new",B=Object(u.useState)(!1),F=Object(R.a)(B,2),T=F[0],E=F[1],z=Object(u.useState)(),K=Object(R.a)(z,2),i=K[0],o=K[1],b=Object(ye.a)(),n=b.manageCourseEdit,c=b.setManageCourseEdit,m=b.validateCourseEdit,v=p.a.useForm(),x=Object(R.a)(v,1),ue=x[0],se=Object(u.useCallback)(Object(k.a)(Object(J.a)().mark(function L(){var O,W;return Object(J.a)().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,Object(q.e)(Number(s));case 2:O=N.sent,O.success&&(j==="attributes"&&m(O.data),o(Object(l.a)(Object(l.a)({},O.data),{},{author_id:O.data.author&&O.data.author.id,categories:(W=O.data.categories)===null||W===void 0?void 0:W.map(te.a)})));case 4:case"end":return N.stop()}},L)})),[s]);Object(u.useEffect)(function(){if(g){o({name:"new"});return}se()},[s]);var ee=Object(u.useMemo)(function(){return{onFinish:function(){var L=Object(k.a)(Object(J.a)().mark(function W(je){var N,Y;return Object(J.a)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!n.disableEdit){S.next=3;break}return c({showModal:!0,disableEdit:!0,clicked:!1}),S.abrupt("return");case 3:if(N=Object(l.a)(Object(l.a)({},je),{},{image_url:i&&i.image_url,image_path:i&&i.image_url&&Object(te.j)(i.image_url),logotype_url:i&&i.logotype_url,logotype_path:i&&i.logotype_path&&Object(te.j)(i.logotype_path)}),!g){S.next=11;break}return S.next=7,Object(q.c)(N);case 7:Y=S.sent,Y.success&&(E(!1),a.f.push("/other/consultations/".concat(Y.data.id))),S.next=15;break;case 11:return S.next=13,Object(q.g)(Number(s),N);case 13:Y=S.sent,Y.success&&(E(!1),m(Y.data),a.f.push("/other/consultations/".concat(Y.data.id,"/").concat(j)));case 15:f.b.success(Y.message);case 16:case"end":return S.stop()}},W)}));function O(W){return L.apply(this,arguments)}return O}(),initialValues:i}},[i,s,j,n]);return i?Object(e.jsx)(Oe.a,{title:g?Object(e.jsx)(a.a,{id:"consultation"}):Object(e.jsx)(a.a,{id:"consultations.edit"}),header:{breadcrumb:{routes:[{path:"other/consultations",breadcrumbName:r.formatMessage({id:"menu.Other activities.Consultations"})},{path:String(s),breadcrumbName:r.formatMessage({id:"form"})},{path:"/",breadcrumbName:String(i.name)},{path:String(j),breadcrumbName:String(i.name)}]}},children:Object(e.jsxs)(G.a,{tabs:{type:"card",activeKey:j,onChange:function(O){return a.f.push("/other/consultations/".concat(s,"/").concat(O))}},children:[Object(e.jsxs)(G.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"attributes"}),children:[n.disableEdit&&Object(e.jsx)(Z.a,{closable:!0,style:{marginBottom:"20px"},type:"warning",message:Object(e.jsx)(a.a,{id:"course_edit_warning_message",defaultMessage:"course_edit_warning_message"}),action:Object(e.jsx)(U.a,{onClick:function(){return c({showModal:!0,disableEdit:!0,clicked:!0})},type:"primary",children:Object(e.jsx)(a.a,{id:"questionnaire.submit",defaultMessage:"questionnaire.submit"})})}),Object(e.jsx)(Pe.a,{show:T})," ",Object(e.jsx)(De.a,{visible:n.showModal,setManage:c}),Object(e.jsxs)(p.a,Object(l.a)(Object(l.a)({},ee),{},{form:ue,onValuesChange:function(){E(!0)},children:[Object(e.jsxs)(p.a.Group,{children:[Object(e.jsx)(ne.a,{width:"md",name:"name",label:Object(e.jsx)(a.a,{id:"name"}),tooltip:Object(e.jsx)(a.a,{id:"name"}),placeholder:r.formatMessage({id:"name",defaultMessage:"name"}),required:!0,disabled:n.disableEdit}),Object(e.jsx)(ne.a,{width:"sm",name:"duration",label:Object(e.jsx)(a.a,{id:"duration"}),tooltip:Object(e.jsx)(a.a,{id:"duration"}),placeholder:r.formatMessage({id:"duration",defaultMessage:"duration"}),disabled:n.disableEdit}),Object(e.jsx)(be.a,{name:"status",width:"sm",label:Object(e.jsx)(a.a,{id:"status"}),tooltip:Object(e.jsx)(a.a,{id:"status_consultation_tooltip"}),valueEnum:{draft:r.formatMessage({id:"draft",defaultMessage:"draft"}),published:r.formatMessage({id:"published",defaultMessage:"published"}),archived:r.formatMessage({id:"archived",defaultMessage:"archived"})},initialValue:ae.draft,placeholder:r.formatMessage({id:"status"}),rules:[{required:!0,message:Object(e.jsx)(a.a,{id:"select"})}],disabled:n.disableEdit})]}),Object(e.jsxs)(p.a.Group,{children:[Object(e.jsx)(re.a,{width:"sm",name:"active_from",label:Object(e.jsx)(a.a,{id:"active_from"}),tooltip:Object(e.jsx)(a.a,{id:"active_from"}),placeholder:r.formatMessage({id:"active_from",defaultMessage:"active_from"}),disabled:n.disableEdit}),Object(e.jsx)(re.a,{width:"sm",name:"active_to",label:Object(e.jsx)(a.a,{id:"active_to"}),tooltip:Object(e.jsx)(a.a,{id:"active_to"}),placeholder:r.formatMessage({id:"active_to",defaultMessage:"active_to"}),disabled:n.disableEdit}),Object(e.jsx)(p.a.Item,{name:"author_id",label:Object(e.jsx)(a.a,{id:"tutor"}),tooltip:Object(e.jsx)(a.a,{id:"tutor_consultation_tooltip"}),valuePropName:"value",required:!0,children:Object(e.jsx)(fe.a,{})})]}),Object(e.jsx)(p.a.Group,{children:Object(e.jsx)(p.a.Item,{name:"description",label:Object(e.jsx)(a.a,{id:"description"}),tooltip:Object(e.jsx)(a.a,{id:"description_tooltip"}),valuePropName:"value",required:!0,children:Object(e.jsx)(ve.a,{directory:"consultation/".concat(s,"/wysiwyg")})})}),Object(e.jsx)(p.a.Group,{children:Object(e.jsx)(p.a.Item,{valuePropName:"value",name:"proposed_terms",tooltip:Object(e.jsx)(a.a,{id:"proposed_terms_tooltip"}),label:Object(e.jsx)(a.a,{id:"consultations.proposed_terms"}),children:Object(e.jsx)(Ee,{})})})]}))]},"attributes"),!g&&Object(e.jsx)(G.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"product"}),disabled:n.disableEdit,children:s&&Object(e.jsx)(Le.a,{type:"line",productable:{class_type:"App\\Models\\Consultation",class_id:s,name:String(i.name),quantity:1}})},"product"),!g&&Object(e.jsx)(G.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"media"}),disabled:n.disableEdit,children:Object(e.jsx)(p.a,Object(l.a)(Object(l.a)({},ee),{},{children:Object(e.jsx)(le.a,{folder:"consultation/".concat(s),title:"image",action:"/api/admin/consultations/".concat(s),src_name:"image_url",form_name:"image",getUploadedSrcField:function(O){return O.file.response.data.image_url},setPath:function(O){return o(function(W){return Object(l.a)(Object(l.a)({},W),O)})}})}))},"media"),!g&&Object(e.jsx)(G.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"categories"}),disabled:n.disableEdit,children:Object(e.jsx)(P.a,{children:Object(e.jsx)(C.a,{span:12,children:Object(e.jsx)(p.a,Object(l.a)(Object(l.a)({},ee),{},{children:Object(e.jsx)(p.a.Item,{label:Object(e.jsx)(a.a,{id:"categories"}),name:"categories",valuePropName:"value",children:Object(e.jsx)(he.a,{})})}))})})},"categories")," ",!g&&Object(e.jsx)(G.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"branding"}),disabled:n.disableEdit,children:Object(e.jsx)(p.a,Object(l.a)(Object(l.a)({},ee),{},{children:Object(e.jsx)(le.a,{folder:"consultation/".concat(s),title:r.formatMessage({id:"logotype"}),action:"/api/admin/consultations/".concat(s),src_name:"logotype_url",form_name:"logotype",getUploadedSrcField:function(O){return O.file.response.data.logotype_url},setPath:function(O){return o(function(W){return Object(l.a)(Object(l.a)({},W),O)})}})}))},"branding")," ",!g&&Object(e.jsx)(G.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"user_submission"}),disabled:n.disableEdit,children:Object(e.jsx)(P.a,{children:Object(e.jsx)(C.a,{span:12,children:s&&Object(e.jsx)(We.a,{id:Number(s),type:"App\\Models\\Consultation"})})})},"user_submission"),!g&&Object(e.jsx)(G.a.TabPane,{tab:Object(e.jsx)(a.a,{id:"consultations.calendar"}),children:Object(e.jsx)(Ke,{consultation:Number(s)})},"calendar")]})}):Object(e.jsx)(A.a,{})},Ze=M.default=Be}}]);
